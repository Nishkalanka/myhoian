function xM(a,l){for(var m=0;m<l.length;m++){const _=l[m];if(typeof _!="string"&&!Array.isArray(_)){for(const w in _)if(w!=="default"&&!(w in a)){const C=Object.getOwnPropertyDescriptor(_,w);C&&Object.defineProperty(a,w,C.get?C:{enumerable:!0,get:()=>_[w]})}}}return Object.freeze(Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}))}(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))_(w);new MutationObserver(w=>{for(const C of w)if(C.type==="childList")for(const M of C.addedNodes)M.tagName==="LINK"&&M.rel==="modulepreload"&&_(M)}).observe(document,{childList:!0,subtree:!0});function m(w){const C={};return w.integrity&&(C.integrity=w.integrity),w.referrerPolicy&&(C.referrerPolicy=w.referrerPolicy),w.crossOrigin==="use-credentials"?C.credentials="include":w.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function _(w){if(w.ep)return;w.ep=!0;const C=m(w);fetch(w.href,C)}})();function $l(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function bd(a){if(Object.prototype.hasOwnProperty.call(a,"__esModule"))return a;var l=a.default;if(typeof l=="function"){var m=function _(){return this instanceof _?Reflect.construct(l,arguments,this.constructor):l.apply(this,arguments)};m.prototype=l.prototype}else m={};return Object.defineProperty(m,"__esModule",{value:!0}),Object.keys(a).forEach(function(_){var w=Object.getOwnPropertyDescriptor(a,_);Object.defineProperty(m,_,w.get?w:{enumerable:!0,get:function(){return a[_]}})}),m}var Sx={exports:{}},kg={},Cx={exports:{}},Ir={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VT;function bM(){if(VT)return Ir;VT=1;var a=Symbol.for("react.element"),l=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),M=Symbol.for("react.context"),r=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),V=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),Z=Symbol.iterator;function ie(lt){return lt===null||typeof lt!="object"?null:(lt=Z&&lt[Z]||lt["@@iterator"],typeof lt=="function"?lt:null)}var de={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},se=Object.assign,ne={};function Se(lt,Ht,Nn){this.props=lt,this.context=Ht,this.refs=ne,this.updater=Nn||de}Se.prototype.isReactComponent={},Se.prototype.setState=function(lt,Ht){if(typeof lt!="object"&&typeof lt!="function"&&lt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,lt,Ht,"setState")},Se.prototype.forceUpdate=function(lt){this.updater.enqueueForceUpdate(this,lt,"forceUpdate")};function me(){}me.prototype=Se.prototype;function Re(lt,Ht,Nn){this.props=lt,this.context=Ht,this.refs=ne,this.updater=Nn||de}var ye=Re.prototype=new me;ye.constructor=Re,se(ye,Se.prototype),ye.isPureReactComponent=!0;var Le=Array.isArray,De=Object.prototype.hasOwnProperty,Oe={current:null},Ee={key:!0,ref:!0,__self:!0,__source:!0};function qe(lt,Ht,Nn){var zn,xn={},An=null,ti=null;if(Ht!=null)for(zn in Ht.ref!==void 0&&(ti=Ht.ref),Ht.key!==void 0&&(An=""+Ht.key),Ht)De.call(Ht,zn)&&!Ee.hasOwnProperty(zn)&&(xn[zn]=Ht[zn]);var Hn=arguments.length-2;if(Hn===1)xn.children=Nn;else if(1<Hn){for(var bn=Array(Hn),Zi=0;Zi<Hn;Zi++)bn[Zi]=arguments[Zi+2];xn.children=bn}if(lt&&lt.defaultProps)for(zn in Hn=lt.defaultProps,Hn)xn[zn]===void 0&&(xn[zn]=Hn[zn]);return{$$typeof:a,type:lt,key:An,ref:ti,props:xn,_owner:Oe.current}}function $e(lt,Ht){return{$$typeof:a,type:lt.type,key:Ht,ref:lt.ref,props:lt.props,_owner:lt._owner}}function Ge(lt){return typeof lt=="object"&&lt!==null&&lt.$$typeof===a}function et(lt){var Ht={"=":"=0",":":"=2"};return"$"+lt.replace(/[=:]/g,function(Nn){return Ht[Nn]})}var mt=/\/+/g;function St(lt,Ht){return typeof lt=="object"&&lt!==null&&lt.key!=null?et(""+lt.key):Ht.toString(36)}function xt(lt,Ht,Nn,zn,xn){var An=typeof lt;(An==="undefined"||An==="boolean")&&(lt=null);var ti=!1;if(lt===null)ti=!0;else switch(An){case"string":case"number":ti=!0;break;case"object":switch(lt.$$typeof){case a:case l:ti=!0}}if(ti)return ti=lt,xn=xn(ti),lt=zn===""?"."+St(ti,0):zn,Le(xn)?(Nn="",lt!=null&&(Nn=lt.replace(mt,"$&/")+"/"),xt(xn,Ht,Nn,"",function(Zi){return Zi})):xn!=null&&(Ge(xn)&&(xn=$e(xn,Nn+(!xn.key||ti&&ti.key===xn.key?"":(""+xn.key).replace(mt,"$&/")+"/")+lt)),Ht.push(xn)),1;if(ti=0,zn=zn===""?".":zn+":",Le(lt))for(var Hn=0;Hn<lt.length;Hn++){An=lt[Hn];var bn=zn+St(An,Hn);ti+=xt(An,Ht,Nn,bn,xn)}else if(bn=ie(lt),typeof bn=="function")for(lt=bn.call(lt),Hn=0;!(An=lt.next()).done;)An=An.value,bn=zn+St(An,Hn++),ti+=xt(An,Ht,Nn,bn,xn);else if(An==="object")throw Ht=String(lt),Error("Objects are not valid as a React child (found: "+(Ht==="[object Object]"?"object with keys {"+Object.keys(lt).join(", ")+"}":Ht)+"). If you meant to render a collection of children, use an array instead.");return ti}function At(lt,Ht,Nn){if(lt==null)return lt;var zn=[],xn=0;return xt(lt,zn,"","",function(An){return Ht.call(Nn,An,xn++)}),zn}function Ct(lt){if(lt._status===-1){var Ht=lt._result;Ht=Ht(),Ht.then(function(Nn){(lt._status===0||lt._status===-1)&&(lt._status=1,lt._result=Nn)},function(Nn){(lt._status===0||lt._status===-1)&&(lt._status=2,lt._result=Nn)}),lt._status===-1&&(lt._status=0,lt._result=Ht)}if(lt._status===1)return lt._result.default;throw lt._result}var Ut={current:null},at={transition:null},kt={ReactCurrentDispatcher:Ut,ReactCurrentBatchConfig:at,ReactCurrentOwner:Oe};function qt(){throw Error("act(...) is not supported in production builds of React.")}return Ir.Children={map:At,forEach:function(lt,Ht,Nn){At(lt,function(){Ht.apply(this,arguments)},Nn)},count:function(lt){var Ht=0;return At(lt,function(){Ht++}),Ht},toArray:function(lt){return At(lt,function(Ht){return Ht})||[]},only:function(lt){if(!Ge(lt))throw Error("React.Children.only expected to receive a single React element child.");return lt}},Ir.Component=Se,Ir.Fragment=m,Ir.Profiler=w,Ir.PureComponent=Re,Ir.StrictMode=_,Ir.Suspense=O,Ir.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kt,Ir.act=qt,Ir.cloneElement=function(lt,Ht,Nn){if(lt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+lt+".");var zn=se({},lt.props),xn=lt.key,An=lt.ref,ti=lt._owner;if(Ht!=null){if(Ht.ref!==void 0&&(An=Ht.ref,ti=Oe.current),Ht.key!==void 0&&(xn=""+Ht.key),lt.type&&lt.type.defaultProps)var Hn=lt.type.defaultProps;for(bn in Ht)De.call(Ht,bn)&&!Ee.hasOwnProperty(bn)&&(zn[bn]=Ht[bn]===void 0&&Hn!==void 0?Hn[bn]:Ht[bn])}var bn=arguments.length-2;if(bn===1)zn.children=Nn;else if(1<bn){Hn=Array(bn);for(var Zi=0;Zi<bn;Zi++)Hn[Zi]=arguments[Zi+2];zn.children=Hn}return{$$typeof:a,type:lt.type,key:xn,ref:An,props:zn,_owner:ti}},Ir.createContext=function(lt){return lt={$$typeof:M,_currentValue:lt,_currentValue2:lt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},lt.Provider={$$typeof:C,_context:lt},lt.Consumer=lt},Ir.createElement=qe,Ir.createFactory=function(lt){var Ht=qe.bind(null,lt);return Ht.type=lt,Ht},Ir.createRef=function(){return{current:null}},Ir.forwardRef=function(lt){return{$$typeof:r,render:lt}},Ir.isValidElement=Ge,Ir.lazy=function(lt){return{$$typeof:U,_payload:{_status:-1,_result:lt},_init:Ct}},Ir.memo=function(lt,Ht){return{$$typeof:V,type:lt,compare:Ht===void 0?null:Ht}},Ir.startTransition=function(lt){var Ht=at.transition;at.transition={};try{lt()}finally{at.transition=Ht}},Ir.unstable_act=qt,Ir.useCallback=function(lt,Ht){return Ut.current.useCallback(lt,Ht)},Ir.useContext=function(lt){return Ut.current.useContext(lt)},Ir.useDebugValue=function(){},Ir.useDeferredValue=function(lt){return Ut.current.useDeferredValue(lt)},Ir.useEffect=function(lt,Ht){return Ut.current.useEffect(lt,Ht)},Ir.useId=function(){return Ut.current.useId()},Ir.useImperativeHandle=function(lt,Ht,Nn){return Ut.current.useImperativeHandle(lt,Ht,Nn)},Ir.useInsertionEffect=function(lt,Ht){return Ut.current.useInsertionEffect(lt,Ht)},Ir.useLayoutEffect=function(lt,Ht){return Ut.current.useLayoutEffect(lt,Ht)},Ir.useMemo=function(lt,Ht){return Ut.current.useMemo(lt,Ht)},Ir.useReducer=function(lt,Ht,Nn){return Ut.current.useReducer(lt,Ht,Nn)},Ir.useRef=function(lt){return Ut.current.useRef(lt)},Ir.useState=function(lt){return Ut.current.useState(lt)},Ir.useSyncExternalStore=function(lt,Ht,Nn){return Ut.current.useSyncExternalStore(lt,Ht,Nn)},Ir.useTransition=function(){return Ut.current.useTransition()},Ir.version="18.3.1",Ir}var qT;function d_(){return qT||(qT=1,Cx.exports=bM()),Cx.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HT;function wM(){if(HT)return kg;HT=1;var a=d_(),l=Symbol.for("react.element"),m=Symbol.for("react.fragment"),_=Object.prototype.hasOwnProperty,w=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,C={key:!0,ref:!0,__self:!0,__source:!0};function M(r,O,V){var U,Z={},ie=null,de=null;V!==void 0&&(ie=""+V),O.key!==void 0&&(ie=""+O.key),O.ref!==void 0&&(de=O.ref);for(U in O)_.call(O,U)&&!C.hasOwnProperty(U)&&(Z[U]=O[U]);if(r&&r.defaultProps)for(U in O=r.defaultProps,O)Z[U]===void 0&&(Z[U]=O[U]);return{$$typeof:l,type:r,key:ie,ref:de,props:Z,_owner:w.current}}return kg.Fragment=m,kg.jsx=M,kg.jsxs=M,kg}var UT;function wd(){return UT||(UT=1,Sx.exports=wM()),Sx.exports}var Ne=wd(),ly={},Ex={exports:{}},pl={},Ax={exports:{}},Ix={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $T;function TM(){return $T||($T=1,function(a){function l(at,kt){var qt=at.length;at.push(kt);e:for(;0<qt;){var lt=qt-1>>>1,Ht=at[lt];if(0<w(Ht,kt))at[lt]=kt,at[qt]=Ht,qt=lt;else break e}}function m(at){return at.length===0?null:at[0]}function _(at){if(at.length===0)return null;var kt=at[0],qt=at.pop();if(qt!==kt){at[0]=qt;e:for(var lt=0,Ht=at.length,Nn=Ht>>>1;lt<Nn;){var zn=2*(lt+1)-1,xn=at[zn],An=zn+1,ti=at[An];if(0>w(xn,qt))An<Ht&&0>w(ti,xn)?(at[lt]=ti,at[An]=qt,lt=An):(at[lt]=xn,at[zn]=qt,lt=zn);else if(An<Ht&&0>w(ti,qt))at[lt]=ti,at[An]=qt,lt=An;else break e}}return kt}function w(at,kt){var qt=at.sortIndex-kt.sortIndex;return qt!==0?qt:at.id-kt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var C=performance;a.unstable_now=function(){return C.now()}}else{var M=Date,r=M.now();a.unstable_now=function(){return M.now()-r}}var O=[],V=[],U=1,Z=null,ie=3,de=!1,se=!1,ne=!1,Se=typeof setTimeout=="function"?setTimeout:null,me=typeof clearTimeout=="function"?clearTimeout:null,Re=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ye(at){for(var kt=m(V);kt!==null;){if(kt.callback===null)_(V);else if(kt.startTime<=at)_(V),kt.sortIndex=kt.expirationTime,l(O,kt);else break;kt=m(V)}}function Le(at){if(ne=!1,ye(at),!se)if(m(O)!==null)se=!0,Ct(De);else{var kt=m(V);kt!==null&&Ut(Le,kt.startTime-at)}}function De(at,kt){se=!1,ne&&(ne=!1,me(qe),qe=-1),de=!0;var qt=ie;try{for(ye(kt),Z=m(O);Z!==null&&(!(Z.expirationTime>kt)||at&&!et());){var lt=Z.callback;if(typeof lt=="function"){Z.callback=null,ie=Z.priorityLevel;var Ht=lt(Z.expirationTime<=kt);kt=a.unstable_now(),typeof Ht=="function"?Z.callback=Ht:Z===m(O)&&_(O),ye(kt)}else _(O);Z=m(O)}if(Z!==null)var Nn=!0;else{var zn=m(V);zn!==null&&Ut(Le,zn.startTime-kt),Nn=!1}return Nn}finally{Z=null,ie=qt,de=!1}}var Oe=!1,Ee=null,qe=-1,$e=5,Ge=-1;function et(){return!(a.unstable_now()-Ge<$e)}function mt(){if(Ee!==null){var at=a.unstable_now();Ge=at;var kt=!0;try{kt=Ee(!0,at)}finally{kt?St():(Oe=!1,Ee=null)}}else Oe=!1}var St;if(typeof Re=="function")St=function(){Re(mt)};else if(typeof MessageChannel<"u"){var xt=new MessageChannel,At=xt.port2;xt.port1.onmessage=mt,St=function(){At.postMessage(null)}}else St=function(){Se(mt,0)};function Ct(at){Ee=at,Oe||(Oe=!0,St())}function Ut(at,kt){qe=Se(function(){at(a.unstable_now())},kt)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(at){at.callback=null},a.unstable_continueExecution=function(){se||de||(se=!0,Ct(De))},a.unstable_forceFrameRate=function(at){0>at||125<at?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$e=0<at?Math.floor(1e3/at):5},a.unstable_getCurrentPriorityLevel=function(){return ie},a.unstable_getFirstCallbackNode=function(){return m(O)},a.unstable_next=function(at){switch(ie){case 1:case 2:case 3:var kt=3;break;default:kt=ie}var qt=ie;ie=kt;try{return at()}finally{ie=qt}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(at,kt){switch(at){case 1:case 2:case 3:case 4:case 5:break;default:at=3}var qt=ie;ie=at;try{return kt()}finally{ie=qt}},a.unstable_scheduleCallback=function(at,kt,qt){var lt=a.unstable_now();switch(typeof qt=="object"&&qt!==null?(qt=qt.delay,qt=typeof qt=="number"&&0<qt?lt+qt:lt):qt=lt,at){case 1:var Ht=-1;break;case 2:Ht=250;break;case 5:Ht=1073741823;break;case 4:Ht=1e4;break;default:Ht=5e3}return Ht=qt+Ht,at={id:U++,callback:kt,priorityLevel:at,startTime:qt,expirationTime:Ht,sortIndex:-1},qt>lt?(at.sortIndex=qt,l(V,at),m(O)===null&&at===m(V)&&(ne?(me(qe),qe=-1):ne=!0,Ut(Le,qt-lt))):(at.sortIndex=Ht,l(O,at),se||de||(se=!0,Ct(De))),at},a.unstable_shouldYield=et,a.unstable_wrapCallback=function(at){var kt=ie;return function(){var qt=ie;ie=kt;try{return at.apply(this,arguments)}finally{ie=qt}}}}(Ix)),Ix}var GT;function SM(){return GT||(GT=1,Ax.exports=TM()),Ax.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WT;function CM(){if(WT)return pl;WT=1;var a=d_(),l=SM();function m(f){for(var y="https://reactjs.org/docs/error-decoder.html?invariant="+f,A=1;A<arguments.length;A++)y+="&args[]="+encodeURIComponent(arguments[A]);return"Minified React error #"+f+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _=new Set,w={};function C(f,y){M(f,y),M(f+"Capture",y)}function M(f,y){for(w[f]=y,f=0;f<y.length;f++)_.add(y[f])}var r=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),O=Object.prototype.hasOwnProperty,V=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,U={},Z={};function ie(f){return O.call(Z,f)?!0:O.call(U,f)?!1:V.test(f)?Z[f]=!0:(U[f]=!0,!1)}function de(f,y,A,D){if(A!==null&&A.type===0)return!1;switch(typeof y){case"function":case"symbol":return!0;case"boolean":return D?!1:A!==null?!A.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function se(f,y,A,D){if(y===null||typeof y>"u"||de(f,y,A,D))return!0;if(D)return!1;if(A!==null)switch(A.type){case 3:return!y;case 4:return y===!1;case 5:return isNaN(y);case 6:return isNaN(y)||1>y}return!1}function ne(f,y,A,D,H,Q,be){this.acceptsBooleans=y===2||y===3||y===4,this.attributeName=D,this.attributeNamespace=H,this.mustUseProperty=A,this.propertyName=f,this.type=y,this.sanitizeURL=Q,this.removeEmptyString=be}var Se={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){Se[f]=new ne(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var y=f[0];Se[y]=new ne(y,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){Se[f]=new ne(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){Se[f]=new ne(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){Se[f]=new ne(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){Se[f]=new ne(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){Se[f]=new ne(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){Se[f]=new ne(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){Se[f]=new ne(f,5,!1,f.toLowerCase(),null,!1,!1)});var me=/[\-:]([a-z])/g;function Re(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var y=f.replace(me,Re);Se[y]=new ne(y,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var y=f.replace(me,Re);Se[y]=new ne(y,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var y=f.replace(me,Re);Se[y]=new ne(y,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){Se[f]=new ne(f,1,!1,f.toLowerCase(),null,!1,!1)}),Se.xlinkHref=new ne("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){Se[f]=new ne(f,1,!1,f.toLowerCase(),null,!0,!0)});function ye(f,y,A,D){var H=Se.hasOwnProperty(y)?Se[y]:null;(H!==null?H.type!==0:D||!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(se(y,A,H,D)&&(A=null),D||H===null?ie(y)&&(A===null?f.removeAttribute(y):f.setAttribute(y,""+A)):H.mustUseProperty?f[H.propertyName]=A===null?H.type===3?!1:"":A:(y=H.attributeName,D=H.attributeNamespace,A===null?f.removeAttribute(y):(H=H.type,A=H===3||H===4&&A===!0?"":""+A,D?f.setAttributeNS(D,y,A):f.setAttribute(y,A))))}var Le=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,De=Symbol.for("react.element"),Oe=Symbol.for("react.portal"),Ee=Symbol.for("react.fragment"),qe=Symbol.for("react.strict_mode"),$e=Symbol.for("react.profiler"),Ge=Symbol.for("react.provider"),et=Symbol.for("react.context"),mt=Symbol.for("react.forward_ref"),St=Symbol.for("react.suspense"),xt=Symbol.for("react.suspense_list"),At=Symbol.for("react.memo"),Ct=Symbol.for("react.lazy"),Ut=Symbol.for("react.offscreen"),at=Symbol.iterator;function kt(f){return f===null||typeof f!="object"?null:(f=at&&f[at]||f["@@iterator"],typeof f=="function"?f:null)}var qt=Object.assign,lt;function Ht(f){if(lt===void 0)try{throw Error()}catch(A){var y=A.stack.trim().match(/\n( *(at )?)/);lt=y&&y[1]||""}return`
`+lt+f}var Nn=!1;function zn(f,y){if(!f||Nn)return"";Nn=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(y)if(y=function(){throw Error()},Object.defineProperty(y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(y,[])}catch(Bt){var D=Bt}Reflect.construct(f,[],y)}else{try{y.call()}catch(Bt){D=Bt}f.call(y.prototype)}else{try{throw Error()}catch(Bt){D=Bt}f()}}catch(Bt){if(Bt&&D&&typeof Bt.stack=="string"){for(var H=Bt.stack.split(`
`),Q=D.stack.split(`
`),be=H.length-1,Ye=Q.length-1;1<=be&&0<=Ye&&H[be]!==Q[Ye];)Ye--;for(;1<=be&&0<=Ye;be--,Ye--)if(H[be]!==Q[Ye]){if(be!==1||Ye!==1)do if(be--,Ye--,0>Ye||H[be]!==Q[Ye]){var ot=`
`+H[be].replace(" at new "," at ");return f.displayName&&ot.includes("<anonymous>")&&(ot=ot.replace("<anonymous>",f.displayName)),ot}while(1<=be&&0<=Ye);break}}}finally{Nn=!1,Error.prepareStackTrace=A}return(f=f?f.displayName||f.name:"")?Ht(f):""}function xn(f){switch(f.tag){case 5:return Ht(f.type);case 16:return Ht("Lazy");case 13:return Ht("Suspense");case 19:return Ht("SuspenseList");case 0:case 2:case 15:return f=zn(f.type,!1),f;case 11:return f=zn(f.type.render,!1),f;case 1:return f=zn(f.type,!0),f;default:return""}}function An(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case Ee:return"Fragment";case Oe:return"Portal";case $e:return"Profiler";case qe:return"StrictMode";case St:return"Suspense";case xt:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case et:return(f.displayName||"Context")+".Consumer";case Ge:return(f._context.displayName||"Context")+".Provider";case mt:var y=f.render;return f=f.displayName,f||(f=y.displayName||y.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case At:return y=f.displayName||null,y!==null?y:An(f.type)||"Memo";case Ct:y=f._payload,f=f._init;try{return An(f(y))}catch{}}return null}function ti(f){var y=f.type;switch(f.tag){case 24:return"Cache";case 9:return(y.displayName||"Context")+".Consumer";case 10:return(y._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=y.render,f=f.displayName||f.name||"",y.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return y;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return An(y);case 8:return y===qe?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y}return null}function Hn(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function bn(f){var y=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function Zi(f){var y=bn(f)?"checked":"value",A=Object.getOwnPropertyDescriptor(f.constructor.prototype,y),D=""+f[y];if(!f.hasOwnProperty(y)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var H=A.get,Q=A.set;return Object.defineProperty(f,y,{configurable:!0,get:function(){return H.call(this)},set:function(be){D=""+be,Q.call(this,be)}}),Object.defineProperty(f,y,{enumerable:A.enumerable}),{getValue:function(){return D},setValue:function(be){D=""+be},stopTracking:function(){f._valueTracker=null,delete f[y]}}}}function Ci(f){f._valueTracker||(f._valueTracker=Zi(f))}function Yi(f){if(!f)return!1;var y=f._valueTracker;if(!y)return!0;var A=y.getValue(),D="";return f&&(D=bn(f)?f.checked?"true":"false":f.value),f=D,f!==A?(y.setValue(f),!0):!1}function Vn(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function ki(f,y){var A=y.checked;return qt({},y,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:A??f._wrapperState.initialChecked})}function zi(f,y){var A=y.defaultValue==null?"":y.defaultValue,D=y.checked!=null?y.checked:y.defaultChecked;A=Hn(y.value!=null?y.value:A),f._wrapperState={initialChecked:D,initialValue:A,controlled:y.type==="checkbox"||y.type==="radio"?y.checked!=null:y.value!=null}}function Pr(f,y){y=y.checked,y!=null&&ye(f,"checked",y,!1)}function Gr(f,y){Pr(f,y);var A=Hn(y.value),D=y.type;if(A!=null)D==="number"?(A===0&&f.value===""||f.value!=A)&&(f.value=""+A):f.value!==""+A&&(f.value=""+A);else if(D==="submit"||D==="reset"){f.removeAttribute("value");return}y.hasOwnProperty("value")?zr(f,y.type,A):y.hasOwnProperty("defaultValue")&&zr(f,y.type,Hn(y.defaultValue)),y.checked==null&&y.defaultChecked!=null&&(f.defaultChecked=!!y.defaultChecked)}function ys(f,y,A){if(y.hasOwnProperty("value")||y.hasOwnProperty("defaultValue")){var D=y.type;if(!(D!=="submit"&&D!=="reset"||y.value!==void 0&&y.value!==null))return;y=""+f._wrapperState.initialValue,A||y===f.value||(f.value=y),f.defaultValue=y}A=f.name,A!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,A!==""&&(f.name=A)}function zr(f,y,A){(y!=="number"||Vn(f.ownerDocument)!==f)&&(A==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+A&&(f.defaultValue=""+A))}var Or=Array.isArray;function sr(f,y,A,D){if(f=f.options,y){y={};for(var H=0;H<A.length;H++)y["$"+A[H]]=!0;for(A=0;A<f.length;A++)H=y.hasOwnProperty("$"+f[A].value),f[A].selected!==H&&(f[A].selected=H),H&&D&&(f[A].defaultSelected=!0)}else{for(A=""+Hn(A),y=null,H=0;H<f.length;H++){if(f[H].value===A){f[H].selected=!0,D&&(f[H].defaultSelected=!0);return}y!==null||f[H].disabled||(y=f[H])}y!==null&&(y.selected=!0)}}function Ss(f,y){if(y.dangerouslySetInnerHTML!=null)throw Error(m(91));return qt({},y,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function as(f,y){var A=y.value;if(A==null){if(A=y.children,y=y.defaultValue,A!=null){if(y!=null)throw Error(m(92));if(Or(A)){if(1<A.length)throw Error(m(93));A=A[0]}y=A}y==null&&(y=""),A=y}f._wrapperState={initialValue:Hn(A)}}function Hi(f,y){var A=Hn(y.value),D=Hn(y.defaultValue);A!=null&&(A=""+A,A!==f.value&&(f.value=A),y.defaultValue==null&&f.defaultValue!==A&&(f.defaultValue=A)),D!=null&&(f.defaultValue=""+D)}function Gs(f){var y=f.textContent;y===f._wrapperState.initialValue&&y!==""&&y!==null&&(f.value=y)}function ho(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jr(f,y){return f==null||f==="http://www.w3.org/1999/xhtml"?ho(y):f==="http://www.w3.org/2000/svg"&&y==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var xr,ci=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(y,A,D,H){MSApp.execUnsafeLocalFunction(function(){return f(y,A,D,H)})}:f}(function(f,y){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=y;else{for(xr=xr||document.createElement("div"),xr.innerHTML="<svg>"+y.valueOf().toString()+"</svg>",y=xr.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;y.firstChild;)f.appendChild(y.firstChild)}});function Cs(f,y){if(y){var A=f.firstChild;if(A&&A===f.lastChild&&A.nodeType===3){A.nodeValue=y;return}}f.textContent=y}var Wr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ws=["Webkit","ms","Moz","O"];Object.keys(Wr).forEach(function(f){Ws.forEach(function(y){y=y+f.charAt(0).toUpperCase()+f.substring(1),Wr[y]=Wr[f]})});function hi(f,y,A){return y==null||typeof y=="boolean"||y===""?"":A||typeof y!="number"||y===0||Wr.hasOwnProperty(f)&&Wr[f]?(""+y).trim():y+"px"}function br(f,y){f=f.style;for(var A in y)if(y.hasOwnProperty(A)){var D=A.indexOf("--")===0,H=hi(A,y[A],D);A==="float"&&(A="cssFloat"),D?f.setProperty(A,H):f[A]=H}}var is=qt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ro(f,y){if(y){if(is[f]&&(y.children!=null||y.dangerouslySetInnerHTML!=null))throw Error(m(137,f));if(y.dangerouslySetInnerHTML!=null){if(y.children!=null)throw Error(m(60));if(typeof y.dangerouslySetInnerHTML!="object"||!("__html"in y.dangerouslySetInnerHTML))throw Error(m(61))}if(y.style!=null&&typeof y.style!="object")throw Error(m(62))}}function Ca(f,y){if(f.indexOf("-")===-1)return typeof y.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var or=null;function qa(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Wl=null,Ls=null,Zl=null;function Sh(f){if(f=$h(f)){if(typeof Wl!="function")throw Error(m(280));var y=f.stateNode;y&&(y=Qc(y),Wl(f.stateNode,f.type,y))}}function Kl(f){Ls?Zl?Zl.push(f):Zl=[f]:Ls=f}function Wt(){if(Ls){var f=Ls,y=Zl;if(Zl=Ls=null,Sh(f),y)for(f=0;f<y.length;f++)Sh(y[f])}}function Ha(f,y){return f(y)}function Td(){}var Rc=!1;function Ei(f,y,A){if(Rc)return f(y,A);Rc=!0;try{return Ha(f,y,A)}finally{Rc=!1,(Ls!==null||Zl!==null)&&(Td(),Wt())}}function it(f,y){var A=f.stateNode;if(A===null)return null;var D=Qc(A);if(D===null)return null;A=D[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(D=!D.disabled)||(f=f.type,D=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!D;break e;default:f=!1}if(f)return null;if(A&&typeof A!="function")throw Error(m(231,y,typeof A));return A}var te=!1;if(r)try{var oe={};Object.defineProperty(oe,"passive",{get:function(){te=!0}}),window.addEventListener("test",oe,oe),window.removeEventListener("test",oe,oe)}catch{te=!1}function xe(f,y,A,D,H,Q,be,Ye,ot){var Bt=Array.prototype.slice.call(arguments,3);try{y.apply(A,Bt)}catch(mn){this.onError(mn)}}var ze=!1,Ce=null,He=!1,Je=null,Ue={onError:function(f){ze=!0,Ce=f}};function tt(f,y,A,D,H,Q,be,Ye,ot){ze=!1,Ce=null,xe.apply(Ue,arguments)}function bt(f,y,A,D,H,Q,be,Ye,ot){if(tt.apply(this,arguments),ze){if(ze){var Bt=Ce;ze=!1,Ce=null}else throw Error(m(198));He||(He=!0,Je=Bt)}}function rt(f){var y=f,A=f;if(f.alternate)for(;y.return;)y=y.return;else{f=y;do y=f,(y.flags&4098)!==0&&(A=y.return),f=y.return;while(f)}return y.tag===3?A:null}function Gt(f){if(f.tag===13){var y=f.memoizedState;if(y===null&&(f=f.alternate,f!==null&&(y=f.memoizedState)),y!==null)return y.dehydrated}return null}function an(f){if(rt(f)!==f)throw Error(m(188))}function hn(f){var y=f.alternate;if(!y){if(y=rt(f),y===null)throw Error(m(188));return y!==f?null:f}for(var A=f,D=y;;){var H=A.return;if(H===null)break;var Q=H.alternate;if(Q===null){if(D=H.return,D!==null){A=D;continue}break}if(H.child===Q.child){for(Q=H.child;Q;){if(Q===A)return an(H),f;if(Q===D)return an(H),y;Q=Q.sibling}throw Error(m(188))}if(A.return!==D.return)A=H,D=Q;else{for(var be=!1,Ye=H.child;Ye;){if(Ye===A){be=!0,A=H,D=Q;break}if(Ye===D){be=!0,D=H,A=Q;break}Ye=Ye.sibling}if(!be){for(Ye=Q.child;Ye;){if(Ye===A){be=!0,A=Q,D=H;break}if(Ye===D){be=!0,D=Q,A=H;break}Ye=Ye.sibling}if(!be)throw Error(m(189))}}if(A.alternate!==D)throw Error(m(190))}if(A.tag!==3)throw Error(m(188));return A.stateNode.current===A?f:y}function Rn(f){return f=hn(f),f!==null?Ln(f):null}function Ln(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var y=Ln(f);if(y!==null)return y;f=f.sibling}return null}var On=l.unstable_scheduleCallback,ni=l.unstable_cancelCallback,Un=l.unstable_shouldYield,Ki=l.unstable_requestPaint,fi=l.unstable_now,pr=l.unstable_getCurrentPriorityLevel,Li=l.unstable_ImmediatePriority,Ii=l.unstable_UserBlockingPriority,kr=l.unstable_NormalPriority,Lr=l.unstable_LowPriority,Sr=l.unstable_IdlePriority,ds=null,ls=null;function so(f){if(ls&&typeof ls.onCommitFiberRoot=="function")try{ls.onCommitFiberRoot(ds,f,void 0,(f.current.flags&128)===128)}catch{}}var Ao=Math.clz32?Math.clz32:Sd,Ds=Math.log,Xl=Math.LN2;function Sd(f){return f>>>=0,f===0?32:31-(Ds(f)/Xl|0)|0}var Yl=64,Ql=4194304;function Jl(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function zc(f,y){var A=f.pendingLanes;if(A===0)return 0;var D=0,H=f.suspendedLanes,Q=f.pingedLanes,be=A&268435455;if(be!==0){var Ye=be&~H;Ye!==0?D=Jl(Ye):(Q&=be,Q!==0&&(D=Jl(Q)))}else be=A&~H,be!==0?D=Jl(be):Q!==0&&(D=Jl(Q));if(D===0)return 0;if(y!==0&&y!==D&&(y&H)===0&&(H=D&-D,Q=y&-y,H>=Q||H===16&&(Q&4194240)!==0))return y;if((D&4)!==0&&(D|=A&16),y=f.entangledLanes,y!==0)for(f=f.entanglements,y&=D;0<y;)A=31-Ao(y),H=1<<A,D|=f[A],y&=~H;return D}function Lc(f,y){switch(f){case 1:case 2:case 4:return y+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ch(f,y){for(var A=f.suspendedLanes,D=f.pingedLanes,H=f.expirationTimes,Q=f.pendingLanes;0<Q;){var be=31-Ao(Q),Ye=1<<be,ot=H[be];ot===-1?((Ye&A)===0||(Ye&D)!==0)&&(H[be]=Lc(Ye,y)):ot<=y&&(f.expiredLanes|=Ye),Q&=~Ye}}function Cu(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function fa(){var f=Yl;return Yl<<=1,(Yl&4194240)===0&&(Yl=64),f}function Io(f){for(var y=[],A=0;31>A;A++)y.push(f);return y}function po(f,y,A){f.pendingLanes|=y,y!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,y=31-Ao(y),f[y]=A}function _l(f,y){var A=f.pendingLanes&~y;f.pendingLanes=y,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=y,f.mutableReadLanes&=y,f.entangledLanes&=y,y=f.entanglements;var D=f.eventTimes;for(f=f.expirationTimes;0<A;){var H=31-Ao(A),Q=1<<H;y[H]=0,D[H]=-1,f[H]=-1,A&=~Q}}function ia(f,y){var A=f.entangledLanes|=y;for(f=f.entanglements;A;){var D=31-Ao(A),H=1<<D;H&y|f[D]&y&&(f[D]|=y),A&=~H}}var ar=0;function Eu(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var Ea,Dc,ec,Oc,Cd,Eh=!1,Zs=[],No=null,ma=null,ra=null,Au=new Map,Iu=new Map,ga=[],wi="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ah(f,y){switch(f){case"focusin":case"focusout":No=null;break;case"dragenter":case"dragleave":ma=null;break;case"mouseover":case"mouseout":ra=null;break;case"pointerover":case"pointerout":Au.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":Iu.delete(y.pointerId)}}function Ua(f,y,A,D,H,Q){return f===null||f.nativeEvent!==Q?(f={blockedOn:y,domEventName:A,eventSystemFlags:D,nativeEvent:Q,targetContainers:[H]},y!==null&&(y=$h(y),y!==null&&Dc(y)),f):(f.eventSystemFlags|=D,y=f.targetContainers,H!==null&&y.indexOf(H)===-1&&y.push(H),f)}function Ih(f,y,A,D,H){switch(y){case"focusin":return No=Ua(No,f,y,A,D,H),!0;case"dragenter":return ma=Ua(ma,f,y,A,D,H),!0;case"mouseover":return ra=Ua(ra,f,y,A,D,H),!0;case"pointerover":var Q=H.pointerId;return Au.set(Q,Ua(Au.get(Q)||null,f,y,A,D,H)),!0;case"gotpointercapture":return Q=H.pointerId,Iu.set(Q,Ua(Iu.get(Q)||null,f,y,A,D,H)),!0}return!1}function Rf(f){var y=Yc(f.target);if(y!==null){var A=rt(y);if(A!==null){if(y=A.tag,y===13){if(y=Gt(A),y!==null){f.blockedOn=y,Cd(f.priority,function(){ec(A)});return}}else if(y===3&&A.stateNode.current.memoizedState.isDehydrated){f.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}f.blockedOn=null}function tc(f){if(f.blockedOn!==null)return!1;for(var y=f.targetContainers;0<y.length;){var A=jc(f.domEventName,f.eventSystemFlags,y[0],f.nativeEvent);if(A===null){A=f.nativeEvent;var D=new A.constructor(A.type,A);or=D,A.target.dispatchEvent(D),or=null}else return y=$h(A),y!==null&&Dc(y),f.blockedOn=A,!1;y.shift()}return!0}function nc(f,y,A){tc(f)&&A.delete(y)}function ic(){Eh=!1,No!==null&&tc(No)&&(No=null),ma!==null&&tc(ma)&&(ma=null),ra!==null&&tc(ra)&&(ra=null),Au.forEach(nc),Iu.forEach(nc)}function Bc(f,y){f.blockedOn===y&&(f.blockedOn=null,Eh||(Eh=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,ic)))}function Fc(f){function y(H){return Bc(H,f)}if(0<Zs.length){Bc(Zs[0],f);for(var A=1;A<Zs.length;A++){var D=Zs[A];D.blockedOn===f&&(D.blockedOn=null)}}for(No!==null&&Bc(No,f),ma!==null&&Bc(ma,f),ra!==null&&Bc(ra,f),Au.forEach(y),Iu.forEach(y),A=0;A<ga.length;A++)D=ga[A],D.blockedOn===f&&(D.blockedOn=null);for(;0<ga.length&&(A=ga[0],A.blockedOn===null);)Rf(A),A.blockedOn===null&&ga.shift()}var _a=Le.ReactCurrentBatchConfig,Ph=!0;function yl(f,y,A,D){var H=ar,Q=_a.transition;_a.transition=null;try{ar=1,Pu(f,y,A,D)}finally{ar=H,_a.transition=Q}}function Ed(f,y,A,D){var H=ar,Q=_a.transition;_a.transition=null;try{ar=4,Pu(f,y,A,D)}finally{ar=H,_a.transition=Q}}function Pu(f,y,A,D){if(Ph){var H=jc(f,y,A,D);if(H===null)Od(f,y,D,Vo,A),Ah(f,D);else if(Ih(H,f,y,A,D))D.stopPropagation();else if(Ah(f,D),y&4&&-1<wi.indexOf(f)){for(;H!==null;){var Q=$h(H);if(Q!==null&&Ea(Q),Q=jc(f,y,A,D),Q===null&&Od(f,y,D,Vo,A),Q===H)break;H=Q}H!==null&&D.stopPropagation()}else Od(f,y,D,null,A)}}var Vo=null;function jc(f,y,A,D){if(Vo=null,f=qa(D),f=Yc(f),f!==null)if(y=rt(f),y===null)f=null;else if(A=y.tag,A===13){if(f=Gt(y),f!==null)return f;f=null}else if(A===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;f=null}else y!==f&&(f=null);return Vo=f,null}function rc(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pr()){case Li:return 1;case Ii:return 4;case kr:case Lr:return 16;case Sr:return 536870912;default:return 16}default:return 16}}var Aa=null,kh=null,Nc=null;function sc(){if(Nc)return Nc;var f,y=kh,A=y.length,D,H="value"in Aa?Aa.value:Aa.textContent,Q=H.length;for(f=0;f<A&&y[f]===H[f];f++);var be=A-f;for(D=1;D<=be&&y[A-D]===H[Q-D];D++);return Nc=H.slice(f,1<D?1-D:void 0)}function oo(f){var y=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&y===13&&(f=13)):f=y,f===10&&(f=13),32<=f||f===13?f:0}function ku(){return!0}function Vc(){return!1}function Os(f){function y(A,D,H,Q,be){this._reactName=A,this._targetInst=H,this.type=D,this.nativeEvent=Q,this.target=be,this.currentTarget=null;for(var Ye in f)f.hasOwnProperty(Ye)&&(A=f[Ye],this[Ye]=A?A(Q):Q[Ye]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?ku:Vc,this.isPropagationStopped=Vc,this}return qt(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=ku)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=ku)},persist:function(){},isPersistent:ku}),y}var Ti={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sa=Os(Ti),Mh=qt({},Ti,{view:0,detail:0}),Pp=Os(Mh),Cn,Mu,vl,$a=qt({},Mh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oc,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==vl&&(vl&&f.type==="mousemove"?(Cn=f.screenX-vl.screenX,Mu=f.screenY-vl.screenY):Mu=Cn=0,vl=f),Cn)},movementY:function(f){return"movementY"in f?f.movementY:Mu}}),qo=Os($a),kp=qt({},$a,{dataTransfer:0}),Ru=Os(kp),pn=qt({},Mh,{relatedTarget:0}),Bi=Os(pn),Di=qt({},Ti,{animationName:0,elapsedTime:0,pseudoElement:0}),Ho=Os(Di),xl=qt({},Ti,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),Fi=Os(xl),Ad=qt({},Ti,{data:0}),zu=Os(Ad),Rh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vm(f){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(f):(f=cs[f])?!!y[f]:!1}function oc(){return Vm}var ac=qt({},Mh,{key:function(f){if(f.key){var y=Rh[f.key]||f.key;if(y!=="Unidentified")return y}return f.type==="keypress"?(f=oo(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?fo[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oc,charCode:function(f){return f.type==="keypress"?oo(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?oo(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),zh=Os(ac),Id=qt({},$a,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lu=Os(Id),Pd=qt({},Mh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oc}),mo=Os(Pd),bl=qt({},Ti,{propertyName:0,elapsedTime:0,pseudoElement:0}),Po=Os(bl),qc=qt({},$a,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),ii=Os(qc),sn=[9,13,27,32],Uo=r&&"CompositionEvent"in window,In=null;r&&"documentMode"in document&&(In=document.documentMode);var rs=r&&"TextEvent"in window&&!In,Du=r&&(!Uo||In&&8<In&&11>=In),Sn=" ",Hc=!1;function Uc(f,y){switch(f){case"keyup":return sn.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wl(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var $c=!1;function ya(f,y){switch(f){case"compositionend":return wl(y);case"keypress":return y.which!==32?null:(Hc=!0,Sn);case"textInput":return f=y.data,f===Sn&&Hc?null:f;default:return null}}function go(f,y){if($c)return f==="compositionend"||!Uo&&Uc(f,y)?(f=sc(),Nc=kh=Aa=null,$c=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return Du&&y.locale!=="ko"?null:y.data;default:return null}}var Lh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vs(f){var y=f&&f.nodeName&&f.nodeName.toLowerCase();return y==="input"?!!Lh[f.type]:y==="textarea"}function kd(f,y,A,D){Kl(D),y=Xc(y,"onChange"),0<y.length&&(A=new sa("onChange","change",null,A,D),f.push({event:A,listeners:y}))}var $o=null,xs=null;function Dh(f){Lp(f,0)}function Md(f){var y=fc(f);if(Yi(y))return f}function qm(f,y){if(f==="change")return y}var Tl=!1;if(r){var lc;if(r){var Sl="oninput"in document;if(!Sl){var Gc=document.createElement("div");Gc.setAttribute("oninput","return;"),Sl=typeof Gc.oninput=="function"}lc=Sl}else lc=!1;Tl=lc&&(!document.documentMode||9<document.documentMode)}function Mp(){$o&&($o.detachEvent("onpropertychange",Oh),xs=$o=null)}function Oh(f){if(f.propertyName==="value"&&Md(xs)){var y=[];kd(y,xs,f,qa(f)),Ei(Dh,y)}}function Rp(f,y,A){f==="focusin"?(Mp(),$o=y,xs=A,$o.attachEvent("onpropertychange",Oh)):f==="focusout"&&Mp()}function Cl(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return Md(xs)}function Hm(f,y){if(f==="click")return Md(y)}function Um(f,y){if(f==="input"||f==="change")return Md(y)}function zf(f,y){return f===y&&(f!==0||1/f===1/y)||f!==f&&y!==y}var va=typeof Object.is=="function"?Object.is:zf;function Ia(f,y){if(va(f,y))return!0;if(typeof f!="object"||f===null||typeof y!="object"||y===null)return!1;var A=Object.keys(f),D=Object.keys(y);if(A.length!==D.length)return!1;for(D=0;D<A.length;D++){var H=A[D];if(!O.call(y,H)||!va(f[H],y[H]))return!1}return!0}function Rd(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function zp(f,y){var A=Rd(f);f=0;for(var D;A;){if(A.nodeType===3){if(D=f+A.textContent.length,f<=y&&D>=y)return{node:A,offset:y-f};f=D}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=Rd(A)}}function Bh(f,y){return f&&y?f===y?!0:f&&f.nodeType===3?!1:y&&y.nodeType===3?Bh(f,y.parentNode):"contains"in f?f.contains(y):f.compareDocumentPosition?!!(f.compareDocumentPosition(y)&16):!1:!1}function zd(){for(var f=window,y=Vn();y instanceof f.HTMLIFrameElement;){try{var A=typeof y.contentWindow.location.href=="string"}catch{A=!1}if(A)f=y.contentWindow;else break;y=Vn(f.document)}return y}function Fh(f){var y=f&&f.nodeName&&f.nodeName.toLowerCase();return y&&(y==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||y==="textarea"||f.contentEditable==="true")}function ao(f){var y=zd(),A=f.focusedElem,D=f.selectionRange;if(y!==A&&A&&A.ownerDocument&&Bh(A.ownerDocument.documentElement,A)){if(D!==null&&Fh(A)){if(y=D.start,f=D.end,f===void 0&&(f=y),"selectionStart"in A)A.selectionStart=y,A.selectionEnd=Math.min(f,A.value.length);else if(f=(y=A.ownerDocument||document)&&y.defaultView||window,f.getSelection){f=f.getSelection();var H=A.textContent.length,Q=Math.min(D.start,H);D=D.end===void 0?Q:Math.min(D.end,H),!f.extend&&Q>D&&(H=D,D=Q,Q=H),H=zp(A,Q);var be=zp(A,D);H&&be&&(f.rangeCount!==1||f.anchorNode!==H.node||f.anchorOffset!==H.offset||f.focusNode!==be.node||f.focusOffset!==be.offset)&&(y=y.createRange(),y.setStart(H.node,H.offset),f.removeAllRanges(),Q>D?(f.addRange(y),f.extend(be.node,be.offset)):(y.setEnd(be.node,be.offset),f.addRange(y)))}}for(y=[],f=A;f=f.parentNode;)f.nodeType===1&&y.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<y.length;A++)f=y[A],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var jh=r&&"documentMode"in document&&11>=document.documentMode,cc=null,Nh=null,Ga=null,uc=!1;function Ld(f,y,A){var D=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;uc||cc==null||cc!==Vn(D)||(D=cc,"selectionStart"in D&&Fh(D)?D={start:D.selectionStart,end:D.selectionEnd}:(D=(D.ownerDocument&&D.ownerDocument.defaultView||window).getSelection(),D={anchorNode:D.anchorNode,anchorOffset:D.anchorOffset,focusNode:D.focusNode,focusOffset:D.focusOffset}),Ga&&Ia(Ga,D)||(Ga=D,D=Xc(Nh,"onSelect"),0<D.length&&(y=new sa("onSelect","select",null,y,A),f.push({event:y,listeners:D}),y.target=cc)))}function Wc(f,y){var A={};return A[f.toLowerCase()]=y.toLowerCase(),A["Webkit"+f]="webkit"+y,A["Moz"+f]="moz"+y,A}var Ks={animationend:Wc("Animation","AnimationEnd"),animationiteration:Wc("Animation","AnimationIteration"),animationstart:Wc("Animation","AnimationStart"),transitionend:Wc("Transition","TransitionEnd")},Ou={},Kt={};r&&(Kt=document.createElement("div").style,"AnimationEvent"in window||(delete Ks.animationend.animation,delete Ks.animationiteration.animation,delete Ks.animationstart.animation),"TransitionEvent"in window||delete Ks.transitionend.transition);function Bu(f){if(Ou[f])return Ou[f];if(!Ks[f])return f;var y=Ks[f],A;for(A in y)if(y.hasOwnProperty(A)&&A in Kt)return Ou[f]=y[A];return f}var Zc=Bu("animationend"),Kc=Bu("animationiteration"),Fu=Bu("animationstart"),ju=Bu("transitionend"),Pa=new Map,Vh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bs(f,y){Pa.set(f,y),C(y,[f])}for(var di=0;di<Vh.length;di++){var hc=Vh[di],$m=hc.toLowerCase(),Gm=hc[0].toUpperCase()+hc.slice(1);Bs($m,"on"+Gm)}Bs(Zc,"onAnimationEnd"),Bs(Kc,"onAnimationIteration"),Bs(Fu,"onAnimationStart"),Bs("dblclick","onDoubleClick"),Bs("focusin","onFocus"),Bs("focusout","onBlur"),Bs(ju,"onTransitionEnd"),M("onMouseEnter",["mouseout","mouseover"]),M("onMouseLeave",["mouseout","mouseover"]),M("onPointerEnter",["pointerout","pointerover"]),M("onPointerLeave",["pointerout","pointerover"]),C("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),C("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),C("onBeforeInput",["compositionend","keypress","textInput","paste"]),C("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),C("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),C("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wm=new Set("cancel close invalid load scroll toggle".split(" ").concat(dc));function Cr(f,y,A){var D=f.type||"unknown-event";f.currentTarget=A,bt(D,y,void 0,f),f.currentTarget=null}function Lp(f,y){y=(y&4)!==0;for(var A=0;A<f.length;A++){var D=f[A],H=D.event;D=D.listeners;e:{var Q=void 0;if(y)for(var be=D.length-1;0<=be;be--){var Ye=D[be],ot=Ye.instance,Bt=Ye.currentTarget;if(Ye=Ye.listener,ot!==Q&&H.isPropagationStopped())break e;Cr(H,Ye,Bt),Q=ot}else for(be=0;be<D.length;be++){if(Ye=D[be],ot=Ye.instance,Bt=Ye.currentTarget,Ye=Ye.listener,ot!==Q&&H.isPropagationStopped())break e;Cr(H,Ye,Bt),Q=ot}}}if(He)throw f=Je,He=!1,Je=null,f}function Zr(f,y){var A=y[Ya];A===void 0&&(A=y[Ya]=new Set);var D=f+"__bubble";A.has(D)||(Lf(y,f,2,!1),A.add(D))}function Dp(f,y,A){var D=0;y&&(D|=4),Lf(A,f,D,y)}var Dd="_reactListening"+Math.random().toString(36).slice(2);function qh(f){if(!f[Dd]){f[Dd]=!0,_.forEach(function(A){A!=="selectionchange"&&(Wm.has(A)||Dp(A,!1,f),Dp(A,!0,f))});var y=f.nodeType===9?f:f.ownerDocument;y===null||y[Dd]||(y[Dd]=!0,Dp("selectionchange",!1,y))}}function Lf(f,y,A,D){switch(rc(y)){case 1:var H=yl;break;case 4:H=Ed;break;default:H=Pu}A=H.bind(null,y,A,f),H=void 0,!te||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(H=!0),D?H!==void 0?f.addEventListener(y,A,{capture:!0,passive:H}):f.addEventListener(y,A,!0):H!==void 0?f.addEventListener(y,A,{passive:H}):f.addEventListener(y,A,!1)}function Od(f,y,A,D,H){var Q=D;if((y&1)===0&&(y&2)===0&&D!==null)e:for(;;){if(D===null)return;var be=D.tag;if(be===3||be===4){var Ye=D.stateNode.containerInfo;if(Ye===H||Ye.nodeType===8&&Ye.parentNode===H)break;if(be===4)for(be=D.return;be!==null;){var ot=be.tag;if((ot===3||ot===4)&&(ot=be.stateNode.containerInfo,ot===H||ot.nodeType===8&&ot.parentNode===H))return;be=be.return}for(;Ye!==null;){if(be=Yc(Ye),be===null)return;if(ot=be.tag,ot===5||ot===6){D=Q=be;continue e}Ye=Ye.parentNode}}D=D.return}Ei(function(){var Bt=Q,mn=qa(A),gn=[];e:{var dn=Pa.get(f);if(dn!==void 0){var jn=sa,Kn=f;switch(f){case"keypress":if(oo(A)===0)break e;case"keydown":case"keyup":jn=zh;break;case"focusin":Kn="focus",jn=Bi;break;case"focusout":Kn="blur",jn=Bi;break;case"beforeblur":case"afterblur":jn=Bi;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":jn=qo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":jn=Ru;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":jn=mo;break;case Zc:case Kc:case Fu:jn=Ho;break;case ju:jn=Po;break;case"scroll":jn=Pp;break;case"wheel":jn=ii;break;case"copy":case"cut":case"paste":jn=Fi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":jn=Lu}var ei=(y&4)!==0,Ms=!ei&&f==="scroll",It=ei?dn!==null?dn+"Capture":null:dn;ei=[];for(var vt=Bt,zt;vt!==null;){zt=vt;var Tn=zt.stateNode;if(zt.tag===5&&Tn!==null&&(zt=Tn,It!==null&&(Tn=it(vt,It),Tn!=null&&ei.push(Hh(vt,Tn,zt)))),Ms)break;vt=vt.return}0<ei.length&&(dn=new jn(dn,Kn,null,A,mn),gn.push({event:dn,listeners:ei}))}}if((y&7)===0){e:{if(dn=f==="mouseover"||f==="pointerover",jn=f==="mouseout"||f==="pointerout",dn&&A!==or&&(Kn=A.relatedTarget||A.fromElement)&&(Yc(Kn)||Kn[Xa]))break e;if((jn||dn)&&(dn=mn.window===mn?mn:(dn=mn.ownerDocument)?dn.defaultView||dn.parentWindow:window,jn?(Kn=A.relatedTarget||A.toElement,jn=Bt,Kn=Kn?Yc(Kn):null,Kn!==null&&(Ms=rt(Kn),Kn!==Ms||Kn.tag!==5&&Kn.tag!==6)&&(Kn=null)):(jn=null,Kn=Bt),jn!==Kn)){if(ei=qo,Tn="onMouseLeave",It="onMouseEnter",vt="mouse",(f==="pointerout"||f==="pointerover")&&(ei=Lu,Tn="onPointerLeave",It="onPointerEnter",vt="pointer"),Ms=jn==null?dn:fc(jn),zt=Kn==null?dn:fc(Kn),dn=new ei(Tn,vt+"leave",jn,A,mn),dn.target=Ms,dn.relatedTarget=zt,Tn=null,Yc(mn)===Bt&&(ei=new ei(It,vt+"enter",Kn,A,mn),ei.target=zt,ei.relatedTarget=Ms,Tn=ei),Ms=Tn,jn&&Kn)t:{for(ei=jn,It=Kn,vt=0,zt=ei;zt;zt=Nu(zt))vt++;for(zt=0,Tn=It;Tn;Tn=Nu(Tn))zt++;for(;0<vt-zt;)ei=Nu(ei),vt--;for(;0<zt-vt;)It=Nu(It),zt--;for(;vt--;){if(ei===It||It!==null&&ei===It.alternate)break t;ei=Nu(ei),It=Nu(It)}ei=null}else ei=null;jn!==null&&Op(gn,dn,jn,ei,!1),Kn!==null&&Ms!==null&&Op(gn,Ms,Kn,ei,!0)}}e:{if(dn=Bt?fc(Bt):window,jn=dn.nodeName&&dn.nodeName.toLowerCase(),jn==="select"||jn==="input"&&dn.type==="file")var ui=qm;else if(vs(dn))if(Tl)ui=Um;else{ui=Cl;var pi=Rp}else(jn=dn.nodeName)&&jn.toLowerCase()==="input"&&(dn.type==="checkbox"||dn.type==="radio")&&(ui=Hm);if(ui&&(ui=ui(f,Bt))){kd(gn,ui,A,mn);break e}pi&&pi(f,dn,Bt),f==="focusout"&&(pi=dn._wrapperState)&&pi.controlled&&dn.type==="number"&&zr(dn,"number",dn.value)}switch(pi=Bt?fc(Bt):window,f){case"focusin":(vs(pi)||pi.contentEditable==="true")&&(cc=pi,Nh=Bt,Ga=null);break;case"focusout":Ga=Nh=cc=null;break;case"mousedown":uc=!0;break;case"contextmenu":case"mouseup":case"dragend":uc=!1,Ld(gn,A,mn);break;case"selectionchange":if(jh)break;case"keydown":case"keyup":Ld(gn,A,mn)}var bi;if(Uo)e:{switch(f){case"compositionstart":var Ri="onCompositionStart";break e;case"compositionend":Ri="onCompositionEnd";break e;case"compositionupdate":Ri="onCompositionUpdate";break e}Ri=void 0}else $c?Uc(f,A)&&(Ri="onCompositionEnd"):f==="keydown"&&A.keyCode===229&&(Ri="onCompositionStart");Ri&&(Du&&A.locale!=="ko"&&($c||Ri!=="onCompositionStart"?Ri==="onCompositionEnd"&&$c&&(bi=sc()):(Aa=mn,kh="value"in Aa?Aa.value:Aa.textContent,$c=!0)),pi=Xc(Bt,Ri),0<pi.length&&(Ri=new zu(Ri,f,null,A,mn),gn.push({event:Ri,listeners:pi}),bi?Ri.data=bi:(bi=wl(A),bi!==null&&(Ri.data=bi)))),(bi=rs?ya(f,A):go(f,A))&&(Bt=Xc(Bt,"onBeforeInput"),0<Bt.length&&(mn=new zu("onBeforeInput","beforeinput",null,A,mn),gn.push({event:mn,listeners:Bt}),mn.data=bi))}Lp(gn,y)})}function Hh(f,y,A){return{instance:f,listener:y,currentTarget:A}}function Xc(f,y){for(var A=y+"Capture",D=[];f!==null;){var H=f,Q=H.stateNode;H.tag===5&&Q!==null&&(H=Q,Q=it(f,A),Q!=null&&D.unshift(Hh(f,Q,H)),Q=it(f,y),Q!=null&&D.push(Hh(f,Q,H))),f=f.return}return D}function Nu(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function Op(f,y,A,D,H){for(var Q=y._reactName,be=[];A!==null&&A!==D;){var Ye=A,ot=Ye.alternate,Bt=Ye.stateNode;if(ot!==null&&ot===D)break;Ye.tag===5&&Bt!==null&&(Ye=Bt,H?(ot=it(A,Q),ot!=null&&be.unshift(Hh(A,ot,Ye))):H||(ot=it(A,Q),ot!=null&&be.push(Hh(A,ot,Ye)))),A=A.return}be.length!==0&&f.push({event:y,listeners:be})}var Bp=/\r\n?/g,Bd=/\u0000|\uFFFD/g;function Fd(f){return(typeof f=="string"?f:""+f).replace(Bp,`
`).replace(Bd,"")}function Wa(f,y,A){if(y=Fd(y),Fd(f)!==y&&A)throw Error(m(425))}function El(){}var Vu=null,qu=null;function pc(f,y){return f==="textarea"||f==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var jd=typeof setTimeout=="function"?setTimeout:void 0,Fp=typeof clearTimeout=="function"?clearTimeout:void 0,jp=typeof Promise=="function"?Promise:void 0,Hu=typeof queueMicrotask=="function"?queueMicrotask:typeof jp<"u"?function(f){return jp.resolve(null).then(f).catch(Nd)}:jd;function Nd(f){setTimeout(function(){throw f})}function Uu(f,y){var A=y,D=0;do{var H=A.nextSibling;if(f.removeChild(A),H&&H.nodeType===8)if(A=H.data,A==="/$"){if(D===0){f.removeChild(H),Fc(y);return}D--}else A!=="$"&&A!=="$?"&&A!=="$!"||D++;A=H}while(A);Fc(y)}function Za(f){for(;f!=null;f=f.nextSibling){var y=f.nodeType;if(y===1||y===3)break;if(y===8){if(y=f.data,y==="$"||y==="$!"||y==="$?")break;if(y==="/$")return null}}return f}function Uh(f){f=f.previousSibling;for(var y=0;f;){if(f.nodeType===8){var A=f.data;if(A==="$"||A==="$!"||A==="$?"){if(y===0)return f;y--}else A==="/$"&&y++}f=f.previousSibling}return null}var Ka=Math.random().toString(36).slice(2),ka="__reactFiber$"+Ka,$u="__reactProps$"+Ka,Xa="__reactContainer$"+Ka,Ya="__reactEvents$"+Ka,Df="__reactListeners$"+Ka,Of="__reactHandles$"+Ka;function Yc(f){var y=f[ka];if(y)return y;for(var A=f.parentNode;A;){if(y=A[Xa]||A[ka]){if(A=y.alternate,y.child!==null||A!==null&&A.child!==null)for(f=Uh(f);f!==null;){if(A=f[ka])return A;f=Uh(f)}return y}f=A,A=f.parentNode}return null}function $h(f){return f=f[ka]||f[Xa],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function fc(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(m(33))}function Qc(f){return f[$u]||null}var Gu=[],oa=-1;function Qa(f){return{current:f}}function Kr(f){0>oa||(f.current=Gu[oa],Gu[oa]=null,oa--)}function es(f,y){oa++,Gu[oa]=f.current,f.current=y}var Go={},fs=Qa(Go),ko=Qa(!1),Fs=Go;function Al(f,y){var A=f.type.contextTypes;if(!A)return Go;var D=f.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===y)return D.__reactInternalMemoizedMaskedChildContext;var H={},Q;for(Q in A)H[Q]=y[Q];return D&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=y,f.__reactInternalMemoizedMaskedChildContext=H),H}function Xs(f){return f=f.childContextTypes,f!=null}function Jc(){Kr(ko),Kr(fs)}function Vd(f,y,A){if(fs.current!==Go)throw Error(m(168));es(fs,y),es(ko,A)}function qd(f,y,A){var D=f.stateNode;if(y=y.childContextTypes,typeof D.getChildContext!="function")return A;D=D.getChildContext();for(var H in D)if(!(H in y))throw Error(m(108,ti(f)||"Unknown",H));return qt({},A,D)}function eu(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||Go,Fs=fs.current,es(fs,f),es(ko,ko.current),!0}function Wu(f,y,A){var D=f.stateNode;if(!D)throw Error(m(169));A?(f=qd(f,y,Fs),D.__reactInternalMemoizedMergedChildContext=f,Kr(ko),Kr(fs),es(fs,f)):Kr(ko),es(ko,A)}var Wo=null,Zu=!1,tu=!1;function Np(f){Wo===null?Wo=[f]:Wo.push(f)}function Bf(f){Zu=!0,Np(f)}function Zo(){if(!tu&&Wo!==null){tu=!0;var f=0,y=ar;try{var A=Wo;for(ar=1;f<A.length;f++){var D=A[f];do D=D(!0);while(D!==null)}Wo=null,Zu=!1}catch(H){throw Wo!==null&&(Wo=Wo.slice(f+1)),On(Li,Zo),H}finally{ar=y,tu=!1}}return null}var nu=[],Ku=0,Hd=null,Ud=0,Mo=[],xa=0,Ja=null,Ma=1,el="";function aa(f,y){nu[Ku++]=Ud,nu[Ku++]=Hd,Hd=f,Ud=y}function $d(f,y,A){Mo[xa++]=Ma,Mo[xa++]=el,Mo[xa++]=Ja,Ja=f;var D=Ma;f=el;var H=32-Ao(D)-1;D&=~(1<<H),A+=1;var Q=32-Ao(y)+H;if(30<Q){var be=H-H%5;Q=(D&(1<<be)-1).toString(32),D>>=be,H-=be,Ma=1<<32-Ao(y)+H|A<<H|D,el=Q+f}else Ma=1<<Q|A<<H|D,el=f}function Gh(f){f.return!==null&&(aa(f,1),$d(f,1,0))}function Gd(f){for(;f===Hd;)Hd=nu[--Ku],nu[Ku]=null,Ud=nu[--Ku],nu[Ku]=null;for(;f===Ja;)Ja=Mo[--xa],Mo[xa]=null,el=Mo[--xa],Mo[xa]=null,Ma=Mo[--xa],Mo[xa]=null}var Es=null,js=null,ss=!1,Ys=null;function Wh(f,y){var A=ms(5,null,null,0);A.elementType="DELETED",A.stateNode=y,A.return=f,y=f.deletions,y===null?(f.deletions=[A],f.flags|=16):y.push(A)}function Xu(f,y){switch(f.tag){case 5:var A=f.type;return y=y.nodeType!==1||A.toLowerCase()!==y.nodeName.toLowerCase()?null:y,y!==null?(f.stateNode=y,Es=f,js=Za(y.firstChild),!0):!1;case 6:return y=f.pendingProps===""||y.nodeType!==3?null:y,y!==null?(f.stateNode=y,Es=f,js=null,!0):!1;case 13:return y=y.nodeType!==8?null:y,y!==null?(A=Ja!==null?{id:Ma,overflow:el}:null,f.memoizedState={dehydrated:y,treeContext:A,retryLane:1073741824},A=ms(18,null,null,0),A.stateNode=y,A.return=f,f.child=A,Es=f,js=null,!0):!1;default:return!1}}function Zh(f){return(f.mode&1)!==0&&(f.flags&128)===0}function Kh(f){if(ss){var y=js;if(y){var A=y;if(!Xu(f,y)){if(Zh(f))throw Error(m(418));y=Za(A.nextSibling);var D=Es;y&&Xu(f,y)?Wh(D,A):(f.flags=f.flags&-4097|2,ss=!1,Es=f)}}else{if(Zh(f))throw Error(m(418));f.flags=f.flags&-4097|2,ss=!1,Es=f}}}function Yu(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;Es=f}function mc(f){if(f!==Es)return!1;if(!ss)return Yu(f),ss=!0,!1;var y;if((y=f.tag!==3)&&!(y=f.tag!==5)&&(y=f.type,y=y!=="head"&&y!=="body"&&!pc(f.type,f.memoizedProps)),y&&(y=js)){if(Zh(f))throw Vp(),Error(m(418));for(;y;)Wh(f,y),y=Za(y.nextSibling)}if(Yu(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(m(317));e:{for(f=f.nextSibling,y=0;f;){if(f.nodeType===8){var A=f.data;if(A==="/$"){if(y===0){js=Za(f.nextSibling);break e}y--}else A!=="$"&&A!=="$!"&&A!=="$?"||y++}f=f.nextSibling}js=null}}else js=Es?Za(f.stateNode.nextSibling):null;return!0}function Vp(){for(var f=js;f;)f=Za(f.nextSibling)}function iu(){js=Es=null,ss=!1}function Ko(f){Ys===null?Ys=[f]:Ys.push(f)}var Zm=Le.ReactCurrentBatchConfig;function Xh(f,y,A){if(f=A.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(A._owner){if(A=A._owner,A){if(A.tag!==1)throw Error(m(309));var D=A.stateNode}if(!D)throw Error(m(147,f));var H=D,Q=""+f;return y!==null&&y.ref!==null&&typeof y.ref=="function"&&y.ref._stringRef===Q?y.ref:(y=function(be){var Ye=H.refs;be===null?delete Ye[Q]:Ye[Q]=be},y._stringRef=Q,y)}if(typeof f!="string")throw Error(m(284));if(!A._owner)throw Error(m(290,f))}return f}function Qu(f,y){throw f=Object.prototype.toString.call(y),Error(m(31,f==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":f))}function Ff(f){var y=f._init;return y(f._payload)}function ru(f){function y(It,vt){if(f){var zt=It.deletions;zt===null?(It.deletions=[vt],It.flags|=16):zt.push(vt)}}function A(It,vt){if(!f)return null;for(;vt!==null;)y(It,vt),vt=vt.sibling;return null}function D(It,vt){for(It=new Map;vt!==null;)vt.key!==null?It.set(vt.key,vt):It.set(vt.index,vt),vt=vt.sibling;return It}function H(It,vt){return It=Bo(It,vt),It.index=0,It.sibling=null,It}function Q(It,vt,zt){return It.index=zt,f?(zt=It.alternate,zt!==null?(zt=zt.index,zt<vt?(It.flags|=2,vt):zt):(It.flags|=2,vt)):(It.flags|=1048576,vt)}function be(It){return f&&It.alternate===null&&(It.flags|=2),It}function Ye(It,vt,zt,Tn){return vt===null||vt.tag!==6?(vt=pd(zt,It.mode,Tn),vt.return=It,vt):(vt=H(vt,zt),vt.return=It,vt)}function ot(It,vt,zt,Tn){var ui=zt.type;return ui===Ee?mn(It,vt,zt.props.children,Tn,zt.key):vt!==null&&(vt.elementType===ui||typeof ui=="object"&&ui!==null&&ui.$$typeof===Ct&&Ff(ui)===vt.type)?(Tn=H(vt,zt.props),Tn.ref=Xh(It,vt,zt),Tn.return=It,Tn):(Tn=Jo(zt.type,zt.key,zt.props,null,It.mode,Tn),Tn.ref=Xh(It,vt,zt),Tn.return=It,Tn)}function Bt(It,vt,zt,Tn){return vt===null||vt.tag!==4||vt.stateNode.containerInfo!==zt.containerInfo||vt.stateNode.implementation!==zt.implementation?(vt=Ec(zt,It.mode,Tn),vt.return=It,vt):(vt=H(vt,zt.children||[]),vt.return=It,vt)}function mn(It,vt,zt,Tn,ui){return vt===null||vt.tag!==7?(vt=ea(zt,It.mode,Tn,ui),vt.return=It,vt):(vt=H(vt,zt),vt.return=It,vt)}function gn(It,vt,zt){if(typeof vt=="string"&&vt!==""||typeof vt=="number")return vt=pd(""+vt,It.mode,zt),vt.return=It,vt;if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case De:return zt=Jo(vt.type,vt.key,vt.props,null,It.mode,zt),zt.ref=Xh(It,null,vt),zt.return=It,zt;case Oe:return vt=Ec(vt,It.mode,zt),vt.return=It,vt;case Ct:var Tn=vt._init;return gn(It,Tn(vt._payload),zt)}if(Or(vt)||kt(vt))return vt=ea(vt,It.mode,zt,null),vt.return=It,vt;Qu(It,vt)}return null}function dn(It,vt,zt,Tn){var ui=vt!==null?vt.key:null;if(typeof zt=="string"&&zt!==""||typeof zt=="number")return ui!==null?null:Ye(It,vt,""+zt,Tn);if(typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case De:return zt.key===ui?ot(It,vt,zt,Tn):null;case Oe:return zt.key===ui?Bt(It,vt,zt,Tn):null;case Ct:return ui=zt._init,dn(It,vt,ui(zt._payload),Tn)}if(Or(zt)||kt(zt))return ui!==null?null:mn(It,vt,zt,Tn,null);Qu(It,zt)}return null}function jn(It,vt,zt,Tn,ui){if(typeof Tn=="string"&&Tn!==""||typeof Tn=="number")return It=It.get(zt)||null,Ye(vt,It,""+Tn,ui);if(typeof Tn=="object"&&Tn!==null){switch(Tn.$$typeof){case De:return It=It.get(Tn.key===null?zt:Tn.key)||null,ot(vt,It,Tn,ui);case Oe:return It=It.get(Tn.key===null?zt:Tn.key)||null,Bt(vt,It,Tn,ui);case Ct:var pi=Tn._init;return jn(It,vt,zt,pi(Tn._payload),ui)}if(Or(Tn)||kt(Tn))return It=It.get(zt)||null,mn(vt,It,Tn,ui,null);Qu(vt,Tn)}return null}function Kn(It,vt,zt,Tn){for(var ui=null,pi=null,bi=vt,Ri=vt=0,lo=null;bi!==null&&Ri<zt.length;Ri++){bi.index>Ri?(lo=bi,bi=null):lo=bi.sibling;var Nr=dn(It,bi,zt[Ri],Tn);if(Nr===null){bi===null&&(bi=lo);break}f&&bi&&Nr.alternate===null&&y(It,bi),vt=Q(Nr,vt,Ri),pi===null?ui=Nr:pi.sibling=Nr,pi=Nr,bi=lo}if(Ri===zt.length)return A(It,bi),ss&&aa(It,Ri),ui;if(bi===null){for(;Ri<zt.length;Ri++)bi=gn(It,zt[Ri],Tn),bi!==null&&(vt=Q(bi,vt,Ri),pi===null?ui=bi:pi.sibling=bi,pi=bi);return ss&&aa(It,Ri),ui}for(bi=D(It,bi);Ri<zt.length;Ri++)lo=jn(bi,It,Ri,zt[Ri],Tn),lo!==null&&(f&&lo.alternate!==null&&bi.delete(lo.key===null?Ri:lo.key),vt=Q(lo,vt,Ri),pi===null?ui=lo:pi.sibling=lo,pi=lo);return f&&bi.forEach(function(ph){return y(It,ph)}),ss&&aa(It,Ri),ui}function ei(It,vt,zt,Tn){var ui=kt(zt);if(typeof ui!="function")throw Error(m(150));if(zt=ui.call(zt),zt==null)throw Error(m(151));for(var pi=ui=null,bi=vt,Ri=vt=0,lo=null,Nr=zt.next();bi!==null&&!Nr.done;Ri++,Nr=zt.next()){bi.index>Ri?(lo=bi,bi=null):lo=bi.sibling;var ph=dn(It,bi,Nr.value,Tn);if(ph===null){bi===null&&(bi=lo);break}f&&bi&&ph.alternate===null&&y(It,bi),vt=Q(ph,vt,Ri),pi===null?ui=ph:pi.sibling=ph,pi=ph,bi=lo}if(Nr.done)return A(It,bi),ss&&aa(It,Ri),ui;if(bi===null){for(;!Nr.done;Ri++,Nr=zt.next())Nr=gn(It,Nr.value,Tn),Nr!==null&&(vt=Q(Nr,vt,Ri),pi===null?ui=Nr:pi.sibling=Nr,pi=Nr);return ss&&aa(It,Ri),ui}for(bi=D(It,bi);!Nr.done;Ri++,Nr=zt.next())Nr=jn(bi,It,Ri,Nr.value,Tn),Nr!==null&&(f&&Nr.alternate!==null&&bi.delete(Nr.key===null?Ri:Nr.key),vt=Q(Nr,vt,Ri),pi===null?ui=Nr:pi.sibling=Nr,pi=Nr);return f&&bi.forEach(function(pv){return y(It,pv)}),ss&&aa(It,Ri),ui}function Ms(It,vt,zt,Tn){if(typeof zt=="object"&&zt!==null&&zt.type===Ee&&zt.key===null&&(zt=zt.props.children),typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case De:e:{for(var ui=zt.key,pi=vt;pi!==null;){if(pi.key===ui){if(ui=zt.type,ui===Ee){if(pi.tag===7){A(It,pi.sibling),vt=H(pi,zt.props.children),vt.return=It,It=vt;break e}}else if(pi.elementType===ui||typeof ui=="object"&&ui!==null&&ui.$$typeof===Ct&&Ff(ui)===pi.type){A(It,pi.sibling),vt=H(pi,zt.props),vt.ref=Xh(It,pi,zt),vt.return=It,It=vt;break e}A(It,pi);break}else y(It,pi);pi=pi.sibling}zt.type===Ee?(vt=ea(zt.props.children,It.mode,Tn,zt.key),vt.return=It,It=vt):(Tn=Jo(zt.type,zt.key,zt.props,null,It.mode,Tn),Tn.ref=Xh(It,vt,zt),Tn.return=It,It=Tn)}return be(It);case Oe:e:{for(pi=zt.key;vt!==null;){if(vt.key===pi)if(vt.tag===4&&vt.stateNode.containerInfo===zt.containerInfo&&vt.stateNode.implementation===zt.implementation){A(It,vt.sibling),vt=H(vt,zt.children||[]),vt.return=It,It=vt;break e}else{A(It,vt);break}else y(It,vt);vt=vt.sibling}vt=Ec(zt,It.mode,Tn),vt.return=It,It=vt}return be(It);case Ct:return pi=zt._init,Ms(It,vt,pi(zt._payload),Tn)}if(Or(zt))return Kn(It,vt,zt,Tn);if(kt(zt))return ei(It,vt,zt,Tn);Qu(It,zt)}return typeof zt=="string"&&zt!==""||typeof zt=="number"?(zt=""+zt,vt!==null&&vt.tag===6?(A(It,vt.sibling),vt=H(vt,zt),vt.return=It,It=vt):(A(It,vt),vt=pd(zt,It.mode,Tn),vt.return=It,It=vt),be(It)):A(It,vt)}return Ms}var Il=ru(!0),tl=ru(!1),gc=Qa(null),_c=null,su=null,yc=null;function vc(){yc=su=_c=null}function Ju(f){var y=gc.current;Kr(gc),f._currentValue=y}function Yh(f,y,A){for(;f!==null;){var D=f.alternate;if((f.childLanes&y)!==y?(f.childLanes|=y,D!==null&&(D.childLanes|=y)):D!==null&&(D.childLanes&y)!==y&&(D.childLanes|=y),f===A)break;f=f.return}}function xc(f,y){_c=f,yc=su=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&y)!==0&&(yo=!0),f.firstContext=null)}function As(f){var y=f._currentValue;if(yc!==f)if(f={context:f,memoizedValue:y,next:null},su===null){if(_c===null)throw Error(m(308));su=f,_c.dependencies={lanes:0,firstContext:f}}else su=su.next=f;return y}var Ro=null;function nn(f){Ro===null?Ro=[f]:Ro.push(f)}function qp(f,y,A,D){var H=y.interleaved;return H===null?(A.next=A,nn(y)):(A.next=H.next,H.next=A),y.interleaved=A,nl(f,D)}function nl(f,y){f.lanes|=y;var A=f.alternate;for(A!==null&&(A.lanes|=y),A=f,f=f.return;f!==null;)f.childLanes|=y,A=f.alternate,A!==null&&(A.childLanes|=y),A=f,f=f.return;return A.tag===3?A.stateNode:null}var zo=!1;function il(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wn(f,y){f=f.updateQueue,y.updateQueue===f&&(y.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function la(f,y){return{eventTime:f,lane:y,tag:0,payload:null,callback:null,next:null}}function bc(f,y,A){var D=f.updateQueue;if(D===null)return null;if(D=D.shared,(G&2)!==0){var H=D.pending;return H===null?y.next=y:(y.next=H.next,H.next=y),D.pending=y,nl(f,A)}return H=D.interleaved,H===null?(y.next=y,nn(D)):(y.next=H.next,H.next=y),D.interleaved=y,nl(f,A)}function Wd(f,y,A){if(y=y.updateQueue,y!==null&&(y=y.shared,(A&4194240)!==0)){var D=y.lanes;D&=f.pendingLanes,A|=D,y.lanes=A,ia(f,A)}}function Zd(f,y){var A=f.updateQueue,D=f.alternate;if(D!==null&&(D=D.updateQueue,A===D)){var H=null,Q=null;if(A=A.firstBaseUpdate,A!==null){do{var be={eventTime:A.eventTime,lane:A.lane,tag:A.tag,payload:A.payload,callback:A.callback,next:null};Q===null?H=Q=be:Q=Q.next=be,A=A.next}while(A!==null);Q===null?H=Q=y:Q=Q.next=y}else H=Q=y;A={baseState:D.baseState,firstBaseUpdate:H,lastBaseUpdate:Q,shared:D.shared,effects:D.effects},f.updateQueue=A;return}f=A.lastBaseUpdate,f===null?A.firstBaseUpdate=y:f.next=y,A.lastBaseUpdate=y}function Qh(f,y,A,D){var H=f.updateQueue;zo=!1;var Q=H.firstBaseUpdate,be=H.lastBaseUpdate,Ye=H.shared.pending;if(Ye!==null){H.shared.pending=null;var ot=Ye,Bt=ot.next;ot.next=null,be===null?Q=Bt:be.next=Bt,be=ot;var mn=f.alternate;mn!==null&&(mn=mn.updateQueue,Ye=mn.lastBaseUpdate,Ye!==be&&(Ye===null?mn.firstBaseUpdate=Bt:Ye.next=Bt,mn.lastBaseUpdate=ot))}if(Q!==null){var gn=H.baseState;be=0,mn=Bt=ot=null,Ye=Q;do{var dn=Ye.lane,jn=Ye.eventTime;if((D&dn)===dn){mn!==null&&(mn=mn.next={eventTime:jn,lane:0,tag:Ye.tag,payload:Ye.payload,callback:Ye.callback,next:null});e:{var Kn=f,ei=Ye;switch(dn=y,jn=A,ei.tag){case 1:if(Kn=ei.payload,typeof Kn=="function"){gn=Kn.call(jn,gn,dn);break e}gn=Kn;break e;case 3:Kn.flags=Kn.flags&-65537|128;case 0:if(Kn=ei.payload,dn=typeof Kn=="function"?Kn.call(jn,gn,dn):Kn,dn==null)break e;gn=qt({},gn,dn);break e;case 2:zo=!0}}Ye.callback!==null&&Ye.lane!==0&&(f.flags|=64,dn=H.effects,dn===null?H.effects=[Ye]:dn.push(Ye))}else jn={eventTime:jn,lane:dn,tag:Ye.tag,payload:Ye.payload,callback:Ye.callback,next:null},mn===null?(Bt=mn=jn,ot=gn):mn=mn.next=jn,be|=dn;if(Ye=Ye.next,Ye===null){if(Ye=H.shared.pending,Ye===null)break;dn=Ye,Ye=dn.next,dn.next=null,H.lastBaseUpdate=dn,H.shared.pending=null}}while(!0);if(mn===null&&(ot=gn),H.baseState=ot,H.firstBaseUpdate=Bt,H.lastBaseUpdate=mn,y=H.shared.interleaved,y!==null){H=y;do be|=H.lane,H=H.next;while(H!==y)}else Q===null&&(H.shared.lanes=0);Te|=be,f.lanes=be,f.memoizedState=gn}}function jf(f,y,A){if(f=y.effects,y.effects=null,f!==null)for(y=0;y<f.length;y++){var D=f[y],H=D.callback;if(H!==null){if(D.callback=null,D=A,typeof H!="function")throw Error(m(191,H));H.call(D)}}}var eh={},rl=Qa(eh),Jh=Qa(eh),Qs=Qa(eh);function Pl(f){if(f===eh)throw Error(m(174));return f}function Js(f,y){switch(es(Qs,y),es(Jh,f),es(rl,eh),f=y.nodeType,f){case 9:case 11:y=(y=y.documentElement)?y.namespaceURI:Jr(null,"");break;default:f=f===8?y.parentNode:y,y=f.namespaceURI||null,f=f.tagName,y=Jr(y,f)}Kr(rl),es(rl,y)}function Xo(){Kr(rl),Kr(Jh),Kr(Qs)}function wc(f){Pl(Qs.current);var y=Pl(rl.current),A=Jr(y,f.type);y!==A&&(es(Jh,f),es(rl,A))}function th(f){Jh.current===f&&(Kr(rl),Kr(Jh))}var ts=Qa(0);function kl(f){for(var y=f;y!==null;){if(y.tag===13){var A=y.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||A.data==="$!"))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if((y.flags&128)!==0)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===f)break;for(;y.sibling===null;){if(y.return===null||y.return===f)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var Kd=[];function Ra(){for(var f=0;f<Kd.length;f++)Kd[f]._workInProgressVersionPrimary=null;Kd.length=0}var ji=Le.ReactCurrentDispatcher,ou=Le.ReactCurrentBatchConfig,Yo=0,us=null,Is=null,Ns=null,Xd=!1,sl=!1,za=0,Ot=0;function Zt(){throw Error(m(321))}function Ml(f,y){if(y===null)return!1;for(var A=0;A<y.length&&A<f.length;A++)if(!va(f[A],y[A]))return!1;return!0}function Er(f,y,A,D,H,Q){if(Yo=Q,us=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,ji.current=f===null||f.memoizedState===null?id:rp,f=A(D,H),sl){Q=0;do{if(sl=!1,za=0,25<=Q)throw Error(m(301));Q+=1,Ns=Is=null,y.updateQueue=null,ji.current=oh,f=A(D,H)}while(sl)}if(ji.current=Da,y=Is!==null&&Is.next!==null,Yo=0,Ns=Is=us=null,Xd=!1,y)throw Error(m(300));return f}function Xe(){var f=za!==0;return za=0,f}function Ps(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ns===null?us.memoizedState=Ns=f:Ns=Ns.next=f,Ns}function Lo(){if(Is===null){var f=us.alternate;f=f!==null?f.memoizedState:null}else f=Is.next;var y=Ns===null?us.memoizedState:Ns.next;if(y!==null)Ns=y,Is=f;else{if(f===null)throw Error(m(310));Is=f,f={memoizedState:Is.memoizedState,baseState:Is.baseState,baseQueue:Is.baseQueue,queue:Is.queue,next:null},Ns===null?us.memoizedState=Ns=f:Ns=Ns.next=f}return Ns}function Tc(f,y){return typeof y=="function"?y(f):y}function ed(f){var y=Lo(),A=y.queue;if(A===null)throw Error(m(311));A.lastRenderedReducer=f;var D=Is,H=D.baseQueue,Q=A.pending;if(Q!==null){if(H!==null){var be=H.next;H.next=Q.next,Q.next=be}D.baseQueue=H=Q,A.pending=null}if(H!==null){Q=H.next,D=D.baseState;var Ye=be=null,ot=null,Bt=Q;do{var mn=Bt.lane;if((Yo&mn)===mn)ot!==null&&(ot=ot.next={lane:0,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null}),D=Bt.hasEagerState?Bt.eagerState:f(D,Bt.action);else{var gn={lane:mn,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null};ot===null?(Ye=ot=gn,be=D):ot=ot.next=gn,us.lanes|=mn,Te|=mn}Bt=Bt.next}while(Bt!==null&&Bt!==Q);ot===null?be=D:ot.next=Ye,va(D,y.memoizedState)||(yo=!0),y.memoizedState=D,y.baseState=be,y.baseQueue=ot,A.lastRenderedState=D}if(f=A.interleaved,f!==null){H=f;do Q=H.lane,us.lanes|=Q,Te|=Q,H=H.next;while(H!==f)}else H===null&&(A.lanes=0);return[y.memoizedState,A.dispatch]}function Yd(f){var y=Lo(),A=y.queue;if(A===null)throw Error(m(311));A.lastRenderedReducer=f;var D=A.dispatch,H=A.pending,Q=y.memoizedState;if(H!==null){A.pending=null;var be=H=H.next;do Q=f(Q,be.action),be=be.next;while(be!==H);va(Q,y.memoizedState)||(yo=!0),y.memoizedState=Q,y.baseQueue===null&&(y.baseState=Q),A.lastRenderedState=Q}return[Q,D]}function Hp(){}function au(f,y){var A=us,D=Lo(),H=y(),Q=!va(D.memoizedState,H);if(Q&&(D.memoizedState=H,yo=!0),D=D.queue,al(Up.bind(null,A,D,f),[f]),D.getSnapshot!==y||Q||Ns!==null&&Ns.memoizedState.tag&1){if(A.flags|=2048,nh(9,Vf.bind(null,A,D,H,y),void 0,null),Y===null)throw Error(m(349));(Yo&30)!==0||Nf(A,y,H)}return H}function Nf(f,y,A){f.flags|=16384,f={getSnapshot:y,value:A},y=us.updateQueue,y===null?(y={lastEffect:null,stores:null},us.updateQueue=y,y.stores=[f]):(A=y.stores,A===null?y.stores=[f]:A.push(f))}function Vf(f,y,A,D){y.value=A,y.getSnapshot=D,td(y)&&Qd(f)}function Up(f,y,A){return A(function(){td(y)&&Qd(f)})}function td(f){var y=f.getSnapshot;f=f.value;try{var A=y();return!va(f,A)}catch{return!0}}function Qd(f){var y=nl(f,1);y!==null&&Xt(y,f,1,-1)}function Jd(f){var y=Ps();return typeof f=="function"&&(f=f()),y.memoizedState=y.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tc,lastRenderedState:f},y.queue=f,f=f.dispatch=np.bind(null,us,f),[y.memoizedState,f]}function nh(f,y,A,D){return f={tag:f,create:y,destroy:A,deps:D,next:null},y=us.updateQueue,y===null?(y={lastEffect:null,stores:null},us.updateQueue=y,y.lastEffect=f.next=f):(A=y.lastEffect,A===null?y.lastEffect=f.next=f:(D=A.next,A.next=f,f.next=D,y.lastEffect=f)),f}function nd(){return Lo().memoizedState}function Sc(f,y,A,D){var H=Ps();us.flags|=f,H.memoizedState=nh(1|y,A,void 0,D===void 0?null:D)}function ol(f,y,A,D){var H=Lo();D=D===void 0?null:D;var Q=void 0;if(Is!==null){var be=Is.memoizedState;if(Q=be.destroy,D!==null&&Ml(D,be.deps)){H.memoizedState=nh(y,A,Q,D);return}}us.flags|=f,H.memoizedState=nh(1|y,A,Q,D)}function ep(f,y){return Sc(8390656,8,f,y)}function al(f,y){return ol(2048,8,f,y)}function eo(f,y){return ol(4,2,f,y)}function qf(f,y){return ol(4,4,f,y)}function ih(f,y){if(typeof y=="function")return f=f(),y(f),function(){y(null)};if(y!=null)return f=f(),y.current=f,function(){y.current=null}}function lr(f,y,A){return A=A!=null?A.concat([f]):null,ol(4,4,ih.bind(null,y,f),A)}function xi(){}function tp(f,y){var A=Lo();y=y===void 0?null:y;var D=A.memoizedState;return D!==null&&y!==null&&Ml(y,D[1])?D[0]:(A.memoizedState=[f,y],f)}function ll(f,y){var A=Lo();y=y===void 0?null:y;var D=A.memoizedState;return D!==null&&y!==null&&Ml(y,D[1])?D[0]:(f=f(),A.memoizedState=[f,y],f)}function rh(f,y,A){return(Yo&21)===0?(f.baseState&&(f.baseState=!1,yo=!0),f.memoizedState=A):(va(A,y)||(A=fa(),us.lanes|=A,Te|=A,f.baseState=!0),y)}function sh(f,y){var A=ar;ar=A!==0&&4>A?A:4,f(!0);var D=ou.transition;ou.transition={};try{f(!1),y()}finally{ar=A,ou.transition=D}}function Rl(){return Lo().memoizedState}function $p(f,y,A){var D=tn(f);if(A={lane:D,action:A,hasEagerState:!1,eagerState:null,next:null},lu(f))ip(y,A);else if(A=qp(f,y,A,D),A!==null){var H=Yt();Xt(A,f,D,H),La(A,y,D)}}function np(f,y,A){var D=tn(f),H={lane:D,action:A,hasEagerState:!1,eagerState:null,next:null};if(lu(f))ip(y,H);else{var Q=f.alternate;if(f.lanes===0&&(Q===null||Q.lanes===0)&&(Q=y.lastRenderedReducer,Q!==null))try{var be=y.lastRenderedState,Ye=Q(be,A);if(H.hasEagerState=!0,H.eagerState=Ye,va(Ye,be)){var ot=y.interleaved;ot===null?(H.next=H,nn(y)):(H.next=ot.next,ot.next=H),y.interleaved=H;return}}catch{}finally{}A=qp(f,y,H,D),A!==null&&(H=Yt(),Xt(A,f,D,H),La(A,y,D))}}function lu(f){var y=f.alternate;return f===us||y!==null&&y===us}function ip(f,y){sl=Xd=!0;var A=f.pending;A===null?y.next=y:(y.next=A.next,A.next=y),f.pending=y}function La(f,y,A){if((A&4194240)!==0){var D=y.lanes;D&=f.pendingLanes,A|=D,y.lanes=A,ia(f,A)}}var Da={readContext:As,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},id={readContext:As,useCallback:function(f,y){return Ps().memoizedState=[f,y===void 0?null:y],f},useContext:As,useEffect:ep,useImperativeHandle:function(f,y,A){return A=A!=null?A.concat([f]):null,Sc(4194308,4,ih.bind(null,y,f),A)},useLayoutEffect:function(f,y){return Sc(4194308,4,f,y)},useInsertionEffect:function(f,y){return Sc(4,2,f,y)},useMemo:function(f,y){var A=Ps();return y=y===void 0?null:y,f=f(),A.memoizedState=[f,y],f},useReducer:function(f,y,A){var D=Ps();return y=A!==void 0?A(y):y,D.memoizedState=D.baseState=y,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:y},D.queue=f,f=f.dispatch=$p.bind(null,us,f),[D.memoizedState,f]},useRef:function(f){var y=Ps();return f={current:f},y.memoizedState=f},useState:Jd,useDebugValue:xi,useDeferredValue:function(f){return Ps().memoizedState=f},useTransition:function(){var f=Jd(!1),y=f[0];return f=sh.bind(null,f[1]),Ps().memoizedState=f,[y,f]},useMutableSource:function(){},useSyncExternalStore:function(f,y,A){var D=us,H=Ps();if(ss){if(A===void 0)throw Error(m(407));A=A()}else{if(A=y(),Y===null)throw Error(m(349));(Yo&30)!==0||Nf(D,y,A)}H.memoizedState=A;var Q={value:A,getSnapshot:y};return H.queue=Q,ep(Up.bind(null,D,Q,f),[f]),D.flags|=2048,nh(9,Vf.bind(null,D,Q,A,y),void 0,null),A},useId:function(){var f=Ps(),y=Y.identifierPrefix;if(ss){var A=el,D=Ma;A=(D&~(1<<32-Ao(D)-1)).toString(32)+A,y=":"+y+"R"+A,A=za++,0<A&&(y+="H"+A.toString(32)),y+=":"}else A=Ot++,y=":"+y+"r"+A.toString(32)+":";return f.memoizedState=y},unstable_isNewReconciler:!1},rp={readContext:As,useCallback:tp,useContext:As,useEffect:al,useImperativeHandle:lr,useInsertionEffect:eo,useLayoutEffect:qf,useMemo:ll,useReducer:ed,useRef:nd,useState:function(){return ed(Tc)},useDebugValue:xi,useDeferredValue:function(f){var y=Lo();return rh(y,Is.memoizedState,f)},useTransition:function(){var f=ed(Tc)[0],y=Lo().memoizedState;return[f,y]},useMutableSource:Hp,useSyncExternalStore:au,useId:Rl,unstable_isNewReconciler:!1},oh={readContext:As,useCallback:tp,useContext:As,useEffect:al,useImperativeHandle:lr,useInsertionEffect:eo,useLayoutEffect:qf,useMemo:ll,useReducer:Yd,useRef:nd,useState:function(){return Yd(Tc)},useDebugValue:xi,useDeferredValue:function(f){var y=Lo();return Is===null?y.memoizedState=f:rh(y,Is.memoizedState,f)},useTransition:function(){var f=Yd(Tc)[0],y=Lo().memoizedState;return[f,y]},useMutableSource:Hp,useSyncExternalStore:au,useId:Rl,unstable_isNewReconciler:!1};function _o(f,y){if(f&&f.defaultProps){y=qt({},y),f=f.defaultProps;for(var A in f)y[A]===void 0&&(y[A]=f[A]);return y}return y}function bs(f,y,A,D){y=f.memoizedState,A=A(D,y),A=A==null?y:qt({},y,A),f.memoizedState=A,f.lanes===0&&(f.updateQueue.baseState=A)}var zl={isMounted:function(f){return(f=f._reactInternals)?rt(f)===f:!1},enqueueSetState:function(f,y,A){f=f._reactInternals;var D=Yt(),H=tn(f),Q=la(D,H);Q.payload=y,A!=null&&(Q.callback=A),y=bc(f,Q,H),y!==null&&(Xt(y,f,H,D),Wd(y,f,H))},enqueueReplaceState:function(f,y,A){f=f._reactInternals;var D=Yt(),H=tn(f),Q=la(D,H);Q.tag=1,Q.payload=y,A!=null&&(Q.callback=A),y=bc(f,Q,H),y!==null&&(Xt(y,f,H,D),Wd(y,f,H))},enqueueForceUpdate:function(f,y){f=f._reactInternals;var A=Yt(),D=tn(f),H=la(A,D);H.tag=2,y!=null&&(H.callback=y),y=bc(f,H,D),y!==null&&(Xt(y,f,D,A),Wd(y,f,D))}};function Ll(f,y,A,D,H,Q,be){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(D,Q,be):y.prototype&&y.prototype.isPureReactComponent?!Ia(A,D)||!Ia(H,Q):!0}function sp(f,y,A){var D=!1,H=Go,Q=y.contextType;return typeof Q=="object"&&Q!==null?Q=As(Q):(H=Xs(y)?Fs:fs.current,D=y.contextTypes,Q=(D=D!=null)?Al(f,H):Go),y=new y(A,Q),f.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=zl,f.stateNode=y,y._reactInternals=f,D&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=H,f.__reactInternalMemoizedMaskedChildContext=Q),y}function rd(f,y,A,D){f=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(A,D),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(A,D),y.state!==f&&zl.enqueueReplaceState(y,y.state,null)}function sd(f,y,A,D){var H=f.stateNode;H.props=A,H.state=f.memoizedState,H.refs={},il(f);var Q=y.contextType;typeof Q=="object"&&Q!==null?H.context=As(Q):(Q=Xs(y)?Fs:fs.current,H.context=Al(f,Q)),H.state=f.memoizedState,Q=y.getDerivedStateFromProps,typeof Q=="function"&&(bs(f,y,Q,A),H.state=f.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(y=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),y!==H.state&&zl.enqueueReplaceState(H,H.state,null),Qh(f,A,H,D),H.state=f.memoizedState),typeof H.componentDidMount=="function"&&(f.flags|=4194308)}function cl(f,y){try{var A="",D=y;do A+=xn(D),D=D.return;while(D);var H=A}catch(Q){H=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:f,source:y,stack:H,digest:null}}function ws(f,y,A){return{value:f,source:null,stack:A??null,digest:y??null}}function cu(f,y){try{console.error(y.value)}catch(A){setTimeout(function(){throw A})}}var Gp=typeof WeakMap=="function"?WeakMap:Map;function op(f,y,A){A=la(-1,A),A.tag=3,A.payload={element:null};var D=y.value;return A.callback=function(){Et||(Et=!0,Ke=D),cu(f,y)},A}function Dl(f,y,A){A=la(-1,A),A.tag=3;var D=f.type.getDerivedStateFromError;if(typeof D=="function"){var H=y.value;A.payload=function(){return D(H)},A.callback=function(){cu(f,y)}}var Q=f.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(A.callback=function(){cu(f,y),typeof D!="function"&&(st===null?st=new Set([this]):st.add(this));var be=y.stack;this.componentDidCatch(y.value,{componentStack:be!==null?be:""})}),A}function ah(f,y,A){var D=f.pingCache;if(D===null){D=f.pingCache=new Gp;var H=new Set;D.set(y,H)}else H=D.get(y),H===void 0&&(H=new Set,D.set(y,H));H.has(A)||(H.add(A),f=Br.bind(null,f,y,A),y.then(f,f))}function ap(f){do{var y;if((y=f.tag===13)&&(y=f.memoizedState,y=y!==null?y.dehydrated!==null:!0),y)return f;f=f.return}while(f!==null);return null}function od(f,y,A,D,H){return(f.mode&1)===0?(f===y?f.flags|=65536:(f.flags|=128,A.flags|=131072,A.flags&=-52805,A.tag===1&&(A.alternate===null?A.tag=17:(y=la(-1,1),y.tag=2,bc(A,y,1))),A.lanes|=1),f):(f.flags|=65536,f.lanes=H,f)}var uu=Le.ReactCurrentOwner,yo=!1;function Vs(f,y,A,D){y.child=f===null?tl(y,null,A,D):Il(y,f.child,A,D)}function hu(f,y,A,D,H){A=A.render;var Q=y.ref;return xc(y,H),D=Er(f,y,A,D,Q,H),A=Xe(),f!==null&&!yo?(y.updateQueue=f.updateQueue,y.flags&=-2053,f.lanes&=~H,Qi(f,y,H)):(ss&&A&&Gh(y),y.flags|=1,Vs(f,y,D,H),y.child)}function lh(f,y,A,D,H){if(f===null){var Q=A.type;return typeof Q=="function"&&!Qo(Q)&&Q.defaultProps===void 0&&A.compare===null&&A.defaultProps===void 0?(y.tag=15,y.type=Q,lp(f,y,Q,D,H)):(f=Jo(A.type,null,D,y,y.mode,H),f.ref=y.ref,f.return=y,y.child=f)}if(Q=f.child,(f.lanes&H)===0){var be=Q.memoizedProps;if(A=A.compare,A=A!==null?A:Ia,A(be,D)&&f.ref===y.ref)return Qi(f,y,H)}return y.flags|=1,f=Bo(Q,D),f.ref=y.ref,f.return=y,y.child=f}function lp(f,y,A,D,H){if(f!==null){var Q=f.memoizedProps;if(Ia(Q,D)&&f.ref===y.ref)if(yo=!1,y.pendingProps=D=Q,(f.lanes&H)!==0)(f.flags&131072)!==0&&(yo=!0);else return y.lanes=f.lanes,Qi(f,y,H)}return ch(f,y,A,D,H)}function ad(f,y,A){var D=y.pendingProps,H=D.children,Q=f!==null?f.memoizedState:null;if(D.mode==="hidden")if((y.mode&1)===0)y.memoizedState={baseLanes:0,cachePool:null,transitions:null},es(_e,pe),pe|=A;else{if((A&1073741824)===0)return f=Q!==null?Q.baseLanes|A:A,y.lanes=y.childLanes=1073741824,y.memoizedState={baseLanes:f,cachePool:null,transitions:null},y.updateQueue=null,es(_e,pe),pe|=f,null;y.memoizedState={baseLanes:0,cachePool:null,transitions:null},D=Q!==null?Q.baseLanes:A,es(_e,pe),pe|=D}else Q!==null?(D=Q.baseLanes|A,y.memoizedState=null):D=A,es(_e,pe),pe|=D;return Vs(f,y,H,A),y.child}function Wp(f,y){var A=y.ref;(f===null&&A!==null||f!==null&&f.ref!==A)&&(y.flags|=512,y.flags|=2097152)}function ch(f,y,A,D,H){var Q=Xs(A)?Fs:fs.current;return Q=Al(y,Q),xc(y,H),A=Er(f,y,A,D,Q,H),D=Xe(),f!==null&&!yo?(y.updateQueue=f.updateQueue,y.flags&=-2053,f.lanes&=~H,Qi(f,y,H)):(ss&&D&&Gh(y),y.flags|=1,Vs(f,y,A,H),y.child)}function Zp(f,y,A,D,H){if(Xs(A)){var Q=!0;eu(y)}else Q=!1;if(xc(y,H),y.stateNode===null)du(f,y),sp(y,A,D),sd(y,A,D,H),D=!0;else if(f===null){var be=y.stateNode,Ye=y.memoizedProps;be.props=Ye;var ot=be.context,Bt=A.contextType;typeof Bt=="object"&&Bt!==null?Bt=As(Bt):(Bt=Xs(A)?Fs:fs.current,Bt=Al(y,Bt));var mn=A.getDerivedStateFromProps,gn=typeof mn=="function"||typeof be.getSnapshotBeforeUpdate=="function";gn||typeof be.UNSAFE_componentWillReceiveProps!="function"&&typeof be.componentWillReceiveProps!="function"||(Ye!==D||ot!==Bt)&&rd(y,be,D,Bt),zo=!1;var dn=y.memoizedState;be.state=dn,Qh(y,D,be,H),ot=y.memoizedState,Ye!==D||dn!==ot||ko.current||zo?(typeof mn=="function"&&(bs(y,A,mn,D),ot=y.memoizedState),(Ye=zo||Ll(y,A,Ye,D,dn,ot,Bt))?(gn||typeof be.UNSAFE_componentWillMount!="function"&&typeof be.componentWillMount!="function"||(typeof be.componentWillMount=="function"&&be.componentWillMount(),typeof be.UNSAFE_componentWillMount=="function"&&be.UNSAFE_componentWillMount()),typeof be.componentDidMount=="function"&&(y.flags|=4194308)):(typeof be.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=D,y.memoizedState=ot),be.props=D,be.state=ot,be.context=Bt,D=Ye):(typeof be.componentDidMount=="function"&&(y.flags|=4194308),D=!1)}else{be=y.stateNode,wn(f,y),Ye=y.memoizedProps,Bt=y.type===y.elementType?Ye:_o(y.type,Ye),be.props=Bt,gn=y.pendingProps,dn=be.context,ot=A.contextType,typeof ot=="object"&&ot!==null?ot=As(ot):(ot=Xs(A)?Fs:fs.current,ot=Al(y,ot));var jn=A.getDerivedStateFromProps;(mn=typeof jn=="function"||typeof be.getSnapshotBeforeUpdate=="function")||typeof be.UNSAFE_componentWillReceiveProps!="function"&&typeof be.componentWillReceiveProps!="function"||(Ye!==gn||dn!==ot)&&rd(y,be,D,ot),zo=!1,dn=y.memoizedState,be.state=dn,Qh(y,D,be,H);var Kn=y.memoizedState;Ye!==gn||dn!==Kn||ko.current||zo?(typeof jn=="function"&&(bs(y,A,jn,D),Kn=y.memoizedState),(Bt=zo||Ll(y,A,Bt,D,dn,Kn,ot)||!1)?(mn||typeof be.UNSAFE_componentWillUpdate!="function"&&typeof be.componentWillUpdate!="function"||(typeof be.componentWillUpdate=="function"&&be.componentWillUpdate(D,Kn,ot),typeof be.UNSAFE_componentWillUpdate=="function"&&be.UNSAFE_componentWillUpdate(D,Kn,ot)),typeof be.componentDidUpdate=="function"&&(y.flags|=4),typeof be.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof be.componentDidUpdate!="function"||Ye===f.memoizedProps&&dn===f.memoizedState||(y.flags|=4),typeof be.getSnapshotBeforeUpdate!="function"||Ye===f.memoizedProps&&dn===f.memoizedState||(y.flags|=1024),y.memoizedProps=D,y.memoizedState=Kn),be.props=D,be.state=Kn,be.context=ot,D=Bt):(typeof be.componentDidUpdate!="function"||Ye===f.memoizedProps&&dn===f.memoizedState||(y.flags|=4),typeof be.getSnapshotBeforeUpdate!="function"||Ye===f.memoizedProps&&dn===f.memoizedState||(y.flags|=1024),D=!1)}return cp(f,y,A,D,Q,H)}function cp(f,y,A,D,H,Q){Wp(f,y);var be=(y.flags&128)!==0;if(!D&&!be)return H&&Wu(y,A,!1),Qi(f,y,Q);D=y.stateNode,uu.current=y;var Ye=be&&typeof A.getDerivedStateFromError!="function"?null:D.render();return y.flags|=1,f!==null&&be?(y.child=Il(y,f.child,null,Q),y.child=Il(y,null,Ye,Q)):Vs(f,y,Ye,Q),y.memoizedState=D.state,H&&Wu(y,A,!0),y.child}function Kp(f){var y=f.stateNode;y.pendingContext?Vd(f,y.pendingContext,y.pendingContext!==y.context):y.context&&Vd(f,y.context,!1),Js(f,y.containerInfo)}function Xp(f,y,A,D,H){return iu(),Ko(H),y.flags|=256,Vs(f,y,A,D),y.child}var ld={dehydrated:null,treeContext:null,retryLane:0};function up(f){return{baseLanes:f,cachePool:null,transitions:null}}function Yp(f,y,A){var D=y.pendingProps,H=ts.current,Q=!1,be=(y.flags&128)!==0,Ye;if((Ye=be)||(Ye=f!==null&&f.memoizedState===null?!1:(H&2)!==0),Ye?(Q=!0,y.flags&=-129):(f===null||f.memoizedState!==null)&&(H|=1),es(ts,H&1),f===null)return Kh(y),f=y.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((y.mode&1)===0?y.lanes=1:f.data==="$!"?y.lanes=8:y.lanes=1073741824,null):(be=D.children,f=D.fallback,Q?(D=y.mode,Q=y.child,be={mode:"hidden",children:be},(D&1)===0&&Q!==null?(Q.childLanes=0,Q.pendingProps=be):Q=Cc(be,D,0,null),f=ea(f,D,A,null),Q.return=y,f.return=y,Q.sibling=f,y.child=Q,y.child.memoizedState=up(A),y.memoizedState=ld,f):hp(y,be));if(H=f.memoizedState,H!==null&&(Ye=H.dehydrated,Ye!==null))return Hf(f,y,be,D,Ye,H,A);if(Q){Q=D.fallback,be=y.mode,H=f.child,Ye=H.sibling;var ot={mode:"hidden",children:D.children};return(be&1)===0&&y.child!==H?(D=y.child,D.childLanes=0,D.pendingProps=ot,y.deletions=null):(D=Bo(H,ot),D.subtreeFlags=H.subtreeFlags&14680064),Ye!==null?Q=Bo(Ye,Q):(Q=ea(Q,be,A,null),Q.flags|=2),Q.return=y,D.return=y,D.sibling=Q,y.child=D,D=Q,Q=y.child,be=f.child.memoizedState,be=be===null?up(A):{baseLanes:be.baseLanes|A,cachePool:null,transitions:be.transitions},Q.memoizedState=be,Q.childLanes=f.childLanes&~A,y.memoizedState=ld,D}return Q=f.child,f=Q.sibling,D=Bo(Q,{mode:"visible",children:D.children}),(y.mode&1)===0&&(D.lanes=A),D.return=y,D.sibling=null,f!==null&&(A=y.deletions,A===null?(y.deletions=[f],y.flags|=16):A.push(f)),y.child=D,y.memoizedState=null,D}function hp(f,y){return y=Cc({mode:"visible",children:y},f.mode,0,null),y.return=f,f.child=y}function cd(f,y,A,D){return D!==null&&Ko(D),Il(y,f.child,null,A),f=hp(y,y.pendingProps.children),f.flags|=2,y.memoizedState=null,f}function Hf(f,y,A,D,H,Q,be){if(A)return y.flags&256?(y.flags&=-257,D=ws(Error(m(422))),cd(f,y,be,D)):y.memoizedState!==null?(y.child=f.child,y.flags|=128,null):(Q=D.fallback,H=y.mode,D=Cc({mode:"visible",children:D.children},H,0,null),Q=ea(Q,H,be,null),Q.flags|=2,D.return=y,Q.return=y,D.sibling=Q,y.child=D,(y.mode&1)!==0&&Il(y,f.child,null,be),y.child.memoizedState=up(be),y.memoizedState=ld,Q);if((y.mode&1)===0)return cd(f,y,be,null);if(H.data==="$!"){if(D=H.nextSibling&&H.nextSibling.dataset,D)var Ye=D.dgst;return D=Ye,Q=Error(m(419)),D=ws(Q,D,void 0),cd(f,y,be,D)}if(Ye=(be&f.childLanes)!==0,yo||Ye){if(D=Y,D!==null){switch(be&-be){case 4:H=2;break;case 16:H=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:H=32;break;case 536870912:H=268435456;break;default:H=0}H=(H&(D.suspendedLanes|be))!==0?0:H,H!==0&&H!==Q.retryLane&&(Q.retryLane=H,nl(f,H),Xt(D,f,H,-1))}return er(),D=ws(Error(m(421))),cd(f,y,be,D)}return H.data==="$?"?(y.flags|=128,y.child=f.child,y=fr.bind(null,f),H._reactRetry=y,null):(f=Q.treeContext,js=Za(H.nextSibling),Es=y,ss=!0,Ys=null,f!==null&&(Mo[xa++]=Ma,Mo[xa++]=el,Mo[xa++]=Ja,Ma=f.id,el=f.overflow,Ja=y),y=hp(y,D.children),y.flags|=4096,y)}function Qp(f,y,A){f.lanes|=y;var D=f.alternate;D!==null&&(D.lanes|=y),Yh(f.return,y,A)}function Jp(f,y,A,D,H){var Q=f.memoizedState;Q===null?f.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:D,tail:A,tailMode:H}:(Q.isBackwards=y,Q.rendering=null,Q.renderingStartTime=0,Q.last=D,Q.tail=A,Q.tailMode=H)}function Uf(f,y,A){var D=y.pendingProps,H=D.revealOrder,Q=D.tail;if(Vs(f,y,D.children,A),D=ts.current,(D&2)!==0)D=D&1|2,y.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=y.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&Qp(f,A,y);else if(f.tag===19)Qp(f,A,y);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===y)break e;for(;f.sibling===null;){if(f.return===null||f.return===y)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}D&=1}if(es(ts,D),(y.mode&1)===0)y.memoizedState=null;else switch(H){case"forwards":for(A=y.child,H=null;A!==null;)f=A.alternate,f!==null&&kl(f)===null&&(H=A),A=A.sibling;A=H,A===null?(H=y.child,y.child=null):(H=A.sibling,A.sibling=null),Jp(y,!1,H,A,Q);break;case"backwards":for(A=null,H=y.child,y.child=null;H!==null;){if(f=H.alternate,f!==null&&kl(f)===null){y.child=H;break}f=H.sibling,H.sibling=A,A=H,H=f}Jp(y,!0,A,null,Q);break;case"together":Jp(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function du(f,y){(y.mode&1)===0&&f!==null&&(f.alternate=null,y.alternate=null,y.flags|=2)}function Qi(f,y,A){if(f!==null&&(y.dependencies=f.dependencies),Te|=y.lanes,(A&y.childLanes)===0)return null;if(f!==null&&y.child!==f.child)throw Error(m(153));if(y.child!==null){for(f=y.child,A=Bo(f,f.pendingProps),y.child=A,A.return=y;f.sibling!==null;)f=f.sibling,A=A.sibling=Bo(f,f.pendingProps),A.return=y;A.sibling=null}return y.child}function $f(f,y,A){switch(y.tag){case 3:Kp(y),iu();break;case 5:wc(y);break;case 1:Xs(y.type)&&eu(y);break;case 4:Js(y,y.stateNode.containerInfo);break;case 10:var D=y.type._context,H=y.memoizedProps.value;es(gc,D._currentValue),D._currentValue=H;break;case 13:if(D=y.memoizedState,D!==null)return D.dehydrated!==null?(es(ts,ts.current&1),y.flags|=128,null):(A&y.child.childLanes)!==0?Yp(f,y,A):(es(ts,ts.current&1),f=Qi(f,y,A),f!==null?f.sibling:null);es(ts,ts.current&1);break;case 19:if(D=(A&y.childLanes)!==0,(f.flags&128)!==0){if(D)return Uf(f,y,A);y.flags|=128}if(H=y.memoizedState,H!==null&&(H.rendering=null,H.tail=null,H.lastEffect=null),es(ts,ts.current),D)break;return null;case 22:case 23:return y.lanes=0,ad(f,y,A)}return Qi(f,y,A)}var ud,hd,ef,uh;ud=function(f,y){for(var A=y.child;A!==null;){if(A.tag===5||A.tag===6)f.appendChild(A.stateNode);else if(A.tag!==4&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===y)break;for(;A.sibling===null;){if(A.return===null||A.return===y)return;A=A.return}A.sibling.return=A.return,A=A.sibling}},hd=function(){},ef=function(f,y,A,D){var H=f.memoizedProps;if(H!==D){f=y.stateNode,Pl(rl.current);var Q=null;switch(A){case"input":H=ki(f,H),D=ki(f,D),Q=[];break;case"select":H=qt({},H,{value:void 0}),D=qt({},D,{value:void 0}),Q=[];break;case"textarea":H=Ss(f,H),D=Ss(f,D),Q=[];break;default:typeof H.onClick!="function"&&typeof D.onClick=="function"&&(f.onclick=El)}ro(A,D);var be;A=null;for(Bt in H)if(!D.hasOwnProperty(Bt)&&H.hasOwnProperty(Bt)&&H[Bt]!=null)if(Bt==="style"){var Ye=H[Bt];for(be in Ye)Ye.hasOwnProperty(be)&&(A||(A={}),A[be]="")}else Bt!=="dangerouslySetInnerHTML"&&Bt!=="children"&&Bt!=="suppressContentEditableWarning"&&Bt!=="suppressHydrationWarning"&&Bt!=="autoFocus"&&(w.hasOwnProperty(Bt)?Q||(Q=[]):(Q=Q||[]).push(Bt,null));for(Bt in D){var ot=D[Bt];if(Ye=H!=null?H[Bt]:void 0,D.hasOwnProperty(Bt)&&ot!==Ye&&(ot!=null||Ye!=null))if(Bt==="style")if(Ye){for(be in Ye)!Ye.hasOwnProperty(be)||ot&&ot.hasOwnProperty(be)||(A||(A={}),A[be]="");for(be in ot)ot.hasOwnProperty(be)&&Ye[be]!==ot[be]&&(A||(A={}),A[be]=ot[be])}else A||(Q||(Q=[]),Q.push(Bt,A)),A=ot;else Bt==="dangerouslySetInnerHTML"?(ot=ot?ot.__html:void 0,Ye=Ye?Ye.__html:void 0,ot!=null&&Ye!==ot&&(Q=Q||[]).push(Bt,ot)):Bt==="children"?typeof ot!="string"&&typeof ot!="number"||(Q=Q||[]).push(Bt,""+ot):Bt!=="suppressContentEditableWarning"&&Bt!=="suppressHydrationWarning"&&(w.hasOwnProperty(Bt)?(ot!=null&&Bt==="onScroll"&&Zr("scroll",f),Q||Ye===ot||(Q=[])):(Q=Q||[]).push(Bt,ot))}A&&(Q=Q||[]).push("style",A);var Bt=Q;(y.updateQueue=Bt)&&(y.flags|=4)}},uh=function(f,y,A,D){A!==D&&(y.flags|=4)};function pu(f,y){if(!ss)switch(f.tailMode){case"hidden":y=f.tail;for(var A=null;y!==null;)y.alternate!==null&&(A=y),y=y.sibling;A===null?f.tail=null:A.sibling=null;break;case"collapsed":A=f.tail;for(var D=null;A!==null;)A.alternate!==null&&(D=A),A=A.sibling;D===null?y||f.tail===null?f.tail=null:f.tail.sibling=null:D.sibling=null}}function qs(f){var y=f.alternate!==null&&f.alternate.child===f.child,A=0,D=0;if(y)for(var H=f.child;H!==null;)A|=H.lanes|H.childLanes,D|=H.subtreeFlags&14680064,D|=H.flags&14680064,H.return=f,H=H.sibling;else for(H=f.child;H!==null;)A|=H.lanes|H.childLanes,D|=H.subtreeFlags,D|=H.flags,H.return=f,H=H.sibling;return f.subtreeFlags|=D,f.childLanes=A,y}function dd(f,y,A){var D=y.pendingProps;switch(Gd(y),y.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(y),null;case 1:return Xs(y.type)&&Jc(),qs(y),null;case 3:return D=y.stateNode,Xo(),Kr(ko),Kr(fs),Ra(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(f===null||f.child===null)&&(mc(y)?y.flags|=4:f===null||f.memoizedState.isDehydrated&&(y.flags&256)===0||(y.flags|=1024,Ys!==null&&(Pn(Ys),Ys=null))),hd(f,y),qs(y),null;case 5:th(y);var H=Pl(Qs.current);if(A=y.type,f!==null&&y.stateNode!=null)ef(f,y,A,D,H),f.ref!==y.ref&&(y.flags|=512,y.flags|=2097152);else{if(!D){if(y.stateNode===null)throw Error(m(166));return qs(y),null}if(f=Pl(rl.current),mc(y)){D=y.stateNode,A=y.type;var Q=y.memoizedProps;switch(D[ka]=y,D[$u]=Q,f=(y.mode&1)!==0,A){case"dialog":Zr("cancel",D),Zr("close",D);break;case"iframe":case"object":case"embed":Zr("load",D);break;case"video":case"audio":for(H=0;H<dc.length;H++)Zr(dc[H],D);break;case"source":Zr("error",D);break;case"img":case"image":case"link":Zr("error",D),Zr("load",D);break;case"details":Zr("toggle",D);break;case"input":zi(D,Q),Zr("invalid",D);break;case"select":D._wrapperState={wasMultiple:!!Q.multiple},Zr("invalid",D);break;case"textarea":as(D,Q),Zr("invalid",D)}ro(A,Q),H=null;for(var be in Q)if(Q.hasOwnProperty(be)){var Ye=Q[be];be==="children"?typeof Ye=="string"?D.textContent!==Ye&&(Q.suppressHydrationWarning!==!0&&Wa(D.textContent,Ye,f),H=["children",Ye]):typeof Ye=="number"&&D.textContent!==""+Ye&&(Q.suppressHydrationWarning!==!0&&Wa(D.textContent,Ye,f),H=["children",""+Ye]):w.hasOwnProperty(be)&&Ye!=null&&be==="onScroll"&&Zr("scroll",D)}switch(A){case"input":Ci(D),ys(D,Q,!0);break;case"textarea":Ci(D),Gs(D);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(D.onclick=El)}D=H,y.updateQueue=D,D!==null&&(y.flags|=4)}else{be=H.nodeType===9?H:H.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=ho(A)),f==="http://www.w3.org/1999/xhtml"?A==="script"?(f=be.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof D.is=="string"?f=be.createElement(A,{is:D.is}):(f=be.createElement(A),A==="select"&&(be=f,D.multiple?be.multiple=!0:D.size&&(be.size=D.size))):f=be.createElementNS(f,A),f[ka]=y,f[$u]=D,ud(f,y,!1,!1),y.stateNode=f;e:{switch(be=Ca(A,D),A){case"dialog":Zr("cancel",f),Zr("close",f),H=D;break;case"iframe":case"object":case"embed":Zr("load",f),H=D;break;case"video":case"audio":for(H=0;H<dc.length;H++)Zr(dc[H],f);H=D;break;case"source":Zr("error",f),H=D;break;case"img":case"image":case"link":Zr("error",f),Zr("load",f),H=D;break;case"details":Zr("toggle",f),H=D;break;case"input":zi(f,D),H=ki(f,D),Zr("invalid",f);break;case"option":H=D;break;case"select":f._wrapperState={wasMultiple:!!D.multiple},H=qt({},D,{value:void 0}),Zr("invalid",f);break;case"textarea":as(f,D),H=Ss(f,D),Zr("invalid",f);break;default:H=D}ro(A,H),Ye=H;for(Q in Ye)if(Ye.hasOwnProperty(Q)){var ot=Ye[Q];Q==="style"?br(f,ot):Q==="dangerouslySetInnerHTML"?(ot=ot?ot.__html:void 0,ot!=null&&ci(f,ot)):Q==="children"?typeof ot=="string"?(A!=="textarea"||ot!=="")&&Cs(f,ot):typeof ot=="number"&&Cs(f,""+ot):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(w.hasOwnProperty(Q)?ot!=null&&Q==="onScroll"&&Zr("scroll",f):ot!=null&&ye(f,Q,ot,be))}switch(A){case"input":Ci(f),ys(f,D,!1);break;case"textarea":Ci(f),Gs(f);break;case"option":D.value!=null&&f.setAttribute("value",""+Hn(D.value));break;case"select":f.multiple=!!D.multiple,Q=D.value,Q!=null?sr(f,!!D.multiple,Q,!1):D.defaultValue!=null&&sr(f,!!D.multiple,D.defaultValue,!0);break;default:typeof H.onClick=="function"&&(f.onclick=El)}switch(A){case"button":case"input":case"select":case"textarea":D=!!D.autoFocus;break e;case"img":D=!0;break e;default:D=!1}}D&&(y.flags|=4)}y.ref!==null&&(y.flags|=512,y.flags|=2097152)}return qs(y),null;case 6:if(f&&y.stateNode!=null)uh(f,y,f.memoizedProps,D);else{if(typeof D!="string"&&y.stateNode===null)throw Error(m(166));if(A=Pl(Qs.current),Pl(rl.current),mc(y)){if(D=y.stateNode,A=y.memoizedProps,D[ka]=y,(Q=D.nodeValue!==A)&&(f=Es,f!==null))switch(f.tag){case 3:Wa(D.nodeValue,A,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&Wa(D.nodeValue,A,(f.mode&1)!==0)}Q&&(y.flags|=4)}else D=(A.nodeType===9?A:A.ownerDocument).createTextNode(D),D[ka]=y,y.stateNode=D}return qs(y),null;case 13:if(Kr(ts),D=y.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(ss&&js!==null&&(y.mode&1)!==0&&(y.flags&128)===0)Vp(),iu(),y.flags|=98560,Q=!1;else if(Q=mc(y),D!==null&&D.dehydrated!==null){if(f===null){if(!Q)throw Error(m(318));if(Q=y.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(m(317));Q[ka]=y}else iu(),(y.flags&128)===0&&(y.memoizedState=null),y.flags|=4;qs(y),Q=!1}else Ys!==null&&(Pn(Ys),Ys=null),Q=!0;if(!Q)return y.flags&65536?y:null}return(y.flags&128)!==0?(y.lanes=A,y):(D=D!==null,D!==(f!==null&&f.memoizedState!==null)&&D&&(y.child.flags|=8192,(y.mode&1)!==0&&(f===null||(ts.current&1)!==0?Ae===0&&(Ae=3):er())),y.updateQueue!==null&&(y.flags|=4),qs(y),null);case 4:return Xo(),hd(f,y),f===null&&qh(y.stateNode.containerInfo),qs(y),null;case 10:return Ju(y.type._context),qs(y),null;case 17:return Xs(y.type)&&Jc(),qs(y),null;case 19:if(Kr(ts),Q=y.memoizedState,Q===null)return qs(y),null;if(D=(y.flags&128)!==0,be=Q.rendering,be===null)if(D)pu(Q,!1);else{if(Ae!==0||f!==null&&(f.flags&128)!==0)for(f=y.child;f!==null;){if(be=kl(f),be!==null){for(y.flags|=128,pu(Q,!1),D=be.updateQueue,D!==null&&(y.updateQueue=D,y.flags|=4),y.subtreeFlags=0,D=A,A=y.child;A!==null;)Q=A,f=D,Q.flags&=14680066,be=Q.alternate,be===null?(Q.childLanes=0,Q.lanes=f,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=be.childLanes,Q.lanes=be.lanes,Q.child=be.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=be.memoizedProps,Q.memoizedState=be.memoizedState,Q.updateQueue=be.updateQueue,Q.type=be.type,f=be.dependencies,Q.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),A=A.sibling;return es(ts,ts.current&1|2),y.child}f=f.sibling}Q.tail!==null&&fi()>ft&&(y.flags|=128,D=!0,pu(Q,!1),y.lanes=4194304)}else{if(!D)if(f=kl(be),f!==null){if(y.flags|=128,D=!0,A=f.updateQueue,A!==null&&(y.updateQueue=A,y.flags|=4),pu(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!be.alternate&&!ss)return qs(y),null}else 2*fi()-Q.renderingStartTime>ft&&A!==1073741824&&(y.flags|=128,D=!0,pu(Q,!1),y.lanes=4194304);Q.isBackwards?(be.sibling=y.child,y.child=be):(A=Q.last,A!==null?A.sibling=be:y.child=be,Q.last=be)}return Q.tail!==null?(y=Q.tail,Q.rendering=y,Q.tail=y.sibling,Q.renderingStartTime=fi(),y.sibling=null,A=ts.current,es(ts,D?A&1|2:A&1),y):(qs(y),null);case 22:case 23:return Dr(),D=y.memoizedState!==null,f!==null&&f.memoizedState!==null!==D&&(y.flags|=8192),D&&(y.mode&1)!==0?(pe&1073741824)!==0&&(qs(y),y.subtreeFlags&6&&(y.flags|=8192)):qs(y),null;case 24:return null;case 25:return null}throw Error(m(156,y.tag))}function Ol(f,y){switch(Gd(y),y.tag){case 1:return Xs(y.type)&&Jc(),f=y.flags,f&65536?(y.flags=f&-65537|128,y):null;case 3:return Xo(),Kr(ko),Kr(fs),Ra(),f=y.flags,(f&65536)!==0&&(f&128)===0?(y.flags=f&-65537|128,y):null;case 5:return th(y),null;case 13:if(Kr(ts),f=y.memoizedState,f!==null&&f.dehydrated!==null){if(y.alternate===null)throw Error(m(340));iu()}return f=y.flags,f&65536?(y.flags=f&-65537|128,y):null;case 19:return Kr(ts),null;case 4:return Xo(),null;case 10:return Ju(y.type._context),null;case 22:case 23:return Dr(),null;case 24:return null;default:return null}}var fu=!1,Ui=!1,ul=typeof WeakSet=="function"?WeakSet:Set,Fn=null;function Bl(f,y){var A=f.ref;if(A!==null)if(typeof A=="function")try{A(null)}catch(D){$n(f,y,D)}else A.current=null}function dp(f,y,A){try{A()}catch(D){$n(f,y,D)}}var Gf=!1;function hh(f,y){if(Vu=Ph,f=zd(),Fh(f)){if("selectionStart"in f)var A={start:f.selectionStart,end:f.selectionEnd};else e:{A=(A=f.ownerDocument)&&A.defaultView||window;var D=A.getSelection&&A.getSelection();if(D&&D.rangeCount!==0){A=D.anchorNode;var H=D.anchorOffset,Q=D.focusNode;D=D.focusOffset;try{A.nodeType,Q.nodeType}catch{A=null;break e}var be=0,Ye=-1,ot=-1,Bt=0,mn=0,gn=f,dn=null;t:for(;;){for(var jn;gn!==A||H!==0&&gn.nodeType!==3||(Ye=be+H),gn!==Q||D!==0&&gn.nodeType!==3||(ot=be+D),gn.nodeType===3&&(be+=gn.nodeValue.length),(jn=gn.firstChild)!==null;)dn=gn,gn=jn;for(;;){if(gn===f)break t;if(dn===A&&++Bt===H&&(Ye=be),dn===Q&&++mn===D&&(ot=be),(jn=gn.nextSibling)!==null)break;gn=dn,dn=gn.parentNode}gn=jn}A=Ye===-1||ot===-1?null:{start:Ye,end:ot}}else A=null}A=A||{start:0,end:0}}else A=null;for(qu={focusedElem:f,selectionRange:A},Ph=!1,Fn=y;Fn!==null;)if(y=Fn,f=y.child,(y.subtreeFlags&1028)!==0&&f!==null)f.return=y,Fn=f;else for(;Fn!==null;){y=Fn;try{var Kn=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(Kn!==null){var ei=Kn.memoizedProps,Ms=Kn.memoizedState,It=y.stateNode,vt=It.getSnapshotBeforeUpdate(y.elementType===y.type?ei:_o(y.type,ei),Ms);It.__reactInternalSnapshotBeforeUpdate=vt}break;case 3:var zt=y.stateNode.containerInfo;zt.nodeType===1?zt.textContent="":zt.nodeType===9&&zt.documentElement&&zt.removeChild(zt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(m(163))}}catch(Tn){$n(y,y.return,Tn)}if(f=y.sibling,f!==null){f.return=y.return,Fn=f;break}Fn=y.return}return Kn=Gf,Gf=!1,Kn}function mu(f,y,A){var D=y.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var H=D=D.next;do{if((H.tag&f)===f){var Q=H.destroy;H.destroy=void 0,Q!==void 0&&dp(y,A,Q)}H=H.next}while(H!==D)}}function ca(f,y){if(y=y.updateQueue,y=y!==null?y.lastEffect:null,y!==null){var A=y=y.next;do{if((A.tag&f)===f){var D=A.create;A.destroy=D()}A=A.next}while(A!==y)}}function gu(f){var y=f.ref;if(y!==null){var A=f.stateNode;switch(f.tag){case 5:f=A;break;default:f=A}typeof y=="function"?y(f):y.current=f}}function pp(f){var y=f.alternate;y!==null&&(f.alternate=null,pp(y)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(y=f.stateNode,y!==null&&(delete y[ka],delete y[$u],delete y[Ya],delete y[Df],delete y[Of])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function dh(f){return f.tag===5||f.tag===3||f.tag===4}function _u(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||dh(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function Oa(f,y,A){var D=f.tag;if(D===5||D===6)f=f.stateNode,y?A.nodeType===8?A.parentNode.insertBefore(f,y):A.insertBefore(f,y):(A.nodeType===8?(y=A.parentNode,y.insertBefore(f,A)):(y=A,y.appendChild(f)),A=A._reactRootContainer,A!=null||y.onclick!==null||(y.onclick=El));else if(D!==4&&(f=f.child,f!==null))for(Oa(f,y,A),f=f.sibling;f!==null;)Oa(f,y,A),f=f.sibling}function ua(f,y,A){var D=f.tag;if(D===5||D===6)f=f.stateNode,y?A.insertBefore(f,y):A.appendChild(f);else if(D!==4&&(f=f.child,f!==null))for(ua(f,y,A),f=f.sibling;f!==null;)ua(f,y,A),f=f.sibling}var qr=null,vo=!1;function u(f,y,A){for(A=A.child;A!==null;)t(f,y,A),A=A.sibling}function t(f,y,A){if(ls&&typeof ls.onCommitFiberUnmount=="function")try{ls.onCommitFiberUnmount(ds,A)}catch{}switch(A.tag){case 5:Ui||Bl(A,y);case 6:var D=qr,H=vo;qr=null,u(f,y,A),qr=D,vo=H,qr!==null&&(vo?(f=qr,A=A.stateNode,f.nodeType===8?f.parentNode.removeChild(A):f.removeChild(A)):qr.removeChild(A.stateNode));break;case 18:qr!==null&&(vo?(f=qr,A=A.stateNode,f.nodeType===8?Uu(f.parentNode,A):f.nodeType===1&&Uu(f,A),Fc(f)):Uu(qr,A.stateNode));break;case 4:D=qr,H=vo,qr=A.stateNode.containerInfo,vo=!0,u(f,y,A),qr=D,vo=H;break;case 0:case 11:case 14:case 15:if(!Ui&&(D=A.updateQueue,D!==null&&(D=D.lastEffect,D!==null))){H=D=D.next;do{var Q=H,be=Q.destroy;Q=Q.tag,be!==void 0&&((Q&2)!==0||(Q&4)!==0)&&dp(A,y,be),H=H.next}while(H!==D)}u(f,y,A);break;case 1:if(!Ui&&(Bl(A,y),D=A.stateNode,typeof D.componentWillUnmount=="function"))try{D.props=A.memoizedProps,D.state=A.memoizedState,D.componentWillUnmount()}catch(Ye){$n(A,y,Ye)}u(f,y,A);break;case 21:u(f,y,A);break;case 22:A.mode&1?(Ui=(D=Ui)||A.memoizedState!==null,u(f,y,A),Ui=D):u(f,y,A);break;default:u(f,y,A)}}function s(f){var y=f.updateQueue;if(y!==null){f.updateQueue=null;var A=f.stateNode;A===null&&(A=f.stateNode=new ul),y.forEach(function(D){var H=Pi.bind(null,f,D);A.has(D)||(A.add(D),D.then(H,H))})}}function h(f,y){var A=y.deletions;if(A!==null)for(var D=0;D<A.length;D++){var H=A[D];try{var Q=f,be=y,Ye=be;e:for(;Ye!==null;){switch(Ye.tag){case 5:qr=Ye.stateNode,vo=!1;break e;case 3:qr=Ye.stateNode.containerInfo,vo=!0;break e;case 4:qr=Ye.stateNode.containerInfo,vo=!0;break e}Ye=Ye.return}if(qr===null)throw Error(m(160));t(Q,be,H),qr=null,vo=!1;var ot=H.alternate;ot!==null&&(ot.return=null),H.return=null}catch(Bt){$n(H,y,Bt)}}if(y.subtreeFlags&12854)for(y=y.child;y!==null;)g(y,f),y=y.sibling}function g(f,y){var A=f.alternate,D=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(h(y,f),v(f),D&4){try{mu(3,f,f.return),ca(3,f)}catch(ei){$n(f,f.return,ei)}try{mu(5,f,f.return)}catch(ei){$n(f,f.return,ei)}}break;case 1:h(y,f),v(f),D&512&&A!==null&&Bl(A,A.return);break;case 5:if(h(y,f),v(f),D&512&&A!==null&&Bl(A,A.return),f.flags&32){var H=f.stateNode;try{Cs(H,"")}catch(ei){$n(f,f.return,ei)}}if(D&4&&(H=f.stateNode,H!=null)){var Q=f.memoizedProps,be=A!==null?A.memoizedProps:Q,Ye=f.type,ot=f.updateQueue;if(f.updateQueue=null,ot!==null)try{Ye==="input"&&Q.type==="radio"&&Q.name!=null&&Pr(H,Q),Ca(Ye,be);var Bt=Ca(Ye,Q);for(be=0;be<ot.length;be+=2){var mn=ot[be],gn=ot[be+1];mn==="style"?br(H,gn):mn==="dangerouslySetInnerHTML"?ci(H,gn):mn==="children"?Cs(H,gn):ye(H,mn,gn,Bt)}switch(Ye){case"input":Gr(H,Q);break;case"textarea":Hi(H,Q);break;case"select":var dn=H._wrapperState.wasMultiple;H._wrapperState.wasMultiple=!!Q.multiple;var jn=Q.value;jn!=null?sr(H,!!Q.multiple,jn,!1):dn!==!!Q.multiple&&(Q.defaultValue!=null?sr(H,!!Q.multiple,Q.defaultValue,!0):sr(H,!!Q.multiple,Q.multiple?[]:"",!1))}H[$u]=Q}catch(ei){$n(f,f.return,ei)}}break;case 6:if(h(y,f),v(f),D&4){if(f.stateNode===null)throw Error(m(162));H=f.stateNode,Q=f.memoizedProps;try{H.nodeValue=Q}catch(ei){$n(f,f.return,ei)}}break;case 3:if(h(y,f),v(f),D&4&&A!==null&&A.memoizedState.isDehydrated)try{Fc(y.containerInfo)}catch(ei){$n(f,f.return,ei)}break;case 4:h(y,f),v(f);break;case 13:h(y,f),v(f),H=f.child,H.flags&8192&&(Q=H.memoizedState!==null,H.stateNode.isHidden=Q,!Q||H.alternate!==null&&H.alternate.memoizedState!==null||(Qe=fi())),D&4&&s(f);break;case 22:if(mn=A!==null&&A.memoizedState!==null,f.mode&1?(Ui=(Bt=Ui)||mn,h(y,f),Ui=Bt):h(y,f),v(f),D&8192){if(Bt=f.memoizedState!==null,(f.stateNode.isHidden=Bt)&&!mn&&(f.mode&1)!==0)for(Fn=f,mn=f.child;mn!==null;){for(gn=Fn=mn;Fn!==null;){switch(dn=Fn,jn=dn.child,dn.tag){case 0:case 11:case 14:case 15:mu(4,dn,dn.return);break;case 1:Bl(dn,dn.return);var Kn=dn.stateNode;if(typeof Kn.componentWillUnmount=="function"){D=dn,A=dn.return;try{y=D,Kn.props=y.memoizedProps,Kn.state=y.memoizedState,Kn.componentWillUnmount()}catch(ei){$n(D,A,ei)}}break;case 5:Bl(dn,dn.return);break;case 22:if(dn.memoizedState!==null){z(gn);continue}}jn!==null?(jn.return=dn,Fn=jn):z(gn)}mn=mn.sibling}e:for(mn=null,gn=f;;){if(gn.tag===5){if(mn===null){mn=gn;try{H=gn.stateNode,Bt?(Q=H.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(Ye=gn.stateNode,ot=gn.memoizedProps.style,be=ot!=null&&ot.hasOwnProperty("display")?ot.display:null,Ye.style.display=hi("display",be))}catch(ei){$n(f,f.return,ei)}}}else if(gn.tag===6){if(mn===null)try{gn.stateNode.nodeValue=Bt?"":gn.memoizedProps}catch(ei){$n(f,f.return,ei)}}else if((gn.tag!==22&&gn.tag!==23||gn.memoizedState===null||gn===f)&&gn.child!==null){gn.child.return=gn,gn=gn.child;continue}if(gn===f)break e;for(;gn.sibling===null;){if(gn.return===null||gn.return===f)break e;mn===gn&&(mn=null),gn=gn.return}mn===gn&&(mn=null),gn.sibling.return=gn.return,gn=gn.sibling}}break;case 19:h(y,f),v(f),D&4&&s(f);break;case 21:break;default:h(y,f),v(f)}}function v(f){var y=f.flags;if(y&2){try{e:{for(var A=f.return;A!==null;){if(dh(A)){var D=A;break e}A=A.return}throw Error(m(160))}switch(D.tag){case 5:var H=D.stateNode;D.flags&32&&(Cs(H,""),D.flags&=-33);var Q=_u(f);ua(f,Q,H);break;case 3:case 4:var be=D.stateNode.containerInfo,Ye=_u(f);Oa(f,Ye,be);break;default:throw Error(m(161))}}catch(ot){$n(f,f.return,ot)}f.flags&=-3}y&4096&&(f.flags&=-4097)}function b(f,y,A){Fn=f,E(f)}function E(f,y,A){for(var D=(f.mode&1)!==0;Fn!==null;){var H=Fn,Q=H.child;if(H.tag===22&&D){var be=H.memoizedState!==null||fu;if(!be){var Ye=H.alternate,ot=Ye!==null&&Ye.memoizedState!==null||Ui;Ye=fu;var Bt=Ui;if(fu=be,(Ui=ot)&&!Bt)for(Fn=H;Fn!==null;)be=Fn,ot=be.child,be.tag===22&&be.memoizedState!==null?L(H):ot!==null?(ot.return=be,Fn=ot):L(H);for(;Q!==null;)Fn=Q,E(Q),Q=Q.sibling;Fn=H,fu=Ye,Ui=Bt}I(f)}else(H.subtreeFlags&8772)!==0&&Q!==null?(Q.return=H,Fn=Q):I(f)}}function I(f){for(;Fn!==null;){var y=Fn;if((y.flags&8772)!==0){var A=y.alternate;try{if((y.flags&8772)!==0)switch(y.tag){case 0:case 11:case 15:Ui||ca(5,y);break;case 1:var D=y.stateNode;if(y.flags&4&&!Ui)if(A===null)D.componentDidMount();else{var H=y.elementType===y.type?A.memoizedProps:_o(y.type,A.memoizedProps);D.componentDidUpdate(H,A.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var Q=y.updateQueue;Q!==null&&jf(y,Q,D);break;case 3:var be=y.updateQueue;if(be!==null){if(A=null,y.child!==null)switch(y.child.tag){case 5:A=y.child.stateNode;break;case 1:A=y.child.stateNode}jf(y,be,A)}break;case 5:var Ye=y.stateNode;if(A===null&&y.flags&4){A=Ye;var ot=y.memoizedProps;switch(y.type){case"button":case"input":case"select":case"textarea":ot.autoFocus&&A.focus();break;case"img":ot.src&&(A.src=ot.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(y.memoizedState===null){var Bt=y.alternate;if(Bt!==null){var mn=Bt.memoizedState;if(mn!==null){var gn=mn.dehydrated;gn!==null&&Fc(gn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(m(163))}Ui||y.flags&512&&gu(y)}catch(dn){$n(y,y.return,dn)}}if(y===f){Fn=null;break}if(A=y.sibling,A!==null){A.return=y.return,Fn=A;break}Fn=y.return}}function z(f){for(;Fn!==null;){var y=Fn;if(y===f){Fn=null;break}var A=y.sibling;if(A!==null){A.return=y.return,Fn=A;break}Fn=y.return}}function L(f){for(;Fn!==null;){var y=Fn;try{switch(y.tag){case 0:case 11:case 15:var A=y.return;try{ca(4,y)}catch(ot){$n(y,A,ot)}break;case 1:var D=y.stateNode;if(typeof D.componentDidMount=="function"){var H=y.return;try{D.componentDidMount()}catch(ot){$n(y,H,ot)}}var Q=y.return;try{gu(y)}catch(ot){$n(y,Q,ot)}break;case 5:var be=y.return;try{gu(y)}catch(ot){$n(y,be,ot)}}}catch(ot){$n(y,y.return,ot)}if(y===f){Fn=null;break}var Ye=y.sibling;if(Ye!==null){Ye.return=y.return,Fn=Ye;break}Fn=y.return}}var N=Math.ceil,F=Le.ReactCurrentDispatcher,q=Le.ReactCurrentOwner,X=Le.ReactCurrentBatchConfig,G=0,Y=null,J=null,re=0,pe=0,_e=Qa(0),Ae=0,Ie=null,Te=0,ve=0,Pe=0,Me=null,We=null,Qe=0,ft=1/0,pt=null,Et=!1,Ke=null,st=null,Ve=!1,_t=null,nt=0,Tt=0,jt=null,yt=-1,Lt=0;function Yt(){return(G&6)!==0?fi():yt!==-1?yt:yt=fi()}function tn(f){return(f.mode&1)===0?1:(G&2)!==0&&re!==0?re&-re:Zm.transition!==null?(Lt===0&&(Lt=fa()),Lt):(f=ar,f!==0||(f=window.event,f=f===void 0?16:rc(f.type)),f)}function Xt(f,y,A,D){if(50<Tt)throw Tt=0,jt=null,Error(m(185));po(f,A,D),((G&2)===0||f!==Y)&&(f===Y&&((G&2)===0&&(ve|=A),Ae===4&&vi(f,re)),rn(f,D),A===1&&G===0&&(y.mode&1)===0&&(ft=fi()+500,Zu&&Zo()))}function rn(f,y){var A=f.callbackNode;Ch(f,y);var D=zc(f,f===Y?re:0);if(D===0)A!==null&&ni(A),f.callbackNode=null,f.callbackPriority=0;else if(y=D&-D,f.callbackPriority!==y){if(A!=null&&ni(A),y===1)f.tag===0?Bf(Ji.bind(null,f)):Np(Ji.bind(null,f)),Hu(function(){(G&6)===0&&Zo()}),A=null;else{switch(Eu(D)){case 1:A=Li;break;case 4:A=Ii;break;case 16:A=kr;break;case 536870912:A=Sr;break;default:A=kr}A=xo(A,fn.bind(null,f))}f.callbackPriority=y,f.callbackNode=A}}function fn(f,y){if(yt=-1,Lt=0,(G&6)!==0)throw Error(m(327));var A=f.callbackNode;if(Ni()&&f.callbackNode!==A)return null;var D=zc(f,f===Y?re:0);if(D===0)return null;if((D&30)!==0||(D&f.expiredLanes)!==0||y)y=Hr(f,D);else{y=D;var H=G;G|=2;var Q=si();(Y!==f||re!==y)&&(pt=null,ft=fi()+500,Dn(f,y));do try{Mi();break}catch(Ye){Zn(f,Ye)}while(!0);vc(),F.current=Q,G=H,J!==null?y=0:(Y=null,re=0,y=Ae)}if(y!==0){if(y===2&&(H=Cu(f),H!==0&&(D=H,y=_n(f,H))),y===1)throw A=Ie,Dn(f,0),vi(f,D),rn(f,fi()),A;if(y===6)vi(f,D);else{if(H=f.current.alternate,(D&30)===0&&!Wn(H)&&(y=Hr(f,D),y===2&&(Q=Cu(f),Q!==0&&(D=Q,y=_n(f,Q))),y===1))throw A=Ie,Dn(f,0),vi(f,D),rn(f,fi()),A;switch(f.finishedWork=H,f.finishedLanes=D,y){case 0:case 1:throw Error(m(345));case 2:Rr(f,We,pt);break;case 3:if(vi(f,D),(D&130023424)===D&&(y=Qe+500-fi(),10<y)){if(zc(f,0)!==0)break;if(H=f.suspendedLanes,(H&D)!==D){Yt(),f.pingedLanes|=f.suspendedLanes&H;break}f.timeoutHandle=jd(Rr.bind(null,f,We,pt),y);break}Rr(f,We,pt);break;case 4:if(vi(f,D),(D&4194240)===D)break;for(y=f.eventTimes,H=-1;0<D;){var be=31-Ao(D);Q=1<<be,be=y[be],be>H&&(H=be),D&=~Q}if(D=H,D=fi()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*N(D/1960))-D,10<D){f.timeoutHandle=jd(Rr.bind(null,f,We,pt),D);break}Rr(f,We,pt);break;case 5:Rr(f,We,pt);break;default:throw Error(m(329))}}}return rn(f,fi()),f.callbackNode===A?fn.bind(null,f):null}function _n(f,y){var A=Me;return f.current.memoizedState.isDehydrated&&(Dn(f,y).flags|=256),f=Hr(f,y),f!==2&&(y=We,We=A,y!==null&&Pn(y)),f}function Pn(f){We===null?We=f:We.push.apply(We,f)}function Wn(f){for(var y=f;;){if(y.flags&16384){var A=y.updateQueue;if(A!==null&&(A=A.stores,A!==null))for(var D=0;D<A.length;D++){var H=A[D],Q=H.getSnapshot;H=H.value;try{if(!va(Q(),H))return!1}catch{return!1}}}if(A=y.child,y.subtreeFlags&16384&&A!==null)A.return=y,y=A;else{if(y===f)break;for(;y.sibling===null;){if(y.return===null||y.return===f)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function vi(f,y){for(y&=~Pe,y&=~ve,f.suspendedLanes|=y,f.pingedLanes&=~y,f=f.expirationTimes;0<y;){var A=31-Ao(y),D=1<<A;f[A]=-1,y&=~D}}function Ji(f){if((G&6)!==0)throw Error(m(327));Ni();var y=zc(f,0);if((y&1)===0)return rn(f,fi()),null;var A=Hr(f,y);if(f.tag!==0&&A===2){var D=Cu(f);D!==0&&(y=D,A=_n(f,D))}if(A===1)throw A=Ie,Dn(f,0),vi(f,y),rn(f,fi()),A;if(A===6)throw Error(m(345));return f.finishedWork=f.current.alternate,f.finishedLanes=y,Rr(f,We,pt),rn(f,fi()),null}function Oi(f,y){var A=G;G|=1;try{return f(y)}finally{G=A,G===0&&(ft=fi()+500,Zu&&Zo())}}function Ai(f){_t!==null&&_t.tag===0&&(G&6)===0&&Ni();var y=G;G|=1;var A=X.transition,D=ar;try{if(X.transition=null,ar=1,f)return f()}finally{ar=D,X.transition=A,G=y,(G&6)===0&&Zo()}}function Dr(){pe=_e.current,Kr(_e)}function Dn(f,y){f.finishedWork=null,f.finishedLanes=0;var A=f.timeoutHandle;if(A!==-1&&(f.timeoutHandle=-1,Fp(A)),J!==null)for(A=J.return;A!==null;){var D=A;switch(Gd(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&Jc();break;case 3:Xo(),Kr(ko),Kr(fs),Ra();break;case 5:th(D);break;case 4:Xo();break;case 13:Kr(ts);break;case 19:Kr(ts);break;case 10:Ju(D.type._context);break;case 22:case 23:Dr()}A=A.return}if(Y=f,J=f=Bo(f.current,null),re=pe=y,Ae=0,Ie=null,Pe=ve=Te=0,We=Me=null,Ro!==null){for(y=0;y<Ro.length;y++)if(A=Ro[y],D=A.interleaved,D!==null){A.interleaved=null;var H=D.next,Q=A.pending;if(Q!==null){var be=Q.next;Q.next=H,D.next=be}A.pending=D}Ro=null}return f}function Zn(f,y){do{var A=J;try{if(vc(),ji.current=Da,Xd){for(var D=us.memoizedState;D!==null;){var H=D.queue;H!==null&&(H.pending=null),D=D.next}Xd=!1}if(Yo=0,Ns=Is=us=null,sl=!1,za=0,q.current=null,A===null||A.return===null){Ae=1,Ie=y,J=null;break}e:{var Q=f,be=A.return,Ye=A,ot=y;if(y=re,Ye.flags|=32768,ot!==null&&typeof ot=="object"&&typeof ot.then=="function"){var Bt=ot,mn=Ye,gn=mn.tag;if((mn.mode&1)===0&&(gn===0||gn===11||gn===15)){var dn=mn.alternate;dn?(mn.updateQueue=dn.updateQueue,mn.memoizedState=dn.memoizedState,mn.lanes=dn.lanes):(mn.updateQueue=null,mn.memoizedState=null)}var jn=ap(be);if(jn!==null){jn.flags&=-257,od(jn,be,Ye,Q,y),jn.mode&1&&ah(Q,Bt,y),y=jn,ot=Bt;var Kn=y.updateQueue;if(Kn===null){var ei=new Set;ei.add(ot),y.updateQueue=ei}else Kn.add(ot);break e}else{if((y&1)===0){ah(Q,Bt,y),er();break e}ot=Error(m(426))}}else if(ss&&Ye.mode&1){var Ms=ap(be);if(Ms!==null){(Ms.flags&65536)===0&&(Ms.flags|=256),od(Ms,be,Ye,Q,y),Ko(cl(ot,Ye));break e}}Q=ot=cl(ot,Ye),Ae!==4&&(Ae=2),Me===null?Me=[Q]:Me.push(Q),Q=be;do{switch(Q.tag){case 3:Q.flags|=65536,y&=-y,Q.lanes|=y;var It=op(Q,ot,y);Zd(Q,It);break e;case 1:Ye=ot;var vt=Q.type,zt=Q.stateNode;if((Q.flags&128)===0&&(typeof vt.getDerivedStateFromError=="function"||zt!==null&&typeof zt.componentDidCatch=="function"&&(st===null||!st.has(zt)))){Q.flags|=65536,y&=-y,Q.lanes|=y;var Tn=Dl(Q,Ye,y);Zd(Q,Tn);break e}}Q=Q.return}while(Q!==null)}yi(A)}catch(ui){y=ui,J===A&&A!==null&&(J=A=A.return);continue}break}while(!0)}function si(){var f=F.current;return F.current=Da,f===null?Da:f}function er(){(Ae===0||Ae===3||Ae===2)&&(Ae=4),Y===null||(Te&268435455)===0&&(ve&268435455)===0||vi(Y,re)}function Hr(f,y){var A=G;G|=2;var D=si();(Y!==f||re!==y)&&(pt=null,Dn(f,y));do try{nr();break}catch(H){Zn(f,H)}while(!0);if(vc(),G=A,F.current=D,J!==null)throw Error(m(261));return Y=null,re=0,Ae}function nr(){for(;J!==null;)Mr(J)}function Mi(){for(;J!==null&&!Un();)Mr(J)}function Mr(f){var y=Do(f.alternate,f,pe);f.memoizedProps=f.pendingProps,y===null?yi(f):J=y,q.current=null}function yi(f){var y=f;do{var A=y.alternate;if(f=y.return,(y.flags&32768)===0){if(A=dd(A,y,pe),A!==null){J=A;return}}else{if(A=Ol(A,y),A!==null){A.flags&=32767,J=A;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{Ae=6,J=null;return}}if(y=y.sibling,y!==null){J=y;return}J=y=f}while(y!==null);Ae===0&&(Ae=5)}function Rr(f,y,A){var D=ar,H=X.transition;try{X.transition=null,ar=1,cr(f,y,A,D)}finally{X.transition=H,ar=D}return null}function cr(f,y,A,D){do Ni();while(_t!==null);if((G&6)!==0)throw Error(m(327));A=f.finishedWork;var H=f.finishedLanes;if(A===null)return null;if(f.finishedWork=null,f.finishedLanes=0,A===f.current)throw Error(m(177));f.callbackNode=null,f.callbackPriority=0;var Q=A.lanes|A.childLanes;if(_l(f,Q),f===Y&&(J=Y=null,re=0),(A.subtreeFlags&2064)===0&&(A.flags&2064)===0||Ve||(Ve=!0,xo(kr,function(){return Ni(),null})),Q=(A.flags&15990)!==0,(A.subtreeFlags&15990)!==0||Q){Q=X.transition,X.transition=null;var be=ar;ar=1;var Ye=G;G|=4,q.current=null,hh(f,A),g(A,f),ao(qu),Ph=!!Vu,qu=Vu=null,f.current=A,b(A),Ki(),G=Ye,ar=be,X.transition=Q}else f.current=A;if(Ve&&(Ve=!1,_t=f,nt=H),Q=f.pendingLanes,Q===0&&(st=null),so(A.stateNode),rn(f,fi()),y!==null)for(D=f.onRecoverableError,A=0;A<y.length;A++)H=y[A],D(H.value,{componentStack:H.stack,digest:H.digest});if(Et)throw Et=!1,f=Ke,Ke=null,f;return(nt&1)!==0&&f.tag!==0&&Ni(),Q=f.pendingLanes,(Q&1)!==0?f===jt?Tt++:(Tt=0,jt=f):Tt=0,Zo(),null}function Ni(){if(_t!==null){var f=Eu(nt),y=X.transition,A=ar;try{if(X.transition=null,ar=16>f?16:f,_t===null)var D=!1;else{if(f=_t,_t=null,nt=0,(G&6)!==0)throw Error(m(331));var H=G;for(G|=4,Fn=f.current;Fn!==null;){var Q=Fn,be=Q.child;if((Fn.flags&16)!==0){var Ye=Q.deletions;if(Ye!==null){for(var ot=0;ot<Ye.length;ot++){var Bt=Ye[ot];for(Fn=Bt;Fn!==null;){var mn=Fn;switch(mn.tag){case 0:case 11:case 15:mu(8,mn,Q)}var gn=mn.child;if(gn!==null)gn.return=mn,Fn=gn;else for(;Fn!==null;){mn=Fn;var dn=mn.sibling,jn=mn.return;if(pp(mn),mn===Bt){Fn=null;break}if(dn!==null){dn.return=jn,Fn=dn;break}Fn=jn}}}var Kn=Q.alternate;if(Kn!==null){var ei=Kn.child;if(ei!==null){Kn.child=null;do{var Ms=ei.sibling;ei.sibling=null,ei=Ms}while(ei!==null)}}Fn=Q}}if((Q.subtreeFlags&2064)!==0&&be!==null)be.return=Q,Fn=be;else e:for(;Fn!==null;){if(Q=Fn,(Q.flags&2048)!==0)switch(Q.tag){case 0:case 11:case 15:mu(9,Q,Q.return)}var It=Q.sibling;if(It!==null){It.return=Q.return,Fn=It;break e}Fn=Q.return}}var vt=f.current;for(Fn=vt;Fn!==null;){be=Fn;var zt=be.child;if((be.subtreeFlags&2064)!==0&&zt!==null)zt.return=be,Fn=zt;else e:for(be=vt;Fn!==null;){if(Ye=Fn,(Ye.flags&2048)!==0)try{switch(Ye.tag){case 0:case 11:case 15:ca(9,Ye)}}catch(ui){$n(Ye,Ye.return,ui)}if(Ye===be){Fn=null;break e}var Tn=Ye.sibling;if(Tn!==null){Tn.return=Ye.return,Fn=Tn;break e}Fn=Ye.return}}if(G=H,Zo(),ls&&typeof ls.onPostCommitFiberRoot=="function")try{ls.onPostCommitFiberRoot(ds,f)}catch{}D=!0}return D}finally{ar=A,X.transition=y}}return!1}function ir(f,y,A){y=cl(A,y),y=op(f,y,1),f=bc(f,y,1),y=Yt(),f!==null&&(po(f,1,y),rn(f,y))}function $n(f,y,A){if(f.tag===3)ir(f,f,A);else for(;y!==null;){if(y.tag===3){ir(y,f,A);break}else if(y.tag===1){var D=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(st===null||!st.has(D))){f=cl(A,f),f=Dl(y,f,1),y=bc(y,f,1),f=Yt(),y!==null&&(po(y,1,f),rn(y,f));break}}y=y.return}}function Br(f,y,A){var D=f.pingCache;D!==null&&D.delete(y),y=Yt(),f.pingedLanes|=f.suspendedLanes&A,Y===f&&(re&A)===A&&(Ae===4||Ae===3&&(re&130023424)===re&&500>fi()-Qe?Dn(f,0):Pe|=A),rn(f,y)}function ks(f,y){y===0&&((f.mode&1)===0?y=1:(y=Ql,Ql<<=1,(Ql&130023424)===0&&(Ql=4194304)));var A=Yt();f=nl(f,y),f!==null&&(po(f,y,A),rn(f,A))}function fr(f){var y=f.memoizedState,A=0;y!==null&&(A=y.retryLane),ks(f,A)}function Pi(f,y){var A=0;switch(f.tag){case 13:var D=f.stateNode,H=f.memoizedState;H!==null&&(A=H.retryLane);break;case 19:D=f.stateNode;break;default:throw Error(m(314))}D!==null&&D.delete(y),ks(f,A)}var Do;Do=function(f,y,A){if(f!==null)if(f.memoizedProps!==y.pendingProps||ko.current)yo=!0;else{if((f.lanes&A)===0&&(y.flags&128)===0)return yo=!1,$f(f,y,A);yo=(f.flags&131072)!==0}else yo=!1,ss&&(y.flags&1048576)!==0&&$d(y,Ud,y.index);switch(y.lanes=0,y.tag){case 2:var D=y.type;du(f,y),f=y.pendingProps;var H=Al(y,fs.current);xc(y,A),H=Er(null,y,D,f,H,A);var Q=Xe();return y.flags|=1,typeof H=="object"&&H!==null&&typeof H.render=="function"&&H.$$typeof===void 0?(y.tag=1,y.memoizedState=null,y.updateQueue=null,Xs(D)?(Q=!0,eu(y)):Q=!1,y.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,il(y),H.updater=zl,y.stateNode=H,H._reactInternals=y,sd(y,D,f,A),y=cp(null,y,D,!0,Q,A)):(y.tag=0,ss&&Q&&Gh(y),Vs(null,y,H,A),y=y.child),y;case 16:D=y.elementType;e:{switch(du(f,y),f=y.pendingProps,H=D._init,D=H(D._payload),y.type=D,H=y.tag=Oo(D),f=_o(D,f),H){case 0:y=ch(null,y,D,f,A);break e;case 1:y=Zp(null,y,D,f,A);break e;case 11:y=hu(null,y,D,f,A);break e;case 14:y=lh(null,y,D,_o(D.type,f),A);break e}throw Error(m(306,D,""))}return y;case 0:return D=y.type,H=y.pendingProps,H=y.elementType===D?H:_o(D,H),ch(f,y,D,H,A);case 1:return D=y.type,H=y.pendingProps,H=y.elementType===D?H:_o(D,H),Zp(f,y,D,H,A);case 3:e:{if(Kp(y),f===null)throw Error(m(387));D=y.pendingProps,Q=y.memoizedState,H=Q.element,wn(f,y),Qh(y,D,null,A);var be=y.memoizedState;if(D=be.element,Q.isDehydrated)if(Q={element:D,isDehydrated:!1,cache:be.cache,pendingSuspenseBoundaries:be.pendingSuspenseBoundaries,transitions:be.transitions},y.updateQueue.baseState=Q,y.memoizedState=Q,y.flags&256){H=cl(Error(m(423)),y),y=Xp(f,y,D,A,H);break e}else if(D!==H){H=cl(Error(m(424)),y),y=Xp(f,y,D,A,H);break e}else for(js=Za(y.stateNode.containerInfo.firstChild),Es=y,ss=!0,Ys=null,A=tl(y,null,D,A),y.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling;else{if(iu(),D===H){y=Qi(f,y,A);break e}Vs(f,y,D,A)}y=y.child}return y;case 5:return wc(y),f===null&&Kh(y),D=y.type,H=y.pendingProps,Q=f!==null?f.memoizedProps:null,be=H.children,pc(D,H)?be=null:Q!==null&&pc(D,Q)&&(y.flags|=32),Wp(f,y),Vs(f,y,be,A),y.child;case 6:return f===null&&Kh(y),null;case 13:return Yp(f,y,A);case 4:return Js(y,y.stateNode.containerInfo),D=y.pendingProps,f===null?y.child=Il(y,null,D,A):Vs(f,y,D,A),y.child;case 11:return D=y.type,H=y.pendingProps,H=y.elementType===D?H:_o(D,H),hu(f,y,D,H,A);case 7:return Vs(f,y,y.pendingProps,A),y.child;case 8:return Vs(f,y,y.pendingProps.children,A),y.child;case 12:return Vs(f,y,y.pendingProps.children,A),y.child;case 10:e:{if(D=y.type._context,H=y.pendingProps,Q=y.memoizedProps,be=H.value,es(gc,D._currentValue),D._currentValue=be,Q!==null)if(va(Q.value,be)){if(Q.children===H.children&&!ko.current){y=Qi(f,y,A);break e}}else for(Q=y.child,Q!==null&&(Q.return=y);Q!==null;){var Ye=Q.dependencies;if(Ye!==null){be=Q.child;for(var ot=Ye.firstContext;ot!==null;){if(ot.context===D){if(Q.tag===1){ot=la(-1,A&-A),ot.tag=2;var Bt=Q.updateQueue;if(Bt!==null){Bt=Bt.shared;var mn=Bt.pending;mn===null?ot.next=ot:(ot.next=mn.next,mn.next=ot),Bt.pending=ot}}Q.lanes|=A,ot=Q.alternate,ot!==null&&(ot.lanes|=A),Yh(Q.return,A,y),Ye.lanes|=A;break}ot=ot.next}}else if(Q.tag===10)be=Q.type===y.type?null:Q.child;else if(Q.tag===18){if(be=Q.return,be===null)throw Error(m(341));be.lanes|=A,Ye=be.alternate,Ye!==null&&(Ye.lanes|=A),Yh(be,A,y),be=Q.sibling}else be=Q.child;if(be!==null)be.return=Q;else for(be=Q;be!==null;){if(be===y){be=null;break}if(Q=be.sibling,Q!==null){Q.return=be.return,be=Q;break}be=be.return}Q=be}Vs(f,y,H.children,A),y=y.child}return y;case 9:return H=y.type,D=y.pendingProps.children,xc(y,A),H=As(H),D=D(H),y.flags|=1,Vs(f,y,D,A),y.child;case 14:return D=y.type,H=_o(D,y.pendingProps),H=_o(D.type,H),lh(f,y,D,H,A);case 15:return lp(f,y,y.type,y.pendingProps,A);case 17:return D=y.type,H=y.pendingProps,H=y.elementType===D?H:_o(D,H),du(f,y),y.tag=1,Xs(D)?(f=!0,eu(y)):f=!1,xc(y,A),sp(y,D,H),sd(y,D,H,A),cp(null,y,D,!0,f,A);case 19:return Uf(f,y,A);case 22:return ad(f,y,A)}throw Error(m(156,y.tag))};function xo(f,y){return On(f,y)}function ha(f,y,A,D){this.tag=f,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ms(f,y,A,D){return new ha(f,y,A,D)}function Qo(f){return f=f.prototype,!(!f||!f.isReactComponent)}function Oo(f){if(typeof f=="function")return Qo(f)?1:0;if(f!=null){if(f=f.$$typeof,f===mt)return 11;if(f===At)return 14}return 2}function Bo(f,y){var A=f.alternate;return A===null?(A=ms(f.tag,y,f.key,f.mode),A.elementType=f.elementType,A.type=f.type,A.stateNode=f.stateNode,A.alternate=f,f.alternate=A):(A.pendingProps=y,A.type=f.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=f.flags&14680064,A.childLanes=f.childLanes,A.lanes=f.lanes,A.child=f.child,A.memoizedProps=f.memoizedProps,A.memoizedState=f.memoizedState,A.updateQueue=f.updateQueue,y=f.dependencies,A.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},A.sibling=f.sibling,A.index=f.index,A.ref=f.ref,A}function Jo(f,y,A,D,H,Q){var be=2;if(D=f,typeof f=="function")Qo(f)&&(be=1);else if(typeof f=="string")be=5;else e:switch(f){case Ee:return ea(A.children,H,Q,y);case qe:be=8,H|=8;break;case $e:return f=ms(12,A,y,H|2),f.elementType=$e,f.lanes=Q,f;case St:return f=ms(13,A,y,H),f.elementType=St,f.lanes=Q,f;case xt:return f=ms(19,A,y,H),f.elementType=xt,f.lanes=Q,f;case Ut:return Cc(A,H,Q,y);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case Ge:be=10;break e;case et:be=9;break e;case mt:be=11;break e;case At:be=14;break e;case Ct:be=16,D=null;break e}throw Error(m(130,f==null?f:typeof f,""))}return y=ms(be,A,y,H),y.elementType=f,y.type=D,y.lanes=Q,y}function ea(f,y,A,D){return f=ms(7,f,D,y),f.lanes=A,f}function Cc(f,y,A,D){return f=ms(22,f,D,y),f.elementType=Ut,f.lanes=A,f.stateNode={isHidden:!1},f}function pd(f,y,A){return f=ms(6,f,null,y),f.lanes=A,f}function Ec(f,y,A){return y=ms(4,f.children!==null?f.children:[],f.key,y),y.lanes=A,y.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},y}function tf(f,y,A,D,H){this.tag=y,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Io(0),this.expirationTimes=Io(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Io(0),this.identifierPrefix=D,this.onRecoverableError=H,this.mutableSourceEagerHydrationData=null}function yu(f,y,A,D,H,Q,be,Ye,ot){return f=new tf(f,y,A,Ye,ot),y===1?(y=1,Q===!0&&(y|=8)):y=0,Q=ms(3,null,null,y),f.current=Q,Q.stateNode=f,Q.memoizedState={element:D,isDehydrated:A,cache:null,transitions:null,pendingSuspenseBoundaries:null},il(Q),f}function fp(f,y,A){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Oe,key:D==null?null:""+D,children:f,containerInfo:y,implementation:A}}function fd(f){if(!f)return Go;f=f._reactInternals;e:{if(rt(f)!==f||f.tag!==1)throw Error(m(170));var y=f;do{switch(y.tag){case 3:y=y.stateNode.context;break e;case 1:if(Xs(y.type)){y=y.stateNode.__reactInternalMemoizedMergedChildContext;break e}}y=y.return}while(y!==null);throw Error(m(171))}if(f.tag===1){var A=f.type;if(Xs(A))return qd(f,A,y)}return y}function Ba(f,y,A,D,H,Q,be,Ye,ot){return f=yu(A,D,!0,f,H,Q,be,Ye,ot),f.context=fd(null),A=f.current,D=Yt(),H=tn(A),Q=la(D,H),Q.callback=y??null,bc(A,Q,H),f.current.lanes=H,po(f,H,D),rn(f,D),f}function Fl(f,y,A,D){var H=y.current,Q=Yt(),be=tn(H);return A=fd(A),y.context===null?y.context=A:y.pendingContext=A,y=la(Q,be),y.payload={element:f},D=D===void 0?null:D,D!==null&&(y.callback=D),f=bc(H,y,be),f!==null&&(Xt(f,H,be,Q),Wd(f,H,be)),be}function hl(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function jl(f,y){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var A=f.retryLane;f.retryLane=A!==0&&A<y?A:y}}function nf(f,y){jl(f,y),(f=f.alternate)&&jl(f,y)}function mp(){return null}var rf=typeof reportError=="function"?reportError:function(f){console.error(f)};function Wf(f){this._internalRoot=f}sf.prototype.render=Wf.prototype.render=function(f){var y=this._internalRoot;if(y===null)throw Error(m(409));Fl(f,y,null,null)},sf.prototype.unmount=Wf.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var y=f.containerInfo;Ai(function(){Fl(null,f,null,null)}),y[Xa]=null}};function sf(f){this._internalRoot=f}sf.prototype.unstable_scheduleHydration=function(f){if(f){var y=Oc();f={blockedOn:null,target:f,priority:y};for(var A=0;A<ga.length&&y!==0&&y<ga[A].priority;A++);ga.splice(A,0,f),A===0&&Rf(f)}};function Zf(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function of(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function Km(){}function md(f,y,A,D,H){if(H){if(typeof D=="function"){var Q=D;D=function(){var Bt=hl(be);Q.call(Bt)}}var be=Ba(y,D,f,0,null,!1,!1,"",Km);return f._reactRootContainer=be,f[Xa]=be.current,qh(f.nodeType===8?f.parentNode:f),Ai(),be}for(;H=f.lastChild;)f.removeChild(H);if(typeof D=="function"){var Ye=D;D=function(){var Bt=hl(ot);Ye.call(Bt)}}var ot=yu(f,0,!1,null,null,!1,!1,"",Km);return f._reactRootContainer=ot,f[Xa]=ot.current,qh(f.nodeType===8?f.parentNode:f),Ai(function(){Fl(y,ot,A,D)}),ot}function af(f,y,A,D,H){var Q=A._reactRootContainer;if(Q){var be=Q;if(typeof H=="function"){var Ye=H;H=function(){var ot=hl(be);Ye.call(ot)}}Fl(y,be,f,H)}else be=md(A,y,f,H,D);return hl(be)}Ea=function(f){switch(f.tag){case 3:var y=f.stateNode;if(y.current.memoizedState.isDehydrated){var A=Jl(y.pendingLanes);A!==0&&(ia(y,A|1),rn(y,fi()),(G&6)===0&&(ft=fi()+500,Zo()))}break;case 13:Ai(function(){var D=nl(f,1);if(D!==null){var H=Yt();Xt(D,f,1,H)}}),nf(f,1)}},Dc=function(f){if(f.tag===13){var y=nl(f,134217728);if(y!==null){var A=Yt();Xt(y,f,134217728,A)}nf(f,134217728)}},ec=function(f){if(f.tag===13){var y=tn(f),A=nl(f,y);if(A!==null){var D=Yt();Xt(A,f,y,D)}nf(f,y)}},Oc=function(){return ar},Cd=function(f,y){var A=ar;try{return ar=f,y()}finally{ar=A}},Wl=function(f,y,A){switch(y){case"input":if(Gr(f,A),y=A.name,A.type==="radio"&&y!=null){for(A=f;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll("input[name="+JSON.stringify(""+y)+'][type="radio"]'),y=0;y<A.length;y++){var D=A[y];if(D!==f&&D.form===f.form){var H=Qc(D);if(!H)throw Error(m(90));Yi(D),Gr(D,H)}}}break;case"textarea":Hi(f,A);break;case"select":y=A.value,y!=null&&sr(f,!!A.multiple,y,!1)}},Ha=Oi,Td=Ai;var bo={usingClientEntryPoint:!1,Events:[$h,fc,Qc,Kl,Wt,Oi]},Ac={findFiberByHostInstance:Yc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dv={bundleType:Ac.bundleType,version:Ac.version,rendererPackageName:Ac.rendererPackageName,rendererConfig:Ac.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Le.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=Rn(f),f===null?null:f.stateNode},findFiberByHostInstance:Ac.findFiberByHostInstance||mp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kf.isDisabled&&Kf.supportsFiber)try{ds=Kf.inject(dv),ls=Kf}catch{}}return pl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bo,pl.createPortal=function(f,y){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zf(y))throw Error(m(200));return fp(f,y,null,A)},pl.createRoot=function(f,y){if(!Zf(f))throw Error(m(299));var A=!1,D="",H=rf;return y!=null&&(y.unstable_strictMode===!0&&(A=!0),y.identifierPrefix!==void 0&&(D=y.identifierPrefix),y.onRecoverableError!==void 0&&(H=y.onRecoverableError)),y=yu(f,1,!1,null,null,A,!1,D,H),f[Xa]=y.current,qh(f.nodeType===8?f.parentNode:f),new Wf(y)},pl.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var y=f._reactInternals;if(y===void 0)throw typeof f.render=="function"?Error(m(188)):(f=Object.keys(f).join(","),Error(m(268,f)));return f=Rn(y),f=f===null?null:f.stateNode,f},pl.flushSync=function(f){return Ai(f)},pl.hydrate=function(f,y,A){if(!of(y))throw Error(m(200));return af(null,f,y,!0,A)},pl.hydrateRoot=function(f,y,A){if(!Zf(f))throw Error(m(405));var D=A!=null&&A.hydratedSources||null,H=!1,Q="",be=rf;if(A!=null&&(A.unstable_strictMode===!0&&(H=!0),A.identifierPrefix!==void 0&&(Q=A.identifierPrefix),A.onRecoverableError!==void 0&&(be=A.onRecoverableError)),y=Ba(y,null,f,1,A??null,H,!1,Q,be),f[Xa]=y.current,qh(f),D)for(f=0;f<D.length;f++)A=D[f],H=A._getVersion,H=H(A._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[A,H]:y.mutableSourceEagerHydrationData.push(A,H);return new sf(y)},pl.render=function(f,y,A){if(!of(y))throw Error(m(200));return af(null,f,y,!1,A)},pl.unmountComponentAtNode=function(f){if(!of(f))throw Error(m(40));return f._reactRootContainer?(Ai(function(){af(null,null,f,!1,function(){f._reactRootContainer=null,f[Xa]=null})}),!0):!1},pl.unstable_batchedUpdates=Oi,pl.unstable_renderSubtreeIntoContainer=function(f,y,A,D){if(!of(A))throw Error(m(200));if(f==null||f._reactInternals===void 0)throw Error(m(38));return af(f,y,A,!1,D)},pl.version="18.3.1-next-f1338f8080-20240426",pl}var ZT;function o2(){if(ZT)return Ex.exports;ZT=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(l){console.error(l)}}return a(),Ex.exports=CM(),Ex.exports}var KT;function EM(){if(KT)return ly;KT=1;var a=o2();return ly.createRoot=a.createRoot,ly.hydrateRoot=a.hydrateRoot,ly}var AM=EM();const a2=$l(AM);var ue=d_();const Qr=$l(ue),Ey=xM({__proto__:null,default:Qr},[ue]);var l2=o2();const cy=$l(l2);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function n_(){return n_=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(a[_]=m[_])}return a},n_.apply(this,arguments)}var Sp;(function(a){a.Pop="POP",a.Push="PUSH",a.Replace="REPLACE"})(Sp||(Sp={}));const XT="popstate";function IM(a){a===void 0&&(a={});function l(_,w){let{pathname:C,search:M,hash:r}=_.location;return s0("",{pathname:C,search:M,hash:r},w.state&&w.state.usr||null,w.state&&w.state.key||"default")}function m(_,w){return typeof w=="string"?w:u2(w)}return kM(l,m,null,a)}function jo(a,l){if(a===!1||a===null||typeof a>"u")throw new Error(l)}function c2(a,l){if(!a){typeof console<"u"&&console.warn(l);try{throw new Error(l)}catch{}}}function PM(){return Math.random().toString(36).substr(2,8)}function YT(a,l){return{usr:a.state,key:a.key,idx:l}}function s0(a,l,m,_){return m===void 0&&(m=null),n_({pathname:typeof a=="string"?a:a.pathname,search:"",hash:""},typeof l=="string"?zm(l):l,{state:m,key:l&&l.key||_||PM()})}function u2(a){let{pathname:l="/",search:m="",hash:_=""}=a;return m&&m!=="?"&&(l+=m.charAt(0)==="?"?m:"?"+m),_&&_!=="#"&&(l+=_.charAt(0)==="#"?_:"#"+_),l}function zm(a){let l={};if(a){let m=a.indexOf("#");m>=0&&(l.hash=a.substr(m),a=a.substr(0,m));let _=a.indexOf("?");_>=0&&(l.search=a.substr(_),a=a.substr(0,_)),a&&(l.pathname=a)}return l}function kM(a,l,m,_){_===void 0&&(_={});let{window:w=document.defaultView,v5Compat:C=!1}=_,M=w.history,r=Sp.Pop,O=null,V=U();V==null&&(V=0,M.replaceState(n_({},M.state,{idx:V}),""));function U(){return(M.state||{idx:null}).idx}function Z(){r=Sp.Pop;let Se=U(),me=Se==null?null:Se-V;V=Se,O&&O({action:r,location:ne.location,delta:me})}function ie(Se,me){r=Sp.Push;let Re=s0(ne.location,Se,me);V=U()+1;let ye=YT(Re,V),Le=ne.createHref(Re);try{M.pushState(ye,"",Le)}catch(De){if(De instanceof DOMException&&De.name==="DataCloneError")throw De;w.location.assign(Le)}C&&O&&O({action:r,location:ne.location,delta:1})}function de(Se,me){r=Sp.Replace;let Re=s0(ne.location,Se,me);V=U();let ye=YT(Re,V),Le=ne.createHref(Re);M.replaceState(ye,"",Le),C&&O&&O({action:r,location:ne.location,delta:0})}function se(Se){let me=w.location.origin!=="null"?w.location.origin:w.location.href,Re=typeof Se=="string"?Se:u2(Se);return Re=Re.replace(/ $/,"%20"),jo(me,"No window.location.(origin|href) available to create URL for href: "+Re),new URL(Re,me)}let ne={get action(){return r},get location(){return a(w,M)},listen(Se){if(O)throw new Error("A history only accepts one active listener");return w.addEventListener(XT,Z),O=Se,()=>{w.removeEventListener(XT,Z),O=null}},createHref(Se){return l(w,Se)},createURL:se,encodeLocation(Se){let me=se(Se);return{pathname:me.pathname,search:me.search,hash:me.hash}},push:ie,replace:de,go(Se){return M.go(Se)}};return ne}var QT;(function(a){a.data="data",a.deferred="deferred",a.redirect="redirect",a.error="error"})(QT||(QT={}));function MM(a,l,m){return m===void 0&&(m="/"),RM(a,l,m)}function RM(a,l,m,_){let w=typeof l=="string"?zm(l):l,C=p2(w.pathname||"/",m);if(C==null)return null;let M=h2(a);zM(M);let r=null;for(let O=0;r==null&&O<M.length;++O){let V=$M(C);r=qM(M[O],V)}return r}function h2(a,l,m,_){l===void 0&&(l=[]),m===void 0&&(m=[]),_===void 0&&(_="");let w=(C,M,r)=>{let O={relativePath:r===void 0?C.path||"":r,caseSensitive:C.caseSensitive===!0,childrenIndex:M,route:C};O.relativePath.startsWith("/")&&(jo(O.relativePath.startsWith(_),'Absolute route path "'+O.relativePath+'" nested under path '+('"'+_+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),O.relativePath=O.relativePath.slice(_.length));let V=wf([_,O.relativePath]),U=m.concat(O);C.children&&C.children.length>0&&(jo(C.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+V+'".')),h2(C.children,l,U,V)),!(C.path==null&&!C.index)&&l.push({path:V,score:NM(V,C.index),routesMeta:U})};return a.forEach((C,M)=>{var r;if(C.path===""||!((r=C.path)!=null&&r.includes("?")))w(C,M);else for(let O of d2(C.path))w(C,M,O)}),l}function d2(a){let l=a.split("/");if(l.length===0)return[];let[m,..._]=l,w=m.endsWith("?"),C=m.replace(/\?$/,"");if(_.length===0)return w?[C,""]:[C];let M=d2(_.join("/")),r=[];return r.push(...M.map(O=>O===""?C:[C,O].join("/"))),w&&r.push(...M),r.map(O=>a.startsWith("/")&&O===""?"/":O)}function zM(a){a.sort((l,m)=>l.score!==m.score?m.score-l.score:VM(l.routesMeta.map(_=>_.childrenIndex),m.routesMeta.map(_=>_.childrenIndex)))}const LM=/^:[\w-]+$/,DM=3,OM=2,BM=1,FM=10,jM=-2,JT=a=>a==="*";function NM(a,l){let m=a.split("/"),_=m.length;return m.some(JT)&&(_+=jM),l&&(_+=OM),m.filter(w=>!JT(w)).reduce((w,C)=>w+(LM.test(C)?DM:C===""?BM:FM),_)}function VM(a,l){return a.length===l.length&&a.slice(0,-1).every((_,w)=>_===l[w])?a[a.length-1]-l[l.length-1]:0}function qM(a,l,m){let{routesMeta:_}=a,w={},C="/",M=[];for(let r=0;r<_.length;++r){let O=_[r],V=r===_.length-1,U=C==="/"?l:l.slice(C.length)||"/",Z=HM({path:O.relativePath,caseSensitive:O.caseSensitive,end:V},U),ie=O.route;if(!Z)return null;Object.assign(w,Z.params),M.push({params:w,pathname:wf([C,Z.pathname]),pathnameBase:YM(wf([C,Z.pathnameBase])),route:ie}),Z.pathnameBase!=="/"&&(C=wf([C,Z.pathnameBase]))}return M}function HM(a,l){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[m,_]=UM(a.path,a.caseSensitive,a.end),w=l.match(m);if(!w)return null;let C=w[0],M=C.replace(/(.)\/+$/,"$1"),r=w.slice(1);return{params:_.reduce((V,U,Z)=>{let{paramName:ie,isOptional:de}=U;if(ie==="*"){let ne=r[Z]||"";M=C.slice(0,C.length-ne.length).replace(/(.)\/+$/,"$1")}const se=r[Z];return de&&!se?V[ie]=void 0:V[ie]=(se||"").replace(/%2F/g,"/"),V},{}),pathname:C,pathnameBase:M,pattern:a}}function UM(a,l,m){l===void 0&&(l=!1),m===void 0&&(m=!0),c2(a==="*"||!a.endsWith("*")||a.endsWith("/*"),'Route path "'+a+'" will be treated as if it were '+('"'+a.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+a.replace(/\*$/,"/*")+'".'));let _=[],w="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(M,r,O)=>(_.push({paramName:r,isOptional:O!=null}),O?"/?([^\\/]+)?":"/([^\\/]+)"));return a.endsWith("*")?(_.push({paramName:"*"}),w+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):m?w+="\\/*$":a!==""&&a!=="/"&&(w+="(?:(?=\\/|$))"),[new RegExp(w,l?void 0:"i"),_]}function $M(a){try{return a.split("/").map(l=>decodeURIComponent(l).replace(/\//g,"%2F")).join("/")}catch(l){return c2(!1,'The URL path "'+a+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+l+").")),a}}function p2(a,l){if(l==="/")return a;if(!a.toLowerCase().startsWith(l.toLowerCase()))return null;let m=l.endsWith("/")?l.length-1:l.length,_=a.charAt(m);return _&&_!=="/"?null:a.slice(m)||"/"}function GM(a,l){l===void 0&&(l="/");let{pathname:m,search:_="",hash:w=""}=typeof a=="string"?zm(a):a;return{pathname:m?m.startsWith("/")?m:WM(m,l):l,search:QM(_),hash:JM(w)}}function WM(a,l){let m=l.replace(/\/+$/,"").split("/");return a.split("/").forEach(w=>{w===".."?m.length>1&&m.pop():w!=="."&&m.push(w)}),m.length>1?m.join("/"):"/"}function Px(a,l,m,_){return"Cannot include a '"+a+"' character in a manually specified "+("`to."+l+"` field ["+JSON.stringify(_)+"].  Please separate it out to the ")+("`to."+m+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ZM(a){return a.filter((l,m)=>m===0||l.route.path&&l.route.path.length>0)}function KM(a,l){let m=ZM(a);return l?m.map((_,w)=>w===m.length-1?_.pathname:_.pathnameBase):m.map(_=>_.pathnameBase)}function XM(a,l,m,_){_===void 0&&(_=!1);let w;typeof a=="string"?w=zm(a):(w=n_({},a),jo(!w.pathname||!w.pathname.includes("?"),Px("?","pathname","search",w)),jo(!w.pathname||!w.pathname.includes("#"),Px("#","pathname","hash",w)),jo(!w.search||!w.search.includes("#"),Px("#","search","hash",w)));let C=a===""||w.pathname==="",M=C?"/":w.pathname,r;if(M==null)r=m;else{let Z=l.length-1;if(!_&&M.startsWith("..")){let ie=M.split("/");for(;ie[0]==="..";)ie.shift(),Z-=1;w.pathname=ie.join("/")}r=Z>=0?l[Z]:"/"}let O=GM(w,r),V=M&&M!=="/"&&M.endsWith("/"),U=(C||M===".")&&m.endsWith("/");return!O.pathname.endsWith("/")&&(V||U)&&(O.pathname+="/"),O}const wf=a=>a.join("/").replace(/\/\/+/g,"/"),YM=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),QM=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,JM=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function eR(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}const f2=["post","put","patch","delete"];new Set(f2);const tR=["get",...f2];new Set(tR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function i_(){return i_=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(a[_]=m[_])}return a},i_.apply(this,arguments)}const M0=ue.createContext(null),nR=ue.createContext(null),Hy=ue.createContext(null),Uy=ue.createContext(null),If=ue.createContext({outlet:null,matches:[],isDataRoute:!1}),m2=ue.createContext(null);function $y(){return ue.useContext(Uy)!=null}function g2(){return $y()||jo(!1),ue.useContext(Uy).location}function _2(a){ue.useContext(Hy).static||ue.useLayoutEffect(a)}function iR(){let{isDataRoute:a}=ue.useContext(If);return a?_R():rR()}function rR(){$y()||jo(!1);let a=ue.useContext(M0),{basename:l,future:m,navigator:_}=ue.useContext(Hy),{matches:w}=ue.useContext(If),{pathname:C}=g2(),M=JSON.stringify(KM(w,m.v7_relativeSplatPath)),r=ue.useRef(!1);return _2(()=>{r.current=!0}),ue.useCallback(function(V,U){if(U===void 0&&(U={}),!r.current)return;if(typeof V=="number"){_.go(V);return}let Z=XM(V,JSON.parse(M),C,U.relative==="path");a==null&&l!=="/"&&(Z.pathname=Z.pathname==="/"?l:wf([l,Z.pathname])),(U.replace?_.replace:_.push)(Z,U.state,U)},[l,_,M,C,a])}function sR(){let{matches:a}=ue.useContext(If),l=a[a.length-1];return l?l.params:{}}function oR(a,l){return aR(a,l)}function aR(a,l,m,_){$y()||jo(!1);let{navigator:w}=ue.useContext(Hy),{matches:C}=ue.useContext(If),M=C[C.length-1],r=M?M.params:{};M&&M.pathname;let O=M?M.pathnameBase:"/";M&&M.route;let V=g2(),U;if(l){var Z;let Se=typeof l=="string"?zm(l):l;O==="/"||(Z=Se.pathname)!=null&&Z.startsWith(O)||jo(!1),U=Se}else U=V;let ie=U.pathname||"/",de=ie;if(O!=="/"){let Se=O.replace(/^\//,"").split("/");de="/"+ie.replace(/^\//,"").split("/").slice(Se.length).join("/")}let se=MM(a,{pathname:de}),ne=dR(se&&se.map(Se=>Object.assign({},Se,{params:Object.assign({},r,Se.params),pathname:wf([O,w.encodeLocation?w.encodeLocation(Se.pathname).pathname:Se.pathname]),pathnameBase:Se.pathnameBase==="/"?O:wf([O,w.encodeLocation?w.encodeLocation(Se.pathnameBase).pathname:Se.pathnameBase])})),C,m,_);return l&&ne?ue.createElement(Uy.Provider,{value:{location:i_({pathname:"/",search:"",hash:"",state:null,key:"default"},U),navigationType:Sp.Pop}},ne):ne}function lR(){let a=gR(),l=eR(a)?a.status+" "+a.statusText:a instanceof Error?a.message:JSON.stringify(a),m=a instanceof Error?a.stack:null,w={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ue.createElement(ue.Fragment,null,ue.createElement("h2",null,"Unexpected Application Error!"),ue.createElement("h3",{style:{fontStyle:"italic"}},l),m?ue.createElement("pre",{style:w},m):null,null)}const cR=ue.createElement(lR,null);class uR extends ue.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,m){return m.location!==l.location||m.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:m.error,location:m.location,revalidation:l.revalidation||m.revalidation}}componentDidCatch(l,m){console.error("React Router caught the following error during render",l,m)}render(){return this.state.error!==void 0?ue.createElement(If.Provider,{value:this.props.routeContext},ue.createElement(m2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hR(a){let{routeContext:l,match:m,children:_}=a,w=ue.useContext(M0);return w&&w.static&&w.staticContext&&(m.route.errorElement||m.route.ErrorBoundary)&&(w.staticContext._deepestRenderedBoundaryId=m.route.id),ue.createElement(If.Provider,{value:l},_)}function dR(a,l,m,_){var w;if(l===void 0&&(l=[]),m===void 0&&(m=null),_===void 0&&(_=null),a==null){var C;if(!m)return null;if(m.errors)a=m.matches;else if((C=_)!=null&&C.v7_partialHydration&&l.length===0&&!m.initialized&&m.matches.length>0)a=m.matches;else return null}let M=a,r=(w=m)==null?void 0:w.errors;if(r!=null){let U=M.findIndex(Z=>Z.route.id&&(r==null?void 0:r[Z.route.id])!==void 0);U>=0||jo(!1),M=M.slice(0,Math.min(M.length,U+1))}let O=!1,V=-1;if(m&&_&&_.v7_partialHydration)for(let U=0;U<M.length;U++){let Z=M[U];if((Z.route.HydrateFallback||Z.route.hydrateFallbackElement)&&(V=U),Z.route.id){let{loaderData:ie,errors:de}=m,se=Z.route.loader&&ie[Z.route.id]===void 0&&(!de||de[Z.route.id]===void 0);if(Z.route.lazy||se){O=!0,V>=0?M=M.slice(0,V+1):M=[M[0]];break}}}return M.reduceRight((U,Z,ie)=>{let de,se=!1,ne=null,Se=null;m&&(de=r&&Z.route.id?r[Z.route.id]:void 0,ne=Z.route.errorElement||cR,O&&(V<0&&ie===0?(yR("route-fallback"),se=!0,Se=null):V===ie&&(se=!0,Se=Z.route.hydrateFallbackElement||null)));let me=l.concat(M.slice(0,ie+1)),Re=()=>{let ye;return de?ye=ne:se?ye=Se:Z.route.Component?ye=ue.createElement(Z.route.Component,null):Z.route.element?ye=Z.route.element:ye=U,ue.createElement(hR,{match:Z,routeContext:{outlet:U,matches:me,isDataRoute:m!=null},children:ye})};return m&&(Z.route.ErrorBoundary||Z.route.errorElement||ie===0)?ue.createElement(uR,{location:m.location,revalidation:m.revalidation,component:ne,error:de,children:Re(),routeContext:{outlet:null,matches:me,isDataRoute:!0}}):Re()},null)}var y2=function(a){return a.UseBlocker="useBlocker",a.UseRevalidator="useRevalidator",a.UseNavigateStable="useNavigate",a}(y2||{}),v2=function(a){return a.UseBlocker="useBlocker",a.UseLoaderData="useLoaderData",a.UseActionData="useActionData",a.UseRouteError="useRouteError",a.UseNavigation="useNavigation",a.UseRouteLoaderData="useRouteLoaderData",a.UseMatches="useMatches",a.UseRevalidator="useRevalidator",a.UseNavigateStable="useNavigate",a.UseRouteId="useRouteId",a}(v2||{});function pR(a){let l=ue.useContext(M0);return l||jo(!1),l}function fR(a){let l=ue.useContext(nR);return l||jo(!1),l}function mR(a){let l=ue.useContext(If);return l||jo(!1),l}function x2(a){let l=mR(),m=l.matches[l.matches.length-1];return m.route.id||jo(!1),m.route.id}function gR(){var a;let l=ue.useContext(m2),m=fR(),_=x2();return l!==void 0?l:(a=m.errors)==null?void 0:a[_]}function _R(){let{router:a}=pR(y2.UseNavigateStable),l=x2(v2.UseNavigateStable),m=ue.useRef(!1);return _2(()=>{m.current=!0}),ue.useCallback(function(w,C){C===void 0&&(C={}),m.current&&(typeof w=="number"?a.navigate(w):a.navigate(w,i_({fromRouteId:l},C)))},[a,l])}const eS={};function yR(a,l,m){eS[a]||(eS[a]=!0)}function vR(a,l){a==null||a.v7_startTransition,a==null||a.v7_relativeSplatPath}function o0(a){jo(!1)}function xR(a){let{basename:l="/",children:m=null,location:_,navigationType:w=Sp.Pop,navigator:C,static:M=!1,future:r}=a;$y()&&jo(!1);let O=l.replace(/^\/*/,"/"),V=ue.useMemo(()=>({basename:O,navigator:C,static:M,future:i_({v7_relativeSplatPath:!1},r)}),[O,r,C,M]);typeof _=="string"&&(_=zm(_));let{pathname:U="/",search:Z="",hash:ie="",state:de=null,key:se="default"}=_,ne=ue.useMemo(()=>{let Se=p2(U,O);return Se==null?null:{location:{pathname:Se,search:Z,hash:ie,state:de,key:se},navigationType:w}},[O,U,Z,ie,de,se,w]);return ne==null?null:ue.createElement(Hy.Provider,{value:V},ue.createElement(Uy.Provider,{children:m,value:ne}))}function bR(a){let{children:l,location:m}=a;return oR(a0(l),m)}new Promise(()=>{});function a0(a,l){l===void 0&&(l=[]);let m=[];return ue.Children.forEach(a,(_,w)=>{if(!ue.isValidElement(_))return;let C=[...l,w];if(_.type===ue.Fragment){m.push.apply(m,a0(_.props.children,C));return}_.type!==o0&&jo(!1),!_.props.index||!_.props.children||jo(!1);let M={id:_.props.id||C.join("-"),caseSensitive:_.props.caseSensitive,element:_.props.element,Component:_.props.Component,index:_.props.index,path:_.props.path,loader:_.props.loader,action:_.props.action,errorElement:_.props.errorElement,ErrorBoundary:_.props.ErrorBoundary,hasErrorBoundary:_.props.ErrorBoundary!=null||_.props.errorElement!=null,shouldRevalidate:_.props.shouldRevalidate,handle:_.props.handle,lazy:_.props.lazy};_.props.children&&(M.children=a0(_.props.children,C)),m.push(M)}),m}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const wR="6";try{window.__reactRouterVersion=wR}catch{}const TR="startTransition",tS=Ey[TR];function SR(a){let{basename:l,children:m,future:_,window:w}=a,C=ue.useRef();C.current==null&&(C.current=IM({window:w,v5Compat:!0}));let M=C.current,[r,O]=ue.useState({action:M.action,location:M.location}),{v7_startTransition:V}=_||{},U=ue.useCallback(Z=>{V&&tS?tS(()=>O(Z)):O(Z)},[O,V]);return ue.useLayoutEffect(()=>M.listen(U),[M,U]),ue.useEffect(()=>vR(_),[_]),ue.createElement(xR,{basename:l,children:m,location:r.location,navigationType:r.action,navigator:M,future:_})}var nS;(function(a){a.UseScrollRestoration="useScrollRestoration",a.UseSubmit="useSubmit",a.UseSubmitFetcher="useSubmitFetcher",a.UseFetcher="useFetcher",a.useViewTransitionState="useViewTransitionState"})(nS||(nS={}));var iS;(function(a){a.UseFetcher="useFetcher",a.UseFetchers="useFetchers",a.UseScrollRestoration="useScrollRestoration"})(iS||(iS={}));const r_={black:"#000",white:"#fff"},hm={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},dm={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},pm={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},fm={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},mm={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},Mg={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},CR={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function xd(a){let l="https://mui.com/production-error/?code="+a;for(let m=1;m<arguments.length;m+=1)l+="&args[]="+encodeURIComponent(arguments[m]);return"Minified MUI error #"+a+"; visit "+l+" for the full message."}const ER=Object.freeze(Object.defineProperty({__proto__:null,default:xd},Symbol.toStringTag,{value:"Module"})),Em="$$material";function Fe(){return Fe=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var _ in m)({}).hasOwnProperty.call(m,_)&&(a[_]=m[_])}return a},Fe.apply(null,arguments)}function Yn(a,l){if(a==null)return{};var m={};for(var _ in a)if({}.hasOwnProperty.call(a,_)){if(l.indexOf(_)!==-1)continue;m[_]=a[_]}return m}function AR(a){if(a.sheet)return a.sheet;for(var l=0;l<document.styleSheets.length;l++)if(document.styleSheets[l].ownerNode===a)return document.styleSheets[l]}function IR(a){var l=document.createElement("style");return l.setAttribute("data-emotion",a.key),a.nonce!==void 0&&l.setAttribute("nonce",a.nonce),l.appendChild(document.createTextNode("")),l.setAttribute("data-s",""),l}var PR=function(){function a(m){var _=this;this._insertTag=function(w){var C;_.tags.length===0?_.insertionPoint?C=_.insertionPoint.nextSibling:_.prepend?C=_.container.firstChild:C=_.before:C=_.tags[_.tags.length-1].nextSibling,_.container.insertBefore(w,C),_.tags.push(w)},this.isSpeedy=m.speedy===void 0?!0:m.speedy,this.tags=[],this.ctr=0,this.nonce=m.nonce,this.key=m.key,this.container=m.container,this.prepend=m.prepend,this.insertionPoint=m.insertionPoint,this.before=null}var l=a.prototype;return l.hydrate=function(_){_.forEach(this._insertTag)},l.insert=function(_){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(IR(this));var w=this.tags[this.tags.length-1];if(this.isSpeedy){var C=AR(w);try{C.insertRule(_,C.cssRules.length)}catch{}}else w.appendChild(document.createTextNode(_));this.ctr++},l.flush=function(){this.tags.forEach(function(_){var w;return(w=_.parentNode)==null?void 0:w.removeChild(_)}),this.tags=[],this.ctr=0},a}(),Ta="-ms-",Ay="-moz-",Xr="-webkit-",b2="comm",R0="rule",z0="decl",kR="@import",w2="@keyframes",MR="@layer",RR=Math.abs,Gy=String.fromCharCode,zR=Object.assign;function LR(a,l){return da(a,0)^45?(((l<<2^da(a,0))<<2^da(a,1))<<2^da(a,2))<<2^da(a,3):0}function T2(a){return a.trim()}function DR(a,l){return(a=l.exec(a))?a[0]:a}function Yr(a,l,m){return a.replace(l,m)}function l0(a,l){return a.indexOf(l)}function da(a,l){return a.charCodeAt(l)|0}function s_(a,l,m){return a.slice(l,m)}function _h(a){return a.length}function L0(a){return a.length}function uy(a,l){return l.push(a),a}function OR(a,l){return a.map(l).join("")}var Wy=1,Am=1,S2=0,fl=0,Co=0,Lm="";function Zy(a,l,m,_,w,C,M){return{value:a,root:l,parent:m,type:_,props:w,children:C,line:Wy,column:Am,length:M,return:""}}function Rg(a,l){return zR(Zy("",null,null,"",null,null,0),a,{length:-a.length},l)}function BR(){return Co}function FR(){return Co=fl>0?da(Lm,--fl):0,Am--,Co===10&&(Am=1,Wy--),Co}function Ul(){return Co=fl<S2?da(Lm,fl++):0,Am++,Co===10&&(Am=1,Wy++),Co}function xh(){return da(Lm,fl)}function vy(){return fl}function p_(a,l){return s_(Lm,a,l)}function o_(a){switch(a){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function C2(a){return Wy=Am=1,S2=_h(Lm=a),fl=0,[]}function E2(a){return Lm="",a}function xy(a){return T2(p_(fl-1,c0(a===91?a+2:a===40?a+1:a)))}function jR(a){for(;(Co=xh())&&Co<33;)Ul();return o_(a)>2||o_(Co)>3?"":" "}function NR(a,l){for(;--l&&Ul()&&!(Co<48||Co>102||Co>57&&Co<65||Co>70&&Co<97););return p_(a,vy()+(l<6&&xh()==32&&Ul()==32))}function c0(a){for(;Ul();)switch(Co){case a:return fl;case 34:case 39:a!==34&&a!==39&&c0(Co);break;case 40:a===41&&c0(a);break;case 92:Ul();break}return fl}function VR(a,l){for(;Ul()&&a+Co!==57;)if(a+Co===84&&xh()===47)break;return"/*"+p_(l,fl-1)+"*"+Gy(a===47?a:Ul())}function qR(a){for(;!o_(xh());)Ul();return p_(a,fl)}function HR(a){return E2(by("",null,null,null,[""],a=C2(a),0,[0],a))}function by(a,l,m,_,w,C,M,r,O){for(var V=0,U=0,Z=M,ie=0,de=0,se=0,ne=1,Se=1,me=1,Re=0,ye="",Le=w,De=C,Oe=_,Ee=ye;Se;)switch(se=Re,Re=Ul()){case 40:if(se!=108&&da(Ee,Z-1)==58){l0(Ee+=Yr(xy(Re),"&","&\f"),"&\f")!=-1&&(me=-1);break}case 34:case 39:case 91:Ee+=xy(Re);break;case 9:case 10:case 13:case 32:Ee+=jR(se);break;case 92:Ee+=NR(vy()-1,7);continue;case 47:switch(xh()){case 42:case 47:uy(UR(VR(Ul(),vy()),l,m),O);break;default:Ee+="/"}break;case 123*ne:r[V++]=_h(Ee)*me;case 125*ne:case 59:case 0:switch(Re){case 0:case 125:Se=0;case 59+U:me==-1&&(Ee=Yr(Ee,/\f/g,"")),de>0&&_h(Ee)-Z&&uy(de>32?sS(Ee+";",_,m,Z-1):sS(Yr(Ee," ","")+";",_,m,Z-2),O);break;case 59:Ee+=";";default:if(uy(Oe=rS(Ee,l,m,V,U,w,r,ye,Le=[],De=[],Z),C),Re===123)if(U===0)by(Ee,l,Oe,Oe,Le,C,Z,r,De);else switch(ie===99&&da(Ee,3)===110?100:ie){case 100:case 108:case 109:case 115:by(a,Oe,Oe,_&&uy(rS(a,Oe,Oe,0,0,w,r,ye,w,Le=[],Z),De),w,De,Z,r,_?Le:De);break;default:by(Ee,Oe,Oe,Oe,[""],De,0,r,De)}}V=U=de=0,ne=me=1,ye=Ee="",Z=M;break;case 58:Z=1+_h(Ee),de=se;default:if(ne<1){if(Re==123)--ne;else if(Re==125&&ne++==0&&FR()==125)continue}switch(Ee+=Gy(Re),Re*ne){case 38:me=U>0?1:(Ee+="\f",-1);break;case 44:r[V++]=(_h(Ee)-1)*me,me=1;break;case 64:xh()===45&&(Ee+=xy(Ul())),ie=xh(),U=Z=_h(ye=Ee+=qR(vy())),Re++;break;case 45:se===45&&_h(Ee)==2&&(ne=0)}}return C}function rS(a,l,m,_,w,C,M,r,O,V,U){for(var Z=w-1,ie=w===0?C:[""],de=L0(ie),se=0,ne=0,Se=0;se<_;++se)for(var me=0,Re=s_(a,Z+1,Z=RR(ne=M[se])),ye=a;me<de;++me)(ye=T2(ne>0?ie[me]+" "+Re:Yr(Re,/&\f/g,ie[me])))&&(O[Se++]=ye);return Zy(a,l,m,w===0?R0:r,O,V,U)}function UR(a,l,m){return Zy(a,l,m,b2,Gy(BR()),s_(a,2,-2),0)}function sS(a,l,m,_){return Zy(a,l,m,z0,s_(a,0,_),s_(a,_+1,-1),_)}function bm(a,l){for(var m="",_=L0(a),w=0;w<_;w++)m+=l(a[w],w,a,l)||"";return m}function $R(a,l,m,_){switch(a.type){case MR:if(a.children.length)break;case kR:case z0:return a.return=a.return||a.value;case b2:return"";case w2:return a.return=a.value+"{"+bm(a.children,_)+"}";case R0:a.value=a.props.join(",")}return _h(m=bm(a.children,_))?a.return=a.value+"{"+m+"}":""}function GR(a){var l=L0(a);return function(m,_,w,C){for(var M="",r=0;r<l;r++)M+=a[r](m,_,w,C)||"";return M}}function WR(a){return function(l){l.root||(l=l.return)&&a(l)}}function A2(a){var l=Object.create(null);return function(m){return l[m]===void 0&&(l[m]=a(m)),l[m]}}var ZR=function(l,m,_){for(var w=0,C=0;w=C,C=xh(),w===38&&C===12&&(m[_]=1),!o_(C);)Ul();return p_(l,fl)},KR=function(l,m){var _=-1,w=44;do switch(o_(w)){case 0:w===38&&xh()===12&&(m[_]=1),l[_]+=ZR(fl-1,m,_);break;case 2:l[_]+=xy(w);break;case 4:if(w===44){l[++_]=xh()===58?"&\f":"",m[_]=l[_].length;break}default:l[_]+=Gy(w)}while(w=Ul());return l},XR=function(l,m){return E2(KR(C2(l),m))},oS=new WeakMap,YR=function(l){if(!(l.type!=="rule"||!l.parent||l.length<1)){for(var m=l.value,_=l.parent,w=l.column===_.column&&l.line===_.line;_.type!=="rule";)if(_=_.parent,!_)return;if(!(l.props.length===1&&m.charCodeAt(0)!==58&&!oS.get(_))&&!w){oS.set(l,!0);for(var C=[],M=XR(m,C),r=_.props,O=0,V=0;O<M.length;O++)for(var U=0;U<r.length;U++,V++)l.props[V]=C[O]?M[O].replace(/&\f/g,r[U]):r[U]+" "+M[O]}}},QR=function(l){if(l.type==="decl"){var m=l.value;m.charCodeAt(0)===108&&m.charCodeAt(2)===98&&(l.return="",l.value="")}};function I2(a,l){switch(LR(a,l)){case 5103:return Xr+"print-"+a+a;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Xr+a+a;case 5349:case 4246:case 4810:case 6968:case 2756:return Xr+a+Ay+a+Ta+a+a;case 6828:case 4268:return Xr+a+Ta+a+a;case 6165:return Xr+a+Ta+"flex-"+a+a;case 5187:return Xr+a+Yr(a,/(\w+).+(:[^]+)/,Xr+"box-$1$2"+Ta+"flex-$1$2")+a;case 5443:return Xr+a+Ta+"flex-item-"+Yr(a,/flex-|-self/,"")+a;case 4675:return Xr+a+Ta+"flex-line-pack"+Yr(a,/align-content|flex-|-self/,"")+a;case 5548:return Xr+a+Ta+Yr(a,"shrink","negative")+a;case 5292:return Xr+a+Ta+Yr(a,"basis","preferred-size")+a;case 6060:return Xr+"box-"+Yr(a,"-grow","")+Xr+a+Ta+Yr(a,"grow","positive")+a;case 4554:return Xr+Yr(a,/([^-])(transform)/g,"$1"+Xr+"$2")+a;case 6187:return Yr(Yr(Yr(a,/(zoom-|grab)/,Xr+"$1"),/(image-set)/,Xr+"$1"),a,"")+a;case 5495:case 3959:return Yr(a,/(image-set\([^]*)/,Xr+"$1$`$1");case 4968:return Yr(Yr(a,/(.+:)(flex-)?(.*)/,Xr+"box-pack:$3"+Ta+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Xr+a+a;case 4095:case 3583:case 4068:case 2532:return Yr(a,/(.+)-inline(.+)/,Xr+"$1$2")+a;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(_h(a)-1-l>6)switch(da(a,l+1)){case 109:if(da(a,l+4)!==45)break;case 102:return Yr(a,/(.+:)(.+)-([^]+)/,"$1"+Xr+"$2-$3$1"+Ay+(da(a,l+3)==108?"$3":"$2-$3"))+a;case 115:return~l0(a,"stretch")?I2(Yr(a,"stretch","fill-available"),l)+a:a}break;case 4949:if(da(a,l+1)!==115)break;case 6444:switch(da(a,_h(a)-3-(~l0(a,"!important")&&10))){case 107:return Yr(a,":",":"+Xr)+a;case 101:return Yr(a,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Xr+(da(a,14)===45?"inline-":"")+"box$3$1"+Xr+"$2$3$1"+Ta+"$2box$3")+a}break;case 5936:switch(da(a,l+11)){case 114:return Xr+a+Ta+Yr(a,/[svh]\w+-[tblr]{2}/,"tb")+a;case 108:return Xr+a+Ta+Yr(a,/[svh]\w+-[tblr]{2}/,"tb-rl")+a;case 45:return Xr+a+Ta+Yr(a,/[svh]\w+-[tblr]{2}/,"lr")+a}return Xr+a+Ta+a+a}return a}var JR=function(l,m,_,w){if(l.length>-1&&!l.return)switch(l.type){case z0:l.return=I2(l.value,l.length);break;case w2:return bm([Rg(l,{value:Yr(l.value,"@","@"+Xr)})],w);case R0:if(l.length)return OR(l.props,function(C){switch(DR(C,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return bm([Rg(l,{props:[Yr(C,/:(read-\w+)/,":"+Ay+"$1")]})],w);case"::placeholder":return bm([Rg(l,{props:[Yr(C,/:(plac\w+)/,":"+Xr+"input-$1")]}),Rg(l,{props:[Yr(C,/:(plac\w+)/,":"+Ay+"$1")]}),Rg(l,{props:[Yr(C,/:(plac\w+)/,Ta+"input-$1")]})],w)}return""})}},ez=[JR],P2=function(l){var m=l.key;if(m==="css"){var _=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(_,function(ne){var Se=ne.getAttribute("data-emotion");Se.indexOf(" ")!==-1&&(document.head.appendChild(ne),ne.setAttribute("data-s",""))})}var w=l.stylisPlugins||ez,C={},M,r=[];M=l.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+m+' "]'),function(ne){for(var Se=ne.getAttribute("data-emotion").split(" "),me=1;me<Se.length;me++)C[Se[me]]=!0;r.push(ne)});var O,V=[YR,QR];{var U,Z=[$R,WR(function(ne){U.insert(ne)})],ie=GR(V.concat(w,Z)),de=function(Se){return bm(HR(Se),ie)};O=function(Se,me,Re,ye){U=Re,de(Se?Se+"{"+me.styles+"}":me.styles),ye&&(se.inserted[me.name]=!0)}}var se={key:m,sheet:new PR({key:m,container:M,nonce:l.nonce,speedy:l.speedy,prepend:l.prepend,insertionPoint:l.insertionPoint}),nonce:l.nonce,inserted:C,registered:{},insert:O};return se.sheet.hydrate(r),se},kx={exports:{}},ns={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aS;function tz(){if(aS)return ns;aS=1;var a=typeof Symbol=="function"&&Symbol.for,l=a?Symbol.for("react.element"):60103,m=a?Symbol.for("react.portal"):60106,_=a?Symbol.for("react.fragment"):60107,w=a?Symbol.for("react.strict_mode"):60108,C=a?Symbol.for("react.profiler"):60114,M=a?Symbol.for("react.provider"):60109,r=a?Symbol.for("react.context"):60110,O=a?Symbol.for("react.async_mode"):60111,V=a?Symbol.for("react.concurrent_mode"):60111,U=a?Symbol.for("react.forward_ref"):60112,Z=a?Symbol.for("react.suspense"):60113,ie=a?Symbol.for("react.suspense_list"):60120,de=a?Symbol.for("react.memo"):60115,se=a?Symbol.for("react.lazy"):60116,ne=a?Symbol.for("react.block"):60121,Se=a?Symbol.for("react.fundamental"):60117,me=a?Symbol.for("react.responder"):60118,Re=a?Symbol.for("react.scope"):60119;function ye(De){if(typeof De=="object"&&De!==null){var Oe=De.$$typeof;switch(Oe){case l:switch(De=De.type,De){case O:case V:case _:case C:case w:case Z:return De;default:switch(De=De&&De.$$typeof,De){case r:case U:case se:case de:case M:return De;default:return Oe}}case m:return Oe}}}function Le(De){return ye(De)===V}return ns.AsyncMode=O,ns.ConcurrentMode=V,ns.ContextConsumer=r,ns.ContextProvider=M,ns.Element=l,ns.ForwardRef=U,ns.Fragment=_,ns.Lazy=se,ns.Memo=de,ns.Portal=m,ns.Profiler=C,ns.StrictMode=w,ns.Suspense=Z,ns.isAsyncMode=function(De){return Le(De)||ye(De)===O},ns.isConcurrentMode=Le,ns.isContextConsumer=function(De){return ye(De)===r},ns.isContextProvider=function(De){return ye(De)===M},ns.isElement=function(De){return typeof De=="object"&&De!==null&&De.$$typeof===l},ns.isForwardRef=function(De){return ye(De)===U},ns.isFragment=function(De){return ye(De)===_},ns.isLazy=function(De){return ye(De)===se},ns.isMemo=function(De){return ye(De)===de},ns.isPortal=function(De){return ye(De)===m},ns.isProfiler=function(De){return ye(De)===C},ns.isStrictMode=function(De){return ye(De)===w},ns.isSuspense=function(De){return ye(De)===Z},ns.isValidElementType=function(De){return typeof De=="string"||typeof De=="function"||De===_||De===V||De===C||De===w||De===Z||De===ie||typeof De=="object"&&De!==null&&(De.$$typeof===se||De.$$typeof===de||De.$$typeof===M||De.$$typeof===r||De.$$typeof===U||De.$$typeof===Se||De.$$typeof===me||De.$$typeof===Re||De.$$typeof===ne)},ns.typeOf=ye,ns}var lS;function nz(){return lS||(lS=1,kx.exports=tz()),kx.exports}var Mx,cS;function iz(){if(cS)return Mx;cS=1;var a=nz(),l={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},m={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},_={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},w={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},C={};C[a.ForwardRef]=_,C[a.Memo]=w;function M(se){return a.isMemo(se)?w:C[se.$$typeof]||l}var r=Object.defineProperty,O=Object.getOwnPropertyNames,V=Object.getOwnPropertySymbols,U=Object.getOwnPropertyDescriptor,Z=Object.getPrototypeOf,ie=Object.prototype;function de(se,ne,Se){if(typeof ne!="string"){if(ie){var me=Z(ne);me&&me!==ie&&de(se,me,Se)}var Re=O(ne);V&&(Re=Re.concat(V(ne)));for(var ye=M(se),Le=M(ne),De=0;De<Re.length;++De){var Oe=Re[De];if(!m[Oe]&&!(Se&&Se[Oe])&&!(Le&&Le[Oe])&&!(ye&&ye[Oe])){var Ee=U(ne,Oe);try{r(se,Oe,Ee)}catch{}}}}return se}return Mx=de,Mx}iz();var rz=!0;function k2(a,l,m){var _="";return m.split(" ").forEach(function(w){a[w]!==void 0?l.push(a[w]+";"):w&&(_+=w+" ")}),_}var D0=function(l,m,_){var w=l.key+"-"+m.name;(_===!1||rz===!1)&&l.registered[w]===void 0&&(l.registered[w]=m.styles)},O0=function(l,m,_){D0(l,m,_);var w=l.key+"-"+m.name;if(l.inserted[m.name]===void 0){var C=m;do l.insert(m===C?"."+w:"",C,l.sheet,!0),C=C.next;while(C!==void 0)}};function sz(a){for(var l=0,m,_=0,w=a.length;w>=4;++_,w-=4)m=a.charCodeAt(_)&255|(a.charCodeAt(++_)&255)<<8|(a.charCodeAt(++_)&255)<<16|(a.charCodeAt(++_)&255)<<24,m=(m&65535)*1540483477+((m>>>16)*59797<<16),m^=m>>>24,l=(m&65535)*1540483477+((m>>>16)*59797<<16)^(l&65535)*1540483477+((l>>>16)*59797<<16);switch(w){case 3:l^=(a.charCodeAt(_+2)&255)<<16;case 2:l^=(a.charCodeAt(_+1)&255)<<8;case 1:l^=a.charCodeAt(_)&255,l=(l&65535)*1540483477+((l>>>16)*59797<<16)}return l^=l>>>13,l=(l&65535)*1540483477+((l>>>16)*59797<<16),((l^l>>>15)>>>0).toString(36)}var oz={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},az=/[A-Z]|^ms/g,lz=/_EMO_([^_]+?)_([^]*?)_EMO_/g,M2=function(l){return l.charCodeAt(1)===45},uS=function(l){return l!=null&&typeof l!="boolean"},Rx=A2(function(a){return M2(a)?a:a.replace(az,"-$&").toLowerCase()}),hS=function(l,m){switch(l){case"animation":case"animationName":if(typeof m=="string")return m.replace(lz,function(_,w,C){return yh={name:w,styles:C,next:yh},w})}return oz[l]!==1&&!M2(l)&&typeof m=="number"&&m!==0?m+"px":m};function a_(a,l,m){if(m==null)return"";var _=m;if(_.__emotion_styles!==void 0)return _;switch(typeof m){case"boolean":return"";case"object":{var w=m;if(w.anim===1)return yh={name:w.name,styles:w.styles,next:yh},w.name;var C=m;if(C.styles!==void 0){var M=C.next;if(M!==void 0)for(;M!==void 0;)yh={name:M.name,styles:M.styles,next:yh},M=M.next;var r=C.styles+";";return r}return cz(a,l,m)}case"function":{if(a!==void 0){var O=yh,V=m(a);return yh=O,a_(a,l,V)}break}}var U=m;if(l==null)return U;var Z=l[U];return Z!==void 0?Z:U}function cz(a,l,m){var _="";if(Array.isArray(m))for(var w=0;w<m.length;w++)_+=a_(a,l,m[w])+";";else for(var C in m){var M=m[C];if(typeof M!="object"){var r=M;l!=null&&l[r]!==void 0?_+=C+"{"+l[r]+"}":uS(r)&&(_+=Rx(C)+":"+hS(C,r)+";")}else if(Array.isArray(M)&&typeof M[0]=="string"&&(l==null||l[M[0]]===void 0))for(var O=0;O<M.length;O++)uS(M[O])&&(_+=Rx(C)+":"+hS(C,M[O])+";");else{var V=a_(a,l,M);switch(C){case"animation":case"animationName":{_+=Rx(C)+":"+V+";";break}default:_+=C+"{"+V+"}"}}}return _}var dS=/label:\s*([^\s;{]+)\s*(;|$)/g,yh;function f_(a,l,m){if(a.length===1&&typeof a[0]=="object"&&a[0]!==null&&a[0].styles!==void 0)return a[0];var _=!0,w="";yh=void 0;var C=a[0];if(C==null||C.raw===void 0)_=!1,w+=a_(m,l,C);else{var M=C;w+=M[0]}for(var r=1;r<a.length;r++)if(w+=a_(m,l,a[r]),_){var O=C;w+=O[r]}dS.lastIndex=0;for(var V="",U;(U=dS.exec(w))!==null;)V+="-"+U[1];var Z=sz(w)+V;return{name:Z,styles:w,next:yh}}var uz=function(l){return l()},R2=Ey.useInsertionEffect?Ey.useInsertionEffect:!1,z2=R2||uz,pS=R2||ue.useLayoutEffect,L2=ue.createContext(typeof HTMLElement<"u"?P2({key:"css"}):null),hz=L2.Provider,B0=function(l){return ue.forwardRef(function(m,_){var w=ue.useContext(L2);return l(m,w,_)})},Dm=ue.createContext({}),F0={}.hasOwnProperty,u0="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",dz=function(l,m){var _={};for(var w in m)F0.call(m,w)&&(_[w]=m[w]);return _[u0]=l,_},pz=function(l){var m=l.cache,_=l.serialized,w=l.isStringTag;return D0(m,_,w),z2(function(){return O0(m,_,w)}),null},fz=B0(function(a,l,m){var _=a.css;typeof _=="string"&&l.registered[_]!==void 0&&(_=l.registered[_]);var w=a[u0],C=[_],M="";typeof a.className=="string"?M=k2(l.registered,C,a.className):a.className!=null&&(M=a.className+" ");var r=f_(C,void 0,ue.useContext(Dm));M+=l.key+"-"+r.name;var O={};for(var V in a)F0.call(a,V)&&V!=="css"&&V!==u0&&(O[V]=a[V]);return O.className=M,m&&(O.ref=m),ue.createElement(ue.Fragment,null,ue.createElement(pz,{cache:l,serialized:r,isStringTag:typeof w=="string"}),ue.createElement(w,O))}),mz=fz,fS=function(l,m){var _=arguments;if(m==null||!F0.call(m,"css"))return ue.createElement.apply(void 0,_);var w=_.length,C=new Array(w);C[0]=mz,C[1]=dz(l,m);for(var M=2;M<w;M++)C[M]=_[M];return ue.createElement.apply(null,C)};(function(a){var l;l||(l=a.JSX||(a.JSX={}))})(fS||(fS={}));var gz=B0(function(a,l){var m=a.styles,_=f_([m],void 0,ue.useContext(Dm)),w=ue.useRef();return pS(function(){var C=l.key+"-global",M=new l.sheet.constructor({key:C,nonce:l.sheet.nonce,container:l.sheet.container,speedy:l.sheet.isSpeedy}),r=!1,O=document.querySelector('style[data-emotion="'+C+" "+_.name+'"]');return l.sheet.tags.length&&(M.before=l.sheet.tags[0]),O!==null&&(r=!0,O.setAttribute("data-emotion",C),M.hydrate([O])),w.current=[M,r],function(){M.flush()}},[l]),pS(function(){var C=w.current,M=C[0],r=C[1];if(r){C[1]=!1;return}if(_.next!==void 0&&O0(l,_.next,!0),M.tags.length){var O=M.tags[M.tags.length-1].nextElementSibling;M.before=O,M.flush()}l.insert("",_,M,!1)},[l,_.name]),null});function D2(){for(var a=arguments.length,l=new Array(a),m=0;m<a;m++)l[m]=arguments[m];return f_(l)}function Ky(){var a=D2.apply(void 0,arguments),l="animation-"+a.name;return{name:l,styles:"@keyframes "+l+"{"+a.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var _z=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,yz=A2(function(a){return _z.test(a)||a.charCodeAt(0)===111&&a.charCodeAt(1)===110&&a.charCodeAt(2)<91}),vz=yz,xz=function(l){return l!=="theme"},mS=function(l){return typeof l=="string"&&l.charCodeAt(0)>96?vz:xz},gS=function(l,m,_){var w;if(m){var C=m.shouldForwardProp;w=l.__emotion_forwardProp&&C?function(M){return l.__emotion_forwardProp(M)&&C(M)}:C}return typeof w!="function"&&_&&(w=l.__emotion_forwardProp),w},bz=function(l){var m=l.cache,_=l.serialized,w=l.isStringTag;return D0(m,_,w),z2(function(){return O0(m,_,w)}),null},wz=function a(l,m){var _=l.__emotion_real===l,w=_&&l.__emotion_base||l,C,M;m!==void 0&&(C=m.label,M=m.target);var r=gS(l,m,_),O=r||mS(w),V=!O("as");return function(){var U=arguments,Z=_&&l.__emotion_styles!==void 0?l.__emotion_styles.slice(0):[];if(C!==void 0&&Z.push("label:"+C+";"),U[0]==null||U[0].raw===void 0)Z.push.apply(Z,U);else{var ie=U[0];Z.push(ie[0]);for(var de=U.length,se=1;se<de;se++)Z.push(U[se],ie[se])}var ne=B0(function(Se,me,Re){var ye=V&&Se.as||w,Le="",De=[],Oe=Se;if(Se.theme==null){Oe={};for(var Ee in Se)Oe[Ee]=Se[Ee];Oe.theme=ue.useContext(Dm)}typeof Se.className=="string"?Le=k2(me.registered,De,Se.className):Se.className!=null&&(Le=Se.className+" ");var qe=f_(Z.concat(De),me.registered,Oe);Le+=me.key+"-"+qe.name,M!==void 0&&(Le+=" "+M);var $e=V&&r===void 0?mS(ye):O,Ge={};for(var et in Se)V&&et==="as"||$e(et)&&(Ge[et]=Se[et]);return Ge.className=Le,Re&&(Ge.ref=Re),ue.createElement(ue.Fragment,null,ue.createElement(bz,{cache:me,serialized:qe,isStringTag:typeof ye=="string"}),ue.createElement(ye,Ge))});return ne.displayName=C!==void 0?C:"Styled("+(typeof w=="string"?w:w.displayName||w.name||"Component")+")",ne.defaultProps=l.defaultProps,ne.__emotion_real=ne,ne.__emotion_base=w,ne.__emotion_styles=Z,ne.__emotion_forwardProp=r,Object.defineProperty(ne,"toString",{value:function(){return"."+M}}),ne.withComponent=function(Se,me){var Re=a(Se,Fe({},m,me,{shouldForwardProp:gS(ne,me,!0)}));return Re.apply(void 0,Z)},ne}},Tz=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],h0=wz.bind(null);Tz.forEach(function(a){h0[a]=h0(a)});function Sz(a,l){const m=P2({key:"css",prepend:a});if(l){const _=m.insert;m.insert=(...w)=>(w[1].styles.match(/^@layer\s+[^{]*$/)||(w[1].styles=`@layer mui {${w[1].styles}}`),_(...w))}return m}const zx=new Map;function Cz(a){const{injectFirst:l,enableCssLayer:m,children:_}=a,w=ue.useMemo(()=>{const C=`${l}-${m}`;if(typeof document=="object"&&zx.has(C))return zx.get(C);const M=Sz(l,m);return zx.set(C,M),M},[l,m]);return l||m?Ne.jsx(hz,{value:w,children:_}):_}function Ez(a){return a==null||Object.keys(a).length===0}function O2(a){const{styles:l,defaultTheme:m={}}=a,_=typeof l=="function"?w=>l(Ez(w)?m:w):l;return Ne.jsx(gz,{styles:_})}function j0(a,l){return h0(a,l)}const B2=(a,l)=>{Array.isArray(a.__emotion_styles)&&(a.__emotion_styles=l(a.__emotion_styles))},_S=[];function Iy(a){return _S[0]=a,f_(_S)}const Az=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:O2,StyledEngineProvider:Cz,ThemeContext:Dm,css:D2,default:j0,internal_processStyles:B2,internal_serializeStyles:Iy,keyframes:Ky},Symbol.toStringTag,{value:"Module"}));function yd(a){if(typeof a!="object"||a===null)return!1;const l=Object.getPrototypeOf(a);return(l===null||l===Object.prototype||Object.getPrototypeOf(l)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)}function F2(a){if(ue.isValidElement(a)||!yd(a))return a;const l={};return Object.keys(a).forEach(m=>{l[m]=F2(a[m])}),l}function ja(a,l,m={clone:!0}){const _=m.clone?Fe({},a):a;return yd(a)&&yd(l)&&Object.keys(l).forEach(w=>{ue.isValidElement(l[w])?_[w]=l[w]:yd(l[w])&&Object.prototype.hasOwnProperty.call(a,w)&&yd(a[w])?_[w]=ja(a[w],l[w],m):m.clone?_[w]=yd(l[w])?F2(l[w]):l[w]:_[w]=l[w]}),_}const Iz=Object.freeze(Object.defineProperty({__proto__:null,default:ja,isPlainObject:yd},Symbol.toStringTag,{value:"Module"})),Pz=["values","unit","step"],kz=a=>{const l=Object.keys(a).map(m=>({key:m,val:a[m]}))||[];return l.sort((m,_)=>m.val-_.val),l.reduce((m,_)=>Fe({},m,{[_.key]:_.val}),{})};function j2(a){const{values:l={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:m="px",step:_=5}=a,w=Yn(a,Pz),C=kz(l),M=Object.keys(C);function r(ie){return`@media (min-width:${typeof l[ie]=="number"?l[ie]:ie}${m})`}function O(ie){return`@media (max-width:${(typeof l[ie]=="number"?l[ie]:ie)-_/100}${m})`}function V(ie,de){const se=M.indexOf(de);return`@media (min-width:${typeof l[ie]=="number"?l[ie]:ie}${m}) and (max-width:${(se!==-1&&typeof l[M[se]]=="number"?l[M[se]]:de)-_/100}${m})`}function U(ie){return M.indexOf(ie)+1<M.length?V(ie,M[M.indexOf(ie)+1]):r(ie)}function Z(ie){const de=M.indexOf(ie);return de===0?r(M[1]):de===M.length-1?O(M[de]):V(ie,M[M.indexOf(ie)+1]).replace("@media","@media not all and")}return Fe({keys:M,values:C,up:r,down:O,between:V,only:U,not:Z,unit:m},w)}const Mz={borderRadius:4};function Yg(a,l){return l?ja(a,l,{clone:!1}):a}const N0={xs:0,sm:600,md:900,lg:1200,xl:1536},yS={keys:["xs","sm","md","lg","xl"],up:a=>`@media (min-width:${N0[a]}px)`};function ml(a,l,m){const _=a.theme||{};if(Array.isArray(l)){const C=_.breakpoints||yS;return l.reduce((M,r,O)=>(M[C.up(C.keys[O])]=m(l[O]),M),{})}if(typeof l=="object"){const C=_.breakpoints||yS;return Object.keys(l).reduce((M,r)=>{if(Object.keys(C.values||N0).indexOf(r)!==-1){const O=C.up(r);M[O]=m(l[r],r)}else{const O=r;M[O]=l[O]}return M},{})}return m(l)}function N2(a={}){var l;return((l=a.keys)==null?void 0:l.reduce((_,w)=>{const C=a.up(w);return _[C]={},_},{}))||{}}function d0(a,l){return a.reduce((m,_)=>{const w=m[_];return(!w||Object.keys(w).length===0)&&delete m[_],m},l)}function Rz(a,...l){const m=N2(a),_=[m,...l].reduce((w,C)=>ja(w,C),{});return d0(Object.keys(m),_)}function zz(a,l){if(typeof a!="object")return{};const m={},_=Object.keys(l);return Array.isArray(a)?_.forEach((w,C)=>{C<a.length&&(m[w]=!0)}):_.forEach(w=>{a[w]!=null&&(m[w]=!0)}),m}function Tf({values:a,breakpoints:l,base:m}){const _=m||zz(a,l),w=Object.keys(_);if(w.length===0)return a;let C;return w.reduce((M,r,O)=>(Array.isArray(a)?(M[r]=a[O]!=null?a[O]:a[C],C=O):typeof a=="object"?(M[r]=a[r]!=null?a[r]:a[C],C=r):M[r]=a,M),{})}function vn(a){if(typeof a!="string")throw new Error(xd(7));return a.charAt(0).toUpperCase()+a.slice(1)}const Lz=Object.freeze(Object.defineProperty({__proto__:null,default:vn},Symbol.toStringTag,{value:"Module"}));function Im(a,l,m=!0){if(!l||typeof l!="string")return null;if(a&&a.vars&&m){const _=`vars.${l}`.split(".").reduce((w,C)=>w&&w[C]?w[C]:null,a);if(_!=null)return _}return l.split(".").reduce((_,w)=>_&&_[w]!=null?_[w]:null,a)}function Py(a,l,m,_=m){let w;return typeof a=="function"?w=a(m):Array.isArray(a)?w=a[m]||_:w=Im(a,m)||_,l&&(w=l(w,_,a)),w}function uo(a){const{prop:l,cssProperty:m=a.prop,themeKey:_,transform:w}=a,C=M=>{if(M[l]==null)return null;const r=M[l],O=M.theme,V=Im(O,_)||{};return ml(M,r,Z=>{let ie=Py(V,w,Z);return Z===ie&&typeof Z=="string"&&(ie=Py(V,w,`${l}${Z==="default"?"":vn(Z)}`,Z)),m===!1?ie:{[m]:ie}})};return C.propTypes={},C.filterProps=[l],C}function Dz(a){const l={};return m=>(l[m]===void 0&&(l[m]=a(m)),l[m])}const Oz={m:"margin",p:"padding"},Bz={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},vS={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Fz=Dz(a=>{if(a.length>2)if(vS[a])a=vS[a];else return[a];const[l,m]=a.split(""),_=Oz[l],w=Bz[m]||"";return Array.isArray(w)?w.map(C=>_+C):[_+w]}),V0=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],q0=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...V0,...q0];function m_(a,l,m,_){var w;const C=(w=Im(a,l,!1))!=null?w:m;return typeof C=="number"?M=>typeof M=="string"?M:C*M:Array.isArray(C)?M=>typeof M=="string"?M:C[M]:typeof C=="function"?C:()=>{}}function H0(a){return m_(a,"spacing",8)}function Cf(a,l){if(typeof l=="string"||l==null)return l;const m=Math.abs(l),_=a(m);return l>=0?_:typeof _=="number"?-_:`-${_}`}function jz(a,l){return m=>a.reduce((_,w)=>(_[w]=Cf(l,m),_),{})}function Nz(a,l,m,_){if(l.indexOf(m)===-1)return null;const w=Fz(m),C=jz(w,_),M=a[m];return ml(a,M,C)}function V2(a,l){const m=H0(a.theme);return Object.keys(a).map(_=>Nz(a,l,_,m)).reduce(Yg,{})}function no(a){return V2(a,V0)}no.propTypes={};no.filterProps=V0;function io(a){return V2(a,q0)}io.propTypes={};io.filterProps=q0;function Vz(a=8){if(a.mui)return a;const l=H0({spacing:a}),m=(..._)=>(_.length===0?[1]:_).map(C=>{const M=l(C);return typeof M=="number"?`${M}px`:M}).join(" ");return m.mui=!0,m}function Xy(...a){const l=a.reduce((_,w)=>(w.filterProps.forEach(C=>{_[C]=w}),_),{}),m=_=>Object.keys(_).reduce((w,C)=>l[C]?Yg(w,l[C](_)):w,{});return m.propTypes={},m.filterProps=a.reduce((_,w)=>_.concat(w.filterProps),[]),m}function kc(a){return typeof a!="number"?a:`${a}px solid`}function Mc(a,l){return uo({prop:a,themeKey:"borders",transform:l})}const qz=Mc("border",kc),Hz=Mc("borderTop",kc),Uz=Mc("borderRight",kc),$z=Mc("borderBottom",kc),Gz=Mc("borderLeft",kc),Wz=Mc("borderColor"),Zz=Mc("borderTopColor"),Kz=Mc("borderRightColor"),Xz=Mc("borderBottomColor"),Yz=Mc("borderLeftColor"),Qz=Mc("outline",kc),Jz=Mc("outlineColor"),Yy=a=>{if(a.borderRadius!==void 0&&a.borderRadius!==null){const l=m_(a.theme,"shape.borderRadius",4),m=_=>({borderRadius:Cf(l,_)});return ml(a,a.borderRadius,m)}return null};Yy.propTypes={};Yy.filterProps=["borderRadius"];Xy(qz,Hz,Uz,$z,Gz,Wz,Zz,Kz,Xz,Yz,Yy,Qz,Jz);const Qy=a=>{if(a.gap!==void 0&&a.gap!==null){const l=m_(a.theme,"spacing",8),m=_=>({gap:Cf(l,_)});return ml(a,a.gap,m)}return null};Qy.propTypes={};Qy.filterProps=["gap"];const Jy=a=>{if(a.columnGap!==void 0&&a.columnGap!==null){const l=m_(a.theme,"spacing",8),m=_=>({columnGap:Cf(l,_)});return ml(a,a.columnGap,m)}return null};Jy.propTypes={};Jy.filterProps=["columnGap"];const ev=a=>{if(a.rowGap!==void 0&&a.rowGap!==null){const l=m_(a.theme,"spacing",8),m=_=>({rowGap:Cf(l,_)});return ml(a,a.rowGap,m)}return null};ev.propTypes={};ev.filterProps=["rowGap"];const eL=uo({prop:"gridColumn"}),tL=uo({prop:"gridRow"}),nL=uo({prop:"gridAutoFlow"}),iL=uo({prop:"gridAutoColumns"}),rL=uo({prop:"gridAutoRows"}),sL=uo({prop:"gridTemplateColumns"}),oL=uo({prop:"gridTemplateRows"}),aL=uo({prop:"gridTemplateAreas"}),lL=uo({prop:"gridArea"});Xy(Qy,Jy,ev,eL,tL,nL,iL,rL,sL,oL,aL,lL);function wm(a,l){return l==="grey"?l:a}const cL=uo({prop:"color",themeKey:"palette",transform:wm}),uL=uo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:wm}),hL=uo({prop:"backgroundColor",themeKey:"palette",transform:wm});Xy(cL,uL,hL);function ql(a){return a<=1&&a!==0?`${a*100}%`:a}const dL=uo({prop:"width",transform:ql}),U0=a=>{if(a.maxWidth!==void 0&&a.maxWidth!==null){const l=m=>{var _,w;const C=((_=a.theme)==null||(_=_.breakpoints)==null||(_=_.values)==null?void 0:_[m])||N0[m];return C?((w=a.theme)==null||(w=w.breakpoints)==null?void 0:w.unit)!=="px"?{maxWidth:`${C}${a.theme.breakpoints.unit}`}:{maxWidth:C}:{maxWidth:ql(m)}};return ml(a,a.maxWidth,l)}return null};U0.filterProps=["maxWidth"];const pL=uo({prop:"minWidth",transform:ql}),fL=uo({prop:"height",transform:ql}),mL=uo({prop:"maxHeight",transform:ql}),gL=uo({prop:"minHeight",transform:ql});uo({prop:"size",cssProperty:"width",transform:ql});uo({prop:"size",cssProperty:"height",transform:ql});const _L=uo({prop:"boxSizing"});Xy(dL,U0,pL,fL,mL,gL,_L);const g_={border:{themeKey:"borders",transform:kc},borderTop:{themeKey:"borders",transform:kc},borderRight:{themeKey:"borders",transform:kc},borderBottom:{themeKey:"borders",transform:kc},borderLeft:{themeKey:"borders",transform:kc},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:kc},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Yy},color:{themeKey:"palette",transform:wm},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:wm},backgroundColor:{themeKey:"palette",transform:wm},p:{style:io},pt:{style:io},pr:{style:io},pb:{style:io},pl:{style:io},px:{style:io},py:{style:io},padding:{style:io},paddingTop:{style:io},paddingRight:{style:io},paddingBottom:{style:io},paddingLeft:{style:io},paddingX:{style:io},paddingY:{style:io},paddingInline:{style:io},paddingInlineStart:{style:io},paddingInlineEnd:{style:io},paddingBlock:{style:io},paddingBlockStart:{style:io},paddingBlockEnd:{style:io},m:{style:no},mt:{style:no},mr:{style:no},mb:{style:no},ml:{style:no},mx:{style:no},my:{style:no},margin:{style:no},marginTop:{style:no},marginRight:{style:no},marginBottom:{style:no},marginLeft:{style:no},marginX:{style:no},marginY:{style:no},marginInline:{style:no},marginInlineStart:{style:no},marginInlineEnd:{style:no},marginBlock:{style:no},marginBlockStart:{style:no},marginBlockEnd:{style:no},displayPrint:{cssProperty:!1,transform:a=>({"@media print":{display:a}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Qy},rowGap:{style:ev},columnGap:{style:Jy},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:ql},maxWidth:{style:U0},minWidth:{transform:ql},height:{transform:ql},maxHeight:{transform:ql},minHeight:{transform:ql},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function yL(...a){const l=a.reduce((_,w)=>_.concat(Object.keys(w)),[]),m=new Set(l);return a.every(_=>m.size===Object.keys(_).length)}function vL(a,l){return typeof a=="function"?a(l):a}function q2(){function a(m,_,w,C){const M={[m]:_,theme:w},r=C[m];if(!r)return{[m]:_};const{cssProperty:O=m,themeKey:V,transform:U,style:Z}=r;if(_==null)return null;if(V==="typography"&&_==="inherit")return{[m]:_};const ie=Im(w,V)||{};return Z?Z(M):ml(M,_,se=>{let ne=Py(ie,U,se);return se===ne&&typeof se=="string"&&(ne=Py(ie,U,`${m}${se==="default"?"":vn(se)}`,se)),O===!1?ne:{[O]:ne}})}function l(m){var _;const{sx:w,theme:C={},nested:M}=m||{};if(!w)return null;const r=(_=C.unstable_sxConfig)!=null?_:g_;function O(V){let U=V;if(typeof V=="function")U=V(C);else if(typeof V!="object")return V;if(!U)return null;const Z=N2(C.breakpoints),ie=Object.keys(Z);let de=Z;return Object.keys(U).forEach(se=>{const ne=vL(U[se],C);if(ne!=null)if(typeof ne=="object")if(r[se])de=Yg(de,a(se,ne,C,r));else{const Se=ml({theme:C},ne,me=>({[se]:me}));yL(Se,ne)?de[se]=l({sx:ne,theme:C,nested:!0}):de=Yg(de,Se)}else de=Yg(de,a(se,ne,C,r))}),!M&&C.modularCssLayers?{"@layer sx":d0(ie,de)}:d0(ie,de)}return Array.isArray(w)?w.map(O):O(w)}return l}const Om=q2();Om.filterProps=["sx"];function H2(a,l){const m=this;return m.vars&&typeof m.getColorSchemeSelector=="function"?{[m.getColorSchemeSelector(a).replace(/(\[[^\]]+\])/,"*:where($1)")]:l}:m.palette.mode===a?l:{}}const xL=["breakpoints","palette","spacing","shape"];function Bm(a={},...l){const{breakpoints:m={},palette:_={},spacing:w,shape:C={}}=a,M=Yn(a,xL),r=j2(m),O=Vz(w);let V=ja({breakpoints:r,direction:"ltr",components:{},palette:Fe({mode:"light"},_),spacing:O,shape:Fe({},Mz,C)},M);return V.applyStyles=H2,V=l.reduce((U,Z)=>ja(U,Z),V),V.unstable_sxConfig=Fe({},g_,M==null?void 0:M.unstable_sxConfig),V.unstable_sx=function(Z){return Om({sx:Z,theme:this})},V}const bL=Object.freeze(Object.defineProperty({__proto__:null,default:Bm,private_createBreakpoints:j2,unstable_applyStyles:H2},Symbol.toStringTag,{value:"Module"}));function wL(a){return Object.keys(a).length===0}function $0(a=null){const l=ue.useContext(Dm);return!l||wL(l)?a:l}const TL=Bm();function tv(a=TL){return $0(a)}function Lx(a){const l=Iy(a);return a!==l&&l.styles?(l.styles.match(/^@layer\s+[^{]*$/)||(l.styles=`@layer global{${l.styles}}`),l):a}function U2({styles:a,themeId:l,defaultTheme:m={}}){const _=tv(m),w=l&&_[l]||_;let C=typeof a=="function"?a(w):a;return w.modularCssLayers&&(Array.isArray(C)?C=C.map(M=>Lx(typeof M=="function"?M(w):M)):C=Lx(C)),Ne.jsx(O2,{styles:C})}const SL=["sx"],CL=a=>{var l,m;const _={systemProps:{},otherProps:{}},w=(l=a==null||(m=a.theme)==null?void 0:m.unstable_sxConfig)!=null?l:g_;return Object.keys(a).forEach(C=>{w[C]?_.systemProps[C]=a[C]:_.otherProps[C]=a[C]}),_};function __(a){const{sx:l}=a,m=Yn(a,SL),{systemProps:_,otherProps:w}=CL(m);let C;return Array.isArray(l)?C=[_,...l]:typeof l=="function"?C=(...M)=>{const r=l(...M);return yd(r)?Fe({},_,r):_}:C=Fe({},_,l),Fe({},w,{sx:C})}const EL=Object.freeze(Object.defineProperty({__proto__:null,default:Om,extendSxProp:__,unstable_createStyleFunctionSx:q2,unstable_defaultSxConfig:g_},Symbol.toStringTag,{value:"Module"})),xS=a=>a,AL=()=>{let a=xS;return{configure(l){a=l},generate(l){return a(l)},reset(){a=xS}}},G0=AL();function $2(a){var l,m,_="";if(typeof a=="string"||typeof a=="number")_+=a;else if(typeof a=="object")if(Array.isArray(a)){var w=a.length;for(l=0;l<w;l++)a[l]&&(m=$2(a[l]))&&(_&&(_+=" "),_+=m)}else for(m in a)a[m]&&(_&&(_+=" "),_+=m);return _}function oi(){for(var a,l,m=0,_="",w=arguments.length;m<w;m++)(a=arguments[m])&&(l=$2(a))&&(_&&(_+=" "),_+=l);return _}const IL=["className","component"];function PL(a={}){const{themeId:l,defaultTheme:m,defaultClassName:_="MuiBox-root",generateClassName:w}=a,C=j0("div",{shouldForwardProp:r=>r!=="theme"&&r!=="sx"&&r!=="as"})(Om);return ue.forwardRef(function(O,V){const U=tv(m),Z=__(O),{className:ie,component:de="div"}=Z,se=Yn(Z,IL);return Ne.jsx(C,Fe({as:de,ref:V,className:oi(ie,w?w(_):_),theme:l&&U[l]||U},se))})}const kL={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function dr(a,l,m="Mui"){const _=kL[l];return _?`${m}-${_}`:`${G0.generate(a)}-${l}`}function rr(a,l,m="Mui"){const _={};return l.forEach(w=>{_[w]=dr(a,w,m)}),_}var Dx={exports:{}},hs={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bS;function ML(){if(bS)return hs;bS=1;var a=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),M=Symbol.for("react.context"),r=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),ie=Symbol.for("react.view_transition"),de=Symbol.for("react.client.reference");function se(ne){if(typeof ne=="object"&&ne!==null){var Se=ne.$$typeof;switch(Se){case a:switch(ne=ne.type,ne){case m:case w:case _:case O:case V:case ie:return ne;default:switch(ne=ne&&ne.$$typeof,ne){case M:case r:case Z:case U:return ne;case C:return ne;default:return Se}}case l:return Se}}}return hs.ContextConsumer=C,hs.ContextProvider=M,hs.Element=a,hs.ForwardRef=r,hs.Fragment=m,hs.Lazy=Z,hs.Memo=U,hs.Portal=l,hs.Profiler=w,hs.StrictMode=_,hs.Suspense=O,hs.SuspenseList=V,hs.isContextConsumer=function(ne){return se(ne)===C},hs.isContextProvider=function(ne){return se(ne)===M},hs.isElement=function(ne){return typeof ne=="object"&&ne!==null&&ne.$$typeof===a},hs.isForwardRef=function(ne){return se(ne)===r},hs.isFragment=function(ne){return se(ne)===m},hs.isLazy=function(ne){return se(ne)===Z},hs.isMemo=function(ne){return se(ne)===U},hs.isPortal=function(ne){return se(ne)===l},hs.isProfiler=function(ne){return se(ne)===w},hs.isStrictMode=function(ne){return se(ne)===_},hs.isSuspense=function(ne){return se(ne)===O},hs.isSuspenseList=function(ne){return se(ne)===V},hs.isValidElementType=function(ne){return typeof ne=="string"||typeof ne=="function"||ne===m||ne===w||ne===_||ne===O||ne===V||typeof ne=="object"&&ne!==null&&(ne.$$typeof===Z||ne.$$typeof===U||ne.$$typeof===M||ne.$$typeof===C||ne.$$typeof===r||ne.$$typeof===de||ne.getModuleId!==void 0)},hs.typeOf=se,hs}var wS;function RL(){return wS||(wS=1,Dx.exports=ML()),Dx.exports}var TS=RL();const zL=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function G2(a){const l=`${a}`.match(zL);return l&&l[1]||""}function W2(a,l=""){return a.displayName||a.name||G2(a)||l}function SS(a,l,m){const _=W2(l);return a.displayName||(_!==""?`${m}(${_})`:m)}function LL(a){if(a!=null){if(typeof a=="string")return a;if(typeof a=="function")return W2(a,"Component");if(typeof a=="object")switch(a.$$typeof){case TS.ForwardRef:return SS(a,a.render,"ForwardRef");case TS.Memo:return SS(a,a.type,"memo");default:return}}}const DL=Object.freeze(Object.defineProperty({__proto__:null,default:LL,getFunctionName:G2},Symbol.toStringTag,{value:"Module"})),OL=["ownerState"],BL=["variants"],FL=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function jL(a){return Object.keys(a).length===0}function NL(a){return typeof a=="string"&&a.charCodeAt(0)>96}function Ox(a){return a!=="ownerState"&&a!=="theme"&&a!=="sx"&&a!=="as"}function CS(a,l){return l&&a&&typeof a=="object"&&a.styles&&!a.styles.startsWith("@layer")&&(a.styles=`@layer ${l}{${String(a.styles)}}`),a}const VL=Bm(),qL=a=>a&&a.charAt(0).toLowerCase()+a.slice(1);function hy({defaultTheme:a,theme:l,themeId:m}){return jL(l)?a:l[m]||l}function HL(a){return a?(l,m)=>m[a]:null}function wy(a,l,m){let{ownerState:_}=l,w=Yn(l,OL);const C=typeof a=="function"?a(Fe({ownerState:_},w)):a;if(Array.isArray(C))return C.flatMap(M=>wy(M,Fe({ownerState:_},w),m));if(C&&typeof C=="object"&&Array.isArray(C.variants)){const{variants:M=[]}=C;let O=Yn(C,BL);return M.forEach(V=>{let U=!0;if(typeof V.props=="function"?U=V.props(Fe({ownerState:_},w,_)):Object.keys(V.props).forEach(Z=>{(_==null?void 0:_[Z])!==V.props[Z]&&w[Z]!==V.props[Z]&&(U=!1)}),U){Array.isArray(O)||(O=[O]);const Z=typeof V.style=="function"?V.style(Fe({ownerState:_},w,_)):V.style;O.push(m?CS(Iy(Z),m):Z)}}),O}return m?CS(Iy(C),m):C}function UL(a={}){const{themeId:l,defaultTheme:m=VL,rootShouldForwardProp:_=Ox,slotShouldForwardProp:w=Ox}=a,C=M=>Om(Fe({},M,{theme:hy(Fe({},M,{defaultTheme:m,themeId:l}))}));return C.__mui_systemSx=!0,(M,r={})=>{B2(M,Oe=>Oe.filter(Ee=>!(Ee!=null&&Ee.__mui_systemSx)));const{name:O,slot:V,skipVariantsResolver:U,skipSx:Z,overridesResolver:ie=HL(qL(V))}=r,de=Yn(r,FL),se=O&&O.startsWith("Mui")||V?"components":"custom",ne=U!==void 0?U:V&&V!=="Root"&&V!=="root"||!1,Se=Z||!1;let me,Re=Ox;V==="Root"||V==="root"?Re=_:V?Re=w:NL(M)&&(Re=void 0);const ye=j0(M,Fe({shouldForwardProp:Re,label:me},de)),Le=Oe=>typeof Oe=="function"&&Oe.__emotion_real!==Oe||yd(Oe)?Ee=>{const qe=hy({theme:Ee.theme,defaultTheme:m,themeId:l});return wy(Oe,Fe({},Ee,{theme:qe}),qe.modularCssLayers?se:void 0)}:Oe,De=(Oe,...Ee)=>{let qe=Le(Oe);const $e=Ee?Ee.map(Le):[];O&&ie&&$e.push(mt=>{const St=hy(Fe({},mt,{defaultTheme:m,themeId:l}));if(!St.components||!St.components[O]||!St.components[O].styleOverrides)return null;const xt=St.components[O].styleOverrides,At={};return Object.entries(xt).forEach(([Ct,Ut])=>{At[Ct]=wy(Ut,Fe({},mt,{theme:St}),St.modularCssLayers?"theme":void 0)}),ie(mt,At)}),O&&!ne&&$e.push(mt=>{var St;const xt=hy(Fe({},mt,{defaultTheme:m,themeId:l})),At=xt==null||(St=xt.components)==null||(St=St[O])==null?void 0:St.variants;return wy({variants:At},Fe({},mt,{theme:xt}),xt.modularCssLayers?"theme":void 0)}),Se||$e.push(C);const Ge=$e.length-Ee.length;if(Array.isArray(Oe)&&Ge>0){const mt=new Array(Ge).fill("");qe=[...Oe,...mt],qe.raw=[...Oe.raw,...mt]}const et=ye(qe,...$e);return M.muiName&&(et.muiName=M.muiName),et};return ye.withConfig&&(De.withConfig=ye.withConfig),De}}const Z2=UL();function l_(a,l){const m=Fe({},l);return Object.keys(a).forEach(_=>{if(_.toString().match(/^(components|slots)$/))m[_]=Fe({},a[_],m[_]);else if(_.toString().match(/^(componentsProps|slotProps)$/)){const w=a[_]||{},C=l[_];m[_]={},!C||!Object.keys(C)?m[_]=w:!w||!Object.keys(w)?m[_]=C:(m[_]=Fe({},C),Object.keys(w).forEach(M=>{m[_][M]=l_(w[M],C[M])}))}else m[_]===void 0&&(m[_]=a[_])}),m}function $L(a){const{theme:l,name:m,props:_}=a;return!l||!l.components||!l.components[m]||!l.components[m].defaultProps?_:l_(l.components[m].defaultProps,_)}function K2({props:a,name:l,defaultTheme:m,themeId:_}){let w=tv(m);return _&&(w=w[_]||w),$L({theme:w,name:l,props:a})}const bh=typeof window<"u"?ue.useLayoutEffect:ue.useEffect;function X2(a,l=Number.MIN_SAFE_INTEGER,m=Number.MAX_SAFE_INTEGER){return Math.max(l,Math.min(a,m))}const GL=Object.freeze(Object.defineProperty({__proto__:null,default:X2},Symbol.toStringTag,{value:"Module"}));function WL(a,l=0,m=1){return X2(a,l,m)}function ZL(a){a=a.slice(1);const l=new RegExp(`.{1,${a.length>=6?2:1}}`,"g");let m=a.match(l);return m&&m[0].length===1&&(m=m.map(_=>_+_)),m?`rgb${m.length===4?"a":""}(${m.map((_,w)=>w<3?parseInt(_,16):Math.round(parseInt(_,16)/255*1e3)/1e3).join(", ")})`:""}function Y2(a){if(a.type)return a;if(a.charAt(0)==="#")return Y2(ZL(a));const l=a.indexOf("("),m=a.substring(0,l);if(["rgb","rgba","hsl","hsla","color"].indexOf(m)===-1)throw new Error(xd(9,a));let _=a.substring(l+1,a.length-1),w;if(m==="color"){if(_=_.split(" "),w=_.shift(),_.length===4&&_[3].charAt(0)==="/"&&(_[3]=_[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(w)===-1)throw new Error(xd(10,w))}else _=_.split(",");return _=_.map(C=>parseFloat(C)),{type:m,values:_,colorSpace:w}}function KL(a){const{type:l,colorSpace:m}=a;let{values:_}=a;return l.indexOf("rgb")!==-1?_=_.map((w,C)=>C<3?parseInt(w,10):w):l.indexOf("hsl")!==-1&&(_[1]=`${_[1]}%`,_[2]=`${_[2]}%`),l.indexOf("color")!==-1?_=`${m} ${_.join(" ")}`:_=`${_.join(", ")}`,`${l}(${_})`}function p0(a,l){return a=Y2(a),l=WL(l),(a.type==="rgb"||a.type==="hsl")&&(a.type+="a"),a.type==="color"?a.values[3]=`/${l}`:a.values[3]=l,KL(a)}function f0(...a){return a.reduce((l,m)=>m==null?l:function(...w){l.apply(this,w),m.apply(this,w)},()=>{})}function nv(a,l=166){let m;function _(...w){const C=()=>{a.apply(this,w)};clearTimeout(m),m=setTimeout(C,l)}return _.clear=()=>{clearTimeout(m)},_}function XL(a,l){return()=>null}function Ty(a,l){var m,_;return ue.isValidElement(a)&&l.indexOf((m=a.type.muiName)!=null?m:(_=a.type)==null||(_=_._payload)==null||(_=_.value)==null?void 0:_.muiName)!==-1}function pa(a){return a&&a.ownerDocument||document}function wh(a){return pa(a).defaultView||window}function YL(a,l){return()=>null}function ky(a,l){typeof a=="function"?a(l):a&&(a.current=l)}let ES=0;function QL(a){const[l,m]=ue.useState(a),_=a||l;return ue.useEffect(()=>{l==null&&(ES+=1,m(`mui-${ES}`))},[l]),_}const AS=Ey.useId;function iv(a){if(AS!==void 0){const l=AS();return a??l}return QL(a)}function JL(a,l,m,_,w){return null}function My({controlled:a,default:l,name:m,state:_="value"}){const{current:w}=ue.useRef(a!==void 0),[C,M]=ue.useState(l),r=w?a:C,O=ue.useCallback(V=>{w||M(V)},[]);return[r,O]}function Tu(a){const l=ue.useRef(a);return bh(()=>{l.current=a}),ue.useRef((...m)=>(0,l.current)(...m)).current}function Eo(...a){return ue.useMemo(()=>a.every(l=>l==null)?null:l=>{a.forEach(m=>{ky(m,l)})},a)}const IS={};function eD(a,l){const m=ue.useRef(IS);return m.current===IS&&(m.current=a(l)),m}const tD=[];function nD(a){ue.useEffect(a,tD)}class rv{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new rv}start(l,m){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,m()},l)}}function W0(){const a=eD(rv.create).current;return nD(a.disposeEffect),a}let sv=!0,m0=!1;const iD=new rv,rD={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function sD(a){const{type:l,tagName:m}=a;return!!(m==="INPUT"&&rD[l]&&!a.readOnly||m==="TEXTAREA"&&!a.readOnly||a.isContentEditable)}function oD(a){a.metaKey||a.altKey||a.ctrlKey||(sv=!0)}function Bx(){sv=!1}function aD(){this.visibilityState==="hidden"&&m0&&(sv=!0)}function lD(a){a.addEventListener("keydown",oD,!0),a.addEventListener("mousedown",Bx,!0),a.addEventListener("pointerdown",Bx,!0),a.addEventListener("touchstart",Bx,!0),a.addEventListener("visibilitychange",aD,!0)}function cD(a){const{target:l}=a;try{return l.matches(":focus-visible")}catch{}return sv||sD(l)}function Z0(){const a=ue.useCallback(w=>{w!=null&&lD(w.ownerDocument)},[]),l=ue.useRef(!1);function m(){return l.current?(m0=!0,iD.start(100,()=>{m0=!1}),l.current=!1,!0):!1}function _(w){return cD(w)?(l.current=!0,!0):!1}return{isFocusVisibleRef:l,onFocus:_,onBlur:m,ref:a}}function Q2(a){const l=a.documentElement.clientWidth;return Math.abs(window.innerWidth-l)}function yr(a,l,m=void 0){const _={};return Object.keys(a).forEach(w=>{_[w]=a[w].reduce((C,M)=>{if(M){const r=l(M);r!==""&&C.push(r),m&&m[M]&&C.push(m[M])}return C},[]).join(" ")}),_}function Ry(a){return typeof a=="string"}function uD(a,l,m){return a===void 0||Ry(a)?l:Fe({},l,{ownerState:Fe({},l.ownerState,m)})}function zy(a,l=[]){if(a===void 0)return{};const m={};return Object.keys(a).filter(_=>_.match(/^on[A-Z]/)&&typeof a[_]=="function"&&!l.includes(_)).forEach(_=>{m[_]=a[_]}),m}function PS(a){if(a===void 0)return{};const l={};return Object.keys(a).filter(m=>!(m.match(/^on[A-Z]/)&&typeof a[m]=="function")).forEach(m=>{l[m]=a[m]}),l}function hD(a){const{getSlotProps:l,additionalProps:m,externalSlotProps:_,externalForwardedProps:w,className:C}=a;if(!l){const de=oi(m==null?void 0:m.className,C,w==null?void 0:w.className,_==null?void 0:_.className),se=Fe({},m==null?void 0:m.style,w==null?void 0:w.style,_==null?void 0:_.style),ne=Fe({},m,w,_);return de.length>0&&(ne.className=de),Object.keys(se).length>0&&(ne.style=se),{props:ne,internalRef:void 0}}const M=zy(Fe({},w,_)),r=PS(_),O=PS(w),V=l(M),U=oi(V==null?void 0:V.className,m==null?void 0:m.className,C,w==null?void 0:w.className,_==null?void 0:_.className),Z=Fe({},V==null?void 0:V.style,m==null?void 0:m.style,w==null?void 0:w.style,_==null?void 0:_.style),ie=Fe({},V,m,O,r);return U.length>0&&(ie.className=U),Object.keys(Z).length>0&&(ie.style=Z),{props:ie,internalRef:V.ref}}function dD(a,l,m){return typeof a=="function"?a(l,m):a}const pD=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function Ef(a){var l;const{elementType:m,externalSlotProps:_,ownerState:w,skipResolvingSlotProps:C=!1}=a,M=Yn(a,pD),r=C?{}:dD(_,w),{props:O,internalRef:V}=hD(Fe({},M,{externalSlotProps:r})),U=Eo(V,r==null?void 0:r.ref,(l=a.additionalProps)==null?void 0:l.ref);return uD(m,Fe({},O,{ref:U}),w)}function Pf(a){if(parseInt(ue.version,10)>=19){var l;return(a==null||(l=a.props)==null?void 0:l.ref)||null}return(a==null?void 0:a.ref)||null}const J2=ue.createContext(null);function eE(){return ue.useContext(J2)}const fD=typeof Symbol=="function"&&Symbol.for,mD=fD?Symbol.for("mui.nested"):"__THEME_NESTED__";function gD(a,l){return typeof l=="function"?l(a):Fe({},a,l)}function _D(a){const{children:l,theme:m}=a,_=eE(),w=ue.useMemo(()=>{const C=_===null?m:gD(_,m);return C!=null&&(C[mD]=_!==null),C},[m,_]);return Ne.jsx(J2.Provider,{value:w,children:l})}const yD=["value"],tE=ue.createContext();function vD(a){let{value:l}=a,m=Yn(a,yD);return Ne.jsx(tE.Provider,Fe({value:l??!0},m))}const nE=()=>{const a=ue.useContext(tE);return a??!1},iE=ue.createContext(void 0);function xD({value:a,children:l}){return Ne.jsx(iE.Provider,{value:a,children:l})}function bD(a){const{theme:l,name:m,props:_}=a;if(!l||!l.components||!l.components[m])return _;const w=l.components[m];return w.defaultProps?l_(w.defaultProps,_):!w.styleOverrides&&!w.variants?l_(w,_):_}function wD({props:a,name:l}){const m=ue.useContext(iE);return bD({props:a,name:l,theme:{components:m}})}function TD(a){const l=$0(),m=iv()||"",{modularCssLayers:_}=a;let w="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!_||l!==null?w="":typeof _=="string"?w=_.replace(/mui(?!\.)/g,w):w=`@layer ${w};`,bh(()=>{const C=document.querySelector("head");if(!C)return;const M=C.firstChild;if(w){var r;if(M&&(r=M.hasAttribute)!=null&&r.call(M,"data-mui-layer-order")&&M.getAttribute("data-mui-layer-order")===m)return;const V=document.createElement("style");V.setAttribute("data-mui-layer-order",m),V.textContent=w,C.prepend(V)}else{var O;(O=C.querySelector(`style[data-mui-layer-order="${m}"]`))==null||O.remove()}},[w,m]),w?Ne.jsx(U2,{styles:w}):null}const kS={};function MS(a,l,m,_=!1){return ue.useMemo(()=>{const w=a&&l[a]||l;if(typeof m=="function"){const C=m(w),M=a?Fe({},l,{[a]:C}):C;return _?()=>M:M}return a?Fe({},l,{[a]:m}):Fe({},l,m)},[a,l,m,_])}function SD(a){const{children:l,theme:m,themeId:_}=a,w=$0(kS),C=eE()||kS,M=MS(_,w,m),r=MS(_,C,m,!0),O=M.direction==="rtl",V=TD(M);return Ne.jsx(_D,{theme:r,children:Ne.jsx(Dm.Provider,{value:M,children:Ne.jsx(vD,{value:O,children:Ne.jsxs(xD,{value:M==null?void 0:M.components,children:[V,l]})})})})}const CD=["className","component","disableGutters","fixed","maxWidth","classes"],ED=Bm(),AD=Z2("div",{name:"MuiContainer",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,l[`maxWidth${vn(String(m.maxWidth))}`],m.fixed&&l.fixed,m.disableGutters&&l.disableGutters]}}),ID=a=>K2({props:a,name:"MuiContainer",defaultTheme:ED}),PD=(a,l)=>{const m=O=>dr(l,O),{classes:_,fixed:w,disableGutters:C,maxWidth:M}=a,r={root:["root",M&&`maxWidth${vn(String(M))}`,w&&"fixed",C&&"disableGutters"]};return yr(r,m,_)};function kD(a={}){const{createStyledComponent:l=AD,useThemeProps:m=ID,componentName:_="MuiContainer"}=a,w=l(({theme:M,ownerState:r})=>Fe({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",display:"block"},!r.disableGutters&&{paddingLeft:M.spacing(2),paddingRight:M.spacing(2),[M.breakpoints.up("sm")]:{paddingLeft:M.spacing(3),paddingRight:M.spacing(3)}}),({theme:M,ownerState:r})=>r.fixed&&Object.keys(M.breakpoints.values).reduce((O,V)=>{const U=V,Z=M.breakpoints.values[U];return Z!==0&&(O[M.breakpoints.up(U)]={maxWidth:`${Z}${M.breakpoints.unit}`}),O},{}),({theme:M,ownerState:r})=>Fe({},r.maxWidth==="xs"&&{[M.breakpoints.up("xs")]:{maxWidth:Math.max(M.breakpoints.values.xs,444)}},r.maxWidth&&r.maxWidth!=="xs"&&{[M.breakpoints.up(r.maxWidth)]:{maxWidth:`${M.breakpoints.values[r.maxWidth]}${M.breakpoints.unit}`}}));return ue.forwardRef(function(r,O){const V=m(r),{className:U,component:Z="div",disableGutters:ie=!1,fixed:de=!1,maxWidth:se="lg"}=V,ne=Yn(V,CD),Se=Fe({},V,{component:Z,disableGutters:ie,fixed:de,maxWidth:se}),me=PD(Se,_);return Ne.jsx(w,Fe({as:Z,ownerState:Se,className:oi(me.root,U),ref:O},ne))})}const MD=["component","direction","spacing","divider","children","className","useFlexGap"],RD=Bm(),zD=Z2("div",{name:"MuiStack",slot:"Root",overridesResolver:(a,l)=>l.root});function LD(a){return K2({props:a,name:"MuiStack",defaultTheme:RD})}function DD(a,l){const m=ue.Children.toArray(a).filter(Boolean);return m.reduce((_,w,C)=>(_.push(w),C<m.length-1&&_.push(ue.cloneElement(l,{key:`separator-${C}`})),_),[])}const OD=a=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[a],BD=({ownerState:a,theme:l})=>{let m=Fe({display:"flex",flexDirection:"column"},ml({theme:l},Tf({values:a.direction,breakpoints:l.breakpoints.values}),_=>({flexDirection:_})));if(a.spacing){const _=H0(l),w=Object.keys(l.breakpoints.values).reduce((O,V)=>((typeof a.spacing=="object"&&a.spacing[V]!=null||typeof a.direction=="object"&&a.direction[V]!=null)&&(O[V]=!0),O),{}),C=Tf({values:a.direction,base:w}),M=Tf({values:a.spacing,base:w});typeof C=="object"&&Object.keys(C).forEach((O,V,U)=>{if(!C[O]){const ie=V>0?C[U[V-1]]:"column";C[O]=ie}}),m=ja(m,ml({theme:l},M,(O,V)=>a.useFlexGap?{gap:Cf(_,O)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${OD(V?C[V]:a.direction)}`]:Cf(_,O)}}))}return m=Rz(l.breakpoints,m),m};function FD(a={}){const{createStyledComponent:l=zD,useThemeProps:m=LD,componentName:_="MuiStack"}=a,w=()=>yr({root:["root"]},O=>dr(_,O),{}),C=l(BD);return ue.forwardRef(function(O,V){const U=m(O),Z=__(U),{component:ie="div",direction:de="column",spacing:se=0,divider:ne,children:Se,className:me,useFlexGap:Re=!1}=Z,ye=Yn(Z,MD),Le={direction:de,spacing:se,useFlexGap:Re},De=w();return Ne.jsx(C,Fe({as:ie,ownerState:Le,ref:V,className:oi(De.root,me)},ye,{children:ne?DD(Se,ne):Se}))})}function jD(a,l){return Fe({toolbar:{minHeight:56,[a.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[a.up("sm")]:{minHeight:64}}},l)}var Us={},Fx={exports:{}},RS;function Th(){return RS||(RS=1,function(a){function l(m){return m&&m.__esModule?m:{default:m}}a.exports=l,a.exports.__esModule=!0,a.exports.default=a.exports}(Fx)),Fx.exports}const ND=bd(ER),VD=bd(GL);var zS;function qD(){if(zS)return Us;zS=1;var a=Th();Object.defineProperty(Us,"__esModule",{value:!0}),Us.alpha=se,Us.blend=Oe,Us.colorChannel=void 0,Us.darken=Se,Us.decomposeColor=M,Us.emphasize=Le,Us.getContrastRatio=de,Us.getLuminance=ie,Us.hexToRgb=w,Us.hslToRgb=Z,Us.lighten=Re,Us.private_safeAlpha=ne,Us.private_safeColorChannel=void 0,Us.private_safeDarken=me,Us.private_safeEmphasize=De,Us.private_safeLighten=ye,Us.recomposeColor=V,Us.rgbToHex=U;var l=a(ND),m=a(VD);function _(Ee,qe=0,$e=1){return(0,m.default)(Ee,qe,$e)}function w(Ee){Ee=Ee.slice(1);const qe=new RegExp(`.{1,${Ee.length>=6?2:1}}`,"g");let $e=Ee.match(qe);return $e&&$e[0].length===1&&($e=$e.map(Ge=>Ge+Ge)),$e?`rgb${$e.length===4?"a":""}(${$e.map((Ge,et)=>et<3?parseInt(Ge,16):Math.round(parseInt(Ge,16)/255*1e3)/1e3).join(", ")})`:""}function C(Ee){const qe=Ee.toString(16);return qe.length===1?`0${qe}`:qe}function M(Ee){if(Ee.type)return Ee;if(Ee.charAt(0)==="#")return M(w(Ee));const qe=Ee.indexOf("("),$e=Ee.substring(0,qe);if(["rgb","rgba","hsl","hsla","color"].indexOf($e)===-1)throw new Error((0,l.default)(9,Ee));let Ge=Ee.substring(qe+1,Ee.length-1),et;if($e==="color"){if(Ge=Ge.split(" "),et=Ge.shift(),Ge.length===4&&Ge[3].charAt(0)==="/"&&(Ge[3]=Ge[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(et)===-1)throw new Error((0,l.default)(10,et))}else Ge=Ge.split(",");return Ge=Ge.map(mt=>parseFloat(mt)),{type:$e,values:Ge,colorSpace:et}}const r=Ee=>{const qe=M(Ee);return qe.values.slice(0,3).map(($e,Ge)=>qe.type.indexOf("hsl")!==-1&&Ge!==0?`${$e}%`:$e).join(" ")};Us.colorChannel=r;const O=(Ee,qe)=>{try{return r(Ee)}catch{return Ee}};Us.private_safeColorChannel=O;function V(Ee){const{type:qe,colorSpace:$e}=Ee;let{values:Ge}=Ee;return qe.indexOf("rgb")!==-1?Ge=Ge.map((et,mt)=>mt<3?parseInt(et,10):et):qe.indexOf("hsl")!==-1&&(Ge[1]=`${Ge[1]}%`,Ge[2]=`${Ge[2]}%`),qe.indexOf("color")!==-1?Ge=`${$e} ${Ge.join(" ")}`:Ge=`${Ge.join(", ")}`,`${qe}(${Ge})`}function U(Ee){if(Ee.indexOf("#")===0)return Ee;const{values:qe}=M(Ee);return`#${qe.map(($e,Ge)=>C(Ge===3?Math.round(255*$e):$e)).join("")}`}function Z(Ee){Ee=M(Ee);const{values:qe}=Ee,$e=qe[0],Ge=qe[1]/100,et=qe[2]/100,mt=Ge*Math.min(et,1-et),St=(Ct,Ut=(Ct+$e/30)%12)=>et-mt*Math.max(Math.min(Ut-3,9-Ut,1),-1);let xt="rgb";const At=[Math.round(St(0)*255),Math.round(St(8)*255),Math.round(St(4)*255)];return Ee.type==="hsla"&&(xt+="a",At.push(qe[3])),V({type:xt,values:At})}function ie(Ee){Ee=M(Ee);let qe=Ee.type==="hsl"||Ee.type==="hsla"?M(Z(Ee)).values:Ee.values;return qe=qe.map($e=>(Ee.type!=="color"&&($e/=255),$e<=.03928?$e/12.92:(($e+.055)/1.055)**2.4)),Number((.2126*qe[0]+.7152*qe[1]+.0722*qe[2]).toFixed(3))}function de(Ee,qe){const $e=ie(Ee),Ge=ie(qe);return(Math.max($e,Ge)+.05)/(Math.min($e,Ge)+.05)}function se(Ee,qe){return Ee=M(Ee),qe=_(qe),(Ee.type==="rgb"||Ee.type==="hsl")&&(Ee.type+="a"),Ee.type==="color"?Ee.values[3]=`/${qe}`:Ee.values[3]=qe,V(Ee)}function ne(Ee,qe,$e){try{return se(Ee,qe)}catch{return Ee}}function Se(Ee,qe){if(Ee=M(Ee),qe=_(qe),Ee.type.indexOf("hsl")!==-1)Ee.values[2]*=1-qe;else if(Ee.type.indexOf("rgb")!==-1||Ee.type.indexOf("color")!==-1)for(let $e=0;$e<3;$e+=1)Ee.values[$e]*=1-qe;return V(Ee)}function me(Ee,qe,$e){try{return Se(Ee,qe)}catch{return Ee}}function Re(Ee,qe){if(Ee=M(Ee),qe=_(qe),Ee.type.indexOf("hsl")!==-1)Ee.values[2]+=(100-Ee.values[2])*qe;else if(Ee.type.indexOf("rgb")!==-1)for(let $e=0;$e<3;$e+=1)Ee.values[$e]+=(255-Ee.values[$e])*qe;else if(Ee.type.indexOf("color")!==-1)for(let $e=0;$e<3;$e+=1)Ee.values[$e]+=(1-Ee.values[$e])*qe;return V(Ee)}function ye(Ee,qe,$e){try{return Re(Ee,qe)}catch{return Ee}}function Le(Ee,qe=.15){return ie(Ee)>.5?Se(Ee,qe):Re(Ee,qe)}function De(Ee,qe,$e){try{return Le(Ee,qe)}catch{return Ee}}function Oe(Ee,qe,$e,Ge=1){const et=(At,Ct)=>Math.round((At**(1/Ge)*(1-$e)+Ct**(1/Ge)*$e)**Ge),mt=M(Ee),St=M(qe),xt=[et(mt.values[0],St.values[0]),et(mt.values[1],St.values[1]),et(mt.values[2],St.values[2])];return V({type:"rgb",values:xt})}return Us}var os=qD();const HD=["mode","contrastThreshold","tonalOffset"],LS={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:r_.white,default:r_.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},jx={text:{primary:r_.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:r_.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function DS(a,l,m,_){const w=_.light||_,C=_.dark||_*1.5;a[l]||(a.hasOwnProperty(m)?a[l]=a[m]:l==="light"?a.light=os.lighten(a.main,w):l==="dark"&&(a.dark=os.darken(a.main,C)))}function UD(a="light"){return a==="dark"?{main:pm[200],light:pm[50],dark:pm[400]}:{main:pm[700],light:pm[400],dark:pm[800]}}function $D(a="light"){return a==="dark"?{main:dm[200],light:dm[50],dark:dm[400]}:{main:dm[500],light:dm[300],dark:dm[700]}}function GD(a="light"){return a==="dark"?{main:hm[500],light:hm[300],dark:hm[700]}:{main:hm[700],light:hm[400],dark:hm[800]}}function WD(a="light"){return a==="dark"?{main:fm[400],light:fm[300],dark:fm[700]}:{main:fm[700],light:fm[500],dark:fm[900]}}function ZD(a="light"){return a==="dark"?{main:mm[400],light:mm[300],dark:mm[700]}:{main:mm[800],light:mm[500],dark:mm[900]}}function KD(a="light"){return a==="dark"?{main:Mg[400],light:Mg[300],dark:Mg[700]}:{main:"#ed6c02",light:Mg[500],dark:Mg[900]}}function XD(a){const{mode:l="light",contrastThreshold:m=3,tonalOffset:_=.2}=a,w=Yn(a,HD),C=a.primary||UD(l),M=a.secondary||$D(l),r=a.error||GD(l),O=a.info||WD(l),V=a.success||ZD(l),U=a.warning||KD(l);function Z(ne){return os.getContrastRatio(ne,jx.text.primary)>=m?jx.text.primary:LS.text.primary}const ie=({color:ne,name:Se,mainShade:me=500,lightShade:Re=300,darkShade:ye=700})=>{if(ne=Fe({},ne),!ne.main&&ne[me]&&(ne.main=ne[me]),!ne.hasOwnProperty("main"))throw new Error(xd(11,Se?` (${Se})`:"",me));if(typeof ne.main!="string")throw new Error(xd(12,Se?` (${Se})`:"",JSON.stringify(ne.main)));return DS(ne,"light",Re,_),DS(ne,"dark",ye,_),ne.contrastText||(ne.contrastText=Z(ne.main)),ne},de={dark:jx,light:LS};return ja(Fe({common:Fe({},r_),mode:l,primary:ie({color:C,name:"primary"}),secondary:ie({color:M,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:ie({color:r,name:"error"}),warning:ie({color:U,name:"warning"}),info:ie({color:O,name:"info"}),success:ie({color:V,name:"success"}),grey:CR,contrastThreshold:m,getContrastText:Z,augmentColor:ie,tonalOffset:_},de[l]),w)}const YD=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function QD(a){return Math.round(a*1e5)/1e5}const OS={textTransform:"uppercase"},BS='"Roboto", "Helvetica", "Arial", sans-serif';function JD(a,l){const m=typeof l=="function"?l(a):l,{fontFamily:_=BS,fontSize:w=14,fontWeightLight:C=300,fontWeightRegular:M=400,fontWeightMedium:r=500,fontWeightBold:O=700,htmlFontSize:V=16,allVariants:U,pxToRem:Z}=m,ie=Yn(m,YD),de=w/14,se=Z||(me=>`${me/V*de}rem`),ne=(me,Re,ye,Le,De)=>Fe({fontFamily:_,fontWeight:me,fontSize:se(Re),lineHeight:ye},_===BS?{letterSpacing:`${QD(Le/Re)}em`}:{},De,U),Se={h1:ne(C,96,1.167,-1.5),h2:ne(C,60,1.2,-.5),h3:ne(M,48,1.167,0),h4:ne(M,34,1.235,.25),h5:ne(M,24,1.334,0),h6:ne(r,20,1.6,.15),subtitle1:ne(M,16,1.75,.15),subtitle2:ne(r,14,1.57,.1),body1:ne(M,16,1.5,.15),body2:ne(M,14,1.43,.15),button:ne(r,14,1.75,.4,OS),caption:ne(M,12,1.66,.4),overline:ne(M,12,2.66,1,OS),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ja(Fe({htmlFontSize:V,pxToRem:se,fontFamily:_,fontSize:w,fontWeightLight:C,fontWeightRegular:M,fontWeightMedium:r,fontWeightBold:O},Se),ie,{clone:!1})}const eO=.2,tO=.14,nO=.12;function zs(...a){return[`${a[0]}px ${a[1]}px ${a[2]}px ${a[3]}px rgba(0,0,0,${eO})`,`${a[4]}px ${a[5]}px ${a[6]}px ${a[7]}px rgba(0,0,0,${tO})`,`${a[8]}px ${a[9]}px ${a[10]}px ${a[11]}px rgba(0,0,0,${nO})`].join(",")}const iO=["none",zs(0,2,1,-1,0,1,1,0,0,1,3,0),zs(0,3,1,-2,0,2,2,0,0,1,5,0),zs(0,3,3,-2,0,3,4,0,0,1,8,0),zs(0,2,4,-1,0,4,5,0,0,1,10,0),zs(0,3,5,-1,0,5,8,0,0,1,14,0),zs(0,3,5,-1,0,6,10,0,0,1,18,0),zs(0,4,5,-2,0,7,10,1,0,2,16,1),zs(0,5,5,-3,0,8,10,1,0,3,14,2),zs(0,5,6,-3,0,9,12,1,0,3,16,2),zs(0,6,6,-3,0,10,14,1,0,4,18,3),zs(0,6,7,-4,0,11,15,1,0,4,20,3),zs(0,7,8,-4,0,12,17,2,0,5,22,4),zs(0,7,8,-4,0,13,19,2,0,5,24,4),zs(0,7,9,-4,0,14,21,2,0,5,26,4),zs(0,8,9,-5,0,15,22,2,0,6,28,5),zs(0,8,10,-5,0,16,24,2,0,6,30,5),zs(0,8,11,-5,0,17,26,2,0,6,32,5),zs(0,9,11,-5,0,18,28,2,0,7,34,6),zs(0,9,12,-6,0,19,29,2,0,7,36,6),zs(0,10,13,-6,0,20,31,3,0,8,38,7),zs(0,10,13,-6,0,21,33,3,0,8,40,7),zs(0,10,14,-6,0,22,35,3,0,8,42,7),zs(0,11,14,-7,0,23,36,3,0,9,44,8),zs(0,11,15,-7,0,24,38,3,0,9,46,8)],rO=["duration","easing","delay"],sO={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},oO={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function FS(a){return`${Math.round(a)}ms`}function aO(a){if(!a)return 0;const l=a/36;return Math.round((4+15*l**.25+l/5)*10)}function lO(a){const l=Fe({},sO,a.easing),m=Fe({},oO,a.duration);return Fe({getAutoHeightDuration:aO,create:(w=["all"],C={})=>{const{duration:M=m.standard,easing:r=l.easeInOut,delay:O=0}=C;return Yn(C,rO),(Array.isArray(w)?w:[w]).map(V=>`${V} ${typeof M=="string"?M:FS(M)} ${r} ${typeof O=="string"?O:FS(O)}`).join(",")}},a,{easing:l,duration:m})}const cO={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},uO=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function K0(a={},...l){const{mixins:m={},palette:_={},transitions:w={},typography:C={}}=a,M=Yn(a,uO);if(a.vars&&a.generateCssVars===void 0)throw new Error(xd(18));const r=XD(_),O=Bm(a);let V=ja(O,{mixins:jD(O.breakpoints,m),palette:r,shadows:iO.slice(),typography:JD(r,C),transitions:lO(w),zIndex:Fe({},cO)});return V=ja(V,M),V=l.reduce((U,Z)=>ja(U,Z),V),V.unstable_sxConfig=Fe({},g_,M==null?void 0:M.unstable_sxConfig),V.unstable_sx=function(Z){return Om({sx:Z,theme:this})},V}const X0=K0();function gl(){const a=tv(X0);return a[Em]||a}var _f={},Nx={exports:{}},jS;function hO(){return jS||(jS=1,function(a){function l(){return a.exports=l=Object.assign?Object.assign.bind():function(m){for(var _=1;_<arguments.length;_++){var w=arguments[_];for(var C in w)({}).hasOwnProperty.call(w,C)&&(m[C]=w[C])}return m},a.exports.__esModule=!0,a.exports.default=a.exports,l.apply(null,arguments)}a.exports=l,a.exports.__esModule=!0,a.exports.default=a.exports}(Nx)),Nx.exports}var Vx={exports:{}},NS;function dO(){return NS||(NS=1,function(a){function l(m,_){if(m==null)return{};var w={};for(var C in m)if({}.hasOwnProperty.call(m,C)){if(_.indexOf(C)!==-1)continue;w[C]=m[C]}return w}a.exports=l,a.exports.__esModule=!0,a.exports.default=a.exports}(Vx)),Vx.exports}const pO=bd(Az),fO=bd(Iz),mO=bd(Lz),gO=bd(DL),_O=bd(bL),yO=bd(EL);var VS;function vO(){if(VS)return _f;VS=1;var a=Th();Object.defineProperty(_f,"__esModule",{value:!0}),_f.default=De,_f.shouldForwardProp=se,_f.systemDefaultTheme=void 0;var l=a(hO()),m=a(dO()),_=Z(pO),w=fO;a(mO),a(gO);var C=a(_O),M=a(yO);const r=["ownerState"],O=["variants"],V=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function U(Oe){if(typeof WeakMap!="function")return null;var Ee=new WeakMap,qe=new WeakMap;return(U=function($e){return $e?qe:Ee})(Oe)}function Z(Oe,Ee){if(Oe&&Oe.__esModule)return Oe;if(Oe===null||typeof Oe!="object"&&typeof Oe!="function")return{default:Oe};var qe=U(Ee);if(qe&&qe.has(Oe))return qe.get(Oe);var $e={__proto__:null},Ge=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var et in Oe)if(et!=="default"&&Object.prototype.hasOwnProperty.call(Oe,et)){var mt=Ge?Object.getOwnPropertyDescriptor(Oe,et):null;mt&&(mt.get||mt.set)?Object.defineProperty($e,et,mt):$e[et]=Oe[et]}return $e.default=Oe,qe&&qe.set(Oe,$e),$e}function ie(Oe){return Object.keys(Oe).length===0}function de(Oe){return typeof Oe=="string"&&Oe.charCodeAt(0)>96}function se(Oe){return Oe!=="ownerState"&&Oe!=="theme"&&Oe!=="sx"&&Oe!=="as"}function ne(Oe,Ee){return Ee&&Oe&&typeof Oe=="object"&&Oe.styles&&!Oe.styles.startsWith("@layer")&&(Oe.styles=`@layer ${Ee}{${String(Oe.styles)}}`),Oe}const Se=_f.systemDefaultTheme=(0,C.default)(),me=Oe=>Oe&&Oe.charAt(0).toLowerCase()+Oe.slice(1);function Re({defaultTheme:Oe,theme:Ee,themeId:qe}){return ie(Ee)?Oe:Ee[qe]||Ee}function ye(Oe){return Oe?(Ee,qe)=>qe[Oe]:null}function Le(Oe,Ee,qe){let{ownerState:$e}=Ee,Ge=(0,m.default)(Ee,r);const et=typeof Oe=="function"?Oe((0,l.default)({ownerState:$e},Ge)):Oe;if(Array.isArray(et))return et.flatMap(mt=>Le(mt,(0,l.default)({ownerState:$e},Ge),qe));if(et&&typeof et=="object"&&Array.isArray(et.variants)){const{variants:mt=[]}=et;let xt=(0,m.default)(et,O);return mt.forEach(At=>{let Ct=!0;if(typeof At.props=="function"?Ct=At.props((0,l.default)({ownerState:$e},Ge,$e)):Object.keys(At.props).forEach(Ut=>{($e==null?void 0:$e[Ut])!==At.props[Ut]&&Ge[Ut]!==At.props[Ut]&&(Ct=!1)}),Ct){Array.isArray(xt)||(xt=[xt]);const Ut=typeof At.style=="function"?At.style((0,l.default)({ownerState:$e},Ge,$e)):At.style;xt.push(qe?ne((0,_.internal_serializeStyles)(Ut),qe):Ut)}}),xt}return qe?ne((0,_.internal_serializeStyles)(et),qe):et}function De(Oe={}){const{themeId:Ee,defaultTheme:qe=Se,rootShouldForwardProp:$e=se,slotShouldForwardProp:Ge=se}=Oe,et=mt=>(0,M.default)((0,l.default)({},mt,{theme:Re((0,l.default)({},mt,{defaultTheme:qe,themeId:Ee}))}));return et.__mui_systemSx=!0,(mt,St={})=>{(0,_.internal_processStyles)(mt,Hn=>Hn.filter(bn=>!(bn!=null&&bn.__mui_systemSx)));const{name:xt,slot:At,skipVariantsResolver:Ct,skipSx:Ut,overridesResolver:at=ye(me(At))}=St,kt=(0,m.default)(St,V),qt=xt&&xt.startsWith("Mui")||At?"components":"custom",lt=Ct!==void 0?Ct:At&&At!=="Root"&&At!=="root"||!1,Ht=Ut||!1;let Nn,zn=se;At==="Root"||At==="root"?zn=$e:At?zn=Ge:de(mt)&&(zn=void 0);const xn=(0,_.default)(mt,(0,l.default)({shouldForwardProp:zn,label:Nn},kt)),An=Hn=>typeof Hn=="function"&&Hn.__emotion_real!==Hn||(0,w.isPlainObject)(Hn)?bn=>{const Zi=Re({theme:bn.theme,defaultTheme:qe,themeId:Ee});return Le(Hn,(0,l.default)({},bn,{theme:Zi}),Zi.modularCssLayers?qt:void 0)}:Hn,ti=(Hn,...bn)=>{let Zi=An(Hn);const Ci=bn?bn.map(An):[];xt&&at&&Ci.push(ki=>{const zi=Re((0,l.default)({},ki,{defaultTheme:qe,themeId:Ee}));if(!zi.components||!zi.components[xt]||!zi.components[xt].styleOverrides)return null;const Pr=zi.components[xt].styleOverrides,Gr={};return Object.entries(Pr).forEach(([ys,zr])=>{Gr[ys]=Le(zr,(0,l.default)({},ki,{theme:zi}),zi.modularCssLayers?"theme":void 0)}),at(ki,Gr)}),xt&&!lt&&Ci.push(ki=>{var zi;const Pr=Re((0,l.default)({},ki,{defaultTheme:qe,themeId:Ee})),Gr=Pr==null||(zi=Pr.components)==null||(zi=zi[xt])==null?void 0:zi.variants;return Le({variants:Gr},(0,l.default)({},ki,{theme:Pr}),Pr.modularCssLayers?"theme":void 0)}),Ht||Ci.push(et);const Yi=Ci.length-bn.length;if(Array.isArray(Hn)&&Yi>0){const ki=new Array(Yi).fill("");Zi=[...Hn,...ki],Zi.raw=[...Hn.raw,...ki]}const Vn=xn(Zi,...Ci);return mt.muiName&&(Vn.muiName=mt.muiName),Vn};return xn.withConfig&&(ti.withConfig=xn.withConfig),ti}}return _f}var xO=vO();const bO=$l(xO);function rE(a){return a!=="ownerState"&&a!=="theme"&&a!=="sx"&&a!=="as"}const Na=a=>rE(a)&&a!=="classes",qn=bO({themeId:Em,defaultTheme:X0,rootShouldForwardProp:Na}),wO=["theme"];function TO(a){let{theme:l}=a,m=Yn(a,wO);const _=l[Em];let w=_||l;return typeof l!="function"&&(_&&!_.vars?w=Fe({},_,{vars:null}):l&&!l.vars&&(w=Fe({},l,{vars:null}))),Ne.jsx(SD,Fe({},m,{themeId:_?Em:void 0,theme:w}))}const qS=a=>{let l;return a<1?l=5.11916*a**2:l=4.5*Math.log(a+1)+2,(l/100).toFixed(2)};function vr(a){return wD(a)}function SO(a){return dr("MuiSvgIcon",a)}rr("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const CO=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],EO=a=>{const{color:l,fontSize:m,classes:_}=a,w={root:["root",l!=="inherit"&&`color${vn(l)}`,`fontSize${vn(m)}`]};return yr(w,SO,_)},AO=qn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,m.color!=="inherit"&&l[`color${vn(m.color)}`],l[`fontSize${vn(m.fontSize)}`]]}})(({theme:a,ownerState:l})=>{var m,_,w,C,M,r,O,V,U,Z,ie,de,se;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:l.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(m=a.transitions)==null||(_=m.create)==null?void 0:_.call(m,"fill",{duration:(w=a.transitions)==null||(w=w.duration)==null?void 0:w.shorter}),fontSize:{inherit:"inherit",small:((C=a.typography)==null||(M=C.pxToRem)==null?void 0:M.call(C,20))||"1.25rem",medium:((r=a.typography)==null||(O=r.pxToRem)==null?void 0:O.call(r,24))||"1.5rem",large:((V=a.typography)==null||(U=V.pxToRem)==null?void 0:U.call(V,35))||"2.1875rem"}[l.fontSize],color:(Z=(ie=(a.vars||a).palette)==null||(ie=ie[l.color])==null?void 0:ie.main)!=null?Z:{action:(de=(a.vars||a).palette)==null||(de=de.action)==null?void 0:de.active,disabled:(se=(a.vars||a).palette)==null||(se=se.action)==null?void 0:se.disabled,inherit:void 0}[l.color]}}),g0=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiSvgIcon"}),{children:w,className:C,color:M="inherit",component:r="svg",fontSize:O="medium",htmlColor:V,inheritViewBox:U=!1,titleAccess:Z,viewBox:ie="0 0 24 24"}=_,de=Yn(_,CO),se=ue.isValidElement(w)&&w.type==="svg",ne=Fe({},_,{color:M,component:r,fontSize:O,instanceFontSize:l.fontSize,inheritViewBox:U,viewBox:ie,hasSvgAsChild:se}),Se={};U||(Se.viewBox=ie);const me=EO(ne);return Ne.jsxs(AO,Fe({as:r,className:oi(me.root,C),focusable:"false",color:V,"aria-hidden":Z?void 0:!0,role:Z?"img":void 0,ref:m},Se,de,se&&w.props,{ownerState:ne,children:[se?w.props.children:w,Z?Ne.jsx("title",{children:Z}):null]}))});g0.muiName="SvgIcon";function Fm(a,l){function m(_,w){return Ne.jsx(g0,Fe({"data-testid":`${l}Icon`,ref:w},_,{children:a}))}return m.muiName=g0.muiName,ue.memo(ue.forwardRef(m))}const IO={configure:a=>{G0.configure(a)}},PO=Object.freeze(Object.defineProperty({__proto__:null,capitalize:vn,createChainedFunction:f0,createSvgIcon:Fm,debounce:nv,deprecatedPropType:XL,isMuiElement:Ty,ownerDocument:pa,ownerWindow:wh,requirePropFactory:YL,setRef:ky,unstable_ClassNameGenerator:IO,unstable_useEnhancedEffect:bh,unstable_useId:iv,unsupportedProp:JL,useControlled:My,useEventCallback:Tu,useForkRef:Eo,useIsFocusVisible:Z0},Symbol.toStringTag,{value:"Module"}));function _0(a,l){return _0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(m,_){return m.__proto__=_,m},_0(a,l)}function sE(a,l){a.prototype=Object.create(l.prototype),a.prototype.constructor=a,_0(a,l)}const HS={disabled:!1},Ly=Qr.createContext(null);var kO=function(l){return l.scrollTop},Kg="unmounted",vf="exited",xf="entering",xm="entered",y0="exiting",Su=function(a){sE(l,a);function l(_,w){var C;C=a.call(this,_,w)||this;var M=w,r=M&&!M.isMounting?_.enter:_.appear,O;return C.appearStatus=null,_.in?r?(O=vf,C.appearStatus=xf):O=xm:_.unmountOnExit||_.mountOnEnter?O=Kg:O=vf,C.state={status:O},C.nextCallback=null,C}l.getDerivedStateFromProps=function(w,C){var M=w.in;return M&&C.status===Kg?{status:vf}:null};var m=l.prototype;return m.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},m.componentDidUpdate=function(w){var C=null;if(w!==this.props){var M=this.state.status;this.props.in?M!==xf&&M!==xm&&(C=xf):(M===xf||M===xm)&&(C=y0)}this.updateStatus(!1,C)},m.componentWillUnmount=function(){this.cancelNextCallback()},m.getTimeouts=function(){var w=this.props.timeout,C,M,r;return C=M=r=w,w!=null&&typeof w!="number"&&(C=w.exit,M=w.enter,r=w.appear!==void 0?w.appear:M),{exit:C,enter:M,appear:r}},m.updateStatus=function(w,C){if(w===void 0&&(w=!1),C!==null)if(this.cancelNextCallback(),C===xf){if(this.props.unmountOnExit||this.props.mountOnEnter){var M=this.props.nodeRef?this.props.nodeRef.current:cy.findDOMNode(this);M&&kO(M)}this.performEnter(w)}else this.performExit();else this.props.unmountOnExit&&this.state.status===vf&&this.setState({status:Kg})},m.performEnter=function(w){var C=this,M=this.props.enter,r=this.context?this.context.isMounting:w,O=this.props.nodeRef?[r]:[cy.findDOMNode(this),r],V=O[0],U=O[1],Z=this.getTimeouts(),ie=r?Z.appear:Z.enter;if(!w&&!M||HS.disabled){this.safeSetState({status:xm},function(){C.props.onEntered(V)});return}this.props.onEnter(V,U),this.safeSetState({status:xf},function(){C.props.onEntering(V,U),C.onTransitionEnd(ie,function(){C.safeSetState({status:xm},function(){C.props.onEntered(V,U)})})})},m.performExit=function(){var w=this,C=this.props.exit,M=this.getTimeouts(),r=this.props.nodeRef?void 0:cy.findDOMNode(this);if(!C||HS.disabled){this.safeSetState({status:vf},function(){w.props.onExited(r)});return}this.props.onExit(r),this.safeSetState({status:y0},function(){w.props.onExiting(r),w.onTransitionEnd(M.exit,function(){w.safeSetState({status:vf},function(){w.props.onExited(r)})})})},m.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},m.safeSetState=function(w,C){C=this.setNextCallback(C),this.setState(w,C)},m.setNextCallback=function(w){var C=this,M=!0;return this.nextCallback=function(r){M&&(M=!1,C.nextCallback=null,w(r))},this.nextCallback.cancel=function(){M=!1},this.nextCallback},m.onTransitionEnd=function(w,C){this.setNextCallback(C);var M=this.props.nodeRef?this.props.nodeRef.current:cy.findDOMNode(this),r=w==null&&!this.props.addEndListener;if(!M||r){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var O=this.props.nodeRef?[this.nextCallback]:[M,this.nextCallback],V=O[0],U=O[1];this.props.addEndListener(V,U)}w!=null&&setTimeout(this.nextCallback,w)},m.render=function(){var w=this.state.status;if(w===Kg)return null;var C=this.props,M=C.children;C.in,C.mountOnEnter,C.unmountOnExit,C.appear,C.enter,C.exit,C.timeout,C.addEndListener,C.onEnter,C.onEntering,C.onEntered,C.onExit,C.onExiting,C.onExited,C.nodeRef;var r=Yn(C,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Qr.createElement(Ly.Provider,{value:null},typeof M=="function"?M(w,r):Qr.cloneElement(Qr.Children.only(M),r))},l}(Qr.Component);Su.contextType=Ly;Su.propTypes={};function gm(){}Su.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:gm,onEntering:gm,onEntered:gm,onExit:gm,onExiting:gm,onExited:gm};Su.UNMOUNTED=Kg;Su.EXITED=vf;Su.ENTERING=xf;Su.ENTERED=xm;Su.EXITING=y0;function MO(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Y0(a,l){var m=function(C){return l&&ue.isValidElement(C)?l(C):C},_=Object.create(null);return a&&ue.Children.map(a,function(w){return w}).forEach(function(w){_[w.key]=m(w)}),_}function RO(a,l){a=a||{},l=l||{};function m(U){return U in l?l[U]:a[U]}var _=Object.create(null),w=[];for(var C in a)C in l?w.length&&(_[C]=w,w=[]):w.push(C);var M,r={};for(var O in l){if(_[O])for(M=0;M<_[O].length;M++){var V=_[O][M];r[_[O][M]]=m(V)}r[O]=m(O)}for(M=0;M<w.length;M++)r[w[M]]=m(w[M]);return r}function bf(a,l,m){return m[l]!=null?m[l]:a.props[l]}function zO(a,l){return Y0(a.children,function(m){return ue.cloneElement(m,{onExited:l.bind(null,m),in:!0,appear:bf(m,"appear",a),enter:bf(m,"enter",a),exit:bf(m,"exit",a)})})}function LO(a,l,m){var _=Y0(a.children),w=RO(l,_);return Object.keys(w).forEach(function(C){var M=w[C];if(ue.isValidElement(M)){var r=C in l,O=C in _,V=l[C],U=ue.isValidElement(V)&&!V.props.in;O&&(!r||U)?w[C]=ue.cloneElement(M,{onExited:m.bind(null,M),in:!0,exit:bf(M,"exit",a),enter:bf(M,"enter",a)}):!O&&r&&!U?w[C]=ue.cloneElement(M,{in:!1}):O&&r&&ue.isValidElement(V)&&(w[C]=ue.cloneElement(M,{onExited:m.bind(null,M),in:V.props.in,exit:bf(M,"exit",a),enter:bf(M,"enter",a)}))}}),w}var DO=Object.values||function(a){return Object.keys(a).map(function(l){return a[l]})},OO={component:"div",childFactory:function(l){return l}},Q0=function(a){sE(l,a);function l(_,w){var C;C=a.call(this,_,w)||this;var M=C.handleExited.bind(MO(C));return C.state={contextValue:{isMounting:!0},handleExited:M,firstRender:!0},C}var m=l.prototype;return m.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},m.componentWillUnmount=function(){this.mounted=!1},l.getDerivedStateFromProps=function(w,C){var M=C.children,r=C.handleExited,O=C.firstRender;return{children:O?zO(w,r):LO(w,M,r),firstRender:!1}},m.handleExited=function(w,C){var M=Y0(this.props.children);w.key in M||(w.props.onExited&&w.props.onExited(C),this.mounted&&this.setState(function(r){var O=Fe({},r.children);return delete O[w.key],{children:O}}))},m.render=function(){var w=this.props,C=w.component,M=w.childFactory,r=Yn(w,["component","childFactory"]),O=this.state.contextValue,V=DO(this.state.children).map(M);return delete r.appear,delete r.enter,delete r.exit,C===null?Qr.createElement(Ly.Provider,{value:O},V):Qr.createElement(Ly.Provider,{value:O},Qr.createElement(C,r,V))},l}(Qr.Component);Q0.propTypes={};Q0.defaultProps=OO;const J0=a=>a.scrollTop;function Pm(a,l){var m,_;const{timeout:w,easing:C,style:M={}}=a;return{duration:(m=M.transitionDuration)!=null?m:typeof w=="number"?w:w[l.mode]||0,easing:(_=M.transitionTimingFunction)!=null?_:typeof C=="object"?C[l.mode]:C,delay:M.transitionDelay}}function BO(a){return dr("MuiPaper",a)}rr("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const FO=["className","component","elevation","square","variant"],jO=a=>{const{square:l,elevation:m,variant:_,classes:w}=a,C={root:["root",_,!l&&"rounded",_==="elevation"&&`elevation${m}`]};return yr(C,BO,w)},NO=qn("div",{name:"MuiPaper",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,l[m.variant],!m.square&&l.rounded,m.variant==="elevation"&&l[`elevation${m.elevation}`]]}})(({theme:a,ownerState:l})=>{var m;return Fe({backgroundColor:(a.vars||a).palette.background.paper,color:(a.vars||a).palette.text.primary,transition:a.transitions.create("box-shadow")},!l.square&&{borderRadius:a.shape.borderRadius},l.variant==="outlined"&&{border:`1px solid ${(a.vars||a).palette.divider}`},l.variant==="elevation"&&Fe({boxShadow:(a.vars||a).shadows[l.elevation]},!a.vars&&a.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${os.alpha("#fff",qS(l.elevation))}, ${os.alpha("#fff",qS(l.elevation))})`},a.vars&&{backgroundImage:(m=a.vars.overlays)==null?void 0:m[l.elevation]}))}),jm=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiPaper"}),{className:w,component:C="div",elevation:M=1,square:r=!1,variant:O="elevation"}=_,V=Yn(_,FO),U=Fe({},_,{component:C,elevation:M,square:r,variant:O}),Z=jO(U);return Ne.jsx(NO,Fe({as:C,ownerState:U,className:oi(Z.root,w),ref:m},V))});function VO(a){const{className:l,classes:m,pulsate:_=!1,rippleX:w,rippleY:C,rippleSize:M,in:r,onExited:O,timeout:V}=a,[U,Z]=ue.useState(!1),ie=oi(l,m.ripple,m.rippleVisible,_&&m.ripplePulsate),de={width:M,height:M,top:-(M/2)+C,left:-(M/2)+w},se=oi(m.child,U&&m.childLeaving,_&&m.childPulsate);return!r&&!U&&Z(!0),ue.useEffect(()=>{if(!r&&O!=null){const ne=setTimeout(O,V);return()=>{clearTimeout(ne)}}},[O,r,V]),Ne.jsx("span",{className:ie,style:de,children:Ne.jsx("span",{className:se})})}const Pc=rr("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),qO=["center","classes","className"];let ov=a=>a,US,$S,GS,WS;const v0=550,HO=80,UO=Ky(US||(US=ov`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),$O=Ky($S||($S=ov`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),GO=Ky(GS||(GS=ov`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),WO=qn("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),ZO=qn(VO,{name:"MuiTouchRipple",slot:"Ripple"})(WS||(WS=ov`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Pc.rippleVisible,UO,v0,({theme:a})=>a.transitions.easing.easeInOut,Pc.ripplePulsate,({theme:a})=>a.transitions.duration.shorter,Pc.child,Pc.childLeaving,$O,v0,({theme:a})=>a.transitions.easing.easeInOut,Pc.childPulsate,GO,({theme:a})=>a.transitions.easing.easeInOut),KO=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiTouchRipple"}),{center:w=!1,classes:C={},className:M}=_,r=Yn(_,qO),[O,V]=ue.useState([]),U=ue.useRef(0),Z=ue.useRef(null);ue.useEffect(()=>{Z.current&&(Z.current(),Z.current=null)},[O]);const ie=ue.useRef(!1),de=W0(),se=ue.useRef(null),ne=ue.useRef(null),Se=ue.useCallback(Le=>{const{pulsate:De,rippleX:Oe,rippleY:Ee,rippleSize:qe,cb:$e}=Le;V(Ge=>[...Ge,Ne.jsx(ZO,{classes:{ripple:oi(C.ripple,Pc.ripple),rippleVisible:oi(C.rippleVisible,Pc.rippleVisible),ripplePulsate:oi(C.ripplePulsate,Pc.ripplePulsate),child:oi(C.child,Pc.child),childLeaving:oi(C.childLeaving,Pc.childLeaving),childPulsate:oi(C.childPulsate,Pc.childPulsate)},timeout:v0,pulsate:De,rippleX:Oe,rippleY:Ee,rippleSize:qe},U.current)]),U.current+=1,Z.current=$e},[C]),me=ue.useCallback((Le={},De={},Oe=()=>{})=>{const{pulsate:Ee=!1,center:qe=w||De.pulsate,fakeElement:$e=!1}=De;if((Le==null?void 0:Le.type)==="mousedown"&&ie.current){ie.current=!1;return}(Le==null?void 0:Le.type)==="touchstart"&&(ie.current=!0);const Ge=$e?null:ne.current,et=Ge?Ge.getBoundingClientRect():{width:0,height:0,left:0,top:0};let mt,St,xt;if(qe||Le===void 0||Le.clientX===0&&Le.clientY===0||!Le.clientX&&!Le.touches)mt=Math.round(et.width/2),St=Math.round(et.height/2);else{const{clientX:At,clientY:Ct}=Le.touches&&Le.touches.length>0?Le.touches[0]:Le;mt=Math.round(At-et.left),St=Math.round(Ct-et.top)}if(qe)xt=Math.sqrt((2*et.width**2+et.height**2)/3),xt%2===0&&(xt+=1);else{const At=Math.max(Math.abs((Ge?Ge.clientWidth:0)-mt),mt)*2+2,Ct=Math.max(Math.abs((Ge?Ge.clientHeight:0)-St),St)*2+2;xt=Math.sqrt(At**2+Ct**2)}Le!=null&&Le.touches?se.current===null&&(se.current=()=>{Se({pulsate:Ee,rippleX:mt,rippleY:St,rippleSize:xt,cb:Oe})},de.start(HO,()=>{se.current&&(se.current(),se.current=null)})):Se({pulsate:Ee,rippleX:mt,rippleY:St,rippleSize:xt,cb:Oe})},[w,Se,de]),Re=ue.useCallback(()=>{me({},{pulsate:!0})},[me]),ye=ue.useCallback((Le,De)=>{if(de.clear(),(Le==null?void 0:Le.type)==="touchend"&&se.current){se.current(),se.current=null,de.start(0,()=>{ye(Le,De)});return}se.current=null,V(Oe=>Oe.length>0?Oe.slice(1):Oe),Z.current=De},[de]);return ue.useImperativeHandle(m,()=>({pulsate:Re,start:me,stop:ye}),[Re,me,ye]),Ne.jsx(WO,Fe({className:oi(Pc.root,C.root,M),ref:ne},r,{children:Ne.jsx(Q0,{component:null,exit:!0,children:O})}))});function XO(a){return dr("MuiButtonBase",a)}const YO=rr("MuiButtonBase",["root","disabled","focusVisible"]),QO=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],JO=a=>{const{disabled:l,focusVisible:m,focusVisibleClassName:_,classes:w}=a,M=yr({root:["root",l&&"disabled",m&&"focusVisible"]},XO,w);return m&&_&&(M.root+=` ${_}`),M},e3=qn("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(a,l)=>l.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${YO.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),km=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiButtonBase"}),{action:w,centerRipple:C=!1,children:M,className:r,component:O="button",disabled:V=!1,disableRipple:U=!1,disableTouchRipple:Z=!1,focusRipple:ie=!1,LinkComponent:de="a",onBlur:se,onClick:ne,onContextMenu:Se,onDragLeave:me,onFocus:Re,onFocusVisible:ye,onKeyDown:Le,onKeyUp:De,onMouseDown:Oe,onMouseLeave:Ee,onMouseUp:qe,onTouchEnd:$e,onTouchMove:Ge,onTouchStart:et,tabIndex:mt=0,TouchRippleProps:St,touchRippleRef:xt,type:At}=_,Ct=Yn(_,QO),Ut=ue.useRef(null),at=ue.useRef(null),kt=Eo(at,xt),{isFocusVisibleRef:qt,onFocus:lt,onBlur:Ht,ref:Nn}=Z0(),[zn,xn]=ue.useState(!1);V&&zn&&xn(!1),ue.useImperativeHandle(w,()=>({focusVisible:()=>{xn(!0),Ut.current.focus()}}),[]);const[An,ti]=ue.useState(!1);ue.useEffect(()=>{ti(!0)},[]);const Hn=An&&!U&&!V;ue.useEffect(()=>{zn&&ie&&!U&&An&&at.current.pulsate()},[U,ie,zn,An]);function bn(ci,Cs,Wr=Z){return Tu(Ws=>(Cs&&Cs(Ws),!Wr&&at.current&&at.current[ci](Ws),!0))}const Zi=bn("start",Oe),Ci=bn("stop",Se),Yi=bn("stop",me),Vn=bn("stop",qe),ki=bn("stop",ci=>{zn&&ci.preventDefault(),Ee&&Ee(ci)}),zi=bn("start",et),Pr=bn("stop",$e),Gr=bn("stop",Ge),ys=bn("stop",ci=>{Ht(ci),qt.current===!1&&xn(!1),se&&se(ci)},!1),zr=Tu(ci=>{Ut.current||(Ut.current=ci.currentTarget),lt(ci),qt.current===!0&&(xn(!0),ye&&ye(ci)),Re&&Re(ci)}),Or=()=>{const ci=Ut.current;return O&&O!=="button"&&!(ci.tagName==="A"&&ci.href)},sr=ue.useRef(!1),Ss=Tu(ci=>{ie&&!sr.current&&zn&&at.current&&ci.key===" "&&(sr.current=!0,at.current.stop(ci,()=>{at.current.start(ci)})),ci.target===ci.currentTarget&&Or()&&ci.key===" "&&ci.preventDefault(),Le&&Le(ci),ci.target===ci.currentTarget&&Or()&&ci.key==="Enter"&&!V&&(ci.preventDefault(),ne&&ne(ci))}),as=Tu(ci=>{ie&&ci.key===" "&&at.current&&zn&&!ci.defaultPrevented&&(sr.current=!1,at.current.stop(ci,()=>{at.current.pulsate(ci)})),De&&De(ci),ne&&ci.target===ci.currentTarget&&Or()&&ci.key===" "&&!ci.defaultPrevented&&ne(ci)});let Hi=O;Hi==="button"&&(Ct.href||Ct.to)&&(Hi=de);const Gs={};Hi==="button"?(Gs.type=At===void 0?"button":At,Gs.disabled=V):(!Ct.href&&!Ct.to&&(Gs.role="button"),V&&(Gs["aria-disabled"]=V));const ho=Eo(m,Nn,Ut),Jr=Fe({},_,{centerRipple:C,component:O,disabled:V,disableRipple:U,disableTouchRipple:Z,focusRipple:ie,tabIndex:mt,focusVisible:zn}),xr=JO(Jr);return Ne.jsxs(e3,Fe({as:Hi,className:oi(xr.root,r),ownerState:Jr,onBlur:ys,onClick:ne,onContextMenu:Ci,onFocus:zr,onKeyDown:Ss,onKeyUp:as,onMouseDown:Zi,onMouseLeave:ki,onMouseUp:Vn,onDragLeave:Yi,onTouchEnd:Pr,onTouchMove:Gr,onTouchStart:zi,ref:ho,tabIndex:V?-1:mt,type:At},Gs,Ct,{children:[M,Hn?Ne.jsx(KO,Fe({ref:kt,center:C},St)):null]}))});function t3(a){return dr("MuiIconButton",a)}const n3=rr("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),i3=["edge","children","className","color","disabled","disableFocusRipple","size"],r3=a=>{const{classes:l,disabled:m,color:_,edge:w,size:C}=a,M={root:["root",m&&"disabled",_!=="default"&&`color${vn(_)}`,w&&`edge${vn(w)}`,`size${vn(C)}`]};return yr(M,t3,l)},s3=qn(km,{name:"MuiIconButton",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,m.color!=="default"&&l[`color${vn(m.color)}`],m.edge&&l[`edge${vn(m.edge)}`],l[`size${vn(m.size)}`]]}})(({theme:a,ownerState:l})=>Fe({textAlign:"center",flex:"0 0 auto",fontSize:a.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(a.vars||a).palette.action.active,transition:a.transitions.create("background-color",{duration:a.transitions.duration.shortest})},!l.disableRipple&&{"&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.activeChannel} / ${a.vars.palette.action.hoverOpacity})`:os.alpha(a.palette.action.active,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},l.edge==="start"&&{marginLeft:l.size==="small"?-3:-12},l.edge==="end"&&{marginRight:l.size==="small"?-3:-12}),({theme:a,ownerState:l})=>{var m;const _=(m=(a.vars||a).palette)==null?void 0:m[l.color];return Fe({},l.color==="inherit"&&{color:"inherit"},l.color!=="inherit"&&l.color!=="default"&&Fe({color:_==null?void 0:_.main},!l.disableRipple&&{"&:hover":Fe({},_&&{backgroundColor:a.vars?`rgba(${_.mainChannel} / ${a.vars.palette.action.hoverOpacity})`:os.alpha(_.main,a.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),l.size==="small"&&{padding:5,fontSize:a.typography.pxToRem(18)},l.size==="large"&&{padding:12,fontSize:a.typography.pxToRem(28)},{[`&.${n3.disabled}`]:{backgroundColor:"transparent",color:(a.vars||a).palette.action.disabled}})}),Hl=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiIconButton"}),{edge:w=!1,children:C,className:M,color:r="default",disabled:O=!1,disableFocusRipple:V=!1,size:U="medium"}=_,Z=Yn(_,i3),ie=Fe({},_,{edge:w,color:r,disabled:O,disableFocusRipple:V,size:U}),de=r3(ie);return Ne.jsx(s3,Fe({className:oi(de.root,M),centerRipple:!0,focusRipple:!V,disabled:O,ref:m},Z,{ownerState:ie,children:C}))});function o3(a){return dr("MuiTypography",a)}rr("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const a3=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],l3=a=>{const{align:l,gutterBottom:m,noWrap:_,paragraph:w,variant:C,classes:M}=a,r={root:["root",C,a.align!=="inherit"&&`align${vn(l)}`,m&&"gutterBottom",_&&"noWrap",w&&"paragraph"]};return yr(r,o3,M)},c3=qn("span",{name:"MuiTypography",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,m.variant&&l[m.variant],m.align!=="inherit"&&l[`align${vn(m.align)}`],m.noWrap&&l.noWrap,m.gutterBottom&&l.gutterBottom,m.paragraph&&l.paragraph]}})(({theme:a,ownerState:l})=>Fe({margin:0},l.variant==="inherit"&&{font:"inherit"},l.variant!=="inherit"&&a.typography[l.variant],l.align!=="inherit"&&{textAlign:l.align},l.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},l.gutterBottom&&{marginBottom:"0.35em"},l.paragraph&&{marginBottom:16})),ZS={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},u3={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},h3=a=>u3[a]||a,na=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiTypography"}),w=h3(_.color),C=__(Fe({},_,{color:w})),{align:M="inherit",className:r,component:O,gutterBottom:V=!1,noWrap:U=!1,paragraph:Z=!1,variant:ie="body1",variantMapping:de=ZS}=C,se=Yn(C,a3),ne=Fe({},C,{align:M,color:w,className:r,component:O,gutterBottom:V,noWrap:U,paragraph:Z,variant:ie,variantMapping:de}),Se=O||(Z?"p":de[ie]||ZS[ie])||"span",me=l3(ne);return Ne.jsx(c3,Fe({as:Se,ref:m,ownerState:ne,className:oi(me.root,r)},se))});function d3(a){return dr("MuiAppBar",a)}rr("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const p3=["className","color","enableColorOnDark","position"],f3=a=>{const{color:l,position:m,classes:_}=a,w={root:["root",`color${vn(l)}`,`position${vn(m)}`]};return yr(w,d3,_)},dy=(a,l)=>a?`${a==null?void 0:a.replace(")","")}, ${l})`:l,m3=qn(jm,{name:"MuiAppBar",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,l[`position${vn(m.position)}`],l[`color${vn(m.color)}`]]}})(({theme:a,ownerState:l})=>{const m=a.palette.mode==="light"?a.palette.grey[100]:a.palette.grey[900];return Fe({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},l.position==="fixed"&&{position:"fixed",zIndex:(a.vars||a).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},l.position==="absolute"&&{position:"absolute",zIndex:(a.vars||a).zIndex.appBar,top:0,left:"auto",right:0},l.position==="sticky"&&{position:"sticky",zIndex:(a.vars||a).zIndex.appBar,top:0,left:"auto",right:0},l.position==="static"&&{position:"static"},l.position==="relative"&&{position:"relative"},!a.vars&&Fe({},l.color==="default"&&{backgroundColor:m,color:a.palette.getContrastText(m)},l.color&&l.color!=="default"&&l.color!=="inherit"&&l.color!=="transparent"&&{backgroundColor:a.palette[l.color].main,color:a.palette[l.color].contrastText},l.color==="inherit"&&{color:"inherit"},a.palette.mode==="dark"&&!l.enableColorOnDark&&{backgroundColor:null,color:null},l.color==="transparent"&&Fe({backgroundColor:"transparent",color:"inherit"},a.palette.mode==="dark"&&{backgroundImage:"none"})),a.vars&&Fe({},l.color==="default"&&{"--AppBar-background":l.enableColorOnDark?a.vars.palette.AppBar.defaultBg:dy(a.vars.palette.AppBar.darkBg,a.vars.palette.AppBar.defaultBg),"--AppBar-color":l.enableColorOnDark?a.vars.palette.text.primary:dy(a.vars.palette.AppBar.darkColor,a.vars.palette.text.primary)},l.color&&!l.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":l.enableColorOnDark?a.vars.palette[l.color].main:dy(a.vars.palette.AppBar.darkBg,a.vars.palette[l.color].main),"--AppBar-color":l.enableColorOnDark?a.vars.palette[l.color].contrastText:dy(a.vars.palette.AppBar.darkColor,a.vars.palette[l.color].contrastText)},!["inherit","transparent"].includes(l.color)&&{backgroundColor:"var(--AppBar-background)"},{color:l.color==="inherit"?"inherit":"var(--AppBar-color)"},l.color==="transparent"&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))}),g3=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiAppBar"}),{className:w,color:C="primary",enableColorOnDark:M=!1,position:r="fixed"}=_,O=Yn(_,p3),V=Fe({},_,{color:C,position:r,enableColorOnDark:M}),U=f3(V);return Ne.jsx(m3,Fe({square:!0,component:"header",ownerState:V,elevation:4,className:oi(U.root,w,r==="fixed"&&"mui-fixed"),ref:m},O))});function _3(a){return typeof a=="function"?a():a}const y3=ue.forwardRef(function(l,m){const{children:_,container:w,disablePortal:C=!1}=l,[M,r]=ue.useState(null),O=Eo(ue.isValidElement(_)?Pf(_):null,m);if(bh(()=>{C||r(_3(w)||document.body)},[w,C]),bh(()=>{if(M&&!C)return ky(m,M),()=>{ky(m,null)}},[m,M,C]),C){if(ue.isValidElement(_)){const V={ref:O};return ue.cloneElement(_,V)}return Ne.jsx(ue.Fragment,{children:_})}return Ne.jsx(ue.Fragment,{children:M&&l2.createPortal(_,M)})}),v3=Fm(Ne.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function x3(a){return dr("MuiChip",a)}const $r=rr("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),b3=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],w3=a=>{const{classes:l,disabled:m,size:_,color:w,iconColor:C,onDelete:M,clickable:r,variant:O}=a,V={root:["root",O,m&&"disabled",`size${vn(_)}`,`color${vn(w)}`,r&&"clickable",r&&`clickableColor${vn(w)}`,M&&"deletable",M&&`deletableColor${vn(w)}`,`${O}${vn(w)}`],label:["label",`label${vn(_)}`],avatar:["avatar",`avatar${vn(_)}`,`avatarColor${vn(w)}`],icon:["icon",`icon${vn(_)}`,`iconColor${vn(C)}`],deleteIcon:["deleteIcon",`deleteIcon${vn(_)}`,`deleteIconColor${vn(w)}`,`deleteIcon${vn(O)}Color${vn(w)}`]};return yr(V,x3,l)},T3=qn("div",{name:"MuiChip",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a,{color:_,iconColor:w,clickable:C,onDelete:M,size:r,variant:O}=m;return[{[`& .${$r.avatar}`]:l.avatar},{[`& .${$r.avatar}`]:l[`avatar${vn(r)}`]},{[`& .${$r.avatar}`]:l[`avatarColor${vn(_)}`]},{[`& .${$r.icon}`]:l.icon},{[`& .${$r.icon}`]:l[`icon${vn(r)}`]},{[`& .${$r.icon}`]:l[`iconColor${vn(w)}`]},{[`& .${$r.deleteIcon}`]:l.deleteIcon},{[`& .${$r.deleteIcon}`]:l[`deleteIcon${vn(r)}`]},{[`& .${$r.deleteIcon}`]:l[`deleteIconColor${vn(_)}`]},{[`& .${$r.deleteIcon}`]:l[`deleteIcon${vn(O)}Color${vn(_)}`]},l.root,l[`size${vn(r)}`],l[`color${vn(_)}`],C&&l.clickable,C&&_!=="default"&&l[`clickableColor${vn(_)})`],M&&l.deletable,M&&_!=="default"&&l[`deletableColor${vn(_)}`],l[O],l[`${O}${vn(_)}`]]}})(({theme:a,ownerState:l})=>{const m=a.palette.mode==="light"?a.palette.grey[700]:a.palette.grey[300];return Fe({maxWidth:"100%",fontFamily:a.typography.fontFamily,fontSize:a.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(a.vars||a).palette.text.primary,backgroundColor:(a.vars||a).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:a.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${$r.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${$r.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:a.vars?a.vars.palette.Chip.defaultAvatarColor:m,fontSize:a.typography.pxToRem(12)},[`& .${$r.avatarColorPrimary}`]:{color:(a.vars||a).palette.primary.contrastText,backgroundColor:(a.vars||a).palette.primary.dark},[`& .${$r.avatarColorSecondary}`]:{color:(a.vars||a).palette.secondary.contrastText,backgroundColor:(a.vars||a).palette.secondary.dark},[`& .${$r.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:a.typography.pxToRem(10)},[`& .${$r.icon}`]:Fe({marginLeft:5,marginRight:-6},l.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},l.iconColor===l.color&&Fe({color:a.vars?a.vars.palette.Chip.defaultIconColor:m},l.color!=="default"&&{color:"inherit"})),[`& .${$r.deleteIcon}`]:Fe({WebkitTapHighlightColor:"transparent",color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.26)`:os.alpha(a.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.4)`:os.alpha(a.palette.text.primary,.4)}},l.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},l.color!=="default"&&{color:a.vars?`rgba(${a.vars.palette[l.color].contrastTextChannel} / 0.7)`:os.alpha(a.palette[l.color].contrastText,.7),"&:hover, &:active":{color:(a.vars||a).palette[l.color].contrastText}})},l.size==="small"&&{height:24},l.color!=="default"&&{backgroundColor:(a.vars||a).palette[l.color].main,color:(a.vars||a).palette[l.color].contrastText},l.onDelete&&{[`&.${$r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:os.alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},l.onDelete&&l.color!=="default"&&{[`&.${$r.focusVisible}`]:{backgroundColor:(a.vars||a).palette[l.color].dark}})},({theme:a,ownerState:l})=>Fe({},l.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:os.alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity)},[`&.${$r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:os.alpha(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)},"&:active":{boxShadow:(a.vars||a).shadows[1]}},l.clickable&&l.color!=="default"&&{[`&:hover, &.${$r.focusVisible}`]:{backgroundColor:(a.vars||a).palette[l.color].dark}}),({theme:a,ownerState:l})=>Fe({},l.variant==="outlined"&&{backgroundColor:"transparent",border:a.vars?`1px solid ${a.vars.palette.Chip.defaultBorder}`:`1px solid ${a.palette.mode==="light"?a.palette.grey[400]:a.palette.grey[700]}`,[`&.${$r.clickable}:hover`]:{backgroundColor:(a.vars||a).palette.action.hover},[`&.${$r.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`& .${$r.avatar}`]:{marginLeft:4},[`& .${$r.avatarSmall}`]:{marginLeft:2},[`& .${$r.icon}`]:{marginLeft:4},[`& .${$r.iconSmall}`]:{marginLeft:2},[`& .${$r.deleteIcon}`]:{marginRight:5},[`& .${$r.deleteIconSmall}`]:{marginRight:3}},l.variant==="outlined"&&l.color!=="default"&&{color:(a.vars||a).palette[l.color].main,border:`1px solid ${a.vars?`rgba(${a.vars.palette[l.color].mainChannel} / 0.7)`:os.alpha(a.palette[l.color].main,.7)}`,[`&.${$r.clickable}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[l.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:os.alpha(a.palette[l.color].main,a.palette.action.hoverOpacity)},[`&.${$r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[l.color].mainChannel} / ${a.vars.palette.action.focusOpacity})`:os.alpha(a.palette[l.color].main,a.palette.action.focusOpacity)},[`& .${$r.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[l.color].mainChannel} / 0.7)`:os.alpha(a.palette[l.color].main,.7),"&:hover, &:active":{color:(a.vars||a).palette[l.color].main}}})),S3=qn("span",{name:"MuiChip",slot:"Label",overridesResolver:(a,l)=>{const{ownerState:m}=a,{size:_}=m;return[l.label,l[`label${vn(_)}`]]}})(({ownerState:a})=>Fe({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},a.variant==="outlined"&&{paddingLeft:11,paddingRight:11},a.size==="small"&&{paddingLeft:8,paddingRight:8},a.size==="small"&&a.variant==="outlined"&&{paddingLeft:7,paddingRight:7}));function KS(a){return a.key==="Backspace"||a.key==="Delete"}const C3=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiChip"}),{avatar:w,className:C,clickable:M,color:r="default",component:O,deleteIcon:V,disabled:U=!1,icon:Z,label:ie,onClick:de,onDelete:se,onKeyDown:ne,onKeyUp:Se,size:me="medium",variant:Re="filled",tabIndex:ye,skipFocusWhenDisabled:Le=!1}=_,De=Yn(_,b3),Oe=ue.useRef(null),Ee=Eo(Oe,m),qe=kt=>{kt.stopPropagation(),se&&se(kt)},$e=kt=>{kt.currentTarget===kt.target&&KS(kt)&&kt.preventDefault(),ne&&ne(kt)},Ge=kt=>{kt.currentTarget===kt.target&&(se&&KS(kt)?se(kt):kt.key==="Escape"&&Oe.current&&Oe.current.blur()),Se&&Se(kt)},et=M!==!1&&de?!0:M,mt=et||se?km:O||"div",St=Fe({},_,{component:mt,disabled:U,size:me,color:r,iconColor:ue.isValidElement(Z)&&Z.props.color||r,onDelete:!!se,clickable:et,variant:Re}),xt=w3(St),At=mt===km?Fe({component:O||"div",focusVisibleClassName:xt.focusVisible},se&&{disableRipple:!0}):{};let Ct=null;se&&(Ct=V&&ue.isValidElement(V)?ue.cloneElement(V,{className:oi(V.props.className,xt.deleteIcon),onClick:qe}):Ne.jsx(v3,{className:oi(xt.deleteIcon),onClick:qe}));let Ut=null;w&&ue.isValidElement(w)&&(Ut=ue.cloneElement(w,{className:oi(xt.avatar,w.props.className)}));let at=null;return Z&&ue.isValidElement(Z)&&(at=ue.cloneElement(Z,{className:oi(xt.icon,Z.props.className)})),Ne.jsxs(T3,Fe({as:mt,className:oi(xt.root,C),disabled:et&&U?!0:void 0,onClick:de,onKeyDown:$e,onKeyUp:Ge,ref:Ee,tabIndex:Le&&U?-1:ye,ownerState:St},At,De,{children:[Ut||at,Ne.jsx(S3,{className:oi(xt.label),ownerState:St,children:ie}),Ct]}))}),E3=["onChange","maxRows","minRows","style","value"];function py(a){return parseInt(a,10)||0}const A3={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function I3(a){for(const l in a)return!1;return!0}function XS(a){return I3(a)||a.outerHeightStyle===0&&!a.overflowing}const P3=ue.forwardRef(function(l,m){const{onChange:_,maxRows:w,minRows:C=1,style:M,value:r}=l,O=Yn(l,E3),{current:V}=ue.useRef(r!=null),U=ue.useRef(null),Z=Eo(m,U),ie=ue.useRef(null),de=ue.useRef(null),se=ue.useCallback(()=>{const ye=U.current,Le=de.current;if(!ye||!Le)return;const Oe=wh(ye).getComputedStyle(ye);if(Oe.width==="0px")return{outerHeightStyle:0,overflowing:!1};Le.style.width=Oe.width,Le.value=ye.value||l.placeholder||"x",Le.value.slice(-1)===`
`&&(Le.value+=" ");const Ee=Oe.boxSizing,qe=py(Oe.paddingBottom)+py(Oe.paddingTop),$e=py(Oe.borderBottomWidth)+py(Oe.borderTopWidth),Ge=Le.scrollHeight;Le.value="x";const et=Le.scrollHeight;let mt=Ge;C&&(mt=Math.max(Number(C)*et,mt)),w&&(mt=Math.min(Number(w)*et,mt)),mt=Math.max(mt,et);const St=mt+(Ee==="border-box"?qe+$e:0),xt=Math.abs(mt-Ge)<=1;return{outerHeightStyle:St,overflowing:xt}},[w,C,l.placeholder]),ne=Tu(()=>{const ye=U.current,Le=se();if(!ye||!Le||XS(Le))return!1;const De=Le.outerHeightStyle;return ie.current!=null&&ie.current!==De}),Se=ue.useCallback(()=>{const ye=U.current,Le=se();if(!ye||!Le||XS(Le))return;const De=Le.outerHeightStyle;ie.current!==De&&(ie.current=De,ye.style.height=`${De}px`),ye.style.overflow=Le.overflowing?"hidden":""},[se]),me=ue.useRef(-1);bh(()=>{const ye=nv(Se),Le=U==null?void 0:U.current;if(!Le)return;const De=wh(Le);De.addEventListener("resize",ye);let Oe;return typeof ResizeObserver<"u"&&(Oe=new ResizeObserver(()=>{ne()&&(Oe.unobserve(Le),cancelAnimationFrame(me.current),Se(),me.current=requestAnimationFrame(()=>{Oe.observe(Le)}))}),Oe.observe(Le)),()=>{ye.clear(),cancelAnimationFrame(me.current),De.removeEventListener("resize",ye),Oe&&Oe.disconnect()}},[se,Se,ne]),bh(()=>{Se()});const Re=ye=>{V||Se(),_&&_(ye)};return Ne.jsxs(ue.Fragment,{children:[Ne.jsx("textarea",Fe({value:r,onChange:Re,ref:Z,rows:C,style:M},O)),Ne.jsx("textarea",{"aria-hidden":!0,className:l.className,readOnly:!0,ref:de,tabIndex:-1,style:Fe({},A3.shadow,M,{paddingTop:0,paddingBottom:0})})]})});function kf({props:a,states:l,muiFormControl:m}){return l.reduce((_,w)=>(_[w]=a[w],m&&typeof a[w]>"u"&&(_[w]=m[w]),_),{})}const eb=ue.createContext(void 0);function Ap(){return ue.useContext(eb)}function oE(a){return Ne.jsx(U2,Fe({},a,{defaultTheme:X0,themeId:Em}))}function YS(a){return a!=null&&!(Array.isArray(a)&&a.length===0)}function Dy(a,l=!1){return a&&(YS(a.value)&&a.value!==""||l&&YS(a.defaultValue)&&a.defaultValue!=="")}function k3(a){return a.startAdornment}function M3(a){return dr("MuiInputBase",a)}const Mm=rr("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),R3=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],av=(a,l)=>{const{ownerState:m}=a;return[l.root,m.formControl&&l.formControl,m.startAdornment&&l.adornedStart,m.endAdornment&&l.adornedEnd,m.error&&l.error,m.size==="small"&&l.sizeSmall,m.multiline&&l.multiline,m.color&&l[`color${vn(m.color)}`],m.fullWidth&&l.fullWidth,m.hiddenLabel&&l.hiddenLabel]},lv=(a,l)=>{const{ownerState:m}=a;return[l.input,m.size==="small"&&l.inputSizeSmall,m.multiline&&l.inputMultiline,m.type==="search"&&l.inputTypeSearch,m.startAdornment&&l.inputAdornedStart,m.endAdornment&&l.inputAdornedEnd,m.hiddenLabel&&l.inputHiddenLabel]},z3=a=>{const{classes:l,color:m,disabled:_,error:w,endAdornment:C,focused:M,formControl:r,fullWidth:O,hiddenLabel:V,multiline:U,readOnly:Z,size:ie,startAdornment:de,type:se}=a,ne={root:["root",`color${vn(m)}`,_&&"disabled",w&&"error",O&&"fullWidth",M&&"focused",r&&"formControl",ie&&ie!=="medium"&&`size${vn(ie)}`,U&&"multiline",de&&"adornedStart",C&&"adornedEnd",V&&"hiddenLabel",Z&&"readOnly"],input:["input",_&&"disabled",se==="search"&&"inputTypeSearch",U&&"inputMultiline",ie==="small"&&"inputSizeSmall",V&&"inputHiddenLabel",de&&"inputAdornedStart",C&&"inputAdornedEnd",Z&&"readOnly"]};return yr(ne,M3,l)},cv=qn("div",{name:"MuiInputBase",slot:"Root",overridesResolver:av})(({theme:a,ownerState:l})=>Fe({},a.typography.body1,{color:(a.vars||a).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Mm.disabled}`]:{color:(a.vars||a).palette.text.disabled,cursor:"default"}},l.multiline&&Fe({padding:"4px 0 5px"},l.size==="small"&&{paddingTop:1}),l.fullWidth&&{width:"100%"})),uv=qn("input",{name:"MuiInputBase",slot:"Input",overridesResolver:lv})(({theme:a,ownerState:l})=>{const m=a.palette.mode==="light",_=Fe({color:"currentColor"},a.vars?{opacity:a.vars.opacity.inputPlaceholder}:{opacity:m?.42:.5},{transition:a.transitions.create("opacity",{duration:a.transitions.duration.shorter})}),w={opacity:"0 !important"},C=a.vars?{opacity:a.vars.opacity.inputPlaceholder}:{opacity:m?.42:.5};return Fe({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":_,"&::-moz-placeholder":_,"&:-ms-input-placeholder":_,"&::-ms-input-placeholder":_,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Mm.formControl} &`]:{"&::-webkit-input-placeholder":w,"&::-moz-placeholder":w,"&:-ms-input-placeholder":w,"&::-ms-input-placeholder":w,"&:focus::-webkit-input-placeholder":C,"&:focus::-moz-placeholder":C,"&:focus:-ms-input-placeholder":C,"&:focus::-ms-input-placeholder":C},[`&.${Mm.disabled}`]:{opacity:1,WebkitTextFillColor:(a.vars||a).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},l.size==="small"&&{paddingTop:1},l.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},l.type==="search"&&{MozAppearance:"textfield"})}),L3=Ne.jsx(oE,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),tb=ue.forwardRef(function(l,m){var _;const w=vr({props:l,name:"MuiInputBase"}),{"aria-describedby":C,autoComplete:M,autoFocus:r,className:O,components:V={},componentsProps:U={},defaultValue:Z,disabled:ie,disableInjectingGlobalStyles:de,endAdornment:se,fullWidth:ne=!1,id:Se,inputComponent:me="input",inputProps:Re={},inputRef:ye,maxRows:Le,minRows:De,multiline:Oe=!1,name:Ee,onBlur:qe,onChange:$e,onClick:Ge,onFocus:et,onKeyDown:mt,onKeyUp:St,placeholder:xt,readOnly:At,renderSuffix:Ct,rows:Ut,slotProps:at={},slots:kt={},startAdornment:qt,type:lt="text",value:Ht}=w,Nn=Yn(w,R3),zn=Re.value!=null?Re.value:Ht,{current:xn}=ue.useRef(zn!=null),An=ue.useRef(),ti=ue.useCallback(xr=>{},[]),Hn=Eo(An,ye,Re.ref,ti),[bn,Zi]=ue.useState(!1),Ci=Ap(),Yi=kf({props:w,muiFormControl:Ci,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Yi.focused=Ci?Ci.focused:bn,ue.useEffect(()=>{!Ci&&ie&&bn&&(Zi(!1),qe&&qe())},[Ci,ie,bn,qe]);const Vn=Ci&&Ci.onFilled,ki=Ci&&Ci.onEmpty,zi=ue.useCallback(xr=>{Dy(xr)?Vn&&Vn():ki&&ki()},[Vn,ki]);bh(()=>{xn&&zi({value:zn})},[zn,zi,xn]);const Pr=xr=>{if(Yi.disabled){xr.stopPropagation();return}et&&et(xr),Re.onFocus&&Re.onFocus(xr),Ci&&Ci.onFocus?Ci.onFocus(xr):Zi(!0)},Gr=xr=>{qe&&qe(xr),Re.onBlur&&Re.onBlur(xr),Ci&&Ci.onBlur?Ci.onBlur(xr):Zi(!1)},ys=(xr,...ci)=>{if(!xn){const Cs=xr.target||An.current;if(Cs==null)throw new Error(xd(1));zi({value:Cs.value})}Re.onChange&&Re.onChange(xr,...ci),$e&&$e(xr,...ci)};ue.useEffect(()=>{zi(An.current)},[]);const zr=xr=>{An.current&&xr.currentTarget===xr.target&&An.current.focus(),Ge&&Ge(xr)};let Or=me,sr=Re;Oe&&Or==="input"&&(Ut?sr=Fe({type:void 0,minRows:Ut,maxRows:Ut},sr):sr=Fe({type:void 0,maxRows:Le,minRows:De},sr),Or=P3);const Ss=xr=>{zi(xr.animationName==="mui-auto-fill-cancel"?An.current:{value:"x"})};ue.useEffect(()=>{Ci&&Ci.setAdornedStart(!!qt)},[Ci,qt]);const as=Fe({},w,{color:Yi.color||"primary",disabled:Yi.disabled,endAdornment:se,error:Yi.error,focused:Yi.focused,formControl:Ci,fullWidth:ne,hiddenLabel:Yi.hiddenLabel,multiline:Oe,size:Yi.size,startAdornment:qt,type:lt}),Hi=z3(as),Gs=kt.root||V.Root||cv,ho=at.root||U.root||{},Jr=kt.input||V.Input||uv;return sr=Fe({},sr,(_=at.input)!=null?_:U.input),Ne.jsxs(ue.Fragment,{children:[!de&&L3,Ne.jsxs(Gs,Fe({},ho,!Ry(Gs)&&{ownerState:Fe({},as,ho.ownerState)},{ref:m,onClick:zr},Nn,{className:oi(Hi.root,ho.className,O,At&&"MuiInputBase-readOnly"),children:[qt,Ne.jsx(eb.Provider,{value:null,children:Ne.jsx(Jr,Fe({ownerState:as,"aria-invalid":Yi.error,"aria-describedby":C,autoComplete:M,autoFocus:r,defaultValue:Z,disabled:Yi.disabled,id:Se,onAnimationStart:Ss,name:Ee,placeholder:xt,readOnly:At,required:Yi.required,rows:Ut,value:zn,onKeyDown:mt,onKeyUp:St,type:lt},sr,!Ry(Jr)&&{as:Or,ownerState:Fe({},as,sr.ownerState)},{ref:Hn,className:oi(Hi.input,sr.className,At&&"MuiInputBase-readOnly"),onBlur:Gr,onChange:ys,onFocus:Pr}))}),se,Ct?Ct(Fe({},Yi,{startAdornment:qt})):null]}))]})});function D3(a){return dr("MuiInput",a)}const zg=Fe({},Mm,rr("MuiInput",["root","underline","input"]));function O3(a){return dr("MuiOutlinedInput",a)}const Tp=Fe({},Mm,rr("MuiOutlinedInput",["root","notchedOutline","input"]));function B3(a){return dr("MuiFilledInput",a)}const yf=Fe({},Mm,rr("MuiFilledInput",["root","underline","input"])),F3=Fm(Ne.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),j3=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],N3={entering:{opacity:1},entered:{opacity:1}},aE=ue.forwardRef(function(l,m){const _=gl(),w={enter:_.transitions.duration.enteringScreen,exit:_.transitions.duration.leavingScreen},{addEndListener:C,appear:M=!0,children:r,easing:O,in:V,onEnter:U,onEntered:Z,onEntering:ie,onExit:de,onExited:se,onExiting:ne,style:Se,timeout:me=w,TransitionComponent:Re=Su}=l,ye=Yn(l,j3),Le=ue.useRef(null),De=Eo(Le,Pf(r),m),Oe=xt=>At=>{if(xt){const Ct=Le.current;At===void 0?xt(Ct):xt(Ct,At)}},Ee=Oe(ie),qe=Oe((xt,At)=>{J0(xt);const Ct=Pm({style:Se,timeout:me,easing:O},{mode:"enter"});xt.style.webkitTransition=_.transitions.create("opacity",Ct),xt.style.transition=_.transitions.create("opacity",Ct),U&&U(xt,At)}),$e=Oe(Z),Ge=Oe(ne),et=Oe(xt=>{const At=Pm({style:Se,timeout:me,easing:O},{mode:"exit"});xt.style.webkitTransition=_.transitions.create("opacity",At),xt.style.transition=_.transitions.create("opacity",At),de&&de(xt)}),mt=Oe(se),St=xt=>{C&&C(Le.current,xt)};return Ne.jsx(Re,Fe({appear:M,in:V,nodeRef:Le,onEnter:qe,onEntered:$e,onEntering:Ee,onExit:et,onExited:mt,onExiting:Ge,addEndListener:St,timeout:me},ye,{children:(xt,At)=>ue.cloneElement(r,Fe({style:Fe({opacity:0,visibility:xt==="exited"&&!V?"hidden":void 0},N3[xt],Se,r.props.style),ref:De},At))}))});function V3(a){return dr("MuiBackdrop",a)}rr("MuiBackdrop",["root","invisible"]);const q3=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],H3=a=>{const{classes:l,invisible:m}=a;return yr({root:["root",m&&"invisible"]},V3,l)},U3=qn("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,m.invisible&&l.invisible]}})(({ownerState:a})=>Fe({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},a.invisible&&{backgroundColor:"transparent"})),lE=ue.forwardRef(function(l,m){var _,w,C;const M=vr({props:l,name:"MuiBackdrop"}),{children:r,className:O,component:V="div",components:U={},componentsProps:Z={},invisible:ie=!1,open:de,slotProps:se={},slots:ne={},TransitionComponent:Se=aE,transitionDuration:me}=M,Re=Yn(M,q3),ye=Fe({},M,{component:V,invisible:ie}),Le=H3(ye),De=(_=se.root)!=null?_:Z.root;return Ne.jsx(Se,Fe({in:de,timeout:me},Re,{children:Ne.jsx(U3,Fe({"aria-hidden":!0},De,{as:(w=(C=ne.root)!=null?C:U.Root)!=null?w:V,className:oi(Le.root,O,De==null?void 0:De.className),ownerState:Fe({},ye,De==null?void 0:De.ownerState),classes:Le,ref:m,children:r}))}))}),$3=rr("MuiBox",["root"]),G3=K0(),$s=PL({themeId:Em,defaultTheme:G3,defaultClassName:$3.root,generateClassName:G0.generate});function W3(a){return dr("MuiButton",a)}const fy=rr("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Z3=ue.createContext({}),K3=ue.createContext(void 0),X3=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Y3=a=>{const{color:l,disableElevation:m,fullWidth:_,size:w,variant:C,classes:M}=a,r={root:["root",C,`${C}${vn(l)}`,`size${vn(w)}`,`${C}Size${vn(w)}`,`color${vn(l)}`,m&&"disableElevation",_&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${vn(w)}`],endIcon:["icon","endIcon",`iconSize${vn(w)}`]},O=yr(r,W3,M);return Fe({},M,O)},cE=a=>Fe({},a.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},a.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},a.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Q3=qn(km,{shouldForwardProp:a=>Na(a)||a==="classes",name:"MuiButton",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,l[m.variant],l[`${m.variant}${vn(m.color)}`],l[`size${vn(m.size)}`],l[`${m.variant}Size${vn(m.size)}`],m.color==="inherit"&&l.colorInherit,m.disableElevation&&l.disableElevation,m.fullWidth&&l.fullWidth]}})(({theme:a,ownerState:l})=>{var m,_;const w=a.palette.mode==="light"?a.palette.grey[300]:a.palette.grey[800],C=a.palette.mode==="light"?a.palette.grey.A100:a.palette.grey[700];return Fe({},a.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create(["background-color","box-shadow","border-color","color"],{duration:a.transitions.duration.short}),"&:hover":Fe({textDecoration:"none",backgroundColor:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / ${a.vars.palette.action.hoverOpacity})`:os.alpha(a.palette.text.primary,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},l.variant==="text"&&l.color!=="inherit"&&{backgroundColor:a.vars?`rgba(${a.vars.palette[l.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:os.alpha(a.palette[l.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},l.variant==="outlined"&&l.color!=="inherit"&&{border:`1px solid ${(a.vars||a).palette[l.color].main}`,backgroundColor:a.vars?`rgba(${a.vars.palette[l.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:os.alpha(a.palette[l.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},l.variant==="contained"&&{backgroundColor:a.vars?a.vars.palette.Button.inheritContainedHoverBg:C,boxShadow:(a.vars||a).shadows[4],"@media (hover: none)":{boxShadow:(a.vars||a).shadows[2],backgroundColor:(a.vars||a).palette.grey[300]}},l.variant==="contained"&&l.color!=="inherit"&&{backgroundColor:(a.vars||a).palette[l.color].dark,"@media (hover: none)":{backgroundColor:(a.vars||a).palette[l.color].main}}),"&:active":Fe({},l.variant==="contained"&&{boxShadow:(a.vars||a).shadows[8]}),[`&.${fy.focusVisible}`]:Fe({},l.variant==="contained"&&{boxShadow:(a.vars||a).shadows[6]}),[`&.${fy.disabled}`]:Fe({color:(a.vars||a).palette.action.disabled},l.variant==="outlined"&&{border:`1px solid ${(a.vars||a).palette.action.disabledBackground}`},l.variant==="contained"&&{color:(a.vars||a).palette.action.disabled,boxShadow:(a.vars||a).shadows[0],backgroundColor:(a.vars||a).palette.action.disabledBackground})},l.variant==="text"&&{padding:"6px 8px"},l.variant==="text"&&l.color!=="inherit"&&{color:(a.vars||a).palette[l.color].main},l.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},l.variant==="outlined"&&l.color!=="inherit"&&{color:(a.vars||a).palette[l.color].main,border:a.vars?`1px solid rgba(${a.vars.palette[l.color].mainChannel} / 0.5)`:`1px solid ${os.alpha(a.palette[l.color].main,.5)}`},l.variant==="contained"&&{color:a.vars?a.vars.palette.text.primary:(m=(_=a.palette).getContrastText)==null?void 0:m.call(_,a.palette.grey[300]),backgroundColor:a.vars?a.vars.palette.Button.inheritContainedBg:w,boxShadow:(a.vars||a).shadows[2]},l.variant==="contained"&&l.color!=="inherit"&&{color:(a.vars||a).palette[l.color].contrastText,backgroundColor:(a.vars||a).palette[l.color].main},l.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},l.size==="small"&&l.variant==="text"&&{padding:"4px 5px",fontSize:a.typography.pxToRem(13)},l.size==="large"&&l.variant==="text"&&{padding:"8px 11px",fontSize:a.typography.pxToRem(15)},l.size==="small"&&l.variant==="outlined"&&{padding:"3px 9px",fontSize:a.typography.pxToRem(13)},l.size==="large"&&l.variant==="outlined"&&{padding:"7px 21px",fontSize:a.typography.pxToRem(15)},l.size==="small"&&l.variant==="contained"&&{padding:"4px 10px",fontSize:a.typography.pxToRem(13)},l.size==="large"&&l.variant==="contained"&&{padding:"8px 22px",fontSize:a.typography.pxToRem(15)},l.fullWidth&&{width:"100%"})},({ownerState:a})=>a.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${fy.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${fy.disabled}`]:{boxShadow:"none"}}),J3=qn("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.startIcon,l[`iconSize${vn(m.size)}`]]}})(({ownerState:a})=>Fe({display:"inherit",marginRight:8,marginLeft:-4},a.size==="small"&&{marginLeft:-2},cE(a))),eB=qn("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.endIcon,l[`iconSize${vn(m.size)}`]]}})(({ownerState:a})=>Fe({display:"inherit",marginRight:-4,marginLeft:8},a.size==="small"&&{marginRight:-2},cE(a))),nb=ue.forwardRef(function(l,m){const _=ue.useContext(Z3),w=ue.useContext(K3),C=l_(_,l),M=vr({props:C,name:"MuiButton"}),{children:r,color:O="primary",component:V="button",className:U,disabled:Z=!1,disableElevation:ie=!1,disableFocusRipple:de=!1,endIcon:se,focusVisibleClassName:ne,fullWidth:Se=!1,size:me="medium",startIcon:Re,type:ye,variant:Le="text"}=M,De=Yn(M,X3),Oe=Fe({},M,{color:O,component:V,disabled:Z,disableElevation:ie,disableFocusRipple:de,fullWidth:Se,size:me,type:ye,variant:Le}),Ee=Y3(Oe),qe=Re&&Ne.jsx(J3,{className:Ee.startIcon,ownerState:Oe,children:Re}),$e=se&&Ne.jsx(eB,{className:Ee.endIcon,ownerState:Oe,children:se}),Ge=w||"";return Ne.jsxs(Q3,Fe({ownerState:Oe,className:oi(_.className,Ee.root,U,Ge),component:V,disabled:Z,focusRipple:!de,focusVisibleClassName:oi(Ee.focusVisible,ne),ref:m,type:ye},De,{classes:Ee,children:[qe,r,$e]}))});function tB(a){return dr("PrivateSwitchBase",a)}rr("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const nB=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],iB=a=>{const{classes:l,checked:m,disabled:_,edge:w}=a,C={root:["root",m&&"checked",_&&"disabled",w&&`edge${vn(w)}`],input:["input"]};return yr(C,tB,l)},rB=qn(km,{name:"MuiSwitchBase"})(({ownerState:a})=>Fe({padding:9,borderRadius:"50%"},a.edge==="start"&&{marginLeft:a.size==="small"?-3:-12},a.edge==="end"&&{marginRight:a.size==="small"?-3:-12})),sB=qn("input",{name:"MuiSwitchBase",shouldForwardProp:Na})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),oB=ue.forwardRef(function(l,m){const{autoFocus:_,checked:w,checkedIcon:C,className:M,defaultChecked:r,disabled:O,disableFocusRipple:V=!1,edge:U=!1,icon:Z,id:ie,inputProps:de,inputRef:se,name:ne,onBlur:Se,onChange:me,onFocus:Re,readOnly:ye,required:Le=!1,tabIndex:De,type:Oe,value:Ee}=l,qe=Yn(l,nB),[$e,Ge]=My({controlled:w,default:!!r,name:"SwitchBase",state:"checked"}),et=Ap(),mt=kt=>{Re&&Re(kt),et&&et.onFocus&&et.onFocus(kt)},St=kt=>{Se&&Se(kt),et&&et.onBlur&&et.onBlur(kt)},xt=kt=>{if(kt.nativeEvent.defaultPrevented)return;const qt=kt.target.checked;Ge(qt),me&&me(kt,qt)};let At=O;et&&typeof At>"u"&&(At=et.disabled);const Ct=Oe==="checkbox"||Oe==="radio",Ut=Fe({},l,{checked:$e,disabled:At,disableFocusRipple:V,edge:U}),at=iB(Ut);return Ne.jsxs(rB,Fe({component:"span",className:oi(at.root,M),centerRipple:!0,focusRipple:!V,disabled:At,tabIndex:null,role:void 0,onFocus:mt,onBlur:St,ownerState:Ut,ref:m},qe,{children:[Ne.jsx(sB,Fe({autoFocus:_,checked:w,defaultChecked:r,className:at.input,disabled:At,id:Ct?ie:void 0,name:ne,onChange:xt,readOnly:ye,ref:se,required:Le,ownerState:Ut,tabIndex:De,type:Oe},Oe==="checkbox"&&Ee===void 0?{}:{value:Ee},de)),$e?C:Z]}))}),aB=Fm(Ne.jsx("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),lB=Fm(Ne.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),cB=Fm(Ne.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function uB(a){return dr("MuiCheckbox",a)}const qx=rr("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),hB=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],dB=a=>{const{classes:l,indeterminate:m,color:_,size:w}=a,C={root:["root",m&&"indeterminate",`color${vn(_)}`,`size${vn(w)}`]},M=yr(C,uB,l);return Fe({},l,M)},pB=qn(oB,{shouldForwardProp:a=>Na(a)||a==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,m.indeterminate&&l.indeterminate,l[`size${vn(m.size)}`],m.color!=="default"&&l[`color${vn(m.color)}`]]}})(({theme:a,ownerState:l})=>Fe({color:(a.vars||a).palette.text.secondary},!l.disableRipple&&{"&:hover":{backgroundColor:a.vars?`rgba(${l.color==="default"?a.vars.palette.action.activeChannel:a.vars.palette[l.color].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:os.alpha(l.color==="default"?a.palette.action.active:a.palette[l.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},l.color!=="default"&&{[`&.${qx.checked}, &.${qx.indeterminate}`]:{color:(a.vars||a).palette[l.color].main},[`&.${qx.disabled}`]:{color:(a.vars||a).palette.action.disabled}})),fB=Ne.jsx(lB,{}),mB=Ne.jsx(aB,{}),gB=Ne.jsx(cB,{}),_B=ue.forwardRef(function(l,m){var _,w;const C=vr({props:l,name:"MuiCheckbox"}),{checkedIcon:M=fB,color:r="primary",icon:O=mB,indeterminate:V=!1,indeterminateIcon:U=gB,inputProps:Z,size:ie="medium",className:de}=C,se=Yn(C,hB),ne=V?U:O,Se=V?U:M,me=Fe({},C,{color:r,indeterminate:V,size:ie}),Re=dB(me);return Ne.jsx(pB,Fe({type:"checkbox",inputProps:Fe({"data-indeterminate":V},Z),icon:ue.cloneElement(ne,{fontSize:(_=ne.props.fontSize)!=null?_:ie}),checkedIcon:ue.cloneElement(Se,{fontSize:(w=Se.props.fontSize)!=null?w:ie}),ownerState:me,ref:m,className:oi(Re.root,de)},se,{classes:Re}))});function QS(a){return a.substring(2).toLowerCase()}function yB(a,l){return l.documentElement.clientWidth<a.clientX||l.documentElement.clientHeight<a.clientY}function vB(a){const{children:l,disableReactTree:m=!1,mouseEvent:_="onClick",onClickAway:w,touchEvent:C="onTouchEnd"}=a,M=ue.useRef(!1),r=ue.useRef(null),O=ue.useRef(!1),V=ue.useRef(!1);ue.useEffect(()=>(setTimeout(()=>{O.current=!0},0),()=>{O.current=!1}),[]);const U=Eo(Pf(l),r),Z=Tu(se=>{const ne=V.current;V.current=!1;const Se=pa(r.current);if(!O.current||!r.current||"clientX"in se&&yB(se,Se))return;if(M.current){M.current=!1;return}let me;se.composedPath?me=se.composedPath().indexOf(r.current)>-1:me=!Se.documentElement.contains(se.target)||r.current.contains(se.target),!me&&(m||!ne)&&w(se)}),ie=se=>ne=>{V.current=!0;const Se=l.props[se];Se&&Se(ne)},de={ref:U};return C!==!1&&(de[C]=ie(C)),ue.useEffect(()=>{if(C!==!1){const se=QS(C),ne=pa(r.current),Se=()=>{M.current=!0};return ne.addEventListener(se,Z),ne.addEventListener("touchmove",Se),()=>{ne.removeEventListener(se,Z),ne.removeEventListener("touchmove",Se)}}},[Z,C]),_!==!1&&(de[_]=ie(_)),ue.useEffect(()=>{if(_!==!1){const se=QS(_),ne=pa(r.current);return ne.addEventListener(se,Z),()=>{ne.removeEventListener(se,Z)}}},[Z,_]),Ne.jsx(ue.Fragment,{children:ue.cloneElement(l,de)})}const xB=kD({createStyledComponent:qn("div",{name:"MuiContainer",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,l[`maxWidth${vn(String(m.maxWidth))}`],m.fixed&&l.fixed,m.disableGutters&&l.disableGutters]}}),useThemeProps:a=>vr({props:a,name:"MuiContainer"})}),bB=(a,l)=>Fe({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},l&&!a.vars&&{colorScheme:a.palette.mode}),wB=a=>Fe({color:(a.vars||a).palette.text.primary},a.typography.body1,{backgroundColor:(a.vars||a).palette.background.default,"@media print":{backgroundColor:(a.vars||a).palette.common.white}}),TB=(a,l=!1)=>{var m;const _={};l&&a.colorSchemes&&Object.entries(a.colorSchemes).forEach(([M,r])=>{var O;_[a.getColorSchemeSelector(M).replace(/\s*&/,"")]={colorScheme:(O=r.palette)==null?void 0:O.mode}});let w=Fe({html:bB(a,l),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:a.typography.fontWeightBold},body:Fe({margin:0},wB(a),{"&::backdrop":{backgroundColor:(a.vars||a).palette.background.default}})},_);const C=(m=a.components)==null||(m=m.MuiCssBaseline)==null?void 0:m.styleOverrides;return C&&(w=[w,C]),w};function SB(a){const l=vr({props:a,name:"MuiCssBaseline"}),{children:m,enableColorScheme:_=!1}=l;return Ne.jsxs(ue.Fragment,{children:[Ne.jsx(oE,{styles:w=>TB(w,_)}),m]})}function CB(a){const l=pa(a);return l.body===a?wh(a).innerWidth>l.documentElement.clientWidth:a.scrollHeight>a.clientHeight}function Qg(a,l){l?a.setAttribute("aria-hidden","true"):a.removeAttribute("aria-hidden")}function JS(a){return parseInt(wh(a).getComputedStyle(a).paddingRight,10)||0}function EB(a){const m=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(a.tagName)!==-1,_=a.tagName==="INPUT"&&a.getAttribute("type")==="hidden";return m||_}function eC(a,l,m,_,w){const C=[l,m,..._];[].forEach.call(a.children,M=>{const r=C.indexOf(M)===-1,O=!EB(M);r&&O&&Qg(M,w)})}function Hx(a,l){let m=-1;return a.some((_,w)=>l(_)?(m=w,!0):!1),m}function AB(a,l){const m=[],_=a.container;if(!l.disableScrollLock){if(CB(_)){const M=Q2(pa(_));m.push({value:_.style.paddingRight,property:"padding-right",el:_}),_.style.paddingRight=`${JS(_)+M}px`;const r=pa(_).querySelectorAll(".mui-fixed");[].forEach.call(r,O=>{m.push({value:O.style.paddingRight,property:"padding-right",el:O}),O.style.paddingRight=`${JS(O)+M}px`})}let C;if(_.parentNode instanceof DocumentFragment)C=pa(_).body;else{const M=_.parentElement,r=wh(_);C=(M==null?void 0:M.nodeName)==="HTML"&&r.getComputedStyle(M).overflowY==="scroll"?M:_}m.push({value:C.style.overflow,property:"overflow",el:C},{value:C.style.overflowX,property:"overflow-x",el:C},{value:C.style.overflowY,property:"overflow-y",el:C}),C.style.overflow="hidden"}return()=>{m.forEach(({value:C,el:M,property:r})=>{C?M.style.setProperty(r,C):M.style.removeProperty(r)})}}function IB(a){const l=[];return[].forEach.call(a.children,m=>{m.getAttribute("aria-hidden")==="true"&&l.push(m)}),l}class PB{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(l,m){let _=this.modals.indexOf(l);if(_!==-1)return _;_=this.modals.length,this.modals.push(l),l.modalRef&&Qg(l.modalRef,!1);const w=IB(m);eC(m,l.mount,l.modalRef,w,!0);const C=Hx(this.containers,M=>M.container===m);return C!==-1?(this.containers[C].modals.push(l),_):(this.containers.push({modals:[l],container:m,restore:null,hiddenSiblings:w}),_)}mount(l,m){const _=Hx(this.containers,C=>C.modals.indexOf(l)!==-1),w=this.containers[_];w.restore||(w.restore=AB(w,m))}remove(l,m=!0){const _=this.modals.indexOf(l);if(_===-1)return _;const w=Hx(this.containers,M=>M.modals.indexOf(l)!==-1),C=this.containers[w];if(C.modals.splice(C.modals.indexOf(l),1),this.modals.splice(_,1),C.modals.length===0)C.restore&&C.restore(),l.modalRef&&Qg(l.modalRef,m),eC(C.container,l.mount,l.modalRef,C.hiddenSiblings,!1),this.containers.splice(w,1);else{const M=C.modals[C.modals.length-1];M.modalRef&&Qg(M.modalRef,!1)}return _}isTopModal(l){return this.modals.length>0&&this.modals[this.modals.length-1]===l}}const kB=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function MB(a){const l=parseInt(a.getAttribute("tabindex")||"",10);return Number.isNaN(l)?a.contentEditable==="true"||(a.nodeName==="AUDIO"||a.nodeName==="VIDEO"||a.nodeName==="DETAILS")&&a.getAttribute("tabindex")===null?0:a.tabIndex:l}function RB(a){if(a.tagName!=="INPUT"||a.type!=="radio"||!a.name)return!1;const l=_=>a.ownerDocument.querySelector(`input[type="radio"]${_}`);let m=l(`[name="${a.name}"]:checked`);return m||(m=l(`[name="${a.name}"]`)),m!==a}function zB(a){return!(a.disabled||a.tagName==="INPUT"&&a.type==="hidden"||RB(a))}function LB(a){const l=[],m=[];return Array.from(a.querySelectorAll(kB)).forEach((_,w)=>{const C=MB(_);C===-1||!zB(_)||(C===0?l.push(_):m.push({documentOrder:w,tabIndex:C,node:_}))}),m.sort((_,w)=>_.tabIndex===w.tabIndex?_.documentOrder-w.documentOrder:_.tabIndex-w.tabIndex).map(_=>_.node).concat(l)}function DB(){return!0}function OB(a){const{children:l,disableAutoFocus:m=!1,disableEnforceFocus:_=!1,disableRestoreFocus:w=!1,getTabbable:C=LB,isEnabled:M=DB,open:r}=a,O=ue.useRef(!1),V=ue.useRef(null),U=ue.useRef(null),Z=ue.useRef(null),ie=ue.useRef(null),de=ue.useRef(!1),se=ue.useRef(null),ne=Eo(Pf(l),se),Se=ue.useRef(null);ue.useEffect(()=>{!r||!se.current||(de.current=!m)},[m,r]),ue.useEffect(()=>{if(!r||!se.current)return;const ye=pa(se.current);return se.current.contains(ye.activeElement)||(se.current.hasAttribute("tabIndex")||se.current.setAttribute("tabIndex","-1"),de.current&&se.current.focus()),()=>{w||(Z.current&&Z.current.focus&&(O.current=!0,Z.current.focus()),Z.current=null)}},[r]),ue.useEffect(()=>{if(!r||!se.current)return;const ye=pa(se.current),Le=Ee=>{Se.current=Ee,!(_||!M()||Ee.key!=="Tab")&&ye.activeElement===se.current&&Ee.shiftKey&&(O.current=!0,U.current&&U.current.focus())},De=()=>{const Ee=se.current;if(Ee===null)return;if(!ye.hasFocus()||!M()||O.current){O.current=!1;return}if(Ee.contains(ye.activeElement)||_&&ye.activeElement!==V.current&&ye.activeElement!==U.current)return;if(ye.activeElement!==ie.current)ie.current=null;else if(ie.current!==null)return;if(!de.current)return;let qe=[];if((ye.activeElement===V.current||ye.activeElement===U.current)&&(qe=C(se.current)),qe.length>0){var $e,Ge;const et=!!(($e=Se.current)!=null&&$e.shiftKey&&((Ge=Se.current)==null?void 0:Ge.key)==="Tab"),mt=qe[0],St=qe[qe.length-1];typeof mt!="string"&&typeof St!="string"&&(et?St.focus():mt.focus())}else Ee.focus()};ye.addEventListener("focusin",De),ye.addEventListener("keydown",Le,!0);const Oe=setInterval(()=>{ye.activeElement&&ye.activeElement.tagName==="BODY"&&De()},50);return()=>{clearInterval(Oe),ye.removeEventListener("focusin",De),ye.removeEventListener("keydown",Le,!0)}},[m,_,w,M,r,C]);const me=ye=>{Z.current===null&&(Z.current=ye.relatedTarget),de.current=!0,ie.current=ye.target;const Le=l.props.onFocus;Le&&Le(ye)},Re=ye=>{Z.current===null&&(Z.current=ye.relatedTarget),de.current=!0};return Ne.jsxs(ue.Fragment,{children:[Ne.jsx("div",{tabIndex:r?0:-1,onFocus:Re,ref:V,"data-testid":"sentinelStart"}),ue.cloneElement(l,{ref:ne,onFocus:me}),Ne.jsx("div",{tabIndex:r?0:-1,onFocus:Re,ref:U,"data-testid":"sentinelEnd"})]})}function BB(a){return typeof a=="function"?a():a}function FB(a){return a?a.props.hasOwnProperty("in"):!1}const jB=new PB;function NB(a){const{container:l,disableEscapeKeyDown:m=!1,disableScrollLock:_=!1,manager:w=jB,closeAfterTransition:C=!1,onTransitionEnter:M,onTransitionExited:r,children:O,onClose:V,open:U,rootRef:Z}=a,ie=ue.useRef({}),de=ue.useRef(null),se=ue.useRef(null),ne=Eo(se,Z),[Se,me]=ue.useState(!U),Re=FB(O);let ye=!0;(a["aria-hidden"]==="false"||a["aria-hidden"]===!1)&&(ye=!1);const Le=()=>pa(de.current),De=()=>(ie.current.modalRef=se.current,ie.current.mount=de.current,ie.current),Oe=()=>{w.mount(De(),{disableScrollLock:_}),se.current&&(se.current.scrollTop=0)},Ee=Tu(()=>{const Ct=BB(l)||Le().body;w.add(De(),Ct),se.current&&Oe()}),qe=ue.useCallback(()=>w.isTopModal(De()),[w]),$e=Tu(Ct=>{de.current=Ct,Ct&&(U&&qe()?Oe():se.current&&Qg(se.current,ye))}),Ge=ue.useCallback(()=>{w.remove(De(),ye)},[ye,w]);ue.useEffect(()=>()=>{Ge()},[Ge]),ue.useEffect(()=>{U?Ee():(!Re||!C)&&Ge()},[U,Ge,Re,C,Ee]);const et=Ct=>Ut=>{var at;(at=Ct.onKeyDown)==null||at.call(Ct,Ut),!(Ut.key!=="Escape"||Ut.which===229||!qe())&&(m||(Ut.stopPropagation(),V&&V(Ut,"escapeKeyDown")))},mt=Ct=>Ut=>{var at;(at=Ct.onClick)==null||at.call(Ct,Ut),Ut.target===Ut.currentTarget&&V&&V(Ut,"backdropClick")};return{getRootProps:(Ct={})=>{const Ut=zy(a);delete Ut.onTransitionEnter,delete Ut.onTransitionExited;const at=Fe({},Ut,Ct);return Fe({role:"presentation"},at,{onKeyDown:et(at),ref:ne})},getBackdropProps:(Ct={})=>{const Ut=Ct;return Fe({"aria-hidden":!0},Ut,{onClick:mt(Ut),open:U})},getTransitionProps:()=>{const Ct=()=>{me(!1),M&&M()},Ut=()=>{me(!0),r&&r(),C&&Ge()};return{onEnter:f0(Ct,O==null?void 0:O.props.onEnter),onExited:f0(Ut,O==null?void 0:O.props.onExited)}},rootRef:ne,portalRef:$e,isTopModal:qe,exited:Se,hasTransition:Re}}function VB(a){return dr("MuiModal",a)}rr("MuiModal",["root","hidden","backdrop"]);const qB=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],HB=a=>{const{open:l,exited:m,classes:_}=a;return yr({root:["root",!l&&m&&"hidden"],backdrop:["backdrop"]},VB,_)},UB=qn("div",{name:"MuiModal",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,!m.open&&m.exited&&l.hidden]}})(({theme:a,ownerState:l})=>Fe({position:"fixed",zIndex:(a.vars||a).zIndex.modal,right:0,bottom:0,top:0,left:0},!l.open&&l.exited&&{visibility:"hidden"})),$B=qn(lE,{name:"MuiModal",slot:"Backdrop",overridesResolver:(a,l)=>l.backdrop})({zIndex:-1}),ib=ue.forwardRef(function(l,m){var _,w,C,M,r,O;const V=vr({name:"MuiModal",props:l}),{BackdropComponent:U=$B,BackdropProps:Z,className:ie,closeAfterTransition:de=!1,children:se,container:ne,component:Se,components:me={},componentsProps:Re={},disableAutoFocus:ye=!1,disableEnforceFocus:Le=!1,disableEscapeKeyDown:De=!1,disablePortal:Oe=!1,disableRestoreFocus:Ee=!1,disableScrollLock:qe=!1,hideBackdrop:$e=!1,keepMounted:Ge=!1,onBackdropClick:et,open:mt,slotProps:St,slots:xt}=V,At=Yn(V,qB),Ct=Fe({},V,{closeAfterTransition:de,disableAutoFocus:ye,disableEnforceFocus:Le,disableEscapeKeyDown:De,disablePortal:Oe,disableRestoreFocus:Ee,disableScrollLock:qe,hideBackdrop:$e,keepMounted:Ge}),{getRootProps:Ut,getBackdropProps:at,getTransitionProps:kt,portalRef:qt,isTopModal:lt,exited:Ht,hasTransition:Nn}=NB(Fe({},Ct,{rootRef:m})),zn=Fe({},Ct,{exited:Ht}),xn=HB(zn),An={};if(se.props.tabIndex===void 0&&(An.tabIndex="-1"),Nn){const{onEnter:Vn,onExited:ki}=kt();An.onEnter=Vn,An.onExited=ki}const ti=(_=(w=xt==null?void 0:xt.root)!=null?w:me.Root)!=null?_:UB,Hn=(C=(M=xt==null?void 0:xt.backdrop)!=null?M:me.Backdrop)!=null?C:U,bn=(r=St==null?void 0:St.root)!=null?r:Re.root,Zi=(O=St==null?void 0:St.backdrop)!=null?O:Re.backdrop,Ci=Ef({elementType:ti,externalSlotProps:bn,externalForwardedProps:At,getSlotProps:Ut,additionalProps:{ref:m,as:Se},ownerState:zn,className:oi(ie,bn==null?void 0:bn.className,xn==null?void 0:xn.root,!zn.open&&zn.exited&&(xn==null?void 0:xn.hidden))}),Yi=Ef({elementType:Hn,externalSlotProps:Zi,additionalProps:Z,getSlotProps:Vn=>at(Fe({},Vn,{onClick:ki=>{et&&et(ki),Vn!=null&&Vn.onClick&&Vn.onClick(ki)}})),className:oi(Zi==null?void 0:Zi.className,Z==null?void 0:Z.className,xn==null?void 0:xn.backdrop),ownerState:zn});return!Ge&&!mt&&(!Nn||Ht)?null:Ne.jsx(y3,{ref:qt,container:ne,disablePortal:Oe,children:Ne.jsxs(ti,Fe({},Ci,{children:[!$e&&U?Ne.jsx(Hn,Fe({},Yi)):null,Ne.jsx(OB,{disableEnforceFocus:Le,disableAutoFocus:ye,disableRestoreFocus:Ee,isEnabled:lt,open:mt,children:ue.cloneElement(se,An)})]}))})});function GB(a){return dr("MuiDialog",a)}const Ux=rr("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),uE=ue.createContext({}),WB=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],ZB=qn(lE,{name:"MuiDialog",slot:"Backdrop",overrides:(a,l)=>l.backdrop})({zIndex:-1}),KB=a=>{const{classes:l,scroll:m,maxWidth:_,fullWidth:w,fullScreen:C}=a,M={root:["root"],container:["container",`scroll${vn(m)}`],paper:["paper",`paperScroll${vn(m)}`,`paperWidth${vn(String(_))}`,w&&"paperFullWidth",C&&"paperFullScreen"]};return yr(M,GB,l)},XB=qn(ib,{name:"MuiDialog",slot:"Root",overridesResolver:(a,l)=>l.root})({"@media print":{position:"absolute !important"}}),YB=qn("div",{name:"MuiDialog",slot:"Container",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.container,l[`scroll${vn(m.scroll)}`]]}})(({ownerState:a})=>Fe({height:"100%","@media print":{height:"auto"},outline:0},a.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},a.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),QB=qn(jm,{name:"MuiDialog",slot:"Paper",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.paper,l[`scrollPaper${vn(m.scroll)}`],l[`paperWidth${vn(String(m.maxWidth))}`],m.fullWidth&&l.paperFullWidth,m.fullScreen&&l.paperFullScreen]}})(({theme:a,ownerState:l})=>Fe({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},l.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},l.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!l.maxWidth&&{maxWidth:"calc(100% - 64px)"},l.maxWidth==="xs"&&{maxWidth:a.breakpoints.unit==="px"?Math.max(a.breakpoints.values.xs,444):`max(${a.breakpoints.values.xs}${a.breakpoints.unit}, 444px)`,[`&.${Ux.paperScrollBody}`]:{[a.breakpoints.down(Math.max(a.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},l.maxWidth&&l.maxWidth!=="xs"&&{maxWidth:`${a.breakpoints.values[l.maxWidth]}${a.breakpoints.unit}`,[`&.${Ux.paperScrollBody}`]:{[a.breakpoints.down(a.breakpoints.values[l.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},l.fullWidth&&{width:"calc(100% - 64px)"},l.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${Ux.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),hE=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiDialog"}),w=gl(),C={enter:w.transitions.duration.enteringScreen,exit:w.transitions.duration.leavingScreen},{"aria-describedby":M,"aria-labelledby":r,BackdropComponent:O,BackdropProps:V,children:U,className:Z,disableEscapeKeyDown:ie=!1,fullScreen:de=!1,fullWidth:se=!1,maxWidth:ne="sm",onBackdropClick:Se,onClick:me,onClose:Re,open:ye,PaperComponent:Le=jm,PaperProps:De={},scroll:Oe="paper",TransitionComponent:Ee=aE,transitionDuration:qe=C,TransitionProps:$e}=_,Ge=Yn(_,WB),et=Fe({},_,{disableEscapeKeyDown:ie,fullScreen:de,fullWidth:se,maxWidth:ne,scroll:Oe}),mt=KB(et),St=ue.useRef(),xt=at=>{St.current=at.target===at.currentTarget},At=at=>{me&&me(at),St.current&&(St.current=null,Se&&Se(at),Re&&Re(at,"backdropClick"))},Ct=iv(r),Ut=ue.useMemo(()=>({titleId:Ct}),[Ct]);return Ne.jsx(XB,Fe({className:oi(mt.root,Z),closeAfterTransition:!0,components:{Backdrop:ZB},componentsProps:{backdrop:Fe({transitionDuration:qe,as:O},V)},disableEscapeKeyDown:ie,onClose:Re,open:ye,ref:m,onClick:At,ownerState:et},Ge,{children:Ne.jsx(Ee,Fe({appear:!0,in:ye,timeout:qe,role:"presentation"},$e,{children:Ne.jsx(YB,{className:oi(mt.container),onMouseDown:xt,ownerState:et,children:Ne.jsx(QB,Fe({as:Le,elevation:24,role:"dialog","aria-describedby":M,"aria-labelledby":Ct},De,{className:oi(mt.paper,De.className),ownerState:et,children:Ne.jsx(uE.Provider,{value:Ut,children:U})}))})}))}))});function JB(a){return dr("MuiDialogActions",a)}rr("MuiDialogActions",["root","spacing"]);const eF=["className","disableSpacing"],tF=a=>{const{classes:l,disableSpacing:m}=a;return yr({root:["root",!m&&"spacing"]},JB,l)},nF=qn("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,!m.disableSpacing&&l.spacing]}})(({ownerState:a})=>Fe({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!a.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),dE=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiDialogActions"}),{className:w,disableSpacing:C=!1}=_,M=Yn(_,eF),r=Fe({},_,{disableSpacing:C}),O=tF(r);return Ne.jsx(nF,Fe({className:oi(O.root,w),ownerState:r,ref:m},M))});function iF(a){return dr("MuiDialogContent",a)}rr("MuiDialogContent",["root","dividers"]);function rF(a){return dr("MuiDialogTitle",a)}const sF=rr("MuiDialogTitle",["root"]),oF=["className","dividers"],aF=a=>{const{classes:l,dividers:m}=a;return yr({root:["root",m&&"dividers"]},iF,l)},lF=qn("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,m.dividers&&l.dividers]}})(({theme:a,ownerState:l})=>Fe({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},l.dividers?{padding:"16px 24px",borderTop:`1px solid ${(a.vars||a).palette.divider}`,borderBottom:`1px solid ${(a.vars||a).palette.divider}`}:{[`.${sF.root} + &`]:{paddingTop:0}})),pE=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiDialogContent"}),{className:w,dividers:C=!1}=_,M=Yn(_,oF),r=Fe({},_,{dividers:C}),O=aF(r);return Ne.jsx(lF,Fe({className:oi(O.root,w),ownerState:r,ref:m},M))}),cF=["className","id"],uF=a=>{const{classes:l}=a;return yr({root:["root"]},rF,l)},hF=qn(na,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(a,l)=>l.root})({padding:"16px 24px",flex:"0 0 auto"}),fE=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiDialogTitle"}),{className:w,id:C}=_,M=Yn(_,cF),r=_,O=uF(r),{titleId:V=C}=ue.useContext(uE);return Ne.jsx(hF,Fe({component:"h2",className:oi(O.root,w),ownerState:r,ref:m,variant:"h6",id:C??V},M))});function dF(a){return dr("MuiDivider",a)}const tC=rr("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),pF=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],fF=a=>{const{absolute:l,children:m,classes:_,flexItem:w,light:C,orientation:M,textAlign:r,variant:O}=a;return yr({root:["root",l&&"absolute",O,C&&"light",M==="vertical"&&"vertical",w&&"flexItem",m&&"withChildren",m&&M==="vertical"&&"withChildrenVertical",r==="right"&&M!=="vertical"&&"textAlignRight",r==="left"&&M!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",M==="vertical"&&"wrapperVertical"]},dF,_)},mF=qn("div",{name:"MuiDivider",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,m.absolute&&l.absolute,l[m.variant],m.light&&l.light,m.orientation==="vertical"&&l.vertical,m.flexItem&&l.flexItem,m.children&&l.withChildren,m.children&&m.orientation==="vertical"&&l.withChildrenVertical,m.textAlign==="right"&&m.orientation!=="vertical"&&l.textAlignRight,m.textAlign==="left"&&m.orientation!=="vertical"&&l.textAlignLeft]}})(({theme:a,ownerState:l})=>Fe({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(a.vars||a).palette.divider,borderBottomWidth:"thin"},l.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},l.light&&{borderColor:a.vars?`rgba(${a.vars.palette.dividerChannel} / 0.08)`:os.alpha(a.palette.divider,.08)},l.variant==="inset"&&{marginLeft:72},l.variant==="middle"&&l.orientation==="horizontal"&&{marginLeft:a.spacing(2),marginRight:a.spacing(2)},l.variant==="middle"&&l.orientation==="vertical"&&{marginTop:a.spacing(1),marginBottom:a.spacing(1)},l.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},l.flexItem&&{alignSelf:"stretch",height:"auto"}),({ownerState:a})=>Fe({},a.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}),({theme:a,ownerState:l})=>Fe({},l.children&&l.orientation!=="vertical"&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(a.vars||a).palette.divider}`,borderTopStyle:"inherit"}}),({theme:a,ownerState:l})=>Fe({},l.children&&l.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(a.vars||a).palette.divider}`,borderLeftStyle:"inherit"}}),({ownerState:a})=>Fe({},a.textAlign==="right"&&a.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},a.textAlign==="left"&&a.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),gF=qn("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.wrapper,m.orientation==="vertical"&&l.wrapperVertical]}})(({theme:a,ownerState:l})=>Fe({display:"inline-block",paddingLeft:`calc(${a.spacing(1)} * 1.2)`,paddingRight:`calc(${a.spacing(1)} * 1.2)`},l.orientation==="vertical"&&{paddingTop:`calc(${a.spacing(1)} * 1.2)`,paddingBottom:`calc(${a.spacing(1)} * 1.2)`})),rb=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiDivider"}),{absolute:w=!1,children:C,className:M,component:r=C?"div":"hr",flexItem:O=!1,light:V=!1,orientation:U="horizontal",role:Z=r!=="hr"?"separator":void 0,textAlign:ie="center",variant:de="fullWidth"}=_,se=Yn(_,pF),ne=Fe({},_,{absolute:w,component:r,flexItem:O,light:V,orientation:U,role:Z,textAlign:ie,variant:de}),Se=fF(ne);return Ne.jsx(mF,Fe({as:r,className:oi(Se.root,M),role:Z,ref:m,ownerState:ne},se,{children:C?Ne.jsx(gF,{className:Se.wrapper,ownerState:ne,children:C}):null}))});rb.muiSkipListHighlight=!0;const _F=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function yF(a,l,m){const _=l.getBoundingClientRect(),w=m&&m.getBoundingClientRect(),C=wh(l);let M;if(l.fakeTransform)M=l.fakeTransform;else{const V=C.getComputedStyle(l);M=V.getPropertyValue("-webkit-transform")||V.getPropertyValue("transform")}let r=0,O=0;if(M&&M!=="none"&&typeof M=="string"){const V=M.split("(")[1].split(")")[0].split(",");r=parseInt(V[4],10),O=parseInt(V[5],10)}return a==="left"?w?`translateX(${w.right+r-_.left}px)`:`translateX(${C.innerWidth+r-_.left}px)`:a==="right"?w?`translateX(-${_.right-w.left-r}px)`:`translateX(-${_.left+_.width-r}px)`:a==="up"?w?`translateY(${w.bottom+O-_.top}px)`:`translateY(${C.innerHeight+O-_.top}px)`:w?`translateY(-${_.top-w.top+_.height-O}px)`:`translateY(-${_.top+_.height-O}px)`}function vF(a){return typeof a=="function"?a():a}function my(a,l,m){const _=vF(m),w=yF(a,l,_);w&&(l.style.webkitTransform=w,l.style.transform=w)}const xF=ue.forwardRef(function(l,m){const _=gl(),w={enter:_.transitions.easing.easeOut,exit:_.transitions.easing.sharp},C={enter:_.transitions.duration.enteringScreen,exit:_.transitions.duration.leavingScreen},{addEndListener:M,appear:r=!0,children:O,container:V,direction:U="down",easing:Z=w,in:ie,onEnter:de,onEntered:se,onEntering:ne,onExit:Se,onExited:me,onExiting:Re,style:ye,timeout:Le=C,TransitionComponent:De=Su}=l,Oe=Yn(l,_F),Ee=ue.useRef(null),qe=Eo(Pf(O),Ee,m),$e=at=>kt=>{at&&(kt===void 0?at(Ee.current):at(Ee.current,kt))},Ge=$e((at,kt)=>{my(U,at,V),J0(at),de&&de(at,kt)}),et=$e((at,kt)=>{const qt=Pm({timeout:Le,style:ye,easing:Z},{mode:"enter"});at.style.webkitTransition=_.transitions.create("-webkit-transform",Fe({},qt)),at.style.transition=_.transitions.create("transform",Fe({},qt)),at.style.webkitTransform="none",at.style.transform="none",ne&&ne(at,kt)}),mt=$e(se),St=$e(Re),xt=$e(at=>{const kt=Pm({timeout:Le,style:ye,easing:Z},{mode:"exit"});at.style.webkitTransition=_.transitions.create("-webkit-transform",kt),at.style.transition=_.transitions.create("transform",kt),my(U,at,V),Se&&Se(at)}),At=$e(at=>{at.style.webkitTransition="",at.style.transition="",me&&me(at)}),Ct=at=>{M&&M(Ee.current,at)},Ut=ue.useCallback(()=>{Ee.current&&my(U,Ee.current,V)},[U,V]);return ue.useEffect(()=>{if(ie||U==="down"||U==="right")return;const at=nv(()=>{Ee.current&&my(U,Ee.current,V)}),kt=wh(Ee.current);return kt.addEventListener("resize",at),()=>{at.clear(),kt.removeEventListener("resize",at)}},[U,ie,V]),ue.useEffect(()=>{ie||Ut()},[ie,Ut]),Ne.jsx(De,Fe({nodeRef:Ee,onEnter:Ge,onEntered:mt,onEntering:et,onExit:xt,onExited:At,onExiting:St,addEndListener:Ct,appear:r,in:ie,timeout:Le},Oe,{children:(at,kt)=>ue.cloneElement(O,Fe({ref:qe,style:Fe({visibility:at==="exited"&&!ie?"hidden":void 0},ye,O.props.style)},kt))}))});function bF(a){return dr("MuiDrawer",a)}rr("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const wF=["BackdropProps"],TF=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],mE=(a,l)=>{const{ownerState:m}=a;return[l.root,(m.variant==="permanent"||m.variant==="persistent")&&l.docked,l.modal]},SF=a=>{const{classes:l,anchor:m,variant:_}=a,w={root:["root"],docked:[(_==="permanent"||_==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${vn(m)}`,_!=="temporary"&&`paperAnchorDocked${vn(m)}`]};return yr(w,bF,l)},CF=qn(ib,{name:"MuiDrawer",slot:"Root",overridesResolver:mE})(({theme:a})=>({zIndex:(a.vars||a).zIndex.drawer})),nC=qn("div",{shouldForwardProp:Na,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:mE})({flex:"0 0 auto"}),EF=qn(jm,{name:"MuiDrawer",slot:"Paper",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.paper,l[`paperAnchor${vn(m.anchor)}`],m.variant!=="temporary"&&l[`paperAnchorDocked${vn(m.anchor)}`]]}})(({theme:a,ownerState:l})=>Fe({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(a.vars||a).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},l.anchor==="left"&&{left:0},l.anchor==="top"&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},l.anchor==="right"&&{right:0},l.anchor==="bottom"&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},l.anchor==="left"&&l.variant!=="temporary"&&{borderRight:`1px solid ${(a.vars||a).palette.divider}`},l.anchor==="top"&&l.variant!=="temporary"&&{borderBottom:`1px solid ${(a.vars||a).palette.divider}`},l.anchor==="right"&&l.variant!=="temporary"&&{borderLeft:`1px solid ${(a.vars||a).palette.divider}`},l.anchor==="bottom"&&l.variant!=="temporary"&&{borderTop:`1px solid ${(a.vars||a).palette.divider}`})),gE={left:"right",right:"left",top:"down",bottom:"up"};function AF(a){return["left","right"].indexOf(a)!==-1}function IF({direction:a},l){return a==="rtl"&&AF(l)?gE[l]:l}const _E=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiDrawer"}),w=gl(),C=nE(),M={enter:w.transitions.duration.enteringScreen,exit:w.transitions.duration.leavingScreen},{anchor:r="left",BackdropProps:O,children:V,className:U,elevation:Z=16,hideBackdrop:ie=!1,ModalProps:{BackdropProps:de}={},onClose:se,open:ne=!1,PaperProps:Se={},SlideProps:me,TransitionComponent:Re=xF,transitionDuration:ye=M,variant:Le="temporary"}=_,De=Yn(_.ModalProps,wF),Oe=Yn(_,TF),Ee=ue.useRef(!1);ue.useEffect(()=>{Ee.current=!0},[]);const qe=IF({direction:C?"rtl":"ltr"},r),Ge=Fe({},_,{anchor:r,elevation:Z,open:ne,variant:Le},Oe),et=SF(Ge),mt=Ne.jsx(EF,Fe({elevation:Le==="temporary"?Z:0,square:!0},Se,{className:oi(et.paper,Se.className),ownerState:Ge,children:V}));if(Le==="permanent")return Ne.jsx(nC,Fe({className:oi(et.root,et.docked,U),ownerState:Ge,ref:m},Oe,{children:mt}));const St=Ne.jsx(Re,Fe({in:ne,direction:gE[qe],timeout:ye,appear:Ee.current},me,{children:mt}));return Le==="persistent"?Ne.jsx(nC,Fe({className:oi(et.root,et.docked,U),ownerState:Ge,ref:m},Oe,{children:St})):Ne.jsx(CF,Fe({BackdropProps:Fe({},O,de,{transitionDuration:ye}),className:oi(et.root,et.modal,U),open:ne,ownerState:Ge,onClose:se,hideBackdrop:ie,ref:m},Oe,De,{children:St}))}),PF=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],kF=a=>{const{classes:l,disableUnderline:m}=a,w=yr({root:["root",!m&&"underline"],input:["input"]},B3,l);return Fe({},l,w)},MF=qn(cv,{shouldForwardProp:a=>Na(a)||a==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[...av(a,l),!m.disableUnderline&&l.underline]}})(({theme:a,ownerState:l})=>{var m;const _=a.palette.mode==="light",w=_?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",C=_?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",M=_?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",r=_?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return Fe({position:"relative",backgroundColor:a.vars?a.vars.palette.FilledInput.bg:C,borderTopLeftRadius:(a.vars||a).shape.borderRadius,borderTopRightRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create("background-color",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),"&:hover":{backgroundColor:a.vars?a.vars.palette.FilledInput.hoverBg:M,"@media (hover: none)":{backgroundColor:a.vars?a.vars.palette.FilledInput.bg:C}},[`&.${yf.focused}`]:{backgroundColor:a.vars?a.vars.palette.FilledInput.bg:C},[`&.${yf.disabled}`]:{backgroundColor:a.vars?a.vars.palette.FilledInput.disabledBg:r}},!l.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(m=(a.vars||a).palette[l.color||"primary"])==null?void 0:m.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${yf.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${yf.error}`]:{"&::before, &::after":{borderBottomColor:(a.vars||a).palette.error.main}},"&::before":{borderBottom:`1px solid ${a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / ${a.vars.opacity.inputUnderline})`:w}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:a.transitions.create("border-bottom-color",{duration:a.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${yf.disabled}, .${yf.error}):before`]:{borderBottom:`1px solid ${(a.vars||a).palette.text.primary}`},[`&.${yf.disabled}:before`]:{borderBottomStyle:"dotted"}},l.startAdornment&&{paddingLeft:12},l.endAdornment&&{paddingRight:12},l.multiline&&Fe({padding:"25px 12px 8px"},l.size==="small"&&{paddingTop:21,paddingBottom:4},l.hiddenLabel&&{paddingTop:16,paddingBottom:17},l.hiddenLabel&&l.size==="small"&&{paddingTop:8,paddingBottom:9}))}),RF=qn(uv,{name:"MuiFilledInput",slot:"Input",overridesResolver:lv})(({theme:a,ownerState:l})=>Fe({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!a.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:a.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:a.palette.mode==="light"?null:"#fff",caretColor:a.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},a.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[a.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},l.size==="small"&&{paddingTop:21,paddingBottom:4},l.hiddenLabel&&{paddingTop:16,paddingBottom:17},l.startAdornment&&{paddingLeft:0},l.endAdornment&&{paddingRight:0},l.hiddenLabel&&l.size==="small"&&{paddingTop:8,paddingBottom:9},l.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),yE=ue.forwardRef(function(l,m){var _,w,C,M;const r=vr({props:l,name:"MuiFilledInput"}),{components:O={},componentsProps:V,fullWidth:U=!1,inputComponent:Z="input",multiline:ie=!1,slotProps:de,slots:se={},type:ne="text"}=r,Se=Yn(r,PF),me=Fe({},r,{fullWidth:U,inputComponent:Z,multiline:ie,type:ne}),Re=kF(r),ye={root:{ownerState:me},input:{ownerState:me}},Le=de??V?ja(ye,de??V):ye,De=(_=(w=se.root)!=null?w:O.Root)!=null?_:MF,Oe=(C=(M=se.input)!=null?M:O.Input)!=null?C:RF;return Ne.jsx(tb,Fe({slots:{root:De,input:Oe},componentsProps:Le,fullWidth:U,inputComponent:Z,multiline:ie,ref:m,type:ne},Se,{classes:Re}))});yE.muiName="Input";function zF(a){return dr("MuiFormControl",a)}rr("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const LF=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],DF=a=>{const{classes:l,margin:m,fullWidth:_}=a,w={root:["root",m!=="none"&&`margin${vn(m)}`,_&&"fullWidth"]};return yr(w,zF,l)},OF=qn("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:a},l)=>Fe({},l.root,l[`margin${vn(a.margin)}`],a.fullWidth&&l.fullWidth)})(({ownerState:a})=>Fe({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},a.margin==="normal"&&{marginTop:16,marginBottom:8},a.margin==="dense"&&{marginTop:8,marginBottom:4},a.fullWidth&&{width:"100%"})),vE=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiFormControl"}),{children:w,className:C,color:M="primary",component:r="div",disabled:O=!1,error:V=!1,focused:U,fullWidth:Z=!1,hiddenLabel:ie=!1,margin:de="none",required:se=!1,size:ne="medium",variant:Se="outlined"}=_,me=Yn(_,LF),Re=Fe({},_,{color:M,component:r,disabled:O,error:V,fullWidth:Z,hiddenLabel:ie,margin:de,required:se,size:ne,variant:Se}),ye=DF(Re),[Le,De]=ue.useState(()=>{let St=!1;return w&&ue.Children.forEach(w,xt=>{if(!Ty(xt,["Input","Select"]))return;const At=Ty(xt,["Select"])?xt.props.input:xt;At&&k3(At.props)&&(St=!0)}),St}),[Oe,Ee]=ue.useState(()=>{let St=!1;return w&&ue.Children.forEach(w,xt=>{Ty(xt,["Input","Select"])&&(Dy(xt.props,!0)||Dy(xt.props.inputProps,!0))&&(St=!0)}),St}),[qe,$e]=ue.useState(!1);O&&qe&&$e(!1);const Ge=U!==void 0&&!O?U:qe;let et;const mt=ue.useMemo(()=>({adornedStart:Le,setAdornedStart:De,color:M,disabled:O,error:V,filled:Oe,focused:Ge,fullWidth:Z,hiddenLabel:ie,size:ne,onBlur:()=>{$e(!1)},onEmpty:()=>{Ee(!1)},onFilled:()=>{Ee(!0)},onFocus:()=>{$e(!0)},registerEffect:et,required:se,variant:Se}),[Le,M,O,V,Oe,Ge,Z,ie,et,se,ne,Se]);return Ne.jsx(eb.Provider,{value:mt,children:Ne.jsx(OF,Fe({as:r,ownerState:Re,className:oi(ye.root,C),ref:m},me,{children:w}))})}),Rm=FD({createStyledComponent:qn("div",{name:"MuiStack",slot:"Root",overridesResolver:(a,l)=>l.root}),useThemeProps:a=>vr({props:a,name:"MuiStack"})});function BF(a){return dr("MuiFormControlLabel",a)}const Xg=rr("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),FF=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],jF=a=>{const{classes:l,disabled:m,labelPlacement:_,error:w,required:C}=a,M={root:["root",m&&"disabled",`labelPlacement${vn(_)}`,w&&"error",C&&"required"],label:["label",m&&"disabled"],asterisk:["asterisk",w&&"error"]};return yr(M,BF,l)},NF=qn("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[{[`& .${Xg.label}`]:l.label},l.root,l[`labelPlacement${vn(m.labelPlacement)}`]]}})(({theme:a,ownerState:l})=>Fe({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${Xg.disabled}`]:{cursor:"default"}},l.labelPlacement==="start"&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},l.labelPlacement==="top"&&{flexDirection:"column-reverse",marginLeft:16},l.labelPlacement==="bottom"&&{flexDirection:"column",marginLeft:16},{[`& .${Xg.label}`]:{[`&.${Xg.disabled}`]:{color:(a.vars||a).palette.text.disabled}}})),VF=qn("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(a,l)=>l.asterisk})(({theme:a})=>({[`&.${Xg.error}`]:{color:(a.vars||a).palette.error.main}})),qF=ue.forwardRef(function(l,m){var _,w;const C=vr({props:l,name:"MuiFormControlLabel"}),{className:M,componentsProps:r={},control:O,disabled:V,disableTypography:U,label:Z,labelPlacement:ie="end",required:de,slotProps:se={}}=C,ne=Yn(C,FF),Se=Ap(),me=(_=V??O.props.disabled)!=null?_:Se==null?void 0:Se.disabled,Re=de??O.props.required,ye={disabled:me,required:Re};["checked","name","onChange","value","inputRef"].forEach($e=>{typeof O.props[$e]>"u"&&typeof C[$e]<"u"&&(ye[$e]=C[$e])});const Le=kf({props:C,muiFormControl:Se,states:["error"]}),De=Fe({},C,{disabled:me,labelPlacement:ie,required:Re,error:Le.error}),Oe=jF(De),Ee=(w=se.typography)!=null?w:r.typography;let qe=Z;return qe!=null&&qe.type!==na&&!U&&(qe=Ne.jsx(na,Fe({component:"span"},Ee,{className:oi(Oe.label,Ee==null?void 0:Ee.className),children:qe}))),Ne.jsxs(NF,Fe({className:oi(Oe.root,M),ownerState:De,ref:m},ne,{children:[ue.cloneElement(O,ye),Re?Ne.jsxs(Rm,{display:"block",children:[qe,Ne.jsxs(VF,{ownerState:De,"aria-hidden":!0,className:Oe.asterisk,children:["","*"]})]}):qe]}))});function HF(a){return dr("MuiFormGroup",a)}rr("MuiFormGroup",["root","row","error"]);const UF=["className","row"],$F=a=>{const{classes:l,row:m,error:_}=a;return yr({root:["root",m&&"row",_&&"error"]},HF,l)},GF=qn("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,m.row&&l.row]}})(({ownerState:a})=>Fe({display:"flex",flexDirection:"column",flexWrap:"wrap"},a.row&&{flexDirection:"row"})),WF=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiFormGroup"}),{className:w,row:C=!1}=_,M=Yn(_,UF),r=Ap(),O=kf({props:_,muiFormControl:r,states:["error"]}),V=Fe({},_,{row:C,error:O.error}),U=$F(V);return Ne.jsx(GF,Fe({className:oi(U.root,w),ownerState:V,ref:m},M))});function ZF(a){return dr("MuiFormLabel",a)}const Jg=rr("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),KF=["children","className","color","component","disabled","error","filled","focused","required"],XF=a=>{const{classes:l,color:m,focused:_,disabled:w,error:C,filled:M,required:r}=a,O={root:["root",`color${vn(m)}`,w&&"disabled",C&&"error",M&&"filled",_&&"focused",r&&"required"],asterisk:["asterisk",C&&"error"]};return yr(O,ZF,l)},YF=qn("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:a},l)=>Fe({},l.root,a.color==="secondary"&&l.colorSecondary,a.filled&&l.filled)})(({theme:a,ownerState:l})=>Fe({color:(a.vars||a).palette.text.secondary},a.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${Jg.focused}`]:{color:(a.vars||a).palette[l.color].main},[`&.${Jg.disabled}`]:{color:(a.vars||a).palette.text.disabled},[`&.${Jg.error}`]:{color:(a.vars||a).palette.error.main}})),QF=qn("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(a,l)=>l.asterisk})(({theme:a})=>({[`&.${Jg.error}`]:{color:(a.vars||a).palette.error.main}})),JF=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiFormLabel"}),{children:w,className:C,component:M="label"}=_,r=Yn(_,KF),O=Ap(),V=kf({props:_,muiFormControl:O,states:["color","required","focused","disabled","error","filled"]}),U=Fe({},_,{color:V.color||"primary",component:M,disabled:V.disabled,error:V.error,filled:V.filled,focused:V.focused,required:V.required}),Z=XF(U);return Ne.jsxs(YF,Fe({as:M,ownerState:U,className:oi(Z.root,C),ref:m},r,{children:[w,V.required&&Ne.jsxs(QF,{ownerState:U,"aria-hidden":!0,className:Z.asterisk,children:["","*"]})]}))}),iC=ue.createContext();function ej(a){return dr("MuiGrid",a)}const tj=[0,1,2,3,4,5,6,7,8,9,10],nj=["column-reverse","column","row-reverse","row"],ij=["nowrap","wrap-reverse","wrap"],Lg=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],c_=rr("MuiGrid",["root","container","item","zeroMinWidth",...tj.map(a=>`spacing-xs-${a}`),...nj.map(a=>`direction-xs-${a}`),...ij.map(a=>`wrap-xs-${a}`),...Lg.map(a=>`grid-xs-${a}`),...Lg.map(a=>`grid-sm-${a}`),...Lg.map(a=>`grid-md-${a}`),...Lg.map(a=>`grid-lg-${a}`),...Lg.map(a=>`grid-xl-${a}`)]),rj=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function Tm(a){const l=parseFloat(a);return`${l}${String(a).replace(String(l),"")||"px"}`}function sj({theme:a,ownerState:l}){let m;return a.breakpoints.keys.reduce((_,w)=>{let C={};if(l[w]&&(m=l[w]),!m)return _;if(m===!0)C={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(m==="auto")C={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const M=Tf({values:l.columns,breakpoints:a.breakpoints.values}),r=typeof M=="object"?M[w]:M;if(r==null)return _;const O=`${Math.round(m/r*1e8)/1e6}%`;let V={};if(l.container&&l.item&&l.columnSpacing!==0){const U=a.spacing(l.columnSpacing);if(U!=="0px"){const Z=`calc(${O} + ${Tm(U)})`;V={flexBasis:Z,maxWidth:Z}}}C=Fe({flexBasis:O,flexGrow:0,maxWidth:O},V)}return a.breakpoints.values[w]===0?Object.assign(_,C):_[a.breakpoints.up(w)]=C,_},{})}function oj({theme:a,ownerState:l}){const m=Tf({values:l.direction,breakpoints:a.breakpoints.values});return ml({theme:a},m,_=>{const w={flexDirection:_};return _.indexOf("column")===0&&(w[`& > .${c_.item}`]={maxWidth:"none"}),w})}function xE({breakpoints:a,values:l}){let m="";Object.keys(l).forEach(w=>{m===""&&l[w]!==0&&(m=w)});const _=Object.keys(a).sort((w,C)=>a[w]-a[C]);return _.slice(0,_.indexOf(m))}function aj({theme:a,ownerState:l}){const{container:m,rowSpacing:_}=l;let w={};if(m&&_!==0){const C=Tf({values:_,breakpoints:a.breakpoints.values});let M;typeof C=="object"&&(M=xE({breakpoints:a.breakpoints.values,values:C})),w=ml({theme:a},C,(r,O)=>{var V;const U=a.spacing(r);return U!=="0px"?{marginTop:`-${Tm(U)}`,[`& > .${c_.item}`]:{paddingTop:Tm(U)}}:(V=M)!=null&&V.includes(O)?{}:{marginTop:0,[`& > .${c_.item}`]:{paddingTop:0}}})}return w}function lj({theme:a,ownerState:l}){const{container:m,columnSpacing:_}=l;let w={};if(m&&_!==0){const C=Tf({values:_,breakpoints:a.breakpoints.values});let M;typeof C=="object"&&(M=xE({breakpoints:a.breakpoints.values,values:C})),w=ml({theme:a},C,(r,O)=>{var V;const U=a.spacing(r);return U!=="0px"?{width:`calc(100% + ${Tm(U)})`,marginLeft:`-${Tm(U)}`,[`& > .${c_.item}`]:{paddingLeft:Tm(U)}}:(V=M)!=null&&V.includes(O)?{}:{width:"100%",marginLeft:0,[`& > .${c_.item}`]:{paddingLeft:0}}})}return w}function cj(a,l,m={}){if(!a||a<=0)return[];if(typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number")return[m[`spacing-xs-${String(a)}`]];const _=[];return l.forEach(w=>{const C=a[w];Number(C)>0&&_.push(m[`spacing-${w}-${String(C)}`])}),_}const uj=qn("div",{name:"MuiGrid",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a,{container:_,direction:w,item:C,spacing:M,wrap:r,zeroMinWidth:O,breakpoints:V}=m;let U=[];_&&(U=cj(M,V,l));const Z=[];return V.forEach(ie=>{const de=m[ie];de&&Z.push(l[`grid-${ie}-${String(de)}`])}),[l.root,_&&l.container,C&&l.item,O&&l.zeroMinWidth,...U,w!=="row"&&l[`direction-xs-${String(w)}`],r!=="wrap"&&l[`wrap-xs-${String(r)}`],...Z]}})(({ownerState:a})=>Fe({boxSizing:"border-box"},a.container&&{display:"flex",flexWrap:"wrap",width:"100%"},a.item&&{margin:0},a.zeroMinWidth&&{minWidth:0},a.wrap!=="wrap"&&{flexWrap:a.wrap}),oj,aj,lj,sj);function hj(a,l){if(!a||a<=0)return[];if(typeof a=="string"&&!Number.isNaN(Number(a))||typeof a=="number")return[`spacing-xs-${String(a)}`];const m=[];return l.forEach(_=>{const w=a[_];if(Number(w)>0){const C=`spacing-${_}-${String(w)}`;m.push(C)}}),m}const dj=a=>{const{classes:l,container:m,direction:_,item:w,spacing:C,wrap:M,zeroMinWidth:r,breakpoints:O}=a;let V=[];m&&(V=hj(C,O));const U=[];O.forEach(ie=>{const de=a[ie];de&&U.push(`grid-${ie}-${String(de)}`)});const Z={root:["root",m&&"container",w&&"item",r&&"zeroMinWidth",...V,_!=="row"&&`direction-xs-${String(_)}`,M!=="wrap"&&`wrap-xs-${String(M)}`,...U]};return yr(Z,ej,l)},rC=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiGrid"}),{breakpoints:w}=gl(),C=__(_),{className:M,columns:r,columnSpacing:O,component:V="div",container:U=!1,direction:Z="row",item:ie=!1,rowSpacing:de,spacing:se=0,wrap:ne="wrap",zeroMinWidth:Se=!1}=C,me=Yn(C,rj),Re=de||se,ye=O||se,Le=ue.useContext(iC),De=U?r||12:Le,Oe={},Ee=Fe({},me);w.keys.forEach(Ge=>{me[Ge]!=null&&(Oe[Ge]=me[Ge],delete Ee[Ge])});const qe=Fe({},C,{columns:De,container:U,direction:Z,item:ie,rowSpacing:Re,columnSpacing:ye,wrap:ne,zeroMinWidth:Se,spacing:se},Oe,{breakpoints:w.keys}),$e=dj(qe);return Ne.jsx(iC.Provider,{value:De,children:Ne.jsx(uj,Fe({ownerState:qe,className:oi($e.root,M),as:V,ref:m},Ee))})}),pj=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function x0(a){return`scale(${a}, ${a**2})`}const fj={entering:{opacity:1,transform:x0(1)},entered:{opacity:1,transform:"none"}},$x=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),sb=ue.forwardRef(function(l,m){const{addEndListener:_,appear:w=!0,children:C,easing:M,in:r,onEnter:O,onEntered:V,onEntering:U,onExit:Z,onExited:ie,onExiting:de,style:se,timeout:ne="auto",TransitionComponent:Se=Su}=l,me=Yn(l,pj),Re=W0(),ye=ue.useRef(),Le=gl(),De=ue.useRef(null),Oe=Eo(De,Pf(C),m),Ee=At=>Ct=>{if(At){const Ut=De.current;Ct===void 0?At(Ut):At(Ut,Ct)}},qe=Ee(U),$e=Ee((At,Ct)=>{J0(At);const{duration:Ut,delay:at,easing:kt}=Pm({style:se,timeout:ne,easing:M},{mode:"enter"});let qt;ne==="auto"?(qt=Le.transitions.getAutoHeightDuration(At.clientHeight),ye.current=qt):qt=Ut,At.style.transition=[Le.transitions.create("opacity",{duration:qt,delay:at}),Le.transitions.create("transform",{duration:$x?qt:qt*.666,delay:at,easing:kt})].join(","),O&&O(At,Ct)}),Ge=Ee(V),et=Ee(de),mt=Ee(At=>{const{duration:Ct,delay:Ut,easing:at}=Pm({style:se,timeout:ne,easing:M},{mode:"exit"});let kt;ne==="auto"?(kt=Le.transitions.getAutoHeightDuration(At.clientHeight),ye.current=kt):kt=Ct,At.style.transition=[Le.transitions.create("opacity",{duration:kt,delay:Ut}),Le.transitions.create("transform",{duration:$x?kt:kt*.666,delay:$x?Ut:Ut||kt*.333,easing:at})].join(","),At.style.opacity=0,At.style.transform=x0(.75),Z&&Z(At)}),St=Ee(ie),xt=At=>{ne==="auto"&&Re.start(ye.current||0,At),_&&_(De.current,At)};return Ne.jsx(Se,Fe({appear:w,in:r,nodeRef:De,onEnter:$e,onEntered:Ge,onEntering:qe,onExit:mt,onExited:St,onExiting:et,addEndListener:xt,timeout:ne==="auto"?null:ne},me,{children:(At,Ct)=>ue.cloneElement(C,Fe({style:Fe({opacity:0,transform:x0(.75),visibility:At==="exited"&&!r?"hidden":void 0},fj[At],se,C.props.style),ref:Oe},Ct))}))});sb.muiSupportAuto=!0;const mj=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],gj=a=>{const{classes:l,disableUnderline:m}=a,w=yr({root:["root",!m&&"underline"],input:["input"]},D3,l);return Fe({},l,w)},_j=qn(cv,{shouldForwardProp:a=>Na(a)||a==="classes",name:"MuiInput",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[...av(a,l),!m.disableUnderline&&l.underline]}})(({theme:a,ownerState:l})=>{let _=a.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return a.vars&&(_=`rgba(${a.vars.palette.common.onBackgroundChannel} / ${a.vars.opacity.inputUnderline})`),Fe({position:"relative"},l.formControl&&{"label + &":{marginTop:16}},!l.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(a.vars||a).palette[l.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:a.transitions.create("transform",{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${zg.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${zg.error}`]:{"&::before, &::after":{borderBottomColor:(a.vars||a).palette.error.main}},"&::before":{borderBottom:`1px solid ${_}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:a.transitions.create("border-bottom-color",{duration:a.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${zg.disabled}, .${zg.error}):before`]:{borderBottom:`2px solid ${(a.vars||a).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${_}`}},[`&.${zg.disabled}:before`]:{borderBottomStyle:"dotted"}})}),yj=qn(uv,{name:"MuiInput",slot:"Input",overridesResolver:lv})({}),bE=ue.forwardRef(function(l,m){var _,w,C,M;const r=vr({props:l,name:"MuiInput"}),{disableUnderline:O,components:V={},componentsProps:U,fullWidth:Z=!1,inputComponent:ie="input",multiline:de=!1,slotProps:se,slots:ne={},type:Se="text"}=r,me=Yn(r,mj),Re=gj(r),Le={root:{ownerState:{disableUnderline:O}}},De=se??U?ja(se??U,Le):Le,Oe=(_=(w=ne.root)!=null?w:V.Root)!=null?_:_j,Ee=(C=(M=ne.input)!=null?M:V.Input)!=null?C:yj;return Ne.jsx(tb,Fe({slots:{root:Oe,input:Ee},slotProps:De,fullWidth:Z,inputComponent:ie,multiline:de,ref:m,type:Se},me,{classes:Re}))});bE.muiName="Input";function vj(a){return dr("MuiInputLabel",a)}rr("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const xj=["disableAnimation","margin","shrink","variant","className"],bj=a=>{const{classes:l,formControl:m,size:_,shrink:w,disableAnimation:C,variant:M,required:r}=a,O={root:["root",m&&"formControl",!C&&"animated",w&&"shrink",_&&_!=="normal"&&`size${vn(_)}`,M],asterisk:[r&&"asterisk"]},V=yr(O,vj,l);return Fe({},l,V)},wj=qn(JF,{shouldForwardProp:a=>Na(a)||a==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[{[`& .${Jg.asterisk}`]:l.asterisk},l.root,m.formControl&&l.formControl,m.size==="small"&&l.sizeSmall,m.shrink&&l.shrink,!m.disableAnimation&&l.animated,m.focused&&l.focused,l[m.variant]]}})(({theme:a,ownerState:l})=>Fe({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},l.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},l.size==="small"&&{transform:"translate(0, 17px) scale(1)"},l.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!l.disableAnimation&&{transition:a.transitions.create(["color","transform","max-width"],{duration:a.transitions.duration.shorter,easing:a.transitions.easing.easeOut})},l.variant==="filled"&&Fe({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},l.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},l.shrink&&Fe({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},l.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),l.variant==="outlined"&&Fe({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},l.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},l.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),Tj=ue.forwardRef(function(l,m){const _=vr({name:"MuiInputLabel",props:l}),{disableAnimation:w=!1,shrink:C,className:M}=_,r=Yn(_,xj),O=Ap();let V=C;typeof V>"u"&&O&&(V=O.filled||O.focused||O.adornedStart);const U=kf({props:_,muiFormControl:O,states:["size","variant","required","focused"]}),Z=Fe({},_,{disableAnimation:w,formControl:O,shrink:V,size:U.size,variant:U.variant,required:U.required,focused:U.focused}),ie=bj(Z);return Ne.jsx(wj,Fe({"data-shrink":V,ownerState:Z,ref:m,className:oi(ie.root,M)},r,{classes:ie}))});function Sj(a){return dr("MuiLink",a)}const Cj=rr("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),wE={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Ej=a=>wE[a]||a,Aj=({theme:a,ownerState:l})=>{const m=Ej(l.color),_=Im(a,`palette.${m}`,!1)||l.color,w=Im(a,`palette.${m}Channel`);return"vars"in a&&w?`rgba(${w} / 0.4)`:os.alpha(_,.4)},Ij=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],Pj=a=>{const{classes:l,component:m,focusVisible:_,underline:w}=a,C={root:["root",`underline${vn(w)}`,m==="button"&&"button",_&&"focusVisible"]};return yr(C,Sj,l)},kj=qn(na,{name:"MuiLink",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,l[`underline${vn(m.underline)}`],m.component==="button"&&l.button]}})(({theme:a,ownerState:l})=>Fe({},l.underline==="none"&&{textDecoration:"none"},l.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},l.underline==="always"&&Fe({textDecoration:"underline"},l.color!=="inherit"&&{textDecorationColor:Aj({theme:a,ownerState:l})},{"&:hover":{textDecorationColor:"inherit"}}),l.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Cj.focusVisible}`]:{outline:"auto"}})),Gx=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiLink"}),{className:w,color:C="primary",component:M="a",onBlur:r,onFocus:O,TypographyClasses:V,underline:U="always",variant:Z="inherit",sx:ie}=_,de=Yn(_,Ij),{isFocusVisibleRef:se,onBlur:ne,onFocus:Se,ref:me}=Z0(),[Re,ye]=ue.useState(!1),Le=Eo(m,me),De=$e=>{ne($e),se.current===!1&&ye(!1),r&&r($e)},Oe=$e=>{Se($e),se.current===!0&&ye(!0),O&&O($e)},Ee=Fe({},_,{color:C,component:M,focusVisible:Re,underline:U,variant:Z}),qe=Pj(Ee);return Ne.jsx(kj,Fe({color:C,className:oi(qe.root,w),classes:V,component:M,onBlur:De,onFocus:Oe,ref:Le,ownerState:Ee,variant:Z,sx:[...Object.keys(wE).includes(C)?[]:[{color:C}],...Array.isArray(ie)?ie:[ie]]},de))}),b0=ue.createContext({});function Mj(a){return dr("MuiList",a)}rr("MuiList",["root","padding","dense","subheader"]);const Rj=["children","className","component","dense","disablePadding","subheader"],zj=a=>{const{classes:l,disablePadding:m,dense:_,subheader:w}=a;return yr({root:["root",!m&&"padding",_&&"dense",w&&"subheader"]},Mj,l)},Lj=qn("ul",{name:"MuiList",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,!m.disablePadding&&l.padding,m.dense&&l.dense,m.subheader&&l.subheader]}})(({ownerState:a})=>Fe({listStyle:"none",margin:0,padding:0,position:"relative"},!a.disablePadding&&{paddingTop:8,paddingBottom:8},a.subheader&&{paddingTop:0})),TE=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiList"}),{children:w,className:C,component:M="ul",dense:r=!1,disablePadding:O=!1,subheader:V}=_,U=Yn(_,Rj),Z=ue.useMemo(()=>({dense:r}),[r]),ie=Fe({},_,{component:M,dense:r,disablePadding:O}),de=zj(ie);return Ne.jsx(b0.Provider,{value:Z,children:Ne.jsxs(Lj,Fe({as:M,className:oi(de.root,C),ref:m,ownerState:ie},U,{children:[V,w]}))})}),sC=rr("MuiListItemIcon",["root","alignItemsFlexStart"]),oC=rr("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Dj=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function Wx(a,l,m){return a===l?a.firstChild:l&&l.nextElementSibling?l.nextElementSibling:m?null:a.firstChild}function aC(a,l,m){return a===l?m?a.firstChild:a.lastChild:l&&l.previousElementSibling?l.previousElementSibling:m?null:a.lastChild}function SE(a,l){if(l===void 0)return!0;let m=a.innerText;return m===void 0&&(m=a.textContent),m=m.trim().toLowerCase(),m.length===0?!1:l.repeating?m[0]===l.keys[0]:m.indexOf(l.keys.join(""))===0}function Dg(a,l,m,_,w,C){let M=!1,r=w(a,l,l?m:!1);for(;r;){if(r===a.firstChild){if(M)return!1;M=!0}const O=_?!1:r.disabled||r.getAttribute("aria-disabled")==="true";if(!r.hasAttribute("tabindex")||!SE(r,C)||O)r=w(a,r,m);else return r.focus(),!0}return!1}const Oj=ue.forwardRef(function(l,m){const{actions:_,autoFocus:w=!1,autoFocusItem:C=!1,children:M,className:r,disabledItemsFocusable:O=!1,disableListWrap:V=!1,onKeyDown:U,variant:Z="selectedMenu"}=l,ie=Yn(l,Dj),de=ue.useRef(null),se=ue.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});bh(()=>{w&&de.current.focus()},[w]),ue.useImperativeHandle(_,()=>({adjustStyleForScrollbar:(ye,{direction:Le})=>{const De=!de.current.style.width;if(ye.clientHeight<de.current.clientHeight&&De){const Oe=`${Q2(pa(ye))}px`;de.current.style[Le==="rtl"?"paddingLeft":"paddingRight"]=Oe,de.current.style.width=`calc(100% + ${Oe})`}return de.current}}),[]);const ne=ye=>{const Le=de.current,De=ye.key,Oe=pa(Le).activeElement;if(De==="ArrowDown")ye.preventDefault(),Dg(Le,Oe,V,O,Wx);else if(De==="ArrowUp")ye.preventDefault(),Dg(Le,Oe,V,O,aC);else if(De==="Home")ye.preventDefault(),Dg(Le,null,V,O,Wx);else if(De==="End")ye.preventDefault(),Dg(Le,null,V,O,aC);else if(De.length===1){const Ee=se.current,qe=De.toLowerCase(),$e=performance.now();Ee.keys.length>0&&($e-Ee.lastTime>500?(Ee.keys=[],Ee.repeating=!0,Ee.previousKeyMatched=!0):Ee.repeating&&qe!==Ee.keys[0]&&(Ee.repeating=!1)),Ee.lastTime=$e,Ee.keys.push(qe);const Ge=Oe&&!Ee.repeating&&SE(Oe,Ee);Ee.previousKeyMatched&&(Ge||Dg(Le,Oe,!1,O,Wx,Ee))?ye.preventDefault():Ee.previousKeyMatched=!1}U&&U(ye)},Se=Eo(de,m);let me=-1;ue.Children.forEach(M,(ye,Le)=>{if(!ue.isValidElement(ye)){me===Le&&(me+=1,me>=M.length&&(me=-1));return}ye.props.disabled||(Z==="selectedMenu"&&ye.props.selected||me===-1)&&(me=Le),me===Le&&(ye.props.disabled||ye.props.muiSkipListHighlight||ye.type.muiSkipListHighlight)&&(me+=1,me>=M.length&&(me=-1))});const Re=ue.Children.map(M,(ye,Le)=>{if(Le===me){const De={};return C&&(De.autoFocus=!0),ye.props.tabIndex===void 0&&Z==="selectedMenu"&&(De.tabIndex=0),ue.cloneElement(ye,De)}return ye});return Ne.jsx(TE,Fe({role:"menu",ref:Se,className:r,onKeyDown:ne,tabIndex:w?0:-1},ie,{children:Re}))});function Bj(a){return dr("MuiPopover",a)}rr("MuiPopover",["root","paper"]);const Fj=["onEntering"],jj=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Nj=["slotProps"];function lC(a,l){let m=0;return typeof l=="number"?m=l:l==="center"?m=a.height/2:l==="bottom"&&(m=a.height),m}function cC(a,l){let m=0;return typeof l=="number"?m=l:l==="center"?m=a.width/2:l==="right"&&(m=a.width),m}function uC(a){return[a.horizontal,a.vertical].map(l=>typeof l=="number"?`${l}px`:l).join(" ")}function Zx(a){return typeof a=="function"?a():a}const Vj=a=>{const{classes:l}=a;return yr({root:["root"],paper:["paper"]},Bj,l)},qj=qn(ib,{name:"MuiPopover",slot:"Root",overridesResolver:(a,l)=>l.root})({}),CE=qn(jm,{name:"MuiPopover",slot:"Paper",overridesResolver:(a,l)=>l.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Hj=ue.forwardRef(function(l,m){var _,w,C;const M=vr({props:l,name:"MuiPopover"}),{action:r,anchorEl:O,anchorOrigin:V={vertical:"top",horizontal:"left"},anchorPosition:U,anchorReference:Z="anchorEl",children:ie,className:de,container:se,elevation:ne=8,marginThreshold:Se=16,open:me,PaperProps:Re={},slots:ye,slotProps:Le,transformOrigin:De={vertical:"top",horizontal:"left"},TransitionComponent:Oe=sb,transitionDuration:Ee="auto",TransitionProps:{onEntering:qe}={},disableScrollLock:$e=!1}=M,Ge=Yn(M.TransitionProps,Fj),et=Yn(M,jj),mt=(_=Le==null?void 0:Le.paper)!=null?_:Re,St=ue.useRef(),xt=Eo(St,mt.ref),At=Fe({},M,{anchorOrigin:V,anchorReference:Z,elevation:ne,marginThreshold:Se,externalPaperSlotProps:mt,transformOrigin:De,TransitionComponent:Oe,transitionDuration:Ee,TransitionProps:Ge}),Ct=Vj(At),Ut=ue.useCallback(()=>{if(Z==="anchorPosition")return U;const Vn=Zx(O),zi=(Vn&&Vn.nodeType===1?Vn:pa(St.current).body).getBoundingClientRect();return{top:zi.top+lC(zi,V.vertical),left:zi.left+cC(zi,V.horizontal)}},[O,V.horizontal,V.vertical,U,Z]),at=ue.useCallback(Vn=>({vertical:lC(Vn,De.vertical),horizontal:cC(Vn,De.horizontal)}),[De.horizontal,De.vertical]),kt=ue.useCallback(Vn=>{const ki={width:Vn.offsetWidth,height:Vn.offsetHeight},zi=at(ki);if(Z==="none")return{top:null,left:null,transformOrigin:uC(zi)};const Pr=Ut();let Gr=Pr.top-zi.vertical,ys=Pr.left-zi.horizontal;const zr=Gr+ki.height,Or=ys+ki.width,sr=wh(Zx(O)),Ss=sr.innerHeight-Se,as=sr.innerWidth-Se;if(Se!==null&&Gr<Se){const Hi=Gr-Se;Gr-=Hi,zi.vertical+=Hi}else if(Se!==null&&zr>Ss){const Hi=zr-Ss;Gr-=Hi,zi.vertical+=Hi}if(Se!==null&&ys<Se){const Hi=ys-Se;ys-=Hi,zi.horizontal+=Hi}else if(Or>as){const Hi=Or-as;ys-=Hi,zi.horizontal+=Hi}return{top:`${Math.round(Gr)}px`,left:`${Math.round(ys)}px`,transformOrigin:uC(zi)}},[O,Z,Ut,at,Se]),[qt,lt]=ue.useState(me),Ht=ue.useCallback(()=>{const Vn=St.current;if(!Vn)return;const ki=kt(Vn);ki.top!==null&&(Vn.style.top=ki.top),ki.left!==null&&(Vn.style.left=ki.left),Vn.style.transformOrigin=ki.transformOrigin,lt(!0)},[kt]);ue.useEffect(()=>($e&&window.addEventListener("scroll",Ht),()=>window.removeEventListener("scroll",Ht)),[O,$e,Ht]);const Nn=(Vn,ki)=>{qe&&qe(Vn,ki),Ht()},zn=()=>{lt(!1)};ue.useEffect(()=>{me&&Ht()}),ue.useImperativeHandle(r,()=>me?{updatePosition:()=>{Ht()}}:null,[me,Ht]),ue.useEffect(()=>{if(!me)return;const Vn=nv(()=>{Ht()}),ki=wh(O);return ki.addEventListener("resize",Vn),()=>{Vn.clear(),ki.removeEventListener("resize",Vn)}},[O,me,Ht]);let xn=Ee;Ee==="auto"&&!Oe.muiSupportAuto&&(xn=void 0);const An=se||(O?pa(Zx(O)).body:void 0),ti=(w=ye==null?void 0:ye.root)!=null?w:qj,Hn=(C=ye==null?void 0:ye.paper)!=null?C:CE,bn=Ef({elementType:Hn,externalSlotProps:Fe({},mt,{style:qt?mt.style:Fe({},mt.style,{opacity:0})}),additionalProps:{elevation:ne,ref:xt},ownerState:At,className:oi(Ct.paper,mt==null?void 0:mt.className)}),Zi=Ef({elementType:ti,externalSlotProps:(Le==null?void 0:Le.root)||{},externalForwardedProps:et,additionalProps:{ref:m,slotProps:{backdrop:{invisible:!0}},container:An,open:me},ownerState:At,className:oi(Ct.root,de)}),{slotProps:Ci}=Zi,Yi=Yn(Zi,Nj);return Ne.jsx(ti,Fe({},Yi,!Ry(ti)&&{slotProps:Ci,disableScrollLock:$e},{children:Ne.jsx(Oe,Fe({appear:!0,in:me,onEntering:Nn,onExited:zn,timeout:xn},Ge,{children:Ne.jsx(Hn,Fe({},bn,{children:ie}))}))}))});function Uj(a){return dr("MuiMenu",a)}rr("MuiMenu",["root","paper","list"]);const $j=["onEntering"],Gj=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],Wj={vertical:"top",horizontal:"right"},Zj={vertical:"top",horizontal:"left"},Kj=a=>{const{classes:l}=a;return yr({root:["root"],paper:["paper"],list:["list"]},Uj,l)},Xj=qn(Hj,{shouldForwardProp:a=>Na(a)||a==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(a,l)=>l.root})({}),Yj=qn(CE,{name:"MuiMenu",slot:"Paper",overridesResolver:(a,l)=>l.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Qj=qn(Oj,{name:"MuiMenu",slot:"List",overridesResolver:(a,l)=>l.list})({outline:0}),Jj=ue.forwardRef(function(l,m){var _,w;const C=vr({props:l,name:"MuiMenu"}),{autoFocus:M=!0,children:r,className:O,disableAutoFocusItem:V=!1,MenuListProps:U={},onClose:Z,open:ie,PaperProps:de={},PopoverClasses:se,transitionDuration:ne="auto",TransitionProps:{onEntering:Se}={},variant:me="selectedMenu",slots:Re={},slotProps:ye={}}=C,Le=Yn(C.TransitionProps,$j),De=Yn(C,Gj),Oe=nE(),Ee=Fe({},C,{autoFocus:M,disableAutoFocusItem:V,MenuListProps:U,onEntering:Se,PaperProps:de,transitionDuration:ne,TransitionProps:Le,variant:me}),qe=Kj(Ee),$e=M&&!V&&ie,Ge=ue.useRef(null),et=(at,kt)=>{Ge.current&&Ge.current.adjustStyleForScrollbar(at,{direction:Oe?"rtl":"ltr"}),Se&&Se(at,kt)},mt=at=>{at.key==="Tab"&&(at.preventDefault(),Z&&Z(at,"tabKeyDown"))};let St=-1;ue.Children.map(r,(at,kt)=>{ue.isValidElement(at)&&(at.props.disabled||(me==="selectedMenu"&&at.props.selected||St===-1)&&(St=kt))});const xt=(_=Re.paper)!=null?_:Yj,At=(w=ye.paper)!=null?w:de,Ct=Ef({elementType:Re.root,externalSlotProps:ye.root,ownerState:Ee,className:[qe.root,O]}),Ut=Ef({elementType:xt,externalSlotProps:At,ownerState:Ee,className:qe.paper});return Ne.jsx(Xj,Fe({onClose:Z,anchorOrigin:{vertical:"bottom",horizontal:Oe?"right":"left"},transformOrigin:Oe?Wj:Zj,slots:{paper:xt,root:Re.root},slotProps:{root:Ct,paper:Ut},open:ie,ref:m,transitionDuration:ne,TransitionProps:Fe({onEntering:et},Le),ownerState:Ee},De,{classes:se,children:Ne.jsx(Qj,Fe({onKeyDown:mt,actions:Ge,autoFocus:M&&(St===-1||V),autoFocusItem:$e,variant:me},U,{className:oi(qe.list,U.className),children:r}))}))});function eN(a){return dr("MuiMenuItem",a)}const Og=rr("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),tN=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],nN=(a,l)=>{const{ownerState:m}=a;return[l.root,m.dense&&l.dense,m.divider&&l.divider,!m.disableGutters&&l.gutters]},iN=a=>{const{disabled:l,dense:m,divider:_,disableGutters:w,selected:C,classes:M}=a,O=yr({root:["root",m&&"dense",l&&"disabled",!w&&"gutters",_&&"divider",C&&"selected"]},eN,M);return Fe({},M,O)},rN=qn(km,{shouldForwardProp:a=>Na(a)||a==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:nN})(({theme:a,ownerState:l})=>Fe({},a.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!l.disableGutters&&{paddingLeft:16,paddingRight:16},l.divider&&{borderBottom:`1px solid ${(a.vars||a).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(a.vars||a).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Og.selected}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.selectedOpacity})`:os.alpha(a.palette.primary.main,a.palette.action.selectedOpacity),[`&.${Og.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:os.alpha(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}},[`&.${Og.selected}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:os.alpha(a.palette.primary.main,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:a.vars?`rgba(${a.vars.palette.primary.mainChannel} / ${a.vars.palette.action.selectedOpacity})`:os.alpha(a.palette.primary.main,a.palette.action.selectedOpacity)}},[`&.${Og.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`&.${Og.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity},[`& + .${tC.root}`]:{marginTop:a.spacing(1),marginBottom:a.spacing(1)},[`& + .${tC.inset}`]:{marginLeft:52},[`& .${oC.root}`]:{marginTop:0,marginBottom:0},[`& .${oC.inset}`]:{paddingLeft:36},[`& .${sC.root}`]:{minWidth:36}},!l.dense&&{[a.breakpoints.up("sm")]:{minHeight:"auto"}},l.dense&&Fe({minHeight:32,paddingTop:4,paddingBottom:4},a.typography.body2,{[`& .${sC.root} svg`]:{fontSize:"1.25rem"}}))),Bg=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiMenuItem"}),{autoFocus:w=!1,component:C="li",dense:M=!1,divider:r=!1,disableGutters:O=!1,focusVisibleClassName:V,role:U="menuitem",tabIndex:Z,className:ie}=_,de=Yn(_,tN),se=ue.useContext(b0),ne=ue.useMemo(()=>({dense:M||se.dense||!1,disableGutters:O}),[se.dense,M,O]),Se=ue.useRef(null);bh(()=>{w&&Se.current&&Se.current.focus()},[w]);const me=Fe({},_,{dense:ne.dense,divider:r,disableGutters:O}),Re=iN(_),ye=Eo(Se,m);let Le;return _.disabled||(Le=Z!==void 0?Z:-1),Ne.jsx(b0.Provider,{value:ne,children:Ne.jsx(rN,Fe({ref:ye,role:U,tabIndex:Le,component:C,focusVisibleClassName:oi(Re.focusVisible,V),className:oi(Re.root,ie)},de,{ownerState:me,classes:Re}))})});function sN(a){return dr("MuiNativeSelect",a)}const ob=rr("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),oN=["className","disabled","error","IconComponent","inputRef","variant"],aN=a=>{const{classes:l,variant:m,disabled:_,multiple:w,open:C,error:M}=a,r={select:["select",m,_&&"disabled",w&&"multiple",M&&"error"],icon:["icon",`icon${vn(m)}`,C&&"iconOpen",_&&"disabled"]};return yr(r,sN,l)},EE=({ownerState:a,theme:l})=>Fe({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":Fe({},l.vars?{backgroundColor:`rgba(${l.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:l.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${ob.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(l.vars||l).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},a.variant==="filled"&&{"&&&":{paddingRight:32}},a.variant==="outlined"&&{borderRadius:(l.vars||l).shape.borderRadius,"&:focus":{borderRadius:(l.vars||l).shape.borderRadius},"&&&":{paddingRight:32}}),lN=qn("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Na,overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.select,l[m.variant],m.error&&l.error,{[`&.${ob.multiple}`]:l.multiple}]}})(EE),AE=({ownerState:a,theme:l})=>Fe({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(l.vars||l).palette.action.active,[`&.${ob.disabled}`]:{color:(l.vars||l).palette.action.disabled}},a.open&&{transform:"rotate(180deg)"},a.variant==="filled"&&{right:7},a.variant==="outlined"&&{right:7}),cN=qn("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.icon,m.variant&&l[`icon${vn(m.variant)}`],m.open&&l.iconOpen]}})(AE),uN=ue.forwardRef(function(l,m){const{className:_,disabled:w,error:C,IconComponent:M,inputRef:r,variant:O="standard"}=l,V=Yn(l,oN),U=Fe({},l,{disabled:w,variant:O,error:C}),Z=aN(U);return Ne.jsxs(ue.Fragment,{children:[Ne.jsx(lN,Fe({ownerState:U,className:oi(Z.select,_),disabled:w,ref:r||m},V)),l.multiple?null:Ne.jsx(cN,{as:M,ownerState:U,className:Z.icon})]})});var hC;const hN=["children","classes","className","label","notched"],dN=qn("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:Na})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),pN=qn("legend",{name:"MuiNotchedOutlined",shouldForwardProp:Na})(({ownerState:a,theme:l})=>Fe({float:"unset",width:"auto",overflow:"hidden"},!a.withLabel&&{padding:0,lineHeight:"11px",transition:l.transitions.create("width",{duration:150,easing:l.transitions.easing.easeOut})},a.withLabel&&Fe({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:l.transitions.create("max-width",{duration:50,easing:l.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},a.notched&&{maxWidth:"100%",transition:l.transitions.create("max-width",{duration:100,easing:l.transitions.easing.easeOut,delay:50})})));function fN(a){const{className:l,label:m,notched:_}=a,w=Yn(a,hN),C=m!=null&&m!=="",M=Fe({},a,{notched:_,withLabel:C});return Ne.jsx(dN,Fe({"aria-hidden":!0,className:l,ownerState:M},w,{children:Ne.jsx(pN,{ownerState:M,children:C?Ne.jsx("span",{children:m}):hC||(hC=Ne.jsx("span",{className:"notranslate",children:""}))})}))}const mN=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],gN=a=>{const{classes:l}=a,_=yr({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},O3,l);return Fe({},l,_)},_N=qn(cv,{shouldForwardProp:a=>Na(a)||a==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:av})(({theme:a,ownerState:l})=>{const m=a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return Fe({position:"relative",borderRadius:(a.vars||a).shape.borderRadius,[`&:hover .${Tp.notchedOutline}`]:{borderColor:(a.vars||a).palette.text.primary},"@media (hover: none)":{[`&:hover .${Tp.notchedOutline}`]:{borderColor:a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:m}},[`&.${Tp.focused} .${Tp.notchedOutline}`]:{borderColor:(a.vars||a).palette[l.color].main,borderWidth:2},[`&.${Tp.error} .${Tp.notchedOutline}`]:{borderColor:(a.vars||a).palette.error.main},[`&.${Tp.disabled} .${Tp.notchedOutline}`]:{borderColor:(a.vars||a).palette.action.disabled}},l.startAdornment&&{paddingLeft:14},l.endAdornment&&{paddingRight:14},l.multiline&&Fe({padding:"16.5px 14px"},l.size==="small"&&{padding:"8.5px 14px"}))}),yN=qn(fN,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(a,l)=>l.notchedOutline})(({theme:a})=>{const l=a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:a.vars?`rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:l}}),vN=qn(uv,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:lv})(({theme:a,ownerState:l})=>Fe({padding:"16.5px 14px"},!a.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:a.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:a.palette.mode==="light"?null:"#fff",caretColor:a.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},a.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[a.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},l.size==="small"&&{padding:"8.5px 14px"},l.multiline&&{padding:0},l.startAdornment&&{paddingLeft:0},l.endAdornment&&{paddingRight:0})),IE=ue.forwardRef(function(l,m){var _,w,C,M,r;const O=vr({props:l,name:"MuiOutlinedInput"}),{components:V={},fullWidth:U=!1,inputComponent:Z="input",label:ie,multiline:de=!1,notched:se,slots:ne={},type:Se="text"}=O,me=Yn(O,mN),Re=gN(O),ye=Ap(),Le=kf({props:O,muiFormControl:ye,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),De=Fe({},O,{color:Le.color||"primary",disabled:Le.disabled,error:Le.error,focused:Le.focused,formControl:ye,fullWidth:U,hiddenLabel:Le.hiddenLabel,multiline:de,size:Le.size,type:Se}),Oe=(_=(w=ne.root)!=null?w:V.Root)!=null?_:_N,Ee=(C=(M=ne.input)!=null?M:V.Input)!=null?C:vN;return Ne.jsx(tb,Fe({slots:{root:Oe,input:Ee},renderSuffix:qe=>Ne.jsx(yN,{ownerState:De,className:Re.notchedOutline,label:ie!=null&&ie!==""&&Le.required?r||(r=Ne.jsxs(ue.Fragment,{children:[ie,"","*"]})):ie,notched:typeof se<"u"?se:!!(qe.startAdornment||qe.filled||qe.focused)}),fullWidth:U,inputComponent:Z,multiline:de,ref:m,type:Se},me,{classes:Fe({},Re,{notchedOutline:null})}))});IE.muiName="Input";function xN(a){return dr("MuiSelect",a)}const Fg=rr("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var dC;const bN=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],wN=qn("div",{name:"MuiSelect",slot:"Select",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[{[`&.${Fg.select}`]:l.select},{[`&.${Fg.select}`]:l[m.variant]},{[`&.${Fg.error}`]:l.error},{[`&.${Fg.multiple}`]:l.multiple}]}})(EE,{[`&.${Fg.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),TN=qn("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.icon,m.variant&&l[`icon${vn(m.variant)}`],m.open&&l.iconOpen]}})(AE),SN=qn("input",{shouldForwardProp:a=>rE(a)&&a!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(a,l)=>l.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function pC(a,l){return typeof l=="object"&&l!==null?a===l:String(a)===String(l)}function CN(a){return a==null||typeof a=="string"&&!a.trim()}const EN=a=>{const{classes:l,variant:m,disabled:_,multiple:w,open:C,error:M}=a,r={select:["select",m,_&&"disabled",w&&"multiple",M&&"error"],icon:["icon",`icon${vn(m)}`,C&&"iconOpen",_&&"disabled"],nativeInput:["nativeInput"]};return yr(r,xN,l)},AN=ue.forwardRef(function(l,m){var _;const{"aria-describedby":w,"aria-label":C,autoFocus:M,autoWidth:r,children:O,className:V,defaultOpen:U,defaultValue:Z,disabled:ie,displayEmpty:de,error:se=!1,IconComponent:ne,inputRef:Se,labelId:me,MenuProps:Re={},multiple:ye,name:Le,onBlur:De,onChange:Oe,onClose:Ee,onFocus:qe,onOpen:$e,open:Ge,readOnly:et,renderValue:mt,SelectDisplayProps:St={},tabIndex:xt,value:At,variant:Ct="standard"}=l,Ut=Yn(l,bN),[at,kt]=My({controlled:At,default:Z,name:"Select"}),[qt,lt]=My({controlled:Ge,default:U,name:"Select"}),Ht=ue.useRef(null),Nn=ue.useRef(null),[zn,xn]=ue.useState(null),{current:An}=ue.useRef(Ge!=null),[ti,Hn]=ue.useState(),bn=Eo(m,Se),Zi=ue.useCallback(hi=>{Nn.current=hi,hi&&xn(hi)},[]),Ci=zn==null?void 0:zn.parentNode;ue.useImperativeHandle(bn,()=>({focus:()=>{Nn.current.focus()},node:Ht.current,value:at}),[at]),ue.useEffect(()=>{U&&qt&&zn&&!An&&(Hn(r?null:Ci.clientWidth),Nn.current.focus())},[zn,r]),ue.useEffect(()=>{M&&Nn.current.focus()},[M]),ue.useEffect(()=>{if(!me)return;const hi=pa(Nn.current).getElementById(me);if(hi){const br=()=>{getSelection().isCollapsed&&Nn.current.focus()};return hi.addEventListener("click",br),()=>{hi.removeEventListener("click",br)}}},[me]);const Yi=(hi,br)=>{hi?$e&&$e(br):Ee&&Ee(br),An||(Hn(r?null:Ci.clientWidth),lt(hi))},Vn=hi=>{hi.button===0&&(hi.preventDefault(),Nn.current.focus(),Yi(!0,hi))},ki=hi=>{Yi(!1,hi)},zi=ue.Children.toArray(O),Pr=hi=>{const br=zi.find(is=>is.props.value===hi.target.value);br!==void 0&&(kt(br.props.value),Oe&&Oe(hi,br))},Gr=hi=>br=>{let is;if(br.currentTarget.hasAttribute("tabindex")){if(ye){is=Array.isArray(at)?at.slice():[];const ro=at.indexOf(hi.props.value);ro===-1?is.push(hi.props.value):is.splice(ro,1)}else is=hi.props.value;if(hi.props.onClick&&hi.props.onClick(br),at!==is&&(kt(is),Oe)){const ro=br.nativeEvent||br,Ca=new ro.constructor(ro.type,ro);Object.defineProperty(Ca,"target",{writable:!0,value:{value:is,name:Le}}),Oe(Ca,hi)}ye||Yi(!1,br)}},ys=hi=>{et||[" ","ArrowUp","ArrowDown","Enter"].indexOf(hi.key)!==-1&&(hi.preventDefault(),Yi(!0,hi))},zr=zn!==null&&qt,Or=hi=>{!zr&&De&&(Object.defineProperty(hi,"target",{writable:!0,value:{value:at,name:Le}}),De(hi))};delete Ut["aria-invalid"];let sr,Ss;const as=[];let Hi=!1;(Dy({value:at})||de)&&(mt?sr=mt(at):Hi=!0);const Gs=zi.map(hi=>{if(!ue.isValidElement(hi))return null;let br;if(ye){if(!Array.isArray(at))throw new Error(xd(2));br=at.some(is=>pC(is,hi.props.value)),br&&Hi&&as.push(hi.props.children)}else br=pC(at,hi.props.value),br&&Hi&&(Ss=hi.props.children);return ue.cloneElement(hi,{"aria-selected":br?"true":"false",onClick:Gr(hi),onKeyUp:is=>{is.key===" "&&is.preventDefault(),hi.props.onKeyUp&&hi.props.onKeyUp(is)},role:"option",selected:br,value:void 0,"data-value":hi.props.value})});Hi&&(ye?as.length===0?sr=null:sr=as.reduce((hi,br,is)=>(hi.push(br),is<as.length-1&&hi.push(", "),hi),[]):sr=Ss);let ho=ti;!r&&An&&zn&&(ho=Ci.clientWidth);let Jr;typeof xt<"u"?Jr=xt:Jr=ie?null:0;const xr=St.id||(Le?`mui-component-select-${Le}`:void 0),ci=Fe({},l,{variant:Ct,value:at,open:zr,error:se}),Cs=EN(ci),Wr=Fe({},Re.PaperProps,(_=Re.slotProps)==null?void 0:_.paper),Ws=iv();return Ne.jsxs(ue.Fragment,{children:[Ne.jsx(wN,Fe({ref:Zi,tabIndex:Jr,role:"combobox","aria-controls":Ws,"aria-disabled":ie?"true":void 0,"aria-expanded":zr?"true":"false","aria-haspopup":"listbox","aria-label":C,"aria-labelledby":[me,xr].filter(Boolean).join(" ")||void 0,"aria-describedby":w,onKeyDown:ys,onMouseDown:ie||et?null:Vn,onBlur:Or,onFocus:qe},St,{ownerState:ci,className:oi(St.className,Cs.select,V),id:xr,children:CN(sr)?dC||(dC=Ne.jsx("span",{className:"notranslate",children:""})):sr})),Ne.jsx(SN,Fe({"aria-invalid":se,value:Array.isArray(at)?at.join(","):at,name:Le,ref:Ht,"aria-hidden":!0,onChange:Pr,tabIndex:-1,disabled:ie,className:Cs.nativeInput,autoFocus:M,ownerState:ci},Ut)),Ne.jsx(TN,{as:ne,className:Cs.icon,ownerState:ci}),Ne.jsx(Jj,Fe({id:`menu-${Le||""}`,anchorEl:Ci,open:zr,onClose:ki,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},Re,{MenuListProps:Fe({"aria-labelledby":me,role:"listbox","aria-multiselectable":ye?"true":void 0,disableListWrap:!0,id:Ws},Re.MenuListProps),slotProps:Fe({},Re.slotProps,{paper:Fe({},Wr,{style:Fe({minWidth:ho},Wr!=null?Wr.style:null)})}),children:Gs}))]})}),IN=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],PN=["root"],kN=a=>{const{classes:l}=a;return l},ab={name:"MuiSelect",overridesResolver:(a,l)=>l.root,shouldForwardProp:a=>Na(a)&&a!=="variant",slot:"Root"},MN=qn(bE,ab)(""),RN=qn(IE,ab)(""),zN=qn(yE,ab)(""),PE=ue.forwardRef(function(l,m){const _=vr({name:"MuiSelect",props:l}),{autoWidth:w=!1,children:C,classes:M={},className:r,defaultOpen:O=!1,displayEmpty:V=!1,IconComponent:U=F3,id:Z,input:ie,inputProps:de,label:se,labelId:ne,MenuProps:Se,multiple:me=!1,native:Re=!1,onClose:ye,onOpen:Le,open:De,renderValue:Oe,SelectDisplayProps:Ee,variant:qe="outlined"}=_,$e=Yn(_,IN),Ge=Re?uN:AN,et=Ap(),mt=kf({props:_,muiFormControl:et,states:["variant","error"]}),St=mt.variant||qe,xt=Fe({},_,{variant:St,classes:M}),At=kN(xt),Ct=Yn(At,PN),Ut=ie||{standard:Ne.jsx(MN,{ownerState:xt}),outlined:Ne.jsx(RN,{label:se,ownerState:xt}),filled:Ne.jsx(zN,{ownerState:xt})}[St],at=Eo(m,Pf(Ut));return Ne.jsx(ue.Fragment,{children:ue.cloneElement(Ut,Fe({inputComponent:Ge,inputProps:Fe({children:C,error:mt.error,IconComponent:U,variant:St,type:void 0,multiple:me},Re?{id:Z}:{autoWidth:w,defaultOpen:O,displayEmpty:V,labelId:ne,MenuProps:Se,onClose:ye,onOpen:Le,open:De,renderValue:Oe,SelectDisplayProps:Fe({id:Z},Ee)},de,{classes:de?ja(Ct,de.classes):Ct},ie?ie.props.inputProps:{})},(me&&Re||V)&&St==="outlined"?{notched:!0}:{},{ref:at,className:oi(Ut.props.className,r,At.root)},!ie&&{variant:St},$e))})});PE.muiName="Select";function LN(a={}){const{autoHideDuration:l=null,disableWindowBlurListener:m=!1,onClose:_,open:w,resumeHideDuration:C}=a,M=W0();ue.useEffect(()=>{if(!w)return;function me(Re){Re.defaultPrevented||(Re.key==="Escape"||Re.key==="Esc")&&(_==null||_(Re,"escapeKeyDown"))}return document.addEventListener("keydown",me),()=>{document.removeEventListener("keydown",me)}},[w,_]);const r=Tu((me,Re)=>{_==null||_(me,Re)}),O=Tu(me=>{!_||me==null||M.start(me,()=>{r(null,"timeout")})});ue.useEffect(()=>(w&&O(l),M.clear),[w,l,O,M]);const V=me=>{_==null||_(me,"clickaway")},U=M.clear,Z=ue.useCallback(()=>{l!=null&&O(C??l*.5)},[l,C,O]),ie=me=>Re=>{const ye=me.onBlur;ye==null||ye(Re),Z()},de=me=>Re=>{const ye=me.onFocus;ye==null||ye(Re),U()},se=me=>Re=>{const ye=me.onMouseEnter;ye==null||ye(Re),U()},ne=me=>Re=>{const ye=me.onMouseLeave;ye==null||ye(Re),Z()};return ue.useEffect(()=>{if(!m&&w)return window.addEventListener("focus",Z),window.addEventListener("blur",U),()=>{window.removeEventListener("focus",Z),window.removeEventListener("blur",U)}},[m,w,Z,U]),{getRootProps:(me={})=>{const Re=Fe({},zy(a),zy(me));return Fe({role:"presentation"},me,Re,{onBlur:ie(Re),onFocus:de(Re),onMouseEnter:se(Re),onMouseLeave:ne(Re)})},onClickAway:V}}function DN(a){return dr("MuiSnackbarContent",a)}rr("MuiSnackbarContent",["root","message","action"]);const ON=["action","className","message","role"],BN=a=>{const{classes:l}=a;return yr({root:["root"],action:["action"],message:["message"]},DN,l)},FN=qn(jm,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(a,l)=>l.root})(({theme:a})=>{const l=a.palette.mode==="light"?.8:.98,m=os.emphasize(a.palette.background.default,l);return Fe({},a.typography.body2,{color:a.vars?a.vars.palette.SnackbarContent.color:a.palette.getContrastText(m),backgroundColor:a.vars?a.vars.palette.SnackbarContent.bg:m,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(a.vars||a).shape.borderRadius,flexGrow:1,[a.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}})}),jN=qn("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(a,l)=>l.message})({padding:"8px 0"}),NN=qn("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(a,l)=>l.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),VN=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiSnackbarContent"}),{action:w,className:C,message:M,role:r="alert"}=_,O=Yn(_,ON),V=_,U=BN(V);return Ne.jsxs(FN,Fe({role:r,square:!0,elevation:6,className:oi(U.root,C),ownerState:V,ref:m},O,{children:[Ne.jsx(jN,{className:U.message,ownerState:V,children:M}),w?Ne.jsx(NN,{className:U.action,ownerState:V,children:w}):null]}))});function qN(a){return dr("MuiSnackbar",a)}rr("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const HN=["onEnter","onExited"],UN=["action","anchorOrigin","autoHideDuration","children","className","ClickAwayListenerProps","ContentProps","disableWindowBlurListener","message","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","open","resumeHideDuration","TransitionComponent","transitionDuration","TransitionProps"],$N=a=>{const{classes:l,anchorOrigin:m}=a,_={root:["root",`anchorOrigin${vn(m.vertical)}${vn(m.horizontal)}`]};return yr(_,qN,l)},fC=qn("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,l[`anchorOrigin${vn(m.anchorOrigin.vertical)}${vn(m.anchorOrigin.horizontal)}`]]}})(({theme:a,ownerState:l})=>{const m={left:"50%",right:"auto",transform:"translateX(-50%)"};return Fe({zIndex:(a.vars||a).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center"},l.anchorOrigin.vertical==="top"?{top:8}:{bottom:8},l.anchorOrigin.horizontal==="left"&&{justifyContent:"flex-start"},l.anchorOrigin.horizontal==="right"&&{justifyContent:"flex-end"},{[a.breakpoints.up("sm")]:Fe({},l.anchorOrigin.vertical==="top"?{top:24}:{bottom:24},l.anchorOrigin.horizontal==="center"&&m,l.anchorOrigin.horizontal==="left"&&{left:24,right:"auto"},l.anchorOrigin.horizontal==="right"&&{right:24,left:"auto"})})}),GN=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiSnackbar"}),w=gl(),C={enter:w.transitions.duration.enteringScreen,exit:w.transitions.duration.leavingScreen},{action:M,anchorOrigin:{vertical:r,horizontal:O}={vertical:"bottom",horizontal:"left"},autoHideDuration:V=null,children:U,className:Z,ClickAwayListenerProps:ie,ContentProps:de,disableWindowBlurListener:se=!1,message:ne,open:Se,TransitionComponent:me=sb,transitionDuration:Re=C,TransitionProps:{onEnter:ye,onExited:Le}={}}=_,De=Yn(_.TransitionProps,HN),Oe=Yn(_,UN),Ee=Fe({},_,{anchorOrigin:{vertical:r,horizontal:O},autoHideDuration:V,disableWindowBlurListener:se,TransitionComponent:me,transitionDuration:Re}),qe=$N(Ee),{getRootProps:$e,onClickAway:Ge}=LN(Fe({},Ee)),[et,mt]=ue.useState(!0),St=Ef({elementType:fC,getSlotProps:$e,externalForwardedProps:Oe,ownerState:Ee,additionalProps:{ref:m},className:[qe.root,Z]}),xt=Ct=>{mt(!0),Le&&Le(Ct)},At=(Ct,Ut)=>{mt(!1),ye&&ye(Ct,Ut)};return!Se&&et?null:Ne.jsx(vB,Fe({onClickAway:Ge},ie,{children:Ne.jsx(fC,Fe({},St,{children:Ne.jsx(me,Fe({appear:!0,in:Se,timeout:Re,direction:r==="top"?"down":"up",onEnter:At,onExited:xt},De,{children:U||Ne.jsx(VN,Fe({message:ne,action:M},de))}))}))}))});function WN(a){return dr("MuiToolbar",a)}rr("MuiToolbar",["root","gutters","regular","dense"]);const ZN=["className","component","disableGutters","variant"],KN=a=>{const{classes:l,disableGutters:m,variant:_}=a;return yr({root:["root",!m&&"gutters",_]},WN,l)},XN=qn("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(a,l)=>{const{ownerState:m}=a;return[l.root,!m.disableGutters&&l.gutters,l[m.variant]]}})(({theme:a,ownerState:l})=>Fe({position:"relative",display:"flex",alignItems:"center"},!l.disableGutters&&{paddingLeft:a.spacing(2),paddingRight:a.spacing(2),[a.breakpoints.up("sm")]:{paddingLeft:a.spacing(3),paddingRight:a.spacing(3)}},l.variant==="dense"&&{minHeight:48}),({theme:a,ownerState:l})=>l.variant==="regular"&&a.mixins.toolbar),YN=ue.forwardRef(function(l,m){const _=vr({props:l,name:"MuiToolbar"}),{className:w,component:C="div",disableGutters:M=!1,variant:r="regular"}=_,O=Yn(_,ZN),V=Fe({},_,{component:C,disableGutters:M,variant:r}),U=KN(V);return Ne.jsx(XN,Fe({as:C,className:oi(U.root,w),ref:m,ownerState:V},O))}),kE="/assets/1-CGI0Vlw7.jpg",ME="/assets/10-DSWljDet.jpg",RE="/assets/11-9G2iCV8p.jpg",zE="/assets/12-BF6n2yob.jpg",LE="/assets/13-B96CBMMh.jpg",DE="/assets/14-B1yt2nI3.jpg",OE="/assets/15-fSbRZtMy.jpg",BE="/assets/16-ClroVASi.jpg",FE="/assets/17-CV3IegS3.jpg",jE="/assets/18-eoEq9D_C.jpg",NE="/assets/19-BIscYJ4k.jpg",VE="/assets/2-B3C2ayi2.jpg",qE="/assets/20-DkqZXr3-.jpg",HE="/assets/21-BZcqIYr3.jpg",UE="/assets/22-BzklSMKz.jpg",$E="/assets/23-BXFp1hHv.jpg",GE="/assets/24-D8Wb9wXh.jpg",WE="/assets/25-DjMbkjzt.jpg",ZE="/assets/26-xiB-Tv12.jpg",KE="/assets/27-BBUTsHfh.jpg",XE="/assets/28-CTHfuGGI.jpg",YE="/assets/29-_894_kEU.jpg",QE="/assets/3-6Qg8obZP.jpg",JE="/assets/30-C7mbz-SH.jpg",eA="/assets/31-DsQIeCQ7.jpg",tA="/assets/32-Bp7RtVdI.jpg",nA="/assets/33-9Ripstaw.jpg",iA="/assets/34-BkZ2k5Ip.jpg",rA="/assets/35-BV6BbL_A.jpg",sA="/assets/36-JTmUNWzL.jpg",oA="/assets/37-BNtxzS8T.jpg",aA="/assets/38-DHD00hgZ.jpg",lA="/assets/39-BqCB5Gvw.jpg",cA="/assets/4-BIDAL2Bb.jpg",uA="/assets/40-BYIyDbJH.jpg",hA="/assets/41-Da2PYH9y.jpg",dA="/assets/42-B3Gm9tMk.jpg",pA="/assets/43-NW0FnZ21.jpg",fA="/assets/44-ZGoPsOaU.jpg",mA="/assets/45-CmxDdCCI.jpg",gA="/assets/46-BXclbjmH.jpg",_A="/assets/47-DKe_aU-Z.jpg",yA="/assets/48-BmYacCKW.jpg",vA="/assets/49-HzDPfrsp.jpg",xA="/assets/5-Bn0vIn5S.jpg",bA="/assets/50-B1bMsjsX.jpg",wA="/assets/51-C7m48e91.jpg",TA="/assets/52-BJMtknZe.jpg",SA="/assets/53-BTi2D3GK.jpg",CA="/assets/54-CmmC1X1q.jpg",EA="/assets/55-BZda06qO.jpg",AA="/assets/56-BMhby0JT.jpg",IA="/assets/57-BRmhovHH.jpg",PA="/assets/58-D8oim3zP.jpg",kA="/assets/59-56YSzuZ-.jpg",MA="/assets/6-BcThggzA.jpg",RA="/assets/60-CyRgQgfF.jpg",zA="/assets/7-DfLBYiKl.jpg",LA="/assets/8-TSzkn7Oo.jpg",DA="/assets/9-CSNFRg_J.jpg",OA="/assets/dragon-CWGVTYOO.png",Kx=(a=!1)=>{const[l,m]=ue.useState(a),_=ue.useCallback(()=>m(!0),[]),w=ue.useCallback(()=>m(!1),[]),C=ue.useCallback(()=>m(M=>!M),[]);return{isOpen:l,openDrawer:_,closeDrawer:w,toggleDrawer:C}},QN="https://t.me/pashanishka",JN="https://wa.me/84357923401",e5="mailto:hatifnatts@gmail.com";var jg={},Xx={};const t5=bd(PO);var mC;function Ip(){return mC||(mC=1,function(a){"use client";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"default",{enumerable:!0,get:function(){return l.createSvgIcon}});var l=t5}(Xx)),Xx}var gC;function n5(){if(gC)return jg;gC=1;var a=Th();Object.defineProperty(jg,"__esModule",{value:!0}),jg.default=void 0;var l=a(Ip()),m=wd();return jg.default=(0,l.default)((0,m.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),jg}var i5=n5();const r5=$l(i5);function Oy(){return Oy=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(a[_]=m[_])}return a},Oy.apply(this,arguments)}function s5(a,l){if(a==null)return{};var m={},_=Object.keys(a),w,C;for(C=0;C<_.length;C++)w=_[C],!(l.indexOf(w)>=0)&&(m[w]=a[w]);return m}var o5=["cdnSuffix","cdnUrl","countryCode","style","svg"],a5="https://cdn.jsdelivr.net/gh/lipis/flag-icons/flags/4x3/",l5="svg",c5=127397,Ng=function(l){var m=l.cdnSuffix,_=m===void 0?l5:m,w=l.cdnUrl,C=w===void 0?a5:w,M=l.countryCode,r=l.style,O=l.svg,V=O===void 0?!1:O,U=s5(l,o5);if(typeof M!="string")return null;if(V){var Z=""+C+M.toLowerCase()+"."+_;return ue.createElement("img",Object.assign({},U,{src:Z,style:Oy({display:"inline-block",width:"1em",height:"1em",verticalAlign:"middle"},r)}))}var ie=M.toUpperCase().replace(/./g,function(de){return String.fromCodePoint(de.charCodeAt(0)+c5)});return ue.createElement("span",Object.assign({role:"img"},U,{style:Oy({display:"inline-block",fontSize:"1em",lineHeight:"1em",verticalAlign:"middle"},r)}),ie)};const u5=(a,l,m,_)=>{var C,M,r,O;const w=[m,{code:l,..._||{}}];if((M=(C=a==null?void 0:a.services)==null?void 0:C.logger)!=null&&M.forward)return a.services.logger.forward(w,"warn","react-i18next::",!0);Sf(w[0])&&(w[0]=`react-i18next:: ${w[0]}`),(O=(r=a==null?void 0:a.services)==null?void 0:r.logger)!=null&&O.warn?a.services.logger.warn(...w):console!=null&&console.warn&&console.warn(...w)},_C={},w0=(a,l,m,_)=>{Sf(m)&&_C[m]||(Sf(m)&&(_C[m]=new Date),u5(a,l,m,_))},BA=(a,l)=>()=>{if(a.isInitialized)l();else{const m=()=>{setTimeout(()=>{a.off("initialized",m)},0),l()};a.on("initialized",m)}},T0=(a,l,m)=>{a.loadNamespaces(l,BA(a,m))},yC=(a,l,m,_)=>{if(Sf(m)&&(m=[m]),a.options.preload&&a.options.preload.indexOf(l)>-1)return T0(a,m,_);m.forEach(w=>{a.options.ns.indexOf(w)<0&&a.options.ns.push(w)}),a.loadLanguages(l,BA(a,_))},h5=(a,l,m={})=>!l.languages||!l.languages.length?(w0(l,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:l.languages}),!0):l.hasLoadedNamespace(a,{lng:m.lng,precheck:(_,w)=>{var C;if(((C=m.bindI18n)==null?void 0:C.indexOf("languageChanging"))>-1&&_.services.backendConnector.backend&&_.isLanguageChangingTo&&!w(_.isLanguageChangingTo,a))return!1}}),Sf=a=>typeof a=="string",d5=a=>typeof a=="object"&&a!==null,p5=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,f5={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},m5=a=>f5[a],g5=a=>a.replace(p5,m5);let S0={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:g5};const _5=(a={})=>{S0={...S0,...a}},y5=()=>S0;let FA;const v5=a=>{FA=a},x5=()=>FA,b5={type:"3rdParty",init(a){_5(a.options.react),v5(a)}},w5=ue.createContext();class T5{constructor(){this.usedNamespaces={}}addUsedNamespaces(l){l.forEach(m=>{this.usedNamespaces[m]||(this.usedNamespaces[m]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const S5=(a,l)=>{const m=ue.useRef();return ue.useEffect(()=>{m.current=a},[a,l]),m.current},jA=(a,l,m,_)=>a.getFixedT(l,m,_),C5=(a,l,m,_)=>ue.useCallback(jA(a,l,m,_),[a,l,m,_]),Gl=(a,l={})=>{var Le,De,Oe,Ee;const{i18n:m}=l,{i18n:_,defaultNS:w}=ue.useContext(w5)||{},C=m||_||x5();if(C&&!C.reportNamespaces&&(C.reportNamespaces=new T5),!C){w0(C,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const qe=(Ge,et)=>Sf(et)?et:d5(et)&&Sf(et.defaultValue)?et.defaultValue:Array.isArray(Ge)?Ge[Ge.length-1]:Ge,$e=[qe,{},!1];return $e.t=qe,$e.i18n={},$e.ready=!1,$e}(Le=C.options.react)!=null&&Le.wait&&w0(C,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const M={...y5(),...C.options.react,...l},{useSuspense:r,keyPrefix:O}=M;let V=w||((De=C.options)==null?void 0:De.defaultNS);V=Sf(V)?[V]:V||["translation"],(Ee=(Oe=C.reportNamespaces).addUsedNamespaces)==null||Ee.call(Oe,V);const U=(C.isInitialized||C.initializedStoreOnce)&&V.every(qe=>h5(qe,C,M)),Z=C5(C,l.lng||null,M.nsMode==="fallback"?V:V[0],O),ie=()=>Z,de=()=>jA(C,l.lng||null,M.nsMode==="fallback"?V:V[0],O),[se,ne]=ue.useState(ie);let Se=V.join();l.lng&&(Se=`${l.lng}${Se}`);const me=S5(Se),Re=ue.useRef(!0);ue.useEffect(()=>{const{bindI18n:qe,bindI18nStore:$e}=M;Re.current=!0,!U&&!r&&(l.lng?yC(C,l.lng,V,()=>{Re.current&&ne(de)}):T0(C,V,()=>{Re.current&&ne(de)})),U&&me&&me!==Se&&Re.current&&ne(de);const Ge=()=>{Re.current&&ne(de)};return qe&&(C==null||C.on(qe,Ge)),$e&&(C==null||C.store.on($e,Ge)),()=>{Re.current=!1,C&&(qe==null||qe.split(" ").forEach(et=>C.off(et,Ge))),$e&&C&&$e.split(" ").forEach(et=>C.store.off(et,Ge))}},[C,Se]),ue.useEffect(()=>{Re.current&&U&&ne(ie)},[C,O,U]);const ye=[se,C,U];if(ye.t=se,ye.i18n=C,ye.ready=U,U||!U&&!r)return ye;throw new Promise(qe=>{l.lng?yC(C,l.lng,V,()=>qe()):T0(C,V,()=>qe())})},NA=ue.createContext(void 0),E5=({children:a})=>{const{i18n:l}=Gl(),m=l.language,_=ue.useCallback(w=>{w!==l.language&&l.changeLanguage(w)},[l]);return Ne.jsx(NA.Provider,{value:{currentLang:m,setLang:_},children:a})},A5=()=>{const a=ue.useContext(NA);if(a===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return a},I5=()=>{const{i18n:a}=Gl(),{setLang:l}=A5(),m=_=>{const w=_.target.value;l(w)};return Ne.jsxs(vE,{variant:"outlined",sx:{minWidth:80},children:[Ne.jsx(Tj,{id:"language-select-label"}),Ne.jsxs(PE,{labelId:"language-select-label",id:"language-select",value:a.language,onChange:m,size:"small",sx:{"& .MuiSelect-select":{display:"flex",alignItems:"center",gap:1}},children:[Ne.jsxs(Bg,{value:"en",children:[Ne.jsx(Ng,{countryCode:"US",svg:!0,style:{width:"1.5em",height:"1.5em",marginRight:"8px"},title:"US"})," "]}),Ne.jsxs(Bg,{value:"fr",children:[Ne.jsx(Ng,{countryCode:"FR",svg:!0,style:{width:"1.5em",height:"1.5em",marginRight:"8px"},title:"FR"})," "]}),Ne.jsxs(Bg,{value:"es",children:[Ne.jsx(Ng,{countryCode:"ES",svg:!0,style:{width:"1.5em",height:"1.5em",marginRight:"8px"},title:"ES"})," "]}),Ne.jsxs(Bg,{value:"ru",children:[Ne.jsx(Ng,{countryCode:"RU",svg:!0,style:{width:"1.5em",height:"1.5em",marginRight:"8px"},title:"RU"})," "]}),Ne.jsxs(Bg,{value:"vn",children:[Ne.jsx(Ng,{countryCode:"VN",svg:!0,style:{width:"1.5em",height:"1.5em",marginRight:"8px"},title:"VN"})," "]})]})]})};var Vg={},vC;function P5(){if(vC)return Vg;vC=1;var a=Th();Object.defineProperty(Vg,"__esModule",{value:!0}),Vg.default=void 0;var l=a(Ip()),m=wd();return Vg.default=(0,l.default)((0,m.jsx)("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"}),"FilterList"),Vg}var k5=P5();const M5=$l(k5),R5=({onClick:a,selectedCategorySlugs:l})=>{const{t:m}=Gl(),_=gl();return Ne.jsxs(Hl,{onClick:a,color:"inherit",sx:{ml:1,position:"relative"},"aria-label":m("category"),children:[Ne.jsx(M5,{}),l.length>0&&Ne.jsx($s,{sx:{position:"absolute",top:0,right:0,backgroundColor:"#ffbf00",color:_.palette.primary.contrastText,borderRadius:"50%",width:18,height:18,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold",zIndex:1},children:l.length})]})},z5=({logoSrc:a,onClick:l})=>{const{t:m}=Gl(),_=gl(),w=ue.useCallback(()=>{l()},[l]);return Ne.jsxs($s,{sx:{display:"flex",alignItems:"center",cursor:"pointer","&:hover":{opacity:.8},flexShrink:0,mr:"auto"},onClick:w,children:[Ne.jsx("img",{src:a,alt:m("logoAltText"),style:{width:"auto",height:"36px",display:"block",marginRight:_.spacing(1)}}),Ne.jsx(na,{variant:"body2",component:"span",sx:{fontWeight:600,whiteSpace:"nowrap"},children:m("logoTitle")})]})},L5=({logoSrc:a,onLogoClick:l,onOpenMainMenu:m,onOpenFilterDrawer:_,selectedCategorySlugs:w})=>Ne.jsxs(YN,{disableGutters:!0,sx:{minHeight:"unset !important"},children:[Ne.jsx(Hl,{edge:"start",color:"inherit","aria-label":"open main menu",onClick:m,sx:{ml:0,mr:0,pl:0},children:Ne.jsx(r5,{})}),Ne.jsx(z5,{logoSrc:a,onClick:l}),Ne.jsxs(Rm,{direction:"row",alignItems:"center",spacing:1,sx:{flexShrink:0,ml:"auto"},children:[Ne.jsx(I5,{}),Ne.jsx(R5,{onClick:_,selectedCategorySlugs:w})]})]});var qg={},xC;function D5(){if(xC)return qg;xC=1;var a=Th();Object.defineProperty(qg,"__esModule",{value:!0}),qg.default=void 0;var l=a(Ip()),m=wd();return qg.default=(0,l.default)((0,m.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),qg}var O5=D5();const Nm=$l(O5),B5=({open:a,onClose:l,onHomeClick:m,onAboutClick:_,onServicesClick:w,onContactClick:C,onToggleRouteVisibility:M,isRouteVisible:r})=>{const{t:O}=Gl();return Ne.jsx(_E,{anchor:"left",open:a,onClose:l,children:Ne.jsxs($s,{sx:{width:250},role:"presentation",onKeyDown:l,children:[Ne.jsxs($s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2},children:[Ne.jsx(na,{variant:"h6",children:O("menu.title")}),Ne.jsx(Hl,{onClick:l,children:Ne.jsx(Nm,{})})]}),Ne.jsx(rb,{})]})})},F5=({open:a,onClose:l,onSelectCategories:m,selectedCategorySlugs:_,CategoryFilterComponent:w})=>{const{t:C}=Gl();return Ne.jsx(_E,{anchor:"right",open:a,onClose:l,children:Ne.jsx($s,{sx:{width:280},role:"presentation",children:Ne.jsxs(TE,{children:[Ne.jsxs($s,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:1},children:[Ne.jsx(na,{variant:"h6",children:C("category")}),Ne.jsx(Hl,{onClick:l,children:Ne.jsx(Nm,{})})]}),Ne.jsx(rb,{}),Ne.jsx(w,{onSelectCategories:m,selectedCategorySlugs:_})]})})})};var Hg={},bC;function j5(){if(bC)return Hg;bC=1;var a=Th();Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.default=void 0,w(d_());var l=a(Ip()),m=wd();function _(C){if(typeof WeakMap!="function")return null;var M=new WeakMap,r=new WeakMap;return(_=function(O){return O?r:M})(C)}function w(C,M){if(C&&C.__esModule)return C;if(C===null||typeof C!="object"&&typeof C!="function")return{default:C};var r=_(M);if(r&&r.has(C))return r.get(C);var O={__proto__:null},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in C)if(U!=="default"&&Object.prototype.hasOwnProperty.call(C,U)){var Z=V?Object.getOwnPropertyDescriptor(C,U):null;Z&&(Z.get||Z.set)?Object.defineProperty(O,U,Z):O[U]=C[U]}return O.default=C,r&&r.set(C,O),O}return Hg.default=(0,l.default)((0,m.jsx)("path",{d:"M9.78 18.65l.28-4.23 7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3 3.64 12c-.88-.25-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.81c-.19.91-.74 1.13-1.5.71L12.6 16.3l-1.99 1.93c-.23.23-.42.42-.83.42z"}),"Telegram"),Hg}var N5=j5();const V5=$l(N5);var Ug={},wC;function q5(){if(wC)return Ug;wC=1;var a=Th();Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.default=void 0,w(d_());var l=a(Ip()),m=wd();function _(C){if(typeof WeakMap!="function")return null;var M=new WeakMap,r=new WeakMap;return(_=function(O){return O?r:M})(C)}function w(C,M){if(C&&C.__esModule)return C;if(C===null||typeof C!="object"&&typeof C!="function")return{default:C};var r=_(M);if(r&&r.has(C))return r.get(C);var O={__proto__:null},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in C)if(U!=="default"&&Object.prototype.hasOwnProperty.call(C,U)){var Z=V?Object.getOwnPropertyDescriptor(C,U):null;Z&&(Z.get||Z.set)?Object.defineProperty(O,U,Z):O[U]=C[U]}return O.default=C,r&&r.set(C,O),O}return Ug.default=(0,l.default)((0,m.jsx)("path",{d:"M16.75 13.96c.25.13.41.2.46.3.06.11.04.61-.21 1.18-.2.56-1.24 1.1-1.7 1.12-.46.02-.47.36-2.96-.73-2.49-1.09-3.99-3.75-4.11-3.92-.12-.17-.96-1.38-.92-2.61.05-1.22.69-1.8.95-2.04.24-.26.51-.29.68-.26h.47c.15 0 .36-.06.55.45l.69 1.87c.06.13.1.28.01.44l-.27.41-.39.42c-.12.12-.26.25-.12.5.12.26.62 1.09 1.32 1.78.91.88 1.71 1.17 1.95 1.3.24.14.39.12.54-.04l.81-.94c.19-.25.35-.19.58-.11l1.67.88M12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10c-1.97 0-3.8-.57-5.35-1.55L2 22l1.55-4.65A9.969 9.969 0 0 1 2 12 10 10 0 0 1 12 2m0 2a8 8 0 0 0-8 8c0 1.72.54 3.31 1.46 4.61L4.5 19.5l2.89-.96A7.95 7.95 0 0 0 12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8z"}),"WhatsApp"),Ug}var H5=q5();const U5=$l(H5);var $g={},TC;function $5(){if(TC)return $g;TC=1;var a=Th();Object.defineProperty($g,"__esModule",{value:!0}),$g.default=void 0;var l=a(Ip()),m=wd();return $g.default=(0,l.default)((0,m.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Email"),$g}var G5=$5();const W5=$l(G5),Z5=({open:a,onClose:l,dialogImage:m,telegramLink:_,whatsappLink:w,emailLink:C})=>{const{t:M}=Gl();return gl(),Ne.jsxs(hE,{open:a,onClose:l,"aria-labelledby":"welcome-dialog-title",maxWidth:"xs",fullWidth:!0,children:[Ne.jsx(fE,{id:"welcome-dialog-title",children:Ne.jsxs(Rm,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[Ne.jsx(na,{variant:"h6",children:M("welcomeDialogTitle")}),Ne.jsx(Hl,{edge:"end",color:"inherit",onClick:l,"aria-label":"close",children:Ne.jsx(Nm,{})})]})}),Ne.jsxs(pE,{sx:{textAlign:"center"},dividers:!0,children:[Ne.jsx($s,{component:"img",src:m,alt:"Welcome Dragon",sx:{display:"block",margin:"0 auto 16px auto",maxWidth:"auto",height:"72px",objectFit:"contain"}}),Ne.jsx(na,{sx:{mb:1},variant:"h6",children:M("welcomeDialogMessage")}),Ne.jsx(na,{sx:{mb:1},variant:"body1",children:M("thankYouMessage")}),Ne.jsxs(Rm,{direction:"row",spacing:2,justifyContent:"center",sx:{mt:3},children:[Ne.jsx(Gx,{href:_,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:Ne.jsx(Hl,{color:"primary","aria-label":"Telegram",children:Ne.jsx(V5,{fontSize:"large"})})}),Ne.jsx(Gx,{href:w,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:Ne.jsx(Hl,{color:"primary","aria-label":"WhatsApp",children:Ne.jsx(U5,{fontSize:"large"})})}),Ne.jsx(Gx,{href:C,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:Ne.jsx(Hl,{color:"primary","aria-label":"Email",children:Ne.jsx(W5,{fontSize:"large"})})})]})]}),Ne.jsx(dE,{children:Ne.jsx(nb,{onClick:l,color:"primary",children:M("welcomeClose")})})]})},VA=[{id:1,name:{en:"Museums",ru:"",es:"Museos",fr:"Muses",vn:"Bo tng"},slug:"museum"},{id:2,name:{en:"Food & Drinks",ru:"  ",es:"Comida y Bebidas",fr:"Aliments et Boissons",vn:"m thc &  ung"},slug:"food-drinks"},{id:3,name:{en:"Art / Galleries",ru:" / ",es:"Arte / Galeras",fr:"Art / Galeries",vn:"Ngh thut / Phng trng by"},slug:"art-galleries"},{id:4,name:{en:"Clubs",ru:"",es:"Clubs",fr:"Clubs",vn:"Cu lc b"},slug:"clubs"}];VA.map(a=>a.slug);const K5=({onSelectCategories:a,selectedCategorySlugs:l})=>{const m=gl(),{i18n:_}=Gl(),w=ue.useMemo(()=>VA.map(M=>{const r=M.name[_.language]||M.name.en;return{...M,translatedName:r}}),[_.language]),C=ue.useCallback(M=>{const r=M.target.name,O=M.target.checked;let V;O?V=[...l,r]:V=l.filter(U=>U!==r),a(V)},[a,l]);return Ne.jsx($s,{sx:{m:1,width:250},children:Ne.jsx(vE,{component:"fieldset",variant:"standard",sx:{width:"100%"},children:Ne.jsx(WF,{children:w.map(M=>Ne.jsx(qF,{control:Ne.jsx(_B,{checked:l.includes(M.slug),onChange:C,name:M.slug,sx:{color:l.includes(M.slug)?m.palette.secondary.main:m.palette.text.primary,"&.Mui-checked":{color:m.palette.primary.main}}}),label:M.translatedName},M.id))})})})},X5="/assets/logo-BNZiG2ZH.svg",Y5=Object.assign({"../assets/img/pictures/1.jpg":kE,"../assets/img/pictures/10.jpg":ME,"../assets/img/pictures/11.jpg":RE,"../assets/img/pictures/12.jpg":zE,"../assets/img/pictures/13.jpg":LE,"../assets/img/pictures/14.jpg":DE,"../assets/img/pictures/15.jpg":OE,"../assets/img/pictures/16.jpg":BE,"../assets/img/pictures/17.jpg":FE,"../assets/img/pictures/18.jpg":jE,"../assets/img/pictures/19.jpg":NE,"../assets/img/pictures/2.jpg":VE,"../assets/img/pictures/20.jpg":qE,"../assets/img/pictures/21.jpg":HE,"../assets/img/pictures/22.jpg":UE,"../assets/img/pictures/23.jpg":$E,"../assets/img/pictures/24.jpg":GE,"../assets/img/pictures/25.jpg":WE,"../assets/img/pictures/26.jpg":ZE,"../assets/img/pictures/27.jpg":KE,"../assets/img/pictures/28.jpg":XE,"../assets/img/pictures/29.jpg":YE,"../assets/img/pictures/3.jpg":QE,"../assets/img/pictures/30.jpg":JE,"../assets/img/pictures/31.jpg":eA,"../assets/img/pictures/32.jpg":tA,"../assets/img/pictures/33.jpg":nA,"../assets/img/pictures/34.jpg":iA,"../assets/img/pictures/35.jpg":rA,"../assets/img/pictures/36.jpg":sA,"../assets/img/pictures/37.jpg":oA,"../assets/img/pictures/38.jpg":aA,"../assets/img/pictures/39.jpg":lA,"../assets/img/pictures/4.jpg":cA,"../assets/img/pictures/40.jpg":uA,"../assets/img/pictures/41.jpg":hA,"../assets/img/pictures/42.jpg":dA,"../assets/img/pictures/43.jpg":pA,"../assets/img/pictures/44.jpg":fA,"../assets/img/pictures/45.jpg":mA,"../assets/img/pictures/46.jpg":gA,"../assets/img/pictures/47.jpg":_A,"../assets/img/pictures/48.jpg":yA,"../assets/img/pictures/49.jpg":vA,"../assets/img/pictures/5.jpg":xA,"../assets/img/pictures/50.jpg":bA,"../assets/img/pictures/51.jpg":wA,"../assets/img/pictures/52.jpg":TA,"../assets/img/pictures/53.jpg":SA,"../assets/img/pictures/54.jpg":CA,"../assets/img/pictures/55.jpg":EA,"../assets/img/pictures/56.jpg":AA,"../assets/img/pictures/57.jpg":IA,"../assets/img/pictures/58.jpg":PA,"../assets/img/pictures/59.jpg":kA,"../assets/img/pictures/6.jpg":MA,"../assets/img/pictures/60.jpg":RA,"../assets/img/pictures/7.jpg":zA,"../assets/img/pictures/8.jpg":LA,"../assets/img/pictures/9.jpg":DA,"../assets/img/pictures/dragon.png":OA}),Q5=a=>Y5[`../assets/img/pictures/${a}`],J5=Q5("dragon.png"),e4=({onSelectCategories:a,selectedCategorySlugs:l,toggleRouteVisibility:m,isRouteVisible:_})=>{const{isOpen:w,openDrawer:C,closeDrawer:M}=Kx(!1),{isOpen:r,openDrawer:O,closeDrawer:V}=Kx(!1),{isOpen:U,openDrawer:Z,closeDrawer:ie}=Kx(!1),de=ue.useCallback(()=>{C()},[C]);return Ne.jsxs(g3,{position:"fixed",elevation:0,sx:{p:1,m:1,borderRadius:2,flexShrink:0,top:0,left:0,right:0,zIndex:1e3,backgroundColor:se=>se.palette.mode==="dark"?se.palette.background.default:se.palette.background.paper,boxShadow:se=>se.shadows[3],width:"calc(100% - 16px)",boxSizing:"border-box"},children:[Ne.jsx(L5,{logoSrc:X5,onLogoClick:de,onOpenMainMenu:Z,onOpenFilterDrawer:O,selectedCategorySlugs:l}),Ne.jsx(B5,{open:U,onClose:ie,onToggleRouteVisibility:m,isRouteVisible:_,onHomeClick:()=>console.log("Home clicked"),onAboutClick:()=>console.log("About clicked"),onServicesClick:()=>console.log("Services clicked"),onContactClick:()=>console.log("Contact clicked")}),Ne.jsx(F5,{open:r,onClose:V,onSelectCategories:a,selectedCategorySlugs:l,CategoryFilterComponent:K5}),Ne.jsx(Z5,{open:w,onClose:M,dialogImage:J5,telegramLink:QN,whatsappLink:JN,emailLink:e5})]})},t4=({isLoading:a})=>{const l=gl();return Ne.jsx($s,{sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100dvh",backgroundColor:l.palette.background.default,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:9999,opacity:a?1:0,visibility:a?"visible":"hidden",transition:"opacity 0.8s ease-out, visibility 0.8s ease-out",pointerEvents:a?"auto":"none"},children:Ne.jsx($s,{component:"img",src:"/logo.svg",alt:"My Hoian Logo",sx:{width:{xs:56,sm:82},height:"auto",objectFit:"contain",boxShadow:l.shadows[10],mb:3}})})};function SC(a){return a!==null&&typeof a=="object"&&"constructor"in a&&a.constructor===Object}function lb(a,l){a===void 0&&(a={}),l===void 0&&(l={});const m=["__proto__","constructor","prototype"];Object.keys(l).filter(_=>m.indexOf(_)<0).forEach(_=>{typeof a[_]>"u"?a[_]=l[_]:SC(l[_])&&SC(a[_])&&Object.keys(l[_]).length>0&&lb(a[_],l[_])})}const qA={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function Mf(){const a=typeof document<"u"?document:{};return lb(a,qA),a}const n4={document:qA,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(a){return typeof setTimeout>"u"?(a(),null):setTimeout(a,0)},cancelAnimationFrame(a){typeof setTimeout>"u"||clearTimeout(a)}};function Va(){const a=typeof window<"u"?window:{};return lb(a,n4),a}function i4(a){return a===void 0&&(a=""),a.trim().split(" ").filter(l=>!!l.trim())}function r4(a){const l=a;Object.keys(l).forEach(m=>{try{l[m]=null}catch{}try{delete l[m]}catch{}})}function HA(a,l){return l===void 0&&(l=0),setTimeout(a,l)}function By(){return Date.now()}function s4(a){const l=Va();let m;return l.getComputedStyle&&(m=l.getComputedStyle(a,null)),!m&&a.currentStyle&&(m=a.currentStyle),m||(m=a.style),m}function o4(a,l){l===void 0&&(l="x");const m=Va();let _,w,C;const M=s4(a);return m.WebKitCSSMatrix?(w=M.transform||M.webkitTransform,w.split(",").length>6&&(w=w.split(", ").map(r=>r.replace(",",".")).join(", ")),C=new m.WebKitCSSMatrix(w==="none"?"":w)):(C=M.MozTransform||M.OTransform||M.MsTransform||M.msTransform||M.transform||M.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),_=C.toString().split(",")),l==="x"&&(m.WebKitCSSMatrix?w=C.m41:_.length===16?w=parseFloat(_[12]):w=parseFloat(_[4])),l==="y"&&(m.WebKitCSSMatrix?w=C.m42:_.length===16?w=parseFloat(_[13]):w=parseFloat(_[5])),w||0}function gy(a){return typeof a=="object"&&a!==null&&a.constructor&&Object.prototype.toString.call(a).slice(8,-1)==="Object"}function a4(a){return typeof window<"u"&&typeof window.HTMLElement<"u"?a instanceof HTMLElement:a&&(a.nodeType===1||a.nodeType===11)}function Vl(){const a=Object(arguments.length<=0?void 0:arguments[0]),l=["__proto__","constructor","prototype"];for(let m=1;m<arguments.length;m+=1){const _=m<0||arguments.length<=m?void 0:arguments[m];if(_!=null&&!a4(_)){const w=Object.keys(Object(_)).filter(C=>l.indexOf(C)<0);for(let C=0,M=w.length;C<M;C+=1){const r=w[C],O=Object.getOwnPropertyDescriptor(_,r);O!==void 0&&O.enumerable&&(gy(a[r])&&gy(_[r])?_[r].__swiper__?a[r]=_[r]:Vl(a[r],_[r]):!gy(a[r])&&gy(_[r])?(a[r]={},_[r].__swiper__?a[r]=_[r]:Vl(a[r],_[r])):a[r]=_[r])}}}return a}function _y(a,l,m){a.style.setProperty(l,m)}function UA(a){let{swiper:l,targetPosition:m,side:_}=a;const w=Va(),C=-l.translate;let M=null,r;const O=l.params.speed;l.wrapperEl.style.scrollSnapType="none",w.cancelAnimationFrame(l.cssModeFrameID);const V=m>C?"next":"prev",U=(ie,de)=>V==="next"&&ie>=de||V==="prev"&&ie<=de,Z=()=>{r=new Date().getTime(),M===null&&(M=r);const ie=Math.max(Math.min((r-M)/O,1),0),de=.5-Math.cos(ie*Math.PI)/2;let se=C+de*(m-C);if(U(se,m)&&(se=m),l.wrapperEl.scrollTo({[_]:se}),U(se,m)){l.wrapperEl.style.overflow="hidden",l.wrapperEl.style.scrollSnapType="",setTimeout(()=>{l.wrapperEl.style.overflow="",l.wrapperEl.scrollTo({[_]:se})}),w.cancelAnimationFrame(l.cssModeFrameID);return}l.cssModeFrameID=w.requestAnimationFrame(Z)};Z()}function vd(a,l){l===void 0&&(l="");const m=Va(),_=[...a.children];return m.HTMLSlotElement&&a instanceof HTMLSlotElement&&_.push(...a.assignedElements()),l?_.filter(w=>w.matches(l)):_}function l4(a,l){const m=[l];for(;m.length>0;){const _=m.shift();if(a===_)return!0;m.push(..._.children,..._.shadowRoot?_.shadowRoot.children:[],..._.assignedElements?_.assignedElements():[])}}function c4(a,l){const m=Va();let _=l.contains(a);return!_&&m.HTMLSlotElement&&l instanceof HTMLSlotElement&&(_=[...l.assignedElements()].includes(a),_||(_=l4(a,l))),_}function Fy(a){try{console.warn(a);return}catch{}}function C0(a,l){l===void 0&&(l=[]);const m=document.createElement(a);return m.classList.add(...Array.isArray(l)?l:i4(l)),m}function u4(a,l){const m=[];for(;a.previousElementSibling;){const _=a.previousElementSibling;l?_.matches(l)&&m.push(_):m.push(_),a=_}return m}function h4(a,l){const m=[];for(;a.nextElementSibling;){const _=a.nextElementSibling;l?_.matches(l)&&m.push(_):m.push(_),a=_}return m}function Cp(a,l){return Va().getComputedStyle(a,null).getPropertyValue(l)}function CC(a){let l=a,m;if(l){for(m=0;(l=l.previousSibling)!==null;)l.nodeType===1&&(m+=1);return m}}function d4(a,l){const m=[];let _=a.parentElement;for(;_;)m.push(_),_=_.parentElement;return m}function EC(a,l,m){const _=Va();return a[l==="width"?"offsetWidth":"offsetHeight"]+parseFloat(_.getComputedStyle(a,null).getPropertyValue(l==="width"?"margin-right":"margin-top"))+parseFloat(_.getComputedStyle(a,null).getPropertyValue(l==="width"?"margin-left":"margin-bottom"))}function AC(a,l){l===void 0&&(l=""),typeof trustedTypes<"u"?a.innerHTML=trustedTypes.createPolicy("html",{createHTML:m=>m}).createHTML(l):a.innerHTML=l}let Yx;function p4(){const a=Va(),l=Mf();return{smoothScroll:l.documentElement&&l.documentElement.style&&"scrollBehavior"in l.documentElement.style,touch:!!("ontouchstart"in a||a.DocumentTouch&&l instanceof a.DocumentTouch)}}function $A(){return Yx||(Yx=p4()),Yx}let Qx;function f4(a){let{userAgent:l}=a===void 0?{}:a;const m=$A(),_=Va(),w=_.navigator.platform,C=l||_.navigator.userAgent,M={ios:!1,android:!1},r=_.screen.width,O=_.screen.height,V=C.match(/(Android);?[\s\/]+([\d.]+)?/);let U=C.match(/(iPad).*OS\s([\d_]+)/);const Z=C.match(/(iPod)(.*OS\s([\d_]+))?/),ie=!U&&C.match(/(iPhone\sOS|iOS)\s([\d_]+)/),de=w==="Win32";let se=w==="MacIntel";const ne=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!U&&se&&m.touch&&ne.indexOf(`${r}x${O}`)>=0&&(U=C.match(/(Version)\/([\d.]+)/),U||(U=[0,1,"13_0_0"]),se=!1),V&&!de&&(M.os="android",M.android=!0),(U||ie||Z)&&(M.os="ios",M.ios=!0),M}function GA(a){return a===void 0&&(a={}),Qx||(Qx=f4(a)),Qx}let Jx;function m4(){const a=Va(),l=GA();let m=!1;function _(){const r=a.navigator.userAgent.toLowerCase();return r.indexOf("safari")>=0&&r.indexOf("chrome")<0&&r.indexOf("android")<0}if(_()){const r=String(a.navigator.userAgent);if(r.includes("Version/")){const[O,V]=r.split("Version/")[1].split(" ")[0].split(".").map(U=>Number(U));m=O<16||O===16&&V<2}}const w=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(a.navigator.userAgent),C=_(),M=C||w&&l.ios;return{isSafari:m||C,needPerspectiveFix:m,need3dFix:M,isWebView:w}}function WA(){return Jx||(Jx=m4()),Jx}function g4(a){let{swiper:l,on:m,emit:_}=a;const w=Va();let C=null,M=null;const r=()=>{!l||l.destroyed||!l.initialized||(_("beforeResize"),_("resize"))},O=()=>{!l||l.destroyed||!l.initialized||(C=new ResizeObserver(Z=>{M=w.requestAnimationFrame(()=>{const{width:ie,height:de}=l;let se=ie,ne=de;Z.forEach(Se=>{let{contentBoxSize:me,contentRect:Re,target:ye}=Se;ye&&ye!==l.el||(se=Re?Re.width:(me[0]||me).inlineSize,ne=Re?Re.height:(me[0]||me).blockSize)}),(se!==ie||ne!==de)&&r()})}),C.observe(l.el))},V=()=>{M&&w.cancelAnimationFrame(M),C&&C.unobserve&&l.el&&(C.unobserve(l.el),C=null)},U=()=>{!l||l.destroyed||!l.initialized||_("orientationchange")};m("init",()=>{if(l.params.resizeObserver&&typeof w.ResizeObserver<"u"){O();return}w.addEventListener("resize",r),w.addEventListener("orientationchange",U)}),m("destroy",()=>{V(),w.removeEventListener("resize",r),w.removeEventListener("orientationchange",U)})}function _4(a){let{swiper:l,extendParams:m,on:_,emit:w}=a;const C=[],M=Va(),r=function(U,Z){Z===void 0&&(Z={});const ie=M.MutationObserver||M.WebkitMutationObserver,de=new ie(se=>{if(l.__preventObserver__)return;if(se.length===1){w("observerUpdate",se[0]);return}const ne=function(){w("observerUpdate",se[0])};M.requestAnimationFrame?M.requestAnimationFrame(ne):M.setTimeout(ne,0)});de.observe(U,{attributes:typeof Z.attributes>"u"?!0:Z.attributes,childList:l.isElement||(typeof Z.childList>"u"?!0:Z).childList,characterData:typeof Z.characterData>"u"?!0:Z.characterData}),C.push(de)},O=()=>{if(l.params.observer){if(l.params.observeParents){const U=d4(l.hostEl);for(let Z=0;Z<U.length;Z+=1)r(U[Z])}r(l.hostEl,{childList:l.params.observeSlideChildren}),r(l.wrapperEl,{attributes:!1})}},V=()=>{C.forEach(U=>{U.disconnect()}),C.splice(0,C.length)};m({observer:!1,observeParents:!1,observeSlideChildren:!1}),_("init",O),_("destroy",V)}var y4={on(a,l,m){const _=this;if(!_.eventsListeners||_.destroyed||typeof l!="function")return _;const w=m?"unshift":"push";return a.split(" ").forEach(C=>{_.eventsListeners[C]||(_.eventsListeners[C]=[]),_.eventsListeners[C][w](l)}),_},once(a,l,m){const _=this;if(!_.eventsListeners||_.destroyed||typeof l!="function")return _;function w(){_.off(a,w),w.__emitterProxy&&delete w.__emitterProxy;for(var C=arguments.length,M=new Array(C),r=0;r<C;r++)M[r]=arguments[r];l.apply(_,M)}return w.__emitterProxy=l,_.on(a,w,m)},onAny(a,l){const m=this;if(!m.eventsListeners||m.destroyed||typeof a!="function")return m;const _=l?"unshift":"push";return m.eventsAnyListeners.indexOf(a)<0&&m.eventsAnyListeners[_](a),m},offAny(a){const l=this;if(!l.eventsListeners||l.destroyed||!l.eventsAnyListeners)return l;const m=l.eventsAnyListeners.indexOf(a);return m>=0&&l.eventsAnyListeners.splice(m,1),l},off(a,l){const m=this;return!m.eventsListeners||m.destroyed||!m.eventsListeners||a.split(" ").forEach(_=>{typeof l>"u"?m.eventsListeners[_]=[]:m.eventsListeners[_]&&m.eventsListeners[_].forEach((w,C)=>{(w===l||w.__emitterProxy&&w.__emitterProxy===l)&&m.eventsListeners[_].splice(C,1)})}),m},emit(){const a=this;if(!a.eventsListeners||a.destroyed||!a.eventsListeners)return a;let l,m,_;for(var w=arguments.length,C=new Array(w),M=0;M<w;M++)C[M]=arguments[M];return typeof C[0]=="string"||Array.isArray(C[0])?(l=C[0],m=C.slice(1,C.length),_=a):(l=C[0].events,m=C[0].data,_=C[0].context||a),m.unshift(_),(Array.isArray(l)?l:l.split(" ")).forEach(O=>{a.eventsAnyListeners&&a.eventsAnyListeners.length&&a.eventsAnyListeners.forEach(V=>{V.apply(_,[O,...m])}),a.eventsListeners&&a.eventsListeners[O]&&a.eventsListeners[O].forEach(V=>{V.apply(_,m)})}),a}};function v4(){const a=this;let l,m;const _=a.el;typeof a.params.width<"u"&&a.params.width!==null?l=a.params.width:l=_.clientWidth,typeof a.params.height<"u"&&a.params.height!==null?m=a.params.height:m=_.clientHeight,!(l===0&&a.isHorizontal()||m===0&&a.isVertical())&&(l=l-parseInt(Cp(_,"padding-left")||0,10)-parseInt(Cp(_,"padding-right")||0,10),m=m-parseInt(Cp(_,"padding-top")||0,10)-parseInt(Cp(_,"padding-bottom")||0,10),Number.isNaN(l)&&(l=0),Number.isNaN(m)&&(m=0),Object.assign(a,{width:l,height:m,size:a.isHorizontal()?l:m}))}function x4(){const a=this;function l(Ge,et){return parseFloat(Ge.getPropertyValue(a.getDirectionLabel(et))||0)}const m=a.params,{wrapperEl:_,slidesEl:w,size:C,rtlTranslate:M,wrongRTL:r}=a,O=a.virtual&&m.virtual.enabled,V=O?a.virtual.slides.length:a.slides.length,U=vd(w,`.${a.params.slideClass}, swiper-slide`),Z=O?a.virtual.slides.length:U.length;let ie=[];const de=[],se=[];let ne=m.slidesOffsetBefore;typeof ne=="function"&&(ne=m.slidesOffsetBefore.call(a));let Se=m.slidesOffsetAfter;typeof Se=="function"&&(Se=m.slidesOffsetAfter.call(a));const me=a.snapGrid.length,Re=a.slidesGrid.length;let ye=m.spaceBetween,Le=-ne,De=0,Oe=0;if(typeof C>"u")return;typeof ye=="string"&&ye.indexOf("%")>=0?ye=parseFloat(ye.replace("%",""))/100*C:typeof ye=="string"&&(ye=parseFloat(ye)),a.virtualSize=-ye,U.forEach(Ge=>{M?Ge.style.marginLeft="":Ge.style.marginRight="",Ge.style.marginBottom="",Ge.style.marginTop=""}),m.centeredSlides&&m.cssMode&&(_y(_,"--swiper-centered-offset-before",""),_y(_,"--swiper-centered-offset-after",""));const Ee=m.grid&&m.grid.rows>1&&a.grid;Ee?a.grid.initSlides(U):a.grid&&a.grid.unsetSlides();let qe;const $e=m.slidesPerView==="auto"&&m.breakpoints&&Object.keys(m.breakpoints).filter(Ge=>typeof m.breakpoints[Ge].slidesPerView<"u").length>0;for(let Ge=0;Ge<Z;Ge+=1){qe=0;let et;if(U[Ge]&&(et=U[Ge]),Ee&&a.grid.updateSlide(Ge,et,U),!(U[Ge]&&Cp(et,"display")==="none")){if(m.slidesPerView==="auto"){$e&&(U[Ge].style[a.getDirectionLabel("width")]="");const mt=getComputedStyle(et),St=et.style.transform,xt=et.style.webkitTransform;if(St&&(et.style.transform="none"),xt&&(et.style.webkitTransform="none"),m.roundLengths)qe=a.isHorizontal()?EC(et,"width"):EC(et,"height");else{const At=l(mt,"width"),Ct=l(mt,"padding-left"),Ut=l(mt,"padding-right"),at=l(mt,"margin-left"),kt=l(mt,"margin-right"),qt=mt.getPropertyValue("box-sizing");if(qt&&qt==="border-box")qe=At+at+kt;else{const{clientWidth:lt,offsetWidth:Ht}=et;qe=At+Ct+Ut+at+kt+(Ht-lt)}}St&&(et.style.transform=St),xt&&(et.style.webkitTransform=xt),m.roundLengths&&(qe=Math.floor(qe))}else qe=(C-(m.slidesPerView-1)*ye)/m.slidesPerView,m.roundLengths&&(qe=Math.floor(qe)),U[Ge]&&(U[Ge].style[a.getDirectionLabel("width")]=`${qe}px`);U[Ge]&&(U[Ge].swiperSlideSize=qe),se.push(qe),m.centeredSlides?(Le=Le+qe/2+De/2+ye,De===0&&Ge!==0&&(Le=Le-C/2-ye),Ge===0&&(Le=Le-C/2-ye),Math.abs(Le)<1/1e3&&(Le=0),m.roundLengths&&(Le=Math.floor(Le)),Oe%m.slidesPerGroup===0&&ie.push(Le),de.push(Le)):(m.roundLengths&&(Le=Math.floor(Le)),(Oe-Math.min(a.params.slidesPerGroupSkip,Oe))%a.params.slidesPerGroup===0&&ie.push(Le),de.push(Le),Le=Le+qe+ye),a.virtualSize+=qe+ye,De=qe,Oe+=1}}if(a.virtualSize=Math.max(a.virtualSize,C)+Se,M&&r&&(m.effect==="slide"||m.effect==="coverflow")&&(_.style.width=`${a.virtualSize+ye}px`),m.setWrapperSize&&(_.style[a.getDirectionLabel("width")]=`${a.virtualSize+ye}px`),Ee&&a.grid.updateWrapperSize(qe,ie),!m.centeredSlides){const Ge=[];for(let et=0;et<ie.length;et+=1){let mt=ie[et];m.roundLengths&&(mt=Math.floor(mt)),ie[et]<=a.virtualSize-C&&Ge.push(mt)}ie=Ge,Math.floor(a.virtualSize-C)-Math.floor(ie[ie.length-1])>1&&ie.push(a.virtualSize-C)}if(O&&m.loop){const Ge=se[0]+ye;if(m.slidesPerGroup>1){const et=Math.ceil((a.virtual.slidesBefore+a.virtual.slidesAfter)/m.slidesPerGroup),mt=Ge*m.slidesPerGroup;for(let St=0;St<et;St+=1)ie.push(ie[ie.length-1]+mt)}for(let et=0;et<a.virtual.slidesBefore+a.virtual.slidesAfter;et+=1)m.slidesPerGroup===1&&ie.push(ie[ie.length-1]+Ge),de.push(de[de.length-1]+Ge),a.virtualSize+=Ge}if(ie.length===0&&(ie=[0]),ye!==0){const Ge=a.isHorizontal()&&M?"marginLeft":a.getDirectionLabel("marginRight");U.filter((et,mt)=>!m.cssMode||m.loop?!0:mt!==U.length-1).forEach(et=>{et.style[Ge]=`${ye}px`})}if(m.centeredSlides&&m.centeredSlidesBounds){let Ge=0;se.forEach(mt=>{Ge+=mt+(ye||0)}),Ge-=ye;const et=Ge>C?Ge-C:0;ie=ie.map(mt=>mt<=0?-ne:mt>et?et+Se:mt)}if(m.centerInsufficientSlides){let Ge=0;se.forEach(mt=>{Ge+=mt+(ye||0)}),Ge-=ye;const et=(m.slidesOffsetBefore||0)+(m.slidesOffsetAfter||0);if(Ge+et<C){const mt=(C-Ge-et)/2;ie.forEach((St,xt)=>{ie[xt]=St-mt}),de.forEach((St,xt)=>{de[xt]=St+mt})}}if(Object.assign(a,{slides:U,snapGrid:ie,slidesGrid:de,slidesSizesGrid:se}),m.centeredSlides&&m.cssMode&&!m.centeredSlidesBounds){_y(_,"--swiper-centered-offset-before",`${-ie[0]}px`),_y(_,"--swiper-centered-offset-after",`${a.size/2-se[se.length-1]/2}px`);const Ge=-a.snapGrid[0],et=-a.slidesGrid[0];a.snapGrid=a.snapGrid.map(mt=>mt+Ge),a.slidesGrid=a.slidesGrid.map(mt=>mt+et)}if(Z!==V&&a.emit("slidesLengthChange"),ie.length!==me&&(a.params.watchOverflow&&a.checkOverflow(),a.emit("snapGridLengthChange")),de.length!==Re&&a.emit("slidesGridLengthChange"),m.watchSlidesProgress&&a.updateSlidesOffset(),a.emit("slidesUpdated"),!O&&!m.cssMode&&(m.effect==="slide"||m.effect==="fade")){const Ge=`${m.containerModifierClass}backface-hidden`,et=a.el.classList.contains(Ge);Z<=m.maxBackfaceHiddenSlides?et||a.el.classList.add(Ge):et&&a.el.classList.remove(Ge)}}function b4(a){const l=this,m=[],_=l.virtual&&l.params.virtual.enabled;let w=0,C;typeof a=="number"?l.setTransition(a):a===!0&&l.setTransition(l.params.speed);const M=r=>_?l.slides[l.getSlideIndexByData(r)]:l.slides[r];if(l.params.slidesPerView!=="auto"&&l.params.slidesPerView>1)if(l.params.centeredSlides)(l.visibleSlides||[]).forEach(r=>{m.push(r)});else for(C=0;C<Math.ceil(l.params.slidesPerView);C+=1){const r=l.activeIndex+C;if(r>l.slides.length&&!_)break;m.push(M(r))}else m.push(M(l.activeIndex));for(C=0;C<m.length;C+=1)if(typeof m[C]<"u"){const r=m[C].offsetHeight;w=r>w?r:w}(w||w===0)&&(l.wrapperEl.style.height=`${w}px`)}function w4(){const a=this,l=a.slides,m=a.isElement?a.isHorizontal()?a.wrapperEl.offsetLeft:a.wrapperEl.offsetTop:0;for(let _=0;_<l.length;_+=1)l[_].swiperSlideOffset=(a.isHorizontal()?l[_].offsetLeft:l[_].offsetTop)-m-a.cssOverflowAdjustment()}const IC=(a,l,m)=>{l&&!a.classList.contains(m)?a.classList.add(m):!l&&a.classList.contains(m)&&a.classList.remove(m)};function T4(a){a===void 0&&(a=this&&this.translate||0);const l=this,m=l.params,{slides:_,rtlTranslate:w,snapGrid:C}=l;if(_.length===0)return;typeof _[0].swiperSlideOffset>"u"&&l.updateSlidesOffset();let M=-a;w&&(M=a),l.visibleSlidesIndexes=[],l.visibleSlides=[];let r=m.spaceBetween;typeof r=="string"&&r.indexOf("%")>=0?r=parseFloat(r.replace("%",""))/100*l.size:typeof r=="string"&&(r=parseFloat(r));for(let O=0;O<_.length;O+=1){const V=_[O];let U=V.swiperSlideOffset;m.cssMode&&m.centeredSlides&&(U-=_[0].swiperSlideOffset);const Z=(M+(m.centeredSlides?l.minTranslate():0)-U)/(V.swiperSlideSize+r),ie=(M-C[0]+(m.centeredSlides?l.minTranslate():0)-U)/(V.swiperSlideSize+r),de=-(M-U),se=de+l.slidesSizesGrid[O],ne=de>=0&&de<=l.size-l.slidesSizesGrid[O],Se=de>=0&&de<l.size-1||se>1&&se<=l.size||de<=0&&se>=l.size;Se&&(l.visibleSlides.push(V),l.visibleSlidesIndexes.push(O)),IC(V,Se,m.slideVisibleClass),IC(V,ne,m.slideFullyVisibleClass),V.progress=w?-Z:Z,V.originalProgress=w?-ie:ie}}function S4(a){const l=this;if(typeof a>"u"){const U=l.rtlTranslate?-1:1;a=l&&l.translate&&l.translate*U||0}const m=l.params,_=l.maxTranslate()-l.minTranslate();let{progress:w,isBeginning:C,isEnd:M,progressLoop:r}=l;const O=C,V=M;if(_===0)w=0,C=!0,M=!0;else{w=(a-l.minTranslate())/_;const U=Math.abs(a-l.minTranslate())<1,Z=Math.abs(a-l.maxTranslate())<1;C=U||w<=0,M=Z||w>=1,U&&(w=0),Z&&(w=1)}if(m.loop){const U=l.getSlideIndexByData(0),Z=l.getSlideIndexByData(l.slides.length-1),ie=l.slidesGrid[U],de=l.slidesGrid[Z],se=l.slidesGrid[l.slidesGrid.length-1],ne=Math.abs(a);ne>=ie?r=(ne-ie)/se:r=(ne+se-de)/se,r>1&&(r-=1)}Object.assign(l,{progress:w,progressLoop:r,isBeginning:C,isEnd:M}),(m.watchSlidesProgress||m.centeredSlides&&m.autoHeight)&&l.updateSlidesProgress(a),C&&!O&&l.emit("reachBeginning toEdge"),M&&!V&&l.emit("reachEnd toEdge"),(O&&!C||V&&!M)&&l.emit("fromEdge"),l.emit("progress",w)}const e0=(a,l,m)=>{l&&!a.classList.contains(m)?a.classList.add(m):!l&&a.classList.contains(m)&&a.classList.remove(m)};function C4(){const a=this,{slides:l,params:m,slidesEl:_,activeIndex:w}=a,C=a.virtual&&m.virtual.enabled,M=a.grid&&m.grid&&m.grid.rows>1,r=Z=>vd(_,`.${m.slideClass}${Z}, swiper-slide${Z}`)[0];let O,V,U;if(C)if(m.loop){let Z=w-a.virtual.slidesBefore;Z<0&&(Z=a.virtual.slides.length+Z),Z>=a.virtual.slides.length&&(Z-=a.virtual.slides.length),O=r(`[data-swiper-slide-index="${Z}"]`)}else O=r(`[data-swiper-slide-index="${w}"]`);else M?(O=l.find(Z=>Z.column===w),U=l.find(Z=>Z.column===w+1),V=l.find(Z=>Z.column===w-1)):O=l[w];O&&(M||(U=h4(O,`.${m.slideClass}, swiper-slide`)[0],m.loop&&!U&&(U=l[0]),V=u4(O,`.${m.slideClass}, swiper-slide`)[0],m.loop&&!V===0&&(V=l[l.length-1]))),l.forEach(Z=>{e0(Z,Z===O,m.slideActiveClass),e0(Z,Z===U,m.slideNextClass),e0(Z,Z===V,m.slidePrevClass)}),a.emitSlidesClasses()}const Sy=(a,l)=>{if(!a||a.destroyed||!a.params)return;const m=()=>a.isElement?"swiper-slide":`.${a.params.slideClass}`,_=l.closest(m());if(_){let w=_.querySelector(`.${a.params.lazyPreloaderClass}`);!w&&a.isElement&&(_.shadowRoot?w=_.shadowRoot.querySelector(`.${a.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{_.shadowRoot&&(w=_.shadowRoot.querySelector(`.${a.params.lazyPreloaderClass}`),w&&w.remove())})),w&&w.remove()}},t0=(a,l)=>{if(!a.slides[l])return;const m=a.slides[l].querySelector('[loading="lazy"]');m&&m.removeAttribute("loading")},E0=a=>{if(!a||a.destroyed||!a.params)return;let l=a.params.lazyPreloadPrevNext;const m=a.slides.length;if(!m||!l||l<0)return;l=Math.min(l,m);const _=a.params.slidesPerView==="auto"?a.slidesPerViewDynamic():Math.ceil(a.params.slidesPerView),w=a.activeIndex;if(a.params.grid&&a.params.grid.rows>1){const M=w,r=[M-l];r.push(...Array.from({length:l}).map((O,V)=>M+_+V)),a.slides.forEach((O,V)=>{r.includes(O.column)&&t0(a,V)});return}const C=w+_-1;if(a.params.rewind||a.params.loop)for(let M=w-l;M<=C+l;M+=1){const r=(M%m+m)%m;(r<w||r>C)&&t0(a,r)}else for(let M=Math.max(w-l,0);M<=Math.min(C+l,m-1);M+=1)M!==w&&(M>C||M<w)&&t0(a,M)};function E4(a){const{slidesGrid:l,params:m}=a,_=a.rtlTranslate?a.translate:-a.translate;let w;for(let C=0;C<l.length;C+=1)typeof l[C+1]<"u"?_>=l[C]&&_<l[C+1]-(l[C+1]-l[C])/2?w=C:_>=l[C]&&_<l[C+1]&&(w=C+1):_>=l[C]&&(w=C);return m.normalizeSlideIndex&&(w<0||typeof w>"u")&&(w=0),w}function A4(a){const l=this,m=l.rtlTranslate?l.translate:-l.translate,{snapGrid:_,params:w,activeIndex:C,realIndex:M,snapIndex:r}=l;let O=a,V;const U=de=>{let se=de-l.virtual.slidesBefore;return se<0&&(se=l.virtual.slides.length+se),se>=l.virtual.slides.length&&(se-=l.virtual.slides.length),se};if(typeof O>"u"&&(O=E4(l)),_.indexOf(m)>=0)V=_.indexOf(m);else{const de=Math.min(w.slidesPerGroupSkip,O);V=de+Math.floor((O-de)/w.slidesPerGroup)}if(V>=_.length&&(V=_.length-1),O===C&&!l.params.loop){V!==r&&(l.snapIndex=V,l.emit("snapIndexChange"));return}if(O===C&&l.params.loop&&l.virtual&&l.params.virtual.enabled){l.realIndex=U(O);return}const Z=l.grid&&w.grid&&w.grid.rows>1;let ie;if(l.virtual&&w.virtual.enabled&&w.loop)ie=U(O);else if(Z){const de=l.slides.find(ne=>ne.column===O);let se=parseInt(de.getAttribute("data-swiper-slide-index"),10);Number.isNaN(se)&&(se=Math.max(l.slides.indexOf(de),0)),ie=Math.floor(se/w.grid.rows)}else if(l.slides[O]){const de=l.slides[O].getAttribute("data-swiper-slide-index");de?ie=parseInt(de,10):ie=O}else ie=O;Object.assign(l,{previousSnapIndex:r,snapIndex:V,previousRealIndex:M,realIndex:ie,previousIndex:C,activeIndex:O}),l.initialized&&E0(l),l.emit("activeIndexChange"),l.emit("snapIndexChange"),(l.initialized||l.params.runCallbacksOnInit)&&(M!==ie&&l.emit("realIndexChange"),l.emit("slideChange"))}function I4(a,l){const m=this,_=m.params;let w=a.closest(`.${_.slideClass}, swiper-slide`);!w&&m.isElement&&l&&l.length>1&&l.includes(a)&&[...l.slice(l.indexOf(a)+1,l.length)].forEach(r=>{!w&&r.matches&&r.matches(`.${_.slideClass}, swiper-slide`)&&(w=r)});let C=!1,M;if(w){for(let r=0;r<m.slides.length;r+=1)if(m.slides[r]===w){C=!0,M=r;break}}if(w&&C)m.clickedSlide=w,m.virtual&&m.params.virtual.enabled?m.clickedIndex=parseInt(w.getAttribute("data-swiper-slide-index"),10):m.clickedIndex=M;else{m.clickedSlide=void 0,m.clickedIndex=void 0;return}_.slideToClickedSlide&&m.clickedIndex!==void 0&&m.clickedIndex!==m.activeIndex&&m.slideToClickedSlide()}var P4={updateSize:v4,updateSlides:x4,updateAutoHeight:b4,updateSlidesOffset:w4,updateSlidesProgress:T4,updateProgress:S4,updateSlidesClasses:C4,updateActiveIndex:A4,updateClickedSlide:I4};function k4(a){a===void 0&&(a=this.isHorizontal()?"x":"y");const l=this,{params:m,rtlTranslate:_,translate:w,wrapperEl:C}=l;if(m.virtualTranslate)return _?-w:w;if(m.cssMode)return w;let M=o4(C,a);return M+=l.cssOverflowAdjustment(),_&&(M=-M),M||0}function M4(a,l){const m=this,{rtlTranslate:_,params:w,wrapperEl:C,progress:M}=m;let r=0,O=0;const V=0;m.isHorizontal()?r=_?-a:a:O=a,w.roundLengths&&(r=Math.floor(r),O=Math.floor(O)),m.previousTranslate=m.translate,m.translate=m.isHorizontal()?r:O,w.cssMode?C[m.isHorizontal()?"scrollLeft":"scrollTop"]=m.isHorizontal()?-r:-O:w.virtualTranslate||(m.isHorizontal()?r-=m.cssOverflowAdjustment():O-=m.cssOverflowAdjustment(),C.style.transform=`translate3d(${r}px, ${O}px, ${V}px)`);let U;const Z=m.maxTranslate()-m.minTranslate();Z===0?U=0:U=(a-m.minTranslate())/Z,U!==M&&m.updateProgress(a),m.emit("setTranslate",m.translate,l)}function R4(){return-this.snapGrid[0]}function z4(){return-this.snapGrid[this.snapGrid.length-1]}function L4(a,l,m,_,w){a===void 0&&(a=0),l===void 0&&(l=this.params.speed),m===void 0&&(m=!0),_===void 0&&(_=!0);const C=this,{params:M,wrapperEl:r}=C;if(C.animating&&M.preventInteractionOnTransition)return!1;const O=C.minTranslate(),V=C.maxTranslate();let U;if(_&&a>O?U=O:_&&a<V?U=V:U=a,C.updateProgress(U),M.cssMode){const Z=C.isHorizontal();if(l===0)r[Z?"scrollLeft":"scrollTop"]=-U;else{if(!C.support.smoothScroll)return UA({swiper:C,targetPosition:-U,side:Z?"left":"top"}),!0;r.scrollTo({[Z?"left":"top"]:-U,behavior:"smooth"})}return!0}return l===0?(C.setTransition(0),C.setTranslate(U),m&&(C.emit("beforeTransitionStart",l,w),C.emit("transitionEnd"))):(C.setTransition(l),C.setTranslate(U),m&&(C.emit("beforeTransitionStart",l,w),C.emit("transitionStart")),C.animating||(C.animating=!0,C.onTranslateToWrapperTransitionEnd||(C.onTranslateToWrapperTransitionEnd=function(ie){!C||C.destroyed||ie.target===this&&(C.wrapperEl.removeEventListener("transitionend",C.onTranslateToWrapperTransitionEnd),C.onTranslateToWrapperTransitionEnd=null,delete C.onTranslateToWrapperTransitionEnd,C.animating=!1,m&&C.emit("transitionEnd"))}),C.wrapperEl.addEventListener("transitionend",C.onTranslateToWrapperTransitionEnd))),!0}var D4={getTranslate:k4,setTranslate:M4,minTranslate:R4,maxTranslate:z4,translateTo:L4};function O4(a,l){const m=this;m.params.cssMode||(m.wrapperEl.style.transitionDuration=`${a}ms`,m.wrapperEl.style.transitionDelay=a===0?"0ms":""),m.emit("setTransition",a,l)}function ZA(a){let{swiper:l,runCallbacks:m,direction:_,step:w}=a;const{activeIndex:C,previousIndex:M}=l;let r=_;r||(C>M?r="next":C<M?r="prev":r="reset"),l.emit(`transition${w}`),m&&r==="reset"?l.emit(`slideResetTransition${w}`):m&&C!==M&&(l.emit(`slideChangeTransition${w}`),r==="next"?l.emit(`slideNextTransition${w}`):l.emit(`slidePrevTransition${w}`))}function B4(a,l){a===void 0&&(a=!0);const m=this,{params:_}=m;_.cssMode||(_.autoHeight&&m.updateAutoHeight(),ZA({swiper:m,runCallbacks:a,direction:l,step:"Start"}))}function F4(a,l){a===void 0&&(a=!0);const m=this,{params:_}=m;m.animating=!1,!_.cssMode&&(m.setTransition(0),ZA({swiper:m,runCallbacks:a,direction:l,step:"End"}))}var j4={setTransition:O4,transitionStart:B4,transitionEnd:F4};function N4(a,l,m,_,w){a===void 0&&(a=0),m===void 0&&(m=!0),typeof a=="string"&&(a=parseInt(a,10));const C=this;let M=a;M<0&&(M=0);const{params:r,snapGrid:O,slidesGrid:V,previousIndex:U,activeIndex:Z,rtlTranslate:ie,wrapperEl:de,enabled:se}=C;if(!se&&!_&&!w||C.destroyed||C.animating&&r.preventInteractionOnTransition)return!1;typeof l>"u"&&(l=C.params.speed);const ne=Math.min(C.params.slidesPerGroupSkip,M);let Se=ne+Math.floor((M-ne)/C.params.slidesPerGroup);Se>=O.length&&(Se=O.length-1);const me=-O[Se];if(r.normalizeSlideIndex)for(let Ee=0;Ee<V.length;Ee+=1){const qe=-Math.floor(me*100),$e=Math.floor(V[Ee]*100),Ge=Math.floor(V[Ee+1]*100);typeof V[Ee+1]<"u"?qe>=$e&&qe<Ge-(Ge-$e)/2?M=Ee:qe>=$e&&qe<Ge&&(M=Ee+1):qe>=$e&&(M=Ee)}if(C.initialized&&M!==Z&&(!C.allowSlideNext&&(ie?me>C.translate&&me>C.minTranslate():me<C.translate&&me<C.minTranslate())||!C.allowSlidePrev&&me>C.translate&&me>C.maxTranslate()&&(Z||0)!==M))return!1;M!==(U||0)&&m&&C.emit("beforeSlideChangeStart"),C.updateProgress(me);let Re;M>Z?Re="next":M<Z?Re="prev":Re="reset";const ye=C.virtual&&C.params.virtual.enabled;if(!(ye&&w)&&(ie&&-me===C.translate||!ie&&me===C.translate))return C.updateActiveIndex(M),r.autoHeight&&C.updateAutoHeight(),C.updateSlidesClasses(),r.effect!=="slide"&&C.setTranslate(me),Re!=="reset"&&(C.transitionStart(m,Re),C.transitionEnd(m,Re)),!1;if(r.cssMode){const Ee=C.isHorizontal(),qe=ie?me:-me;if(l===0)ye&&(C.wrapperEl.style.scrollSnapType="none",C._immediateVirtual=!0),ye&&!C._cssModeVirtualInitialSet&&C.params.initialSlide>0?(C._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{de[Ee?"scrollLeft":"scrollTop"]=qe})):de[Ee?"scrollLeft":"scrollTop"]=qe,ye&&requestAnimationFrame(()=>{C.wrapperEl.style.scrollSnapType="",C._immediateVirtual=!1});else{if(!C.support.smoothScroll)return UA({swiper:C,targetPosition:qe,side:Ee?"left":"top"}),!0;de.scrollTo({[Ee?"left":"top"]:qe,behavior:"smooth"})}return!0}const Oe=WA().isSafari;return ye&&!w&&Oe&&C.isElement&&C.virtual.update(!1,!1,M),C.setTransition(l),C.setTranslate(me),C.updateActiveIndex(M),C.updateSlidesClasses(),C.emit("beforeTransitionStart",l,_),C.transitionStart(m,Re),l===0?C.transitionEnd(m,Re):C.animating||(C.animating=!0,C.onSlideToWrapperTransitionEnd||(C.onSlideToWrapperTransitionEnd=function(qe){!C||C.destroyed||qe.target===this&&(C.wrapperEl.removeEventListener("transitionend",C.onSlideToWrapperTransitionEnd),C.onSlideToWrapperTransitionEnd=null,delete C.onSlideToWrapperTransitionEnd,C.transitionEnd(m,Re))}),C.wrapperEl.addEventListener("transitionend",C.onSlideToWrapperTransitionEnd)),!0}function V4(a,l,m,_){a===void 0&&(a=0),m===void 0&&(m=!0),typeof a=="string"&&(a=parseInt(a,10));const w=this;if(w.destroyed)return;typeof l>"u"&&(l=w.params.speed);const C=w.grid&&w.params.grid&&w.params.grid.rows>1;let M=a;if(w.params.loop)if(w.virtual&&w.params.virtual.enabled)M=M+w.virtual.slidesBefore;else{let r;if(C){const ie=M*w.params.grid.rows;r=w.slides.find(de=>de.getAttribute("data-swiper-slide-index")*1===ie).column}else r=w.getSlideIndexByData(M);const O=C?Math.ceil(w.slides.length/w.params.grid.rows):w.slides.length,{centeredSlides:V}=w.params;let U=w.params.slidesPerView;U==="auto"?U=w.slidesPerViewDynamic():(U=Math.ceil(parseFloat(w.params.slidesPerView,10)),V&&U%2===0&&(U=U+1));let Z=O-r<U;if(V&&(Z=Z||r<Math.ceil(U/2)),_&&V&&w.params.slidesPerView!=="auto"&&!C&&(Z=!1),Z){const ie=V?r<w.activeIndex?"prev":"next":r-w.activeIndex-1<w.params.slidesPerView?"next":"prev";w.loopFix({direction:ie,slideTo:!0,activeSlideIndex:ie==="next"?r+1:r-O+1,slideRealIndex:ie==="next"?w.realIndex:void 0})}if(C){const ie=M*w.params.grid.rows;M=w.slides.find(de=>de.getAttribute("data-swiper-slide-index")*1===ie).column}else M=w.getSlideIndexByData(M)}return requestAnimationFrame(()=>{w.slideTo(M,l,m,_)}),w}function q4(a,l,m){l===void 0&&(l=!0);const _=this,{enabled:w,params:C,animating:M}=_;if(!w||_.destroyed)return _;typeof a>"u"&&(a=_.params.speed);let r=C.slidesPerGroup;C.slidesPerView==="auto"&&C.slidesPerGroup===1&&C.slidesPerGroupAuto&&(r=Math.max(_.slidesPerViewDynamic("current",!0),1));const O=_.activeIndex<C.slidesPerGroupSkip?1:r,V=_.virtual&&C.virtual.enabled;if(C.loop){if(M&&!V&&C.loopPreventsSliding)return!1;if(_.loopFix({direction:"next"}),_._clientLeft=_.wrapperEl.clientLeft,_.activeIndex===_.slides.length-1&&C.cssMode)return requestAnimationFrame(()=>{_.slideTo(_.activeIndex+O,a,l,m)}),!0}return C.rewind&&_.isEnd?_.slideTo(0,a,l,m):_.slideTo(_.activeIndex+O,a,l,m)}function H4(a,l,m){l===void 0&&(l=!0);const _=this,{params:w,snapGrid:C,slidesGrid:M,rtlTranslate:r,enabled:O,animating:V}=_;if(!O||_.destroyed)return _;typeof a>"u"&&(a=_.params.speed);const U=_.virtual&&w.virtual.enabled;if(w.loop){if(V&&!U&&w.loopPreventsSliding)return!1;_.loopFix({direction:"prev"}),_._clientLeft=_.wrapperEl.clientLeft}const Z=r?_.translate:-_.translate;function ie(Re){return Re<0?-Math.floor(Math.abs(Re)):Math.floor(Re)}const de=ie(Z),se=C.map(Re=>ie(Re)),ne=w.freeMode&&w.freeMode.enabled;let Se=C[se.indexOf(de)-1];if(typeof Se>"u"&&(w.cssMode||ne)){let Re;C.forEach((ye,Le)=>{de>=ye&&(Re=Le)}),typeof Re<"u"&&(Se=ne?C[Re]:C[Re>0?Re-1:Re])}let me=0;if(typeof Se<"u"&&(me=M.indexOf(Se),me<0&&(me=_.activeIndex-1),w.slidesPerView==="auto"&&w.slidesPerGroup===1&&w.slidesPerGroupAuto&&(me=me-_.slidesPerViewDynamic("previous",!0)+1,me=Math.max(me,0))),w.rewind&&_.isBeginning){const Re=_.params.virtual&&_.params.virtual.enabled&&_.virtual?_.virtual.slides.length-1:_.slides.length-1;return _.slideTo(Re,a,l,m)}else if(w.loop&&_.activeIndex===0&&w.cssMode)return requestAnimationFrame(()=>{_.slideTo(me,a,l,m)}),!0;return _.slideTo(me,a,l,m)}function U4(a,l,m){l===void 0&&(l=!0);const _=this;if(!_.destroyed)return typeof a>"u"&&(a=_.params.speed),_.slideTo(_.activeIndex,a,l,m)}function $4(a,l,m,_){l===void 0&&(l=!0),_===void 0&&(_=.5);const w=this;if(w.destroyed)return;typeof a>"u"&&(a=w.params.speed);let C=w.activeIndex;const M=Math.min(w.params.slidesPerGroupSkip,C),r=M+Math.floor((C-M)/w.params.slidesPerGroup),O=w.rtlTranslate?w.translate:-w.translate;if(O>=w.snapGrid[r]){const V=w.snapGrid[r],U=w.snapGrid[r+1];O-V>(U-V)*_&&(C+=w.params.slidesPerGroup)}else{const V=w.snapGrid[r-1],U=w.snapGrid[r];O-V<=(U-V)*_&&(C-=w.params.slidesPerGroup)}return C=Math.max(C,0),C=Math.min(C,w.slidesGrid.length-1),w.slideTo(C,a,l,m)}function G4(){const a=this;if(a.destroyed)return;const{params:l,slidesEl:m}=a,_=l.slidesPerView==="auto"?a.slidesPerViewDynamic():l.slidesPerView;let w=a.getSlideIndexWhenGrid(a.clickedIndex),C;const M=a.isElement?"swiper-slide":`.${l.slideClass}`,r=a.grid&&a.params.grid&&a.params.grid.rows>1;if(l.loop){if(a.animating)return;C=parseInt(a.clickedSlide.getAttribute("data-swiper-slide-index"),10),l.centeredSlides?a.slideToLoop(C):w>(r?(a.slides.length-_)/2-(a.params.grid.rows-1):a.slides.length-_)?(a.loopFix(),w=a.getSlideIndex(vd(m,`${M}[data-swiper-slide-index="${C}"]`)[0]),HA(()=>{a.slideTo(w)})):a.slideTo(w)}else a.slideTo(w)}var W4={slideTo:N4,slideToLoop:V4,slideNext:q4,slidePrev:H4,slideReset:U4,slideToClosest:$4,slideToClickedSlide:G4};function Z4(a,l){const m=this,{params:_,slidesEl:w}=m;if(!_.loop||m.virtual&&m.params.virtual.enabled)return;const C=()=>{vd(w,`.${_.slideClass}, swiper-slide`).forEach((de,se)=>{de.setAttribute("data-swiper-slide-index",se)})},M=()=>{const ie=vd(w,`.${_.slideBlankClass}`);ie.forEach(de=>{de.remove()}),ie.length>0&&(m.recalcSlides(),m.updateSlides())},r=m.grid&&_.grid&&_.grid.rows>1;_.loopAddBlankSlides&&(_.slidesPerGroup>1||r)&&M();const O=_.slidesPerGroup*(r?_.grid.rows:1),V=m.slides.length%O!==0,U=r&&m.slides.length%_.grid.rows!==0,Z=ie=>{for(let de=0;de<ie;de+=1){const se=m.isElement?C0("swiper-slide",[_.slideBlankClass]):C0("div",[_.slideClass,_.slideBlankClass]);m.slidesEl.append(se)}};if(V){if(_.loopAddBlankSlides){const ie=O-m.slides.length%O;Z(ie),m.recalcSlides(),m.updateSlides()}else Fy("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");C()}else if(U){if(_.loopAddBlankSlides){const ie=_.grid.rows-m.slides.length%_.grid.rows;Z(ie),m.recalcSlides(),m.updateSlides()}else Fy("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");C()}else C();m.loopFix({slideRealIndex:a,direction:_.centeredSlides?void 0:"next",initial:l})}function K4(a){let{slideRealIndex:l,slideTo:m=!0,direction:_,setTranslate:w,activeSlideIndex:C,initial:M,byController:r,byMousewheel:O}=a===void 0?{}:a;const V=this;if(!V.params.loop)return;V.emit("beforeLoopFix");const{slides:U,allowSlidePrev:Z,allowSlideNext:ie,slidesEl:de,params:se}=V,{centeredSlides:ne,initialSlide:Se}=se;if(V.allowSlidePrev=!0,V.allowSlideNext=!0,V.virtual&&se.virtual.enabled){m&&(!se.centeredSlides&&V.snapIndex===0?V.slideTo(V.virtual.slides.length,0,!1,!0):se.centeredSlides&&V.snapIndex<se.slidesPerView?V.slideTo(V.virtual.slides.length+V.snapIndex,0,!1,!0):V.snapIndex===V.snapGrid.length-1&&V.slideTo(V.virtual.slidesBefore,0,!1,!0)),V.allowSlidePrev=Z,V.allowSlideNext=ie,V.emit("loopFix");return}let me=se.slidesPerView;me==="auto"?me=V.slidesPerViewDynamic():(me=Math.ceil(parseFloat(se.slidesPerView,10)),ne&&me%2===0&&(me=me+1));const Re=se.slidesPerGroupAuto?me:se.slidesPerGroup;let ye=ne?Math.max(Re,Math.ceil(me/2)):Re;ye%Re!==0&&(ye+=Re-ye%Re),ye+=se.loopAdditionalSlides,V.loopedSlides=ye;const Le=V.grid&&se.grid&&se.grid.rows>1;U.length<me+ye||V.params.effect==="cards"&&U.length<me+ye*2?Fy("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled or not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):Le&&se.grid.fill==="row"&&Fy("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const De=[],Oe=[],Ee=Le?Math.ceil(U.length/se.grid.rows):U.length,qe=M&&Ee-Se<me&&!ne;let $e=qe?Se:V.activeIndex;typeof C>"u"?C=V.getSlideIndex(U.find(Ct=>Ct.classList.contains(se.slideActiveClass))):$e=C;const Ge=_==="next"||!_,et=_==="prev"||!_;let mt=0,St=0;const At=(Le?U[C].column:C)+(ne&&typeof w>"u"?-me/2+.5:0);if(At<ye){mt=Math.max(ye-At,Re);for(let Ct=0;Ct<ye-At;Ct+=1){const Ut=Ct-Math.floor(Ct/Ee)*Ee;if(Le){const at=Ee-Ut-1;for(let kt=U.length-1;kt>=0;kt-=1)U[kt].column===at&&De.push(kt)}else De.push(Ee-Ut-1)}}else if(At+me>Ee-ye){St=Math.max(At-(Ee-ye*2),Re),qe&&(St=Math.max(St,me-Ee+Se+1));for(let Ct=0;Ct<St;Ct+=1){const Ut=Ct-Math.floor(Ct/Ee)*Ee;Le?U.forEach((at,kt)=>{at.column===Ut&&Oe.push(kt)}):Oe.push(Ut)}}if(V.__preventObserver__=!0,requestAnimationFrame(()=>{V.__preventObserver__=!1}),V.params.effect==="cards"&&U.length<me+ye*2&&(Oe.includes(C)&&Oe.splice(Oe.indexOf(C),1),De.includes(C)&&De.splice(De.indexOf(C),1)),et&&De.forEach(Ct=>{U[Ct].swiperLoopMoveDOM=!0,de.prepend(U[Ct]),U[Ct].swiperLoopMoveDOM=!1}),Ge&&Oe.forEach(Ct=>{U[Ct].swiperLoopMoveDOM=!0,de.append(U[Ct]),U[Ct].swiperLoopMoveDOM=!1}),V.recalcSlides(),se.slidesPerView==="auto"?V.updateSlides():Le&&(De.length>0&&et||Oe.length>0&&Ge)&&V.slides.forEach((Ct,Ut)=>{V.grid.updateSlide(Ut,Ct,V.slides)}),se.watchSlidesProgress&&V.updateSlidesOffset(),m){if(De.length>0&&et){if(typeof l>"u"){const Ct=V.slidesGrid[$e],at=V.slidesGrid[$e+mt]-Ct;O?V.setTranslate(V.translate-at):(V.slideTo($e+Math.ceil(mt),0,!1,!0),w&&(V.touchEventsData.startTranslate=V.touchEventsData.startTranslate-at,V.touchEventsData.currentTranslate=V.touchEventsData.currentTranslate-at))}else if(w){const Ct=Le?De.length/se.grid.rows:De.length;V.slideTo(V.activeIndex+Ct,0,!1,!0),V.touchEventsData.currentTranslate=V.translate}}else if(Oe.length>0&&Ge)if(typeof l>"u"){const Ct=V.slidesGrid[$e],at=V.slidesGrid[$e-St]-Ct;O?V.setTranslate(V.translate-at):(V.slideTo($e-St,0,!1,!0),w&&(V.touchEventsData.startTranslate=V.touchEventsData.startTranslate-at,V.touchEventsData.currentTranslate=V.touchEventsData.currentTranslate-at))}else{const Ct=Le?Oe.length/se.grid.rows:Oe.length;V.slideTo(V.activeIndex-Ct,0,!1,!0)}}if(V.allowSlidePrev=Z,V.allowSlideNext=ie,V.controller&&V.controller.control&&!r){const Ct={slideRealIndex:l,direction:_,setTranslate:w,activeSlideIndex:C,byController:!0};Array.isArray(V.controller.control)?V.controller.control.forEach(Ut=>{!Ut.destroyed&&Ut.params.loop&&Ut.loopFix({...Ct,slideTo:Ut.params.slidesPerView===se.slidesPerView?m:!1})}):V.controller.control instanceof V.constructor&&V.controller.control.params.loop&&V.controller.control.loopFix({...Ct,slideTo:V.controller.control.params.slidesPerView===se.slidesPerView?m:!1})}V.emit("loopFix")}function X4(){const a=this,{params:l,slidesEl:m}=a;if(!l.loop||!m||a.virtual&&a.params.virtual.enabled)return;a.recalcSlides();const _=[];a.slides.forEach(w=>{const C=typeof w.swiperSlideIndex>"u"?w.getAttribute("data-swiper-slide-index")*1:w.swiperSlideIndex;_[C]=w}),a.slides.forEach(w=>{w.removeAttribute("data-swiper-slide-index")}),_.forEach(w=>{m.append(w)}),a.recalcSlides(),a.slideTo(a.realIndex,0)}var Y4={loopCreate:Z4,loopFix:K4,loopDestroy:X4};function Q4(a){const l=this;if(!l.params.simulateTouch||l.params.watchOverflow&&l.isLocked||l.params.cssMode)return;const m=l.params.touchEventsTarget==="container"?l.el:l.wrapperEl;l.isElement&&(l.__preventObserver__=!0),m.style.cursor="move",m.style.cursor=a?"grabbing":"grab",l.isElement&&requestAnimationFrame(()=>{l.__preventObserver__=!1})}function J4(){const a=this;a.params.watchOverflow&&a.isLocked||a.params.cssMode||(a.isElement&&(a.__preventObserver__=!0),a[a.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",a.isElement&&requestAnimationFrame(()=>{a.__preventObserver__=!1}))}var e6={setGrabCursor:Q4,unsetGrabCursor:J4};function t6(a,l){l===void 0&&(l=this);function m(_){if(!_||_===Mf()||_===Va())return null;_.assignedSlot&&(_=_.assignedSlot);const w=_.closest(a);return!w&&!_.getRootNode?null:w||m(_.getRootNode().host)}return m(l)}function PC(a,l,m){const _=Va(),{params:w}=a,C=w.edgeSwipeDetection,M=w.edgeSwipeThreshold;return C&&(m<=M||m>=_.innerWidth-M)?C==="prevent"?(l.preventDefault(),!0):!1:!0}function n6(a){const l=this,m=Mf();let _=a;_.originalEvent&&(_=_.originalEvent);const w=l.touchEventsData;if(_.type==="pointerdown"){if(w.pointerId!==null&&w.pointerId!==_.pointerId)return;w.pointerId=_.pointerId}else _.type==="touchstart"&&_.targetTouches.length===1&&(w.touchId=_.targetTouches[0].identifier);if(_.type==="touchstart"){PC(l,_,_.targetTouches[0].pageX);return}const{params:C,touches:M,enabled:r}=l;if(!r||!C.simulateTouch&&_.pointerType==="mouse"||l.animating&&C.preventInteractionOnTransition)return;!l.animating&&C.cssMode&&C.loop&&l.loopFix();let O=_.target;if(C.touchEventsTarget==="wrapper"&&!c4(O,l.wrapperEl)||"which"in _&&_.which===3||"button"in _&&_.button>0||w.isTouched&&w.isMoved)return;const V=!!C.noSwipingClass&&C.noSwipingClass!=="",U=_.composedPath?_.composedPath():_.path;V&&_.target&&_.target.shadowRoot&&U&&(O=U[0]);const Z=C.noSwipingSelector?C.noSwipingSelector:`.${C.noSwipingClass}`,ie=!!(_.target&&_.target.shadowRoot);if(C.noSwiping&&(ie?t6(Z,O):O.closest(Z))){l.allowClick=!0;return}if(C.swipeHandler&&!O.closest(C.swipeHandler))return;M.currentX=_.pageX,M.currentY=_.pageY;const de=M.currentX,se=M.currentY;if(!PC(l,_,de))return;Object.assign(w,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),M.startX=de,M.startY=se,w.touchStartTime=By(),l.allowClick=!0,l.updateSize(),l.swipeDirection=void 0,C.threshold>0&&(w.allowThresholdMove=!1);let ne=!0;O.matches(w.focusableElements)&&(ne=!1,O.nodeName==="SELECT"&&(w.isTouched=!1)),m.activeElement&&m.activeElement.matches(w.focusableElements)&&m.activeElement!==O&&(_.pointerType==="mouse"||_.pointerType!=="mouse"&&!O.matches(w.focusableElements))&&m.activeElement.blur();const Se=ne&&l.allowTouchMove&&C.touchStartPreventDefault;(C.touchStartForcePreventDefault||Se)&&!O.isContentEditable&&_.preventDefault(),C.freeMode&&C.freeMode.enabled&&l.freeMode&&l.animating&&!C.cssMode&&l.freeMode.onTouchStart(),l.emit("touchStart",_)}function i6(a){const l=Mf(),m=this,_=m.touchEventsData,{params:w,touches:C,rtlTranslate:M,enabled:r}=m;if(!r||!w.simulateTouch&&a.pointerType==="mouse")return;let O=a;if(O.originalEvent&&(O=O.originalEvent),O.type==="pointermove"&&(_.touchId!==null||O.pointerId!==_.pointerId))return;let V;if(O.type==="touchmove"){if(V=[...O.changedTouches].find(De=>De.identifier===_.touchId),!V||V.identifier!==_.touchId)return}else V=O;if(!_.isTouched){_.startMoving&&_.isScrolling&&m.emit("touchMoveOpposite",O);return}const U=V.pageX,Z=V.pageY;if(O.preventedByNestedSwiper){C.startX=U,C.startY=Z;return}if(!m.allowTouchMove){O.target.matches(_.focusableElements)||(m.allowClick=!1),_.isTouched&&(Object.assign(C,{startX:U,startY:Z,currentX:U,currentY:Z}),_.touchStartTime=By());return}if(w.touchReleaseOnEdges&&!w.loop)if(m.isVertical()){if(Z<C.startY&&m.translate<=m.maxTranslate()||Z>C.startY&&m.translate>=m.minTranslate()){_.isTouched=!1,_.isMoved=!1;return}}else{if(M&&(U>C.startX&&-m.translate<=m.maxTranslate()||U<C.startX&&-m.translate>=m.minTranslate()))return;if(!M&&(U<C.startX&&m.translate<=m.maxTranslate()||U>C.startX&&m.translate>=m.minTranslate()))return}if(l.activeElement&&l.activeElement.matches(_.focusableElements)&&l.activeElement!==O.target&&O.pointerType!=="mouse"&&l.activeElement.blur(),l.activeElement&&O.target===l.activeElement&&O.target.matches(_.focusableElements)){_.isMoved=!0,m.allowClick=!1;return}_.allowTouchCallbacks&&m.emit("touchMove",O),C.previousX=C.currentX,C.previousY=C.currentY,C.currentX=U,C.currentY=Z;const ie=C.currentX-C.startX,de=C.currentY-C.startY;if(m.params.threshold&&Math.sqrt(ie**2+de**2)<m.params.threshold)return;if(typeof _.isScrolling>"u"){let De;m.isHorizontal()&&C.currentY===C.startY||m.isVertical()&&C.currentX===C.startX?_.isScrolling=!1:ie*ie+de*de>=25&&(De=Math.atan2(Math.abs(de),Math.abs(ie))*180/Math.PI,_.isScrolling=m.isHorizontal()?De>w.touchAngle:90-De>w.touchAngle)}if(_.isScrolling&&m.emit("touchMoveOpposite",O),typeof _.startMoving>"u"&&(C.currentX!==C.startX||C.currentY!==C.startY)&&(_.startMoving=!0),_.isScrolling||O.type==="touchmove"&&_.preventTouchMoveFromPointerMove){_.isTouched=!1;return}if(!_.startMoving)return;m.allowClick=!1,!w.cssMode&&O.cancelable&&O.preventDefault(),w.touchMoveStopPropagation&&!w.nested&&O.stopPropagation();let se=m.isHorizontal()?ie:de,ne=m.isHorizontal()?C.currentX-C.previousX:C.currentY-C.previousY;w.oneWayMovement&&(se=Math.abs(se)*(M?1:-1),ne=Math.abs(ne)*(M?1:-1)),C.diff=se,se*=w.touchRatio,M&&(se=-se,ne=-ne);const Se=m.touchesDirection;m.swipeDirection=se>0?"prev":"next",m.touchesDirection=ne>0?"prev":"next";const me=m.params.loop&&!w.cssMode,Re=m.touchesDirection==="next"&&m.allowSlideNext||m.touchesDirection==="prev"&&m.allowSlidePrev;if(!_.isMoved){if(me&&Re&&m.loopFix({direction:m.swipeDirection}),_.startTranslate=m.getTranslate(),m.setTransition(0),m.animating){const De=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});m.wrapperEl.dispatchEvent(De)}_.allowMomentumBounce=!1,w.grabCursor&&(m.allowSlideNext===!0||m.allowSlidePrev===!0)&&m.setGrabCursor(!0),m.emit("sliderFirstMove",O)}if(new Date().getTime(),w._loopSwapReset!==!1&&_.isMoved&&_.allowThresholdMove&&Se!==m.touchesDirection&&me&&Re&&Math.abs(se)>=1){Object.assign(C,{startX:U,startY:Z,currentX:U,currentY:Z,startTranslate:_.currentTranslate}),_.loopSwapReset=!0,_.startTranslate=_.currentTranslate;return}m.emit("sliderMove",O),_.isMoved=!0,_.currentTranslate=se+_.startTranslate;let ye=!0,Le=w.resistanceRatio;if(w.touchReleaseOnEdges&&(Le=0),se>0?(me&&Re&&_.allowThresholdMove&&_.currentTranslate>(w.centeredSlides?m.minTranslate()-m.slidesSizesGrid[m.activeIndex+1]-(w.slidesPerView!=="auto"&&m.slides.length-w.slidesPerView>=2?m.slidesSizesGrid[m.activeIndex+1]+m.params.spaceBetween:0)-m.params.spaceBetween:m.minTranslate())&&m.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),_.currentTranslate>m.minTranslate()&&(ye=!1,w.resistance&&(_.currentTranslate=m.minTranslate()-1+(-m.minTranslate()+_.startTranslate+se)**Le))):se<0&&(me&&Re&&_.allowThresholdMove&&_.currentTranslate<(w.centeredSlides?m.maxTranslate()+m.slidesSizesGrid[m.slidesSizesGrid.length-1]+m.params.spaceBetween+(w.slidesPerView!=="auto"&&m.slides.length-w.slidesPerView>=2?m.slidesSizesGrid[m.slidesSizesGrid.length-1]+m.params.spaceBetween:0):m.maxTranslate())&&m.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:m.slides.length-(w.slidesPerView==="auto"?m.slidesPerViewDynamic():Math.ceil(parseFloat(w.slidesPerView,10)))}),_.currentTranslate<m.maxTranslate()&&(ye=!1,w.resistance&&(_.currentTranslate=m.maxTranslate()+1-(m.maxTranslate()-_.startTranslate-se)**Le))),ye&&(O.preventedByNestedSwiper=!0),!m.allowSlideNext&&m.swipeDirection==="next"&&_.currentTranslate<_.startTranslate&&(_.currentTranslate=_.startTranslate),!m.allowSlidePrev&&m.swipeDirection==="prev"&&_.currentTranslate>_.startTranslate&&(_.currentTranslate=_.startTranslate),!m.allowSlidePrev&&!m.allowSlideNext&&(_.currentTranslate=_.startTranslate),w.threshold>0)if(Math.abs(se)>w.threshold||_.allowThresholdMove){if(!_.allowThresholdMove){_.allowThresholdMove=!0,C.startX=C.currentX,C.startY=C.currentY,_.currentTranslate=_.startTranslate,C.diff=m.isHorizontal()?C.currentX-C.startX:C.currentY-C.startY;return}}else{_.currentTranslate=_.startTranslate;return}!w.followFinger||w.cssMode||((w.freeMode&&w.freeMode.enabled&&m.freeMode||w.watchSlidesProgress)&&(m.updateActiveIndex(),m.updateSlidesClasses()),w.freeMode&&w.freeMode.enabled&&m.freeMode&&m.freeMode.onTouchMove(),m.updateProgress(_.currentTranslate),m.setTranslate(_.currentTranslate))}function r6(a){const l=this,m=l.touchEventsData;let _=a;_.originalEvent&&(_=_.originalEvent);let w;if(_.type==="touchend"||_.type==="touchcancel"){if(w=[..._.changedTouches].find(De=>De.identifier===m.touchId),!w||w.identifier!==m.touchId)return}else{if(m.touchId!==null||_.pointerId!==m.pointerId)return;w=_}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(_.type)&&!(["pointercancel","contextmenu"].includes(_.type)&&(l.browser.isSafari||l.browser.isWebView)))return;m.pointerId=null,m.touchId=null;const{params:M,touches:r,rtlTranslate:O,slidesGrid:V,enabled:U}=l;if(!U||!M.simulateTouch&&_.pointerType==="mouse")return;if(m.allowTouchCallbacks&&l.emit("touchEnd",_),m.allowTouchCallbacks=!1,!m.isTouched){m.isMoved&&M.grabCursor&&l.setGrabCursor(!1),m.isMoved=!1,m.startMoving=!1;return}M.grabCursor&&m.isMoved&&m.isTouched&&(l.allowSlideNext===!0||l.allowSlidePrev===!0)&&l.setGrabCursor(!1);const Z=By(),ie=Z-m.touchStartTime;if(l.allowClick){const De=_.path||_.composedPath&&_.composedPath();l.updateClickedSlide(De&&De[0]||_.target,De),l.emit("tap click",_),ie<300&&Z-m.lastClickTime<300&&l.emit("doubleTap doubleClick",_)}if(m.lastClickTime=By(),HA(()=>{l.destroyed||(l.allowClick=!0)}),!m.isTouched||!m.isMoved||!l.swipeDirection||r.diff===0&&!m.loopSwapReset||m.currentTranslate===m.startTranslate&&!m.loopSwapReset){m.isTouched=!1,m.isMoved=!1,m.startMoving=!1;return}m.isTouched=!1,m.isMoved=!1,m.startMoving=!1;let de;if(M.followFinger?de=O?l.translate:-l.translate:de=-m.currentTranslate,M.cssMode)return;if(M.freeMode&&M.freeMode.enabled){l.freeMode.onTouchEnd({currentPos:de});return}const se=de>=-l.maxTranslate()&&!l.params.loop;let ne=0,Se=l.slidesSizesGrid[0];for(let De=0;De<V.length;De+=De<M.slidesPerGroupSkip?1:M.slidesPerGroup){const Oe=De<M.slidesPerGroupSkip-1?1:M.slidesPerGroup;typeof V[De+Oe]<"u"?(se||de>=V[De]&&de<V[De+Oe])&&(ne=De,Se=V[De+Oe]-V[De]):(se||de>=V[De])&&(ne=De,Se=V[V.length-1]-V[V.length-2])}let me=null,Re=null;M.rewind&&(l.isBeginning?Re=M.virtual&&M.virtual.enabled&&l.virtual?l.virtual.slides.length-1:l.slides.length-1:l.isEnd&&(me=0));const ye=(de-V[ne])/Se,Le=ne<M.slidesPerGroupSkip-1?1:M.slidesPerGroup;if(ie>M.longSwipesMs){if(!M.longSwipes){l.slideTo(l.activeIndex);return}l.swipeDirection==="next"&&(ye>=M.longSwipesRatio?l.slideTo(M.rewind&&l.isEnd?me:ne+Le):l.slideTo(ne)),l.swipeDirection==="prev"&&(ye>1-M.longSwipesRatio?l.slideTo(ne+Le):Re!==null&&ye<0&&Math.abs(ye)>M.longSwipesRatio?l.slideTo(Re):l.slideTo(ne))}else{if(!M.shortSwipes){l.slideTo(l.activeIndex);return}l.navigation&&(_.target===l.navigation.nextEl||_.target===l.navigation.prevEl)?_.target===l.navigation.nextEl?l.slideTo(ne+Le):l.slideTo(ne):(l.swipeDirection==="next"&&l.slideTo(me!==null?me:ne+Le),l.swipeDirection==="prev"&&l.slideTo(Re!==null?Re:ne))}}function kC(){const a=this,{params:l,el:m}=a;if(m&&m.offsetWidth===0)return;l.breakpoints&&a.setBreakpoint();const{allowSlideNext:_,allowSlidePrev:w,snapGrid:C}=a,M=a.virtual&&a.params.virtual.enabled;a.allowSlideNext=!0,a.allowSlidePrev=!0,a.updateSize(),a.updateSlides(),a.updateSlidesClasses();const r=M&&l.loop;(l.slidesPerView==="auto"||l.slidesPerView>1)&&a.isEnd&&!a.isBeginning&&!a.params.centeredSlides&&!r?a.slideTo(a.slides.length-1,0,!1,!0):a.params.loop&&!M?a.slideToLoop(a.realIndex,0,!1,!0):a.slideTo(a.activeIndex,0,!1,!0),a.autoplay&&a.autoplay.running&&a.autoplay.paused&&(clearTimeout(a.autoplay.resizeTimeout),a.autoplay.resizeTimeout=setTimeout(()=>{a.autoplay&&a.autoplay.running&&a.autoplay.paused&&a.autoplay.resume()},500)),a.allowSlidePrev=w,a.allowSlideNext=_,a.params.watchOverflow&&C!==a.snapGrid&&a.checkOverflow()}function s6(a){const l=this;l.enabled&&(l.allowClick||(l.params.preventClicks&&a.preventDefault(),l.params.preventClicksPropagation&&l.animating&&(a.stopPropagation(),a.stopImmediatePropagation())))}function o6(){const a=this,{wrapperEl:l,rtlTranslate:m,enabled:_}=a;if(!_)return;a.previousTranslate=a.translate,a.isHorizontal()?a.translate=-l.scrollLeft:a.translate=-l.scrollTop,a.translate===0&&(a.translate=0),a.updateActiveIndex(),a.updateSlidesClasses();let w;const C=a.maxTranslate()-a.minTranslate();C===0?w=0:w=(a.translate-a.minTranslate())/C,w!==a.progress&&a.updateProgress(m?-a.translate:a.translate),a.emit("setTranslate",a.translate,!1)}function a6(a){const l=this;Sy(l,a.target),!(l.params.cssMode||l.params.slidesPerView!=="auto"&&!l.params.autoHeight)&&l.update()}function l6(){const a=this;a.documentTouchHandlerProceeded||(a.documentTouchHandlerProceeded=!0,a.params.touchReleaseOnEdges&&(a.el.style.touchAction="auto"))}const KA=(a,l)=>{const m=Mf(),{params:_,el:w,wrapperEl:C,device:M}=a,r=!!_.nested,O=l==="on"?"addEventListener":"removeEventListener",V=l;!w||typeof w=="string"||(m[O]("touchstart",a.onDocumentTouchStart,{passive:!1,capture:r}),w[O]("touchstart",a.onTouchStart,{passive:!1}),w[O]("pointerdown",a.onTouchStart,{passive:!1}),m[O]("touchmove",a.onTouchMove,{passive:!1,capture:r}),m[O]("pointermove",a.onTouchMove,{passive:!1,capture:r}),m[O]("touchend",a.onTouchEnd,{passive:!0}),m[O]("pointerup",a.onTouchEnd,{passive:!0}),m[O]("pointercancel",a.onTouchEnd,{passive:!0}),m[O]("touchcancel",a.onTouchEnd,{passive:!0}),m[O]("pointerout",a.onTouchEnd,{passive:!0}),m[O]("pointerleave",a.onTouchEnd,{passive:!0}),m[O]("contextmenu",a.onTouchEnd,{passive:!0}),(_.preventClicks||_.preventClicksPropagation)&&w[O]("click",a.onClick,!0),_.cssMode&&C[O]("scroll",a.onScroll),_.updateOnWindowResize?a[V](M.ios||M.android?"resize orientationchange observerUpdate":"resize observerUpdate",kC,!0):a[V]("observerUpdate",kC,!0),w[O]("load",a.onLoad,{capture:!0}))};function c6(){const a=this,{params:l}=a;a.onTouchStart=n6.bind(a),a.onTouchMove=i6.bind(a),a.onTouchEnd=r6.bind(a),a.onDocumentTouchStart=l6.bind(a),l.cssMode&&(a.onScroll=o6.bind(a)),a.onClick=s6.bind(a),a.onLoad=a6.bind(a),KA(a,"on")}function u6(){KA(this,"off")}var h6={attachEvents:c6,detachEvents:u6};const MC=(a,l)=>a.grid&&l.grid&&l.grid.rows>1;function d6(){const a=this,{realIndex:l,initialized:m,params:_,el:w}=a,C=_.breakpoints;if(!C||C&&Object.keys(C).length===0)return;const M=Mf(),r=_.breakpointsBase==="window"||!_.breakpointsBase?_.breakpointsBase:"container",O=["window","container"].includes(_.breakpointsBase)||!_.breakpointsBase?a.el:M.querySelector(_.breakpointsBase),V=a.getBreakpoint(C,r,O);if(!V||a.currentBreakpoint===V)return;const Z=(V in C?C[V]:void 0)||a.originalParams,ie=MC(a,_),de=MC(a,Z),se=a.params.grabCursor,ne=Z.grabCursor,Se=_.enabled;ie&&!de?(w.classList.remove(`${_.containerModifierClass}grid`,`${_.containerModifierClass}grid-column`),a.emitContainerClasses()):!ie&&de&&(w.classList.add(`${_.containerModifierClass}grid`),(Z.grid.fill&&Z.grid.fill==="column"||!Z.grid.fill&&_.grid.fill==="column")&&w.classList.add(`${_.containerModifierClass}grid-column`),a.emitContainerClasses()),se&&!ne?a.unsetGrabCursor():!se&&ne&&a.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(Oe=>{if(typeof Z[Oe]>"u")return;const Ee=_[Oe]&&_[Oe].enabled,qe=Z[Oe]&&Z[Oe].enabled;Ee&&!qe&&a[Oe].disable(),!Ee&&qe&&a[Oe].enable()});const me=Z.direction&&Z.direction!==_.direction,Re=_.loop&&(Z.slidesPerView!==_.slidesPerView||me),ye=_.loop;me&&m&&a.changeDirection(),Vl(a.params,Z);const Le=a.params.enabled,De=a.params.loop;Object.assign(a,{allowTouchMove:a.params.allowTouchMove,allowSlideNext:a.params.allowSlideNext,allowSlidePrev:a.params.allowSlidePrev}),Se&&!Le?a.disable():!Se&&Le&&a.enable(),a.currentBreakpoint=V,a.emit("_beforeBreakpoint",Z),m&&(Re?(a.loopDestroy(),a.loopCreate(l),a.updateSlides()):!ye&&De?(a.loopCreate(l),a.updateSlides()):ye&&!De&&a.loopDestroy()),a.emit("breakpoint",Z)}function p6(a,l,m){if(l===void 0&&(l="window"),!a||l==="container"&&!m)return;let _=!1;const w=Va(),C=l==="window"?w.innerHeight:m.clientHeight,M=Object.keys(a).map(r=>{if(typeof r=="string"&&r.indexOf("@")===0){const O=parseFloat(r.substr(1));return{value:C*O,point:r}}return{value:r,point:r}});M.sort((r,O)=>parseInt(r.value,10)-parseInt(O.value,10));for(let r=0;r<M.length;r+=1){const{point:O,value:V}=M[r];l==="window"?w.matchMedia(`(min-width: ${V}px)`).matches&&(_=O):V<=m.clientWidth&&(_=O)}return _||"max"}var f6={setBreakpoint:d6,getBreakpoint:p6};function m6(a,l){const m=[];return a.forEach(_=>{typeof _=="object"?Object.keys(_).forEach(w=>{_[w]&&m.push(l+w)}):typeof _=="string"&&m.push(l+_)}),m}function g6(){const a=this,{classNames:l,params:m,rtl:_,el:w,device:C}=a,M=m6(["initialized",m.direction,{"free-mode":a.params.freeMode&&m.freeMode.enabled},{autoheight:m.autoHeight},{rtl:_},{grid:m.grid&&m.grid.rows>1},{"grid-column":m.grid&&m.grid.rows>1&&m.grid.fill==="column"},{android:C.android},{ios:C.ios},{"css-mode":m.cssMode},{centered:m.cssMode&&m.centeredSlides},{"watch-progress":m.watchSlidesProgress}],m.containerModifierClass);l.push(...M),w.classList.add(...l),a.emitContainerClasses()}function _6(){const a=this,{el:l,classNames:m}=a;!l||typeof l=="string"||(l.classList.remove(...m),a.emitContainerClasses())}var y6={addClasses:g6,removeClasses:_6};function v6(){const a=this,{isLocked:l,params:m}=a,{slidesOffsetBefore:_}=m;if(_){const w=a.slides.length-1,C=a.slidesGrid[w]+a.slidesSizesGrid[w]+_*2;a.isLocked=a.size>C}else a.isLocked=a.snapGrid.length===1;m.allowSlideNext===!0&&(a.allowSlideNext=!a.isLocked),m.allowSlidePrev===!0&&(a.allowSlidePrev=!a.isLocked),l&&l!==a.isLocked&&(a.isEnd=!1),l!==a.isLocked&&a.emit(a.isLocked?"lock":"unlock")}var x6={checkOverflow:v6},A0={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function b6(a,l){return function(_){_===void 0&&(_={});const w=Object.keys(_)[0],C=_[w];if(typeof C!="object"||C===null){Vl(l,_);return}if(a[w]===!0&&(a[w]={enabled:!0}),w==="navigation"&&a[w]&&a[w].enabled&&!a[w].prevEl&&!a[w].nextEl&&(a[w].auto=!0),["pagination","scrollbar"].indexOf(w)>=0&&a[w]&&a[w].enabled&&!a[w].el&&(a[w].auto=!0),!(w in a&&"enabled"in C)){Vl(l,_);return}typeof a[w]=="object"&&!("enabled"in a[w])&&(a[w].enabled=!0),a[w]||(a[w]={enabled:!1}),Vl(l,_)}}const n0={eventsEmitter:y4,update:P4,translate:D4,transition:j4,slide:W4,loop:Y4,grabCursor:e6,events:h6,breakpoints:f6,checkOverflow:x6,classes:y6},i0={};let cb=class _d{constructor(){let l,m;for(var _=arguments.length,w=new Array(_),C=0;C<_;C++)w[C]=arguments[C];w.length===1&&w[0].constructor&&Object.prototype.toString.call(w[0]).slice(8,-1)==="Object"?m=w[0]:[l,m]=w,m||(m={}),m=Vl({},m),l&&!m.el&&(m.el=l);const M=Mf();if(m.el&&typeof m.el=="string"&&M.querySelectorAll(m.el).length>1){const U=[];return M.querySelectorAll(m.el).forEach(Z=>{const ie=Vl({},m,{el:Z});U.push(new _d(ie))}),U}const r=this;r.__swiper__=!0,r.support=$A(),r.device=GA({userAgent:m.userAgent}),r.browser=WA(),r.eventsListeners={},r.eventsAnyListeners=[],r.modules=[...r.__modules__],m.modules&&Array.isArray(m.modules)&&r.modules.push(...m.modules);const O={};r.modules.forEach(U=>{U({params:m,swiper:r,extendParams:b6(m,O),on:r.on.bind(r),once:r.once.bind(r),off:r.off.bind(r),emit:r.emit.bind(r)})});const V=Vl({},A0,O);return r.params=Vl({},V,i0,m),r.originalParams=Vl({},r.params),r.passedParams=Vl({},m),r.params&&r.params.on&&Object.keys(r.params.on).forEach(U=>{r.on(U,r.params.on[U])}),r.params&&r.params.onAny&&r.onAny(r.params.onAny),Object.assign(r,{enabled:r.params.enabled,el:l,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return r.params.direction==="horizontal"},isVertical(){return r.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:r.params.allowSlideNext,allowSlidePrev:r.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:r.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:r.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),r.emit("_swiper"),r.params.init&&r.init(),r}getDirectionLabel(l){return this.isHorizontal()?l:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[l]}getSlideIndex(l){const{slidesEl:m,params:_}=this,w=vd(m,`.${_.slideClass}, swiper-slide`),C=CC(w[0]);return CC(l)-C}getSlideIndexByData(l){return this.getSlideIndex(this.slides.find(m=>m.getAttribute("data-swiper-slide-index")*1===l))}getSlideIndexWhenGrid(l){return this.grid&&this.params.grid&&this.params.grid.rows>1&&(this.params.grid.fill==="column"?l=Math.floor(l/this.params.grid.rows):this.params.grid.fill==="row"&&(l=l%Math.ceil(this.slides.length/this.params.grid.rows))),l}recalcSlides(){const l=this,{slidesEl:m,params:_}=l;l.slides=vd(m,`.${_.slideClass}, swiper-slide`)}enable(){const l=this;l.enabled||(l.enabled=!0,l.params.grabCursor&&l.setGrabCursor(),l.emit("enable"))}disable(){const l=this;l.enabled&&(l.enabled=!1,l.params.grabCursor&&l.unsetGrabCursor(),l.emit("disable"))}setProgress(l,m){const _=this;l=Math.min(Math.max(l,0),1);const w=_.minTranslate(),M=(_.maxTranslate()-w)*l+w;_.translateTo(M,typeof m>"u"?0:m),_.updateActiveIndex(),_.updateSlidesClasses()}emitContainerClasses(){const l=this;if(!l.params._emitClasses||!l.el)return;const m=l.el.className.split(" ").filter(_=>_.indexOf("swiper")===0||_.indexOf(l.params.containerModifierClass)===0);l.emit("_containerClasses",m.join(" "))}getSlideClasses(l){const m=this;return m.destroyed?"":l.className.split(" ").filter(_=>_.indexOf("swiper-slide")===0||_.indexOf(m.params.slideClass)===0).join(" ")}emitSlidesClasses(){const l=this;if(!l.params._emitClasses||!l.el)return;const m=[];l.slides.forEach(_=>{const w=l.getSlideClasses(_);m.push({slideEl:_,classNames:w}),l.emit("_slideClass",_,w)}),l.emit("_slideClasses",m)}slidesPerViewDynamic(l,m){l===void 0&&(l="current"),m===void 0&&(m=!1);const _=this,{params:w,slides:C,slidesGrid:M,slidesSizesGrid:r,size:O,activeIndex:V}=_;let U=1;if(typeof w.slidesPerView=="number")return w.slidesPerView;if(w.centeredSlides){let Z=C[V]?Math.ceil(C[V].swiperSlideSize):0,ie;for(let de=V+1;de<C.length;de+=1)C[de]&&!ie&&(Z+=Math.ceil(C[de].swiperSlideSize),U+=1,Z>O&&(ie=!0));for(let de=V-1;de>=0;de-=1)C[de]&&!ie&&(Z+=C[de].swiperSlideSize,U+=1,Z>O&&(ie=!0))}else if(l==="current")for(let Z=V+1;Z<C.length;Z+=1)(m?M[Z]+r[Z]-M[V]<O:M[Z]-M[V]<O)&&(U+=1);else for(let Z=V-1;Z>=0;Z-=1)M[V]-M[Z]<O&&(U+=1);return U}update(){const l=this;if(!l||l.destroyed)return;const{snapGrid:m,params:_}=l;_.breakpoints&&l.setBreakpoint(),[...l.el.querySelectorAll('[loading="lazy"]')].forEach(M=>{M.complete&&Sy(l,M)}),l.updateSize(),l.updateSlides(),l.updateProgress(),l.updateSlidesClasses();function w(){const M=l.rtlTranslate?l.translate*-1:l.translate,r=Math.min(Math.max(M,l.maxTranslate()),l.minTranslate());l.setTranslate(r),l.updateActiveIndex(),l.updateSlidesClasses()}let C;if(_.freeMode&&_.freeMode.enabled&&!_.cssMode)w(),_.autoHeight&&l.updateAutoHeight();else{if((_.slidesPerView==="auto"||_.slidesPerView>1)&&l.isEnd&&!_.centeredSlides){const M=l.virtual&&_.virtual.enabled?l.virtual.slides:l.slides;C=l.slideTo(M.length-1,0,!1,!0)}else C=l.slideTo(l.activeIndex,0,!1,!0);C||w()}_.watchOverflow&&m!==l.snapGrid&&l.checkOverflow(),l.emit("update")}changeDirection(l,m){m===void 0&&(m=!0);const _=this,w=_.params.direction;return l||(l=w==="horizontal"?"vertical":"horizontal"),l===w||l!=="horizontal"&&l!=="vertical"||(_.el.classList.remove(`${_.params.containerModifierClass}${w}`),_.el.classList.add(`${_.params.containerModifierClass}${l}`),_.emitContainerClasses(),_.params.direction=l,_.slides.forEach(C=>{l==="vertical"?C.style.width="":C.style.height=""}),_.emit("changeDirection"),m&&_.update()),_}changeLanguageDirection(l){const m=this;m.rtl&&l==="rtl"||!m.rtl&&l==="ltr"||(m.rtl=l==="rtl",m.rtlTranslate=m.params.direction==="horizontal"&&m.rtl,m.rtl?(m.el.classList.add(`${m.params.containerModifierClass}rtl`),m.el.dir="rtl"):(m.el.classList.remove(`${m.params.containerModifierClass}rtl`),m.el.dir="ltr"),m.update())}mount(l){const m=this;if(m.mounted)return!0;let _=l||m.params.el;if(typeof _=="string"&&(_=document.querySelector(_)),!_)return!1;_.swiper=m,_.parentNode&&_.parentNode.host&&_.parentNode.host.nodeName===m.params.swiperElementNodeName.toUpperCase()&&(m.isElement=!0);const w=()=>`.${(m.params.wrapperClass||"").trim().split(" ").join(".")}`;let M=_&&_.shadowRoot&&_.shadowRoot.querySelector?_.shadowRoot.querySelector(w()):vd(_,w())[0];return!M&&m.params.createElements&&(M=C0("div",m.params.wrapperClass),_.append(M),vd(_,`.${m.params.slideClass}`).forEach(r=>{M.append(r)})),Object.assign(m,{el:_,wrapperEl:M,slidesEl:m.isElement&&!_.parentNode.host.slideSlots?_.parentNode.host:M,hostEl:m.isElement?_.parentNode.host:_,mounted:!0,rtl:_.dir.toLowerCase()==="rtl"||Cp(_,"direction")==="rtl",rtlTranslate:m.params.direction==="horizontal"&&(_.dir.toLowerCase()==="rtl"||Cp(_,"direction")==="rtl"),wrongRTL:Cp(M,"display")==="-webkit-box"}),!0}init(l){const m=this;if(m.initialized||m.mount(l)===!1)return m;m.emit("beforeInit"),m.params.breakpoints&&m.setBreakpoint(),m.addClasses(),m.updateSize(),m.updateSlides(),m.params.watchOverflow&&m.checkOverflow(),m.params.grabCursor&&m.enabled&&m.setGrabCursor(),m.params.loop&&m.virtual&&m.params.virtual.enabled?m.slideTo(m.params.initialSlide+m.virtual.slidesBefore,0,m.params.runCallbacksOnInit,!1,!0):m.slideTo(m.params.initialSlide,0,m.params.runCallbacksOnInit,!1,!0),m.params.loop&&m.loopCreate(void 0,!0),m.attachEvents();const w=[...m.el.querySelectorAll('[loading="lazy"]')];return m.isElement&&w.push(...m.hostEl.querySelectorAll('[loading="lazy"]')),w.forEach(C=>{C.complete?Sy(m,C):C.addEventListener("load",M=>{Sy(m,M.target)})}),E0(m),m.initialized=!0,E0(m),m.emit("init"),m.emit("afterInit"),m}destroy(l,m){l===void 0&&(l=!0),m===void 0&&(m=!0);const _=this,{params:w,el:C,wrapperEl:M,slides:r}=_;return typeof _.params>"u"||_.destroyed||(_.emit("beforeDestroy"),_.initialized=!1,_.detachEvents(),w.loop&&_.loopDestroy(),m&&(_.removeClasses(),C&&typeof C!="string"&&C.removeAttribute("style"),M&&M.removeAttribute("style"),r&&r.length&&r.forEach(O=>{O.classList.remove(w.slideVisibleClass,w.slideFullyVisibleClass,w.slideActiveClass,w.slideNextClass,w.slidePrevClass),O.removeAttribute("style"),O.removeAttribute("data-swiper-slide-index")})),_.emit("destroy"),Object.keys(_.eventsListeners).forEach(O=>{_.off(O)}),l!==!1&&(_.el&&typeof _.el!="string"&&(_.el.swiper=null),r4(_)),_.destroyed=!0),null}static extendDefaults(l){Vl(i0,l)}static get extendedDefaults(){return i0}static get defaults(){return A0}static installModule(l){_d.prototype.__modules__||(_d.prototype.__modules__=[]);const m=_d.prototype.__modules__;typeof l=="function"&&m.indexOf(l)<0&&m.push(l)}static use(l){return Array.isArray(l)?(l.forEach(m=>_d.installModule(m)),_d):(_d.installModule(l),_d)}};Object.keys(n0).forEach(a=>{Object.keys(n0[a]).forEach(l=>{cb.prototype[l]=n0[a][l]})});cb.use([g4,_4]);const XA=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function Af(a){return typeof a=="object"&&a!==null&&a.constructor&&Object.prototype.toString.call(a).slice(8,-1)==="Object"&&!a.__swiper__}function Sm(a,l){const m=["__proto__","constructor","prototype"];Object.keys(l).filter(_=>m.indexOf(_)<0).forEach(_=>{typeof a[_]>"u"?a[_]=l[_]:Af(l[_])&&Af(a[_])&&Object.keys(l[_]).length>0?l[_].__swiper__?a[_]=l[_]:Sm(a[_],l[_]):a[_]=l[_]})}function YA(a){return a===void 0&&(a={}),a.navigation&&typeof a.navigation.nextEl>"u"&&typeof a.navigation.prevEl>"u"}function QA(a){return a===void 0&&(a={}),a.pagination&&typeof a.pagination.el>"u"}function JA(a){return a===void 0&&(a={}),a.scrollbar&&typeof a.scrollbar.el>"u"}function eI(a){a===void 0&&(a="");const l=a.split(" ").map(_=>_.trim()).filter(_=>!!_),m=[];return l.forEach(_=>{m.indexOf(_)<0&&m.push(_)}),m.join(" ")}function w6(a){return a===void 0&&(a=""),a?a.includes("swiper-wrapper")?a:`swiper-wrapper ${a}`:"swiper-wrapper"}function T6(a){let{swiper:l,slides:m,passedParams:_,changedParams:w,nextEl:C,prevEl:M,scrollbarEl:r,paginationEl:O}=a;const V=w.filter($e=>$e!=="children"&&$e!=="direction"&&$e!=="wrapperClass"),{params:U,pagination:Z,navigation:ie,scrollbar:de,virtual:se,thumbs:ne}=l;let Se,me,Re,ye,Le,De,Oe,Ee;w.includes("thumbs")&&_.thumbs&&_.thumbs.swiper&&!_.thumbs.swiper.destroyed&&U.thumbs&&(!U.thumbs.swiper||U.thumbs.swiper.destroyed)&&(Se=!0),w.includes("controller")&&_.controller&&_.controller.control&&U.controller&&!U.controller.control&&(me=!0),w.includes("pagination")&&_.pagination&&(_.pagination.el||O)&&(U.pagination||U.pagination===!1)&&Z&&!Z.el&&(Re=!0),w.includes("scrollbar")&&_.scrollbar&&(_.scrollbar.el||r)&&(U.scrollbar||U.scrollbar===!1)&&de&&!de.el&&(ye=!0),w.includes("navigation")&&_.navigation&&(_.navigation.prevEl||M)&&(_.navigation.nextEl||C)&&(U.navigation||U.navigation===!1)&&ie&&!ie.prevEl&&!ie.nextEl&&(Le=!0);const qe=$e=>{l[$e]&&(l[$e].destroy(),$e==="navigation"?(l.isElement&&(l[$e].prevEl.remove(),l[$e].nextEl.remove()),U[$e].prevEl=void 0,U[$e].nextEl=void 0,l[$e].prevEl=void 0,l[$e].nextEl=void 0):(l.isElement&&l[$e].el.remove(),U[$e].el=void 0,l[$e].el=void 0))};w.includes("loop")&&l.isElement&&(U.loop&&!_.loop?De=!0:!U.loop&&_.loop?Oe=!0:Ee=!0),V.forEach($e=>{if(Af(U[$e])&&Af(_[$e]))Object.assign(U[$e],_[$e]),($e==="navigation"||$e==="pagination"||$e==="scrollbar")&&"enabled"in _[$e]&&!_[$e].enabled&&qe($e);else{const Ge=_[$e];(Ge===!0||Ge===!1)&&($e==="navigation"||$e==="pagination"||$e==="scrollbar")?Ge===!1&&qe($e):U[$e]=_[$e]}}),V.includes("controller")&&!me&&l.controller&&l.controller.control&&U.controller&&U.controller.control&&(l.controller.control=U.controller.control),w.includes("children")&&m&&se&&U.virtual.enabled?(se.slides=m,se.update(!0)):w.includes("virtual")&&se&&U.virtual.enabled&&(m&&(se.slides=m),se.update(!0)),w.includes("children")&&m&&U.loop&&(Ee=!0),Se&&ne.init()&&ne.update(!0),me&&(l.controller.control=U.controller.control),Re&&(l.isElement&&(!O||typeof O=="string")&&(O=document.createElement("div"),O.classList.add("swiper-pagination"),O.part.add("pagination"),l.el.appendChild(O)),O&&(U.pagination.el=O),Z.init(),Z.render(),Z.update()),ye&&(l.isElement&&(!r||typeof r=="string")&&(r=document.createElement("div"),r.classList.add("swiper-scrollbar"),r.part.add("scrollbar"),l.el.appendChild(r)),r&&(U.scrollbar.el=r),de.init(),de.updateSize(),de.setTranslate()),Le&&(l.isElement&&((!C||typeof C=="string")&&(C=document.createElement("div"),C.classList.add("swiper-button-next"),AC(C,l.hostEl.constructor.nextButtonSvg),C.part.add("button-next"),l.el.appendChild(C)),(!M||typeof M=="string")&&(M=document.createElement("div"),M.classList.add("swiper-button-prev"),AC(M,l.hostEl.constructor.prevButtonSvg),M.part.add("button-prev"),l.el.appendChild(M))),C&&(U.navigation.nextEl=C),M&&(U.navigation.prevEl=M),ie.init(),ie.update()),w.includes("allowSlideNext")&&(l.allowSlideNext=_.allowSlideNext),w.includes("allowSlidePrev")&&(l.allowSlidePrev=_.allowSlidePrev),w.includes("direction")&&l.changeDirection(_.direction,!1),(De||Ee)&&l.loopDestroy(),(Oe||Ee)&&l.loopCreate(),l.update()}function S6(a,l){a===void 0&&(a={}),l===void 0&&(l=!0);const m={on:{}},_={},w={};Sm(m,A0),m._emitClasses=!0,m.init=!1;const C={},M=XA.map(O=>O.replace(/_/,"")),r=Object.assign({},a);return Object.keys(r).forEach(O=>{typeof a[O]>"u"||(M.indexOf(O)>=0?Af(a[O])?(m[O]={},w[O]={},Sm(m[O],a[O]),Sm(w[O],a[O])):(m[O]=a[O],w[O]=a[O]):O.search(/on[A-Z]/)===0&&typeof a[O]=="function"?l?_[`${O[2].toLowerCase()}${O.substr(3)}`]=a[O]:m.on[`${O[2].toLowerCase()}${O.substr(3)}`]=a[O]:C[O]=a[O])}),["navigation","pagination","scrollbar"].forEach(O=>{m[O]===!0&&(m[O]={}),m[O]===!1&&delete m[O]}),{params:m,passedParams:w,rest:C,events:_}}function C6(a,l){let{el:m,nextEl:_,prevEl:w,paginationEl:C,scrollbarEl:M,swiper:r}=a;YA(l)&&_&&w&&(r.params.navigation.nextEl=_,r.originalParams.navigation.nextEl=_,r.params.navigation.prevEl=w,r.originalParams.navigation.prevEl=w),QA(l)&&C&&(r.params.pagination.el=C,r.originalParams.pagination.el=C),JA(l)&&M&&(r.params.scrollbar.el=M,r.originalParams.scrollbar.el=M),r.init(m)}function E6(a,l,m,_,w){const C=[];if(!l)return C;const M=O=>{C.indexOf(O)<0&&C.push(O)};if(m&&_){const O=_.map(w),V=m.map(w);O.join("")!==V.join("")&&M("children"),_.length!==m.length&&M("children")}return XA.filter(O=>O[0]==="_").map(O=>O.replace(/_/,"")).forEach(O=>{if(O in a&&O in l)if(Af(a[O])&&Af(l[O])){const V=Object.keys(a[O]),U=Object.keys(l[O]);V.length!==U.length?M(O):(V.forEach(Z=>{a[O][Z]!==l[O][Z]&&M(O)}),U.forEach(Z=>{a[O][Z]!==l[O][Z]&&M(O)}))}else a[O]!==l[O]&&M(O)}),C}const A6=a=>{!a||a.destroyed||!a.params.virtual||a.params.virtual&&!a.params.virtual.enabled||(a.updateSlides(),a.updateProgress(),a.updateSlidesClasses(),a.emit("_virtualUpdated"),a.parallax&&a.params.parallax&&a.params.parallax.enabled&&a.parallax.setTranslate())};function jy(){return jy=Object.assign?Object.assign.bind():function(a){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(a[_]=m[_])}return a},jy.apply(this,arguments)}function tI(a){return a.type&&a.type.displayName&&a.type.displayName.includes("SwiperSlide")}function nI(a){const l=[];return Qr.Children.toArray(a).forEach(m=>{tI(m)?l.push(m):m.props&&m.props.children&&nI(m.props.children).forEach(_=>l.push(_))}),l}function I6(a){const l=[],m={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return Qr.Children.toArray(a).forEach(_=>{if(tI(_))l.push(_);else if(_.props&&_.props.slot&&m[_.props.slot])m[_.props.slot].push(_);else if(_.props&&_.props.children){const w=nI(_.props.children);w.length>0?w.forEach(C=>l.push(C)):m["container-end"].push(_)}else m["container-end"].push(_)}),{slides:l,slots:m}}function P6(a,l,m){if(!m)return null;const _=U=>{let Z=U;return U<0?Z=l.length+U:Z>=l.length&&(Z=Z-l.length),Z},w=a.isHorizontal()?{[a.rtlTranslate?"right":"left"]:`${m.offset}px`}:{top:`${m.offset}px`},{from:C,to:M}=m,r=a.params.loop?-l.length:0,O=a.params.loop?l.length*2:l.length,V=[];for(let U=r;U<O;U+=1)U>=C&&U<=M&&V.push(l[_(U)]);return V.map((U,Z)=>Qr.cloneElement(U,{swiper:a,style:w,key:U.props.virtualIndex||U.key||`slide-${Z}`}))}function e_(a,l){return typeof window>"u"?ue.useEffect(a,l):ue.useLayoutEffect(a,l)}const RC=ue.createContext(null),k6=ue.createContext(null),iI=ue.forwardRef(function(a,l){let{className:m,tag:_="div",wrapperTag:w="div",children:C,onSwiper:M,...r}=a===void 0?{}:a,O=!1;const[V,U]=ue.useState("swiper"),[Z,ie]=ue.useState(null),[de,se]=ue.useState(!1),ne=ue.useRef(!1),Se=ue.useRef(null),me=ue.useRef(null),Re=ue.useRef(null),ye=ue.useRef(null),Le=ue.useRef(null),De=ue.useRef(null),Oe=ue.useRef(null),Ee=ue.useRef(null),{params:qe,passedParams:$e,rest:Ge,events:et}=S6(r),{slides:mt,slots:St}=I6(C),xt=()=>{se(!de)};Object.assign(qe.on,{_containerClasses(kt,qt){U(qt)}});const At=()=>{Object.assign(qe.on,et),O=!0;const kt={...qe};if(delete kt.wrapperClass,me.current=new cb(kt),me.current.virtual&&me.current.params.virtual.enabled){me.current.virtual.slides=mt;const qt={cache:!1,slides:mt,renderExternal:ie,renderExternalUpdate:!1};Sm(me.current.params.virtual,qt),Sm(me.current.originalParams.virtual,qt)}};Se.current||At(),me.current&&me.current.on("_beforeBreakpoint",xt);const Ct=()=>{O||!et||!me.current||Object.keys(et).forEach(kt=>{me.current.on(kt,et[kt])})},Ut=()=>{!et||!me.current||Object.keys(et).forEach(kt=>{me.current.off(kt,et[kt])})};ue.useEffect(()=>()=>{me.current&&me.current.off("_beforeBreakpoint",xt)}),ue.useEffect(()=>{!ne.current&&me.current&&(me.current.emitSlidesClasses(),ne.current=!0)}),e_(()=>{if(l&&(l.current=Se.current),!!Se.current)return me.current.destroyed&&At(),C6({el:Se.current,nextEl:Le.current,prevEl:De.current,paginationEl:Oe.current,scrollbarEl:Ee.current,swiper:me.current},qe),M&&!me.current.destroyed&&M(me.current),()=>{me.current&&!me.current.destroyed&&me.current.destroy(!0,!1)}},[]),e_(()=>{Ct();const kt=E6($e,Re.current,mt,ye.current,qt=>qt.key);return Re.current=$e,ye.current=mt,kt.length&&me.current&&!me.current.destroyed&&T6({swiper:me.current,slides:mt,passedParams:$e,changedParams:kt,nextEl:Le.current,prevEl:De.current,scrollbarEl:Ee.current,paginationEl:Oe.current}),()=>{Ut()}}),e_(()=>{A6(me.current)},[Z]);function at(){return qe.virtual?P6(me.current,mt,Z):mt.map((kt,qt)=>Qr.cloneElement(kt,{swiper:me.current,swiperSlideIndex:qt}))}return Qr.createElement(_,jy({ref:Se,className:eI(`${V}${m?` ${m}`:""}`)},Ge),Qr.createElement(k6.Provider,{value:me.current},St["container-start"],Qr.createElement(w,{className:w6(qe.wrapperClass)},St["wrapper-start"],at(),St["wrapper-end"]),YA(qe)&&Qr.createElement(Qr.Fragment,null,Qr.createElement("div",{ref:De,className:"swiper-button-prev"}),Qr.createElement("div",{ref:Le,className:"swiper-button-next"})),JA(qe)&&Qr.createElement("div",{ref:Ee,className:"swiper-scrollbar"}),QA(qe)&&Qr.createElement("div",{ref:Oe,className:"swiper-pagination"}),St["container-end"]))});iI.displayName="Swiper";const I0=ue.forwardRef(function(a,l){let{tag:m="div",children:_,className:w="",swiper:C,zoom:M,lazy:r,virtualIndex:O,swiperSlideIndex:V,...U}=a===void 0?{}:a;const Z=ue.useRef(null),[ie,de]=ue.useState("swiper-slide"),[se,ne]=ue.useState(!1);function Se(Le,De,Oe){De===Z.current&&de(Oe)}e_(()=>{if(typeof V<"u"&&(Z.current.swiperSlideIndex=V),l&&(l.current=Z.current),!(!Z.current||!C)){if(C.destroyed){ie!=="swiper-slide"&&de("swiper-slide");return}return C.on("_slideClass",Se),()=>{C&&C.off("_slideClass",Se)}}}),e_(()=>{C&&Z.current&&!C.destroyed&&de(C.getSlideClasses(Z.current))},[C]);const me={isActive:ie.indexOf("swiper-slide-active")>=0,isVisible:ie.indexOf("swiper-slide-visible")>=0,isPrev:ie.indexOf("swiper-slide-prev")>=0,isNext:ie.indexOf("swiper-slide-next")>=0},Re=()=>typeof _=="function"?_(me):_,ye=()=>{ne(!0)};return Qr.createElement(m,jy({ref:Z,className:eI(`${ie}${w?` ${w}`:""}`),"data-swiper-slide-index":O,onLoad:ye},U),M&&Qr.createElement(RC.Provider,{value:me},Qr.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":typeof M=="number"?M:void 0},Re(),r&&!se&&Qr.createElement("div",{className:"swiper-lazy-preloader"}))),!M&&Qr.createElement(RC.Provider,{value:me},Re(),r&&!se&&Qr.createElement("div",{className:"swiper-lazy-preloader"})))});I0.displayName="SwiperSlide";const M6=[{id:"japanese-covered-bridge",coordinates:[15.877122578067937,108.32601152345488],category:["museum"],imageUrl:"1.jpg",en:{title:"Japanese Covered Bridge",description:"Hoi An's famous symbol, built in the 16th century by the Japanese community.",fullDescription:`
<p>If you've been to Hoi An and haven't taken a picture on the Japanese Covered Bridge (Cha Cu), then you haven't really been to Hoi An. Seriously, this bridge is so delightful it even made it onto the city's emblem! And for good reason, it has a very unusual history...</p>

<img src="26.jpg" alt="Japanese Bridge Detail"/>

<p>This bridge is a real superstar, staring back at you from the 20,000 Vietnamese Dong (VND) banknote! Don't be surprised if you see crowds of tourists seriously holding this banknote next to the bridge, trying to get "that shot." While it may not be the most original shot in the world, it's impossible to resist such a selfie! After all, it's not every day you hold money in your hands that depicts what's behind you, right?</p>

<h6>The Japanese Left, But The Bridge Remained</h6>
<p>Imagine the 17th century: Hoi An is an international trade hub in Southeast Asia, attracting merchants from all corners of the globe. Japanese and Chinese traders were so active here that they decided: "Let's build a bridge to make it easier to visit each other!" And so, in 1593, our hero came into being.</p>

<img src="2.jpg" alt="Japanese Bridge Detail"/>

<p>Few people know this, but the Japanese actively lived in Hoi An until 1663, and then... Boom! The Japanese government suddenly declared: "That's it, stop trading! We're going into lockdown!" (Well, almost). So Japan went into isolation, and its magnificent legacy  this bridge  remained standing, like a greeting from the past.</p>

<h6>Bridge, Temple, and a Little Mystery</h6>

<img src="25.jpg" alt="Japanese Bridge Detail"/>
<small>Statue of the Taoist God of Weather, Tran Bo Bac De</small>

<p>You walk across the bridge, and there's a... temple? Yes, right in the middle of the bridge, a small altar is nestled. It's dedicated to the Taoist Jade Emperor Yu-di. It's funny because Taoism wasn't widely practiced in Japan, so it's likely the temple was added by the Vietnamese later. It's a kind of cultural bridge that connects not only shores but also beliefs!</p>

<img src="24.jpg" alt="Japanese Bridge Detail"/>

<p>And on both sides of the bridge, you're greeted by stone statues of dogs and monkeys. Don't ask why them specifically  it's one of those Hoi An mysteries that makes you scratch your head. Maybe it's because of the years of construction (started in the Year of the Dog, finished in the Year of the Monkey)? Or, as another version suggests, many Japanese emperors were born in these years? In any case, they're here for a reason, and locals still adorn them and make offerings. Who knows, maybe they really are the guardians of the bridge, and whether you'll be lucky today depends on them!</p>

<h6>Fighting the Underwater Catfish</h6>
<p>Here's where it gets wild (in a good way)! The bridge wasn't built just for fun; it had a very important mission  to pin down a gigantic mythical catfish named Onamazu ()!</p>

<img src="3.jpg" alt="Onamazu"/>
<small>Onamazu (Japanese:   "giant catfish")</small>

<p>The essence of the legend: In Japanese folklore, there's this enormous catfish that causes earthquakes when it wiggles its tail. Its head, they say, is under India, its tail under Japan, but its BACK PASSES RIGHT UNDER VIETNAM! And the bridge builders, apparently, were very clever engineers, because they built the bridge specifically to "pin down" the back of this monster, preventing it from thrashing. Thus, the Japanese Bridge became a kind of anti-seismic press for all of Central Vietnam.</p>
<img src="20.jpg" alt="Onamazu"/>

<p>We don't know how much Onamazu appreciated this "massage" therapy, but the bridge, built on strong wooden supports, truly has stood for hundreds of years! Although, to be honest, not without humanity's help. The bridge has undergone eight (!) major renovations (even in 2022 it was literally disassembled for "surgery"!), which probably also helped a bit to keep it from falling apart. But the catfish myth still sounds cooler, don't you agree?</p>

<h6>The Prince, the Carver, and Three Hieroglyphs</h6>

<p>In 1719, Prince Nguyn Phc Chu visited Hoi An. He was an important figure who ruled Southern Vietnam, almost like a king, from 1691 to 1725. And so, they say, he didn't just admire the bridge, but personally carved three Chinese characters above the temple door! Can you imagine? Instead of sending servants, the prince decided to do the carving himself. He must have felt inspired!</p>

<img src="23.jpg" alt="The Prince, the Carver, and Three Hieroglyphs"/>

<p>These symbols translate very poetically: "bridge for welcoming guests from afar." Or, in Vietnamese style, "Lai Viet Kieu." It's as if the bridge itself is saying: "Hello, traveler! Come in, make yourself at home, you belong here!" Such an ancient "welcome sign," carved by the hand of the ruler himself.</p>

<h6>The French Road and Why the Bridge is Pedestrian Only</h6>

<img src="21.jpg" alt="Japanese Bridge Detail"/>

<p>Times change, and even the Japanese Bridge had to endure its "fashion experiments." During colonial rule, the French decided: "Hey, why shouldn't motorcycles drive here?" and leveled the road across the bridge. Sounds like a great idea for traffic jams, right? Fortunately, this "innovation" was later canceled, and the bridge once again became pedestrian-only. And thank goodness, because what kind of "symbol" is it if bikes are speeding across it?</p>

<h6>A Small Bridge with a Giant Heart</h6>
<p>So, when you walk across the Japanese Bridge, know this: you're not just walking on planks, you're treading on living history, full of legends, cultural intricacies, and even mythical catfish. It doesn't just connect two shores  it connects eras, peoples, and perhaps even calms earthquakes. That's our Japanese Covered Bridge  small, but very proud and mysterious.</p>

<img src="22.jpg" alt="Japanese Bridge Detail"/>
      `,internalImageNames:["2.jpg","3.jpg","22.jpg","20.jpg","21.jpg","23.jpg","24.jpg","25.jpg","26.jpg"]},es:{title:"Puente Cubierto Japons",description:"Smbolo famoso de Hoi An, construido en el siglo XVI por la comunidad japonesa.",fullDescription:`
<p>Si has estado en Hoi An y no te has tomado una foto en el Puente Cubierto Japons (Cha Cu), entonces realmente no has estado en Hoi An. En serio, este puente es tan encantador que incluso lleg al emblema de la ciudad. Y con razn, tiene una historia muy inusual!</p>

<img src="26.jpg" alt="Detalle del Puente Japons"/>

<p>Este puente es una verdadera superestrella, mirndote fijamente desde el billete de 20.000 Dong vietnamitas (VND)! No te sorprendas si ves multitudes de turistas sosteniendo seriamente este billete junto al puente, tratando de conseguir "esa foto". Aunque no sea la foto ms original del mundo, es imposible resistirse a un selfie as! Despus de todo, no todos los das tienes dinero en tus manos que representa lo que est detrs de ti, verdad?</p>

<h6>Los japoneses se fueron, pero el puente permaneci</h6>
<p>Imagina el siglo XVII: Hoi An es un centro de comercio internacional en el sudeste asitico, atrayendo a mercaderes de todos los rincones del mundo. Los comerciantes japoneses y chinos eran tan activos aqu que decidieron: "Construyamos un puente para que sea ms fcil visitarnos!" Y as, en 1593, naci nuestro hroe.</p>

<img src="2.jpg" alt="Detalle del Puente Japons"/>

<p>Poca gente sabe esto, pero los japoneses vivieron activamente en Hoi An hasta 1663, y luego... Boom! El gobierno japons declar de repente: "Ya est, parad de comerciar! Nos vamos a un cierre!" (Bueno, casi). As que Japn entr en aislamiento, y su magnfico legado este puente permaneci en pie, como un saludo del pasado.</p>

<h6>Puente, Templo y un pequeo misterio</h6>

<img src="25.jpg" alt="Detalle del Puente Japons"/>
<small>Estatua del Dios Taosta del Clima, Tran Bo Bac De</small>

<p>Caminas por el puente, y hay un... templo? S, justo en el medio del puente, se encuentra un pequeo altar. Est dedicado al Emperador de Jade Taosta Yu-di. Es curioso porque el taosmo no era muy practicado en Japn, as que es probable que el templo fuera aadido por los vietnamitas ms tarde. Es una especie de puente cultural que conecta no solo orillas sino tambin creencias!</p>

<img src="24.jpg" alt="Detalle del Puente Japons"/>

<p>Y a ambos lados del puente, te saludan estatuas de piedra de perros y monos. No preguntes por qu ellos especficamente  es uno de esos misterios de Hoi An que te hacen rascarte la cabeza. Quizs sea por los aos de construccin (empez en el Ao del Perro, termin en el Ao del Mono)? O, como sugiere otra versin, muchos emperadores japoneses nacieron en estos aos? En cualquier caso, estn aqu por una razn, y los lugareos todava los adornan y hacen ofrendas. Quin sabe, quizs realmente sean los guardianes del puente, y tu suerte hoy dependa de ellos!</p>

<h6>Luchando contra el bagre submarino</h6>
<p>Aqu es donde la cosa se pone salvaje (en el buen sentido)! El puente no fue construido solo por diversin; tena una misin muy importante: sujetar a un gigantesco bagre mtico llamado Onamazu ()!</p>

<img src="3.jpg" alt="Onamazu"/>
<small>Onamazu (Japons:   "bagre gigante")</small>

<p>La esencia de la leyenda: En el folclore japons, existe este enorme bagre que causa terremotos cuando menea su cola. Su cabeza, dicen, est bajo la India, su cola bajo Japn, pero su ESPALDA PASA JUSTO BAJO VIETNAM! Y los constructores del puente, al parecer, eran ingenieros muy inteligentes, porque construyeron el puente especficamente para "sujetar" la espalda de este monstruo, impidiendo que se agitara. As, el Puente Japons se convirti en una especie de prensa antissmica para todo el centro de Vietnam.</p>
<img src="20.jpg" alt="Onamazu"/>

<p>No sabemos cunto apreci Onamazu esta terapia de "masaje", pero el puente, construido sobre fuertes soportes de madera, realmente ha resistido durante cientos de aos! Aunque, para ser honesto, no sin la ayuda de la humanidad. El puente ha sufrido ocho (!) renovaciones importantes (incluso en 2022 fue literalmente desensamblado para una "ciruga"!), lo que probablemente tambin ayud un poco a que no se desmoronara. Pero el mito del bagre sigue sonando ms genial, no crees?</p>

<h6>El Prncipe, el Tallador y Tres Jeroglficos</h6>

<p>En 1719, el Prncipe Nguyn Phc Chu visit Hoi An. Fue una figura importante que gobern el sur de Vietnam, casi como un rey, de 1691 a 1725. Y as, dicen, no solo admir el puente, sino que personalmente tall tres caracteres chinos sobre la puerta del templo! Te imaginas? En lugar de enviar sirvientes, el prncipe decidi hacer el tallado l mismo. Debe haberse sentido inspirado!</p>

<img src="23.jpg" alt="El Prncipe, el Tallador y Tres Jeroglficos"/>

<p>Estos smbolos se traducen muy poticamente: "puente para dar la bienvenida a los huspedes de lejos". O, al estilo vietnamita, "Lai Viet Kieu". Es como si el propio puente dijera: "Hola, viajero! Adelante, sintete como en casa, aqu perteneces!" Una antigua "seal de bienvenida", tallada por la mano del propio gobernante.</p>

<h6>El Camino Francs y Por Qu el Puente es Solo Peatonal</h6>

<img src="21.jpg" alt="Detalle del Puente Japons"/>

<p>Los tiempos cambian, e incluso el Puente Japons tuvo que soportar sus "experimentos de moda". Durante el dominio colonial, los franceses decidieron: "Oye, por qu no deberan conducir motos aqu?" y nivelaron la carretera a travs del puente. Suena a una gran idea para los atascos, verdad? Afortunadamente, esta "innovacin" fue cancelada ms tarde, y el puente volvi a ser solo para peatones. Y gracias a Dios, porque qu tipo de "smbolo" es si las motos lo cruzan a toda velocidad?</p>

<h6>Un Pequeo Puente con un Gran Corazn</h6>
<p>As que, cuando camines por el Puente Japons, sabrs esto: no solo ests caminando sobre tablones, ests pisando historia viva, llena de leyendas, complejidades culturales e incluso bagres mticos. No solo conecta dos orillas, conecta pocas, pueblos y quizs incluso calma los terremotos. Ese es nuestro Puente Cubierto Japons: pequeo, pero muy orgulloso y misterioso.</p>

<img src="22.jpg" alt="Detalle del Puente Japons"/>
      `,internalImageNames:["2.jpg","3.jpg","22.jpg","20.jpg","21.jpg","23.jpg","24.jpg","25.jpg","26.jpg"]},fr:{title:"Pont couvert japonais",description:"Clbre symbole de Hoi An, construit au 16me sicle par la communaut japonaise.",fullDescription:`
<p>Si vous tes all  Hoi An et que vous n'avez pas pris de photo sur le Pont couvert japonais (Cha Cu), alors vous n'tes pas vraiment all  Hoi An. Srieusement, ce pont est si charmant qu'il a mme figur sur l'emblme de la ville ! Et pour une bonne raison, il a une histoire trs inhabituelle...</p>

<img src="26.jpg" alt="Dtail du pont japonais"/>

<p>Ce pont est une vraie superstar, il vous regarde depuis le billet de 20 000 Dongs vietnamiens (VND) ! Ne soyez pas surpris si vous voyez des foules de touristes tenir srieusement ce billet  ct du pont, essayant d'obtenir "ce clich". Bien que ce ne soit pas le clich le plus original du monde, il est impossible de rsister  un tel selfie ! Aprs tout, ce n'est pas tous les jours que vous tenez de l'argent dans vos mains qui reprsente ce qui est derrire vous, n'est-ce pas ?</p>

<h6>Les Japonais sont partis, mais le pont est rest</h6>
<p>Imaginez le 17me sicle : Hoi An est un centre commercial international en Asie du Sud-Est, attirant des marchands des quatre coins du globe. Les commerants japonais et chinois taient si actifs ici qu'ils ont dcid : "Construisons un pont pour faciliter nos visites mutuelles !" Et c'est ainsi qu'en 1593, notre hros a vu le jour.</p>

<img src="2.jpg" alt="Dtail du pont japonais"/>

<p>Peu de gens le savent, mais les Japonais ont vcu activement  Hoi An jusqu'en 1663, et puis... Boum ! Le gouvernement japonais a soudainement dclar : "a suffit, arrtez de commercer ! Nous entrons en confinement !" (Enfin, presque). Le Japon s'est donc isol, et son magnifique hritage  ce pont  est rest debout, comme un salut du pass.</p>

<h6>Pont, Temple et un petit mystre</h6>

<img src="25.jpg" alt="Dtail du pont japonais"/>
<small>Statue du dieu taoste de la Mto, Tran Bo Bac De</small>

<p>Vous traversez le pont, et il y a un... temple ? Oui, juste au milieu du pont, un petit autel est nich. Il est ddi  l'Empereur de Jade taoste Yu-di. C'est drle car le taosme n'tait pas largement pratiqu au Japon, il est donc probable que le temple ait t ajout par les Vietnamiens plus tard. C'est une sorte de pont culturel qui relie non seulement les rives, mais aussi les croyances !</p>

<img src="24.jpg" alt="Dtail du pont japonais"/>

<p>Et des deux cts du pont, vous tes accueillis par des statues en pierre de chiens et de singes. Ne demandez pas pourquoi eux spcifiquement  c'est l'un de ces mystres de Hoi An qui vous fait vous gratter la tte. Peut-tre est-ce  cause des annes de construction (commenc l'anne du Chien, termin l'anne du Singe) ? Ou, comme le suggre une autre version, de nombreux empereurs japonais sont ns ces annes-l ? Quoi qu'il en soit, ils sont l pour une raison, et les habitants les ornent toujours et font des offrandes. Qui sait, peut-tre sont-ils vraiment les gardiens du pont, et votre chance du jour dpend d'eux !</p>

<h6>Combattre le poisson-chat sous-marin</h6>
<p>C'est l que a devient fou (dans le bon sens) ! Le pont n'a pas t construit juste pour le plaisir ; il avait une mission trs importante  d'immobiliser un gigantesque poisson-chat mythique nomm Onamazu () !</p>

<img src="3.jpg" alt="Onamazu"/>
<small>Onamazu (Japonais :   "poisson-chat gant")</small>

<p>L'essence de la lgende : Dans le folklore japonais, il y a cet norme poisson-chat qui provoque des tremblements de terre quand il agite sa queue. Sa tte, dit-on, est sous l'Inde, sa queue sous le Japon, mais son DOS PASSE JUSTE SOUS LE VIETNAM ! Et les constructeurs du pont, apparemment, taient des ingnieurs trs astucieux, car ils ont construit le pont spcifiquement pour "immobiliser" le dos de ce monstre, l'empchant de se dbattre. Ainsi, le pont japonais est devenu une sorte de presse antisismique pour tout le Centre du Vietnam.</p>
<img src="20.jpg" alt="Onamazu"/>

<p>Nous ne savons pas  quel point Onamazu a apprci cette "massage" thrapie, mais le pont, construit sur de solides supports en bois, a vraiment rsist pendant des centaines d'annes ! Bien que, pour tre honnte, pas sans l'aide de l'humanit. Le pont a subi huit (!) rnovations majeures (mme en 2022, il a t littralement dmont pour une "chirurgie" !), ce qui a probablement aussi un peu aid  l'empcher de s'effondrer. Mais le mythe du poisson-chat sonne toujours mieux, n'est-ce pas ?</p>

<h6>Le Prince, le Graveur et Trois Hiroglyphes</h6>

<p>En 1719, le Prince Nguyn Phc Chu a visit Hoi An. Il tait une figure importante qui a gouvern le Sud du Vietnam, presque comme un roi, de 1691  1725. Et ainsi, dit-on, il n'a pas seulement admir le pont, mais a personnellement grav trois caractres chinois au-dessus de la porte du temple ! Pouvez-vous imaginer ? Au lieu d'envoyer des serviteurs, le prince a dcid de faire la gravure lui-mme. Il a d se sentir inspir !</p>

<img src="23.jpg" alt="Le Prince, le Graveur et Trois Hiroglyphes"/>

<p>Ces symboles se traduisent trs potiquement : "pont pour accueillir les invits de loin." Ou, dans le style vietnamien, "Lai Viet Kieu." C'est comme si le pont lui-mme disait : "Bonjour, voyageur ! Entrez, faites comme chez vous, vous appartenez ici !" Un tel "panneau de bienvenue" ancien, grav de la main du souverain lui-mme.</p>

<h6>La Route Franaise et Pourquoi le Pont est rserv aux pitons</h6>

<img src="21.jpg" alt="Dtail du pont japonais"/>

<p>Les temps changent, et mme le Pont japonais a d endurer ses "expriences de mode". Pendant la domination coloniale, les Franais ont dcid : "H, pourquoi les motos ne pourraient-elles pas rouler ici ?" et ont nivel la route  travers le pont. a ressemble  une excellente ide pour les embouteillages, n'est-ce pas ? Heureusement, cette "innovation" a t annule plus tard, et le pont est redevenu rserv aux pitons. Et heureusement, car quel genre de "symbole" est-ce si des vlos y circulent  toute vitesse ?</p>

<h6>Un petit pont avec un grand cur</h6>
<p>Alors, quand vous traversez le Pont japonais, sachez ceci : vous ne marchez pas seulement sur des planches, vous foulez une histoire vivante, pleine de lgendes, de subtilits culturelles et mme de poissons-chats mythiques. Il ne relie pas seulement deux rives  il relie des poques, des peuples et peut-tre mme calme les tremblements de terre. C'est notre Pont couvert japonais  petit, mais trs fier et mystrieux.</p>

<img src="22.jpg" alt="Dtail du pont japonais"/>
      `,internalImageNames:["2.jpg","3.jpg","22.jpg","20.jpg","21.jpg","23.jpg","24.jpg","25.jpg","26.jpg"]},ru:{title:"  ",description:"  ,   XVI   .",fullDescription:`
<p>            (Cha Cu),   -    . ,    ,       !   ,     ...</p>

<img src="26.jpg" alt="  "/>

<p>    ,       20 000   (VND)!  ,    ,       ,   "  ".   , ,      ,      !   ,       ,    ,     , ?</p>

<h6> ,   </h6>
<p> XVII :      - ,       .        ,  : "  ,         !"  ,  1593 ,     .</p>

<img src="2.jpg" alt="  "/>

<p>  ,        1663 ,  ... !    : ",  !    !" (, ).     ,          ,    .</p>

<h6>,    </h6>

<img src="25.jpg" alt="  "/>
<small>   ,    </small>

<p>   ,  ... ? ,      .      -. ,         ,  ,  ,     .    ,     ,   !</p>

<img src="24.jpg" alt="  "/>

<p>           .  ,          ,    .  ,  -   (   ,    )? ,    ,       ?   ,     ,           .  ,  ,    ,    ,    !</p>

<h6>   </h6>
<p>     (  )!       ;               ()!</p>

<img src="3.jpg" alt=""/>
<small> (.:   " ")</small>

<p> :       ,   ,   .  , ,   ,     ,       !   , -,    ,      ,  ""   ,   .  ,           .</p>
<img src="20.jpg" alt=""/>

<p>  ,     "" ,  ,     ,    ! ,  ,    .    (!)   (  2022      ""!), , ,      .        ,   ?</p>

<h6>,    </h6>

<p> 1719       .    ,   ,   ,  1691  1725 .  , ,     ,         !   ?     ,     . ,  ,  !</p>

<img src="23.jpg" alt=",    "/>

<p>    : "    ". ,   , "  ".     : ", ! ,    ,   !"    " ",    .</p>

<h6>       </h6>

<img src="21.jpg" alt="  "/>

<p> ,        " ."      : ",      ?"     .      , ?  ,  ""   ,      .   ,      "",     ?</p>

<h6>    </h6>
<p>,      , :      ,     ,  ,      .          ,  , ,   .       ,     .</p>

<img src="22.jpg" alt="  "/>
      `,internalImageNames:["2.jpg","3.jpg","22.jpg","20.jpg","21.jpg","23.jpg","24.jpg","25.jpg","26.jpg"]},vn:{title:"Cha Cu (Cu Cha Nht Bn)",description:"Biu tng ni ting ca Hi An, c cng ng Nht Bn xy dng vo th k 16.",fullDescription:`
<p>Nu bn  n Hi An m cha chp mt bc nh ti Cha Cu (Cu Cha Nht Bn), th coi nh bn cha thc s n Hi An. Nghim tc m ni, cy cu ny duyn dng n mc n cn c a vo biu tng ca thnh ph! V c l do chnh ng, n c mt lch s rt khc thng...</p>

<img src="26.jpg" alt="Chi tit Cu Nht Bn"/>

<p>Cy cu ny l mt ngi sao thc s, nhn li bn t t tin 20.000 ng Vit Nam (VND)! ng ngc nhin nu bn thy m ng khch du lch nghim tc cm t tin ny bn cnh cy cu, c gng c c "bc nh ". Mc d c th khng phi l bc nh c o nht trn th gii, nhng khng th cng li mt bc nh selfie nh vy! Rt cuc, khng phi ngy no bn cng cm tin trn tay m li miu t th  pha sau bn, ng khng?</p>

<h6>Ngi Nht  ri i, nhng cy cu vn  li</h6>
<p>Hy tng tng th k 17: Hi An l mt trung tm thng mi quc t  ng Nam , thu ht cc thng nhn t khp ni trn th gii. Cc thng nhn Nht Bn v Trung Quc hot ng rt tch cc ti y n ni h quyt nh: "Hy xy mt cy cu  d dng gh thm nhau hn!" V th l, vo nm 1593, ngi hng ca chng ta  ra i.</p>

<img src="2.jpg" alt="Chi tit Cu Nht Bn"/>

<p>t ngi bit iu ny, nhng ngi Nht  sng tch cc  Hi An cho n nm 1663, v sau ... Bm! Chnh ph Nht Bn t ngt tuyn b: "Thi, ngng giao thng! Chng ta s b c lp!" (Gn nh vy). V vy, Nht Bn  t c lp, v di sn trng l ca h  cy cu ny  vn ng vng, nh mt li cho t qu kh.</p>

<h6>Cu, Cha v mt cht b n</h6>

<img src="25.jpg" alt="Chi tit Cu Nht Bn"/>
<small>Tng Thn o gio ca Thi tit, Trn Bo Bc </small>

<p>Bn i b qua cu, v c mt... ngi cha? Vng, ngay gia cu, mt bn th nh np mnh. N c dnh ring cho Ngc Hong Thng  ca o gio (Yu-di). Tht bun ci v o gio khng c thc hnh rng ri  Nht Bn, v vy c kh nng ngi cha  c ngi Vit thm vo sau ny.  l mt loi cu vn ha khng ch kt ni b m cn kt ni tn ngng!</p>

<img src="24.jpg" alt="Chi tit Cu Nht Bn"/>

<p>V  hai bn cu, bn c cho n bi nhng bc tng  hnh ch v kh. ng hi ti sao li l chng   l mt trong nhng b n ca Hi An khin bn phi gi u. C l l do nhng nm xy dng (bt u vo Nm Con Ch, kt thc vo Nm Con Kh)? Hoc, theo mt phin bn khc, nhiu v hong  Nht Bn  sinh ra trong nhng nm ny? D sao i na, chng  y u c l do, v ngi dn a phng vn trang tr v dng l cho chng. Ai bit c, c l chng thc s l nhng ngi bo v cy cu, v liu bn c may mn hm nay hay khng ty thuc vo chng!</p>

<h6>Chng li Con C Tr Khng L Di Nc</h6>
<p>y l phn in r (theo ngha tt)! Cy cu khng ch c xy dng  gii tr; n c mt nhim v rt quan trng   gi cht mt con c tr khng l trong thn thoi tn l Namazu ()!</p>

<img src="3.jpg" alt="Namazu"/>
<small>Namazu (ting Nht:   "c tr khng l")</small>

<p>Bn cht ca truyn thuyt: Trong vn ha dn gian Nht Bn, c mt con c tr khng l gy ra ng t khi n vy ui. u n, ngi ta ni,  di n , ui n  di Nht Bn, nhng LNG N LI NM NGAY DI VIT NAM! V nhng ngi xy cu, r rng, l nhng k s rt thng minh, bi v h  xy cy cu c bit  "gi cht" lng ca con qui vt ny, ngn n khi vng vy. Do , Cha Cu  tr thnh mt loi "my p" chng ng t cho ton b min Trung Vit Nam.</p>
<img src="20.jpg" alt="Namazu"/>

<p>Chng ta khng bit Namazu  nh gi cao liu php "massage" ny n mc no, nhng cy cu, c xy dng trn nhng ct g vng chc, thc s  ng vng hng trm nm! Mc d, thnh tht m ni, khng phi khng c s gip  ca con ngi. Cy cu  tri qua tm (!) ln trng tu ln (thm ch vo nm 2022 n  c tho d theo ngha en  "phu thut"!), iu ny c l cng gip ch mt cht  n khng b sp. Nhng huyn thoi v c tr vn nghe hay hn, bn c ng  khng?</p>

<h6>Cha Nguyn Phc Chu, ngi chm khc v Ba ch Hn</h6>

<p>Nm 1719, Cha Nguyn Phc Chu  gh thm Hi An. ng l mt nhn vt quan trng, cai tr min Nam Vit Nam, gn nh mt v vua, t nm 1691 n 1725. V ngi ta ni rng, ng khng ch chim ngng cy cu, m cn ch thn chm khc ba ch Hn pha trn ca cha! Bn c th tng tng khng? Thay v c ngi hu, v cha  t mnh chm khc. Chc hn ng  cm thy rt hng th!</p>

<img src="23.jpg" alt="Cha Nguyn Phc Chu, ngi chm khc v Ba ch Hn"/>

<p>Nhng biu tng ny c dch rt th mng: "cu  n khch t xa". Hoc, theo kiu Vit Nam, "Lai Vin Kiu". C nh th chnh cy cu ang ni: "Cho mng, du khch! Hy vo i, hy t nhin nh  nh, bn thuc v ni ny!" Mt "bin cho" c xa nh vy, c chm khc bi chnh tay v cha.</p>

<h6>Con ng Php v l do Cu ch dnh cho ngi i b</h6>

<img src="21.jpg" alt="Chi tit Cu Nht Bn"/>

<p>Thi gian thay i, v ngay c Cha Cu cng phi chu ng nhng "th nghim thi trang" ca mnh. Trong thi k thuc a, ngi Php quyt nh: "Ny, ti sao xe my khng nn i qua y?" v san bng con ng qua cu. Nghe c v l mt  tng tuyt vi cho tc nghn giao thng, ng khng? May mn thay, "sng kin" ny sau   b hy b, v cy cu mt ln na tr thnh cu dnh ring cho ngi i b. V tht may mn, bi v mt "biu tng" nh th no nu xe my chy o o qua n?</p>

<h6>Mt cy cu nh vi mt tri tim khng l</h6>
<p>V vy, khi bn i b qua Cha Cu, hy bit iu ny: bn khng ch i trn nhng tm vn, bn ang bc i trn lch s sng ng, y huyn thoi, nhng chi tit vn ha phc tp, v thm ch c nhng con c tr thn thoi. N khng ch kt ni hai b  n kt ni cc thi i, cc dn tc, v c l cn lm du nhng trn ng t.  chnh l Cha Cu ca chng ta  nh b, nhng rt t ho v b n.</p>

<img src="22.jpg" alt="Chi tit Cu Nht Bn"/>
      `,internalImageNames:["2.jpg","3.jpg","22.jpg","20.jpg","21.jpg","23.jpg","24.jpg","25.jpg","26.jpg"]},slug:{en:"japanese-covered-bridge",ru:"yaponskiy-krytyy-most",es:"puente-cubierto-japones",fr:"pont-couvert-japonais",vn:"cau-chua-nhat-ban"}},{id:"cantonese-assembly-hall",coordinates:[15.877134908051383,108.32652751922738],category:["museum"],imageUrl:"4.jpg",en:{title:"Cantonese Assembly Hall",description:"The Cantonese Assembly Hall remains an active place of worship for both the Chinese diaspora in Hoi An and the Vietnamese people.",fullDescription:`
<p>
    If you've ever wondered what Hoi An looked like in its heyday as a trading port, then the Cantonese Assembly Hall (Hoi Quan Quang Trieu) is your ticket to the past! This majestic complex is one of the most striking testaments to the incredible influence of the Chinese community on the city's life.
</p>
<p>
    Built in 1885 by influential merchants from the Chinese province of Guangdong (Canton), this hall was much more than just a meeting place. It served as the spiritual and social heart of the Cantonese diaspora, a place of worship for the legendary Guan Kung (god of loyalty and bravery) and Thien Hau (Mother Goddess of the Sea, protector of all who navigate the waves). Imagine merchants gathering here, praying for safe passage and fair trade, settling disputes, and celebrating their traditions!
</p>

<h6>Guan Kung</h6>

<p>
    When you hear the name Guan Kung (Guan Yu), imagine a true hero whose fame has endured for centuries! This legendary general lived in China during the Three Kingdoms period (3rd century AD) and was known for his incredible loyalty, righteousness, honor, and fearlessness. He was such an outstanding figure that after his death, he was deified, becoming one of the most revered gods not only in China but also in many Chinese diasporas around the world.
</p>
<p>
    For merchants and businessmen, Guan Kung is not just a god of war. He is revered as the patron of fair trade and a protector against dishonesty. If you've ever seen statues of Guan Kung, you'll notice his powerful figure with a long beard and a red face, often in armor, sometimes with a halberd. He is a symbol of strength that reminds us of the need to be honest and unwavering in our dealings. In the Cantonese Assembly Hall, he was honored, seeking his blessing for successful and just trade.
</p>

<h6>Thien Hau: Mother Goddess of the Sea</h6>
<p>
    Now, let's turn to another incredible goddess  Thien Hau (Thien Hau), or as she's also called, the Mother Goddess of the Sea. Imagine the endless ocean expanses, over which countless ships have sailed for centuries... For sailors, fishermen, and merchants whose lives depended on the mercy of the sea, Thien Hau was the most important protector.
</p>
<p>
    Thien Hau is believed to have been a mortal girl named Lin Mo from Fujian (China) who possessed mystical abilities and could save sailors during storms. After her death, she ascended and became a goddess, protecting all who embark on a sea journey.
</p>
<p>
    For Chinese traders who crossed dangerous seas to reach Hoi An, worshiping Thien Hau was an absolute necessity. She was their hope and assurance of a safe return home. In the Cantonese Assembly Hall, her altar serves as a reminder of how vital maritime routes were and how strongly those who risked their lives and goods on the boundless oceans believed in her power. She is a symbol of safety, good fortune, and the patroness of all water journeys.
</p>

<h6>Architectural Masterpiece and Details That Will Surprise You</h6>
<img src="29.jpg" alt="Cantonese Assembly Hall"/>
<p>
    The Cantonese Assembly Hall is a true architectural extravaganza, pure Cantonese style! Built of wood, stone, and red brick, the complex immediately captures your attention with its details:
</p>
<ul>
    <li>Entrance Gate: You'll be greeted by impressive, richly decorated gates, often with three entrances and intricate carvings  they seem to invite you into another world.</li>
    <li>Mystical Courtyards: Inside, you'll find several light-filled inner courtyards leading to the Main Hall. In one of them, be sure to notice the large decorative fountain or pond with dragons  symbols of wealth and good fortune!</li>
    <li>Art in Every Detail: The hall is famous for its incredibly detailed and skillfully executed wood and stone carvings. Here, you can endlessly examine images of dragons, phoenixes, mythical creatures, animals, as well as scenes from Chinese mythology and classical novels. Bright colors, especially red and gold, create a truly luxurious atmosphere.</li>
    <li>Sculptures and Statues: In addition to the carvings, you'll see vibrant statues, including the main statue of Guan Kung. And also look for sculptures of the 12 animals of the Chinese zodiac  they are very popular with visitors!</li>
</ul>

<h6>Cultural Significance and Living History</h6>
<p>
    The Cantonese Assembly Hall continues to be an active place of worship for the Chinese diaspora in Hoi An today. Important annual festivals are held here, especially the colorful Guan Kung Festival, attracting many devotees and tourists.
</p>
<p>
    This hall is not just a beautiful attraction. It is a direct reflection of the economic power and cultural influence of the Cantonese community during Hoi An's heyday. It is an important part of the UNESCO heritage, demonstrating the deep cultural interaction and legacy created by different communities.
</p>
<p>
    Opening Hours: Usually from 07:00 to 17:00 daily.
</p>
<p>
    Admission: Visiting the Cantonese Assembly Hall is usually included in the general admission ticket to Hoi An Ancient Town. This is convenient as it also grants access to other attractions.
</p>
<p>
    Be sure to visit the Cantonese Assembly Hall to delve deep into the history and culture of Hoi An's Chinese diaspora. It is truly an impressive and beautifully preserved place!
</p>
    `,internalImageNames:["29.jpg"]},ru:{title:"  ",description:"            ,     .",fullDescription:`
<p>
      -  ,        ,     (Hoi Quan Quang Trieu)      !                .
</p>
<p>
      1885        (),     ,    .        ,      (   )    (- ,  ,    ).   ,   ,       ,      !
</p>

<h6> </h6>

<p>
          ( ),    ,    !          (III   )      , ,   .     ,     ,          ,         .
</p>
<p>
               .          .   -    ,           ,   ,   .    ,           .       ,        .
</p>

<h6> : - </h6>
<p>
               (Thin Hu), ,    , - .     ,      ...  ,   ,      ,      .
</p>
<p>
    ,             (),           .        ,  ,     .
</p>
<p>
      ,    ,    ,      .         .          ,          ,         ,    .    ,      .
</p>

<h6>   ,   </h6>
<img src="29.jpg" alt="  "/>
<p>
           ,   !   ,    ,      :
</p>
<ul>
    <li> :   ,   ,               .</li>
    <li> :       ,    .                    !</li>
    <li>   :            .      , ,  , ,         .  ,    ,    .</li>
    <li>  :  ,    ,     .     12         !</li>
</ul>

<h6>    </h6>
<p>
                  .     ,     ,     .
</p>
<p>
          .              .     ,      ,   .
</p>
<p>
     :   07:00  17:00 .
</p>
<p>
    :              .  ,         .
</p>
<p>
        ,          .       !
</p>
    `,internalImageNames:["29.jpg"]},es:{title:"Sala de la Asamblea Cantonesa",description:"La Sala de la Asamblea Cantonesa sigue siendo un lugar de culto activo tanto para la dispora china en Hoi An como para el pueblo vietnamita.",fullDescription:`
<p>
    Si alguna vez te has preguntado cmo era Hoi An en su apogeo como puerto comercial, entonces la Sala de la Asamblea Cantonesa (Hoi Quan Quang Trieu) es tu boleto al pasado! Este majestuoso complejo es uno de los testimonios ms impactantes de la increble influencia de la comunidad china en la vida de la ciudad.
</p>
<p>
    Construida en 1885 por influyentes comerciantes de la provincia china de Guangdong (Cantn), esta sala era mucho ms que un simple lugar de reunin. Sirvi como el corazn espiritual y social de la dispora cantonesa, un lugar de culto para el legendario Guan Kung (dios de la lealtad y la valenta) y Thien Hau (Madre Diosa del Mar, protectora de todos los que navegan las olas). Imagina a los comerciantes reunindose aqu, orando por un paso seguro y un comercio justo, resolviendo disputas y celebrando sus tradiciones!
</p>

<h6>Guan Kung</h6>

<p>
    Cuando escuches el nombre de Guan Kung (Guan Yu), imagina a un verdadero hroe cuya fama ha perdurado durante siglos! Este legendario general vivi en China durante el perodo de los Tres Reinos (siglo III d.C.) y fue conocido por su increble lealtad, rectitud, honor y valenta. Fue una figura tan destacada que, despus de su muerte, fue deificado, convirtindose en uno de los dioses ms venerados no solo en China, sino tambin en muchas disporas chinas de todo el mundo.
</p>
<p>
    Para los comerciantes y hombres de negocios, Guan Kung no es solo un dios de la guerra. Es venerado como el patrn del comercio justo y un protector contra la deshonestidad. Si alguna vez has visto estatuas de Guan Kung, notars su poderosa figura con una larga barba y un rostro rojo, a menudo con armadura, a veces con una alabarda. Es un smbolo de fuerza que nos recuerda la necesidad de ser honestos e inquebrantables en nuestros tratos. En la Sala de la Asamblea Cantonesa, se le honraba, buscando su bendicin para un comercio exitoso y justo.
</p>

<h6>Thien Hau: Madre Diosa del Mar</h6>
<p>
    Ahora, pasemos a otra diosa increble: Thien Hau (Thien Hau), o como tambin se la llama, la Madre Diosa del Mar. Imagina las infinitas extensiones ocenicas, por las que innumerables barcos han navegado durante siglos... Para los marineros, pescadores y comerciantes cuyas vidas dependan de la misericordia del mar, Thien Hau era la protectora ms importante.
</p>
<p>
    Se cree que Thien Hau fue una nia mortal llamada Lin Mo de Fujian (China) que posea habilidades msticas y poda salvar a los marineros durante las tormentas. Despus de su muerte, ascendi y se convirti en una diosa, protegiendo a todos los que se embarcan en un viaje por mar.
</p>
<p>
    Para los comerciantes chinos que cruzaban mares peligrosos para llegar a Hoi An, adorar a Thien Hau era una necesidad absoluta. Ella era su esperanza y la seguridad de un regreso seguro a casa. En la Sala de la Asamblea Cantonesa, su altar sirve como un recordatorio de lo vitales que eran las rutas martimas y de cun firmemente crean en su poder quienes arriesgaban sus vidas y bienes en los ocanos ilimitados. Ella es un smbolo de seguridad, buena fortuna y la patrona de todos los viajes por agua.
</p>

<h6>Obra Maestra Arquitectnica y Detalles Que Te Sorprendern</h6>
<img src="29.jpg" alt="Sala de la Asamblea Cantonesa"/>
<p>
    La Sala de la Asamblea Cantonesa es una verdadera extravagancia arquitectnica, puro estilo cantons! Construido con madera, piedra y ladrillo rojo, el complejo capta inmediatamente tu atencin con sus detalles:
</p>
<ul>
    <li>Puerta de Entrada: Sers recibido por impresionantes puertas, ricamente decoradas, a menudo con tres entradas y tallas intrincadas, que parecen invitarte a otro mundo.</li>
    <li>Patios Msticos: En el interior, encontrars varios patios interiores llenos de luz que conducen al Saln Principal. En uno de ellos, asegrate de notar la gran fuente decorativa o estanque con dragones, smbolos de riqueza y buena fortuna!</li>
    <li>Arte en Cada Detalle: La sala es famosa por sus tallas de madera y piedra increblemente detalladas y hbilmente ejecutadas. Aqu, puedes examinar sin cesar imgenes de dragones, fnix, criaturas mticas, animales, as como escenas de la mitologa china y novelas clsicas. Los colores brillantes, especialmente el rojo y el dorado, crean una atmsfera verdaderamente lujosa.</li>
    <li>Esculturas y Estatuas: Adems de las tallas, vers estatuas vibrantes, incluida la estatua principal de Guan Kung. Y tambin busca esculturas de los 12 animales del zodiaco chino, son muy populares entre los visitantes!</li>
</ul>

<h6>Significado Cultural e Historia Viva</h6>
<p>
    La Sala de la Asamblea Cantonesa sigue siendo hoy un lugar de culto activo para la dispora china en Hoi An. Aqu se celebran importantes festivales anuales, especialmente el colorido Festival de Guan Kung, que atrae a muchos devotos y turistas.
</p>
<p>
    Esta sala no es solo una hermosa atraccin. Es un reflejo directo del poder econmico y la influencia cultural de la comunidad cantonesa durante el apogeo de Hoi An. Es una parte importante del patrimonio de la UNESCO, que demuestra la profunda interaccin cultural y el legado creado por diferentes comunidades.
</p>
<p>
    Horario de Apertura: Normalmente de 07:00 a 17:00 diariamente.
</p>
<p>
    Entrada: La visita a la Sala de la Asamblea Cantonesa suele estar incluida en el billete de entrada general al Casco Antiguo de Hoi An. Esto es conveniente, ya que tambin permite el acceso a otras atracciones.
</p>
<p>
    Asegrate de visitar la Sala de la Asamblea Cantonesa para profundizar en la historia y la cultura de la dispora china de Hoi An. Es realmente un lugar impresionante y maravillosamente conservado!
</p>
    `,internalImageNames:["29.jpg"]},fr:{title:"Salle de l'Assemble Cantonaise",description:"La salle de l'Assemble Cantonaise demeure un lieu de culte actif pour la diaspora chinoise  Hoi An et le peuple vietnamien.",fullDescription:`
<p>
    Si vous vous tes dj demand  quoi ressemblait Hoi An  son apoge en tant que port de commerce, alors la Salle de l'Assemble Cantonaise (Hoi Quan Quang Trieu) est votre billet pour le pass ! Ce complexe majestueux est l'un des tmoignages les plus frappants de l'incroyable influence de la communaut chinoise sur la vie de la ville.
</p>
<p>
    Construite en 1885 par des marchands influents de la province chinoise du Guangdong (Canton), cette salle tait bien plus qu'un simple lieu de rencontre. Elle servait de cur spirituel et social de la diaspora cantonaise, un lieu de culte pour le lgendaire Guan Kung (dieu de la loyaut et du courage) et Thien Hau (Desse Mre de la Mer, protectrice de tous ceux qui naviguent sur les vagues). Imaginez les marchands se rassemblant ici, priant pour un passage sr et un commerce quitable, rglant les diffrends et clbrant leurs traditions !
</p>

<h6>Guan Kung</h6>

<p>
    Lorsque vous entendez le nom de Guan Kung (Guan Yu), imaginez un vritable hros dont la renomme a perdur pendant des sicles ! Ce gnral lgendaire a vcu en Chine pendant la priode des Trois Royaumes (IIIe sicle aprs J.-C.) et tait connu pour son incroyable loyaut, sa droiture, son honneur et son intrpidit. Il tait une figure tellement remarquable qu'aprs sa mort, il fut difi, devenant l'un des dieux les plus vnrs non seulement en Chine, mais aussi dans de nombreuses diasporas chinoises du monde entier.
</p>
<p>
    Pour les marchands et les hommes d'affaires, Guan Kung n'est pas seulement un dieu de la guerre. Il est vnr comme le protecteur du commerce quitable et un protecteur contre la malhonntet. Si vous avez dj vu des statues de Guan Kung, vous remarquerez sa silhouette puissante avec une longue barbe et un visage rouge, souvent en armure, parfois avec une hallebarde. C'est un symbole de force qui nous rappelle la ncessit d'tre honnte et inbranlable dans nos transactions. Dans la Salle de l'Assemble Cantonaise, il tait honor, recherchant sa bndiction pour un commerce russi et juste.
</p>

<h6>Thien Hau : Desse Mre de la Mer</h6>
<p>
    Passons maintenant  une autre desse incroyable  Thien Hau (Thien Hau), ou comme on l'appelle aussi, la Desse Mre de la Mer. Imaginez les tendues ocaniques infinies, sur lesquelles d'innombrables navires ont navigu pendant des sicles... Pour les marins, les pcheurs et les marchands dont la vie dpendait de la misricorde de la mer, Thien Hau tait la protectrice la plus importante.
</p>
<p>
    On pense que Thien Hau tait une jeune fille mortelle nomme Lin Mo de Fujian (Chine) qui possdait des capacits mystiques et pouvait sauver les marins pendant les temptes. Aprs sa mort, elle est monte au ciel et est devenue une desse, protgeant tous ceux qui s'engagent dans un voyage en mer.
</p>
<p>
    Pour les commerants chinois qui traversaient des mers dangereuses pour atteindre Hoi An, le culte de Thien Hau tait une ncessit absolue. Elle tait leur espoir et leur assurance d'un retour en toute scurit  la maison. Dans la Salle de l'Assemble Cantonaise, son autel sert de rappel de l'importance vitale des routes maritimes et de la force avec laquelle ceux qui risquaient leur vie et leurs biens sur les ocans illimits croyaient en son pouvoir. C'est un symbole de scurit, de bonne fortune et la protectrice de tous les voyages nautiques.
</p>

<h6>Chef-d'uvre architectural et dtails qui vous surprendront</h6>
<img src="29.jpg" alt="Salle de l'Assemble Cantonaise"/>
<p>
    La Salle de l'Assemble Cantonaise est une vritable extravagance architecturale, pur style cantonais ! Construite en bois, en pierre et en brique rouge, le complexe attire immdiatement votre attention par ses dtails :
</p>
<ul>
    <li>Porte d'entre : Vous serez accueilli par des portes impressionnantes, richement dcores, souvent avec trois entres et des sculptures complexes  elles semblent vous inviter dans un autre monde.</li>
    <li>Cour mystiques :  l'intrieur, vous trouverez plusieurs cours intrieures lumineuses menant  la Salle principale. Dans l'une d'elles, n'oubliez pas de remarquer la grande fontaine dcorative ou l'tang avec des dragons  symboles de richesse et de bonne fortune !</li>
    <li>L'art dans chaque dtail : La salle est clbre pour ses sculptures sur bois et sur pierre incroyablement dtailles et habilement excutes. Ici, vous pouvez examiner sans fin des images de dragons, de phnix, de cratures mythiques, d'animaux, ainsi que des scnes de la mythologie chinoise et des romans classiques. Les couleurs vives, en particulier le rouge et l'or, crent une atmosphre vraiment luxueuse.</li>
    <li>Sculptures et statues : En plus des sculptures, vous verrez des statues vibrantes, y compris la statue principale de Guan Kung. Et cherchez galement les sculptures des 12 animaux du zodiaque chinois  elles sont trs populaires auprs des visiteurs !</li>
</ul>

<h6>Signification culturelle et histoire vivante</h6>
<p>
    La Salle de l'Assemble Cantonaise continue d'tre un lieu de culte actif pour la diaspora chinoise  Hoi An aujourd'hui. D'importants festivals annuels y sont organiss, en particulier le color Festival de Guan Kung, attirant de nombreux fidles et touristes.
</p>
<p>
    Cette salle n'est pas seulement une belle attraction. C'est un reflet direct du pouvoir conomique et de l'influence culturelle de la communaut cantonaise  l'apoge de Hoi An. C'est une partie importante du patrimoine de l'UNESCO, dmontrant la profonde interaction culturelle et l'hritage cr par diffrentes communauts.
</p>
<p>
    Heures d'ouverture : Gnralement de 07h00  17h00 tous les jours.
</p>
<p>
    Entre : La visite de la Salle de l'Assemble Cantonaise est gnralement incluse dans le billet d'entre gnral pour la vieille ville de Hoi An. C'est pratique car cela donne galement accs  d'autres attractions.
</p>
<p>
    Assurez-vous de visiter la Salle de l'Assemble Cantonaise pour vous plonger profondment dans l'histoire et la culture de la diaspora chinoise de Hoi An. C'est vraiment un endroit impressionnant et magnifiquement prserv !
</p>
    `,internalImageNames:["29.jpg"]},vn:{title:"Hi Qun Qung Triu",description:"Hi Qun Qung Triu vn l ni th cng tch cc ca cng ng ngi Hoa  Hi An v ngi dn Vit Nam.",fullDescription:`
<p>
    Nu bn  tng t hi Hi An trng nh th no vo thi k hong kim ca mt cng thng mi, th Hi Qun Qung Triu l tm v a bn v qu kh! T hp kin trc trng l ny l mt trong nhng minh chng ni bt nht v nh hng ng kinh ngc ca cng ng ngi Hoa n i sng ca thnh ph.
</p>
<p>
    c xy dng vo nm 1885 bi cc thng gia c nh hng n t tnh Qung ng (Canton) ca Trung Quc, hi qun ny khng ch l mt ni gp g. N ng vai tr l tri tim tinh thn v x hi ca cng ng ngi Qung ng, mt ni th cng cho Quan Cng (v thn ca lng trung thnh v dng cm) v Thin Hu (Mu Thn Bin c, ngi bo v tt c nhng ai vt sng). Hy tng tng cc thng gia t tp  y, cu nguyn cho nhng chuyn i an ton v thng mi cng bng, gii quyt tranh chp v tn vinh truyn thng ca h!
</p>

<h6>Quan Cng</h6>

<p>
    Khi bn nghe tn Quan Cng (Quan V), hy hnh dung mt ngi anh hng thc s vi danh ting  tn ti qua nhiu th k! V tng huyn thoi ny sng  Trung Quc trong thi Tam Quc (th k th 3 sau Cng nguyn) v ni ting vi lng trung thnh, chnh trc, danh d v s dng cm ng kinh ngc. ng l mt nhn vt xut chng n ni sau khi qua i, ng c phong thn, tr thnh mt trong nhng v thn c tn knh nht khng ch  Trung Quc m cn  nhiu cng ng ngi Hoa trn khp th gii.
</p>
<p>
    i vi cc thng gia v doanh nhn, Quan Cng khng ch l mt v thn chin tranh. ng c tn knh l ngi bo tr thng mi cng bng v ngi bo v chng li s khng trung thc. Nu bn  tng thy cc bc tng Quan Cng, bn s nhn thy hnh dng uy nghi ca ng vi b ru di v khun mt , thng mc o gip, i khi cm mt thanh ao. ng l biu tng ca sc mnh nhc nh chng ta v s cn thit phi trung thc v kin nh trong cc giao dch ca mnh. Ti Hi Qun Qung Triu, ng c tn vinh, tm kim s ban phc ca ng cho mt giao thng thnh cng v cng bng.
</p>

<h6>Thin Hu: Mu Thn Bin C</h6>
<p>
    By gi, hy chuyn sang mt n thn ng kinh ngc khc  Thin Hu (Thin Hu), hay cn gi l Mu Thn Bin C. Hy tng tng nhng vng bin bao la, ni v s con tu  i qua hng th k... i vi thy th, ng dn v thng gia m cuc sng ca h ph thuc vo lng nhn t ca bin c, Thin Hu l ngi bo v quan trng nht.
</p>
<p>
    Thin Hu c cho l mt c gi phm trn tn l Lm Mc n t Phc Kin (Trung Quc) s hu kh nng thn b v c th cu cc thy th trong bo t. Sau khi qua i, b thng thin v tr thnh mt n thn, bo v tt c nhng ai bt u mt cuc hnh trnh trn bin.
</p>
<p>
    i vi cc thng nhn ngi Hoa  vt qua nhng vng bin nguy him  n Hi An, vic th cng Thin Hu l mt iu hon ton cn thit. B l hy vng v s m bo cho mt chuyn tr v nh an ton. Ti Hi Qun Qung Triu, bn th ca b l mt li nhc nh v tm quan trng ca cc tuyn ng bin v mc  mnh m ca nim tin vo sc mnh ca b i vi nhng ngi  mo him tnh mng v hng ha ca mnh trn i dng bao la. B l biu tng ca s an ton, may mn v l ngi bo tr cho tt c cc chuyn i trn bin.
</p>

<h6>Kit tc kin trc v nhng chi tit s lm bn ngc nhin</h6>
<img src="29.jpg" alt="Hi Qun Qung Triu"/>
<p>
    Hi Qun Qung Triu l mt kit tc kin trc thc s, mang m phong cch Qung ng! c xy dng bng g,  v gch , khu phc hp ny ngay lp tc thu ht s ch  ca bn vi cc chi tit:
</p>
<ul>
    <li>Cng vo: Bn s c cho n bi nhng cnh cng n tng, c trang tr phong ph, thng c ba li vo v nhng ng chm khc tinh xo  chng dng nh mi bn vo mt th gii khc.</li>
    <li>Sn trong huyn b: Bn trong, bn s tm thy mt s sn trong trn ngp nh sng dn n Chnh in. Trong mt trong s , hy nh ch  n i phun nc hoc ao trang tr ln vi rng  biu tng ca s giu c v may mn!</li>
    <li>Ngh thut trong tng chi tit: Hi qun ni ting vi nhng chm khc g v  v cng chi tit v c thc hin mt cch kho lo. Ti y, bn c th chim ngng khng ngng nhng hnh nh rng, phng, sinh vt thn thoi, ng vt, cng nh cc cnh trong thn thoi Trung Quc v tiu thuyt c in. Mu sc ti sng, c bit l  v vng, to nn mt bu khng kh thc s sang trng.</li>
    <li>iu khc v tng: Ngoi cc chm khc, bn s thy nhng bc tng sng ng, bao gm bc tng chnh ca Quan Cng. V cng hy tm cc bc tng ca 12 con gip Trung Quc  chng rt ph bin vi du khch!</li>
</ul>

<h6> ngha vn ha v lch s sng ng</h6>
<p>
    Hi Qun Qung Triu ngy nay vn tip tc l mt ni th cng tch cc ca cng ng ngi Hoa  Hi An. Cc l hi quan trng hng nm c t chc ti y, c bit l L hi Quan Cng y mu sc, thu ht nhiu tn  v du khch.
</p>
<p>
    Hi qun ny khng ch l mt im tham quan p.  l s phn nh trc tip sc mnh kinh t v nh hng vn ha ca cng ng ngi Qung ng trong thi k hong kim ca Hi An.  l mt phn quan trng ca di sn UNESCO, th hin s tng tc vn ha su sc v di sn c to ra bi cc cng ng khc nhau.
</p>
<p>
    Gi m ca: Thng t 07:00 n 17:00 hng ngy.
</p>
<p>
    V vo ca: Vic tham quan Hi Qun Qung Triu thng c bao gm trong v vo ca chung ca Ph c Hi An. iu ny tin li v n cng cp quyn truy cp vo cc im tham quan khc.
</p>
<p>
    Hy chc chn gh thm Hi Qun Qung Triu  tm hiu su hn v lch s v vn ha ca cng ng ngi Hoa  Hi An.  thc s l mt ni n tng v c bo tn tuyt vi!
</p>
    `,internalImageNames:["29.jpg"]},slug:{en:"cantonese-assembly-hall",ru:"kantonskiy-sbornyy-zal",es:"sala-asamblea-cantonesa",fr:"salle-assemblee-cantonaise",vn:"hoi-quan-quang-trieu"}},{id:"phung-hung-house",coordinates:[15.877187252525204,108.32579993502969],category:["museum"],imageUrl:"5.jpg",en:{title:"Phung Hung House",description:"One of Hoi An's largest ancient mansions!",fullDescription:`
<p>
    Imagine standing by the famous Japanese Bridge in Hoi An, feeling the breeze from the river and the scent of history... And right behind the bridge, like a guardian of centuries, stands the Phung Hung House (The Old House of Phung Hung). This isn't just an old house; it's a living open-air museum where every beam and every tile remembers its stories.
</p>
<p>
    This mansion, one of the largest and most impressive in Hoi An, was built in 1780. Its owners were not just ordinary residents, but successful merchants who made a fortune selling exotic goods: glassware, precious spices, and fragrant incense. Imagine how many caravans and ships this house has seen!
</p>

<h6>Architectural Mix or How Was Hoi An Built?</h6>
<p>
    The architecture of Phung Hung House is a song in itself, darling! It's a true embodiment of what makes Hoi An so unique: an incredible blend of cultures. Here, every corner tells you about trade routes and cultural exchanges:
</p>
<ul>
    <li>Chinese, Japanese, and Vietnamese elements are skillfully intertwined, creating a unique appearance. You'll see the influence of Chinese temples, Japanese precision, and Vietnamese functionality, all under one roof. It's like an architectural mixed salad, but very, very tasty!</li>
    <li>The two-story building is supported by as many as 80 sturdy wooden columns. Just imagine the scale and skill of the ancient builders! These columns don't just hold the roof  they seem to carry history itself.</li>
    <li>Like many ancient houses in Hoi An, Phung Hung House has an ancestral shrine. This is the heart of the house, a place where generations of the family paid tribute to their ancestors and preserved their traditions. This is what makes these houses alive, not just tourist attractions.</li>
</ul>

<h6>What Else to See and Feel?</h6>

<p>
    In addition to its unique architecture and rich history, Phung Hung House has a few surprises in store for you:
</p>
<ul>
    <li>Legacy Lives On: The house still belongs to the descendants of the very merchants who built it. This is incredible, darling! You can chat with the guardians of history, who will proudly tell you about their home and family traditions. It's not a museum exhibit; it's living history!</li>
    <li>Breathtaking View: Be sure to go up to the balcony on the second floor. From there, you'll get an absolutely amazing view of the Japanese Bridge and the bustling street. It's the perfect place to take those postcard-perfect photos and simply soak in the atmosphere of Hoi An.</li>
    <li>Sometimes, Surprises: Since it's a residential house, it might not always be open or have varying hours, depending on family circumstances. This adds even more charm and authenticity  it's like you're visiting someone's home, not a well-oiled tourist attraction.</li>
</ul>
<p>
    Phung Hung House is not just a dot on the map of Hoi An. It's a gateway to its trading past, a living testament to cultural richness, and a place where you can feel the true spirit of the city. Be sure to check it out!
</p>
    `,internalImageNames:["27.jpg"]},ru:{title:"  ",description:"     !",fullDescription:`
<p>
    ,        ,        ...    ,   ,     (The Old House of Phung Hung).     ;      ,         .
</p>
<p>
     ,        ,    1780 .       ,   ,       :  ,     . ,       !
</p>

<h6> ,    ?</h6>
<p>
             , !    ,     :   .           :
</p>
<ul>
    <li>,      ,   .     ,            .    -,  - !</li>
    <li>    80   .       !              .</li>
    <li>      ,      .   , ,            .      ,     .</li>
</ul>

<h6>    ?</h6>

<p>
         ,        :
</p>
<ul>
    <li> :         ,   .  , !      ,           .        !</li>
    <li> :      .           .   ,     ,     ,     .</li>
    <li> :    ,           ,     .               - ,      .</li>
</ul>
<p>
              .      ,      ,      .   !
</p>
    `,internalImageNames:["27.jpg"]},es:{title:"Casa de Phung Hung",description:"Una de las mansiones antiguas ms grandes de Hoi An!",fullDescription:`
<p>
    Imagina que ests de pie junto al famoso Puente Japons en Hoi An, sintiendo la brisa del ro y el aroma de la historia... Y justo detrs del puente, como un guardin de los siglos, se alza la Casa de Phung Hung (The Old House of Phung Hung). Esta no es solo una casa antigua; es un museo viviente al aire libre donde cada viga y cada teja recuerdan sus historias.
</p>
<p>
    Esta mansin, una de las ms grandes e impresionantes de Hoi An, fue construida en 1780. Sus propietarios no eran residentes comunes, sino exitosos comerciantes que hicieron fortuna vendiendo productos exticos: cristalera, especias preciosas e incienso fragante. Imagina cuntas caravanas y barcos ha visto esta casa!
</p>

<h6>Mezcla arquitectnica o Cmo se construy Hoi An?</h6>
<p>
    La arquitectura de la Casa de Phung Hung es una cancin en s misma, querida! Es una verdadera encarnacin de lo que hace a Hoi An tan nico: una increble mezcla de culturas. Aqu, cada rincn te habla de rutas comerciales e intercambios culturales:
</p>
<ul>
    <li>Elementos chinos, japoneses y vietnamitas se entrelazan hbilmente, creando una apariencia nica. Vers la influencia de los templos chinos, la precisin japonesa y la funcionalidad vietnamita, todo bajo un mismo techo. Es como una ensalada mixta arquitectnica, pero muy, muy sabrosa!</li>
    <li>El edificio de dos pisos est sostenido por hasta 80 robustas columnas de madera. Solo imagina la escala y la habilidad de los constructores antiguos! Estas columnas no solo sostienen el techo, sino que parecen llevar la historia misma.</li>
    <li>Como muchas casas antiguas en Hoi An, la Casa de Phung Hung tiene un santuario ancestral. Este es el corazn de la casa, un lugar donde generaciones de la familia rindieron homenaje a sus antepasados y conservaron sus tradiciones. Esto es lo que hace que estas casas estn vivas, no solo sean atracciones tursticas.</li>
</ul>

<h6>Qu ms ver y sentir?</h6>

<p>
    Adems de su arquitectura nica y su rica historia, la Casa de Phung Hung tiene algunas sorpresas guardadas para ti:
</p>
<ul>
    <li>El legado contina: La casa todava pertenece a los descendientes de los mismos comerciantes que la construyeron. Esto es increble, querida! Puedes charlar con los guardianes de la historia, quienes te contarn con orgullo sobre su hogar y las tradiciones familiares. No es una exhibicin de museo; es historia viva!</li>
    <li>Vista impresionante: Asegrate de subir al balcn del segundo piso. Desde all, obtendrs una vista absolutamente increble del Puente Japons y la animada calle. Es el lugar perfecto para tomar esas fotos dignas de postal y simplemente sumergirte en la atmsfera de Hoi An.</li>
    <li>A veces, sorpresas: Dado que es una casa residencial, es posible que no siempre est abierta o que tenga horarios variables, segn las circunstancias familiares. Esto aade an ms encanto y autenticidad, es como si estuvieras visitando la casa de alguien, no una atraccin turstica bien engrasada.</li>
</ul>
<p>
    La Casa de Phung Hung no es solo un punto en el mapa de Hoi An. Es una puerta de entrada a su pasado comercial, un testimonio vivo de la riqueza cultural y un lugar donde puedes sentir el verdadero espritu de la ciudad. Asegrate de visitarla!
</p>
    `,internalImageNames:["27.jpg"]},fr:{title:"Maison Phung Hung",description:"L'une des plus grandes demeures anciennes de Hoi An !",fullDescription:`
<p>
    Imaginez-vous debout prs du clbre Pont Japonais  Hoi An, sentant la brise du fleuve et le parfum de l'histoire... Et juste derrire le pont, comme un gardien des sicles, se dresse la Maison Phung Hung (L'Ancienne Maison de Phung Hung). Ce n'est pas juste une vieille maison ; c'est un muse vivant  ciel ouvert o chaque poutre et chaque tuile se souviennent de ses histoires.
</p>
<p>
    Cette demeure, l'une des plus grandes et des plus impressionnantes de Hoi An, a t construite en 1780. Ses propritaires n'taient pas de simples habitants, mais des marchands prospres qui ont fait fortune en vendant des produits exotiques : verrerie, pices prcieuses et encens parfum. Imaginez combien de caravanes et de navires cette maison a vus !
</p>

<h6>Mlange architectural ou Comment Hoi An a-t-elle t construite ?</h6>
<p>
    L'architecture de la Maison Phung Hung est une chanson  elle seule, ma chre ! C'est une vritable incarnation de ce qui rend Hoi An si unique : un incroyable mlange de cultures. Ici, chaque coin vous raconte des histoires de routes commerciales et d'changes culturels :
</p>
<ul>
    <li>Des lments chinois, japonais et vietnamiens sont habilement entrelacs, crant une apparence unique. Vous verrez l'influence des temples chinois, la prcision japonaise et la fonctionnalit vietnamienne, le tout sous un mme toit. C'est comme une salade mixte architecturale, mais trs, trs savoureuse !</li>
    <li>Le btiment de deux tages est soutenu par pas moins de 80 robustes colonnes en bois. Imaginez l'chelle et le savoir-faire des anciens constructeurs ! Ces colonnes ne tiennent pas seulement le toit  elles semblent porter l'histoire elle-mme.</li>
    <li>Comme de nombreuses maisons anciennes de Hoi An, la Maison Phung Hung possde un sanctuaire ancestral. C'est le cur de la maison, un lieu o des gnrations de la famille ont rendu hommage  leurs anctres et ont prserv leurs traditions. C'est ce qui rend ces maisons vivantes, et non de simples attractions touristiques.</li>
</ul>

<h6>Que voir et ressentir d'autre ?</h6>

<p>
    En plus de son architecture unique et de sa riche histoire, la Maison Phung Hung vous rserve quelques surprises :
</p>
<ul>
    <li>Le Legs perdure : La maison appartient toujours aux descendants des mmes marchands qui l'ont construite. C'est incroyable, ma chre ! Vous pouvez discuter avec les gardiens de l'histoire, qui vous raconteront avec fiert leur foyer et leurs traditions familiales. Ce n'est pas une exposition de muse ; c'est de l'histoire vivante !</li>
    <li>Vue imprenable : N'oubliez pas de monter sur le balcon du deuxime tage. De l, vous aurez une vue absolument incroyable sur le Pont Japonais et la rue anime. C'est l'endroit idal pour prendre ces photos dignes d'une carte postale et simplement vous imprgner de l'atmosphre de Hoi An.</li>
    <li>Parfois, des surprises : Comme c'est une maison rsidentielle, elle pourrait ne pas toujours tre ouverte ou avoir des horaires variables, selon les circonstances familiales. Cela ajoute encore plus de charme et d'authenticit  c'est comme si vous rendiez visite  quelqu'un chez lui, et non  une attraction touristique bien huile.</li>
</ul>
<p>
    La Maison Phung Hung n'est pas seulement un point sur la carte de Hoi An. C'est une porte d'entre vers son pass commercial, un tmoignage vivant de la richesse culturelle, et un endroit o vous pouvez ressentir le vritable esprit de la ville. Assurez-vous d'y jeter un coup d'il !
</p>
    `,internalImageNames:["27.jpg"]},vn:{title:"Nh C Phng Hng",description:"Mt trong nhng ngi nh c ln nht Hi An!",fullDescription:`
<p>
    Hy tng tng bn ang ng bn Cu Nht Bn ni ting  Hi An, cm nhn ln gi t dng sng v hng v ca lch s... V ngay pha sau cy cu, nh mt ngi bo v hng th k, l Nh C Phng Hng (The Old House of Phung Hung). y khng ch l mt ngi nh c; y l mt bo tng sng ngoi tri ni mi x nh v mi vin ngi u ghi nh nhng cu chuyn ca n.
</p>
<p>
    Dinh th ny, mt trong nhng ngi nh ln nht v n tng nht  Hi An, c xy dng vo nm 1780. Ch nhn ca n khng ch l nhng c dn bnh thng, m l nhng thng nhn thnh t  kim c ti sn nh bun bn cc mt hng ngoi lai:  thy tinh, gia v qu him v hng trm thm. Hy tng tng ngi nh ny  chng kin bao nhiu on caravan v tu thuyn!
</p>

<h6>S pha trn kin trc hay Hi An  c xy dng nh th no?</h6>
<p>
    Kin trc ca Nh C Phng Hng l mt bi ca ring, bn ! N l mt hin thn thc s ca nhng g lm cho Hi An tr nn c o: s pha trn ng kinh ngc ca cc nn vn ha.  y, mi gc u k cho bn nghe v cc tuyn ng thng mi v giao lu vn ha:
</p>
<ul>
    <li>Cc yu t Trung Quc, Nht Bn v Vit Nam c an xen kho lo, to nn mt v ngoi c o. Bn s thy nh hng ca cc ngi cha Trung Quc, s chnh xc ca Nht Bn v tnh nng ca Vit Nam, tt c di mt mi nh. N ging nh mt mn salad kin trc hn hp, nhng rt, rt ngon!</li>
    <li>Ta nh hai tng c chng  bi ti 80 ct g chc chn. Ch cn tng tng quy m v k nng ca nhng ngi th xy c i! Nhng ct ny khng ch gi mi nh  chng dng nh mang c lch s.</li>
    <li>Ging nh nhiu ngi nh c  Hi An, Nh C Phng Hng c mt bn th t tin. y l tri tim ca ngi nh, ni cc th h trong gia nh  t lng knh trng vi t tin v bo tn truyn thng ca h. y chnh l iu lm cho nhng ngi nh ny tr nn sng ng, khng ch l nhng im thu ht khch du lch.</li>
</ul>

<h6>Cn g  xem v cm nhn?</h6>

<p>
    Ngoi kin trc c o v lch s phong ph, Nh C Phng Hng cn c mt vi iu bt ng dnh cho bn:
</p>
<ul>
    <li>Di sn vn sng: Ngi nh vn thuc v con chu ca nhng thng nhn  xy dng n. iu ny tht ng kinh ngc, bn ! Bn c th tr chuyn vi nhng ngi gn gi lch s, nhng ngi s t ho k cho bn nghe v ngi nh v truyn thng gia nh ca h. y khng phi l mt trin lm bo tng; y l lch s sng!</li>
    <li>View ngon mc: Hy chc chn ln ban cng tng hai. T , bn s c mt ci nhn hon ton tuyt vi v Cu Nht Bn v con ph nhn nhp.  l ni hon ho  chp nhng bc nh p nh bu thip v n gin l m mnh vo bu khng kh ca Hi An.</li>
    <li>i khi, bt ng: V y l mt ngi nh dn sinh, nn n c th khng phi lc no cng m ca hoc c gi gic khc nhau, ty thuc vo hon cnh gia nh. iu ny cng lm tng thm v duyn dng v chn thc  ging nh bn ang gh thm nh ai , ch khng phi mt im du lch c t chc bi bn.</li>
</ul>
<p>
    Nh C Phng Hng khng ch l mt chm nh trn bn  Hi An.  l cnh cng dn n qu kh thng mi ca n, mt minh chng sng ng v s phong ph vn ha v mt ni bn c th cm nhn tinh thn thc s ca thnh ph. Hy chc chn gh thm!
</p>
    `,internalImageNames:["27.jpg"]},slug:{en:"phung-hung-house",ru:"dom-fung-hung",es:"casa-phung-hung",fr:"maison-phung-hung",vn:"nha-co-phung-hung"}},{id:"sa-huynh-cultural-museum",coordinates:[15.877044021697701,108.32639923348592],category:["museum"],imageUrl:"6.jpg",en:{title:"Sa Huynh Cultural Museum",description:"The museum tells the story of the first people who settled in the area 2000 years ago.",fullDescription:`
<p>
    Imagine: you're walking through the ancient streets of Hoi An, breathing in the scent of spices and feeling the breath of centuries. What if I told you that the history of this city began thousands of years before all these beautiful houses and Japanese bridges appeared? Long before traders from all over the world came here, life was already bustling!
</p>
<p>
    Want to delve into the heart of prehistoric Vietnam? Then your path leads to the Sa Huynh Cultural Museum. This is not just another exhibition  it's a time machine that will take you back 3,000 years, straight to the Iron Age!
</p>

<h6>What is this Sa Huynh anyway?</h6>
<p>
    Sa Huynh culture (approximately 1000 BC  200 AD) is not just a collection of boring archaeological finds. It was an entire civilization that, according to scholars, is the ancestor of the Champa people  the founders of the powerful Champa kingdom!
</p>
<p>
    The Sa Huynh people were true masters of their craft:
</p>
<ul>
    <li>Burial Mysteries: They cremated their adults and buried the ashes in huge ceramic urns, covered with lids. And yes, along with the ashes, they placed treasures  from tools to exquisite ornaments. Imagine how many stories these jars hold!</li>
    <li>Ancient "Blacksmiths": These guys mastered metallurgy, creating elegant iron and bronze tools: axes, swords, spearheads, knives, and sickles. These weren't just any old tools!</li>
    <li>Global Traders: Forget the "Silk Road"  Sa Huynh had its own "Sa Huynh-Kalanay Trade Route"! They traded with literally the whole world  from China and India to the Philippines and even the Mediterranean! Chinese coins and other curiosities found here prove that Hoi An was an international trading hub thousands of years before it became mainstream.</li>
</ul>

<h6>What awaits you inside the museum:</h6>
<img src="27.jpg" alt="Sa Huynh Cultural Museum"/>
<p>
    The Sa Huynh Cultural Museum is not a dusty archive, but a real treasure chest! It houses about 1000 unique artifacts found right here in Hoi An and on the nearby Cham Islands. Each exhibit is a piece of ancient life that will tell you its story.
</p>

<ul>
    <li>Urns, Urns, and More Urns: Of course, you'll see a collection of those very burial jars  from small to large, in various shapes and sizes. Try to imagine who might have been buried in each of them!</li>
    <li>The Brilliance of Ancient Jewelry: Get ready to admire! Incredible jewelry made of stone, bronze, gold, and glass is on display here. But the highlight of the program, of course, is the famous double-headed earrings (lingling-o). These are unique ear ornaments, often depicting two-headed creatures. Just think what these symbols meant to ancient people!</li>
    <li>Tools and Utensils: You'll see what the Sa Huynh people used every day: from axes to sickles, from pots to exquisite ceramics.</li>
    <li>Immersion in History: The museum provides detailed archaeological explanations, photographs from excavation sites, and even documentary videos that will help you visualize the life and rituals of this enigmatic civilization.</li>
</ul>

<h6>Important details for your adventure:</h6>
<ul>
    <li>Address: 149 Trn Ph, Phng Minh An, Hi An, Qung Nam, Vietnam. It's located right in the heart of the Ancient Town.</li>
    <li>Opening Hours: Usually from 08:00 to 20:00 daily. BUT! Keep in mind: on the 10th of each month, the museum is closed for maintenance. Plan your visit in advance!</li>
    <li>Admission: Visiting the museum usually requires a single admission ticket to Hoi An Ancient Town. This is convenient as it also grants access to other attractions.</li>
    <li>The Building Itself: The museum is housed in a beautiful, traditional building with characteristic yellow walls, red tiled roofs, and wooden elements, creating a perfect atmosphere for immersing yourself in antiquity.</li>
</ul>
<p>
    Don't miss the chance to touch the very origins of Hoi An and understand what laid the foundation for its greatness! The Sa Huynh Cultural Museum is not just history; it's a prologue to your adventure in Hoi An!
</p>
    `,internalImageNames:["27.jpg"]},ru:{title:"   ",description:"    ,    2000  .",fullDescription:`
<p>
    :      ,       .  ,    ,          ,         ?   ,       ,    !
</p>
<p>
          ?         .         ,     3000  ,    !
</p>

<h6>     ?</h6>
<p>
       ( 1000 .  ..  200 . ..)        .   , ,   ,         !
</p>
<p>
           :
</p>
<ul>
    <li> :           ,  .  ,           . ,     !</li>
    <li> "":    ,      : , ,  ,   .       !</li>
    <li> :   " "       "   -"!                !        ,           ,    .</li>
</ul>

<h6>    :</h6>
<img src="27.jpg" alt="   "/>
<p>
            ,     !    1000  ,   ,  ,     .       ,     .
</p>

<ul>
    <li>,     : ,            ,    .  ,        !</li>
    <li>  :  !      , ,   .   , ,     (lingling-o).    ,    .  ,       !</li>
    <li>  :  ,       :    ,     .</li>
    <li>  :     ,        ,          .</li>
</ul>

<h6>    :</h6>
<ul>
    <li>: 149 Trn Ph, Phng Minh An, Hi An, Qung Nam, .       .</li>
    <li> :   08:00  20:00 . !   : 10-        .    !</li>
    <li>:           .  ,         .</li>
    <li> :          ,      ,       .</li>
</ul>
<p>
             ,     !         ;       !
</p>
    `,internalImageNames:["27.jpg"]},es:{title:"Museo Cultural Sa Huynh",description:"El museo cuenta la historia de las primeras personas que se asentaron en la zona hace 2000 aos.",fullDescription:`
<p>
    Imagina: ests caminando por las antiguas calles de Hoi An, respirando el aroma de las especias y sintiendo el aliento de los siglos. Qu pasara si te dijera que la historia de esta ciudad comenz miles de aos antes de que aparecieran todas estas hermosas casas y puentes japoneses? Mucho antes de que los comerciantes de todo el mundo llegaran aqu, la vida ya bulla!
</p>
<p>
    Quieres adentrarte en el corazn del Vietnam prehistrico? Entonces tu camino te lleva al Museo Cultural Sa Huynh. Esta no es solo otra exposicin, es una mquina del tiempo que te transportar 3.000 aos atrs, directamente a la Edad del Hierro!
</p>

<h6>Qu es Sa Huynh, de todos modos?</h6>
<p>
    La cultura Sa Huynh (aproximadamente 1000 a.C.  200 d.C.) no es solo una coleccin de aburridos hallazgos arqueolgicos. Fue toda una civilizacin que, segn los estudiosos, es el ancestro del pueblo Champa, los fundadores del poderoso reino de Champa!
</p>
<p>
    La gente de Sa Huynh era verdadera maestra de su oficio:
</p>
<ul>
    <li>Misterios funerarios: Cremaban a sus adultos y enterraban las cenizas en enormes urnas de cermica, cubiertas con tapas. Y s, junto con las cenizas, colocaban tesoros, desde herramientas hasta exquisitos ornamentos. Imagina cuntas historias guardan estos jarrones!</li>
    <li>Antiguos "herreros": Estos tipos dominaron la metalurgia, creando elegantes herramientas de hierro y bronce: hachas, espadas, puntas de lanza, cuchillos y hoces. Estas no eran herramientas cualquiera!</li>
    <li>Comerciantes globales: Olvdate de la "Ruta de la Seda"  Sa Huynh tena su propia "Ruta Comercial Sa Huynh-Kalanay"! Comerciaban literalmente con todo el mundo, desde China e India hasta Filipinas e incluso el Mediterrneo. Las monedas chinas y otras curiosidades encontradas aqu demuestran que Hoi An fue un centro comercial internacional miles de aos antes de que se volviera algo comn.</li>
</ul>

<h6>Lo que te espera dentro del museo:</h6>
<img src="27.jpg" alt="Museo Cultural Sa Huynh"/>
<p>
    El Museo Cultural Sa Huynh no es un archivo polvoriento, sino un verdadero cofre del tesoro! Alberga alrededor de 1000 artefactos nicos encontrados aqu mismo en Hoi An y en las cercanas islas Cham. Cada exhibicin es una pieza de vida antigua que te contar su historia.
</p>

<ul>
    <li>Urnas, urnas y ms urnas: Por supuesto, vers una coleccin de esas mismas urnas funerarias, desde pequeas hasta grandes, en varias formas y tamaos. Intenta imaginar quin podra haber sido enterrado en cada una de ellas!</li>
    <li>El brillo de la joyera antigua: Preprate para admirar! Aqu se exhiben increbles joyas hechas de piedra, bronce, oro y vidrio. Pero lo ms destacado del programa, por supuesto, son los famosos aretes de doble cabeza (lingling-o). Estos son adornos de oreja nicos, que a menudo representan criaturas de dos cabezas. Piensa lo que estos smbolos significaron para la gente antigua!</li>
    <li>Herramientas y utensilios: Vers lo que la gente de Sa Huynh usaba todos los das: desde hachas hasta hoces, desde ollas hasta exquisita cermica.</li>
    <li>Inmersin en la historia: El museo ofrece explicaciones arqueolgicas detalladas, fotografas de los sitios de excavacin e incluso videos documentales que te ayudarn a visualizar la vida y los rituales de esta enigmtica civilizacin.</li>
</ul>

<h6>Detalles importantes para tu aventura:</h6>
<ul>
    <li>Direccin: 149 Trn Ph, Phng Minh An, Hi An, Qung Nam, Vietnam. Se encuentra justo en el corazn del Casco Antiguo.</li>
    <li>Horario de Apertura: Normalmente de 08:00 a 20:00 diariamente. PERO! Ten en cuenta: el da 10 de cada mes, el museo est cerrado por mantenimiento. Planifica tu visita con anticipacin!</li>
    <li>Entrada: La visita al museo generalmente requiere un solo boleto de entrada a la Ciudad Antigua de Hoi An. Esto es conveniente, ya que tambin otorga acceso a otras atracciones.</li>
    <li>El Edificio en S: El museo est ubicado en un hermoso edificio tradicional con caractersticas paredes amarillas, techos de tejas rojas y elementos de madera, creando una atmsfera perfecta para sumergirse en la antigedad.</li>
</ul>
<p>
    No pierdas la oportunidad de tocar los orgenes mismos de Hoi An y comprender qu sent las bases de su grandeza! El Museo Cultural Sa Huynh no es solo historia; es un prlogo a tu aventura en Hoi An!
</p>
    `,internalImageNames:["27.jpg"]},fr:{title:"Muse Culturel Sa Huynh",description:"Le muse raconte l'histoire des premiers habitants de la rgion il y a 2000 ans.",fullDescription:`
<p>
    Imaginez : vous marchez dans les rues anciennes de Hoi An, respirant le parfum des pices et sentant le souffle des sicles. Et si je vous disais que l'histoire de cette ville a commenc des milliers d'annes avant que toutes ces belles maisons et ponts japonais n'apparaissent ? Bien avant l'arrive des commerants du monde entier, la vie y battait dj son plein !
</p>
<p>
    Envie de plonger au cur du Vietnam prhistorique ? Alors votre chemin vous mne au Muse Culturel Sa Huynh. Ce n'est pas juste une autre exposition  c'est une machine  remonter le temps qui vous transportera 3 000 ans en arrire, directement  l'ge du fer !
</p>

<h6>Qu'est-ce que Sa Huynh au juste ?</h6>
<p>
    La culture Sa Huynh (environ 1000 av. J.-C.  200 ap. J.-C.) n'est pas seulement une collection de dcouvertes archologiques ennuyeuses. C'tait toute une civilisation qui, selon les chercheurs, est l'anctre du peuple Cham  les fondateurs du puissant royaume de Champa !
</p>
<p>
    Le peuple Sa Huynh tait de vritables matres de leur artisanat :
</p>
<ul>
    <li>Mystres funraires : Ils incinrait leurs adultes et enterraient les cendres dans d'normes urnes en cramique, couvertes de couvercles. Et oui, avec les cendres, ils plaaient des trsors  des outils aux ornements exquis. Imaginez combien d'histoires ces jarres reclent !</li>
    <li>Anciens "forgerons" : Ces gars-l matrisaient la mtallurgie, crant des outils lgants en fer et en bronze : haches, pes, pointes de lance, couteaux et faucilles. Ce n'taient pas n'importe quels vieux outils !</li>
    <li>Commerants mondiaux : Oubliez la "Route de la Soie"  Sa Huynh avait sa propre "Route Commerciale Sa Huynh-Kalanay" ! Ils commeraient littralement avec le monde entier  de la Chine et de l'Inde aux Philippines et mme  la Mditerrane ! Des pices de monnaie chinoises et d'autres curiosits trouves ici prouvent que Hoi An tait un centre commercial international des milliers d'annes avant que cela ne devienne courant.</li>
</ul>

<h6>Ce qui vous attend  l'intrieur du muse :</h6>
<img src="27.jpg" alt="Muse Culturel Sa Huynh"/>
<p>
    Le Muse Culturel Sa Huynh n'est pas une archive poussireuse, mais un vritable coffre au trsor ! Il abrite environ 1000 artefacts uniques trouvs ici mme  Hoi An et sur les les Cham voisines. Chaque exposition est un morceau de vie ancienne qui vous racontera son histoire.
</p>

<ul>
    <li>Urnes, urnes, et encore des urnes : Bien sr, vous verrez une collection de ces mmes jarres funraires  des petites aux grandes, de diffrentes formes et tailles. Essayez d'imaginer qui aurait pu tre enterr dans chacune d'elles !</li>
    <li>L'clat des bijoux anciens : Prparez-vous  admirer ! D'incroyables bijoux en pierre, bronze, or et verre sont exposs ici. Mais le clou du spectacle, bien sr, ce sont les clbres boucles d'oreilles  double tte (lingling-o). Ce sont des ornements d'oreille uniques, reprsentant souvent des cratures  deux ttes. Pensez simplement  ce que ces symboles signifiaient pour les peuples anciens !</li>
    <li>Outils et ustensiles : Vous verrez ce que le peuple Sa Huynh utilisait quotidiennement : des haches aux faucilles, des pots  la cramique exquise.</li>
    <li>Immersion dans l'histoire : Le muse fournit des explications archologiques dtailles, des photographies des sites de fouilles et mme des vidos documentaires qui vous aideront  visualiser la vie et les rituels de cette civilisation nigmatique.</li>
</ul>

<h6>Dtails importants pour votre aventure :</h6>
<ul>
    <li>Adresse : 149 Trn Ph, Phng Minh An, Hi An, Qung Nam, Vietnam. Il est situ en plein cur de la vieille ville.</li>
    <li>Heures d'ouverture : Gnralement de 08h00  20h00 tous les jours. MAIS ! Gardez  l'esprit : le 10 de chaque mois, le muse est ferm pour entretien. Planifiez votre visite  l'avance !</li>
    <li>Entre : La visite du muse ncessite gnralement un seul billet d'entre pour la vieille ville de Hoi An. C'est pratique car cela donne galement accs  d'autres attractions.</li>
    <li>Le btiment lui-mme : Le muse est install dans un magnifique btiment traditionnel avec des murs jaunes caractristiques, des toits de tuiles rouges et des lments en bois, crant une atmosphre parfaite pour vous plonger dans l'Antiquit.</li>
</ul>
<p>
    Ne manquez pas l'occasion de toucher aux origines mmes de Hoi An et de comprendre ce qui a jet les bases de sa grandeur ! Le Muse Culturel Sa Huynh n'est pas seulement de l'histoire ; c'est un prologue  votre aventure  Hoi An !
</p>
    `,internalImageNames:["27.jpg"]},vn:{title:"Bo tng Vn ha Sa Hunh",description:"Bo tng k cu chuyn v nhng ngi u tin nh c  khu vc ny cch y 2000 nm.",fullDescription:`
<p>
    Hy tng tng: bn ang i do trn nhng con ph c ca Hi An, ht th hng v ca cc loi gia v v cm nhn hi th ca nhiu th k. iu g s xy ra nu ti ni vi bn rng lch s ca thnh ph ny bt u t hng ngn nm trc khi tt c nhng ngi nh p v cu Nht Bn ny xut hin? Rt lu trc khi cc thng nhn t khp ni trn th gii n y, cuc sng  si ng ri!
</p>
<p>
    Bn mun i su vo trung tm ca Vit Nam tin s? Vy th con ng ca bn dn n Bo tng Vn ha Sa Hunh. y khng ch l mt cuc trin lm khc   l mt c my thi gian s a bn tr li 3.000 nm, thng n thi i  st!
</p>

<h6>Sa Hunh l g vy?</h6>
<p>
    Vn ha Sa Hunh (khong 1000 TCN  200 CN) khng ch l mt b su tp cc pht hin kho c hc nhm chn.  l c mt nn vn minh m, theo cc hc gi, l t tin ca ngi Chm  nhng ngi sng lp vng quc Champa hng mnh!
</p>
<p>
    Ngi Sa Hunh l nhng bc thy thc s trong ngh ca h:
</p>
<ul>
    <li>B n mai tng: H ha tng ngi trng thnh v chn tro ct trong nhng chic bnh gm ln, c np y. V vng, cng vi tro ct, h t nhng kho bu  t cng c n  trang sc tinh xo. Hy tng tng nhng chic bnh ny cha ng bao nhiu cu chuyn!</li>
    <li>"Th rn" c i: Nhng ngi ny  thnh tho luyn kim, to ra cc cng c bng st v ng thanh trang nh: ru, kim, u gio, dao v lim. y khng phi l nhng cng c tm thng!</li>
    <li>Thng nhn ton cu: Qun "Con ng t la" i  Sa Hunh c "Tuyn ng thng mi Sa Hunh-Kalanay" ca ring mnh! H  giao dch vi ng ngha en l c th gii  t Trung Quc v n  n Philippines v thm ch c a Trung Hi! Cc ng tin Trung Quc v nhng mn  t m khc c tm thy  y chng minh rng Hi An l mt trung tm thng mi quc t hng ngn nm trc khi n tr thnh xu hng ch o.</li>
</ul>

<h6>Nhng g ang ch i bn bn trong bo tng:</h6>
<img src="27.jpg" alt="Bo tng Vn ha Sa Hunh"/>
<p>
    Bo tng Vn ha Sa Hunh khng phi l mt kho lu tr bi bm, m l mt kho bu thc s! Ni y lu gi khong 1000 hin vt c o c tm thy ngay ti Hi An v trn qun o Chm gn . Mi hin vt l mt mnh i c i s k cho bn nghe cu chuyn ca n.
</p>

<ul>
    <li>Bnh, bnh v nhiu bnh hn na: Tt nhin, bn s thy mt b su tp cc bnh mai tng   t nh n ln, vi nhiu hnh dng v kch c khc nhau. Hy th tng tng ai c th  c chn ct trong mi chic bnh !</li>
    <li>S rc r ca  trang sc c i: Hy sn sng  chim ngng! Nhng mn trang sc ng kinh ngc c lm t , ng, vng v thy tinh c trng by  y. Nhng im nhn ca chng trnh, tt nhin, l i khuyn tai hai u ni ting (lingling-o). y l nhng vt trang sc tai c o, thng m t nhng sinh vt hai u. Ch cn ngh xem nhng biu tng ny c  ngha g i vi ngi c i!</li>
    <li>Cng c v  dng: Bn s thy nhng g ngi Sa Hunh s dng hng ngy: t ru n lim, t ni n  gm tinh xo.</li>
    <li>m mnh vo lch s: Bo tng cung cp cc gii thch kho c chi tit, hnh nh t cc a im khai qut v thm ch c video ti liu s gip bn hnh dung cuc sng v nghi l ca nn vn minh b n ny.</li>
</ul>

<h6>Chi tit quan trng cho cuc phiu lu ca bn:</h6>
<ul>
    <li>a ch: 149 Trn Ph, Phng Minh An, Hi An, Qung Nam, Vit Nam. Nm ngay trung tm Ph c.</li>
    <li>Gi m ca: Thng t 08:00 n 20:00 hng ngy. NHNG! Xin lu : vo ngy 10 hng thng, bo tng ng ca  bo tr. Hy ln k hoch chuyn thm ca bn trc!</li>
    <li>V vo ca: Vic tham quan bo tng thng yu cu mt v vo ca chung vo Ph c Hi An. iu ny tin li v n cng cp quyn truy cp vo cc im tham quan khc.</li>
    <li>Bn thn ta nh: Bo tng c t trong mt ta nh truyn thng tuyt p vi nhng bc tng vng c trng, mi ngi  v cc yu t g, to ra mt bu khng kh hon ho  m mnh vo thi c i.</li>
</ul>
<p>
    ng b l c hi  chm vo nhng ngun gc ca Hi An v hiu c iu g  t nn mng cho s v i ca n! Bo tng Vn ha Sa Hunh khng ch l lch s;  l li m u cho cuc phiu lu ca bn  Hi An!
</p>
    `,internalImageNames:["27.jpg"]},slug:{en:"sa-huynh-cultural-museum",ru:"muzey-kultury-sa-huynh",es:"museo-cultural-sa-huynh",fr:"musee-culturel-sa-huynh",vn:"bao-tang-van-hoa-sa-huynh"}},{id:"duc-an-house",coordinates:[15.877072142790434,108.32731599830328],category:["museum"],imageUrl:"7.jpg",en:{title:"Duc An House",description:"This house holds significant pages of Vietnam's political history.",fullDescription:`
<p>
    If you're looking for a place where Hoi An's history comes alive, your path leads to Duc An House. This mansion is not just one of the ancient buildings; it's a living testament to the city's rich past, its commercial spirit, and even its heroic struggle for independence.
</p>
<p>
    Built in the mid-19th century (meaning it's over 200 years old!), Duc An House is still owned and managed by the sixth generation of the Bui family. Imagine, the same family preserving their roots and traditions within these walls for so many years! Originally, this house was a well-known trading center specializing in traditional Vietnamese medicine, selling medicinal herbs and spices. The Bui family were true experts in this field, passing down their knowledge from generation to generation.
</p>

<h6>From Herb Shop to Revolutionary Center: Secrets of Duc An House</h6>
<p>
    But the history of Duc An House goes much deeper than just trade and medicine. This house holds significant pages of Vietnam's political history. During the struggle for independence, it served as an underground branch of the revolutionary movement! Mr. Bui Kien Thanh, an ancestor of the current owners and a renowned intellectual, used this house as a refuge and a place for secret meetings of patriots. Many important documents and plans related to the revolution were discussed and stored right here. This is a place where history was literally made!
</p>
<p>
    Duc An House is a classic example of Hoi An's unique architectural style, demonstrating a fusion of cultures:
</p>
<img src="30.jpg" alt="Duc An House"/>
<ul>
    <li>The house is built in the traditional "tube house" style: a narrow facade, but a long, deep interior space.</li>
    <li>Durable and long-lasting ironwood was used, thanks to which the house has been preserved for centuries.</li>
    <li>The space is divided into zones: a shop at the entrance (where herbs were once sold, and now perhaps souvenirs), living quarters, ancestral worship areas, and an inner courtyard that provides natural light and ventilation, as well as serving to collect rainwater.</li>
    <li>Pay attention to the exquisite wood carvings that adorn the columns, beams, and furniture, reflecting both Vietnamese and Chinese influences.</li>
    <li>Inside, old wooden cabinets, tables, chairs, as well as books, documents, and other artifacts related to the family's history have been preserved.</li>
</ul>

<h6>Living History and National Heritage</h6>
<p>
    Duc An House is a true "living museum," allowing you to experience the atmosphere of past centuries and understand how Hoi An's merchants lived and worked. Its role in the revolutionary movement gives it special significance as a place where Vietnam's history was forged. Visiting this house is a unique opportunity not only to see ancient architecture but also to touch the rich history of a family that is inextricably linked with the history of all Hoi An.
</p>
    `,internalImageNames:["30.jpg"]},ru:{title:"  ",description:"       .",fullDescription:`
<p>
       ,    ,       .         ;      ,         .
</p>
<p>
       XIX  (    200 !),             . ,                 !       ,     ,     .        ,       .
</p>

<h6>      :    </h6>
<p>
           ,     .        .           !    ,      ,           .     ,  ,     .  ,    !
</p>
<p>
             ,   :
</p>
<img src="30.jpg" alt="  "/>
<ul>
    <li>     " ":  ,  ,   .</li>
    <li>     ,       .</li>
    <li>   :    ( -  ,  , , ),  ,      ,      ,       .</li>
    <li>      ,  ,   ,   ,    .</li>
    <li>    , , ,   ,    ,    .</li>
</ul>

<h6>    </h6>
<p>
          " ",       ,      .           ,    .           ,       ,       .
</p>
    `,internalImageNames:["30.jpg"]},es:{title:"Casa Duc An",description:"Esta casa contiene pginas significativas de la historia poltica de Vietnam.",fullDescription:`
<p>
    Si buscas un lugar donde la historia de Hoi An cobra vida, tu camino te lleva a la Casa Duc An. Esta mansin no es solo uno de los edificios antiguos; es un testimonio viviente del rico pasado de la ciudad, su espritu comercial e incluso su heroica lucha por la independencia.
</p>
<p>
    Construida a mediados del siglo XIX (lo que significa que tiene ms de 200 aos!), la Casa Duc An todava es propiedad y est gestionada por la sexta generacin de la familia Bui. Imagina, la misma familia preservando sus races y tradiciones dentro de estas paredes durante tantos aos! Originalmente, esta casa era un conocido centro comercial especializado en medicina tradicional vietnamita, vendiendo hierbas medicinales y especias. La familia Bui eran verdaderos expertos en este campo, transmitiendo sus conocimientos de generacin en generacin.
</p>

<h6>De herbolario a centro revolucionario: Secretos de la Casa Duc An</h6>
<p>
    Pero la historia de la Casa Duc An va mucho ms all del comercio y la medicina. Esta casa contiene pginas significativas de la historia poltica de Vietnam. Durante la lucha por la independencia, sirvi como una rama clandestina del movimiento revolucionario! El Sr. Bui Kien Thanh, un antepasado de los actuales propietarios y un intelectual de renombre, utiliz esta casa como refugio y lugar para reuniones secretas de patriotas. Muchos documentos y planes importantes relacionados con la revolucin se discutieron y almacenaron aqu mismo. Este es un lugar donde la historia se hizo literalmente!
</p>
<p>
    La Casa Duc An es un ejemplo clsico del estilo arquitectnico nico de Hoi An, demostrando una fusin de culturas:
</p>
<img src="30.jpg" alt="Casa Duc An"/>
<ul>
    <li>La casa est construida en el estilo tradicional de "casa tubo": una fachada estrecha, pero un espacio interior largo y profundo.</li>
    <li>Se utiliz madera de hierro duradera y de larga duracin, gracias a lo cual la casa se ha conservado durante siglos.</li>
    <li>El espacio se divide en zonas: una tienda en la entrada (donde antes se vendan hierbas, y ahora quizs recuerdos), salas de estar, reas de culto ancestral y un patio interior que proporciona luz natural y ventilacin, adems de servir para recoger agua de lluvia.</li>
    <li>Presta atencin a las exquisitas tallas de madera que adornan las columnas, vigas y muebles, que reflejan influencias tanto vietnamitas como chinas.</li>
    <li>En el interior, se han conservado antiguos armarios de madera, mesas, sillas, as como libros, documentos y otros artefactos relacionados con la historia de la familia.</li>
</ul>

<h6>Historia Viva y Patrimonio Nacional</h6>
<p>
    La Casa Duc An es un verdadero "museo viviente", que te permite experimentar la atmsfera de siglos pasados y comprender cmo vivan y trabajaban los comerciantes de Hoi An. Su papel en el movimiento revolucionario le otorga un significado especial como un lugar donde se forj la historia de Vietnam. Visitar esta casa es una oportunidad nica no solo para ver arquitectura antigua, sino tambin para tocar la rica historia de una familia que est inextricablemente ligada a la historia de todo Hoi An.
</p>
    `,internalImageNames:["30.jpg"]},fr:{title:"Maison Duc An",description:"Cette maison renferme des pages importantes de l'histoire politique du Vietnam.",fullDescription:`
<p>
    Si vous cherchez un endroit o l'histoire de Hoi An prend vie, votre chemin mne  la Maison Duc An. Cette demeure n'est pas seulement l'un des btiments anciens ; c'est un tmoignage vivant du riche pass de la ville, de son esprit commercial, et mme de sa lutte hroque pour l'indpendance.
</p>
<p>
    Construite au milieu du XIXe sicle (ce qui signifie qu'elle a plus de 200 ans !), la Maison Duc An est toujours possde et gre par la sixime gnration de la famille Bui. Imaginez, la mme famille prservant ses racines et ses traditions entre ces murs pendant tant d'annes !  l'origine, cette maison tait un centre commercial bien connu, spcialis dans la mdecine traditionnelle vietnamienne, vendant des herbes mdicinales et des pices. La famille Bui tait de vritables experts dans ce domaine, transmettant leurs connaissances de gnration en gnration.
</p>

<h6>Du magasin d'herbes mdicinales au centre rvolutionnaire : les secrets de la Maison Duc An</h6>
<p>
    Mais l'histoire de la Maison Duc An va bien plus loin que le simple commerce et la mdecine. Cette maison renferme des pages importantes de l'histoire politique du Vietnam. Pendant la lutte pour l'indpendance, elle a servi de branche clandestine du mouvement rvolutionnaire ! M. Bui Kien Thanh, un anctre des propritaires actuels et un intellectuel renomm, a utilis cette maison comme refuge et lieu de runions secrtes de patriotes. De nombreux documents et plans importants lis  la rvolution y ont t discuts et stocks. C'est un lieu o l'histoire s'est littralement faite !
</p>
<p>
    La Maison Duc An est un exemple classique du style architectural unique de Hoi An, dmontrant une fusion de cultures :
</p>
<img src="30.jpg" alt="Maison Duc An"/>
<ul>
    <li>La maison est construite dans le style traditionnel de la "maison tube" : une faade troite, mais un espace intrieur long et profond.</li>
    <li>Du bois de fer durable et rsistant a t utilis, grce auquel la maison a t prserve pendant des sicles.</li>
    <li>L'espace est divis en zones : une boutique  l'entre (o des herbes taient autrefois vendues, et maintenant peut-tre des souvenirs), des quartiers d'habitation, des zones de culte ancestral et une cour intrieure qui fournit une lumire naturelle et une ventilation, ainsi que servant  recueillir l'eau de pluie.</li>
    <li>Faites attention aux exquises sculptures sur bois qui ornent les colonnes, les poutres et les meubles, refltant les influences vietnamiennes et chinoises.</li>
    <li> l'intrieur, de vieux placards en bois, des tables, des chaises, ainsi que des livres, des documents et d'autres artefacts lis  l'histoire de la famille ont t conservs.</li>
</ul>

<h6>Histoire vivante et patrimoine national</h6>
<p>
    La Maison Duc An est un vritable "muse vivant", vous permettant de dcouvrir l'atmosphre des sicles passs et de comprendre comment les marchands de Hoi An vivaient et travaillaient. Son rle dans le mouvement rvolutionnaire lui confre une signification particulire en tant que lieu o l'histoire du Vietnam a t forge. Visiter cette maison est une occasion unique non seulement de voir l'architecture ancienne, mais aussi de toucher  la riche histoire d'une famille inextricablement lie  l'histoire de tout Hoi An.
</p>
    `,internalImageNames:["30.jpg"]},vn:{title:"Nh c An",description:"Ngi nh ny lu gi nhng trang s quan trng ca lch s chnh tr Vit Nam.",fullDescription:`
<p>
    Nu bn ang tm kim mt ni m lch s Hi An sng dy, con ng ca bn dn n Nh c An. Ngi nh ny khng ch l mt trong nhng cng trnh c knh;  l mt minh chng sng ng cho qu kh phong ph ca thnh ph, tinh thn thng mi ca n, v thm ch l cuc u tranh anh dng v c lp.
</p>
<p>
    c xy dng vo gia th k 19 (ngha l  hn 200 tui!), Nh c An vn thuc s hu v c qun l bi th h th su ca gia nh Bi. Hy tng tng, cng mt gia nh gn gi ci r v truyn thng ca h trong nhng bc tng ny sut bao nm qua! Ban u, ngi nh ny l mt trung tm thng mi ni ting chuyn v y hc c truyn Vit Nam, bn cc loi tho mc v gia v thuc. Gia nh Bi l nhng chuyn gia thc s trong lnh vc ny, truyn li kin thc ca h t th h ny sang th h khc.
</p>

<h6>T tim thuc bc n trung tm cch mng: B mt ca Nh c An</h6>
<p>
    Nhng lch s ca Nh c An cn su sc hn nhiu so vi thng mi v y hc. Ngi nh ny lu gi nhng trang s quan trng ca lch s chnh tr Vit Nam. Trong cuc u tranh ginh c lp, n tng l mt chi nhnh ngm ca phong tro cch mng! ng Bi Kin Thanh, mt t tin ca nhng ngi ch hin ti v l mt tr thc ni ting,  s dng ngi nh ny lm ni tr n v ni hp b mt ca nhng ngi yu nc. Nhiu ti liu v k hoch quan trng lin quan n cch mng  c tho lun v lu tr ngay ti y. y l mt ni m lch s  thc s c to ra!
</p>
<p>
    Nh c An l mt v d in hnh v phong cch kin trc c o ca Hi An, th hin s pha trn vn ha:
</p>
<img src="30.jpg" alt="Nh c An"/>
<ul>
    <li>Ngi nh c xy dng theo kiu "nh ng" truyn thng: mt tin hp, nhng khng gian ni tht di v su.</li>
    <li>G lim bn v lu nm  c s dng, nh  ngi nh  c bo tn qua nhiu th k.</li>
    <li>Khng gian c chia thnh cc khu vc: mt ca hng  li vo (ni tng bn tho mc, v by gi c l l  lu nim), khu sinh hot, khu th cng t tin, v mt sn trong cung cp nh sng t nhin v thng gi, cng nh dng  thu thp nc ma.</li>
    <li>Hy ch  n nhng chm khc g tinh xo trang tr cc ct, x v  ni tht, phn nh c nh hng ca Vit Nam v Trung Quc.</li>
    <li>Bn trong, cc t g c, bn, gh, cng nh sch, ti liu v cc hin vt khc lin quan n lch s gia nh  c bo tn.</li>
</ul>

<h6>Lch s sng ng v Di sn Quc gia</h6>
<p>
    Nh c An l mt "bo tng sng" thc s, cho php bn tri nghim bu khng kh ca cc th k  qua v hiu cch cc thng nhn Hi An  sng v lm vic. Vai tr ca n trong phong tro cch mng mang li cho n  ngha c bit nh mt ni m lch s Vit Nam  c nh hnh. Tham quan ngi nh ny l mt c hi duy nht khng ch  xem kin trc c knh m cn  chm vo lch s phong ph ca mt gia nh gn b mt thit vi lch s ca ton Hi An.
</p>
    `,internalImageNames:["30.jpg"]},slug:{en:"duc-an-house",ru:"dom-duk-an",es:"casa-duc-an",fr:"maison-duc-an",vn:"nha-co-duc-an"}},{id:"kazimierz-kwiatkowski-monument",coordinates:[15.877200258792449,108.32779555779305],category:["museum"],imageUrl:"8.jpg",en:{title:"Kazimierz Kwiatkowski Monument",description:"Knight of cultural heritage. A Polish Superhero who saved Hoi An from concrete and boredom!",fullDescription:`
<p>
    Have you ever wondered why old Hoi An is still so authentic, and its ancient houses haven't turned into faceless new buildings? The answer is simple: it's all thanks to one person  Kazimierz Kwiatkowski (1944-1997), a Polish architect and restorer, affectionately known in Vietnam as Kazik the Architect. He dedicated his life to saving Vietnam's cultural heritage, and his motto was: "I don't restore stones  I restore people's memories."
</p>
<p>
    Kazik came to Vietnam as a volunteer in 1980 and worked here for 17 years. 16 of those he dedicated to My Son sanctuary, and from 1981, he became closely involved with ancient Hoi An. At that time, after 40 years of war, the monuments were severely damaged, and Vietnam desperately needed help. Kazik led the first Polish-Vietnamese mission in Asia to restore monuments. He was the only expert who undertook this colossal task.
</p>

<h6>"They Call Me Crazy..."  Kazik's Rebellious Spirit</h6>
<img src="31.jpg" alt="Kazimierz Kwiatkowski"/>
<p>
    Kazimierz Kwiatkowski was not one to compromise. When it came to preserving authenticity, he became a force of nature!
</p>
<ul>
    <li>War with cement: Vietnamese officials, wanting to "quickly restore" old houses, brought in cement. Kazik insisted on authentic methods: a mixture of lime, sugarcane, and clay, as it was built in the 18th century. They say he once even locked a batch of cement in a shed and set a few bags on fire to show his determination! "Do you want the whole city to crumble like this in 10 years?" he would shout at meetings, shaking a rotten beam.</li>
    <li>Battle with developers: In the 90s, when the tourist boom began, businessmen were eager to build hotels in the old quarter. Kazik personally blocked construction sites, and, according to his student, even lay down in front of bulldozers! He was willing to do anything to protect Hoi An.</li>
    <li>"Revolt" against UNESCO: In 1993, UNESCO experts proposed prohibiting residents from living in historical houses, turning the city into a "museum exhibit." Kazik invited them to dinner in a 300-year-old house, fed them soup, and declared: "Either you let people live, or Hoi An will become a dead museum, like your Venice!" UNESCO surrendered.</li>
</ul>

<h6>Incredible Stories and "Kazik's Curse"</h6>
<p>
    Many legends circulate around Kazik, and even if some of them are embellished, they only emphasize his uniqueness:
</p>
<ul>
    <li>War with neon signs: When the first shop hung a neon sign on an ancient facade, Kazik would secretly tear down the signs at night, and once personally painted over a neon sign with black paint in front of witnesses! His famous phrase, still quoted by guides today: "If I see another 'I  Hoi An' shop in the old quarter  I'll shoot it with a slingshot!"</li>
    <li>Cursed bridge: When a concrete foundation was secretly poured under the Japanese Bridge, Kazik personally smashed it with a sledgehammer at 5 AM for everyone to hear. He found an old master who remembered how the bridge was built 60 years ago and made the workers carry stones by hand. The bridge still stands!</li>
    <li>"Chicken rebellion": In 1996, UNESCO wanted to ban residents from keeping chickens in the old quarter. Kazik, in response, personally distributed chicks to 50 families and taught them how to build "historically accurate" chicken coops. "If you remove the chickens  the spirit of Hoi An will disappear," he said, and UNESCO again yielded.</li>
    <li>Last gift: Before his death, he "discovered" an ancient stele (actually a fake) under an 18th-century fish market that was being demolished. The market was immediately listed as a protected site. The deception was uncovered 10 years later, but it was too late  the building had already been restored.</li>
</ul>

<h6>A Legacy That Lives On</h6>
<img src="32.jpg" alt="Kazimierz Kwiatkowski"/>
<p>
    Kazimierz Kwiatkowski tragically died of a heart attack in Hue in 1997, while working on the restoration of the royal palace. He was buried in Poland, but a monument to him has been erected in Hoi An in a park named after him  a rare honor for a foreigner in Vietnam.
</p>
<p>
    Thanks to his tireless efforts, Hoi An and My Son were recognized as UNESCO World Heritage sites. He taught the Vietnamese to restore while preserving authenticity, and his students continue his work to this day. Even if some stories about him have become legends, they only emphasize how much he inspired people to protect heritage. Kazik is not just a historian; he is the spirit of Hoi An, living in every preserved house, in every carved beam, and in every story about the "crazy Pole" who saved the city.
</p>
    `,internalImageNames:["32.jpg","31.jpg"]},ru:{title:"  ",description:"  .  ,      !",fullDescription:`
<p>
     - ,        ,         ?  :        (1944-1997),    ,      -.        ,    :         .
</p>
<p>
          1980     17 . 16      ,   1981     .   ,  40  ,    ,      .    -      .    ,      .
</p>

<h6>      </h6>
<img src="31.jpg" alt=" "/>
<p>
         .      ,   !
</p>
<ul>
    <li>  :  ,     ,  .     :  ,    ,    XVIII . ,             ,    !  ,       10 ?!     ,   .</li>
    <li>  :  90- ,    ,       .    , ,    ,    !     ,   .</li>
    <li>  :  1993          ,     .       300- ,    :     ,     ,   !  .</li>
</ul>

<h6>    </h6>
<p>
        ,       ,     :
</p>
<ul>
    <li>   :         ,     ,          !   ,      :       I  Hoi An         !</li>
    <li> :        ,   5         .    ,  ,    60  ,      .     !</li>
    <li> :  1996          .       50        .       ,   ,    .</li>
    <li> :       (   )     XVIII .         .    10 ,         .</li>
</ul>

<h6>,  </h6>
<img src="32.jpg" alt=" "/>
<p>
              1997 ,     .     ,        ,           .
</p>
<p>
       ,         .    ,  ,         .        ,   ,       .      ;   ,     ,           ,   .
</p>
    `,internalImageNames:["32.jpg","31.jpg"]},es:{title:"Monumento a Kazimierz Kwiatkowski",description:"Caballero del patrimonio cultural. Un superhroe polaco que salv a Hoi An del hormign y el aburrimiento!",fullDescription:`
<p>
    Alguna vez te has preguntado por qu el antiguo Hoi An sigue siendo tan autntico y sus casas antiguas no se han convertido en edificios nuevos sin rostro? La respuesta es simple: todo gracias a una persona, Kazimierz Kwiatkowski (1944-1997), un arquitecto y restaurador polaco, conocido cariosamente en Vietnam como Kazik el Arquitecto. Dedic su vida a salvar el patrimonio cultural de Vietnam, y su lema era: "No restauro piedras, restauro recuerdos de la gente".
</p>
<p>
    Kazik lleg a Vietnam como voluntario en 1980 y trabaj aqu durante 17 aos. 16 de ellos los dedic al santuario de My Son, y desde 1981, se involucr estrechamente con el antiguo Hoi An. En ese momento, despus de 40 aos de guerra, los monumentos estaban gravemente daados, y Vietnam necesitaba desesperadamente ayuda. Kazik dirigi la primera misin polaco-vietnamita en Asia para restaurar monumentos. Fue el nico experto que emprendi esta tarea colosal.
</p>

<h6>"Me llaman loco..."  El espritu rebelde de Kazik</h6>
<img src="31.jpg" alt="Kazimierz Kwiatkowski"/>
<p>
    Kazimierz Kwiatkowski no era de los que se comprometan. Cuando se trataba de preservar la autenticidad, se converta en una fuerza de la naturaleza!
</p>
<ul>
    <li>Guerra con el cemento: Los funcionarios vietnamitas, queriendo "restaurar rpidamente" las casas antiguas, trajeron cemento. Kazik insisti en mtodos autnticos: una mezcla de cal, caa de azcar y arcilla, tal como se construy en el siglo XVIII. Dicen que una vez incluso encerr un lote de cemento en un cobertizo y quem algunas bolsas para mostrar su determinacin! "Quieres que toda la ciudad se desmorone as en 10 aos?", gritaba en las reuniones, agitando una viga podrida.</li>
    <li>Batalla con los promotores: En los aos 90, cuando comenz el auge turstico, los empresarios estaban ansiosos por construir hoteles en el barrio antiguo. Kazik bloque personalmente los sitios de construccin y, segn su alumno, incluso se tumb delante de las excavadoras! Estaba dispuesto a hacer cualquier cosa para proteger Hoi An.</li>
    <li>"Revuelta" contra la UNESCO: En 1993, los expertos de la UNESCO propusieron prohibir a los residentes vivir en casas histricas, convirtiendo la ciudad en una "exposicin de museo". Kazik los invit a cenar a una casa de 300 aos, les dio sopa y declar: "O dejan que la gente viva, o Hoi An se convertir en un museo muerto, como su Venecia!" La UNESCO se rindi.</li>
</ul>

<h6>Historias increbles y "La maldicin de Kazik"</h6>
<p>
    Muchas leyendas circulan alrededor de Kazik, y aunque algunas de ellas estn adornadas, solo enfatizan su singularidad:
</p>
<ul>
    <li>Guerra con los letreros de nen: Cuando la primera tienda colg un letrero de nen en una fachada antigua, Kazik secretamente arrancaba los letreros por la noche, y una vez personalmente pint un letrero de nen con pintura negra frente a testigos! Su famosa frase, todava citada por los guas hoy: "Si veo otra tienda 'I  Hoi An' en el barrio antiguo, la derribar con una honda!"</li>
    <li>Puente maldito: Cuando se verti una base de hormign en secreto debajo del Puente Japons, Kazik personalmente lo destroz con un mazo a las 5 AM para que todos lo oyeran. Encontr a un viejo maestro que recordaba cmo se construy el puente hace 60 aos e hizo que los trabajadores llevaran las piedras a mano. El puente sigue en pie!</li>
    <li>"Rebelin del pollo": En 1996, la UNESCO quiso prohibir a los residentes tener gallinas en el barrio antiguo. Kazik, en respuesta, distribuy personalmente pollitos a 50 familias y les ense cmo construir gallineros "histricamente correctos". "Si quitan los pollos, el espritu de Hoi An desaparecer", dijo, y la UNESCO volvi a ceder.</li>
    <li>ltimo regalo: Antes de su muerte, "descubri" una estela antigua (en realidad, una falsificacin) debajo de un mercado de pescado del siglo XVIII que estaba siendo demolido. El mercado fue inmediatamente catalogado como sitio protegido. El engao fue descubierto 10 aos despus, pero ya era demasiado tarde: el edificio ya haba sido restaurado.</li>
</ul>

<h6>Un legado que perdura</h6>
<img src="32.jpg" alt="Kazimierz Kwiatkowski"/>
<p>
    Kazimierz Kwiatkowski muri trgicamente de un ataque al corazn en Hue en 1997, mientras trabajaba en la restauracin del palacio real. Fue enterrado en Polonia, pero se le ha erigido un monumento en Hoi An en un parque que lleva su nombre, un honor poco comn para un extranjero en Vietnam.
</p>
<p>
    Gracias a sus incansables esfuerzos, Hoi An y My Son fueron reconocidos como sitios del Patrimonio Mundial de la UNESCO. Ense a los vietnamitas a restaurar preservando la autenticidad, y sus alumnos continan su trabajo hasta el da de hoy. Incluso si algunas historias sobre l se han convertido en leyendas, solo enfatizan cunto inspir a la gente a proteger el patrimonio. Kazik no es solo un historiador; es el espritu de Hoi An, que vive en cada casa conservada, en cada viga tallada y en cada historia sobre el "polaco loco" que salv la ciudad.
</p>
    `,internalImageNames:["32.jpg","31.jpg"]},fr:{title:"Monument Kazimierz Kwiatkowski",description:"Chevalier du patrimoine culturel. Un super-hros polonais qui a sauv Hoi An du bton et de l'ennui !",fullDescription:`
<p>
    Vous tes-vous dj demand pourquoi le vieux Hoi An est toujours aussi authentique, et ses maisons anciennes ne se sont pas transformes en nouveaux btiments sans visage ? La rponse est simple : c'est grce  une seule personne  Kazimierz Kwiatkowski (1944-1997), un architecte et restaurateur polonais, affectueusement connu au Vietnam sous le nom de Kazik l'Architecte. Il a ddi sa vie  sauver le patrimoine culturel du Vietnam, et sa devise tait :  Je ne restaure pas des pierres  je restaure la mmoire des gens. 
</p>
<p>
    Kazik est venu au Vietnam en tant que volontaire en 1980 et y a travaill pendant 17 ans. 16 de ces annes, il les a consacres au sanctuaire de My Son, et  partir de 1981, il s'est troitement impliqu dans l'ancien Hoi An.  cette poque, aprs 40 ans de guerre, les monuments taient gravement endommags, et le Vietnam avait dsesprment besoin d'aide. Kazik a dirig la premire mission polono-vietnamienne en Asie pour restaurer les monuments. Il tait le seul expert  entreprendre cette tche colossale.
</p>

<h6> Ils m'appellent fou...   L'esprit rebelle de Kazik</h6>
<img src="31.jpg" alt="Kazimierz Kwiatkowski"/>
<p>
    Kazimierz Kwiatkowski n'tait pas du genre  faire des compromis. Quand il s'agissait de prserver l'authenticit, il devenait une force de la nature !
</p>
<ul>
    <li>Guerre avec le ciment : Les fonctionnaires vietnamiens, dsireux de  restaurer rapidement  les vieilles maisons, ont fait venir du ciment. Kazik a insist sur les mthodes authentiques : un mlange de chaux, de canne  sucre et d'argile, tel qu'il a t construit au XVIIIe sicle. On raconte qu'il a mme un jour enferm un lot de ciment dans un hangar et mis le feu  quelques sacs pour montrer sa dtermination !  Voulez-vous que toute la ville s'effondre comme a dans 10 ans ?  criait-il lors des runions, en secouant une poutre pourrie.</li>
    <li>Bataille avec les promoteurs : Dans les annes 90, lorsque le boom touristique a commenc, les hommes d'affaires taient impatients de construire des htels dans le vieux quartier. Kazik a personnellement bloqu les chantiers, et, selon son lve, s'est mme allong devant les bulldozers ! Il tait prt  tout pour protger Hoi An.</li>
    <li> Rvolte  contre l'UNESCO : En 1993, les experts de l'UNESCO ont propos d'interdire aux habitants de vivre dans des maisons historiques, transformant la ville en une  exposition de muse . Kazik les a invits  dner dans une maison vieille de 300 ans, leur a servi de la soupe et a dclar :  Soit vous laissez les gens vivre, soit Hoi An deviendra un muse mort, comme votre Venise !  L'UNESCO s'est rendue.</li>
</ul>

<h6>Histoires incroyables et  la maldiction de Kazik </h6>
<p>
    De nombreuses lgendes circulent autour de Kazik, et mme si certaines d'entre elles sont embellies, elles ne font que souligner son caractre unique :
</p>
<ul>
    <li>Guerre des enseignes au non : Lorsque le premier magasin a accroch une enseigne au non sur une faade ancienne, Kazik arrachait secrtement les enseignes la nuit, et a mme personnellement peint une enseigne au non en noir devant des tmoins ! Sa phrase clbre, encore cite par les guides aujourd'hui :  Si je vois un autre magasin 'I  Hoi An' dans le vieux quartier, je lui tirerai dessus avec une fronde ! </li>
    <li>Pont maudit : Lorsqu'une fondation en bton a t secrtement coule sous le Pont Japonais, Kazik l'a personnellement brise avec une masse  5 heures du matin pour que tout le monde entende. Il a trouv un vieux matre qui se souvenait comment le pont avait t construit il y a 60 ans et a fait porter les pierres  la main aux ouvriers. Le pont tient toujours !</li>
    <li> Rbellion des poulets  : En 1996, l'UNESCO a voulu interdire aux habitants d'lever des poulets dans le vieux quartier. Kazik, en rponse, a personnellement distribu des poussins  50 familles et leur a appris  construire des poulaillers  historiquement exacts .  Si vous enlevez les poulets, l'esprit de Hoi An disparatra , a-t-il dit, et l'UNESCO a de nouveau cd.</li>
    <li>Dernier cadeau : Avant sa mort, il a  dcouvert  une ancienne stle (en fait une contrefaon) sous un march aux poissons du XVIIIe sicle qui tait en cours de dmolition. Le march a t immdiatement class comme site protg. La tromperie a t dcouverte 10 ans plus tard, mais il tait trop tard  le btiment avait dj t restaur.</li>
</ul>

<h6>Un hritage qui perdure</h6>
<img src="32.jpg" alt="Kazimierz Kwiatkowski"/>
<p>
    Kazimierz Kwiatkowski est dcd tragiquement d'une crise cardiaque  Hue en 1997, alors qu'il travaillait  la restauration du palais royal. Il a t enterr en Pologne, mais un monument lui a t rig  Hoi An dans un parc qui porte son nom  un honneur rare pour un tranger au Vietnam.
</p>
<p>
    Grce  ses efforts inlassables, Hoi An et My Son ont t reconnus comme sites du patrimoine mondial de l'UNESCO. Il a enseign aux Vietnamiens  restaurer tout en prservant l'authenticit, et ses tudiants continuent son travail  ce jour. Mme si certaines histoires  son sujet sont devenues des lgendes, elles ne font que souligner  quel point il a inspir les gens  protger le patrimoine. Kazik n'est pas seulement un historien ; il est l'esprit de Hoi An, vivant dans chaque maison prserve, dans chaque poutre sculpte, et dans chaque histoire sur le  Polonais fou  qui a sauv la ville.
</p>
    `,internalImageNames:["32.jpg","31.jpg"]},vn:{title:"Tng i Kazimierz Kwiatkowski",description:"Hip s di sn vn ha. Mt siu anh hng Ba Lan  cu Hi An khi b tng v s nhm chn!",fullDescription:`
<p>
    Bn c bao gi t hi ti sao Hi An c knh vn gi c nt chn thc, v nhng ngi nh c ca n khng bin thnh nhng ta nh mi v hn? Cu tr li rt n gin: tt c l nh mt ngi  Kazimierz Kwiatkowski (1944-1997), mt kin trc s v nh phc ch ngi Ba Lan, c ngi Vit Nam tru mn gi l kin trc s Kazik. ng  cng hin c cuc i mnh  cu ly di sn vn ha Vit Nam, v phng chm ca ng l: "Ti khng phc ch   ti phc ch k c ca con ngi."
</p>
<p>
    Kazik n Vit Nam vi t cch tnh nguyn vin vo nm 1980 v lm vic  y trong 17 nm. 16 nm trong s  ng dnh cho thnh a M Sn, v t nm 1981, ng bt u gn b cht ch vi Hi An c knh. Vo thi im , sau 40 nm chin tranh, cc di tch b h hi nng n, v Vit Nam ang rt cn s gip . Kazik  dn u phi on Ba Lan-Vit Nam u tin  chu   phc ch di tch. ng l chuyn gia duy nht  m nhn nhim v khng l ny.
</p>

<h6>"H gi ti l k in..."  Tinh thn ni lon ca Kazik</h6>
<img src="31.jpg" alt="Kazimierz Kwiatkowski"/>
<p>
    Kazimierz Kwiatkowski khng phi l ngi d tha hip. Khi ni n vic bo tn tnh chn thc, ng tr thnh mt th lc ca t nhin!
</p>
<ul>
    <li>Cuc chin vi xi mng: Cc quan chc Vit Nam, mun "phc ch nhanh chng" nhng ngi nh c,  mang xi mng n. Kazik nhn mnh vo cc phng php chn thc: hn hp vi, ma v t st, nh cch n c xy dng vo th k 18. Ngi ta ni rng ng thm ch  tng kha mt l xi mng trong nh kho v t mt vi bao  th hin quyt tm ca mnh! "ng c mun c thnh ph ny sp  nh th ny trong 10 nm na khng?" ng s ht ln trong cc cuc hp, lc mt cy x mc nt.</li>
    <li>Trn chin vi cc nh pht trin: Vo nhng nm 90, khi s bng n du lch bt u, cc doanh nhn rt ho hc xy dng khch sn trong khu ph c. Kazik  ch thn chn cc cng trng xy dng, v, theo li hc tr ca ng, thm ch cn nm trc xe i! ng sn sng lm bt c iu g  bo v Hi An.</li>
    <li>"Cuc ni lon" chng li UNESCO: Nm 1993, cc chuyn gia UNESCO  xut cm ngi dn sng trong cc ngi nh lch s, bin thnh ph thnh mt "hin vt bo tng". Kazik  mi h n ti trong mt ngi nh 300 tui, cho h n sp, v tuyn b: "Hoc l cc ng  ngi dn sng, hoc Hi An s tr thnh mt bo tng cht, ging nh Venice ca cc ng!" UNESCO  nhng b.</li>
</ul>

<h6>Nhng cu chuyn ng kinh ngc v "Li nguyn ca Kazik"</h6>
<p>
    Nhiu truyn thuyt lu truyn v Kazik, v ngay c khi mt s trong s  c t im, chng ch nhn mnh s c o ca ng:
</p>
<ul>
    <li>Cuc chin vi bin hiu neon: Khi ca hng u tin treo bin hiu neon trn mt tin c knh, Kazik s b mt x b cc bin hiu vo ban m, v mt ln ch thn sn en bin hiu neon trc s chng kin ca mi ngi! Cu ni ni ting ca ng, vn c cc hng dn vin trch dn ngy nay: "Nu ti thy mt ca hng 'I  Hoi An' khc trong khu ph c  ti s bn n bng n!"</li>
    <li>Cy cu b nguyn ra: Khi mt nn b tng c  b mt di Cu Nht Bn, Kazik  ch thn p v n bng ba t vo lc 5 gi sng  mi ngi cng nghe. ng tm thy mt ngi th gi nh cch cy cu c xy dng 60 nm trc v yu cu cng nhn mang  bng tay. Cy cu vn ng vng!</li>
    <li>"Ni lon g": Nm 1996, UNESCO mun cm ngi dn nui g trong khu ph c. p li, Kazik  ch thn phn pht g con cho 50 gia nh v dy h cch xy chung g "chun lch s". "Nu bn b g i  linh hn ca Hi An s bin mt," ng ni, v UNESCO li nhng b.</li>
    <li>Mn qu cui cng: Trc khi qua i, ng  "pht hin" mt bia  c (thc ra l  gi) di mt ch c th k 18 ang b ph hy. Ch ngay lp tc c lit k l mt di tch c bo v. S la di c pht hin 10 nm sau, nhng  qu mun  ta nh  c phc ch.</li>
</ul>

<h6>Di sn vn sng mi</h6>
<img src="32.jpg" alt="Kazimierz Kwiatkowski"/>
<p>
    Kazimierz Kwiatkowski qua i bi thm v mt cn au tim  Hu vo nm 1997, khi ang lm vic phc ch cung in hong gia. ng c chn ct  Ba Lan, nhng mt tng i  c dng ln cho ng  Hi An trong mt cng vin mang tn ng  mt vinh d him c i vi mt ngi nc ngoi  Vit Nam.
</p>
<p>
    Nh nhng n lc khng mt mi ca ng, Hi An v M Sn  c cng nhn l Di sn Th gii ca UNESCO. ng  dy ngi Vit Nam cch phc ch trong khi vn gi c tnh chn thc, v hc tr ca ng vn tip tc cng vic ca ng cho n ngy nay. Ngay c khi mt s cu chuyn v ng  tr thnh truyn thuyt, chng ch nhn mnh mc  ng  truyn cm hng cho mi ngi  bo v di sn. Kazik khng ch l mt nh s hc; ng l linh hn ca Hi An, sng trong mi ngi nh c bo tn, trong mi cy x c chm khc, v trong mi cu chuyn v "ngi Ba Lan in"  cu thnh ph.
</p>
    `,internalImageNames:["32.jpg","31.jpg"]},slug:{en:"kazimierz-kwiatkowski-monument",ru:"pamyatnik-kazimiru-kvatkovskomu",es:"monumento-kazimierz-kwiatkowski",fr:"monument-kazimierz-kwiatkowski",vn:"tuong-dai-kazimierz-kwiatkowski"}},{id:"tan-ky-old-house",coordinates:[15.876488698855377,108.3277670451886],category:["museum"],imageUrl:"9.jpg",en:{title:"Tan Ky Old House",description:"Tan Ky Old House is one of the brightest examples of traditional Hoi An architecture.",fullDescription:`
<p>
    Imagine strolling through the ancient streets of Hoi An, where every house tells its own story. But among them, there is one special one  the <strong>Tan Ky Old House</strong>. It's not just an ancient mansion; it's a living history book, full of surprises, where people once lived, traded, and even hid from pirates!
</p>
<img src="33.jpg" alt="Tan Ky Old House"/>
<p>
    Built more than 200 years ago (in the late 18th - early 19th century) by a successful family of local merchants, Tan Ky Old House is one of the brightest examples of traditional Hoi An architecture. It is still owned and managed by the descendants of that very family, now in its seventh generation! This means you won't see a museum exhibit, but a real, living house where ancestral traditions are carefully preserved.
</p>

<h6>Architectural Secrets and Protection from the Elements</h6>
<p>
    Tan Ky Old House is not only beautiful but also features ingenious engineering solutions designed for life in Hoi An, which often suffers from floods:
</p>
<ul>
    <li><strong>"Tube house" design:</strong> Like many trading houses in Hoi An, Tan Ky has a narrow facade but extends far inwards, creating a long, multifunctional space. Here you'll find a trading area, inner courtyards, living quarters, and an area for ancestral worship.</li>
    <li><strong>Flood protection:</strong> Hoi An is located by a river, and floods are common here. But the Tan Ky merchants were prepared for this! The house has special mechanisms for quickly lifting all furniture and valuables to the second floor. Imagine how, during heavy rain, furniture would "fly" upwards, escaping the water!</li>
    <li><strong>Centuries-old floors:</strong> The floors in the house are made of amazing hard "jackfruit" wood, which is said to not rot for up to 300 years! This is another testament to the wisdom and durability of the materials used in those times.</li>
    <li><strong>Art on wood:</strong> Be sure to pay attention to the original carved panels that adorn the interior. They are made in a traditional style and often depict scenes from Chinese mythology, symbols of good luck and prosperity. Each carved element is a work of art and part of ancient beliefs.</li>
</ul>

<h6>Mysteries of the Past and Amazing Finds</h6>
<img src="34.jpg" alt="Tan Ky Old House"/>
<p>
    Tan Ky Old House is full of secrets that give it a special charm:
</p>
<ul>
    <li><strong>Secret room:</strong> It is said that behind the wardrobe in the bedroom there is a door to a tiny secret room. This is where merchants hid their wealth and gold from pirates who might attack the city! Can you find it?</li>
    <li><strong>Cultural mix:</strong> The architecture and decor of the house harmoniously intertwine Vietnamese, Chinese, and Japanese influences, reflecting Hoi An's history as a major international trading port.</li>
    <li><strong>Ancient artifacts:</strong> Inside, you will see not only unique furniture and wooden structures, but also many ancient household items, documents, and works of art that tell about the life and activities of the Tan Ky merchant family.</li>
</ul>
<p>
    Visiting Tan Ky Old House is an opportunity not just to see an ancient building, but to literally touch the living history of mercantile Hoi An. This is a place where every tree and every stone holds its own legends.
</p>

    `,internalImageNames:["33.jpg","34.jpg"]},ru:{title:"   ",description:"            .",fullDescription:`
<p>
    ,       ,      .        <strong>   </strong>.     ;    ,  ,  -  ,      !
</p>
<img src="33.jpg" alt="   "/>
<p>
      200   (  XVIII -  XIX )    ,             .           ,   !  ,      ,  ,  ,     .
</p>

<h6>     </h6>
<p>
          ,      ,     ,     :
</p>
<ul>
    <li><strong>  :</strong>      ,     ,    ,  ,  .     ,  ,       .</li>
    <li><strong>  :</strong>    ,      .        !               . ,        ,   !</li>
    <li><strong> :</strong>         , ,  ,    300 !        ,    .</li>
    <li><strong>  :</strong>       ,  .            ,    .           .</li>
</ul>

<h6>    </h6>
<img src="34.jpg" alt="   "/>
<p>
         ,     :
</p>
<ul>
    <li><strong> :</strong> ,           .          ,     !     ?</li>
    <li><strong> :</strong>        ,    ,         .</li>
    <li><strong> :</strong>          ,      ,    ,          .</li>
</ul>
<p>
                ,         .  ,         .
</p>

    `,internalImageNames:["33.jpg","34.jpg"]},es:{title:"Casa Antigua Tan Ky",description:"La Casa Antigua Tan Ky es uno de los ejemplos ms brillantes de la arquitectura tradicional de Hoi An.",fullDescription:`
<p>
    Imagina pasear por las antiguas calles de Hoi An, donde cada casa cuenta su propia historia. Pero entre ellas, hay una muy especial: la <strong>Casa Antigua Tan Ky</strong>. No es solo una antigua mansin; es un libro de historia viviente, lleno de sorpresas, donde la gente vivi, comerciaba e incluso se esconda de los piratas!
</p>
<img src="33.jpg" alt="Casa Antigua Tan Ky"/>
<p>
    Construida hace ms de 200 aos (a finales del siglo XVIII - principios del XIX) por una exitosa familia de comerciantes locales, la Casa Antigua Tan Ky es uno de los ejemplos ms brillantes de la arquitectura tradicional de Hoi An. Todava es propiedad y est gestionada por los descendientes de esa misma familia, ahora en su sptima generacin! Esto significa que no vers una exhibicin de museo, sino una casa real y viva donde las tradiciones ancestrales se conservan cuidadosamente.
</p>

<h6>Secretos Arquitectnicos y Proteccin contra los Elementos</h6>
<p>
    La Casa Antigua Tan Ky no solo es hermosa, sino que tambin presenta ingeniosas soluciones de ingeniera diseadas para la vida en Hoi An, que a menudo sufre de inundaciones:
</p>
<ul>
    <li><strong>Diseo de "casa tubo":</strong> Al igual que muchas casas comerciales en Hoi An, Tan Ky tiene una fachada estrecha pero se extiende mucho hacia el interior, creando un espacio largo y multifuncional. Aqu encontrars un rea comercial, patios interiores, viviendas y un rea para el culto ancestral.</li>
    <li><strong>Proteccin contra inundaciones:</strong> Hoi An est ubicada junto a un ro, y las inundaciones son comunes aqu. Pero los comerciantes de Tan Ky estaban preparados para esto! La casa tiene mecanismos especiales para elevar rpidamente todos los muebles y objetos de valor al segundo piso. Imagina cmo, durante una lluvia intensa, los muebles "volaran" hacia arriba, escapando del agua!</li>
    <li><strong>Pisos centenarios:</strong> Los pisos de la casa estn hechos de una asombrosa madera dura de "rbol de jaca", de la que se dice que no se pudre hasta por 300 aos. Este es otro testimonio de la sabidura y la durabilidad de los materiales utilizados en aquellos tiempos.</li>
    <li><strong>Arte en madera:</strong> Asegrate de prestar atencin a los paneles tallados originales que adornan el interior. Estn hechos en un estilo tradicional y a menudo representan escenas de la mitologa china, smbolos de buena suerte y prosperidad. Cada elemento tallado es una obra de arte y parte de antiguas creencias.</li>
</ul>

<h6>Misterios del Pasado y Hallazgos Asombrosos</h6>
<img src="34.jpg" alt="Casa Antigua Tan Ky"/>
<p>
    La Casa Antigua Tan Ky est llena de secretos que le dan un encanto especial:
</p>
<ul>
    <li><strong>Habitacin secreta:</strong> Se dice que detrs del armario del dormitorio hay una puerta a una pequea habitacin secreta. Aqu es donde los comerciantes escondan sus riquezas y oro de los piratas que podran atacar la ciudad! Puedes encontrarla?</li>
    <li><strong>Mezcla cultural:</strong> La arquitectura y la decoracin de la casa entrelazan armoniosamente influencias vietnamitas, chinas y japonesas, lo que refleja la historia de Hoi An como un importante puerto comercial internacional.</li>
    <li><strong>Artefactos antiguos:</strong> En el interior, vers no solo muebles y estructuras de madera nicos, sino tambin muchos objetos antiguos del hogar, documentos y obras de arte que cuentan la vida y las actividades de la familia de comerciantes Tan Ky.</li>
</ul>
<p>
    Visitar la Casa Antigua Tan Ky es una oportunidad no solo para ver un edificio antiguo, sino para tocar literalmente la historia viva del Hoi An mercantil. Este es un lugar donde cada rbol y cada piedra guardan sus propias leyendas.
</p>

    `,internalImageNames:["33.jpg","34.jpg"]},fr:{title:"Ancienne Maison Tan Ky",description:"L'Ancienne Maison Tan Ky est l'un des exemples les plus marquants de l'architecture traditionnelle de Hoi An.",fullDescription:`
<p>
    Imaginez-vous flnant dans les rues anciennes de Hoi An, o chaque maison raconte sa propre histoire. Mais parmi elles, il y en a une spciale  l'<strong>Ancienne Maison Tan Ky</strong>. Ce n'est pas seulement une ancienne demeure ; c'est un livre d'histoire vivant, plein de surprises, o les gens vivaient, commeraient et se cachaient mme des pirates !
</p>
<img src="33.jpg" alt="Ancienne Maison Tan Ky"/>
<p>
    Construite il y a plus de 200 ans (fin XVIIIe - dbut XIXe sicle) par une famille de marchands locaux prospres, l'Ancienne Maison Tan Ky est l'un des exemples les plus frappants de l'architecture traditionnelle de Hoi An. Elle est toujours la proprit et gre par les descendants de cette mme famille, qui en est maintenant  sa septime gnration ! Cela signifie que vous ne verrez pas une exposition de muse, mais une vraie maison vivante o les traditions ancestrales sont soigneusement prserves.
</p>

<h6>Secrets architecturaux et protection contre les lments</h6>
<p>
    L'Ancienne Maison Tan Ky est non seulement belle mais prsente galement des solutions d'ingnierie ingnieuses conues pour la vie  Hoi An, qui souffre souvent d'inondations :
</p>
<ul>
    <li><strong>Conception de  maison tube  :</strong> Comme de nombreuses maisons de commerce  Hoi An, Tan Ky a une faade troite mais s'tend loin vers l'intrieur, crant un espace long et multifonctionnel. Vous y trouverez une zone commerciale, des cours intrieures, des quartiers d'habitation et une zone de culte ancestral.</li>
    <li><strong>Protection contre les inondations :</strong> Hoi An est situe au bord d'une rivire, et les inondations y sont courantes. Mais les marchands de Tan Ky taient prpars  cela ! La maison dispose de mcanismes spciaux pour soulever rapidement tous les meubles et objets de valeur au deuxime tage. Imaginez comment, lors d'une forte pluie, les meubles  voleraient  vers le haut, chappant  l'eau !</li>
    <li><strong>Planchers centenaires :</strong> Les planchers de la maison sont faits d'un tonnant bois dur de  jacquier , dont on dit qu'il ne pourrit pas pendant 300 ans ! C'est un autre tmoignage de la sagesse et de la durabilit des matriaux utiliss  cette poque.</li>
    <li><strong>Art sur bois :</strong> Assurez-vous de prter attention aux panneaux sculpts originaux qui ornent l'intrieur. Ils sont fabriqus dans un style traditionnel et reprsentent souvent des scnes de la mythologie chinoise, des symboles de chance et de prosprit. Chaque lment sculpt est une uvre d'art et fait partie d'anciennes croyances.</li>
</ul>

<h6>Mystres du pass et dcouvertes tonnantes</h6>
<img src="34.jpg" alt="Ancienne Maison Tan Ky"/>
<p>
    L'Ancienne Maison Tan Ky est pleine de secrets qui lui confrent un charme particulier :
</p>
<ul>
    <li><strong>Pice secrte :</strong> On dit que derrire l'armoire de la chambre se trouve une porte menant  une minuscule pice secrte. C'est l que les marchands cachaient leurs richesses et leur or des pirates qui pouvaient attaquer la ville ! Pourrez-vous la trouver ?</li>
    <li><strong>Mlange culturel :</strong> L'architecture et le dcor de la maison entrelacent harmonieusement les influences vietnamiennes, chinoises et japonaises, refltant l'histoire de Hoi An en tant que grand port commercial international.</li>
    <li><strong>Artefacts anciens :</strong>  l'intrieur, vous verrez non seulement des meubles et des structures en bois uniques, mais aussi de nombreux objets mnagers anciens, des documents et des uvres d'art qui racontent la vie et les activits de la famille de marchands Tan Ky.</li>
</ul>
<p>
    Visiter l'Ancienne Maison Tan Ky est une occasion non seulement de voir un btiment ancien, mais de toucher littralement l'histoire vivante du Hoi An marchand. C'est un lieu o chaque arbre et chaque pierre gardent leurs propres lgendes.
</p>

    `,internalImageNames:["33.jpg","34.jpg"]},vn:{title:"Nh C Tn K",description:"Nh C Tn K l mt trong nhng v d in hnh nht v kin trc truyn thng ca Hi An.",fullDescription:`
<p>
    Hy tng tng bn ang do bc trn nhng con ph c knh ca Hi An, ni mi ngi nh u k mt cu chuyn ring. Nhng trong s , c mt ngi nh c bit  <strong>Nh C Tn K</strong>. y khng ch l mt dinh th c knh;  l mt cun sch lch s sng ng, y bt ng, ni con ngi tng sinh sng, bun bn, v thm ch trn trnh cp bin!
</p>
<img src="33.jpg" alt="Nh C Tn K"/>
<p>
    c xy dng hn 200 nm trc (cui th k 18 - u th k 19) bi mt gia nh thng nhn a phng thnh t, Nh C Tn K l mt trong nhng v d in hnh nht v kin trc truyn thng ca Hi An. Ngi nh vn thuc s hu v c qun l bi con chu ca chnh gia nh , hin  l th h th by! iu ny c ngha l bn s khng thy mt hin vt bo tng, m l mt ngi nh thc s, sng ng ni cc truyn thng t tin c bo tn cn thn.
</p>

<h6>B mt kin trc v Bo v khi thin tai</h6>
<p>
    Nh C Tn K khng ch p m cn c nhng gii php k thut kho lo c thit k cho cuc sng  Hi An, ni thng xuyn chu nh hng ca l lt:
</p>
<ul>
    <li><strong>Thit k "nh ng":</strong> Ging nh nhiu nh bun  Hi An, nh Tn K c mt tin hp nhng ko di su vo bn trong, to ra mt khng gian di, a chc nng.  y bn s tm thy khu vc bun bn, sn trong, khu vc sinh hot v khu vc th cng t tin.</li>
    <li><strong>Bo v chng l:</strong> Hi An nm ven sng, v l lt  y l hin tng ph bin. Nhng nhng ngi bun bn  Tn K  chun b sn sng cho iu ny! Ngi nh c cc c ch c bit  nhanh chng nng tt c  c v vt c gi tr ln tng hai. Hy tng tng khi tri ma ln,  c s "bay" ln trn, thot khi dng nc!</li>
    <li><strong>Sn nh trm tui:</strong> Sn nh c lm bng g mt cng ng kinh ngc, c cho l khng mc nt trong vng 300 nm! y l mt minh chng na cho s khn ngoan v  bn ca cc vt liu c s dng vo thi .</li>
    <li><strong>Ngh thut trn g:</strong> Hy chc chn ch  n cc tm vn chm khc nguyn bn trang tr ni tht. Chng c lm theo phong cch truyn thng v thng m t cc cnh trong thn thoi Trung Quc, biu tng ca s may mn v thnh vng. Mi yu t chm khc l mt tc phm ngh thut v l mt phn ca tn ngng c xa.</li>
</ul>

<h6>B n qu kh v nhng pht hin ng kinh ngc</h6>
<img src="34.jpg" alt="Nh C Tn K"/>
<p>
    Nh C Tn K cha y nhng b mt mang li cho n mt v quyn r c bit:
</p>
<ul>
    <li><strong>Cn phng b mt:</strong> Ngi ta ni rng ng sau t qun o trong phng ng c mt cnh ca dn n mt cn phng b mt nh xu. y l ni cc thng nhn ct giu ti sn v vng ca h khi nhng tn cp bin c th tn cng thnh ph! Bn c th tm thy n khng?</li>
    <li><strong>S pha trn vn ha:</strong> Kin trc v cch trang tr ca ngi nh ha quyn hi ha cc nh hng ca Vit Nam, Trung Quc v Nht Bn, phn nh lch s ca Hi An l mt cng thng mi quc t ln.</li>
    <li><strong>C vt:</strong> Bn trong, bn s khng ch thy  ni tht v cu trc g c o, m cn nhiu  dng sinh hot c, ti liu v tc phm ngh thut k v cuc i v hot ng ca gia nh thng nhn Tn K.</li>
</ul>
<p>
    Tham quan Nh C Tn K l c hi khng ch  ngm nhn mt cng trnh c knh, m cn  chm tay vo lch s sng ng ca Hi An thng cng. y l mt ni m mi cy v mi vin  u cha ng nhng truyn thuyt ring.
</p>

    `,internalImageNames:["33.jpg","34.jpg"]},slug:{en:"tan-ky-old-house",ru:"staryy-dom-tan-ki",es:"casa-antigua-tan-ky",fr:"ancienne-maison-tan-ky",vn:"nha-co-tan-ky"}},{id:"quan-thang-ancient-house",coordinates:[15.877115400142667,108.32921889710688],category:["museum"],imageUrl:"10.jpg",en:{title:"Quan Thang Ancient House",description:"Quan Thang House showcases a harmonious blend of Vietnamese, Chinese, and Japanese influences.",fullDescription:`
<p>
    If you truly want to immerse yourself in the history of Hoi An, then your path leads to the <strong>Quan Thang Ancient House</strong>. This mansion is one of the true gems of the Ancient Town, carefully preserving the spirit of its mercantile past.
</p>
<p>
    Built in the late 17th or 18th century by a wealthy Chinese merchant named Quan Thang, the house was named after him. The owner specialized in trading local products and medicines, and his house was both a luxurious residence and a bustling trading center. Surprisingly, Quan Thang House is still owned and maintained by the descendants of that very family, making it a "living" artifact that has withstood centuries and harsh climatic conditions, while preserving its original architectural design and furnishings.
</p>

<h6>Architectural Masterpiece and Its Secrets</h6>
<p>
    Quan Thang House is an outstanding example of Hoi An architecture, harmoniously blending Vietnamese, Chinese, and Japanese influences:
</p>
<img src="35.jpg" alt="Quan Thang Ancient House"/>
<ul>
    <li>It has the typical "tube house" shape of Hoi An: a narrow facade that extends far inwards, all the way to the river at the back.</li>
    <li>Inside, the house is divided into several zones: a commercial space at the entrance with counters, living quarters for the family, and, of course, a sacred place for ancestral worship.</li>
    <li>Pay attention to the <strong>inner courtyards (Sky Yards)</strong>  these are open spaces in the center of the house. They not only provide natural light and ventilation but also serve to collect rainwater. You can often see fish tanks, small plants, and trees here, creating an an oasis of tranquility.</li>
    <li>The house is famous for its exquisite wood carvings, crafted by artisans from the famous Kim Bong carpentry village. Here you'll see peacocks, flowers, mythical creatures, and patterns related to feng shui. It's one of the most beautiful examples of wood carving in Hoi An.</li>
    <li>Built from precious ironwood, the house is incredibly sturdy. Its roof is covered with "yin-yang" tiles, which help keep it cool in summer and warm in winter  it's like an ancient "air conditioner"!</li>
    <li>Above the main door are unique "door eyes" with a yin-yang symbol and bodhi leaves, adorned with red fabrics. They are believed to protect the house from evil spirits and bad luck.</li>
</ul>

<h6>Immersion in the Mercantile Past</h6>

<p>
    Visiting Quan Thang Ancient House is not just a walk through an old building. It's an opportunity to glimpse into the daily life and trading practices of Hoi An's prosperous merchant class from centuries past. The family shrines and the overall atmosphere of the house demonstrate the importance of preserving traditional beliefs and cultural customs. It is an important part of Hoi An's architectural heritage, showcasing the high craftsmanship of local and Chinese artisans.
</p>

<img src="36.jpg" alt="Quan Thang Ancient House"/>

    `,internalImageNames:["35.jpg","36.jpg"]},ru:{title:"   ",description:"      ,    .",fullDescription:`
<p>
           ,      <strong>   </strong>.         ,      .
</p>
<p>
       XVII  XVIII        ,      .        ,           . ,              ,     ,      ,         .
</p>

<h6>    </h6>
<p>
           ,   ,    :
</p>
<img src="35.jpg" alt="   "/>
<ul>
    <li>       :  ,    ,      .</li>
    <li>     :      ,     ,  ,     .</li>
    <li>   <strong>  ( )</strong>       .        ,       .       ,    ,   .</li>
    <li>      ,        .    , ,    ,   -.           .</li>
    <li>    ,   .     -,             !</li>
    <li>         -   ,   . ,         .</li>
</ul>

<h6>   </h6>

<p>
                .                .              .      ,       .
</p>

<img src="36.jpg" alt="   "/>

    `,internalImageNames:["35.jpg","36.jpg"]},es:{title:"Casa Antigua Quan Thang",description:"La Casa Quan Thang exhibe una armoniosa mezcla de influencias vietnamitas, chinas y japonesas.",fullDescription:`
<p>
    Si realmente quieres sumergirte en la historia de Hoi An, entonces tu camino te lleva a la <strong>Casa Antigua Quan Thang</strong>. Esta mansin es una de las verdaderas joyas del Casco Antiguo, preservando cuidadosamente el espritu de su pasado mercantil.
</p>
<p>
    Construida a finales del siglo XVII o XVIII por un rico comerciante chino llamado Quan Thang, la casa fue nombrada en su honor. El propietario se especializaba en el comercio de productos locales y medicinas, y su casa era tanto una lujosa residencia como un bullicioso centro comercial. Sorprendentemente, la Casa Quan Thang sigue siendo propiedad y est mantenida por los descendientes de esa misma familia, lo que la convierte en un artefacto "viviente" que ha resistido siglos y condiciones climticas adversas, conservando su diseo arquitectnico y mobiliario originales.
</p>

<h6>Obra Maestra Arquitectnica y Sus Secretos</h6>
<p>
    La Casa Quan Thang es un ejemplo sobresaliente de la arquitectura de Hoi An, fusionando armoniosamente influencias vietnamitas, chinas y japonesas:
</p>
<img src="35.jpg" alt="Casa Antigua Quan Thang"/>
<ul>
    <li>Tiene la forma tpica de "casa tubo" de Hoi An: una fachada estrecha que se extiende mucho hacia el interior, hasta el ro en la parte trasera.</li>
    <li>En el interior, la casa se divide en varias zonas: un espacio comercial en la entrada con mostradores, viviendas para la familia y, por supuesto, un lugar sagrado para el culto ancestral.</li>
    <li>Presta atencin a los <strong>patios interiores (Patios del Cielo)</strong>  estos son espacios abiertos en el centro de la casa. No solo proporcionan luz natural y ventilacin, sino que tambin sirven para recolectar agua de lluvia. A menudo se pueden ver peceras, pequeas plantas y rboles aqu, creando un oasis de tranquilidad.</li>
    <li>La casa es famosa por sus exquisitas tallas de madera, elaboradas por artesanos del famoso pueblo de carpinteros de Kim Bong. Aqu vers pavos reales, flores, criaturas mticas y patrones relacionados con el feng shui. Es uno de los ejemplos ms hermosos de tallado de madera en Hoi An.</li>
    <li>Construida con preciosa madera de hierro, la casa es increblemente robusta. Su techo est cubierto con tejas "yin-yang", que ayudan a mantenerla fresca en verano y clida en invierno  es como un "aire acondicionado" antiguo!</li>
    <li>Sobre la puerta principal hay unos "ojos de puerta" nicos con un smbolo yin-yang y hojas de bodhi, adornados con telas rojas. Se cree que protegen la casa de los malos espritus y la mala suerte.</li>
</ul>

<h6>Inmersin en el Pasado Mercantil</h6>

<p>
    Visitar la Casa Antigua Quan Thang no es solo un paseo por un edificio antiguo. Es una oportunidad para echar un vistazo a la vida diaria y las prcticas comerciales de la prspera clase mercantil de Hoi An de siglos pasados. Los santuarios familiares y la atmsfera general de la casa demuestran la importancia de preservar las creencias tradicionales y las costumbres culturales. Es una parte importante del patrimonio arquitectnico de Hoi An, mostrando la alta artesana de los artesanos locales y chinos.
</p>

<img src="36.jpg" alt="Casa Antigua Quan Thang"/>

    `,internalImageNames:["35.jpg","36.jpg"]},fr:{title:"Ancienne Maison Quan Thang",description:"La Maison Quan Thang prsente un mlange harmonieux d'influences vietnamiennes, chinoises et japonaises.",fullDescription:`
<p>
    Si vous voulez vraiment vous immerger dans l'histoire de Hoi An, alors votre chemin mne  l'<strong>Ancienne Maison Quan Thang</strong>. Cette demeure est l'un des vritables joyaux de la Vieille Ville, prservant soigneusement l'esprit de son pass marchand.
</p>
<p>
    Construite  la fin du XVIIe ou au XVIIIe sicle par un riche marchand chinois nomm Quan Thang, la maison a t nomme d'aprs lui. Le propritaire tait spcialis dans le commerce de produits locaux et de mdicaments, et sa maison tait  la fois une rsidence luxueuse et un centre commercial anim. tonnamment, la Maison Quan Thang est toujours la proprit et entretenue par les descendants de cette mme famille, ce qui en fait un artefact  vivant  qui a rsist aux sicles et aux conditions climatiques difficiles, tout en conservant son design architectural et son ameublement d'origine.
</p>

<h6>Chef-d'uvre architectural et ses secrets</h6>
<p>
    La Maison Quan Thang est un exemple exceptionnel de l'architecture de Hoi An, mlangeant harmonieusement les influences vietnamiennes, chinoises et japonaises :
</p>
<img src="35.jpg" alt="Ancienne Maison Quan Thang"/>
<ul>
    <li>Elle a la forme typique de  maison tube  de Hoi An : une faade troite qui s'tend loin vers l'intrieur, jusqu' la rivire  l'arrire.</li>
    <li> l'intrieur, la maison est divise en plusieurs zones : un espace commercial  l'entre avec des comptoirs, des quartiers d'habitation pour la famille et, bien sr, un lieu sacr pour le culte ancestral.</li>
    <li>Faites attention aux <strong>cours intrieures (Jardins du Ciel)</strong>  ce sont des espaces ouverts au centre de la maison. Ils fournissent non seulement une lumire naturelle et une ventilation, mais servent galement  recueillir l'eau de pluie. Vous pouvez souvent y voir des aquariums, de petites plantes et des arbres, crant une oasis de tranquillit.</li>
    <li>La maison est clbre pour ses exquises sculptures sur bois, fabriques par des artisans du clbre village de menuiserie de Kim Bong. Vous y verrez des paons, des fleurs, des cratures mythiques et des motifs lis au feng shui. C'est l'un des plus beaux exemples de sculpture sur bois  Hoi An.</li>
    <li>Construite  partir de bois de fer prcieux, la maison est incroyablement robuste. Son toit est recouvert de tuiles  yin-yang , qui aident  la garder frache en t et chaude en hiver  c'est comme un  climatiseur  ancien !</li>
    <li>Au-dessus de la porte principale se trouvent des  yeux de porte  uniques avec un symbole yin-yang et des feuilles de bodhi, ornes de tissus rouges. On pense qu'ils protgent la maison des mauvais esprits et de la malchance.</li>
</ul>

<h6>Immersion dans le pass marchand</h6>

<p>
    Visiter l'Ancienne Maison Quan Thang n'est pas seulement une promenade dans un vieux btiment. C'est l'occasion de jeter un coup d'il sur la vie quotidienne et les pratiques commerciales de la prospre classe marchande de Hoi An des sicles passs. Les sanctuaires familiaux et l'atmosphre gnrale de la maison dmontrent l'importance de prserver les croyances traditionnelles et les coutumes culturelles. C'est une partie importante du patrimoine architectural de Hoi An, montrant le grand savoir-faire des artisans locaux et chinois.
</p>

<img src="36.jpg" alt="Ancienne Maison Quan Thang"/>

    `,internalImageNames:["35.jpg","36.jpg"]},vn:{title:"Nh C Qun Thng",description:"Nh Qun Thng th hin s pha trn hi ha gia cc nh hng ca Vit Nam, Trung Quc v Nht Bn.",fullDescription:`
<p>
    Nu bn thc s mun m mnh vo lch s Hi An, th con ng ca bn dn n <strong>Nh C Qun Thng</strong>. Dinh th ny l mt trong nhng vin ngc qu thc s ca Ph c, gn gi cn thn tinh thn ca qu kh thng mi ca n.
</p>
<p>
    c xy dng vo cui th k 17 hoc 18 bi mt thng nhn giu c ngi Trung Quc tn l Qun Thng, ngi nh c t theo tn ng. Ch s hu chuyn kinh doanh cc sn phm a phng v thuc men, v ngi nh ca ng va l mt ni  sang trng va l mt trung tm giao thng sm ut. ng ngc nhin, Nh Qun Thng vn thuc s hu v c duy tr bi con chu ca chnh gia nh , bin n thnh mt hin vt "sng"  tn ti qua nhiu th k v iu kin kh hu khc nghit, ng thi gi c thit k kin trc v  c ban u ca n.
</p>

<h6>Kit tc kin trc v nhng b mt ca n</h6>
<p>
    Nh Qun Thng l mt v d ni bt v kin trc Hi An, ha quyn hi ha cc nh hng ca Vit Nam, Trung Quc v Nht Bn:
</p>
<img src="35.jpg" alt="Nh C Qun Thng"/>
<ul>
    <li>N c hnh dng "nh ng" in hnh ca Hi An: mt tin hp nhng ko di su vo bn trong, tn n b sng pha sau.</li>
    <li>Bn trong, ngi nh c chia thnh nhiu khu vc: mt khng gian thng mi  li vo vi quy hng, khu sinh hot cho gia nh, v tt nhin, mt ni linh thing  th cng t tin.</li>
    <li>Hy ch  n <strong>sn trong (Thin Tnh)</strong>  y l nhng khng gian m  trung tm ngi nh. Chng khng ch cung cp nh sng t nhin v thng gi m cn dng  thu thp nc ma. Bn thng c th thy h c, cy nh v cy ci  y, to ra mt c o yn bnh.</li>
    <li>Ngi nh ni ting vi nhng chm khc g tinh xo, c ch tc bi cc ngh nhn t lng mc Kim Bng ni ting.  y bn s thy chim cng, hoa, cc sinh vt thn thoi v cc ha tit lin quan n phong thy. y l mt trong nhng v d p nht v chm khc g  Hi An.</li>
    <li>c xy dng t g lim qu him, ngi nh v cng chc chn. Mi nh c lp bng ngi "m dng", gip gi cho nh mt vo ma h v m vo ma ng  ging nh mt "my lnh" c xa!</li>
    <li>Pha trn ca chnh l nhng "mt ca" c o vi biu tng m dng v l b , c trang tr bng vi . Chng c cho l  bo v ngi nh khi t ma v xui xo.</li>
</ul>

<h6>m mnh vo qu kh thng mi</h6>

<p>
    Tham quan Nh C Qun Thng khng ch l mt cuc do chi qua mt ta nh c.  l c hi  nhn thong qua cuc sng hng ngy v cc hot ng thng mi ca tng lp thng nhn thnh vng ca Hi An t nhiu th k trc. Cc bn th gia nh v bu khng kh chung ca ngi nh th hin tm quan trng ca vic bo tn tn ngng truyn thng v phong tc vn ha. y l mt phn quan trng ca di sn kin trc Hi An, th hin tay ngh cao ca cc ngh nhn a phng v Trung Quc.
</p>

<img src="36.jpg" alt="Nh C Qun Thng"/>

    `,internalImageNames:["35.jpg","36.jpg"]},slug:{en:"quan-thang-ancient-house",ru:"drevniy-dom-kvan-tang",es:"casa-antigua-quan-thang",fr:"ancienne-maison-quan-thang",vn:"nha-co-quan-thang"}},{id:"museum-of-trade-ceramics",coordinates:[15.877278909070201,108.32954973149477],category:["museum"],imageUrl:"11.jpg",en:{title:"Museum of Trade Ceramics",description:"A key testament to Hoi An's prosperity as a bustling trading port from the 15th to 18th centuries.",fullDescription:`
<p>
    If you truly want to understand how Hoi An transformed into a thriving trading port, then the <strong>Museum of Trade Ceramics</strong> is the place that will tell you this fascinating story. Housed in a beautifully restored two-story 19th-century wooden house (or even 1858, according to some sources!), this museum itself is a work of art, reflecting traditional Vietnamese architectural style.
</p>
<p>
    Opened in 1995 with the support of Japanese experts, the museum was created to preserve and showcase the incredible value of ceramics, which were the foundation of Hoi An's commercial life. It seems to trace the threads connecting the city with distant lands and shows how Hoi An became a true hub on the international maritime Silk Road.
</p>

<h6>A Collection That Tells Centuries of Stories</h6>
<p>
    The museum offers a deep dive into Hoi An's history as a bustling trading port and its key role in international ceramics trade. It houses an extensive collection  over 430 ancient artifacts, predominantly dating from the 9th to 19th centuries, although some fragments may be even older, dating back to the 7th-10th centuries!
</p>
<img src="37.jpg" alt="Museum of Trade Ceramics"/>
<p>
    Imagine that these items sailed here from all corners of the world:
</p>
<ul>
    <li><strong>China:</strong> Exquisite pieces from the Tang, Ming, Qing dynasties.</li>
    <li><strong>Japan, Thailand, Vietnam:</strong> Ceramics reflecting local craftsmanship.</li>
    <li><strong>India and even the Middle East/Central Asia:</strong> Proof of Hoi An's incredibly wide trade connections.</li>
</ul>
<p>
    In the collection, you'll see a variety of ceramics: from everyday bowls and plates to elegant wine cups, teapots, vases, and even decorative tiles. Many exhibits were found during archaeological excavations right here in Hoi An, and some were retrieved from sunken ships near Cham Island, including from the largest underwater excavation in Vietnam, dating back to the 15th century! This is undeniable proof that ceramics were a major trade commodity.
</p>

<h6>Immersion in the Trading Atmosphere</h6>
<p>
    The museum is designed to allow you to fully immerse yourself in the atmosphere of ancient trade:
</p>
<img src="38.jpg" alt="Museum of Trade Ceramics"/>
<ul>
    <li>Exhibits are arranged on two levels around a central open courtyard, creating the feeling of walking through an old trading house.</li>
    <li>In the museum's open courtyard, there is a full-sized replica of a traditional ceramic kiln. Here you can imagine how all these beautiful items were created.</li>
    <li>On the walls, you'll find old maps showing Hoi An's maritime trade routes and its connections with other countries. Of particular interest is a copy of a 17th-century Japanese painting, "Journey for Trade in Jiaozhi," painted by the merchant Chaya Shinroku.</li>
    <li>In the center of the hall, you might sometimes see a model of a "ghe bau"  a special type of sailboat from Hoi An, made by a local woodcarver, which will show what the vessels carrying these valuable goods looked like.</li>
</ul>

<h6>Legacy and Significance</h6>
<p>
    The Museum of Trade Ceramics is a key testament to Hoi An's prosperity as a bustling trading port from the 15th to 18th centuries. It clearly demonstrates its role in international trade and cultural exchange between Asia, the Middle East, and even Europe. The museum building itself, a beautifully restored ancient house, has immense architectural value and allows visitors to "feel" the atmosphere of a traditional Vietnamese home. It is a valuable resource for historians and archaeologists, allowing for a deeper study of Hoi An's past.
</p>
<p>
    The Museum of Trade Ceramics in Hoi An is not just a collection of artifacts, but a journey through time, revealing the city's glorious commercial past and its role as an important hub on the international maritime Silk Road.
</p>

    `,internalImageNames:["38.jpg","37.jpg"]},ru:{title:"  ",description:"         XV  XVIII .",fullDescription:`
<p>
        ,       ,  <strong>  </strong>    ,      .        XIX  (  1858 ,   !),        ,     .
</p>
<p>
      1995     ,          ,      .    ,     ,  ,          .
</p>

<h6>,    </h6>
<p>
                      .        430  ,   IX-XIX ,       ,   VII-X !
</p>
<img src="37.jpg" alt="  "/>
<p>
    ,         :
</p>
<ul>
    <li><strong>:</strong>    , , .</li>
    <li><strong>, , :</strong> ,   .</li>
    <li><strong>    / :</strong>      .</li>
</ul>
<p>
         :         , ,     .          ,  ,          ,         ,  XV !    ,      .
</p>

<h6>   </h6>
<p>
      ,         :
</p>
<img src="38.jpg" alt="  "/>
<ul>
    <li>         ,       .</li>
    <li>          .    ,      .</li>
    <li>     ,           .       XVII      ,    .</li>
    <li>               ,     ,  ,   ,    .</li>
</ul>

<h6>  </h6>
<p>
                 XV  XVIII .             ,     .   ,    ,            .       ,     .
</p>
<p>
              ,    ,                .
</p>

    `,internalImageNames:["38.jpg","37.jpg"]},slug:{en:"museum-of-trade-ceramics",ru:"muzey-torgovoy-keramiki",es:"museo-comercio-ceramica",fr:"musee-ceramique-commerciale",vn:"bao-tang-gom-su-thuong-mai"}},{id:"museum-of-local-products",coordinates:[15.877226900667111,108.32979996486384],category:["museum"],imageUrl:"12.jpg",en:{title:"Museum of Local Products",description:"Created to showcase, introduce, promote, and develop Hoi An's spices and local products.",fullDescription:`
<p>
    If you've ever dreamed of discovering the secrets hidden within the local spices and products that have made Hoi An a gem of trade for centuries, then you absolutely must visit the <strong>Museum of Local Products in Hoi An</strong>. This new but very important museum, recently opened, is located in one of the ancient houses at 57 Trn Ph and aims to immerse you in a world of aromas and stories.
</p>
<p>
    Created by the Hoi An Center for Cultural Heritage Management and Preservation, the museum has one main goal: to showcase, introduce, and, of course, promote the unique spices and local products of Hoi An and the entire Quang Nam province. This isn't just an exhibition; it's a new, attractive tourist destination that will allow you to learn about and experience the richness of the region, as well as gain insight into the history of bustling trade that thrived in Hoi An's port from ancient times to the present day.
</p>

<h6>Themes, Artifacts, and Culinary Secrets</h6>
<p>
    The Museum of Local Products is very thoughtfully organized into four fascinating themes that will reveal the essence of Hoi An to you:
</p>
<img src="39.jpg" alt="Museum of Local Products"/>
<ul>
    <li><strong>Overview of Local Products:</strong> You'll get a general understanding of what makes this region rich.</li>
    <li><strong>Hoi An  A Spice Transit Point:</strong> This part of the exhibition highlights Hoi An's historical role as a key hub through which flows of spices and other valuable goods passed.</li>
    <li><strong>Typical and Endemic Products:</strong> Here you'll discover the true treasures of the Quang Nam region, such as mysterious bird's nest, unique Lao leaves, aromatic pepper, betel nut, fragrant cinnamon, various types of tea, and valuable agarwood (oud).</li>
    <li><strong>Continuity and Development:</strong> This section will likely show how local products live and develop in the modern world, preserving their traditions.</li>
</ul>
<p>
    In the museum, you'll see an impressive collection: 130 images, ancient documents, books, and maps, as well as 178 artifacts of high historical and cultural value. In addition, various models, layouts, and samples are presented to help you better understand how these products were collected, processed, and used.
</p>

<h6>Significance for the City and Its Guests</h6>
<p>
    The opening of this museum is an important event that emphasizes several aspects at once:
</p>
<ul>
    <li><strong>Hoi An's Historical Role:</strong> It once again reminds us that Hoi An was a key trading center, connecting regions and countries through spices and local goods.</li>
    <li><strong>Richness of Local Heritage:</strong> The museum vividly demonstrates the diversity of unique products and spices from Quang Nam province, revealing their value.</li>
    <li><strong>Tourism Development:</strong> This is a new, attractive point on the tourist map, offering visitors a unique opportunity to gain a deeper understanding of the region's trade history and culture through its flavors and aromas.</li>
</ul>
<p>
    The Museum of Local Products in Hoi An is a valuable addition to the city's cultural landscape, offering a unique journey into the gastronomic and trade heritage of the region. Be sure to stop by and breathe in the aroma of history!
</p>
    `,internalImageNames:["39.jpg"]},ru:{title:"  ",description:"  , ,        .",fullDescription:`
<p>
      -     ,      ,        ,      <strong>    </strong>.  ,    ,  ,         57 Trn Ph         .
</p>
<p>
           ,     : ,  ,  ,           .    ;  ,   ,        ,        ,           .
</p>

<h6>,    </h6>
<p>
             ,      :
</p>
<img src="39.jpg" alt="  "/>
<ul>
    <li><strong>  :</strong>      ,     .</li>
    <li><strong>    :</strong>          ,         .</li>
    <li><strong>   :</strong>         ,     ,   ,  , ,  ,        ().</li>
    <li><strong>  :</strong>  , , ,         ,   .</li>
</ul>
<p>
         : 130 ,  ,   ,   178 ,      .  ,   ,   ,     ,    ,   .
</p>

<h6>     </h6>
<p>
         ,     :
</p>
<ul>
    <li><strong>  :</strong>     ,      ,         .</li>
    <li><strong>  :</strong>          ,   .</li>
    <li><strong> :</strong>  ,     ,                .</li>
</ul>
<p>
                ,         .      !
</p>
    `,internalImageNames:["39.jpg"]},es:{title:"Museo de Productos Locales",description:"Creado para exhibir, introducir, promover y desarrollar las especias y productos locales de Hoi An.",fullDescription:`
<p>
    Si alguna vez soaste con descubrir los secretos ocultos en las especias y productos locales que han hecho de Hoi An una joya del comercio durante siglos, entonces debes visitar el <strong>Museo de Productos Locales en Hoi An</strong>. Este museo nuevo pero muy importante, recientemente inaugurado, est ubicado en una de las casas antiguas en 57 Trn Ph y tiene como objetivo sumergirte en un mundo de aromas e historias.
</p>
<p>
    Creado por el Centro de Gestin y Preservacin del Patrimonio Cultural de Hoi An, el museo tiene un objetivo principal: exhibir, introducir y, por supuesto, promover las especias y productos locales nicos de Hoi An y de toda la provincia de Quang Nam. Esto no es solo una exposicin; es un nuevo y atractivo destino turstico que te permitir aprender y experimentar la riqueza de la regin, as como comprender la historia del bullicioso comercio que prosper en el puerto de Hoi An desde la antigedad hasta el da de hoy.
</p>

<h6>Temas, Artefactos y Secretos Culinarios</h6>
<p>
    El Museo de Productos Locales est muy cuidadosamente organizado en cuatro temas fascinantes que te revelarn la esencia de Hoi An:
</p>
<img src="39.jpg" alt="Museo de Productos Locales"/>
<ul>
    <li><strong>Panorama de Productos Locales:</strong> Obtendrs una comprensin general de lo que enriquece esta regin.</li>
    <li><strong>Hoi An  Un Punto de Trnsito de Especias:</strong> Esta parte de la exposicin destaca el papel histrico de Hoi An como un centro clave a travs del cual fluan especias y otros bienes valiosos.</li>
    <li><strong>Productos Tpicos y Endmicos:</strong> Aqu descubrirs los verdaderos tesoros de la regin de Quang Nam, como el misterioso nido de pjaro, las hojas nicas de Lao, el aromtico pimiento, la nuez de areca, la fragante canela, varios tipos de t y el valioso agarwood (oud).</li>
    <li><strong>Continuidad y Desarrollo:</strong> Esta seccin probablemente mostrar cmo los productos locales viven y se desarrollan en el mundo moderno, conservando sus tradiciones.</li>
</ul>
<p>
    En el museo, vers una impresionante coleccin: 130 imgenes, documentos antiguos, libros y mapas, as como 178 artefactos de alto valor histrico y cultural. Adems, se presentan varios modelos, maquetas y muestras para ayudarte a comprender mejor cmo se recolectaron, procesaron y utilizaron estos productos.
</p>

<h6>Significado para la Ciudad y Sus Invitados</h6>
<p>
    La apertura de este museo es un evento importante que enfatiza varios aspectos a la vez:
</p>
<ul>
    <li><strong>El Papel Histrico de Hoi An:</strong> Una vez ms nos recuerda que Hoi An fue un centro comercial clave, conectando regiones y pases a travs de especias y productos locales.</li>
    <li><strong>Riqueza del Patrimonio Local:</strong> El museo demuestra vvidamente la diversidad de productos y especias nicos de la provincia de Quang Nam, revelando su valor.</li>
    <li><strong>Desarrollo Turstico:</strong> Este es un nuevo y atractivo punto en el mapa turstico, que ofrece a los visitantes una oportunidad nica de obtener una comprensin ms profunda de la historia comercial y la cultura de la regin a travs de sus sabores y aromas.</li>
</ul>
<p>
    El Museo de Productos Locales en Hoi An es una valiosa adicin al paisaje cultural de la ciudad, ofreciendo un viaje nico al patrimonio gastronmico y comercial de la regin. Asegrate de pasar y respirar el aroma de la historia!
</p>
    `,internalImageNames:["39.jpg"]},fr:{title:"Muse des Produits Locaux",description:"Cr pour prsenter, introduire, promouvoir et dvelopper les pices et les produits locaux de Hoi An.",fullDescription:`
<p>
    Si vous avez toujours rv de dcouvrir les secrets cachs dans les pices et les produits locaux qui ont fait de Hoi An un joyau du commerce pendant des sicles, alors vous devez absolument visiter le <strong>Muse des Produits Locaux  Hoi An</strong>. Ce nouveau muse, mais trs important, rcemment ouvert, est situ dans l'une des anciennes maisons au 57 Trn Ph et vise  vous plonger dans un monde d'armes et d'histoires.
</p>
<p>
    Cr par le Centre de Gestion et de Prservation du Patrimoine Culturel de Hoi An, le muse a un objectif principal : prsenter, introduire et, bien sr, promouvoir les pices et les produits locaux uniques de Hoi An et de toute la province de Quang Nam. Ce n'est pas seulement une exposition ; c'est une nouvelle destination touristique attrayante qui vous permettra de dcouvrir et d'exprimenter la richesse de la rgion, ainsi que d'avoir un aperu de l'histoire du commerce anim qui a prospr dans le port de Hoi An depuis l'Antiquit jusqu' nos jours.
</p>

<h6>Thmes, Artefacts et Secrets Culinaires</h6>
<p>
    Le Muse des Produits Locaux est trs soigneusement organis en quatre thmes fascinants qui vous rvleront l'essence de Hoi An :
</p>
<img src="39.jpg" alt="Muse des Produits Locaux"/>
<ul>
    <li><strong>Aperu des produits locaux :</strong> Vous aurez une comprhension gnrale de ce qui rend cette rgion riche.</li>
    <li><strong>Hoi An  Un point de transit des pices :</strong> Cette partie de l'exposition met en lumire le rle historique de Hoi An en tant que plaque tournante cl par laquelle transitaient les flux d'pices et d'autres marchandises prcieuses.</li>
    <li><strong>Produits typiques et endmiques :</strong> Ici, vous dcouvrirez les vritables trsors de la rgion de Quang Nam, tels que le mystrieux nid d'oiseau, les feuilles de Lao uniques, le poivre aromatique, la noix de btel, la cannelle parfume, divers types de th et le prcieux bois d'agar (oud).</li>
    <li><strong>Continuit et dveloppement :</strong> Cette section montrera probablement comment les produits locaux vivent et se dveloppent dans le monde moderne, en prservant leurs traditions.</li>
</ul>
<p>
    Dans le muse, vous verrez une impressionnante collection : 130 images, documents anciens, livres et cartes, ainsi que 178 artefacts de grande valeur historique et culturelle. De plus, divers modles, maquettes et chantillons sont prsents pour vous aider  mieux comprendre comment ces produits ont t collects, traits et utiliss.
</p>

<h6>Importance pour la ville et ses visiteurs</h6>
<p>
    L'ouverture de ce muse est un vnement important qui met l'accent sur plusieurs aspects  la fois :
</p>
<ul>
    <li><strong>Le rle historique de Hoi An :</strong> Il nous rappelle une fois de plus que Hoi An tait un centre commercial cl, reliant les rgions et les pays grce aux pices et aux produits locaux.</li>
    <li><strong>Richesse du patrimoine local :</strong> Le muse dmontre clairement la diversit des produits et pices uniques de la province de Quang Nam, rvlant leur valeur.</li>
    <li><strong>Dveloppement touristique :</strong> C'est un nouveau point attractif sur la carte touristique, offrant aux visiteurs une occasion unique de mieux comprendre l'histoire du commerce et la culture de la rgion  travers ses saveurs et ses armes.</li>
</ul>
<p>
    Le Muse des Produits Locaux  Hoi An est un ajout prcieux au paysage culturel de la ville, offrant un voyage unique dans le patrimoine gastronomique et commercial de la rgion. N'oubliez pas de vous arrter et de respirer l'arme de l'histoire !
</p>
    `,internalImageNames:["39.jpg"]},vn:{title:"Bo Tng Sn Phm a Phng",description:"c thnh lp  gii thiu, qung b v pht trin cc loi gia v v sn phm a phng ca Hi An.",fullDescription:`
<p>
    Nu bn tng m c khm ph nhng b mt n cha trong cc loi gia v v sn phm a phng  bin Hi An thnh mt vin ngc qu ca thng mi qua nhiu th k, th bn nht nh phi gh thm <strong>Bo Tng Sn Phm a Phng  Hi An</strong>. Bo tng mi nhng rt quan trng ny, va mi khai trng, nm trong mt trong nhng ngi nh c ti s 57 Trn Ph v nhm mc ch a bn m chm vo th gii ca hng thm v nhng cu chuyn.
</p>
<p>
    c thnh lp bi Trung tm Qun l v Bo tn Di sn Vn ha Hi An, bo tng c mt mc tiu chnh: gii thiu, qung b v tt nhin, pht trin cc loi gia v v sn phm a phng c o ca Hi An v ton tnh Qung Nam. y khng ch l mt cuc trin lm;  l mt im n du lch mi, hp dn s cho php bn tm hiu v tri nghim s phong ph ca khu vc, cng nh hiu r hn v lch s thng mi sm ut  pht trin mnh m ti cng Hi An t thi c i n ngy nay.
</p>

<h6>Ch , hin vt v b mt m thc</h6>
<p>
    Bo Tng Sn Phm a Phng c t chc rt chu o thnh bn ch  hp dn s tit l bn cht ca Hi An cho bn:
</p>
<img src="39.jpg" alt="Bo Tng Sn Phm a Phng"/>
<ul>
    <li><strong>Tng quan v sn phm a phng:</strong> Bn s c ci nhn tng th v nhng g lm cho vng ny tr nn giu c.</li>
    <li><strong>Hi An  im trung chuyn gia v:</strong> Phn trin lm ny nhn mnh vai tr lch s ca Hi An l mt trung tm trung chuyn quan trng ni cc dng gia v v cc hng ha c gi tr khc  i qua.</li>
    <li><strong>Sn phm c trng v c hu:</strong> Ti y, bn s khm ph nhng kho bu thc s ca vng Qung Nam, nh t yn b n, l Lo c o, tiu thm, cau, qu thm, cc loi tr khc nhau v trm hng qu gi (oud).</li>
    <li><strong>S lin tc v pht trin:</strong> Phn ny c th s cho thy cc sn phm a phng sng v pht trin nh th no trong th gii hin i, gi gn truyn thng ca chng.</li>
</ul>
<p>
    Trong bo tng, bn s thy mt b su tp n tng: 130 hnh nh, ti liu c, sch v bn , cng nh 178 hin vt c gi tr lch s v vn ha cao. Ngoi ra, nhiu m hnh, b cc v mu vt c trng by  gip bn hiu r hn v cch cc sn phm ny c thu thp, ch bin v s dng.
</p>

<h6> ngha i vi thnh ph v du khch</h6>
<p>
    Vic khai trng bo tng ny l mt s kin quan trng, nhn mnh nhiu kha cnh cng mt lc:
</p>
<ul>
    <li><strong>Vai tr lch s ca Hi An:</strong> N mt ln na nhc nh chng ta rng Hi An tng l mt trung tm thng mi quan trng, kt ni cc vng v quc gia thng qua gia v v hng ha a phng.</li>
    <li><strong>S phong ph ca di sn a phng:</strong> Bo tng minh ha sng ng s a dng ca cc sn phm v gia v c o t tnh Qung Nam, tit l gi tr ca chng.</li>
    <li><strong>Pht trin du lch:</strong> y l mt im n mi, hp dn trn bn  du lch, mang n cho du khch c hi duy nht  hiu su hn v lch s thng mi v vn ha ca vng thng qua hng v v mi hng ca n.</li>
</ul>
<p>
    Bo Tng Sn Phm a Phng  Hi An l mt s b sung c gi tr vo cnh quan vn ha ca thnh ph, mang n mt hnh trnh c o vo di sn m thc v thng mi ca vng. Hy chc chn gh qua v ht th hng thm ca lch s!
</p>
    `,internalImageNames:["39.jpg"]},slug:{en:"museum-of-local-products",ru:"muzey-mestnykh-produktov",es:"museo-productos-locales",fr:"musee-produits-locaux",vn:"bao-tang-san-pham-dia-phuong"}},{id:"trung-hoa-assembly-hall",coordinates:[15.877372981079134,108.33001799930773],category:["museum"],imageUrl:"13.jpg",en:{title:"Trung Hoa Assembly Hall",description:"This is a unique hall, distinct from other Chinese assembly halls in Hoi An.",fullDescription:`
<p>
    Among the many ancient buildings in Hoi An, there is one that stands out with its unique appearance and special history  it's the <strong>Trung Hoa Assembly Hall (Chinese Assembly Hall of Hoi An)</strong>, also known as the Ng Bang Assembly Hall. Located at 64 Trn Ph, it is not just beautiful, but also holds deep meaning.
</p>
<p>
    Built in 1741, this hall was special. Unlike others that belonged to specific regional Chinese communities (Fujian, Cantonese, Hainan), the Ng Bang Assembly Hall was created as a common center for Chinese immigrants from <strong>five main groups</strong>: Cantonese, Teochew, Hainanese, Fujian, and Jiaying (Hakka). Its name "Ng Bang" literally means "Five Groups" or "Five Provinces," perfectly reflecting its purpose  to unite the Chinese diaspora in Hoi An, regardless of their origin. Meetings, religious ceremonies, and community events were held here, and according to some sources, children from Chinese families were even taught here, maintaining their language and culture far from their homeland.
</p>

<h6>Unique Blue Color and Harmonious Architecture</h6>
<p>
    The Chinese Assembly Hall of Hoi An impresses with its unique architecture and, of course, its color palette. It is the only assembly hall in Hoi An painted in a vibrant blue color, which immediately sets it apart from other predominantly red buildings. The blue walls give it a special uniqueness and photogenic quality!
</p>
<p>
    Its layout is carefully balanced and includes all traditional elements:
</p>
<ul>
    <li>You'll be greeted by grand entrance gates that seem to invite you inside.</li>
    <li>Inside, you'll find a spacious front courtyard leading to the front hall, followed by another inner courtyard and a pavilion.</li>
    <li>The main hall takes center stage, where the main worship ceremonies took place.</li>
    <li>On the sides are the east and west halls, which were used for various community needs.</li>
</ul>
<p>
    The entire hall is adorned with intricate carvings, decorative altars, and vibrant paintings. You'll see beautifully sculpted dragons and phoenixes  symbols of strength and prosperity in Chinese culture. The design uses a combination of wood and stone, showcasing the elegance of traditional Chinese craftsmanship.
</p>

<h6>Symbol of Unity and Cultural Preservation</h6>
<p>
    The Trung Hoa Assembly Hall is more than just a beautiful building. It is a powerful symbol of unity and mutual support among the various Chinese communities that contributed greatly to Hoi An's prosperity as a trading port. Various Chinese deities revered by all communities, such as Thien Hau (Mother Goddess of the Sea), Confucius, and other common gods bringing good luck and prosperity, could be worshiped in the hall. Its role in preserving the Chinese language and culture for the diaspora's children makes it particularly valuable.
</p>
<p>
    The Chinese Assembly Hall of Hoi An is not only an architectural masterpiece with a unique blue color, but also an important historical monument reflecting the cohesion and rich cultural heritage of the Chinese diaspora in Hoi An Ancient Town. Be sure to stop by and feel this special atmosphere!
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},ru:{title:"   ",description:"  ,        .",fullDescription:`
<p>
          ,           <strong>    (   )</strong>,       .    64 Trn Ph,    ,     .
</p>
<p>
      1741 ,    .    ,      (, , ),              <strong>  </strong>: , , ,    ().           ,           ,    .   ,     ,    ,       ,        .
</p>

<h6>     </h6>
<p>
            ,  ,  .      ,     ,         .        !
</p>
<p>
            :
</p>
<ul>
    <li>    ,    .</li>
    <li>     ,    ,         .</li>
    <li>    ,     .</li>
    <li>      ,      .</li>
</ul>
<p>
        ,     .               .       ,     .
</p>

<h6>    </h6>
<p>
          ,    .         ,          .       ,   ,     (- ),     ,    .               .
</p>
<p>
                 ,     ,            .       !
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},es:{title:"Sala de Asamblea Trung Hoa",description:"Esta es una sala nica, distinta de otras salas de asamblea chinas en Hoi An.",fullDescription:`
<p>
    Entre los muchos edificios antiguos de Hoi An, hay uno que destaca por su apariencia nica y su historia especial: es la <strong>Sala de Asamblea Trung Hoa (Sala de Asamblea China de Hoi An)</strong>, tambin conocida como la Sala de Asamblea Ng Bang. Ubicada en 64 Trn Ph, no solo es hermosa, sino que tambin tiene un profundo significado.
</p>
<p>
    Construida en 1741, esta sala era especial. A diferencia de otras que pertenecan a comunidades chinas regionales especficas (Fujian, Cantn, Hainan), la Sala de Asamblea Ng Bang fue creada como un centro comn para inmigrantes chinos de <strong>cinco grupos principales</strong>: Cantoneses, Teochew, Hainaneses, Fujian y Jiaying (Hakka). Su nombre "Ng Bang" significa literalmente "Cinco Grupos" o "Cinco Provincias", reflejando perfectamente su propsito: unir a la dispora china en Hoi An, independientemente de su origen. Aqu se celebraban reuniones, ceremonias religiosas y eventos comunitarios, y segn algunas fuentes, incluso se enseaba a los nios de familias chinas, manteniendo su idioma y cultura lejos de su tierra natal.
</p>

<h6>Color Azul nico y Arquitectura Armoniosa</h6>
<p>
    La Sala de Asamblea China de Hoi An impresiona por su arquitectura nica y, por supuesto, su paleta de colores. Es la nica sala de asamblea en Hoi An pintada en un vibrante color azul, lo que la distingue inmediatamente de otros edificios predominantemente rojos. Las paredes azules le dan una singularidad y calidad fotognica especiales!
</p>
<p>
    Su diseo est cuidadosamente equilibrado e incluye todos los elementos tradicionales:
</p>
<ul>
    <li>Sers recibido por grandes puertas de entrada que parecen invitarte al interior.</li>
    <li>Dentro, encontrars un espacioso patio delantero que conduce al vestbulo principal, seguido de otro patio interior y un pabelln.</li>
    <li>La sala principal ocupa un lugar central, donde se llevaban a cabo las principales ceremonias de culto.</li>
    <li>A los lados se encuentran las salas este y oeste, que se utilizaban para diversas necesidades comunitarias.</li>
</ul>
<p>
    Toda la sala est adornada con intrincadas tallas, altares decorativos y vibrantes pinturas. Vers dragones y fnix bellamente esculpidos, smbolos de fuerza y prosperidad en la cultura china. El diseo utiliza una combinacin de madera y piedra, mostrando la elegancia de la artesana tradicional china.
</p>

<h6>Smbolo de Unidad y Preservacin Cultural</h6>
<p>
    La Sala de Asamblea Trung Hoa es ms que un hermoso edificio. Es un poderoso smbolo de unidad y apoyo mutuo entre las diversas comunidades chinas que contribuyeron en gran medida a la prosperidad de Hoi An como puerto comercial. En la sala se podan adorar varias deidades chinas veneradas por todas las comunidades, como Thien Hau (Diosa Madre del Mar), Confucio y otros dioses comunes que traen buena suerte y prosperidad. Su papel en la preservacin del idioma y la cultura chinos para los nios de la dispora la hace particularmente valiosa.
</p>
<p>
    La Sala de Asamblea China de Hoi An no es solo una obra maestra arquitectnica con un color azul nico, sino tambin un importante monumento histrico que refleja la cohesin y el rico patrimonio cultural de la dispora china en el Casco Antiguo de Hoi An. Asegrate de pasar y sentir esta atmsfera especial!
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},fr:{title:"Salle de l'Assemble Trung Hoa",description:"C'est une salle unique, distincte des autres salles d'assemble chinoises  Hoi An.",fullDescription:`
<p>
    Parmi les nombreux btiments anciens de Hoi An, il en est un qui se distingue par son apparence unique et son histoire particulire  c'est la <strong>Salle de l'Assemble Trung Hoa (Salle de l'Assemble chinoise de Hoi An)</strong>, galement connue sous le nom de Salle de l'Assemble Ng Bang. Situe au 64 Trn Ph, elle n'est pas seulement belle, mais revt galement une signification profonde.
</p>
<p>
    Construite en 1741, cette salle tait spciale. Contrairement  d'autres qui appartenaient  des communauts chinoises rgionales spcifiques (Fujian, Canton, Hainan), la Salle de l'Assemble Ng Bang a t cre comme un centre commun pour les immigrants chinois des <strong>cinq groupes principaux</strong> : Cantonais, Teochew, Hainanais, Fujian et Jiaying (Hakka). Son nom  Ng Bang  signifie littralement  Cinq Groupes  ou  Cinq Provinces , refltant parfaitement son objectif  unir la diaspora chinoise  Hoi An, quelle que soit son origine. Des runions, des crmonies religieuses et des vnements communautaires y taient organiss, et selon certaines sources, les enfants des familles chinoises y taient mme enseigns, maintenant leur langue et leur culture loin de leur patrie.
</p>

<h6>Couleur bleue unique et architecture harmonieuse</h6>
<p>
    La Salle de l'Assemble chinoise de Hoi An impressionne par son architecture unique et, bien sr, sa palette de couleurs. C'est la seule salle d'assemble de Hoi An peinte d'un bleu clatant, ce qui la distingue immdiatement des autres btiments majoritairement rouges. Les murs bleus lui confrent une singularit et une qualit photognique particulires !
</p>
<p>
    Son agencement est soigneusement quilibr et comprend tous les lments traditionnels :
</p>
<ul>
    <li>Vous serez accueillis par de grandes portes d'entre qui semblent vous inviter  l'intrieur.</li>
    <li> l'intrieur, vous trouverez une spacieuse cour avant menant au hall d'entre, suivie d'une autre cour intrieure et d'un pavillon.</li>
    <li>Le hall principal occupe une place centrale, o se droulaient les principales crmonies de culte.</li>
    <li>Sur les cts se trouvent les halls est et ouest, qui taient utiliss pour divers besoins communautaires.</li>
</ul>
<p>
    L'ensemble du hall est orn de sculptures complexes, d'autels dcoratifs et de peintures vibrantes. Vous verrez de magnifiques dragons et phnix sculpts  symboles de force et de prosprit dans la culture chinoise. Le design utilise une combinaison de bois et de pierre, mettant en valeur l'lgance de l'artisanat chinois traditionnel.
</p>

<h6>Symbole d'unit et de prservation culturelle</h6>
<p>
    La Salle de l'Assemble Trung Hoa est plus qu'un simple btiment magnifique. C'est un puissant symbole d'unit et de soutien mutuel entre les diverses communauts chinoises qui ont grandement contribu  la prosprit de Hoi An en tant que port de commerce. Diverses divinits chinoises vnres par toutes les communauts, telles que Thien Hau (Desse Mre de la Mer), Confucius et d'autres dieux communs apportant chance et prosprit, pouvaient tre vnres dans le hall. Son rle dans la prservation de la langue et de la culture chinoises pour les enfants de la diaspora la rend particulirement prcieuse.
</p>
<p>
    La Salle de l'Assemble chinoise de Hoi An n'est pas seulement un chef-d'uvre architectural d'une couleur bleue unique, mais aussi un monument historique important refltant la cohsion et le riche patrimoine culturel de la diaspora chinoise dans la vieille ville de Hoi An. N'oubliez pas de vous arrter et de ressentir cette atmosphre spciale !
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},vn:{title:"Hi Qun Trung Hoa",description:"y l mt hi qun c o, khc bit so vi cc hi qun Trung Quc khc  Hi An.",fullDescription:`
<p>
    Trong s rt nhiu cng trnh kin trc c knh  Hi An, c mt ni ni bt vi v ngoi c o v lch s c bit   l <strong>Hi Qun Trung Hoa (Chinese Assembly Hall of Hoi An)</strong>, cn c gi l Ng Bang Hi Qun. Nm  s 64 Trn Ph, ni y khng ch p m cn mang  ngha su sc.
</p>
<p>
    c xy dng vo nm 1741, hi qun ny rt c bit. Khng ging nh cc hi qun khc thuc v cc cng ng ngi Hoa c th (Phc Kin, Qung ng, Hi Nam), Ng Bang Hi Qun c thnh lp nh mt trung tm chung cho nhng ngi Hoa nhp c t <strong>nm nhm chnh</strong>: Qung ng, Triu Chu, Hi Nam, Phc Kin v Gia ng (Khch Gia). Tn gi "Ng Bang" theo ngha en c ngha l "Nm Bang" hoc "Nm Tnh", phn nh hon ho mc ch ca n  on kt cng ng ngi Hoa ti Hi An, bt k ngun gc ca h. Cc cuc hp, nghi l tn gio v s kin cng ng c t chc ti y, v theo mt s ngun, tr em t cc gia nh ngi Hoa thm ch cn c dy hc  y, duy tr ngn ng v vn ha ca h cch xa qu hng.
</p>

<h6>Mu xanh c o v kin trc hi ha</h6>
<p>
    Hi Qun Trung Hoa  Hi An gy n tng vi kin trc c o v, tt nhin, bng mu ca n. y l hi qun duy nht  Hi An c sn mu xanh lam rc r, iu ny ngay lp tc lm n ni bt so vi cc cng trnh ch yu mu  khc. Nhng bc tng mu xanh lam mang li cho n mt nt c o v tnh thm m c bit!
</p>
<p>
    B cc ca n c cn bng cn thn v bao gm tt c cc yu t truyn thng:
</p>
<ul>
    <li>Bn s c cho n bi nhng cng vo ln dng nh mi bn vo bn trong.</li>
    <li>Bn trong, bn s tm thy mt sn trc rng ri dn n snh chnh, tip theo l mt sn trong khc v mt gian th.</li>
    <li>Snh chnh chim v tr trung tm, ni din ra cc nghi l th cng chnh.</li>
    <li> hai bn l cc snh ng v ty, c s dng cho cc nhu cu cng ng khc nhau.</li>
</ul>
<p>
    Ton b hi qun c trang tr bng nhng chm khc tinh xo, bn th trang tr v nhng bc tranh rc r. Bn s thy nhng con rng v phng hong c iu khc p mt  biu tng ca sc mnh v s thnh vng trong vn ha Trung Quc. Thit k s dng s kt hp gia g v , th hin s sang trng ca ngh th cng truyn thng Trung Quc.
</p>

<h6>Biu tng ca s on kt v bo tn vn ha</h6>
<p>
    Hi Qun Trung Hoa khng ch l mt cng trnh kin trc p.  l mt biu tng mnh m ca s on kt v h tr ln nhau gia cc cng ng ngi Hoa khc nhau  ng gp rt ln vo s thnh vng ca Hi An vi t cch l mt thng cng. Cc v thn Trung Quc khc nhau c tt c cc cng ng tn th, chng hn nh Thin Hu (Mu Thin Hu), Khng T v cc v thn chung khc mang li may mn v thnh vng, c th c th cng trong hi qun. Vai tr ca n trong vic bo tn ting Trung v vn ha cho con chu ca cng ng ngi Hoa khin n tr nn c bit c gi tr.
</p>
<p>
    Hi Qun Trung Hoa  Hi An khng ch l mt kit tc kin trc vi mu xanh c o, m cn l mt di tch lch s quan trng phn nh s gn kt v di sn vn ha phong ph ca cng ng ngi Hoa  Ph c Hi An. Hy chc chn gh thm v cm nhn bu khng kh c bit ny!
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},slug:{en:"trung-hoa-assembly-hall",ru:"sbornyy-zal-trung-hoa",es:"sala-asamblea-trung-hoa",fr:"salle-assemblee-trung-hoa",vn:"hoi-quan-trung-hoa"}},{id:"fujian-assembly-hall",coordinates:[15.877479589047237,108.33062773730362],category:["museum"],imageUrl:"14.jpg",en:{title:"Fujian Assembly Hall",description:"Originally a small shrine built by the Vietnamese around 1690.",fullDescription:`
<p>
    If you want to see the most vibrant and richly decorated Chinese assembly hall in Hoi An, then your path leads to the <strong>Fujian Assembly Hall (Hi Qun Phc Kin)</strong>. This is not just a temple; it's a true work of art and a living testament to the prosperity of the Chinese community that played a huge role in Hoi An's establishment as a trading port.
</p>
<p>
    Originally a small shrine built by the Vietnamese around 1690, it was acquired and rebuilt by the influential Chinese community from Fujian province in the late 17th century, making it their main center. Since then, it has been dedicated to <strong>Thien Hau</strong>, the Mother Goddess of the Sea, who is known to protect sailors and merchants. This explains why this hall was so important to Fujian merchants arriving in Hoi An across turbulent seas. The hall has been expanded and restored numerous times, which only emphasizes the power and wealth of this community.
</p>

<h6>Architectural Grandeur and Symbols of Prosperity</h6>
<p>
    The Fujian Assembly Hall impresses with its beauty and traditional Chinese architecture with a strong influence of the Fujian style. The complex has a classic temple structure that will lead you through a series of impressive spaces:
</p>
<ul>
    <li>You'll be greeted by grand Main Gates with three entrances, adorned with intricate carvings and statues.</li>
    <li>Beyond the gates is a spacious Front Courtyard with a fountain and decorative elements  an ideal place to begin your exploration of the hall.</li>
    <li>Next, you'll enter the Main Hall, where the main altar to the Goddess Thien Hau is located. Her statue, often surrounded by other deities, dominates the space.</li>
    <li>The complex also includes a Rear Hall, dedicated to other deities and ancestors, and Side Rooms, which were used for various community needs.</li>
</ul>
<p>
    The entire building is constructed of wood and stone, with a traditional tiled roof. The interior is literally immersed in bright colors, lacquered pieces, exquisite wood and stone carvings, as well as ceramic statues and mosaics. You'll see incredibly detailed carvings depicting dragons, phoenixes, unicorns, lions, flowers, fruits, and scenes from Chinese mythology and history. The predominant colors  red and gold  are no coincidence; they symbolize good luck and prosperity.
</p>

<h6>Unique Details and Cultural Significance</h6>
<p>
    Among other things, the Fujian Assembly Hall has several unique details:
</p>
<ul>
    <li>You'll find many statues depicting deities, mythical creatures, and historical figures. Particularly noteworthy are the statues of the six ancestors of the Tran family, who made significant contributions to the hall's construction.</li>
    <li>A unique feature is the rooms designated for mothers giving birth, reflecting the belief in Thien Hau as a protector of women and children.</li>
</ul>
<p>
    This hall remains an important place of worship not only for the Fujian Chinese community but also for many local Vietnamese people to this day. Traditional holidays and festivals are held here, showcasing the rich culture and traditions of Fujian.
</p>
<p>
    The Fujian Assembly Hall is not only an architectural masterpiece but also a living testament to the history of the Chinese community in Hoi An, its immense contribution to the city's development, and the careful preservation of cultural traditions. Its visit is a must for those who want to truly understand the multifaceted heritage of Hoi An Ancient Town.
</p>
    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},ru:{title:"  ",description:"  ,    1690 .",fullDescription:`
<p>
                 ,      <strong>   (Hi Qun Phc Kin)</strong>.    ;          ,          .
</p>
<p>
      ,    1690 ,              XVII ,    .      <strong> </strong>, - , ,  ,    .  ,         ,      .     ,        .
</p>

<h6>    </h6>
<p>
                  .     ,       :
</p>
<ul>
    <li>       ,     .</li>
    <li>                  .</li>
    <li>     ,       .  ,    ,   .</li>
    <li>    ,     ,   ,      .</li>
</ul>
<p>
          ,    .      ,  ,      ,      .       , , , , ,        .         ;     .
</p>

<h6>    </h6>
<p>
     ,       :
</p>
<ul>
    <li>   ,  ,     .        ,       .</li>
    <li>   ,   ,           .</li>
</ul>
<p>
                  ,      .      ,      .
</p>
<p>
            ,         ,           .     ,   -      .
</p>
    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},es:{title:"Sala de Asamblea Fujian",description:"Originalmente un pequeo santuario construido por los vietnamitas alrededor de 1690.",fullDescription:`
<p>
    Si quieres ver la sala de asamblea china ms vibrante y ricamente decorada en Hoi An, entonces tu camino te lleva a la <strong>Sala de Asamblea Fujian (Hi Qun Phc Kin)</strong>. Esto no es solo un templo; es una verdadera obra de arte y un testimonio vivo de la prosperidad de la comunidad china que desempe un papel enorme en el establecimiento de Hoi An como puerto comercial.
</p>
<p>
    Originalmente un pequeo santuario construido por los vietnamitas alrededor de 1690, fue adquirido y reconstruido por la influyente comunidad china de la provincia de Fujian a finales del siglo XVII, convirtindolo en su centro principal. Desde entonces, ha estado dedicado a <strong>Thien Hau</strong>, la Diosa Madre del Mar, conocida por proteger a marineros y comerciantes. Esto explica por qu esta sala era tan importante para los comerciantes de Fujian que llegaban a Hoi An a travs de mares turbulentos. La sala ha sido ampliada y restaurada numerosas veces, lo que solo enfatiza el poder y la riqueza de esta comunidad.
</p>

<h6>Grandeza Arquitectnica y Smbolos de Prosperidad</h6>
<p>
    La Sala de Asamblea Fujian impresiona por su belleza y arquitectura tradicional china con una fuerte influencia del estilo Fujian. El complejo tiene una estructura de templo clsica que te llevar a travs de una serie de espacios impresionantes:
</p>
<ul>
    <li>Sers recibido por las grandes Puertas Principales con tres entradas, adornadas con intrincadas tallas y estatuas.</li>
    <li>Ms all de las puertas hay un espacioso Patio Delantero con una fuente y elementos decorativos  un lugar ideal para comenzar tu exploracin de la sala.</li>
    <li>Luego, entrars a la Sala Principal, donde se encuentra el altar principal a la Diosa Thien Hau. Su estatua, a menudo rodeada de otras deidades, domina el espacio.</li>
    <li>El complejo tambin incluye una Sala Trasera, dedicada a otras deidades y ancestros, y Salas Laterales, que se utilizaban para diversas necesidades comunitarias.</li>
</ul>
<p>
    Todo el edificio est construido de madera y piedra, con un tejado de tejas tradicional. El interior est literalmente inmerso en colores brillantes, piezas lacadas, exquisitas tallas de madera y piedra, as como estatuas y mosaicos de cermica. Vers tallas increblemente detalladas que representan dragones, fnix, unicornios, leones, flores, frutas y escenas de la mitologa e historia chinas. Los colores predominantes  rojo y dorado  no son una coincidencia; simbolizan la buena suerte y la prosperidad.
</p>

<h6>Detalles nicos y Significado Cultural</h6>
<p>
    Entre otras cosas, la Sala de Asamblea Fujian tiene varios detalles nicos:
</p>
<ul>
    <li>Encontrars muchas estatuas que representan deidades, criaturas mticas y figuras histricas. Destacan particularmente las estatuas de los seis ancestros de la familia Tran, quienes hicieron contribuciones significativas a la construccin de la sala.</li>
    <li>Una caracterstica nica son las habitaciones designadas para las madres que dan a luz, lo que refleja la creencia en Thien Hau como protectora de mujeres y nios.</li>
</ul>
<p>
    Esta sala sigue siendo un importante lugar de culto no solo para la comunidad china de Fujian, sino tambin para muchos vietnamitas locales hasta el da de hoy. Aqu se celebran fiestas y festivales tradicionales, mostrando la rica cultura y tradiciones de Fujian.
</p>
<p>
    La Sala de Asamblea Fujian no es solo una obra maestra arquitectnica, sino tambin un testimonio vivo de la historia de la comunidad china en Hoi An, su inmensa contribucin al desarrollo de la ciudad y la cuidadosa preservacin de las tradiciones culturales. Su visita es obligatoria para aquellos que quieran comprender verdaderamente el patrimonio multifactico del Casco Antiguo de Hoi An.
</p>
    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},fr:{title:"Salle de l'Assemble de Fujian",description:" l'origine un petit sanctuaire construit par les Vietnamiens vers 1690.",fullDescription:`
<p>
    Si vous voulez voir la salle d'assemble chinoise la plus vibrante et richement dcore de Hoi An, alors votre chemin mne  la <strong>Salle de l'Assemble de Fujian (Hi Qun Phc Kin)</strong>. Ce n'est pas seulement un temple ; c'est une vritable uvre d'art et un tmoignage vivant de la prosprit de la communaut chinoise qui a jou un rle norme dans l'tablissement de Hoi An comme port de commerce.
</p>
<p>
     l'origine un petit sanctuaire construit par les Vietnamiens vers 1690, il a t acquis et reconstruit par l'influente communaut chinoise de la province de Fujian  la fin du XVIIe sicle, en faisant leur centre principal. Depuis lors, il est ddi  <strong>Thien Hau</strong>, la Desse Mre de la Mer, qui est connue pour protger les marins et les marchands. Cela explique pourquoi cette salle tait si importante pour les marchands de Fujian arrivant  Hoi An  travers des mers tumultueuses. La salle a t agrandie et restaure de nombreuses fois, ce qui ne fait que souligner le pouvoir et la richesse de cette communaut.
</p>

<h6>Grandeur architecturale et symboles de prosprit</h6>
<p>
    La Salle de l'Assemble de Fujian impressionne par sa beaut et son architecture chinoise traditionnelle avec une forte influence du style Fujian. Le complexe a une structure de temple classique qui vous guidera  travers une srie d'espaces impressionnants :
</p>
<ul>
    <li>Vous serez accueillis par de grandes Portes Principales  trois entres, ornes de sculptures complexes et de statues.</li>
    <li>Au-del des portes se trouve une spacieuse Cour Avant avec une fontaine et des lments dcoratifs  un endroit idal pour commencer votre exploration de la salle.</li>
    <li>Ensuite, vous entrerez dans le Hall Principal, o se trouve l'autel principal de la Desse Thien Hau. Sa statue, souvent entoure d'autres divinits, domine l'espace.</li>
    <li>Le complexe comprend galement un Hall Arrire, ddi  d'autres divinits et anctres, et des Chambres Latrales, qui taient utilises pour divers besoins communautaires.</li>
</ul>
<p>
    Tout le btiment est construit en bois et en pierre, avec un toit de tuiles traditionnel. L'intrieur est littralement immerg dans des couleurs vives, des pices laques, des sculptures exquises sur bois et pierre, ainsi que des statues et mosaques en cramique. Vous verrez des sculptures incroyablement dtailles reprsentant des dragons, des phnix, des licornes, des lions, des fleurs, des fruits et des scnes de la mythologie et de l'histoire chinoises. Les couleurs prdominantes  rouge et or  ne sont pas un hasard ; elles symbolisent la chance et la prosprit.
</p>

<h6>Dtails uniques et signification culturelle</h6>
<p>
    Entre autres choses, la Salle de l'Assemble de Fujian prsente plusieurs dtails uniques :
</p>
<ul>
    <li>Vous trouverez de nombreuses statues reprsentant des divinits, des cratures mythiques et des figures historiques. Les statues des six anctres de la famille Tran, qui ont apport une contribution significative  la construction de la salle, sont particulirement remarquables.</li>
    <li>Une caractristique unique est les pices dsignes pour les mres qui accouchent, refltant la croyance en Thien Hau comme protectrice des femmes et des enfants.</li>
</ul>
<p>
    Cette salle reste un lieu de culte important non seulement pour la communaut chinoise de Fujian, mais aussi pour de nombreux Vietnamiens locaux  ce jour. Des ftes et festivals traditionnels y sont organiss, mettant en valeur la richesse de la culture et des traditions de Fujian.
</p>
<p>
    La Salle de l'Assemble de Fujian n'est pas seulement un chef-d'uvre architectural, mais aussi un tmoignage vivant de l'histoire de la communaut chinoise  Hoi An, de son immense contribution au dveloppement de la ville et de la prservation minutieuse des traditions culturelles. Sa visite est un incontournable pour ceux qui veulent vraiment comprendre le patrimoine multiforme de la Vieille Ville de Hoi An.
</p>
    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},vn:{title:"Hi Qun Phc Kin",description:"Ban u l mt ngi miu nh c ngi Vit xy dng khong nm 1690.",fullDescription:`
<p>
    Nu bn mun chim ngng hi qun Trung Quc rc r v trang tr phong ph nht  Hi An, th con ng ca bn dn n <strong>Hi Qun Phc Kin (Hi Qun Phc Kin)</strong>. y khng ch l mt ngi n;  l mt tc phm ngh thut thc s v l minh chng sng ng cho s thnh vng ca cng ng ngi Hoa  ng gp to ln vo vic hnh thnh Hi An thnh mt thng cng.
</p>
<p>
    Ban u l mt ngi miu nh c ngi Vit xy dng khong nm 1690, n  c cng ng ngi Hoa c nh hng t tnh Phc Kin mua li v xy dng li vo cui th k 17, bin n thnh trung tm chnh ca h. K t , n  c dnh ring cho <strong>Thin Hu</strong>, Thin Hu Thnh Mu, ngi c bit n l bo v cc thy th v thng nhn. iu ny gii thch ti sao hi qun ny li rt quan trng i vi cc thng nhn Phc Kin n Hi An vt qua nhng vng bin y sng gi. Hi qun  c m rng v phc hi nhiu ln, iu ny ch nhn mnh sc mnh v s giu c ca cng ng ny.
</p>

<h6>Kin trc trng l v biu tng ca s thnh vng</h6>
<p>
    Hi Qun Phc Kin gy n tng vi v p v kin trc truyn thng Trung Quc vi nh hng mnh m ca phong cch Phc Kin. Khu phc hp c cu trc n th c in s dn bn qua mt lot cc khng gian n tng:
</p>
<ul>
    <li>Bn s c cho n bi Cng Chnh ln vi ba li vo, c trang tr bng nhng chm khc v tng tinh xo.</li>
    <li>Bn ngoi cng l mt Sn Trc rng ri vi i phun nc v cc yu t trang tr  mt ni l tng  bt u khm ph hi qun.</li>
    <li>Tip theo, bn s vo Chnh in, ni t bn th chnh th Thin Hu Thnh Mu. Tng ca b, thng c bao quanh bi cc v thn khc, chim u th trong khng gian.</li>
    <li>Khu phc hp cng bao gm Hu in, dnh ring cho cc v thn v t tin khc, v cc Phng Ph, c s dng cho cc nhu cu cng ng khc nhau.</li>
</ul>
<p>
    Ton b ta nh c xy dng bng g v , vi mi ngi truyn thng. Ni tht c trang tr rc r vi cc tc phm sn mi, chm khc g v  tinh xo, cng nh cc bc tng gm v tranh ghp. Bn s thy nhng chm khc v cng chi tit miu t rng, phng hong, k ln, s t, hoa, tri cy v cc cnh trong thn thoi v lch s Trung Quc. Cc mu sc ch o   v vng  khng phi ngu nhin; chng tng trng cho may mn v thnh vng.
</p>

<h6>Chi tit c o v  ngha vn ha</h6>
<p>
    Trong s nhng iu khc, Hi Qun Phc Kin c mt s chi tit c o:
</p>
<ul>
    <li>Bn s tm thy nhiu bc tng m t cc v thn, sinh vt thn thoi v nhn vt lch s. c bit ng ch  l cc bc tng su t ca gia nh Trn, nhng ngi  c ng gp ng k vo vic xy dng hi qun.</li>
    <li>Mt c im c o l cc phng dnh cho cc b m sinh con, phn nh nim tin vo Thin Hu l ngi bo v ph n v tr em.</li>
</ul>
<p>
    Hi qun ny vn l mt ni th cng quan trng khng ch i vi cng ng ngi Hoa Phc Kin m cn i vi nhiu ngi dn a phng Vit Nam cho n ngy nay. Cc ngy l v l hi truyn thng c t chc ti y, th hin vn ha v truyn thng phong ph ca ngi Phc Kin.
</p>
<p>
    Hi Qun Phc Kin khng ch l mt kit tc kin trc m cn l mt minh chng sng ng cho lch s ca cng ng ngi Hoa  Hi An, nhng ng gp to ln ca h vo s pht trin ca thnh ph v vic bo tn cn thn cc truyn thng vn ha. Vic gh thm ni y l iu bt buc i vi nhng ai mun thc s hiu di sn a din ca Ph c Hi An.
</p>
    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},slug:{en:"fujian-assembly-hall",ru:"sbornyy-zal-futszyan",es:"sala-asamblea-fujian",fr:"salle-assemblee-fujian",vn:"hoi-quan-phuoc-kien"}},{id:"quan-cong-temple",coordinates:[15.87753059676167,108.33137596808865],category:["museum"],imageUrl:"15.jpg",en:{title:"Quan Cong Temple / Ong Pagoda",description:"The temple is dedicated to the legendary General Quan Cong (Guan Yu).",fullDescription:`
<p>
    If you're looking for a place where the spirit of ancient trade and deep beliefs intertwine, your path leads to the <strong>Quan Cong Temple</strong>, also known as Ong Pagoda. This is not just a temple; it's one of Hoi An's oldest and most significant shrines, built in distant 1653 by Chinese communities, primarily from Fujian and Hainan.
</p>
<p>
    The temple is dedicated to the legendary General <strong>Quan Cong (Guan Yu)</strong>, who lived in China during the Three Kingdoms period (2nd-3rd century AD). Quan Cong is revered as the epitome of loyalty, righteousness, honesty, courage, and strength. He became a symbol of protection against evil and misfortune, and it was to him that Hoi An businessmen and merchants came to pray for good fortune in trade, prosperity, and the safe return of their ships. His image is so important that he is also worshipped by the Chinese community in modern Ho Chi Minh City. Quan Cong Temple has been repeatedly reconstructed over the centuries, preserving its original structure and splendor. In 1991, it was recognized as a National Cultural and Historical Heritage of Vietnam.
</p>

<h6>Architectural Grandeur and Hidden Details</h6>
<p>
    Quan Cong Temple is a vivid example of Chinese temple architecture, full of distinctive features and rich decoration:
</p>
<img src="41.jpg" alt="Quan Cong Temple / Ong Pagoda"/>
<small>The green dragons carved on the entrance door of Ong Pagoda are the embodiment of Quan Cong.</small>
<ul>
    <li>Entry to the temple is through impressive <strong>Triple Gates</strong> adorned with colorful patterns. On either side of the gates stand figures of guardians or majestic guardian lions.</li>
    <li>Passing through the gates, you'll enter a beautiful courtyard with a pond, decorated with water lilies and an elegant bridge. There may also be old trees here, giving the place a special atmosphere of tranquility.</li>
    <li>The central place is occupied by the Main Worship Hall, where a large and impressive statue of General Quan Cong is located. You'll recognize him by his red face, long beard, and distinctive attire. On either side of him are usually statues of his loyal followers: General Zhou Cang (with a green face) and adopted son Guan Ping.</li>
    <li>The altars are richly decorated with lacquered and gilded wooden artifacts, ceramics, and ritual offerings. Giant incense coils hang from the ceiling, creating a mysterious haze.</li>
    <li>The temple is famous for its intricate wood carvings depicting dragons, phoenixes, mythical creatures, as well as scenes from Chinese mythology and classical novels. You'll see many frescoes and bas-reliefs.</li>
</ul>
<p>
    There are also very interesting side rooms:
</p>
<img src="40.jpg" alt="Quan Cong Temple / Ong Pagoda"/>
<ul>
    <li>In the left room, there is an altar dedicated to the patron of trade and prosperity.</li>
    <li>And on the right is a sanctuary dedicated to Quan Cong's famous horse, known as the "Red Hare," which was famous for its incredible speed. Its statue here is an important element.</li>
</ul>

<h6>A Living Museum of Spiritual Beliefs</h6>
<p>
    Quan Cong Temple is an active place of worship for local residents, especially for the Chinese diaspora and Vietnamese. It is often visited by businessmen to ask for blessings for honest and successful trade. The temple also serves as a center for various traditional Chinese and Vietnamese festivals, including Lunar New Year, which are accompanied by rituals, music, and dances (for example, the famous lion dance).
</p>
<img src="42.jpg" alt="Quan Cong Temple / Ong Pagoda"/>
<small>Historical antiquities remain untouched at Ong Pagoda in Hoi An after more than 300 years</small>
<p>
    If you are going to visit only one assembly hall in Hoi An, it might be worth choosing the Cantonese Assembly Hall  it truly impresses with its scale and decorations. However, Quan Cong Temple is a unique living museum that provides a deep understanding of Hoi An's rich history, trade connections, and cultural exchange, as well as the spiritual beliefs that shaped the lives of its inhabitants for centuries. Visiting this temple is an integral part of getting to know the Ancient Town of Hoi An.
</p>
    `,internalImageNames:["40.jpg","42.jpg","41.jpg"]},ru:{title:"   /  ",description:"      ( ).",fullDescription:`
<p>
       ,        ,     <strong>  </strong>,     .    ;         ,    1653   ,     .
</p>
<p>
        <strong>  ( )</strong>,       (II-III  ..).      , , ,   .        ,         ,      ,      .    ,         .        ,      .  1991      -  .
</p>

<h6>    </h6>
<p>
            ,      :
</p>
<img src="41.jpg" alt="   /  "/>
<small> ,      ,    .</small>
<ul>
    <li>      <strong> </strong>,   .          -.</li>
    <li>  ,        ,      .      ,     .</li>
    <li>     ,         .      ,     .           :    (  )     .</li>
    <li>       ,    .      ,   .</li>
    <li>      ,  , ,  ,         .      .</li>
</ul>
<p>
         :
</p>
<img src="40.jpg" alt="   /  "/>
<ul>
    <li>    ,     .</li>
    <li>   ,     ,    ,     .      .</li>
</ul>

<h6>   </h6>
<p>
             ,      .    ,        .           ,    ,   ,    (,   ).
</p>
<img src="42.jpg" alt="   /  "/>
<small>           300 </small>
<p>
             , ,             .         ,       ,     ,    ,        .           .
</p>
    `,internalImageNames:["40.jpg","42.jpg","41.jpg"]},es:{title:"Templo de Quan Cong / Pagoda Ong",description:"El templo est dedicado al legendario General Quan Cong (Guan Yu).",fullDescription:`
<p>
    Si buscas un lugar donde el espritu del comercio antiguo y las creencias profundas se entrelazan, tu camino te lleva al <strong>Templo de Quan Cong</strong>, tambin conocido como Pagoda Ong. Este no es solo un templo; es uno de los santuarios ms antiguos y significativos de Hoi An, construido en el lejano 1653 por comunidades chinas, principalmente de Fujian y Hainan.
</p>
<p>
    El templo est dedicado al legendario General <strong>Quan Cong (Guan Yu)</strong>, quien vivi en China durante el perodo de los Tres Reinos (siglos II-III d.C.). Quan Cong es venerado como el eptome de la lealtad, la rectitud, la honestidad, el coraje y la fuerza. Se convirti en un smbolo de proteccin contra el mal y la desgracia, y a l acudan los empresarios y comerciantes de Hoi An para orar por buena fortuna en el comercio, prosperidad y el regreso seguro de sus barcos. Su imagen es tan importante que tambin es adorado por la comunidad china en la moderna Ciudad Ho Chi Minh. El Templo de Quan Cong ha sido reconstruido repetidamente a lo largo de los siglos, conservando su estructura original y esplendor. En 1991, fue reconocido como Patrimonio Cultural e Histrico Nacional de Vietnam.
</p>

<h6>Grandeza Arquitectnica y Detalles Ocultos</h6>
<p>
    El Templo de Quan Cong es un vvido ejemplo de la arquitectura de templos chinos, llena de caractersticas distintivas y rica decoracin:
</p>
<img src="41.jpg" alt="Templo de Quan Cong / Pagoda Ong"/>
<small>Los dragones verdes tallados en la puerta de entrada de la Pagoda Ong son la encarnacin de Quan Cong.</small>
<ul>
    <li>La entrada al templo es a travs de impresionantes <strong>Puertas Triples</strong> adornadas con coloridos patrones. A cada lado de las puertas se encuentran figuras de guardianes o majestuosos leones guardianes.</li>
    <li>Pasando por las puertas, entrars a un hermoso patio con un estanque, decorado con nenfares y un elegante puente. Tambin puede haber rboles viejos aqu, lo que le da al lugar una atmsfera especial de tranquilidad.</li>
    <li>El lugar central lo ocupa el Saln Principal de Adoracin, donde se encuentra una estatua grande e impresionante del General Quan Cong. Lo reconocers por su cara roja, barba larga y atuendo distintivo. A cada lado de l suelen estar estatuas de sus leales seguidores: el General Zhou Cang (con una cara verde) y su hijo adoptivo Guan Ping.</li>
    <li>Los altares estn ricamente decorados con artefactos de madera lacados y dorados, cermica y ofrendas rituales. Grandes espirales de incienso cuelgan del techo, creando una neblina misteriosa.</li>
    <li>El templo es famoso por sus intrincadas tallas de madera que representan dragones, fnix, criaturas mticas, as como escenas de la mitologa china y novelas clsicas. Vers muchos frescos y bajorrelieves.</li>
</ul>
<p>
    Tambin hay salas laterales muy interesantes:
</p>
<img src="40.jpg" alt="Templo de Quan Cong / Pagoda Ong"/>
<ul>
    <li>En la sala izquierda, hay un altar dedicado al patrn del comercio y la prosperidad.</li>
    <li>Y a la derecha hay un santuario dedicado al famoso caballo de Quan Cong, conocido como el "Liebre Roja", que era famoso por su increble velocidad. Su estatua aqu es un elemento importante.</li>
</ul>

<h6>Un Museo Viviente de Creencias Espirituales</h6>
<p>
    El Templo de Quan Cong es un lugar de culto activo para los residentes locales, especialmente para la dispora china y vietnamita. A menudo es visitado por empresarios para pedir bendiciones para un comercio honesto y exitoso. El templo tambin sirve como centro para varios festivales tradicionales chinos y vietnamitas, incluido el Ao Nuevo Lunar, que se acompaan de rituales, msica y bailes (por ejemplo, la famosa danza del len).
</p>
<img src="42.jpg" alt="Templo de Quan Cong / Pagoda Ong"/>
<small>Las antigedades histricas permanecen intactas en la Pagoda Ong en Hoi An despus de ms de 300 aos</small>
<p>
    Si vas a visitar solo una sala de asamblea en Hoi An, podra valer la pena elegir la Sala de Asamblea Cantonesa, realmente impresiona por su escala y decoraciones. Sin embargo, el Templo de Quan Cong es un museo viviente nico que proporciona una comprensin profunda de la rica historia de Hoi An, las conexiones comerciales y el intercambio cultural, as como las creencias espirituales que dieron forma a la vida de sus habitantes durante siglos. Visitar este templo es una parte integral para conocer el Casco Antiguo de Hoi An.
</p>
    `,internalImageNames:["40.jpg","42.jpg","41.jpg"]},fr:{title:"Temple de Quan Cong / Pagode Ong",description:"Le temple est ddi au lgendaire Gnral Quan Cong (Guan Yu).",fullDescription:`
<p>
    Si vous cherchez un lieu o l'esprit du commerce ancien et les croyances profondes s'entremlent, votre chemin mne au <strong>Temple de Quan Cong</strong>, galement connu sous le nom de Pagode Ong. Ce n'est pas seulement un temple ; c'est l'un des sanctuaires les plus anciens et les plus importants de Hoi An, construit en 1653 par des communauts chinoises, principalement du Fujian et de Hainan.
</p>
<p>
    Le temple est ddi au lgendaire Gnral <strong>Quan Cong (Guan Yu)</strong>, qui a vcu en Chine pendant la priode des Trois Royaumes (IIe-IIIe sicle aprs J.-C.). Quan Cong est vnr comme l'incarnation de la loyaut, de la droiture, de l'honntet, du courage et de la force. Il est devenu un symbole de protection contre le mal et le malheur, et c'est  lui que les hommes d'affaires et les marchands de Hoi An venaient prier pour la bonne fortune dans le commerce, la prosprit et le retour en toute scurit de leurs navires. Son image est si importante qu'il est galement vnr par la communaut chinoise dans la ville moderne de H Chi Minh. Le Temple de Quan Cong a t reconstruit  plusieurs reprises au cours des sicles, conservant sa structure et sa splendeur d'origine. En 1991, il a t reconnu comme patrimoine culturel et historique national du Vietnam.
</p>

<h6>Grandeur architecturale et dtails cachs</h6>
<p>
    Le Temple de Quan Cong est un exemple frappant de l'architecture de temple chinois, pleine de caractristiques distinctives et d'une riche dcoration :
</p>
<img src="41.jpg" alt="Temple de Quan Cong / Pagode Ong"/>
<small>Les dragons verts sculpts sur la porte d'entre de la Pagode Ong sont l'incarnation de Quan Cong.</small>
<ul>
    <li>L'entre du temple se fait par d'impressionnantes <strong>Portes Triples</strong> ornes de motifs colors. De chaque ct des portes se dressent des figures de gardiens ou de majestueux lions gardiens.</li>
    <li>En passant les portes, vous entrerez dans une belle cour avec un tang, dcor de nnuphars et d'un lgant pont. Il peut galement y avoir de vieux arbres ici, donnant au lieu une atmosphre particulire de tranquillit.</li>
    <li>La place centrale est occupe par le Hall Principal de Culte, o se trouve une grande et impressionnante statue du Gnral Quan Cong. Vous le reconnatrez  son visage rouge, sa longue barbe et sa tenue distinctive. De chaque ct de lui se trouvent gnralement des statues de ses fidles partisans : le Gnral Zhou Cang (au visage vert) et son fils adoptif Guan Ping.</li>
    <li>Les autels sont richement dcors d'artefacts en bois laqus et dors, de cramiques et d'offrandes rituelles. Des bobines d'encens gantes pendent du plafond, crant une brume mystrieuse.</li>
    <li>Le temple est clbre pour ses sculptures complexes sur bois reprsentant des dragons, des phnix, des cratures mythiques, ainsi que des scnes de la mythologie chinoise et des romans classiques. Vous verrez de nombreuses fresques et bas-reliefs.</li>
</ul>
<p>
    Il y a aussi des pices latrales trs intressantes :
</p>
<img src="40.jpg" alt="Temple de Quan Cong / Pagode Ong"/>
<ul>
    <li>Dans la pice de gauche, il y a un autel ddi au patron du commerce et de la prosprit.</li>
    <li>Et  droite se trouve un sanctuaire ddi au clbre cheval de Quan Cong, connu sous le nom de "Livre Rouge", qui tait clbre pour son incroyable vitesse. Sa statue ici est un lment important.</li>
</ul>

<h6>Un muse vivant des croyances spirituelles</h6>
<p>
    Le Temple de Quan Cong est un lieu de culte actif pour les rsidents locaux, en particulier pour la diaspora chinoise et vietnamienne. Il est souvent visit par les hommes d'affaires pour demander des bndictions pour un commerce honnte et fructueux. Le temple sert galement de centre pour divers festivals traditionnels chinois et vietnamiens, y compris le Nouvel An lunaire, qui sont accompagns de rituels, de musique et de danses (par exemple, la clbre danse du lion).
</p>
<img src="42.jpg" alt="Temple de Quan Cong / Pagode Ong"/>
<small>Les antiquits historiques restent intactes  la Pagode Ong  Hoi An aprs plus de 300 ans</small>
<p>
    Si vous ne deviez visiter qu'une seule salle d'assemble  Hoi An, il pourrait tre intressant de choisir la Salle de l'Assemble cantonaise  elle impressionne vraiment par son ampleur et ses dcorations. Cependant, le Temple de Quan Cong est un muse vivant unique qui offre une comprhension profonde de la riche histoire de Hoi An, des liens commerciaux et des changes culturels, ainsi que des croyances spirituelles qui ont faonn la vie de ses habitants pendant des sicles. La visite de ce temple est une partie intgrante de la dcouverte de la Vieille Ville de Hoi An.
</p>
    `,internalImageNames:["40.jpg","42.jpg","41.jpg"]},vn:{title:"Cha ng / Miu Quan Cng",description:"Ngi n th v tng huyn thoi Quan Cng (Guan Yu).",fullDescription:`
<p>
    Nu bn ang tm kim mt ni m tinh thn thng mi c xa v tn ngng su sc ha quyn vo nhau, con ng ca bn s dn n <strong>Cha ng</strong>, cn c gi l Miu Quan Cng. y khng ch l mt ngi n;  l mt trong nhng miu th c knh v quan trng nht ca Hi An, c xy dng vo nm 1653 bi cc cng ng ngi Hoa, ch yu t Phc Kin v Hi Nam.
</p>
<p>
    Ngi n th v tng huyn thoi <strong>Quan Cng (Quan V)</strong>, ngi sng  Trung Quc trong thi Tam Quc (th k 2-3 sau Cng nguyn). Quan Cng c tn knh l hnh mu ca lng trung thnh, chnh ngha, trung thc, dng cm v sc mnh. ng tr thnh biu tng ca s bo v chng li ci c v iu khng may, v cc doanh nhn, thng nhn Hi An  n y  cu nguyn cho may mn trong kinh doanh, thnh vng v s tr v an ton ca tu thuyn. Hnh nh ca ng rt quan trng n ni ng cng c cng ng ngi Hoa  Thnh ph H Ch Minh hin i th cng. Cha ng  c trng tu nhiu ln qua cc th k, bo tn cu trc v v lng ly ban u ca n. Nm 1991, n c cng nhn l Di sn Vn ha v Lch s Quc gia Vit Nam.
</p>

<h6>Kin trc trng l v nhng chi tit n</h6>
<p>
    Cha ng l mt v d sng ng v kin trc n th Trung Quc, y nhng nt c trng v trang tr phong ph:
</p>
<img src="41.jpg" alt="Cha ng / Miu Quan Cng"/>
<small>Nhng con rng xanh c chm khc trn ca vo Cha ng l hin thn ca Quan Cng.</small>
<ul>
    <li>Li vo cha qua <strong>Tam Quan</strong> n tng c trang tr bng cc ha tit y mu sc. Hai bn cng l tng cc v thn h php hoc nhng con s t  uy nghi.</li>
    <li>i qua cng, bn s vo mt sn trong xinh p vi mt h nc, c trang tr bng hoa sng v mt cy cu duyn dng. Cng c th c nhng cy c th  y, to cho ni y mt bu khng kh yn bnh c bit.</li>
    <li>V tr trung tm l Chnh in, ni t bc tng ln v n tng ca Tng Quan Cng. Bn s nhn ra ng qua khun mt , b ru di v trang phc c trng. Hai bn ng thng l tng cc ty tng trung thnh ca ng: Tng Chu Thng (vi khun mt xanh) v con nui Quan Bnh.</li>
    <li>Cc bn th c trang tr phong ph vi cc tc phm g sn mi v m vng, gm s v cc vt phm cng dng nghi l. Nhng vng hng ln treo trn trn nh, to ra mt ln khi huyn o.</li>
    <li>Ngi n ni ting vi nhng chm khc g tinh xo m t rng, phng, k ln, s t, cng nh cc cnh trong thn thoi Trung Quc v cc tiu thuyt c in. Bn s thy nhiu bc bch ha v ph iu.</li>
</ul>
<p>
    Ngoi ra cn c nhng phng ph rt th v:
</p>
<img src="40.jpg" alt="Cha ng / Miu Quan Cng"/>
<ul>
    <li>Trong phng bn tri, c mt bn th dnh cho v thn bo tr thng mi v thnh vng.</li>
    <li>V bn phi l mt in th dnh cho con nga ni ting ca Quan Cng, c gi l "Xch Th", ni ting vi tc  ng kinh ngc. Bc tng ca n  y l mt yu t quan trng.</li>
</ul>

<h6>Bo tng sng ca tn ngng tm linh</h6>
<p>
    Cha ng l mt ni th cng tch cc ca ngi dn a phng, c bit l i vi cng ng ngi Hoa v ngi Vit. N thng c cc doanh nhn gh thm  cu xin phc lnh cho mt hot ng kinh doanh trung thc v thnh cng. Ngi n cng phc v nh mt trung tm cho cc l hi truyn thng khc nhau ca Trung Quc v Vit Nam, bao gm Tt Nguyn n, i km vi cc nghi l, m nhc v v iu (v d, ma ln ni ting).
</p>
<img src="42.jpg" alt="Cha ng / Miu Quan Cng"/>
<small>Nhng c vt lch s vn cn nguyn vn ti Cha ng  Hi An sau hn 300 nm</small>
<p>
    Nu bn ch nh thm mt hi qun  Hi An, c l nn chn Hi Qun Qung ng  n thc s gy n tng vi quy m v cc  trang tr ca n. Tuy nhin, Cha ng l mt bo tng sng c o mang li s hiu bit su sc v lch s phong ph ca Hi An, cc mi lin kt thng mi v trao i vn ha, cng nh cc tn ngng tm linh  nh hnh cuc sng ca c dn ni y trong nhiu th k. Gh thm ngi n ny l mt phn khng th thiu  tm hiu v Ph c Hi An.
</p>
    `,internalImageNames:["40.jpg","42.jpg","41.jpg"]},slug:{en:"quan-cong-temple",ru:"khram-quan-tsong",es:"templo-quan-cong",fr:"temple-quan-cong",vn:"chua-ong"}},{id:"museum-of-traditional-medicine",coordinates:[15.876645447545563,108.32985812007384],category:["museum"],imageUrl:"16.jpg",en:{title:"Museum of Traditional Medicine",description:"The main goal of the museum is to show how traditional medicine developed in Hoi An.",fullDescription:`
<p>
    If you've ever dreamed of learning how illnesses were treated centuries ago, or simply want to touch the wisdom of ancient healers, then you absolutely must visit the <strong>Museum of Traditional Medicine in Hoi An</strong>. This relatively new but very informative museum opened on March 15, 2019, becoming a true gift for the 44th anniversary of the Hoi An revolution and the 20th anniversary of the city's inclusion on the UNESCO World Heritage list.
</p>
<p>
    The museum is located in a restored old house. The building itself, with its two floors, is already part of Hoi An's history. The main goal of the museum is to show how traditional medicine developed in Hoi An, combining Vietnamese and Chinese cultural practices.
</p>

<h6>From a Chinese Pharmacy to Vietnamese Secrets: What's Inside?</h6>
<p>
    The Museum of Traditional Medicine is a true treasure trove, housing over 200 artifacts, each telling its own story:
</p>
<ul>
    <li><strong>The first floor</strong> will transport you directly into a classic Chinese pharmacy of centuries past. Here you can see what a doctor looked like at work, examine a huge wooden cabinet with 108 (!) different types of medicines, as well as bamboo trays on which medicinal plants and seeds were once dried. It's like stepping into a scene from an old movie!</li>
    <li><strong>The second floor</strong> is entirely dedicated to traditional Vietnamese medicine. Here you'll learn about its unique features and secrets.</li>
</ul>
<p>
    Among the most interesting exhibits and opportunities at the museum:
</p>
<ul>
    <li>You can see how a doctor checks pulses and writes prescriptions  it's very interesting and informative!</li>
    <li>Old medicine pouches and photos of medicinal plants with their names in Vietnamese and English are presented. You'll be able to understand which herbs were used for treatment.</li>
    <li>Be sure to pay attention to the information about Tue Tinh (1330-1400)  he is considered the true ancestor of Vietnamese medicine.</li>
</ul>

<h6>Why Visit?</h6>
<p>
    Visiting the Museum of Traditional Medicine is not only an opportunity to learn a lot about ancient healing methods but also a chance to immerse yourself in Hoi An's cultural heritage, which has always been closely linked to trade and the exchange of knowledge, including medical knowledge. It offers a fresh perspective on the city's history, which is revealed here through the prism of health and well-being.
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},ru:{title:"  ",description:"    ,      .",fullDescription:`
<p>
      -  ,     ,        ,      <strong>    </strong>.   ,      15  2019 ,     44-     20-       .
</p>
<p>
         .  ,    ,     .     ,      ,      .
</p>

<h6>     :  ?</h6>
<p>
          ,   200 ,      :
</p>
<ul>
    <li><strong> </strong>         .   ,     ,      108 (!)   ,    ,   -     .      !</li>
    <li><strong> </strong>     .         .</li>
</ul>
<p>
          :
</p>
<ul>
    <li>  ,             !</li>
    <li>                .   ,     .</li>
    <li>        (13301400)       .</li>
</ul>

<h6>  ?</h6>
<p>
                   ,        ,          ,    .      ,        .
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},es:{title:"Museo de Medicina Tradicional",description:"El objetivo principal del museo es mostrar cmo se desarroll la medicina tradicional en Hoi An.",fullDescription:`
<p>
    Si alguna vez soaste con aprender cmo se trataban las enfermedades hace siglos, o simplemente quieres tocar la sabidura de los antiguos curanderos, entonces debes visitar el <strong>Museo de Medicina Tradicional en Hoi An</strong>. Este museo relativamente nuevo pero muy informativo se inaugur el 15 de marzo de 2019, convirtindose en un verdadero regalo para el 44 aniversario de la revolucin de Hoi An y el 20 aniversario de la inclusin de la ciudad en la lista del Patrimonio Mundial de la UNESCO.
</p>
<p>
    El museo est ubicado en una casa antigua restaurada. El edificio en s, con sus dos pisos, ya es parte de la historia de Hoi An. El objetivo principal del museo es mostrar cmo se desarroll la medicina tradicional en Hoi An, combinando prcticas culturales vietnamitas y chinas.
</p>

<h6>De una Farmacia China a los Secretos Vietnamitas: Qu hay dentro?</h6>
<p>
    El Museo de Medicina Tradicional es un verdadero tesoro, albergando ms de 200 artefactos, cada uno contando su propia historia:
</p>
<ul>
    <li><strong>El primer piso</strong> te transportar directamente a una farmacia china clsica de siglos pasados. Aqu puedes ver cmo era un mdico en el trabajo, examinar un enorme gabinete de madera con 108 (!) tipos diferentes de medicinas, as como bandejas de bamb en las que alguna vez se secaron plantas medicinales y semillas. Es como entrar en una escena de una pelcula antigua!</li>
    <li><strong>El segundo piso</strong> est completamente dedicado a la medicina tradicional vietnamita. Aqu aprenders sobre sus caractersticas y secretos nicos.</li>
</ul>
<p>
    Entre las exhibiciones y oportunidades ms interesantes del museo:
</p>
<ul>
    <li>Puedes ver cmo un mdico toma el pulso y escribe recetas  es muy interesante e informativo!</li>
    <li>Se presentan antiguas bolsas de medicamentos y fotos de plantas medicinales con sus nombres en vietnamita e ingls. Podrs entender qu hierbas se usaban para el tratamiento.</li>
    <li>Asegrate de prestar atencin a la informacin sobre Tue Tinh (1330-1400)  es considerado el verdadero antepasado de la medicina vietnamita.</li>
</ul>

<h6>Por qu Visitar?</h6>
<p>
    Visitar el Museo de Medicina Tradicional no solo es una oportunidad para aprender mucho sobre los mtodos de curacin antiguos, sino tambin una oportunidad para sumergirse en el patrimonio cultural de Hoi An, que siempre ha estado estrechamente vinculado al comercio y al intercambio de conocimientos, incluidos los conocimientos mdicos. Ofrece una perspectiva fresca sobre la historia de la ciudad, que se revela aqu a travs del prisma de la salud y el bienestar.
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},fr:{title:"Muse de la Mdecine Traditionnelle",description:"L'objectif principal du muse est de montrer comment la mdecine traditionnelle.",fullDescription:`
<p>
    Si vous avez toujours rv d'apprendre comment les maladies taient traites il y a des sicles, ou si vous voulez simplement toucher la sagesse des anciens gurisseurs, alors vous devez absolument visiter le <strong>Muse de la Mdecine Traditionnelle  Hoi An</strong>. Ce muse relativement nouveau mais trs instructif a ouvert ses portes le 15 mars 2019, devenant un vritable cadeau pour le 44e anniversaire de la rvolution de Hoi An et le 20e anniversaire de l'inscription de la ville sur la liste du patrimoine mondial de l'UNESCO.
</p>
<p>
    Le muse est situ dans une vieille maison restaure. Le btiment lui-mme, avec ses deux tages, fait dj partie de l'histoire de Hoi An. L'objectif principal du muse est de montrer comment la mdecine traditionnelle s'est dveloppe  Hoi An, combinant les pratiques culturelles vietnamiennes et chinoises.
</p>

<h6>D'une pharmacie chinoise aux secrets vietnamiens : Qu'y a-t-il  l'intrieur ?</h6>
<p>
    Le Muse de la Mdecine Traditionnelle est un vritable trsor, abritant plus de 200 artefacts, chacun racontant sa propre histoire :
</p>
<ul>
    <li><strong>Le premier tage</strong> vous transportera directement dans une pharmacie chinoise classique des sicles passs. Ici, vous pouvez voir  quoi ressemblait un mdecin au travail, examiner une immense armoire en bois avec 108 (!) types de mdicaments diffrents, ainsi que des plateaux en bambou sur lesquels des plantes mdicinales et des graines taient autrefois sches. C'est comme entrer dans une scne d'un vieux film !</li>
    <li><strong>Le deuxime tage</strong> est entirement ddi  la mdecine traditionnelle vietnamienne. Ici, vous apprendrez ses caractristiques et ses secrets uniques.</li>
</ul>
<p>
    Parmi les expositions et opportunits les plus intressantes du muse :
</p>
<ul>
    <li>Vous pouvez voir comment un mdecin prend le pouls et rdige des ordonnances  c'est trs intressant et instructif !</li>
    <li>De vieilles pochettes de mdicaments et des photos de plantes mdicinales avec leurs noms en vietnamien et en anglais sont prsentes. Vous pourrez comprendre quelles herbes taient utilises pour le traitement.</li>
    <li>Assurez-vous de prter attention aux informations sur Tue Tinh (1330-1400)  il est considr comme le vritable anctre de la mdecine vietnamienne.</li>
</ul>

<h6>Pourquoi visiter ?</h6>
<p>
    Visiter le Muse de la Mdecine Traditionnelle n'est pas seulement une occasion d'en apprendre beaucoup sur les anciennes mthodes de gurison, mais aussi une chance de vous immerger dans le patrimoine culturel de Hoi An, qui a toujours t troitement li au commerce et  l'change de connaissances, y compris mdicales. Il offre une nouvelle perspective sur l'histoire de la ville, qui est rvle ici  travers le prisme de la sant et du bien-tre.
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},vn:{title:"Bo Tng Y Hc C Truyn",description:"Mc tiu chnh ca bo tng l th hin s pht trin ca y hc c truyn ti Hi An.",fullDescription:`
<p>
    Nu bn tng m c c tm hiu cch cha bnh t nhiu th k trc, hoc n gin l mun chm vo tr tu ca cc thy thuc c xa, th bn nht nh phi gh thm <strong>Bo Tng Y Hc C Truyn  Hi An</strong>. Bo tng tng i mi nhng rt b ch ny  khai trng vo ngy 15 thng 3 nm 2019, tr thnh mt mn qu  ngha nhn k nim 44 nm cch mng Hi An v 20 nm thnh ph c a vo danh sch Di sn Th gii ca UNESCO.
</p>
<p>
    Bo tng nm trong mt ngi nh c  c phc hi. Bn thn ta nh, vi hai tng,  l mt phn lch s ca Hi An. Mc tiu chnh ca bo tng l th hin s pht trin ca y hc c truyn ti Hi An, kt hp cc thc hnh vn ha Vit Nam v Trung Quc.
</p>

<h6>T nh thuc Trung Hoa n b mt Vit Nam: C g bn trong?</h6>
<p>
    Bo Tng Y Hc C Truyn l mt kho tng thc s, lu gi hn 200 hin vt, mi th u k mt cu chuyn ring:
</p>
<ul>
    <li><strong>Tng mt</strong> s a bn trc tip vo mt nh thuc Trung Hoa c in ca nhng th k trc. Ti y, bn c th thy mt bc s trng nh th no khi lm vic, kim tra mt t g khng l vi 108 (!) loi thuc khc nhau, cng nh cc khay tre tng c dng  phi cc loi cy thuc v ht ging. C nh bc vo mt cnh trong phim c vy!</li>
    <li><strong>Tng hai</strong> hon ton dnh ring cho y hc c truyn Vit Nam. Ti y, bn s tm hiu v nhng c im v b mt c o ca n.</li>
</ul>
<p>
    Trong s nhng trin lm v c hi th v nht ti bo tng:
</p>
<ul>
    <li>Bn c th thy cch mt bc s bt mch v vit n thuc  rt th v v b ch!</li>
    <li>Cc ti thuc c v hnh nh cc loi cy thuc vi tn ting Vit v ting Anh c trng by. Bn s c th hiu c nhng loi tho mc no  c s dng  iu tr.</li>
    <li>ng qun ch  n thng tin v Tu Tnh (1330-1400)  ng c coi l t tin thc s ca y hc Vit Nam.</li>
</ul>

<h6>Ti sao nn gh thm?</h6>
<p>
    Gh thm Bo Tng Y Hc C Truyn khng ch l c hi  tm hiu nhiu iu v cc phng php cha bnh c xa m cn l c hi  m mnh vo di sn vn ha ca Hi An, ni lun gn lin mt thit vi thng mi v trao i kin thc, bao gm c kin thc y hc. N mang n mt ci nhn mi m v lch s thnh ph, c tit l  y qua lng knh sc khe v hnh phc.
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},slug:{en:"museum-of-traditional-medicine",ru:"muzey-traditsionnoy-meditsiny",es:"museo-medicina-tradicional",fr:"musee-medecine-traditionnelle",vn:"bao-tang-y-hoc-co-truyen"}},{id:"museum-of-folk-culture",coordinates:[15.876582072649137,108.32984229159041],category:["museum"],imageUrl:"17.jpg",en:{title:"Museum of Folk Culture",description:"Demonstration and introduction to Vietnamese folk culture and medicine.",fullDescription:`
<p>
    If you truly want to feel the pulse of ancient Hoi An, to understand how its inhabitants lived while ships brought exotic goods, then you absolutely must visit the <strong>Museum of Folk Culture</strong>. This is one of the six treasure museums of the Old Town, and it is entirely dedicated to the daily life and traditions of Hoi An during its heyday as a trading port.
</p>
<p>
    The museum is located in one of the largest residential buildings in the Old Town, a beautiful two-story mansion with an inner courtyard, which is a work of art in itself. Its architecture is a delightful mix of Chinese influences and unique Vietnamese elements, and it was most likely built in the mid-19th century. So you'll not only study the exhibits but also touch the history of the building itself!
</p>

<h6>500 Artifacts and Four Themes That Tell All!</h6>
<p>
    Inside the museum, you'll embark on a fascinating journey through four main themes, presented on the upper floor, where about 500 artifacts are collected:
</p>
<ul>
    <li><strong>Folk Art:</strong> Here you'll see unique paintings, sculptures, and ceramics that tell of the creative spirit of Hoi An's inhabitants.</li>
    <li><strong>Folk Performing Arts:</strong> You'll learn about local traditions, such as the famous Unicorn Dance and the lively Bai Chai Dance. Imagine the exciting performances that were given on the streets of Hoi An!</li>
    <li><strong>Traditional Villages:</strong> The museum will show how the surrounding villages lived. You'll see ancient agricultural and fishing tools that tell about the specialized techniques of different settlements.</li>
    <li><strong>Traditional Way of Life:</strong> This section will immerse you in the daily life of Hoi An, demonstrating items related to traditional crafts and productions: pottery, silk weaving, and tailoring. After all, Hoi An was not only a trading center but also a place where unique goods were produced!</li>
</ul>
<p>
    Special attention should be paid to the <strong>extensive use of wood</strong> in the construction of the museum building itself. Staircases, balustrades, partitions  everything is made with incredible skill, and this in itself is an exhibit.
</p>

<h6>Why Is This Important and Interesting?</h6>
<p>
    The Museum of Folk Culture provides an incredible insight into how Hoi An functioned, not only as a port city for merchants but also as a center of a vibrant, evolving culture of local residents. It is a place where history comes alive through everyday objects and tells of the rich heritage of the region. Here you can truly feel part of ancient Hoi An.
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},ru:{title:"  ",description:"        .",fullDescription:`
<p>
           , ,    ,     ,      <strong>  </strong>.     -  ,                .
</p>
<p>
             ,      ,       .           , ,  ,      XIX .       ,       !
</p>

<h6>500    ,   !</h6>
<p>
              ,    ,    500 :
</p>
<ul>
    <li><strong> :</strong>     ,   ,       .</li>
    <li><strong>  :</strong>     ,          . ,       !</li>
    <li><strong> :</strong>  ,    .       ,       .</li>
    <li><strong>  :</strong>        ,  ,      :  ,     .       ,   ,    !</li>
</ul>
<p>
        <strong>  </strong>     . , ,       ,       .
</p>

<h6>    ?</h6>
<p>
           ,          ,     ,    .  ,            .    -     .
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},es:{title:"Museo de la Cultura Popular",description:"Demostracin e introduccin a la cultura popular y la medicina vietnamita.",fullDescription:`
<p>
    Si realmente quieres sentir el pulso del antiguo Hoi An, comprender cmo vivan sus habitantes mientras los barcos traan bienes exticos, entonces debes visitar el <strong>Museo de la Cultura Popular</strong>. Este es uno de los seis museos tesoro del Casco Antiguo, y est completamente dedicado a la vida diaria y las tradiciones de Hoi An durante su apogeo como puerto comercial.
</p>
<p>
    El museo est ubicado en uno de los edificios residenciales ms grandes del Casco Antiguo, una hermosa mansin de dos pisos con un patio interior, que es una obra de arte en s misma. Su arquitectura es una deliciosa mezcla de influencias chinas y elementos vietnamitas nicos, y muy probablemente fue construido a mediados del siglo XIX. As que no solo estudiars las exhibiciones, sino que tambin tocars la historia del edificio mismo!
</p>

<h6>500 Artefactos y Cuatro Temas que lo Cuentan Todo!</h6>
<p>
    Dentro del museo, emprenders un fascinante viaje a travs de cuatro temas principales, presentados en el piso superior, donde se recogen alrededor de 500 artefactos:
</p>
<ul>
    <li><strong>Arte Popular:</strong> Aqu vers pinturas, esculturas y cermicas nicas que hablan del espritu creativo de los habitantes de Hoi An.</li>
    <li><strong>Artes Escnicas Populares:</strong> Aprenders sobre las tradiciones locales, como la famosa Danza del Unicornio y la animada Danza Bai Chai. Imagina las emocionantes actuaciones que se daban en las calles de Hoi An!</li>
    <li><strong>Aldeas Tradicionales:</strong> El museo mostrar cmo vivan las aldeas circundantes. Vers herramientas agrcolas y de pesca antiguas que hablan sobre las tcnicas especializadas de diferentes asentamientos.</li>
    <li><strong>Forma de Vida Tradicional:</strong> Esta seccin te sumergir en la vida diaria de Hoi An, demostrando artculos relacionados con artesanas y producciones tradicionales: alfarera, tejido de seda y sastrera. Despus de todo, Hoi An no era solo un centro comercial, sino tambin un lugar donde se producan bienes nicos!</li>
</ul>
<p>
    Se debe prestar especial atencin al <strong>uso extensivo de la madera</strong> en la construccin del propio edificio del museo. Escaleras, balaustradas, tabiques: todo est hecho con una habilidad increble, y esto en s mismo es una exhibicin.
</p>

<h6>Por qu es esto importante e interesante?</h6>
<p>
    El Museo de la Cultura Popular ofrece una visin increble de cmo funcionaba Hoi An, no solo como ciudad portuaria para comerciantes, sino tambin como centro de una cultura vibrante y en evolucin de los residentes locales. Es un lugar donde la historia cobra vida a travs de objetos cotidianos y habla del rico patrimonio de la regin. Aqu puedes sentirte verdaderamente parte del antiguo Hoi An.
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},fr:{title:"Muse de la Culture Populaire",description:"Dmonstration et introduction  la culture populaire et  la mdecine vietnamienne.",fullDescription:`
<p>
    Si vous voulez vraiment sentir le pouls de l'ancien Hoi An, comprendre comment ses habitants vivaient pendant que les navires apportaient des marchandises exotiques, alors vous devez absolument visiter le <strong>Muse de la Culture Populaire</strong>. C'est l'un des six muses trsors de la vieille ville, et il est entirement ddi  la vie quotidienne et aux traditions de Hoi An  son apoge en tant que port de commerce.
</p>
<p>
    Le muse est situ dans l'un des plus grands btiments rsidentiels de la vieille ville, un magnifique manoir de deux tages avec une cour intrieure, qui est une uvre d'art en soi. Son architecture est un dlicieux mlange d'influences chinoises et d'lments vietnamiens uniques, et il a trs probablement t construit au milieu du XIXe sicle. Vous n'tudierez donc pas seulement les expositions, mais vous toucherez galement  l'histoire du btiment lui-mme !
</p>

<h6>500 artefacts et quatre thmes qui racontent tout !</h6>
<p>
     l'intrieur du muse, vous embarquerez pour un voyage fascinant  travers quatre thmes principaux, prsents  l'tage suprieur, o sont rassembls environ 500 artefacts :
</p>
<ul>
    <li><strong>Art populaire :</strong> Vous y verrez des peintures, sculptures et cramiques uniques qui tmoignent de l'esprit cratif des habitants de Hoi An.</li>
    <li><strong>Arts du spectacle populaires :</strong> Vous en apprendrez davantage sur les traditions locales, telles que la clbre Danse de la Licorne et la vive Danse Bai Chai. Imaginez les spectacles passionnants qui taient donns dans les rues de Hoi An !</li>
    <li><strong>Villages traditionnels :</strong> Le muse montrera comment vivaient les villages environnants. Vous y verrez d'anciens outils agricoles et de pche qui racontent les techniques spcialises de diffrentes colonies.</li>
    <li><strong>Mode de vie traditionnel :</strong> Cette section vous plongera dans la vie quotidienne de Hoi An, en prsentant des objets lis aux mtiers et productions traditionnels : poterie, tissage de la soie et couture. Aprs tout, Hoi An n'tait pas seulement un centre commercial, mais aussi un lieu o des marchandises uniques taient produites !</li>
</ul>
<p>
    Une attention particulire doit tre porte  l'<strong>utilisation extensive du bois</strong> dans la construction du btiment du muse lui-mme. Escaliers, balustrades, cloisons  tout est fait avec une habilet incroyable, et cela en soi est une exposition.
</p>

<h6>Pourquoi est-ce important et intressant ?</h6>
<p>
    Le Muse de la Culture Populaire offre un aperu incroyable du fonctionnement de Hoi An, non seulement en tant que ville portuaire pour les marchands, mais aussi en tant que centre d'une culture vibrante et en volution de ses habitants. C'est un lieu o l'histoire prend vie  travers des objets du quotidien et raconte le riche patrimoine de la rgion. Ici, vous pouvez vraiment vous sentir partie prenante de l'ancien Hoi An.
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},vn:{title:"Bo Tng Vn Ha Dn Gian",description:"Trnh by v gii thiu vn ha dn gian v y hc Vit Nam.",fullDescription:`
<p>
    Nu bn thc s mun cm nhn nhp p ca Hi An c knh,  hiu cuc sng ca c dn ni y khi nhng con tu mang n hng ha exotic, th bn nht nh phi gh thm <strong>Bo Tng Vn Ha Dn Gian</strong>. y l mt trong su bo tng kho bu ca Ph C, v n hon ton dnh ring cho i sng hng ngy v truyn thng ca Hi An trong thi k hong kim l mt thng cng.
</p>
<p>
    Bo tng nm trong mt trong nhng ta nh dn c ln nht ca Ph C, mt bit th hai tng tuyt p vi mt sn trong, bn thn n  l mt tc phm ngh thut. Kin trc ca n l s pha trn th v gia nh hng Trung Hoa v cc yu t Vit Nam c o, v rt c th n c xy dng vo gia th k 19. V vy, bn s khng ch nghin cu cc hin vt m cn chm vo lch s ca chnh ta nh!
</p>

<h6>500 Hin vt v Bn Ch  K Li Tt C!</h6>
<p>
    Bn trong bo tng, bn s bt u mt hnh trnh th v qua bn ch  chnh, c trnh by  tng trn, ni c khong 500 hin vt c thu thp:
</p>
<ul>
    <li><strong>Ngh thut dn gian:</strong> Ti y, bn s thy nhng bc tranh, tc phm iu khc v gm s c o k v tinh thn sng to ca c dn Hi An.</li>
    <li><strong>Ngh thut biu din dn gian:</strong> Bn s tm hiu v cc truyn thng a phng, chng hn nh Ma Ln ni ting v iu Ma Bi Chi si ng. Hy tng tng nhng mn trnh din th v  c biu din trn ng ph Hi An!</li>
    <li><strong>Lng ngh truyn thng:</strong> Bo tng s cho thy cuc sng ca cc lng ngh xung quanh. Bn s thy cc cng c nng nghip v ng nghip c xa k v cc k thut chuyn bit ca cc khu nh c khc nhau.</li>
    <li><strong>Cch sng truyn thng:</strong> Phn ny s a bn m mnh vo i sng hng ngy ca Hi An, trng by cc vt phm lin quan n cc ngh th cng v sn xut truyn thng: gm s, dt la v may o. Rt cuc, Hi An khng ch l mt trung tm thng mi m cn l ni sn xut ra nhng mt hng c o!</li>
</ul>
<p>
    Cn c bit ch  n <strong>vic s dng g rng ri</strong> trong vic xy dng chnh ta nh bo tng. Cu thang, lan can, vch ngn  mi th u c lm bng k nng ng kinh ngc, v iu ny t n  l mt hin vt.
</p>

<h6>Ti sao iu ny quan trng v th v?</h6>
<p>
    Bo Tng Vn Ha Dn Gian cung cp mt ci nhn su sc ng kinh ngc v cch Hi An hot ng, khng ch vi t cch l mt thnh ph cng cho cc thng nhn m cn l trung tm ca mt nn vn ha si ng, ang pht trin ca ngi dn a phng.  l mt ni m lch s sng ng qua cc vt dng hng ngy v k v di sn phong ph ca khu vc. Ti y, bn c th thc s cm thy mnh l mt phn ca Hi An c knh.
</p>

    `,internalImageNames:["9.jpg","2.jpg","3.jpg"]},slug:{en:"museum-of-folk-culture",ru:"muzey-narodnoy-kultury",es:"museo-cultura-popular",fr:"musee-culture-populaire",vn:"bao-tang-van-hoa-dan-gian"}},{id:"teochew-assembly-hall",coordinates:[15.877797676562944,108.33307758196435],category:["museum"],imageUrl:"18.jpg",en:{title:"Teochew Assembly Hall",description:"This hall was originally a center for the social and religious life of all Teochew Chinese.",fullDescription:`
<p>
    Among the many magnificent assembly halls of Hoi An, there is one that immediately catches the eye with its special style and rich history  it's the <strong>Teochew Assembly Hall</strong>. It is also called Trieu Chau Assembly Hall or, simply, Ong Bon Pagoda. And it's no coincidence, as it was built by the Chinese community from the Chaozhou (Teochew) region in distant 1845!
</p>
<img src="43.jpg" alt="Teochew Assembly Hall"/>
<p>
    This hall was originally a center for the social and religious life of all Teochew Chinese who lived and traded in Hoi An. It served as a place for meetings, festivals, and mutual assistance. And although the hall has been repeatedly renovated and rebuilt, especially in 1887, 1970, and 1991, it has retained its unique appearance and status as one of the few ancient relics of Vietnam, recognized even by the French School of the Far East!
</p>
<h6>Architectural Magic and the Art of Details</h6>
<img src="44.jpg" alt="Teochew Assembly Hall"/>
<p>
    The Teochew Assembly Hall is a true architectural masterpiece, where Chinese style harmoniously intertwines with local Vietnamese elements. Its layout is very symbolic and follows the Chinese character "" (gu), meaning "country" or "nation," with three main parts: a front courtyard, an inner courtyard, and a main hall.
</p>
<img src="45.jpg" alt="Teochew Assembly Hall"/>
<ul>
    <li>Entry to the hall is through impressive <strong>Triple Gates</strong> with three roofs. Above the middle entrance hangs a plaque with four characters: "Teochew Chinese Congregation Assembly Hall." And the metal gates are adorned with images of carp, which, as you recall, symbolize good luck!</li>
    <li>On either side of the middle entrance, you'll be greeted by two stone figures of guardian lions, ready to protect this sacred place from evil spirits.</li>
    <li>The facade is made of skillfully carved stone slabs, decorated with popular motifs: carp transforming into dragons (any merchant's dream!), four sacred beasts, and graceful butterflies. Every detail here has deep meaning.</li>
    <li>The main worship hall is built of wood and stone. Its rafters and beams are richly decorated with carved patterns, birds, and mythical characters. You'll see carved dragons and fish on the wooden columns, which create a very solemn and impressive appearance.</li>
    <li>The hall is famous for its art of embossing and inlay, often using porcelain, which gives the structure a special beauty. And incense coils with paper prayers hang from the ceilings, filling the air with a mysterious aroma.</li>
    <li>Inside the complex, there are two beautiful courtyards that create a cozy oasis, providing tranquility away from the noisy street.</li>
    <li>On the sides of the main hall are the East and West houses, which could be used for community events and perhaps even for Chinese language lessons for children.</li>
</ul>
<h6>The General Who Calms the Waves and Secrets Beneath the Earth</h6>
<img src="46.jpg" alt="Teochew Assembly Hall"/>
<p>
    The main deity worshipped in the central sanctuary is <strong>Ong Bon</strong>, or Ma Yuan  a Chinese warlord who lived before our era and was deified after death. His official title is "General who calms the waves." He was prayed to for safe passage and successful trade at sea, which was vital for Teochew merchants whose lives depended on sea voyages.
</p>
<p>
    In addition to religious purposes, the Teochew Assembly Hall has always been a crucial center for preserving and spreading the culture and spiritual values of the Teochew community in Hoi An. Festivals and cultural events are still regularly held here, attracting both the local Chinese community and tourists.
</p>
<img src="47.jpg" alt="Teochew Assembly Hall"/>
<p>
    And finally, a little secret: in 1989, archaeologists discovered many ceramic items and ancient coins from the 15th-20th centuries, made in China, Japan, and Vietnam, beneath the Teochew Assembly Hall! These finds once again prove that Hoi An was an incredibly bustling trading port.
</p>
<p>
    The Teochew Assembly Hall is one of the most important and unique architectural and cultural sites in Hoi An. Be sure to stop by to delve into history and understand how different cultures shaped this ancient city.
</p>
    `,internalImageNames:["43.jpg","44.jpg","45.jpg","46.jpg","47.jpg"]},ru:{title:"  ",description:"           .",fullDescription:`
<p>
           ,              <strong>  </strong>.        ,  ,   .    ,          ()   1845 !
</p>
<img src="43.jpg" alt="  "/>
<p>
               ,     .     ,   .       ,   1887, 1970  1991 ,             ,      !
</p>

<h6>    </h6>
<img src="44.jpg" alt="  "/>
<p>
           ,         .          (gu),     ,    :  ,     .
</p>
<img src="45.jpg" alt="  "/>
<ul>
    <li>      <strong> </strong>   .        :     .      , ,   ,  !</li>
    <li>           -,        .</li>
    <li>      ,   : ,    (  !),      .      .</li>
    <li>       .        ,    .         ,       .</li>
    <li>      ,    ,     .         ,    .</li>
    <li>      ,    ,      .</li>
    <li>        ,       , ,       .</li>
</ul>

<h6>,  ,    </h6>
<img src="46.jpg" alt="  "/>
<p>
     ,     ,  <strong> </strong>,      ,        .     ,  .          ,       ,      .
</p>
<p>
      ,                  .          ,     ,   .
</p>
<img src="47.jpg" alt="  "/>
<p>
       :  1989              XVXX ,   ,   !     ,       .
</p>
<p>
                   .   ,      ,       .
</p>
    `,internalImageNames:["43.jpg","44.jpg","45.jpg","46.jpg","47.jpg"]},es:{title:"Sala de Asamblea Teochew",description:"Esta sala fue originalmente un centro para la vida social y religiosa de todos los chinos Teochew.",fullDescription:`
<p>
    Entre las muchas magnficas salas de asamblea de Hoi An, hay una que inmediatamente llama la atencin por su estilo especial y su rica historia: es la <strong>Sala de Asamblea Teochew</strong>. Tambin se le llama Sala de Asamblea Trieu Chau o, simplemente, Pagoda Ong Bon. Y no es una coincidencia, ya que fue construida por la comunidad china de la regin de Chaozhou (Teochew) en el lejano 1845.
</p>
<img src="43.jpg" alt="Sala de Asamblea Teochew"/>
<p>
    Esta sala fue originalmente un centro para la vida social y religiosa de todos los chinos Teochew que vivan y comerciaban en Hoi An. Sirvi como lugar para reuniones, festivales y ayuda mutua. Y aunque la sala ha sido repetidamente renovada y reconstruida, especialmente en 1887, 1970 y 1991, ha conservado su apariencia nica y su estatus como una de las pocas reliquias antiguas de Vietnam, reconocida incluso por la Escuela Francesa del Lejano Oriente.
</p>

<h6>Magia Arquitectnica y el Arte de los Detalles</h6>
<img src="44.jpg" alt="Sala de Asamblea Teochew"/>
<p>
    La Sala de Asamblea Teochew es una verdadera obra maestra arquitectnica, donde el estilo chino se entrelaza armoniosamente con elementos vietnamitas locales. Su diseo es muy simblico y sigue el carcter chino "" (gu), que significa "pas" o "nacin", con tres partes principales: un patio delantero, un patio interior y una sala principal.
</p>
<img src="45.jpg" alt="Sala de Asamblea Teochew"/>
<ul>
    <li>La entrada a la sala es a travs de impresionantes <strong>Puertas Triples</strong> con tres tejados. Sobre la entrada central cuelga una placa con cuatro caracteres: "Sala de Asamblea de la Congregacin China Teochew". Y las puertas de metal estn adornadas con imgenes de carpas, que, como recordarn, simbolizan la buena suerte!</li>
    <li>A cada lado de la entrada central, sers recibido por dos figuras de piedra de leones guardianes, listos para proteger este lugar sagrado de los malos espritus.</li>
    <li>La fachada est hecha de losas de piedra hbilmente talladas, decoradas con motivos populares: carpas transformndose en dragones (el sueo de cualquier comerciante!), cuatro bestias sagradas y grciles mariposas. Cada detalle aqu tiene un significado profundo.</li>
    <li>La sala principal de culto est construida de madera y piedra. Sus vigas y dinteles estn ricamente decorados con patrones tallados, pjaros y personajes mticos. Vers dragones y peces tallados en las columnas de madera, lo que crea una apariencia muy solemne e impresionante.</li>
    <li>La sala es famosa por su arte de repujado e incrustaciones, a menudo utilizando porcelana, lo que le da a la estructura una belleza especial. Y espirales de incienso con oraciones de papel cuelgan de los techos, llenando el aire con un aroma misterioso.</li>
    <li>Dentro del complejo, hay dos hermosos patios que crean un oasis acogedor, proporcionando tranquilidad lejos de la ruidosa calle.</li>
    <li>A los lados de la sala principal se encuentran las casas Este y Oeste, que podran usarse para eventos comunitarios y quizs incluso para lecciones de chino para nios.</li>
</ul>

<h6>El General que Calma las Olas y Secretos Bajo la Tierra</h6>
<img src="46.jpg" alt="Sala de Asamblea Teochew"/>
<p>
    La deidad principal adorada en el santuario central es <strong>Ong Bon</strong>, o Ma Yuan, un caudillo chino que vivi antes de nuestra era y fue deificado despus de su muerte. Su ttulo oficial es "General que calma las olas". Se le oraba por un paso seguro y un comercio exitoso en el mar, lo cual era vital para los comerciantes Teochew cuyas vidas dependan de los viajes por mar.
</p>
<p>
    Adems de sus propsitos religiosos, la Sala de Asamblea Teochew siempre ha sido un centro crucial para preservar y difundir la cultura y los valores espirituales de la comunidad Teochew en Hoi An. Los festivales y eventos culturales todava se celebran regularmente aqu, atrayendo tanto a la comunidad china local como a los turistas.
</p>
<img src="47.jpg" alt="Sala de Asamblea Teochew"/>
<p>
    Y finalmente, un pequeo secreto: en 1989, los arquelogos descubrieron muchos objetos de cermica y monedas antiguas de los siglos XV al XX, fabricados en China, Japn y Vietnam, debajo de la Sala de Asamblea Teochew! Estos hallazgos demuestran una vez ms que Hoi An fue un puerto comercial increblemente bullicioso.
</p>
<p>
    La Sala de Asamblea Teochew es uno de los sitios arquitectnicos y culturales ms importantes y nicos de Hoi An. Asegrate de pasar para adentrarte en la historia y comprender cmo las diferentes culturas dieron forma a esta antigua ciudad.
</p>
    `,internalImageNames:["43.jpg","44.jpg","45.jpg","46.jpg","47.jpg"]},fr:{title:"Salle de l'Assemble de Teochew",description:"Cette salle tait  l'origine un centre de la vie sociale et religieuse de tous les Chinois Teochew.",fullDescription:`
<p>
    Parmi les nombreuses magnifiques salles d'assemble de Hoi An, il en est une qui attire immdiatement le regard par son style particulier et sa riche histoire  c'est la <strong>Salle de l'Assemble de Teochew</strong>. Elle est galement appele Salle de l'Assemble de Trieu Chau ou, simplement, Pagode Ong Bon. Et ce n'est pas un hasard, car elle a t construite par la communaut chinoise de la rgion de Chaozhou (Teochew) en 1845 !
</p>
<img src="43.jpg" alt="Salle de l'Assemble de Teochew"/>
<p>
    Cette salle tait  l'origine un centre de la vie sociale et religieuse de tous les Chinois Teochew qui vivaient et commeraient  Hoi An. Elle servait de lieu de runion, de festivals et d'entraide. Et bien que la salle ait t  plusieurs reprises rnove et reconstruite, notamment en 1887, 1970 et 1991, elle a conserv son apparence unique et son statut de l'une des rares reliques anciennes du Vietnam, reconnue mme par l'cole franaise d'Extrme-Orient !
</p>

<h6>Magie architecturale et l'art des dtails</h6>
<img src="44.jpg" alt="Salle de l'Assemble de Teochew"/>
<p>
    La Salle de l'Assemble de Teochew est un vritable chef-d'uvre architectural, o le style chinois s'entremle harmonieusement avec des lments vietnamiens locaux. Sa disposition est trs symbolique et suit le caractre chinois    (gu), signifiant  pays  ou  nation , avec trois parties principales : une cour avant, une cour intrieure et un hall principal.
</p>
<img src="45.jpg" alt="Salle de l'Assemble de Teochew"/>
<ul>
    <li>L'entre de la salle se fait par d'impressionnantes <strong>Portes Triples</strong>  trois toits. Au-dessus de l'entre centrale est suspendue une plaque avec quatre caractres :  Salle de l'Assemble de la Congrgation chinoise de Teochew . Et les portes mtalliques sont ornes d'images de carpes, qui, comme vous vous en souvenez, symbolisent la bonne fortune !</li>
    <li>De chaque ct de l'entre centrale, vous serez accueillis par deux figures de pierre de lions gardiens, prts  protger ce lieu sacr des mauvais esprits.</li>
    <li>La faade est faite de dalles de pierre habilement sculptes, dcores de motifs populaires : des carpes se transformant en dragons (le rve de tout marchand !), quatre btes sacres et de gracieuses papillons. Chaque dtail ici a une signification profonde.</li>
    <li>Le hall principal de culte est construit en bois et en pierre. Ses chevrons et ses poutres sont richement dcors de motifs sculpts, d'oiseaux et de personnages mythiques. Vous verrez des dragons et des poissons sculpts sur les colonnes en bois, ce qui cre une apparence trs solennelle et impressionnante.</li>
    <li>La salle est clbre pour son art du gaufrage et de l'incrustation, utilisant souvent de la porcelaine, ce qui donne  la structure une beaut particulire. Et des spirales d'encens avec des prires en papier pendent des plafonds, emplissant l'air d'un arme mystrieux.</li>
    <li> l'intrieur du complexe, il y a deux belles cours qui crent une oasis confortable, offrant la tranquillit loin de la rue bruyante.</li>
    <li>Sur les cts du hall principal se trouvent les maisons Est et Ouest, qui pouvaient tre utilises pour des vnements communautaires et peut-tre mme pour des cours de chinois pour les enfants.</li>
</ul>

<h6>Le gnral qui calme les vagues et les secrets sous la terre</h6>
<img src="46.jpg" alt="Salle de l'Assemble de Teochew"/>
<p>
    La divinit principale adore dans le sanctuaire central est <strong>Ong Bon</strong>, ou Ma Yuan  un chef de guerre chinois qui a vcu avant notre re et a t difi aprs sa mort. Son titre officiel est  Gnral qui calme les vagues . On le priait pour un passage sr et un commerce russi en mer, ce qui tait vital pour les marchands de Teochew dont la vie dpendait des voyages en mer.
</p>
<p>
    En plus de ses objectifs religieux, la Salle de l'Assemble de Teochew a toujours t un centre crucial pour la prservation et la diffusion de la culture et des valeurs spirituelles de la communaut Teochew  Hoi An. Des festivals et des vnements culturels y sont toujours rgulirement organiss, attirant  la fois la communaut chinoise locale et les touristes.
</p>
<img src="47.jpg" alt="Salle de l'Assemble de Teochew"/>
<p>
    Et enfin, un petit secret : en 1989, des archologues ont dcouvert de nombreux objets en cramique et des pices de monnaie anciennes des XVe-XXe sicles, fabriqus en Chine, au Japon et au Vietnam, sous la Salle de l'Assemble de Teochew ! Ces dcouvertes prouvent une fois de plus que Hoi An tait un port commercial incroyablement anim.
</p>
<p>
    La Salle de l'Assemble de Teochew est l'un des sites architecturaux et culturels les plus importants et les plus uniques de Hoi An. N'oubliez pas de vous arrter pour vous plonger dans l'histoire et comprendre comment diffrentes cultures ont faonn cette ville ancienne.
</p>
    `,internalImageNames:["43.jpg","44.jpg","45.jpg","46.jpg","47.jpg"]},vn:{title:"Hi Qun Triu Chu",description:"Hi qun ny ban u l trung tm sinh hot x hi v tn gio ca tt c ngi Hoa Triu Chu.",fullDescription:`
<p>
    Trong s nhiu hi qun lng ly  Hi An, c mt hi qun ngay lp tc thu ht nh nhn bi phong cch c bit v lch s phong ph ca n   l <strong>Hi Qun Triu Chu</strong>. N cn c gi l Hi Qun Triu Chu hoc n gin l Cha ng Bn. V iu ny khng phi ngu nhin, v n c cng ng ngi Hoa t vng Triu Chu (Teochew) xy dng vo nm 1845 xa xi!
</p>
<img src="43.jpg" alt="Hi Qun Triu Chu"/>
<p>
    Hi qun ny ban u l trung tm sinh hot x hi v tn gio ca tt c ngi Hoa Triu Chu sng v bun bn ti Hi An. N phc v nh mt ni  hp mt, t chc l hi v tng tr ln nhau. V mc d hi qun  nhiu ln c trng tu v xy dng li, c bit vo cc nm 1887, 1970 v 1991, n vn gi c v ngoi c o v a v l mt trong s t di tch c knh ca Vit Nam, c c Trng Vin ng Bc C ca Php cng nhn!
</p>

<h6>Kin trc huyn diu v ngh thut chi tit</h6>
<img src="44.jpg" alt="Hi Qun Triu Chu"/>
<p>
    Hi Qun Triu Chu l mt kit tc kin trc thc s, ni phong cch Trung Hoa hi ha an xen vi cc yu t Vit Nam a phng. B cc ca n rt tng trng v theo ch "" (gu) trong ting Trung, c ngha l "quc gia" hoc "dn tc", vi ba phn chnh: mt sn trc, mt sn trong v mt snh chnh.
</p>
<img src="45.jpg" alt="Hi Qun Triu Chu"/>
<ul>
    <li>Li vo hi qun thng qua <strong>Tam Quan</strong> n tng vi ba mi. Pha trn li vo chnh gia treo mt tm bin vi bn ch: "Triu Chu Hoa Kiu Hi Qun". V cng kim loi c trang tr bng hnh nh c chp, m nh bn nh, tng trng cho s may mn!</li>
    <li> hai bn li vo chnh gia, bn s c cho n bi hai tng  s t canh gc, sn sng bo v ni linh thing ny khi t kh.</li>
    <li>Mt tin c lm bng cc tm  c chm khc kho lo, trang tr bng cc ha tit ph bin: c chp ha rng (c m ca mi thng nhn!), bn loi linh th v nhng con bm duyn dng. Mi chi tit  y u mang  ngha su sc.</li>
    <li>Snh th chnh c xy dng bng g v . Cc x v ko ca n c trang tr phong ph vi cc hoa vn chm khc, chim v cc nhn vt thn thoi. Bn s thy nhng con rng v c c chm khc trn cc ct g, to nn mt v ngoi rt trang trng v n tng.</li>
    <li>Hi qun ni ting vi ngh thut chm khc ni v khm, thng s dng gm s, mang li v p c bit cho cng trnh. V nhng vng nhang ln vi nhng li cu nguyn trn giy treo t trn nh, lp y khng kh bng mt hng thm b n.</li>
    <li>Bn trong khu phc hp, c hai sn trong xinh p to nn mt c o m cng, mang li s yn bnh trnh xa con ph n o.</li>
    <li> hai bn snh chnh l nh ng v nh Ty, c th c s dng cho cc s kin cng ng v thm ch c th l cc lp hc ting Trung cho tr em.</li>
</ul>

<h6>V tng dp yn sng gi v nhng b mt di lng t</h6>
<img src="46.jpg" alt="Hi Qun Triu Chu"/>
<p>
    V thn chnh c th cng ti gian th trung tm l <strong>ng Bn</strong>, hay M Vin  mt tng lnh Trung Quc sng trc Cng nguyn v c thn thnh ha sau khi qua i. Chc danh chnh thc ca ng l "Phc Ba Tng Qun". Ngi ta cu nguyn ng ph h cho nhng chuyn i bin an ton v giao thng thnh cng trn bin, iu ny rt quan trng i vi cc thng nhn Triu Chu m cuc sng ca h ph thuc vo nhng chuyn i bin.
</p>
<p>
    Ngoi mc ch tn gio, Hi Qun Triu Chu lun l mt trung tm quan trng  bo tn v truyn b vn ha v gi tr tinh thn ca cng ng ngi Triu Chu ti Hi An. Cc l hi v s kin vn ha vn c t chc thng xuyn ti y, thu ht c cng ng ngi Hoa a phng v khch du lch.
</p>
<img src="47.jpg" alt="Hi Qun Triu Chu"/>
<p>
    V cui cng, mt b mt nh: vo nm 1989, cc nh kho c  pht hin nhiu  gm s v tin xu c t th k 15-20, c sn xut ti Trung Quc, Nht Bn v Vit Nam, bn di Hi Qun Triu Chu! Nhng pht hin ny mt ln na chng minh rng Hi An l mt thng cng v cng sm ut.
</p>
<p>
    Hi Qun Triu Chu l mt trong nhng di tch kin trc v vn ha quan trng v c o nht  Hi An. Hy chc chn gh qua  tm hiu su hn v lch s v hiu cch cc nn vn ha khc nhau  nh hnh thnh ph c ny.
</p>
    `,internalImageNames:["43.jpg","44.jpg","45.jpg","46.jpg","47.jpg"]},slug:{en:"teochew-assembly-hall",ru:"sbornyy-zal-tyochou",es:"sala-asamblea-teochew",fr:"salle-assemblee-teochew",vn:"hoi-quan-trieu-chau"}},{id:"precious-heritage-art-gallery-museum",coordinates:[15.877098800954702,108.33427527794125],category:["art-galleries","museum"],imageUrl:"48.jpg",en:{title:"Precious Heritage Art Gallery Museum",description:"Every Portrait is an Open Soul of Vietnam!",fullDescription:`
<p>
    For a moment, forget about ancient temples and trading houses. In Hoi An, there's a truly special place where history is written not in stone, but in human faces and stories. We're talking about the <strong>Precious Heritage Art Gallery Museum</strong>, a project by French photographer <strong>Rhahn</strong>, a man called "the photographer who captures the souls of his models."
</p>
<img src="49.jpg" alt="Precious Heritage Art Gallery Museum"/>
<p>
    Rhahn is not just a man with a camera. He is a true explorer of humanity who traveled to over 35 countries before settling in his beloved Hoi An. For him, photography is a way to get closer to people, hear their stories, and understand their culture. "Good contact (and photography) starts with respect," says Rhahn, and his works reflect this in every frame.
</p>

<h6>"Hidden Smile" and a Project That Changed Lives</h6>
<p>
    In 2011, Rhahn met a woman who changed everything  a 72-year-old boat captain named <strong>Bui Thi Xong</strong>. When he asked to take her portrait, she shyly laughed and covered her mouth. This is how the legendary photograph <strong>"Hidden Smile"</strong> came to be  a photo that conquered the world, became the most expensive Asian photograph (sold for $150,000!), and was even presented by the President of Vietnam to Emmanuel Macron.
</p>
<img src="52.jpg" alt="Precious Heritage Art Gallery Museum"/>
<p>
    For Rhahn, this photograph is "the embodiment of true Vietnam," a mix of modesty, humor, wisdom, and happiness. And it was this encounter that inspired him to create the <strong>Giving Back Project</strong>, a project to return a portion of the profits to the subjects of his photographs.
</p>
<p>
    But "Hidden Smile" was just the beginning. Another iconic work is the portrait of a girl named An Phuoc with blue eyes from the Cham people, which graced the covers of international magazines. Rhahn never rushes; he waits for trust to develop naturally. "The success of a portrait depends not on technique, but on a sincere and meaningful connection with the subject," he believes.
</p>

<h6>Precious Heritage Museum: The Heart of Vietnamese Diversity</h6>
<p>
    Rhahn's most ambitious project is <strong>Precious Heritage</strong>. It began with studying the 54 ethnic groups of Vietnam and evolved into a decade-long exploration of their cultural heritage, crafts, and stories. By 2020, Rhahn completed his mission, having met representatives of all groups.
</p>
<img src="51.jpg" alt="Precious Heritage Art Gallery Museum"/>
<p>
    And the result of this incredible work is the <strong>Precious Heritage Museum in Hoi An</strong>, opened in 2017. It is the only museum in the world that houses artifacts from all ethnic groups of Vietnam! Imagine: 100 stunning photographs, 62 authentic national costumes, five halls, and 500 square meters of space dedicated to cultural diversity.
</p>
<p>
    "Before Vietnam, I couldn't imagine a country where so many languages, traditions, and identities coexist," says Rhahn. His mission is to preserve this fragile and unique heritage.
</p>
<p>
    Visiting the Precious Heritage Art Gallery Museum is not just a tour; it's an emotional journey that will allow you to glimpse into the most hidden corners of Vietnam through the faces of its people. Prepare to leave inspired and with a smile on your face!
</p>
<img src="50.jpg" alt="Precious Heritage Art Gallery Museum"/>

    `,internalImageNames:["48.jpg","49.jpg","50.jpg","51.jpg","52.jpg"]},ru:{title:"-   ",description:"     !",fullDescription:`
<p>
            .      ,     ,     .    <strong>-   </strong>     <strong> (Rhahn)</strong>, ,   ,    .
</p>
<img src="49.jpg" alt="-   "/>
<p>
          .    ,      35 ,       .         ,       .   ( )   ,   ,        .
</p>

<h6>   ,  </h6>
<p>
     2011    ,   ,  72-     <strong>  </strong>.       ,      .     <strong> </strong>  ,   ,      (  150 000 !)        .
</p>
<img src="52.jpg" alt="-   "/>
<p>
           ,  , ,   .         <strong>   (Giving Back Project)</strong>         .
</p>
<p>
         .                 ,     .    ;  ,     .      ,        ,   .
</p>

<h6>  :   </h6>
<p>
         <strong>  (Precious Heritage)</strong>.     54           ,   .  2020     ,     .
</p>
<img src="51.jpg" alt="-   "/>
<p>
          <strong>    </strong>,   2017 .     ,        !  : 100  , 62   ,    500   ,   .
</p>
<p>
           ,    ,   ,   .         .
</p>
<p>
     -        ;   ,             .        !
</p>
<img src="50.jpg" alt="-   "/>

    `,internalImageNames:["48.jpg","49.jpg","50.jpg","51.jpg","52.jpg"]},es:{title:"Museo Galera de Arte Patrimonio Precioso",description:"Cada retrato es un alma abierta de Vietnam!",fullDescription:`
<p>
    Por un momento, olvdese de los templos antiguos y las casas comerciales. En Hoi An, hay un lugar verdaderamente especial donde la historia no est escrita en piedra, sino en rostros e historias humanas. Estamos hablando del <strong>Museo Galera de Arte Patrimonio Precioso</strong>, un proyecto del fotgrafo francs <strong>Rhahn</strong>, un hombre llamado "el fotgrafo que captura las almas de sus modelos".
</p>
<img src="49.jpg" alt="Museo Galera de Arte Patrimonio Precioso"/>
<p>
    Rhahn no es solo un hombre con una cmara. Es un verdadero explorador de la humanidad que viaj por ms de 35 pases antes de establecerse en su amado Hoi An. Para l, la fotografa es una forma de acercarse a las personas, escuchar sus historias y comprender su cultura. "Un buen contacto (y fotografa) comienza con el respeto", dice Rhahn, y sus obras lo reflejan en cada encuadre.
</p>

<h6>"Sonrisa Oculta" y un Proyecto que Cambi Vidas</h6>
<p>
    En 2011, Rhahn conoci a una mujer que lo cambi todo: una capitana de barco de 72 aos llamada <strong>Bui Thi Xong</strong>. Cuando le pidi tomar su retrato, ella se ri tmidamente y se cubri la boca. As naci la legendaria fotografa <strong>"Sonrisa Oculta"</strong>, una foto que conquist el mundo, se convirti en la fotografa asitica ms cara (vendida por $150,000!), e incluso fue presentada por el Presidente de Vietnam a Emmanuel Macron.
</p>
<img src="52.jpg" alt="Museo Galera de Arte Patrimonio Precioso"/>
<p>
    Para Rhahn, esta fotografa es "la encarnacin del verdadero Vietnam", una mezcla de modestia, humor, sabidura y felicidad. Y fue este encuentro lo que lo inspir a crear el <strong>Proyecto de Devolucin (Giving Back Project)</strong>, un proyecto para devolver una parte de las ganancias a los sujetos de sus fotografas.
</p>
<p>
    Pero "Sonrisa Oculta" fue solo el comienzo. Otra obra icnica es el retrato de una nia llamada An Phuoc con ojos azules del pueblo Cham, que apareci en las portadas de revistas internacionales. Rhahn nunca se apresura; espera que la confianza se desarrolle naturalmente. "El xito de un retrato no depende de la tcnica, sino de una conexin sincera y significativa con el sujeto", cree.
</p>

<h6>Museo Patrimonio Precioso: El Corazn de la Diversidad Vietnamita</h6>
<p>
    El proyecto ms ambicioso de Rhahn es <strong>Patrimonio Precioso (Precious Heritage)</strong>. Comenz con el estudio de los 54 grupos tnicos de Vietnam y evolucion hacia una exploracin de una dcada de su patrimonio cultural, artesanas e historias. Para 2020, Rhahn complet su misin, habiendo conocido a representantes de todos los grupos.
</p>
<img src="51.jpg" alt="Museo Galera de Arte Patrimonio Precioso"/>
<p>
    Y el resultado de este increble trabajo es el <strong>Museo Patrimonio Precioso en Hoi An</strong>, inaugurado en 2017. Es el nico museo en el mundo que alberga artefactos de todos los grupos tnicos de Vietnam! Imagnese: 100 fotografas impresionantes, 62 trajes nacionales autnticos, cinco salas y 500 metros cuadrados de espacio dedicados a la diversidad cultural.
</p>
<p>
    "Antes de Vietnam, no poda imaginar un pas donde coexistieran tantos idiomas, tradiciones e identidades", dice Rhahn. Su misin es preservar este patrimonio frgil y nico.
</p>
<p>
    Visitar el Museo Galera de Arte Patrimonio Precioso no es solo un recorrido; es un viaje emocional que le permitir vislumbrar los rincones ms ocultos de Vietnam a travs de los rostros de su gente. Preprese para irse inspirado y con una sonrisa en su rostro!
</p>
<img src="50.jpg" alt="Museo Galera de Arte Patrimonio Precioso"/>

    `,internalImageNames:["48.jpg","49.jpg","50.jpg","51.jpg","52.jpg"]},fr:{title:"Muse-Galerie d'Art du Patrimoine Prcieux",description:"Chaque portrait est une me ouverte du Vietnam !",fullDescription:`
<p>
    Oubliez un instant les temples anciens et les maisons de commerce.  Hoi An, il existe un lieu vraiment spcial o l'histoire n'est pas crite dans la pierre, mais dans les visages et les histoires humaines. Nous parlons du <strong>Muse-Galerie d'Art du Patrimoine Prcieux</strong>, un projet du photographe franais <strong>Rhahn</strong>, un homme surnomm "le photographe qui capture l'me de ses modles".
</p>
<img src="49.jpg" alt="Muse-Galerie d'Art du Patrimoine Prcieux"/>
<p>
    Rhahn n'est pas seulement un homme avec un appareil photo. C'est un vritable explorateur de l'humanit qui a voyag dans plus de 35 pays avant de s'installer dans son cher Hoi An. Pour lui, la photographie est un moyen de se rapprocher des gens, d'couter leurs histoires et de comprendre leur culture. "Un bon contact (et la photographie) commence par le respect", dit Rhahn, et ses uvres le refltent dans chaque image.
</p>

<h6>"Sourire Cach" et un projet qui a chang des vies</h6>
<p>
    En 2011, Rhahn a rencontr une femme qui a tout chang  une capitaine de bateau de 72 ans nomme <strong>Bui Thi Xong</strong>. Quand il lui a demand de prendre son portrait, elle a ri timidement et a couvert sa bouche. C'est ainsi qu'est ne la lgendaire photographie <strong>"Sourire Cach"</strong>  une photo qui a conquis le monde, est devenue la photographie asiatique la plus chre (vendue pour 150 000 $ !), et a mme t prsente par le Prsident du Vietnam  Emmanuel Macron.
</p>
<img src="52.jpg" alt="Muse-Galerie d'Art du Patrimoine Prcieux"/>
<p>
    Pour Rhahn, cette photographie est "l'incarnation du vrai Vietnam", un mlange de modestie, d'humour, de sagesse et de bonheur. Et c'est cette rencontre qui l'a inspir  crer le <strong>Projet de Redonner (Giving Back Project)</strong>, un projet visant  reverser une partie des bnfices aux sujets de ses photographies.
</p>
<p>
    Mais "Sourire Cach" n'tait que le dbut. Une autre uvre emblmatique est le portrait d'une fille nomme An Phuoc aux yeux bleus du peuple Cham, qui a fait la couverture de magazines internationaux. Rhahn ne se presse jamais ; il attend que la confiance se dveloppe naturellement. "Le succs d'un portrait ne dpend pas de la technique, mais d'une connexion sincre et significative avec le sujet", estime-t-il.
</p>

<h6>Muse du Patrimoine Prcieux : Le cur de la diversit vietnamienne</h6>
<p>
    Le projet le plus ambitieux de Rhahn est le <strong>Patrimoine Prcieux</strong>. Il a commenc par l'tude des 54 groupes ethniques du Vietnam et a volu vers une exploration d'une dcennie de leur patrimoine culturel, de leurs mtiers et de leurs histoires. En 2020, Rhahn a achev sa mission, aprs avoir rencontr des reprsentants de tous les groupes.
</p>
<img src="51.jpg" alt="Muse-Galerie d'Art du Patrimoine Prcieux"/>
<p>
    Et le rsultat de ce travail incroyable est le <strong>Muse du Patrimoine Prcieux  Hoi An</strong>, ouvert en 2017. C'est le seul muse au monde qui abrite des artefacts de toutes les ethnies du Vietnam ! Imaginez : 100 photographies poustouflantes, 62 costumes nationaux authentiques, cinq salles et 500 mtres carrs d'espace ddis  la diversit culturelle.
</p>
<p>
    "Avant le Vietnam, je ne pouvais pas imaginer un pays o coexistent autant de langues, de traditions et d'identits", dit Rhahn. Sa mission est de prserver ce patrimoine fragile et unique.
</p>
<p>
    Visiter le Muse-Galerie d'Art du Patrimoine Prcieux n'est pas seulement une visite ; c'est un voyage motionnel qui vous permettra de jeter un coup d'il dans les coins les plus cachs du Vietnam  travers les visages de ses habitants. Prparez-vous  repartir inspir et avec le sourire aux lvres !
</p>
<img src="50.jpg" alt="Muse-Galerie d'Art du Patrimoine Prcieux"/>

    `,internalImageNames:["48.jpg","49.jpg","50.jpg","51.jpg","52.jpg"]},vn:{title:"Bo Tng Phng Trng By Ngh Thut Di Sn Qu Gi",description:"Mi bc chn dung l mt tm hn m ca Vit Nam!",fullDescription:`
<p>
    Trong chc lt, hy qun i nhng ngi cha c knh v nhng ngi nh bun bn.  Hi An, c mt ni thc s c bit ni lch s khng c vit bng , m bng nhng khun mt v cu chuyn ca con ngi. Chng ta ang ni v <strong>Bo Tng Phng Trng By Ngh Thut Di Sn Qu Gi</strong>, mt d n ca nhip nh gia ngi Php <strong>Rhahn</strong>, ngi c mnh danh l "nhip nh gia nm bt tm hn ca nhng ngi mu".
</p>
<img src="49.jpg" alt="Bo Tng Phng Trng By Ngh Thut Di Sn Qu Gi"/>
<p>
    Rhahn khng ch l mt ngi n ng cm my nh. Anh y l mt nh thm him nhn loi thc th, ngi  i hn 35 quc gia trc khi nh c ti Hi An yu du ca mnh. i vi anh, nhip nh l mt cch  n gn hn vi con ngi, lng nghe cu chuyn ca h v hiu vn ha ca h. "S tip xc tt (v nhip nh) bt u bng s tn trng," Rhahn ni, v cc tc phm ca anh y phn nh iu ny trong mi khung hnh.
</p>

<h6>"N Ci n Giu" v D n Thay i Cuc i</h6>
<p>
    Nm 2011, Rhahn gp mt ngi ph n  thay i mi th  mt thuyn trng 72 tui tn l <strong>Bi Th Xong</strong>. Khi anh y yu cu chp chn dung ca b, b ci bn ln v che ming. y l cch bc nh huyn thoi <strong>"N Ci n Giu"</strong> ra i  mt bc nh  chinh phc th gii, tr thnh bc nh chu  t nht (bn vi gi 150.000  la!), v thm ch cn c Ch tch Vit Nam tng cho Emmanuel Macron.
</p>
<img src="52.jpg" alt="Bo Tng Phng Trng By Ngh Thut Di Sn Qu Gi"/>
<p>
    i vi Rhahn, bc nh ny l "hin thn ca Vit Nam chn thc", mt s pha trn gia s khim tn, hi hc, tr tu v hnh phc. V chnh cuc gp g ny  truyn cm hng cho anh to ra <strong>D n Trao Li (Giving Back Project)</strong>, mt d n nhm tr li mt phn li nhun cho nhng ngi c chp nh.
</p>
<p>
    Nhng "N Ci n Giu" ch l khi u. Mt tc phm biu tng khc l chn dung c b An Phc vi i mt xanh ca ngi Chm,  xut hin trn trang ba ca nhiu tp ch quc t. Rhahn khng bao gi vi vng; anh y ch i s tin tng pht trin t nhin. "Thnh cng ca mt bc chn dung khng ph thuc vo k thut, m vo mt kt ni chn thnh v c  ngha vi i tng," anh tin.
</p>

<h6>Bo Tng Di Sn Qu Gi: Tri Tim ca S a Dng Vit Nam</h6>
<p>
    D n tham vng nht ca Rhahn l <strong>Di Sn Qu Gi (Precious Heritage)</strong>. N bt u bng vic nghin cu 54 dn tc thiu s ca Vit Nam v pht trin thnh mt cuc khm ph ko di mt thp k v di sn vn ha, ngh th cng v cu chuyn ca h. n nm 2020, Rhahn  hon thnh s mnh ca mnh, sau khi gp g i din ca tt c cc nhm.
</p>
<img src="51.jpg" alt="Bo Tng Phng Trng By Ngh Thut Di Sn Qu Gi"/>
<p>
    V kt qu ca cng vic ng kinh ngc ny l <strong>Bo Tng Di Sn Qu Gi  Hi An</strong>, khai trng vo nm 2017. y l bo tng duy nht trn th gii lu gi cc hin vt t tt c cc dn tc thiu s ca Vit Nam! Hy tng tng: 100 bc nh tuyt p, 62 b trang phc dn tc ch thc, nm snh v 500 mt vung khng gian dnh ring cho s a dng vn ha.
</p>
<p>
    "Trc Vit Nam, ti khng th tng tng mt t nc m c qu nhiu ngn ng, truyn thng v bn sc cng tn ti," Rhahn ni. Nhim v ca anh y l bo tn di sn mong manh v c o ny.
</p>
<p>
    Gh thm Bo Tng Phng Trng By Ngh Thut Di Sn Qu Gi khng ch l mt chuyn tham quan;  l mt hnh trnh cm xc s cho php bn nhn thong qua nhng gc khut nht ca Vit Nam qua khun mt ca nhng ngi dn ni y. Hy chun b  ra v vi cm hng v n ci trn mi!
</p>
<img src="50.jpg" alt="Bo Tng Phng Trng By Ngh Thut Di Sn Qu Gi"/>

    `,internalImageNames:["48.jpg","49.jpg","50.jpg","51.jpg","52.jpg"]},slug:{en:"precious-heritage-art-gallery-museum",ru:"muzey-galereya-iskusstva-tsennogo-naslediya",es:"museo-galeria-arte-patrimonio-precioso",fr:"musee-galerie-art-patrimoine-precieux",vn:"bao-tang-phong-trung-bay-nghe-thuat-di-san-quy-gia"}}],R6=[{id:"hill-station",coordinates:[15.877801450043398,108.33391777335922],category:["food-drinks"],imageUrl:"53.jpg",en:{title:"The Hill Station Deli & Boutique",description:"Specializing in local produce and fresh ingredients, offering a delicious menu with a focus on quality.",fullDescription:`
<p>Located in the heart of Hoi Ans Ancient Town, The Hill Station Deli & Boutique has been a culinary landmark since 2011. Our journey began with a simple idea: to bring the freshness of local produce and the richness of global culinary traditions to our guests. We started small, with a cozy deli serving artisanal sandwiches, salads, and homemade pastries.</p>

<p>Over the years, we've grown, but our core philosophy remains unchanged: quality ingredients, exceptional flavors, and a welcoming atmosphere. We believe in sourcing the freshest local produce, supporting local farmers and suppliers whenever possible. This commitment to freshness is evident in every dish we serve, from our vibrant salads to our hearty mains.</p>

<h6>Our Culinary Philosophy</h6>
<p>At The Hill Station, we are passionate about food. Our menu is a reflection of our dedication to creating unique and memorable dining experiences. We blend traditional Vietnamese flavors with international culinary techniques, offering a diverse selection that caters to various tastes. Whether you're craving a light bite or a satisfying meal, our kitchen is always bustling with creativity.</p>

<p>Our deli counter is a highlight, featuring an array of freshly baked goods, charcuterie, and cheeses. Its the perfect spot to grab a quick and delicious lunch, or to stock up on gourmet provisions for a picnic by the river. Our boutique section offers a curated selection of unique gifts, local handicrafts, and specialty food products, making it a great place to find a souvenir or a treat for yourself.</p>

<h6>A Community Hub</h6>
<p>More than just a restaurant, The Hill Station is a place where locals and travelers connect. Weve become a beloved gathering spot, known for our relaxed ambiance and friendly service. We often host special events, from wine tastings to cooking classes, inviting our guests to experience the rich culture of Hoi An through its food.</p>

<p>We are constantly innovating, exploring new recipes, and experimenting with flavors. Our team of talented chefs and passionate staff are dedicated to ensuring every visit is a delightful one. We invite you to join us at The Hill Station Deli & Boutique, where good food, good company, and good times are always on the menu.</p>
      `,internalImageNames:["hill_station_interior.jpg","hill_station_food.jpg","hill_station_exterior.jpg"]},es:{title:"The Hill Station Deli & Boutique",description:"Especializado en productos locales e ingredientes frescos, ofreciendo un delicioso men con nfasis en la calidad.",fullDescription:`
<p>Ubicado en el corazn del Casco Antiguo de Hoi An, The Hill Station Deli & Boutique ha sido un punto de referencia culinario desde 2011. Nuestro viaje comenz con una idea simple: llevar la frescura de los productos locales y la riqueza de las tradiciones culinarias globales a nuestros huspedes. Comenzamos pequeos, con una acogedora charcutera que serva sndwiches artesanales, ensaladas y repostera casera.</p>

<p>A lo largo de los aos, hemos crecido, pero nuestra filosofa principal sigue siendo la misma: ingredientes de calidad, sabores excepcionales y un ambiente acogedor. Creemos en la obtencin de los productos locales ms frescos, apoyando a los agricultores y proveedores locales siempre que sea posible. Este compromiso con la frescura es evidente en cada plato que servimos, desde nuestras vibrantes ensaladas hasta nuestros abundantes platos principales.</p>

<h6>Nuestra Filosofa Culinaria</h6>
<p>En The Hill Station, nos apasiona la comida. Nuestro men es un reflejo de nuestra dedicacin a crear experiencias gastronmicas nicas y memorables. Fusionamos sabores vietnamitas tradicionales con tcnicas culinarias internacionales, ofreciendo una seleccin diversa que satisface una amplia gama de gustos. Ya sea que busques un bocado ligero o una comida sustanciosa, nuestra cocina siempre est llena de creatividad.</p>

<p>Nuestro mostrador de charcutera es un punto destacado, con una variedad de productos horneados frescos, embutidos y quesos. Es el lugar perfecto para un almuerzo rpido y delicioso, o para abastecerse de provisiones gourmet para un picnic junto al ro. Nuestra seccin de boutique ofrece una cuidada seleccin de regalos nicos, artesanas locales y productos alimenticios especiales, lo que lo convierte en un excelente lugar para encontrar un recuerdo o un capricho para ti.</p>

<h6>Un Centro Comunitario</h6>
<p>Ms que un simple restaurante, The Hill Station es un lugar donde se conectan lugareos y viajeros. Nos hemos convertido en un lugar de reunin muy querido, conocido por nuestro ambiente relajado y nuestro servicio amable. A menudo organizamos eventos especiales, desde catas de vino hasta clases de cocina, invitando a nuestros huspedes a experimentar la rica cultura de Hoi An a travs de su comida.</p>

<p>Estamos en constante innovacin, explorando nuevas recetas y experimentando con sabores. Nuestro equipo de talentosos chefs y personal apasionado se dedica a garantizar que cada visita sea una delicia. Te invitamos a unirte a nosotros en The Hill Station Deli & Boutique, donde la buena comida, la buena compaa y los buenos momentos siempre estn en el men.</p>
      `,internalImageNames:["hill_station_interior.jpg","hill_station_food.jpg","hill_station_exterior.jpg"]},fr:{title:"The Hill Station Deli & Boutique",description:"Spcialis dans les produits locaux et les ingrdients frais, offrant un menu dlicieux ax sur la qualit.",fullDescription:`
<p>Situ au cur de l'Ancienne Ville de Hoi An, The Hill Station Deli & Boutique est un point de repre culinaire depuis 2011. Notre aventure a commenc par une ide simple : apporter la fracheur des produits locaux et la richesse des traditions culinaires mondiales  nos htes. Nous avons commenc petit, avec un charmant deli servant des sandwichs artisanaux, des salades et des ptisseries faites maison.</p>

<p>Au fil des ans, nous avons grandi, mais notre philosophie fondamentale reste inchange : des ingrdients de qualit, des saveurs exceptionnelles et une atmosphre accueillante. Nous nous engageons  nous procurer les produits locaux les plus frais, en soutenant les agriculteurs et les fournisseurs locaux dans la mesure du possible. Cet engagement envers la fracheur est vident dans chaque plat que nous servons, de nos salades vibrantes  nos plats principaux copieux.</p>

<h6>Notre Philosophie Culinaire</h6>
<p>Chez The Hill Station, nous sommes passionns par la nourriture. Notre menu est le reflet de notre dvouement  crer des expriences culinaires uniques et mmorables. Nous mlons les saveurs vietnamiennes traditionnelles aux techniques culinaires internationales, offrant une slection diversifie qui rpond  tous les gots. Que vous ayez envie d'une collation lgre ou d'un repas copieux, notre cuisine est toujours en bullition de crativit.</p>

<p>Notre comptoir de charcuterie est un atout majeur, proposant une gamme de produits de boulangerie frachement prpars, de charcuteries et de fromages. C'est l'endroit idal pour prendre un djeuner rapide et dlicieux, ou pour faire le plein de provisions gourmandes pour un pique-nique au bord de la rivire. Notre section boutique offre une slection minutieuse de cadeaux uniques, d'artisanat local et de produits alimentaires spcialiss, ce qui en fait un excellent endroit pour trouver un souvenir ou une gterie pour vous-mme.</p>

<h6>Un Centre Communautaire</h6>
<p>Plus qu'un simple restaurant, The Hill Station est un lieu de rencontre pour les habitants et les voyageurs. Nous sommes devenus un lieu de rassemblement apprci, rput pour son ambiance dtendue et son service amical. Nous organisons souvent des vnements spciaux, des dgustations de vin aux cours de cuisine, invitant nos htes  dcouvrir la riche culture de Hoi An  travers sa cuisine.</p>

<p>Nous innovons constamment, explorons de nouvelles recettes et exprimentons des saveurs. Notre quipe de chefs talentueux et de personnel passionn s'engage  faire de chaque visite un moment agrable. Nous vous invitons  nous rejoindre  The Hill Station Deli & Boutique, o bonne cuisine, bonne compagnie et bons moments sont toujours au menu.</p>
      `,internalImageNames:["hill_station_interior.jpg","hill_station_food.jpg","hill_station_exterior.jpg"]},ru:{title:"The Hill Station Deli & Boutique",description:"      ,       .",fullDescription:`
<p>      , The Hill Station Deli & Boutique     2011 .      :           .    ,   ,    ,    .</p>

<img src="hill_station_interior.jpg" alt=" The Hill Station"/>

<p>    ,      :  ,     .        ,       .       ,   ,        .</p>

<h6>  </h6>
<p> The Hill Station   .             .         ,   ,     .   ,        ,     .</p>

<p>    ,     ,   .   ,            .  -      ,       ,     ,     -  .</p>

<h6> </h6>
<p>The Hill Station     ,  ,      .     ,       .     ,      -,           .</p>

<p>   ,       .          ,     .        The Hill Station Deli & Boutique,   ,        .</p>
      `,internalImageNames:["hill_station_interior.jpg","hill_station_food.jpg","hill_station_exterior.jpg"]},vn:{title:"The Hill Station Deli & Boutique",description:"Chuyn v sn phm a phng v nguyn liu ti ngon, cung cp thc n hp dn vi trng tm vo cht lng.",fullDescription:`
<p>Nm  trung tm Ph c Hi An, The Hill Station Deli & Boutique  l mt im n m thc t nm 2011. Hnh trnh ca chng ti bt u vi mt  tng n gin: mang s ti ngon ca sn phm a phng v s phong ph ca truyn thng m thc ton cu n vi khch hng. Chng ti bt u nh, vi mt ca hng deli m cng phc v bnh m sandwich th cng, salad v bnh ngt t lm.</p>

<p>Trong nhng nm qua, chng ti  pht trin, nhng trit l ct li ca chng ti vn khng thay i: nguyn liu cht lng, hng v c bit v khng kh m cng. Chng ti tin vo vic tm ngun sn phm a phng ti ngon nht, h tr nng dn v nh cung cp a phng bt c khi no c th. Cam kt v s ti ngon ny th hin r trong mi mn n chng ti phc v, t nhng mn salad sng ng n nhng mn chnh thnh son.</p>

<h6>Trit l m thc ca chng ti</h6>
<p>Ti The Hill Station, chng ti am m m thc. Thc n ca chng ti l s phn nh s cng hin ca chng ti  to ra nhng tri nghim n ung c o v ng nh. Chng ti pha trn hng v truyn thng Vit Nam vi cc k thut m thc quc t, cung cp mt la chn a dng phc v nhiu khu v khc nhau. Cho d bn ang thm mt mn n nh hay mt ba n no, nh bp ca chng ti lun trn ngp s sng to.</p>

<p>Quy deli ca chng ti l mt im nhn, vi mt lot cc mn nng mi ra l, tht ngui v ph mai. y l ni hon ho  c mt ba tra nhanh chng v ngon ming, hoc  tch tr cc mn  n ngon cho mt bui d ngoi bn sng. Phn ca hng boutique ca chng ti cung cp mt la chn tuyn chn cc mn qu c o,  th cng m ngh a phng v cc sn phm thc phm c bit, lm cho n tr thnh mt ni tuyt vi  tm mt mn qu lu nim hoc mt mn qu t thng cho bn thn.</p>

<h6>Mt Trung tm Cng ng</h6>
<p>Khng ch l mt nh hng, The Hill Station cn l ni kt ni ngi dn a phng v du khch. Chng ti  tr thnh mt a im t hp c yu thch, ni ting vi khng kh th gin v dch v thn thin. Chng ti thng t chc cc s kin c bit, t nm ru vang n cc lp hc nu n, mi khch ca chng ti tri nghim vn ha phong ph ca Hi An thng qua m thc ca n.</p>

<img src="hill_station_exterior.jpg" alt="Ngoi tht The Hill Station"/>

<p>Chng ti khng ngng i mi, khm ph cc cng thc nu n mi v th nghim hng v. i ng u bp ti nng v nhn vin nhit tnh ca chng ti tn tm m bo mi chuyn thm l mt tri nghim th v. Chng ti mi bn n The Hill Station Deli & Boutique, ni lun c  n ngon, bn b tt v nhng khonh khc tuyt vi trong thc n.</p>
      `,internalImageNames:["hill_station_interior.jpg","hill_station_food.jpg","hill_station_exterior.jpg"]},slug:{en:"japanese-covered-bridge",ru:"yaponskiy-krytyy-most",es:"puente-cubierto-japones",fr:"pont-couvert-japonais",vn:"cau-chua-nhat-ban"}},{id:"sua-vegan-restaurant",coordinates:[15.883638636542983,108.32000846236811],category:["food-drinks"],imageUrl:"58.jpg",en:{title:"Sua Vegan Restaurant",description:"A special and heartwarming vegan restaurant in Hoi An, renowned for its delicious plant-based cuisine and its unique mission of employing deaf and mute staff.",fullDescription:`
<p><strong>Sua Vegan Restaurant</strong> in Hoi An is more than just a place to eat; it's a truly special establishment known for its delicious vegan food and its incredibly inspiring social mission. What sets Sua apart is its commitment to employing and empowering <strong>deaf and mute individuals</strong>, offering them meaningful opportunities and fostering a unique, heartwarming dining experience.</p>

<h6>A Special Place with a Heartfelt Mission:</h6>
<ul>
  <li><strong>Empowering Employment:</strong> Sua Vegan Restaurant provides invaluable employment opportunities for deaf and mute people, giving them a platform to showcase their skills and contribute to the community. This initiative highlights inclusivity and creates a supportive environment.</li>
  <li><strong>Unique Communication:</strong> Don't be surprised by a slightly different but charming way of ordering. The staff are adept at communicating through a combination of written notes, gestures, and a warm, welcoming attitude. It's an opportunity for guests to engage in a unique and respectful interaction.</li>
  <li><strong>Inspiring Atmosphere:</strong> The presence of the dedicated and hardworking staff contributes to an incredibly positive and humble atmosphere. Many visitors find their experience here deeply moving and memorable.</li>
</ul>

<h6>Vegan Delights:</h6>
<ul>
  <li><strong>Pure Plant-Based Cuisine:</strong> As the name suggests, Sua is entirely vegan, offering a diverse menu of plant-based dishes that are both healthy and incredibly flavorful.</li>
  <li><strong>Vietnamese & Fusion:</strong> The menu typically features a blend of traditional Vietnamese vegan dishes (like fresh spring rolls, various noodle soups, rice dishes) alongside some creative fusion options.</li>
  <li><strong>Fresh Ingredients:</strong> Emphasis is placed on fresh, local vegetables, herbs, and plant-based proteins, ensuring vibrant and wholesome meals.</li>
  <li><strong>Dietary Friendly:</strong> A great choice for vegans, vegetarians, and anyone looking for healthy, light, and flavorful meals.</li>
</ul>

<h6>Atmosphere & Ambiance:</h6>
<ul>
  <li><strong>Calm and Serene:</strong> Despite being popular, the atmosphere often remains calm and peaceful, allowing guests to relax and savor their meals.</li>
  <li><strong>Authentic Charm:</strong> The decor is usually simple yet charming, reflecting traditional Vietnamese aesthetics with a modern, clean twist.</li>
</ul>

<h6>Location:</h6>
<p>Sua Vegan Restaurant is typically located within or near the central Ancient Town area of Hoi An, making it convenient for tourists exploring the historical sites. Its exact address might be found on a quieter street, offering a peaceful escape from the main crowds.</p>
<p><strong>Always verify the exact address locally or on recent online maps, as businesses can sometimes change locations.</strong></p>

<h6>Visitor Tips:</h6>
<ul>
  <li><strong>Be Patient and Respectful:</strong> Embrace the unique communication style. A smile and a clear written note often go a long way.</li>
  <li><strong>Support the Mission:</strong> By dining here, you are directly supporting a wonderful social enterprise.</li>
  <li><strong>Try the Local Specialties:</strong> Explore their vegan versions of classic Vietnamese dishes.</li>
  <li><strong>Consider Lunch:</strong> It's a great spot for a healthy and satisfying lunch during your exploration of Hoi An.</li>
</ul>
      `,internalImageNames:[]},es:{title:"Sua Vegan Restaurant",description:"Un restaurante vegano especial y conmovedor en Hoi An, famoso por su deliciosa cocina a base de plantas y su misin nica de emplear personal sordo y mudo.",fullDescription:`
<p><strong>Sua Vegan Restaurant</strong> en Hoi An es ms que un simple lugar para comer; es un establecimiento verdaderamente especial conocido por su deliciosa comida vegana y su increble misin social inspiradora. Lo que distingue a Sua es su compromiso de emplear y empoderar a <strong>personas sordas y mudas</strong>, ofrecindoles oportunidades significativas y fomentando una experiencia gastronmica nica y conmovedora.</p>

<h6>Un Lugar Especial con una Misin Sincera:</h6>
<ul>
  <li><strong>Empleo Empoderador:</strong> Sua Vegan Restaurant brinda oportunidades de empleo invaluables para personas sordas y mudas, dndoles una plataforma para mostrar sus habilidades y contribuir a la comunidad. Esta iniciativa destaca la inclusin y crea un ambiente de apoyo.</li>
  <li><strong>Comunicacin nica:</strong> No se sorprenda por una forma de pedir un poco diferente pero encantadora. El personal es experto en comunicarse a travs de una combinacin de notas escritas, gestos y una actitud clida y acogedora. Es una oportunidad para que los huspedes se involucren en una interaccin nica y respetuosa.</li>
  <li><strong>Ambiente Inspirador:</strong> La presencia del personal dedicado y trabajador contribuye a una atmsfera increblemente positiva y humilde. Muchos visitantes encuentran su experiencia aqu profundamente conmovedora y memorable.</li>
</ul>

<h6>Delicias Veganas:</h6>
<ul>
  <li><strong>Cocina Pura a Base de Plantas:</strong> Como su nombre lo indica, Sua es completamente vegano, ofreciendo un men diverso de platos a base de plantas que son saludables y increblemente sabrosos.</li>
  <li><strong>Vietnamita y Fusin:</strong> El men generalmente presenta una mezcla de platos veganos vietnamitas tradicionales (como rollitos de primavera frescos, varias sopas de fideos, platos de arroz) junto con algunas opciones de fusin creativas.</li>
  <li><strong>Ingredientes Frescos:</strong> Se hace hincapi en verduras, hierbas y protenas vegetales frescas y locales, lo que garantiza comidas vibrantes y saludables.</li>
  <li><strong>Apto para Dietas:</strong> Una excelente opcin para veganos, vegetarianos y cualquiera que busque comidas saludables, ligeras y sabrosas.</li>
</ul>

<h6>Atmsfera y Ambiente:</h6>
<ul>
  <li><strong>Tranquilo y Sereno:</strong> A pesar de ser popular, el ambiente a menudo se mantiene tranquilo y pacfico, lo que permite a los huspedes relajarse y saborear sus comidas.</li>
  <li><strong>Encanto Autntico:</strong> La decoracin suele ser sencilla pero encantadora, lo que refleja la esttica tradicional vietnamita con un toque moderno y limpio.</li>
</ul>

<h6>Ubicacin:</h6>
<p>Sua Vegan Restaurant suele estar ubicado dentro o cerca del rea central del Casco Antiguo de Hoi An, lo que lo hace conveniente para los turistas que exploran los sitios histricos. Su direccin exacta podra encontrarse en una calle ms tranquila, ofreciendo un escape pacfico de las principales multitudes.</p>
<p><strong>Siempre verifique la direccin exacta a nivel local o en mapas en lnea recientes, ya que los negocios a veces pueden cambiar de ubicacin.</strong></p>

<h6>Consejos para Visitantes:</h6>
<ul>
  <li><strong>Sea Paciente y Respetuoso:</strong> Adopte el estilo de comunicacin nico. Una sonrisa y una nota escrita clara suelen ser muy tiles.</li>
  <li><strong>Apoye la Misin:</strong> Al cenar aqu, est apoyando directamente una maravillosa empresa social.</li>
  <li><strong>Pruebe las Especialidades Locales:</strong> Explore sus versiones veganas de platos vietnamitas clsicos.</li>
  <li><strong>Considere Almorzar:</strong> Es un gran lugar para un almuerzo saludable y satisfactorio durante su exploracin de Hoi An.</li>
</ul>
      `,internalImageNames:[]},fr:{title:"Sua Vegan Restaurant",description:"Un restaurant vgtalien spcial et chaleureux  Hoi An, rput pour sa dlicieuse cuisine  base de plantes et sa mission unique d'employer du personnel sourd et muet.",fullDescription:`
<p><strong>Sua Vegan Restaurant</strong>  Hoi An est bien plus qu'un simple endroit pour manger ; c'est un tablissement vritablement spcial, connu pour sa dlicieuse cuisine vgtalienne et sa mission sociale incroyablement inspirante. Ce qui distingue Sua est son engagement  employer et  autonomiser les <strong>personnes sourdes et muettes</strong>, en leur offrant des opportunits significatives et en favorisant une exprience culinaire unique et mouvante.</p>

<h6>Un Lieu Spcial avec une Mission Sincre :</h6>
<ul>
  <li><strong>Emploi Autonomisant :</strong> Le Sua Vegan Restaurant offre des opportunits d'emploi inestimables aux personnes sourdes et muettes, leur donnant une plateforme pour montrer leurs comptences et contribuer  la communaut. Cette initiative met en lumire l'inclusion et cre un environnement de soutien.</li>
  <li><strong>Communication Unique :</strong> Ne soyez pas surpris par une faon de commander lgrement diffrente mais charmante. Le personnel est habile  communiquer par une combinaison de notes crites, de gestes et d'une attitude chaleureuse et accueillante. C'est une opportunit pour les clients de s'engager dans une interaction unique et respectueuse.</li>
  <li><strong>Atmosphre Inspirante :</strong> La prsence du personnel dvou et travailleur contribue  une atmosphre incroyablement positive et humble. De nombreux visiteurs trouvent leur exprience ici profondment mouvante et mmorable.</li>
</ul>

<h6>Dlices Vgtaliens :</h6>
<ul>
  <li><strong>Cuisine Purement Vgtale :</strong> Comme son nom l'indique, Sua est entirement vgtalien, offrant un menu diversifi de plats  base de plantes qui sont  la fois sains et incroyablement savoureux.</li>
  <li><strong>Vietnamien & Fusion :</strong> Le menu propose gnralement un mlange de plats vgtaliens vietnamiens traditionnels (comme les rouleaux de printemps frais, diverses soupes de nouilles, plats de riz) ainsi que des options de fusion cratives.</li>
  <li><strong>Ingrdients Frais :</strong> L'accent est mis sur les lgumes, les herbes et les protines vgtales frais et locaux, garantissant des repas vibrants et sains.</li>
  <li><strong>Adapt aux Rgimes :</strong> Un excellent choix pour les vgtaliens, les vgtariens et toute personne  la recherche de repas sains, lgers et savoureux.</li>
</ul>

<h6>Atmosphre & Ambiance :</h6>
<ul>
  <li><strong>Calme et Serein :</strong> Bien qu'tant populaire, l'atmosphre reste souvent calme et paisible, permettant aux clients de se dtendre et de savourer leurs repas.</li>
  <li><strong>Charme Authentique :</strong> Le dcor est gnralement simple mais charmant, refltant l'esthtique traditionnelle vietnamienne avec une touche moderne et pure.</li>
</ul>

<h6>Localisation :</h6>
<p>Le Sua Vegan Restaurant est gnralement situ dans ou  proximit de la zone centrale de la Vieille Ville de Hoi An, ce qui le rend pratique pour les touristes explorant les sites historiques. Son adresse exacte pourrait se trouver dans une rue plus calme, offrant une vasion paisible des principales foules.</p>
<p><strong>Veuillez toujours vrifier l'adresse exacte localement ou sur des cartes en ligne rcentes, car les entreprises peuvent parfois changer d'emplacement.</strong></p>

<h6>Conseils pour les Visiteurs :</h6>
<ul>
  <li><strong>Soyez Patient et Respectueux :</strong> Adoptez le style de communication unique. Un sourire et une note crite claire sont souvent trs utiles.</li>
  <li><strong>Soutenez la Mission :</strong> En dnant ici, vous soutenez directement une merveilleuse entreprise sociale.</li>
  <li><strong>Gotez les Spcialits Locales :</strong> Explorez leurs versions vgtaliennes des plats vietnamiens classiques.</li>
  <li><strong>Considrez le Djeuner :</strong> C'est un excellent endroit pour un djeuner sain et satisfaisant lors de votre exploration de Hoi An.</li>
</ul>
      `,internalImageNames:[]},ru:{title:"Sua Vegan Restaurant",description:"      ,            .",fullDescription:`
<p><strong>Sua Vegan Restaurant</strong>       ,   ;    ,          .   Sua,           <strong> </strong>,       ,   .</p>

<h6>    :</h6>
<ul>
  <li><strong>     :</strong> Sua Vegan Restaurant       ,            .        .</li>
  <li><strong> :</strong>    ,    .        ,   ,  .          .</li>
  <li><strong> :</strong>             .          .</li>
</ul>

<h6> :</h6>
<ul>
  <li><strong>  :</strong>    , Sua  ,      ,       .</li>
  <li><strong>  :</strong>           (,  -,    ,  )     -.</li>
  <li><strong> :</strong>      ,    ,      .</li>
  <li><strong>   :</strong>    ,   ,   ,    .</li>
</ul>

<h6>  :</h6>
<ul>
  <li><strong>  :</strong>   ,      ,      .</li>
  <li><strong> :</strong>   ,  ,      ,  .</li>
</ul>

<h6>:</h6>
<p>Sua Vegan Restaurant             ,      ,   .          ,      .</p>
<p><strong>         -,        .</strong></p>

<h6>  :</h6>
<ul>
  <li><strong>   :</strong>    .        .</li>
  <li><strong> :</strong>  ,      .</li>
  <li><strong>  :</strong>       .</li>
  <li><strong> :</strong>              .</li>
</ul>
      `,internalImageNames:[]},vn:{title:"Sua Vegan Restaurant",description:"Mt nh hng thun chay c bit v m p  Hi An, ni ting vi m thc thc vt ngon ming v s mnh c o l tuyn dng nhn vin khim thnh v khim ngn.",fullDescription:`
<p><strong>Sua Vegan Restaurant</strong>  Hi An khng ch l mt ni  n ung; y l mt c s thc s c bit, ni ting vi cc mn n chay thm ngon v s mnh x hi y cm hng. iu lm nn s khc bit ca Sua l cam kt tuyn dng v trao quyn cho <strong>nhng ngi khim thnh v khim ngn</strong>, mang n cho h nhng c hi c  ngha v to ra tri nghim n ung c o, m lng.</p>

<h6>Mt a im c bit vi S mnh T tm:</h6>
<ul>
  <li><strong>Trao quyn Thng qua Vic lm:</strong> Sua Vegan Restaurant cung cp cc c hi vic lm v gi cho ngi khim thnh v khim ngn, to cho h mt nn tng  th hin k nng v ng gp cho cng ng. Sng kin ny  cao s ha nhp v to ra mt mi trng h tr.</li>
  <li><strong>Giao tip c o:</strong> ng ngc nhin bi mt cch gi mn hi khc nhng duyn dng. Nhn vin thng tho giao tip thng qua s kt hp ca ghi ch vit tay, c ch v thi  nng nhit, hiu khch. y l c hi  khch hng tham gia vo mt tng tc c o v tn trng.</li>
  <li><strong>Khng gian Truyn cm hng:</strong> S hin din ca i ng nhn vin tn tm v chm ch gp phn to nn mt khng kh v cng tch cc v khim tn. Nhiu du khch nhn thy tri nghim ca h  y v cng cm ng v ng nh.</li>
</ul>

<h6> n chay ngon ming:</h6>
<ul>
  <li><strong>m thc Thun thc vt:</strong> ng nh tn gi, Sua hon ton thun chay, cung cp thc n a dng cc mn n t thc vt, va tt cho sc khe va v cng m  hng v.</li>
  <li><strong>Mn Vit & Fusion:</strong> Thc n thng c s pha trn gia cc mn n chay truyn thng Vit Nam (nh nem ti, cc loi bn, cm) cng vi mt s la chn fusion sng to.</li>
  <li><strong>Nguyn liu Ti sng:</strong> S nhn mnh c t vo cc loi rau, tho mc v protein thc vt ti, a phng, m bo cc ba n sng ng v b dng.</li>
  <li><strong>Ph hp vi Ch  n king:</strong> Mt la chn tuyt vi cho ngi n chay, ngi n chay trng v bt k ai ang tm kim nhng ba n lnh mnh, nh nhng v y hng v.</li>
</ul>

<h6>Bu khng kh & Khng gian:</h6>
<ul>
  <li><strong>Bnh yn v Thanh tnh:</strong> Mc d ni ting, khng gian thng vn bnh tnh v yn bnh, cho php khch th gin v thng thc ba n ca h.</li>
  <li><strong>Nt duyn dng Authenticity:</strong> Trang tr thng n gin nhng quyn r, phn nh nt thm m truyn thng Vit Nam vi mt cht hin i, sch s.</li>
</ul>

<h6>V tr:</h6>
<p>Sua Vegan Restaurant thng nm trong hoc rt gn khu vc Ph c Hi An, gip khch du lch d dng tip cn  khm ph cc di tch lch s. a ch chnh xc ca n c th nm trn mt con ph yn tnh hn, mang n mt li thot bnh yn khi m ng chnh.</p>
<p><strong>Lun xc minh a ch chnh xc ti a phng hoc trn cc bn  trc tuyn gn y, v cc doanh nghip i khi c th thay i v tr.</strong></p>

<h6>Mo dnh cho Du khch:</h6>
<ul>
  <li><strong>Hy Kin nhn v Tn trng:</strong> Chp nhn phong cch giao tip c o. Mt n ci v mt ghi ch vit r rng thng rt hu ch.</li>
  <li><strong>ng h S mnh:</strong> Bng cch dng ba ti y, bn ang trc tip ng h mt doanh nghip x hi tuyt vi.</li>
  <li><strong>Th cc Mn c sn a phng:</strong> Khm ph cc phin bn chay ca cc mn n Vit Nam c in ca h.</li>
  <li><strong>Cn nhc dng Ba tra:</strong> y l mt a im tuyt vi cho mt ba tra lnh mnh v no bng trong chuyn khm ph Hi An ca bn.</li>
</ul>
      `,internalImageNames:[]},slug:{en:"japanese-covered-bridge",ru:"yaponskiy-krytyy-most",es:"puente-cubierto-japones",fr:"pont-couvert-japonais",vn:"cau-chua-nhat-ban"}}],z6=[{id:"Rainbow-Coffee-Restaurant-Hoi-An",coordinates:[15.906708185789533,108.31573872344867],category:["food-drinks","art-galleries"],imageUrl:"57.jpg",en:{title:"Rainbow Coffee & Restaurant",description:"A charming and popular spot in Hoi An, offering a wide range of Vietnamese and Western dishes, refreshing drinks, and a cozy atmosphere.",fullDescription:`
<p><strong>Rainbow Coffee & Restaurant</strong> is a well-loved establishment in Hoi An, frequently praised by both locals and tourists for its diverse menu, warm hospitality, and relaxed ambiance. It's a versatile spot perfect for a quick coffee, a leisurely lunch, or a satisfying dinner.</p>

<h6>Atmosphere & Vibe:</h6>
<ul>
  <li><strong>Cozy and Welcoming:</strong> The restaurant often features a charming interior, possibly with traditional Vietnamese elements, wooden furniture, and warm lighting, creating a comfortable and inviting space.</li>
  <li><strong>Relaxed Ambiance:</strong> Ideal for unwinding, whether you're starting your day with coffee or enjoying an evening meal. It often offers a peaceful escape from the bustling streets of Hoi An.</li>
  <li><strong>Friendly Staff:</strong> Consistently highlighted in reviews, the staff are known for being attentive, friendly, and providing excellent service, often with a good grasp of English.</li>
</ul>

<h6>Food & Drinks:</h6>
<ul>
  <li><strong>Extensive Menu:</strong> Rainbow offers a broad selection that typically spans both authentic Vietnamese cuisine (like Pho, Cao Lau, White Rose dumplings) and popular Western dishes (burgers, pasta, sandwiches). This makes it a great choice for groups with varied preferences.</li>
  <li><strong>Quality Coffee:</strong> As the name suggests, coffee is a specialty, including traditional Vietnamese coffee (iced or hot) and various espresso-based drinks.</li>
  <li><strong>Refreshing Beverages:</strong> Besides coffee, the menu usually includes fresh fruit juices, smoothies, local beers, and soft drinks.</li>
  <li><strong>Good Value:</strong> Many visitors find the prices to be very reasonable for the quality and portion sizes offered.</li>
</ul>

<h6>Highlights for Visitors:</h6>
<ul>
  <li><strong>Local & International Choices:</strong> The ability to choose between local delicacies and familiar Western comfort food is a big draw.</li>
  <li><strong>Great for All Meals:</strong> Suitable for breakfast, lunch, or dinner, offering a consistent and pleasant dining experience throughout the day.</li>
  <li><strong>Relaxing Stop:</strong> A perfect place to take a break from exploring the Ancient Town, recharge, and enjoy a good meal or drink.</li>
</ul>

<h6>Location:</h6>
<p>Rainbow Coffee & Restaurant is typically located within or very close to the Hoi An Ancient Town area, making it easily accessible for tourists exploring the historical sites. Its exact address is often found on one of the charming side streets or main arteries of the old town.</p>
<p><strong>Please verify the exact address locally or on recent online maps as specific locations in popular tourist areas can sometimes change.</strong></p>

<h6>Visitor Tips:</h6>
<ul>
  <li><strong>Try a Vietnamese Dish:</strong> Even if you prefer Western food, give a local specialty a try; they are often prepared authentically and deliciously.</li>
  <li><strong>Enjoy the Coffee:</strong> Don't miss out on their coffee, especially the traditional Vietnamese iced coffee.</li>
  <li><strong>Relax and Observe:</strong> Find a comfortable spot and enjoy the local atmosphere.</li>
</ul>
      `,internalImageNames:[]},es:{title:"Rainbow Coffee & Restaurant",description:"Un lugar encantador y popular en Hoi An, que ofrece una amplia variedad de platos vietnamitas y occidentales, bebidas refrescantes y un ambiente acogedor.",fullDescription:`
<p><strong>Rainbow Coffee & Restaurant</strong> es un establecimiento muy querido en Hoi An, frecuentemente elogiado por lugareos y turistas por su men diverso, clida hospitalidad y ambiente relajado. Es un lugar verstil perfecto para un caf rpido, un almuerzo tranquilo o una cena satisfactoria.</p>

<h6>Ambiente y Vibe:</h6>
<ul>
  <li><strong>Acogedor y Confortable:</strong> El restaurante a menudo presenta un interior encantador, posiblemente con elementos tradicionales vietnamitas, muebles de madera e iluminacin clida, creando un espacio cmodo y acogedor.</li>
  <li><strong>Ambiente Relajado:</strong> Ideal para relajarse, ya sea que ests comenzando tu da con caf o disfrutando de una comida por la noche. A menudo ofrece un escape tranquilo del bullicio de las calles de Hoi An.</li>
  <li><strong>Personal Amable:</strong> Destacado constantemente en las reseas, el personal es conocido por ser atento, amable y brindar un excelente servicio, a menudo con un buen dominio del ingls.</li>
</ul>

<h6>Comida y Bebidas:</h6>
<ul>
  <li><strong>Men Extenso:</strong> Rainbow ofrece una amplia seleccin que normalmente abarca tanto la autntica cocina vietnamita (como Pho, Cao Lau, White Rose dumplings) como platos occidentales populares (hamburguesas, pasta, sndwiches). Esto lo convierte en una excelente opcin para grupos con preferencias variadas.</li>
  <li><strong>Caf de Calidad:</strong> Como sugiere el nombre, el caf es una especialidad, incluyendo el caf vietnamita tradicional (helado o caliente) y varias bebidas a base de espresso.</li>
  <li><strong>Bebidas Refrescantes:</strong> Adems del caf, el men suele incluir zumos de frutas frescas, batidos, cervezas locales y refrescos.</li>
  <li><strong>Buena Relacin Calidad-Precio:</strong> Muchos visitantes encuentran que los precios son muy razonables para la calidad y el tamao de las porciones ofrecidas.</li>
</ul>

<h6>Aspectos Destacados para los Visitantes:</h6>
<ul>
  <li><strong>Opciones Locales e Internacionales:</strong> La capacidad de elegir entre delicias locales y comida reconfortante occidental familiar es un gran atractivo.</li>
  <li><strong>Ideal para Todas las Comidas:</strong> Adecuado para el desayuno, el almuerzo o la cena, ofreciendo una experiencia gastronmica consistente y agradable durante todo el da.</li>
  <li><strong>Parada Relajante:</strong> Un lugar perfecto para tomar un descanso de la exploracin de la Ciudad Antigua, recargar energas y disfrutar de una buena comida o bebida.</li>
</ul>

<h6>Ubicacin:</h6>
<p>Rainbow Coffee & Restaurant suele estar ubicado dentro o muy cerca del rea de la Ciudad Antigua de Hoi An, lo que lo hace fcilmente accesible para los turistas que exploran los sitios histricos. Su direccin exacta a menudo se encuentra en una de las encantadoras calles laterales o arterias principales del casco antiguo.</p>
<p><strong>Por favor, verifique la direccin exacta a nivel local o en mapas en lnea recientes, ya que las ubicaciones especficas en reas tursticas populares a veces pueden cambiar.</strong></p>

<h6>Consejos para Visitantes:</h6>
<ul>
  <li><strong>Pruebe un Plato Vietnamita:</strong> Incluso si prefiere la comida occidental, pruebe una especialidad local; a menudo se preparan de forma autntica y deliciosa.</li>
  <li><strong>Disfrute del Caf:</strong> No se pierda su caf, especialmente el caf helado vietnamita tradicional.</li>
  <li><strong>Reljese y Observe:</strong> Encuentre un lugar cmodo y disfrute del ambiente local.</li>
</ul>
      `,internalImageNames:[]},fr:{title:"Rainbow Coffee & Restaurant",description:"Un endroit charmant et populaire  Hoi An, offrant un large ventail de plats vietnamiens et occidentaux, des boissons rafrachissantes et une atmosphre chaleureuse.",fullDescription:`
<p>Le <strong>Rainbow Coffee & Restaurant</strong> est un tablissement trs apprci  Hoi An, frquemment lou par les habitants et les touristes pour son menu vari, son hospitalit chaleureuse et son ambiance dtendue. C'est un endroit polyvalent parfait pour un caf rapide, un djeuner tranquille ou un dner copieux.</p>

<h6>Ambiance & Vibe :</h6>
<ul>
  <li><strong>Confortable et Accueillant :</strong> Le restaurant prsente souvent un intrieur charmant, ventuellement avec des lments traditionnels vietnamiens, des meubles en bois et un clairage chaleureux, crant un espace confortable et invitant.</li>
  <li><strong>Ambiance Dtendu :</strong> Idal pour se dtendre, que vous commenciez votre journe avec un caf ou que vous profitiez d'un repas le soir. Il offre souvent une vasion paisible de l'agitation des rues de Hoi An.</li>
  <li><strong>Personnel Amical :</strong> Constamment soulign dans les critiques, le personnel est rput pour tre attentif, amical et offrir un excellent service, souvent avec une bonne matrise de l'anglais.</li>
</ul>

<h6>Cuisine & Boissons :</h6>
<ul>
  <li><strong>Menu tendu :</strong> Rainbow propose une large slection qui couvre gnralement  la fois la cuisine vietnamienne authentique (comme le Pho, le Cao Lau, les raviolis White Rose) et les plats occidentaux populaires (hamburgers, ptes, sandwichs). Cela en fait un excellent choix pour les groupes ayant des prfrences varies.</li>
  <li><strong>Caf de Qualit :</strong> Comme son nom l'indique, le caf est une spcialit, y compris le caf vietnamien traditionnel (glac ou chaud) et diverses boissons  base d'espresso.</li>
  <li><strong>Boissons Rafrachissantes :</strong> Outre le caf, le menu comprend gnralement des jus de fruits frais, des smoothies, des bires locales et des boissons gazeuses.</li>
  <li><strong>Bon Rapport Qualit-Prix :</strong> De nombreux visiteurs trouvent que les prix sont trs raisonnables pour la qualit et la taille des portions offertes.</li>
</ul>

<h6>Points Forts pour les Visiteurs :</h6>
<ul>
  <li><strong>Choix Locaux et Internationaux :</strong> La possibilit de choisir entre les dlices locaux et la cuisine rconfortante occidentale familire est un grand attrait.</li>
  <li><strong>Idal pour Tous les Repas :</strong> Convient pour le petit-djeuner, le djeuner ou le dner, offrant une exprience culinaire constante et agrable tout au long de la journe.</li>
  <li><strong>Arrt Relaxant :</strong> Un endroit parfait pour faire une pause dans l'exploration de la Vieille Ville, se ressourcer et profiter d'un bon repas ou d'une boisson.</li>
</ul>

<h6>Localisation :</h6>
<p>Le Rainbow Coffee & Restaurant est gnralement situ dans ou trs prs de la zone de la Vieille Ville de Hoi An, ce qui le rend facilement accessible aux touristes explorant les sites historiques. Son adresse exacte se trouve souvent dans l'une des charmantes rues secondaires ou des artres principales de la vieille ville.</p>
<p><strong>Veuillez vrifier l'adresse exacte localement ou sur des cartes en ligne rcentes, car les emplacements spcifiques dans les zones touristiques populaires peuvent parfois changer.</strong></p>

<h6>Conseils pour les Visiteurs :</h6>
<ul>
  <li><strong>Essayez un Plat Vietnamien :</strong> Mme si vous prfrez la cuisine occidentale, essayez une spcialit locale ; elles sont souvent prpares de manire authentique et dlicieuse.</li>
  <li><strong>Profitez du Caf :</strong> Ne manquez pas leur caf, en particulier le caf glac vietnamien traditionnel.</li>
  <li><strong>Dtendez-vous et Observez :</strong> Trouvez un endroit confortable et profitez de l'atmosphre locale.</li>
</ul>
      `,internalImageNames:[]},ru:{title:"Rainbow Coffee & Restaurant",description:"     ,       ,     .",fullDescription:`
<p><strong>Rainbow Coffee & Restaurant</strong>      ,      ,      ,     .   ,     ,     .</p>

<h6>  :</h6>
<ul>
  <li><strong>  :</strong>     , ,    ,     ,     .</li>
  <li><strong> :</strong>    ,         .        .</li>
  <li><strong> :</strong>        ,    ,      .</li>
</ul>

<h6>  :</h6>
<ul>
  <li><strong> :</strong> Rainbow   ,        (, ,  ,   ),      (, , ).          .</li>
  <li><strong> :</strong>    ,    ,     (   )      .</li>
  <li><strong> :</strong>  ,       , ,     .</li>
  <li><strong> :</strong>            .</li>
</ul>

<h6>  :</h6>
<ul>
  <li><strong>   :</strong>            .</li>
  <li><strong>     :</strong>   ,   ,          .</li>
  <li><strong> :</strong>  ,      ,       .</li>
</ul>

<h6>:</h6>
<p>Rainbow Coffee & Restaurant            ,       ,   .                .</p>
<p><strong>,         -,           .</strong></p>

<h6>  :</h6>
<ul>
  <li><strong>  :</strong>      ,    ;      .</li>
  <li><strong> :</strong>    ,      .</li>
  <li><strong>  :</strong>       .</li>
</ul>
      `,internalImageNames:[]},vn:{title:"Rainbow Coffee & Restaurant",description:"Mt a im quyn r v ni ting  Hi An, cung cp nhiu mn n Vit Nam v phng Ty,  ung gii kht v khng gian m cng.",fullDescription:`
<p><strong>Rainbow Coffee & Restaurant</strong> l mt c s c yu thch  Hi An, thng xuyn c c ngi dn a phng v khch du lch khen ngi v thc n a dng, s hiu khch nng hu v khng gian th gin. y l mt a im a nng hon ho cho mt ly c ph nhanh, mt ba tra nhn nh hoc mt ba ti thnh son.</p>

<h6>Bu khng kh & Cm nhn:</h6>
<ul>
  <li><strong>m cng v n tip:</strong> Nh hng thng c ni tht quyn r, c th vi cc yu t truyn thng Vit Nam,  ni tht bng g v nh sng m p, to nn mt khng gian thoi mi v mi gi.</li>
  <li><strong>Khng gian Th gin:</strong> L tng  th gin, cho d bn ang bt u ngy mi vi c ph hay thng thc ba n ti. Ni y thng mang n mt li thot yn bnh khi nhng con ph nhn nhp ca Hi An.</li>
  <li><strong>Nhn vin Thn thin:</strong> Lin tc c nhn mnh trong cc nh gi, nhn vin c bit n l chu o, thn thin v cung cp dch v tuyt vi, thng thnh tho ting Anh.</li>
</ul>

<h6> n & Thc ung:</h6>
<ul>
  <li><strong>Thc n Phong ph:</strong> Rainbow cung cp nhiu la chn a dng, thng bao gm c m thc Vit Nam truyn thng (nh Ph, Cao Lu, bnh bao Bng Hng Trng) v cc mn n phng Ty ph bin (burger, m ng, sandwich). iu ny lm cho ni y tr thnh mt la chn tuyt vi cho cc nhm c s thch khc nhau.</li>
  <li><strong>C ph Cht lng:</strong> ng nh tn gi, c ph l mt c sn, bao gm c ph truyn thng Vit Nam ( hoc nng) v nhiu loi  ung pha ch t espresso khc nhau.</li>
  <li><strong>Thc ung Gii kht:</strong> Ngoi c ph, thc n thng bao gm nc p tri cy ti, sinh t, bia a phng v nc ngt.</li>
  <li><strong>Gi c Hp l:</strong> Nhiu du khch nhn thy gi c rt hp l so vi cht lng v kch thc khu phn c cung cp.</li>
</ul>

<h6>im ni bt cho Du khch:</h6>
<ul>
  <li><strong>La chn a phng & Quc t:</strong> Kh nng la chn gia cc mn ngon a phng v cc mn n phng Ty quen thuc l mt im thu ht ln.</li>
  <li><strong>Tuyt vi cho mi ba n:</strong> Ph hp cho ba sng, ba tra hoc ba ti, mang n tri nghim n ung nht qun v d chu sut c ngy.</li>
  <li><strong>im dng chn Th gin:</strong> Mt ni hon ho  ngh ngi sau khi khm ph Ph c, np li nng lng v thng thc mt ba n ngon hoc  ung.</li>
</ul>

<h6>V tr:</h6>
<p>Rainbow Coffee & Restaurant thng nm trong hoc rt gn khu vc Ph c Hi An, gip du khch d dng tip cn  khm ph cc di tch lch s. a ch chnh xc ca n thng nm trn mt trong nhng con ph nh quyn r hoc cc tuyn ng chnh ca ph c.</p>
<p><strong>Vui lng xc minh a ch chnh xc ti a phng hoc trn bn  trc tuyn gn y v cc a im c th  cc khu du lch ni ting i khi c th thay i.</strong></p>

<h6>Mo dnh cho Du khch:</h6>
<ul>
  <li><strong>Th mt mn n Vit Nam:</strong> Ngay c khi bn thch  n phng Ty, hy th mt c sn a phng; chng thng c ch bin mt cch chn thc v ngon ming.</li>
  <li><strong>Thng thc c ph:</strong> ng b l c ph ca h, c bit l c ph  truyn thng ca Vit Nam.</li>
  <li><strong>Th gin v Quan st:</strong> Tm mt ch ngi thoi mi v tn hng khng kh a phng.</li>
</ul>
      `,internalImageNames:[]},slug:{en:"japanese-covered-bridge",ru:"yaponskiy-krytyy-most",es:"puente-cubierto-japones",fr:"pont-couvert-japonais",vn:"cau-chua-nhat-ban"}},{id:"Not-From-Here",coordinates:[15.886900514248364,108.36724746339776],category:["art-galleries"],imageUrl:"59.jpg",en:{title:"Not From Here Art Gallery",description:"A contemporary art gallery in Hoi An showcasing diverse and often internationally-influenced works, offering a unique cultural experience beyond traditional Vietnamese art.",fullDescription:`
<p><strong>Not From Here Art Gallery</strong> is a prominent contemporary art space located in the historic town of Hoi An, Vietnam. As its name suggests, the gallery often features artworks that transcend typical Vietnamese styles or themes, or showcases pieces by artists who are not native to Hoi An or Vietnam, offering a refreshing perspective on the local art scene.</p>

<h6>Focus & Style:</h6>
<ul>
  <li><strong>Contemporary Art:</strong> The gallery primarily focuses on modern and contemporary art, which may include conceptual works, abstract pieces, mixed media, and experimental forms of expression.</li>
  <li><strong>Diverse Influences:</strong> "Not From Here" implies an international or broadly influenced collection, potentially featuring artists from various backgrounds or those whose work is inspired by global cultures and ideas. This sets it apart from galleries focusing solely on traditional Vietnamese art.</li>
  <li><strong>Platform for New Ideas:</strong> Such galleries often serve as vital platforms for emerging talents and established artists looking to present their unique visions to a wider audience in Hoi An.</li>
</ul>

<h6>Atmosphere:</h6>
<ul>
  <li><strong>Calm and Reflective:</strong> Like most art galleries, "Not From Here" provides a serene environment designed for visitors to immerse themselves in the artworks without distraction.</li>
  <li><strong>Modern Design:</strong> The interior is likely designed with a contemporary aesthetic, featuring clean lines and ample lighting to highlight the diverse exhibits effectively.</li>
</ul>

<h6>For Visitors:</h6>
<ul>
  <li><strong>Art Acquisition:</strong> Opportunities to purchase original artworks, making it an ideal spot for collectors or those looking for unique souvenirs.</li>
  <li><strong>Enriched Cultural Experience:</strong> A visit offers a deeper dive into Hoi An's evolving art scene, providing a contrast to the ancient town's historical charm. It's a chance to see how modern artistic expressions coexist within a rich heritage.</li>
  <li><strong>Community Hub:</strong> The gallery may also act as a meeting point for artists, art enthusiasts, and cultural exchange.</li>
</ul>

<h6>Location:</h6>
<p>Located in the UNESCO World Heritage town of Hoi An, the gallery benefits from a constant flow of tourists and art lovers. Its exact address is best confirmed via online maps or their official website to ensure the most accurate location within this vibrant historical setting.</p>

<h6>Online Presence:</h6>
<p>The use of a dedicated domain (<code>https://notfromhere.art/</code>) highlights a professional approach and a strong online presence, allowing visitors to preview exhibitions, learn about artists, and plan their visit in advance.</p>
`,internalImageNames:[]},es:{title:"Galera de Arte Not From Here",description:"Una galera de arte contemporneo en Hoi An que exhibe obras diversas y a menudo con influencias internacionales, ofreciendo una experiencia cultural nica ms all del arte tradicional vietnamita.",fullDescription:`
<p><strong>Not From Here Art Gallery</strong> es un destacado espacio de arte contemporneo ubicado en la histrica ciudad de Hoi An, Vietnam. Como su nombre lo indica, la galera a menudo presenta obras de arte que trascienden los estilos o temas vietnamitas tpicos, o exhibe piezas de artistas que no son nativos de Hoi An o Vietnam, ofreciendo una perspectiva refrescante sobre la escena artstica local.</p>

<h6>Enfoque y Estilo:</h6>
<ul>
  <li><strong>Arte Contemporneo:</strong> La galera se enfoca principalmente en el arte moderno y contemporneo, que puede incluir obras conceptuales, piezas abstractas, tcnicas mixtas y formas de expresin experimental.</li>
  <li><strong>Influencias Diversas:</strong> "Not From Here" implica una coleccin internacional o de amplia influencia, que potencialmente presenta artistas de diversos orgenes o aquellos cuyo trabajo est inspirado en culturas e ideas globales. Esto la distingue de las galeras que se centran nicamente en el arte tradicional vietnamita.</li>
  <li><strong>Plataforma para Nuevas Ideas:</strong> Estas galeras a menudo sirven como plataformas vitales para talentos emergentes y artistas establecidos que buscan presentar sus visiones nicas a una audiencia ms amplia en Hoi An.</li>
</ul>

<h6>Ambiente:</h6>
<ul>
  <li><strong>Tranquilo y Reflexivo:</strong> Como la mayora de las galeras de arte, "Not From Here" ofrece un ambiente sereno diseado para que los visitantes se sumerjan en las obras de arte sin distracciones.</li>
  <li><strong>Diseo Moderno:</strong> El interior probablemente est diseado con una esttica contempornea, con lneas limpias y amplia iluminacin para resaltar eficazmente las diversas exposiciones.</li>
</ul>

<h6>Para Visitantes:</h6>
<ul>
  <li><strong>Adquisicin de Arte:</strong> Oportunidades para adquirir obras de arte originales, lo que la convierte en un lugar ideal para coleccionistas o aquellos que buscan recuerdos nicos.</li>
  <li><strong>Experiencia Cultural Enriquecida:</strong> Una visita ofrece una inmersin ms profunda en la escena artstica en evolucin de Hoi An, proporcionando un contraste con el encanto histrico de la ciudad antigua. Es una oportunidad para ver cmo las expresiones artsticas modernas coexisten dentro de un rico patrimonio.</li>
  <li><strong>Centro Comunitario:</strong> La galera tambin puede actuar como punto de encuentro para artistas, entusiastas del arte e intercambio cultural.</li>
</ul>

<h6>Ubicacin:</h6>
<p>Ubicada en la ciudad de Hoi An, Patrimonio de la Humanidad por la UNESCO, la galera se beneficia de un flujo constante de turistas y amantes del arte. Es mejor confirmar su direccin exacta a travs de mapas en lnea o su sitio web oficial para garantizar la ubicacin ms precisa dentro de este vibrante entorno histrico.</p>

<h6>Presencia en Lnea:</h6>
<p>El uso de un dominio dedicado (<code>https://notfromhere.art/</code>) resalta un enfoque profesional y una fuerte presencia en lnea, lo que permite a los visitantes previsualizar exposiciones, aprender sobre artistas y planificar su visita con anticipacin.</p>
`,internalImageNames:[]},fr:{title:"Galerie d'Art Not From Here",description:"Une galerie d'art contemporain  Hoi An prsentant des uvres diverses et souvent d'inspiration internationale, offrant une exprience culturelle unique au-del de l'art traditionnel vietnamien.",fullDescription:`
<p>La <strong>Galerie d'Art Not From Here</strong> est un espace d'art contemporain de premier plan situ dans la ville historique de Hoi An, Vietnam. Comme son nom l'indique, la galerie prsente souvent des uvres d'art qui transcendent les styles ou thmes vietnamiens typiques, ou expose des pices d'artistes qui ne sont pas originaires de Hoi An ou du Vietnam, offrant une perspective rafrachissante sur la scne artistique locale.</p>

<h6>Orientation et Style :</h6>
<ul>
  <li><strong>Art Contemporain :</strong> La galerie se concentre principalement sur l'art moderne et contemporain, qui peut inclure des uvres conceptuelles, des pices abstraites, des techniques mixtes et des formes d'expression exprimentales.</li>
  <li><strong>Influences Diverses :</strong> "Not From Here" implique une collection internationale ou largement influence, prsentant potentiellement des artistes d'horizons divers ou dont le travail est inspir par des cultures et des ides mondiales. Cela la distingue des galeries se concentrant uniquement sur l'art traditionnel vietnamien.</li>
  <li><strong>Plateforme pour de Nouvelles Ides :</strong> Ces galeries servent souvent de plateformes vitales pour les talents mergents et les artistes tablis cherchant  prsenter leurs visions uniques  un public plus large  Hoi An.</li>
</ul>

<h6>Atmosphre :</h6>
<ul>
  <li><strong>Calme et Rflchie :</strong> Comme la plupart des galeries d'art, "Not From Here" offre un environnement serein conu pour que les visiteurs puissent s'immerger dans les uvres d'art sans distraction.</li>
  <li><strong>Design Moderne :</strong> L'intrieur est probablement conu avec une esthtique contemporaine, avec des lignes pures et un clairage abondant pour mettre en valeur efficacement les diverses expositions.</li>
</ul>

<h6>Pour les Visiteurs :</h6>
<ul>
  <li><strong>Acquisition d'Art :</strong> Opportunits d'acqurir des uvres d'art originales, ce qui en fait un endroit idal pour les collectionneurs ou ceux qui recherchent des souvenirs uniques.</li>
  <li><strong>Exprience Culturelle Enrichie :</strong> Une visite offre une plonge plus profonde dans la scne artistique en volution de Hoi An, offrant un contraste avec le charme historique de la vieille ville. C'est l'occasion de voir comment les expressions artistiques modernes coexistent au sein d'un riche patrimoine.</li>
  <li><strong>Centre Communautaire :</strong> La galerie peut galement servir de point de rencontre pour les artistes, les amateurs d'art et les changes culturels.</li>
</ul>

<h6>Localisation :</h6>
<p>Situe dans la ville de Hoi An, site du patrimoine mondial de l'UNESCO, la galerie bnficie d'un flux constant de touristes et d'amateurs d'art. Son adresse exacte est prfrable de la confirmer via des cartes en ligne ou leur site web officiel pour garantir l'emplacement le plus prcis dans ce cadre historique dynamique.</p>

<h6>Prsence en Ligne :</h6>
<p>L'utilisation d'un nom de domaine ddi (<code>https://notfromhere.art/</code>) met en vidence une approche professionnelle et une forte prsence en ligne, permettant aux visiteurs de prvisualiser les expositions, de se renseigner sur les artistes et de planifier leur visite  l'avance.</p>
`,internalImageNames:[]},ru:{title:"   ",description:"    ,  ,   ,    ,      .",fullDescription:`
<p><strong>    (Not From Here Art Gallery)</strong>      ,     , .    ,     ,         ,    ,      ,       .</p>

<h6>  :</h6>
<ul>
  <li><strong> :</strong>       ,     ,  ,      .</li>
  <li><strong> :</strong>         ,        ,       .     ,      .</li>
  <li><strong>   :</strong>             ,         .</li>
</ul>

<h6>:</h6>
<ul>
  <li><strong>  :</strong>     ,     ,   ,         .</li>
  <li><strong> :</strong> , ,    ,      ,     .</li>
</ul>

<h6> :</h6>
<ul>
  <li><strong> :</strong>     ,         ,    .</li>
  <li><strong>  :</strong>          ,       .   ,         .</li>
  <li><strong> :</strong>         ,     .</li>
</ul>

<h6>:</h6>
<p>   ,      ,        .        -     ,           .</p>

<h6>  :</h6>
<p>   (<code>https://notfromhere.art/</code>)      -,     ,        .</p>
`,internalImageNames:[]},vn:{title:"Phng Trng By Ngh Thut Not From Here",description:"Mt phng trng by ngh thut ng i  Hi An gii thiu cc tc phm a dng v thng c nh hng quc t, mang n tri nghim vn ha c o vt ra ngoi ngh thut truyn thng Vit Nam.",fullDescription:`
<p><strong>Phng Trng By Ngh Thut Not From Here</strong> l mt khng gian ngh thut ng i ni bt nm trong ph c lch s Hi An, Vit Nam. Nh tn gi, phng trng by thng gii thiu cc tc phm ngh thut vt ra ngoi phong cch hoc ch  Vit Nam in hnh, hoc trng by cc tc phm ca cc ngh s khng phi l ngi gc Hi An hoc Vit Nam, mang n mt gc nhn mi m v nn ngh thut a phng.</p>

<h6>Trng tm & Phong cch:</h6>
<ul>
  <li><strong>Ngh thut ng i:</strong> Phng trng by ch yu tp trung vo ngh thut hin i v ng i, c th bao gm cc tc phm  nim, tru tng, a phng tin v cc hnh thc biu t th nghim.</li>
  <li><strong>nh hng a dng:</strong> "Not From Here" ng  mt b su tp c nh hng quc t hoc rng ri, c kh nng gii thiu cc ngh s t nhiu ngun gc khc nhau hoc nhng ngi c tc phm c truyn cm hng t cc nn vn ha v  tng ton cu. iu ny lm cho n khc bit so vi cc phng trng by ch tp trung vo ngh thut truyn thng Vit Nam.</li>
  <li><strong>Nn tng cho  tng Mi:</strong> Cc phng trng by nh vy thng ng vai tr l nn tng quan trng cho cc ti nng mi ni v cc ngh s  thnh danh mun trnh by nhng tm nhn c o ca h n mt i tng rng hn  Hi An.</li>
</ul>

<h6>Bu khng kh:</h6>
<ul>
  <li><strong>Yn tnh v Su lng:</strong> Ging nh hu ht cc phng trng by ngh thut, "Not From Here" cung cp mt mi trng thanh bnh c thit k  du khch m mnh vo cc tc phm ngh thut m khng b phn tm.</li>
  <li><strong>Thit k Hin i:</strong> Ni tht c kh nng c thit k theo phong cch ng i, vi cc ng nt gn gng v nh sng di do  lm ni bt hiu qu cc cuc trin lm a dng.</li>
</ul>

<h6>Dnh cho Du khch:</h6>
<ul>
  <li><strong>Mua sm Ngh thut:</strong> C hi mua cc tc phm ngh thut gc, bin ni y thnh mt a im l tng cho cc nh su tp hoc nhng ngi tm kim nhng mn qu lu nim c o.</li>
  <li><strong>Tri nghim Vn ha Phong ph:</strong> Mt chuyn thm mang n ci nhn su sc hn v nn ngh thut ang pht trin ca Hi An, to ra s tng phn vi v quyn r lch s ca ph c. y l c hi  xem cc biu hin ngh thut hin i cng tn ti trong mt di sn phong ph.</li>
  <li><strong>Trung tm Cng ng:</strong> Phng trng by cng c th ng vai tr l im gp g ca cc ngh s, nhng ngi yu ngh thut v trao i vn ha.</li>
</ul>

<h6>V tr:</h6>
<p>Nm trong thnh ph Hi An c UNESCO cng nhn l Di sn Th gii, phng trng by c hng li t lng khch du lch v nhng ngi yu ngh thut khng ngng. a ch chnh xc ca n tt nht nn c xc nhn qua bn  trc tuyn hoc trang web chnh thc ca h  m bo v tr chnh xc nht trong bi cnh lch s si ng ny.</p>

<h6>Hin din Trc tuyn:</h6>
<p>Vic s dng tn min chuyn dng (<code>https://notfromhere.art/</code>) lm ni bt cch tip cn chuyn nghip v s hin din trc tuyn mnh m, cho php du khch xem trc cc cuc trin lm, tm hiu v cc ngh s v ln k hoch tham quan trc.</p>
`,internalImageNames:[]},slug:{en:"japanese-covered-bridge",ru:"yaponskiy-krytyy-most",es:"puente-cubierto-japones",fr:"pont-couvert-japonais",vn:"cau-chua-nhat-ban"}}],L6=[{id:"cham-chi-club",coordinates:[15.89547060100983,108.36343088284198],category:["clubs"],imageUrl:"54.jpg",en:{title:"Cham Chi Club",description:"A unique cultural and artistic hub in Hoi An, known for live music, community engagement, and a vibrant atmosphere.",fullDescription:`
<p><strong>Chm Ch Club (sometimes spelled Cham Chi Club)</strong> stands out as a unique and multifaceted space in Hoi An, far beyond a typical bar or nightclub. It's envisioned as a cultural and artistic center fostering connection and interaction.</p>

<h6>Key Features & Concept:</h6>
<ul>
  <li><strong>Multifunctional Space:</strong> Positioned as a venue for art, music, events, drinks, and social activity, not a traditional disco.</li>
  <li><strong>Live Music & Vibe:</strong> Renowned for its lively local music scene, often blending traditional Vietnamese sounds with contemporary styles. Musicians frequently interact with the audience, making each performance unique.</li>
  <li><strong>Openness & Interaction:</strong> The building was deliberately redesigned, with original walls removed or broken down. This allows river breezes for ventilation and encourages more open communication among guests. Its spacious, open layout with views of the Thu Bon River makes it ideal for socializing or quiet relaxation.</li>
  <li><strong>Community & Local Support:</strong> The founder, Thin, emphasizes the club's role in the local community. Neighbors are involved in managing the venue, and food/drinks are sourced from local suppliers, underscoring a commitment to supporting the local economy and traditions.</li>
  <li><strong>24/7 Operations & Social Mission:</strong> Some reports suggest Chm Ch Club operates around the clock. Thin has also mentioned instances where the club served as a refuge for homeless or mentally vulnerable individuals. Some of the club's graffiti is even inspired by Christian themes and created by these visitors.</li>
</ul>

<h6>What You Might Find Inside:</h6>
<p>Due to its versatile nature, you might discover various zones:</p>
<ul>
  <li><strong>Creative Spaces:</strong> Where artists might be working on their creations.</li>
  <li><strong>Music Zones:</strong> Featuring a drum set and other musical instruments.</li>
  <li><strong>Fitness Area:</strong> Reports mention a gym area with yoga mats and punching bags.</li>
  <li><strong>Relaxation Zone:</strong> A bar offering a diverse selection of drinks, from refreshing cocktails to local beers.</li>
</ul>

<h6>Events & Happenings:</h6>
<p>Beyond daily live music, Chm Ch Club also hosts:</p>
<ul>
  <li>Special events</li>
  <li>Workshops</li>
  <li>Parties</li>
</ul>

<h6>Location:</h6>
<p>You can find Chm Ch Club at <strong>47 Ca i, Hi An, Qung Nam, Vietnam</strong>. Its central riverside location offers great views and easy access for tourists looking to experience authentic local nightlife and cultural immersion.</p>

<h6>Visitor Tips:</h6>
<ul>
  <li><strong>Arrive Early:</strong> It can get busy, especially on weekends.</li>
  <li><strong>Try Local Drinks:</strong> Enjoy the live performances with a local beverage.</li>
  <li><strong>Check Schedules:</strong> Follow their Instagram or other social media for special events.</li>
  <li><strong>Be Open to Participation:</strong> The club's atmosphere encourages audience interaction.</li>
</ul>

<p><strong>Note:</strong> Hoi An's nightlife often focuses more on relaxed settings, live music, and cultural experiences rather than traditional loud nightclubs. Chm Ch Club exemplifies this, offering a deeper dive into local culture and community.</p>
      `,internalImageNames:[]},es:{title:"Cham Chi Club",description:"Un centro cultural y artstico nico en Hoi An, conocido por su msica en vivo, compromiso comunitario y ambiente vibrante.",fullDescription:`
<p><strong>Chm Ch Club (a veces escrito Cham Chi Club)</strong> se destaca como un espacio nico y multifactico en Hoi An, mucho ms all de un bar o discoteca tpica. Se concibe como un centro cultural y artstico que fomenta la conexin y la interaccin.</p>

<h6>Caractersticas Clave y Concepto:</h6>
<ul>
  <li><strong>Espacio Multifuncional:</strong> Posicionado como un lugar para el arte, la msica, eventos, bebidas y actividad social, no una discoteca tradicional.</li>
  <li><strong>Msica en Vivo y Ambiente:</strong> Reconocido por su animada escena musical local, a menudo mezclando sonidos tradicionales vietnamitas con estilos contemporneos. Los msicos interactan frecuentemente con la audiencia, haciendo que cada actuacin sea nica.</li>
  <li><strong>Apertura e Interaccin:</strong> El edificio fue rediseado deliberadamente, con las paredes originales retiradas o derribadas. Esto permite la brisa del ro para la ventilacin y fomenta una comunicacin ms abierta entre los invitados. Su diseo espacioso y abierto con vistas al ro Thu Bon lo hace ideal para socializar o relajarse tranquilamente.</li>
  <li><strong>Comunidad y Apoyo Local:</strong> El fundador, Thin, enfatiza el papel del club en la comunidad local. Los vecinos participan en la gestin del lugar, y los alimentos/bebidas se obtienen de proveedores locales, subrayando el compromiso de apoyar la economa y las tradiciones locales.</li>
  <li><strong>Operaciones 24/7 y Misin Social:</strong> Algunos informes sugieren que Chm Ch Club opera las veinticuatro horas. Thin tambin ha mencionado casos en los que el club sirvi como refugio para personas sin hogar o con vulnerabilidades psicolgicas. Algunas de las grafitis del club incluso estn inspiradas en temas cristianos y fueron creadas por estos visitantes.</li>
</ul>

<h6>Lo que Podras Encontrar Dentro:</h6>
<p>Debido a su naturaleza verstil, podras descubrir varias zonas:</p>
<ul>
  <li><strong>Espacios Creativos:</strong> Donde los artistas podran estar trabajando en sus creaciones.</li>
  <li><strong>Zonas Musicales:</strong> Con batera y otros instrumentos musicales.</li>
  <li><strong>rea de Fitness:</strong> Los informes mencionan un rea de gimnasio con esterillas de yoga y sacos de boxeo.</li>
  <li><strong>Zona de Relajacin:</strong> Un bar que ofrece una seleccin diversa de bebidas, desde refrescantes ccteles hasta cervezas locales.</li>
</ul>

<h6>Eventos y Acontecimientos:</h6>
<p>Adems de la msica en vivo diaria, Chm Ch Club tambin alberga:</p>
<ul>
  <li>Eventos especiales</li>
  <li>Talleres</li>
  <li>Fiestas</li>
</ul>

<h6>Ubicacin:</h6>
<p>Puedes encontrar Chm Ch Club en <strong>47 Ca i, Hi An, Qung Nam, Vietnam</strong>. Su ubicacin cntrica junto al ro ofrece excelentes vistas y fcil acceso para los turistas que buscan experimentar la autntica vida nocturna local y la inmersin cultural.</p>

<h6>Consejos para Visitantes:</h6>
<ul>
  <li><strong>Llegar Temprano:</strong> Puede estar concurrido, especialmente los fines de semana.</li>
  <li><strong>Probar Bebidas Locales:</strong> Disfruta de las actuaciones en vivo con una bebida local.</li>
  <li><strong>Consultar Horarios:</strong> Sigue sus redes sociales para eventos especiales.</li>
  <li><strong>Estar Abierto a la Participacin:</strong> El ambiente del club fomenta la interaccin con la audiencia.</li>
</ul>

<p><strong>Nota:</strong> La vida nocturna de Hoi An a menudo se centra ms en entornos relajados, msica en vivo y experiencias culturales que en discotecas ruidosas tradicionales. Chm Ch Club ejemplifica esto, ofreciendo una inmersin ms profunda en la cultura y la comunidad local.</p>
      `,internalImageNames:[]},fr:{title:"Cham Chi Club",description:"Un centre culturel et artistique unique  Hoi An, rput pour sa musique live, son engagement communautaire et son ambiance vibrante.",fullDescription:`
<p><strong>Le Chm Ch Club (parfois orthographi Cham Chi Club)</strong> se distingue comme un espace unique et multifacette  Hoi An, bien au-del d'un bar ou d'une bote de nuit typique. Il est conu comme un centre culturel et artistique favorisant la connexion et l'interaction.</p>

<h6>Caractristiques Cls et Concept :</h6>
<ul>
  <li><strong>Espace Multifonctionnel :</strong> Positionn comme un lieu pour l'art, la musique, les vnements, les boissons et l'activit sociale, et non comme une discothque traditionnelle.</li>
  <li><strong>Musique Live et Ambiance :</strong> Reconnu pour sa scne musicale locale anime, mlant souvent des sons traditionnels vietnamiens  des styles contemporains. Les musiciens interagissent frquemment avec le public, rendant chaque performance unique.</li>
  <li><strong>Ouverture et Interaction :</strong> Le btiment a t dlibrment repens, avec les murs d'origine retirs ou abattus. Cela permet aux brises de la rivire d'arer et encourage une communication plus ouverte entre les invits. Sa disposition spacieuse et ouverte avec vue sur la rivire Thu Bon en fait un lieu idal pour socialiser ou se dtendre tranquillement.</li>
  <li><strong>Communaut et Soutien Local :</strong> Le fondateur, Thin, souligne le rle du club dans la communaut locale. Les voisins sont impliqus dans la gestion du lieu, et les aliments/boissons sont sourced from local suppliers, soulignant un engagement  soutenir l'conomie et les traditions locales.</li>
  <li><strong>Oprations 24/7 et Mission Sociale :</strong> Certains rapports suggrent que le Chm Ch Club fonctionne 24 heures sur 24. Thin a galement mentionn des cas o le club a servi de refuge pour les personnes sans abri ou psychologiquement vulnrables. Certains graffitis du club sont mme inspirs de thmes chrtiens et ont t crs par ces visiteurs.</li>
</ul>

<h6>Ce que Vous Pourriez Trouver  l'Intrieur :</h6>
<p>En raison de sa nature polyvalente, vous pourriez dcouvrir diverses zones :</p>
<ul>
  <li><strong>Espaces Cratifs :</strong> O les artistes pourraient travailler sur leurs crations.</li>
  <li><strong>Zones Musicales :</strong> Avec une batterie et d'autres instruments de musique.</li>
  <li><strong>Espace Fitness :</strong> Des rapports mentionnent un espace de gym avec des tapis de yoga et des sacs de frappe.</li>
  <li><strong>Zone de Dtente :</strong> Un bar proposant une slection varie de boissons, des cocktails rafrachissants aux bires locales.</li>
</ul>

<h6>vnements et Manifestations :</h6>
<p>Au-del de la musique live quotidienne, le Chm Ch Club accueille galement :</p>
<ul>
  <li>Des vnements spciaux</li>
  <li>Des ateliers</li>
  <li>Des soires</li>
</ul>

<h6>Localisation :</h6>
<p>Vous pouvez trouver le Chm Ch Club au <strong>47 Ca i, Hi An, Qung Nam, Vietnam</strong>. Son emplacement central en bord de rivire offre de superbes vues et un accs facile pour les touristes souhaitant dcouvrir la vie nocturne locale authentique et l'immersion culturelle.</p>

<h6>Conseils pour les Visiteurs :</h6>
<ul>
  <li><strong>Arriver Tt :</strong> Il peut y avoir beaucoup de monde, surtout le week-end.</li>
  <li><strong>Gotez aux Boissons Locales :</strong> Profitez des spectacles live avec une boisson locale.</li>
  <li><strong>Consultez les Horaires :</strong> Suivez leurs rseaux sociaux pour les vnements spciaux.</li>
  <li><strong>Soyez Ouvert  la Participation :</strong> L'ambiance du club encourage l'interaction avec le public.</li>
</ul>

<p><strong>Note :</strong> La vie nocturne de Hoi An se concentre souvent davantage sur des ambiances dcontractes, la musique live et les expriences culturelles plutt que sur les botes de nuit bruyantes traditionnelles. Le Chm Ch Club en est un exemple, offrant une immersion plus profonde dans la culture et la communaut locales.</p>
      `,internalImageNames:[]},ru:{title:"Cham Chi Club",description:"   -  ,   ,     .",fullDescription:`
<p>     ,          .      ,   <strong>   </strong>,       .</p>

<h6>   :</h6>
<ul>
  <li><strong> :</strong> Chm Ch Club     , ,  ,    .       .</li>
  <li><strong>   :</strong>       .           ,    .     ,    .</li>
  <li><strong>  :</strong>     :     ,        ,        .                      .</li>
  <li><strong>   :</strong>  , Thin (),      .       ,        ,    .         .</li>
  <li><strong>    :</strong>   ,   Chm Ch Club    .  , Thin  ,          .              .</li>
</ul>

<h6>   :</h6>
<p>  ,        :</p>
<ul>
  <li><strong> :</strong>      .</li>
  <li><strong> :</strong>       .</li>
  <li><strong>  :</strong>           .</li>
  <li><strong>  :</strong>  ,      ,      .</li>
</ul>

<h6>  :</h6>
<p>   , Chm Ch Club   :</p>
<ul>
  <li> </li>
  <li>-</li>
  <li></li>
</ul>

<h6>:</h6>
<p>Chm Ch Club   : <strong>47 Ca i, Hi An, Qung Nam, Vietnam</strong>.         ,           .      ,   .</p>

<h6>  :</h6>
<ul>
  <li><strong> :</strong>    ,   ,       .</li>
  <li><strong>  :</strong>   ,   .</li>
  <li><strong>  :</strong>   Instagram            .</li>
  <li><strong>   :</strong>     .</li>
</ul>

<p><strong> :</strong>         " "     , , ,   .       ,     . Chm Ch Club      ,        .</p>
      `,internalImageNames:[]},vn:{title:"Chm Ch Club",description:"Mt trung tm vn ha v ngh thut c o ti Hi An, ni ting vi nhc sng, s gn kt cng ng v khng kh si ng.",fullDescription:`
<p><strong>Chm Ch Club (i khi c vit l Cham Chi Club)</strong> ni bt nh mt khng gian c o v a nng ti Hi An, vt xa mt qun bar hay hp m thng thng. Ni y c hnh dung l mt trung tm vn ha v ngh thut, nui dng s kt ni v tng tc gia mi ngi.</p>

<h6>c im Chnh v Khi nim:</h6>
<ul>
  <li><strong>Khng gian a chc nng:</strong> nh v l ni dnh cho ngh thut, m nhc, s kin,  ung v hot ng x hi, khng phi l sn nhy truyn thng.</li>
  <li><strong>Nhc Sng & Bu khng kh:</strong> Ni ting vi sn khu nhc sng si ng, thng pha trn m thanh truyn thng Vit Nam vi cc phong cch ng i. Cc nhc s thng xuyn tng tc vi khn gi, lm cho mi bui biu din tr nn c o.</li>
  <li><strong>S M v Tng tc:</strong> Ta nh c c tnh thit k li, vi nhng bc tng ban u b d b hoc ph v. iu ny cho php gi sng thng thong v khuyn khch giao tip ci m hn gia cc v khch. B cc rng ri, thong ng vi tm nhn ra sng Thu Bn lm cho ni y tr thnh a im l tng  giao lu hoc th gin yn tnh.</li>
  <li><strong>Cng ng & H tr a phng:</strong> Ngi sng lp, Thin, nhn mnh vai tr ca cu lc b trong cng ng a phng. Hng xm c tham gia vo vic qun l a im, v thc phm/ ung c ly t cc nh cung cp a phng, nhn mnh cam kt h tr kinh t v truyn thng a phng.</li>
  <li><strong>Hot ng 24/7 & S mnh X hi:</strong> Mt s bo co cho thy Chm Ch Club hot ng sut ngy m. Thin cng   cp n nhng trng hp cu lc b lm ni tr n cho ngi v gia c hoc nhng ngi d b tn thng v tm l. Mt s hnh v graffiti ca cu lc b thm ch cn ly cm hng t ch  Kit gio v c to ra bi nhng v khch ny.</li>
</ul>

<h6>Nhng g bn c th tm thy bn trong:</h6>
<p>Do tnh cht a nng ca n, bn c th khm ph nhiu khu vc khc nhau:</p>
<ul>
  <li><strong>Khng gian Sng to:</strong> Ni cc ngh s c th ang lm vic trn cc tc phm ca h.</li>
  <li><strong>Khu vc m nhc:</strong> Vi b trng v cc nhc c khc.</li>
  <li><strong>Khu vc Th dc:</strong> Cc bo co  cp n khu vc phng tp th dc vi thm yoga v bao m.</li>
  <li><strong>Khu vc Th gin:</strong> Mt quy bar cung cp nhiu la chn  ung a dng, t cocktail gii kht n bia a phng.</li>
</ul>

<h6>S kin & Din bin:</h6>
<p>Ngoi nhc sng hng ngy, Chm Ch Club cn t chc:</p>
<ul>
  <li>Cc s kin c bit</li>
  <li>Cc bui hi tho</li>
  <li>Cc ba tic</li>
</ul>

<h6>V tr:</h6>
<p>Bn c th tm thy Chm Ch Club ti <strong>47 Ca i, Hi An, Qung Nam, Vit Nam</strong>. V tr trung tm ven sng mang li tm nhn tuyt vi v d dng tip cn cho khch du lch mun tri nghim cuc sng v m v s ha mnh vo vn ha a phng ch thc.</p>

<h6>Mo dnh cho Khch truy cp:</h6>
<ul>
  <li><strong>n Sm:</strong> Ni y c th ng c, c bit vo cui tun.</li>
  <li><strong>Th  ung a phng:</strong> Thng thc cc bui biu din trc tip vi  ung a phng.</li>
  <li><strong>Kim tra Lch trnh:</strong> Theo di Instagram hoc cc mng x hi khc ca h  bit cc s kin c bit.</li>
  <li><strong>Hy ci m vi s tham gia:</strong> Bu khng kh ca cu lc b khuyn khch s tng tc ca khn gi.</li>
</ul>

<p><strong>Lu :</strong> Cuc sng v m ca Hi An thng tp trung nhiu hn vo cc a im th gin, nhc sng v tri nghim vn ha hn l cc hp m n o truyn thng. Chm Ch Club l mt v d in hnh cho iu ny, mang n s ha mnh su sc hn vo vn ha v cng ng a phng.</p>
      `,internalImageNames:[]},slug:{en:"japanese-covered-bridge",ru:"yaponskiy-krytyy-most",es:"puente-cubierto-japones",fr:"pont-couvert-japonais",vn:"cau-chua-nhat-ban"}},{id:"roots-bar ",coordinates:[15.912238405333042,108.34211628537149],category:["clubs"],imageUrl:"55.jpg",en:{title:"Roots Bar",description:"A popular and lively bar in Hoi An, known for its friendly atmosphere, good music, and diverse drink selection.",fullDescription:`
<p><strong>Roots Bar</strong> is a well-regarded and vibrant spot in Hoi An, often praised by visitors for its welcoming atmosphere and lively evenings. It's a popular choice for those looking to relax, enjoy a drink, and soak in the city's charming nightlife.</p>

<h6>Atmosphere & Vibe:</h6>
<ul>
  <li><strong>Friendly & Welcoming:</strong> Roots Bar consistently receives high marks for its very friendly and attentive staff, who contribute significantly to its inviting vibe.</li>
  <li><strong>Lively but Relaxed:</strong> While it can get busy and energetic, especially in the evenings, it generally maintains a comfortable, laid-back feel. It's suitable for both social gatherings and solo enjoyment.</li>
  <li><strong>Good Music:</strong> Many reviews highlight the quality of the music played, contributing to the overall positive experience. This often includes a mix of genres that appeal to a wide audience.</li>
  <li><strong>Comfortable Seating:</strong> Offers a mix of indoor and outdoor seating, often with comfortable cushions and low tables, perfect for lingering conversations.</li>
</ul>

<h6>Drinks & Offerings:</h6>
<ul>
  <li><strong>Extensive Drink Menu:</strong> Roots Bar boasts a broad selection of beverages, including local and international beers, a variety of spirits, and well-crafted cocktails.</li>
  <li><strong>Affordable Prices:</strong> Visitors often comment on the reasonable prices, making it an accessible option for budget-conscious travelers.</li>
  <li><strong>Shisha/Hookah:</strong> For those who enjoy it, shisha (hookah) is typically available, adding another element to the relaxing atmosphere.</li>
  <li><strong>Simple Food Options:</strong> While primarily a bar, some simple food items or snacks might be available. It's best to check locally if you're planning to eat.</li>
</ul>

<h6>Why Visitors Love It:</h6>
<ul>
  <li><strong>Great for People-Watching:</strong> Its location often allows for good people-watching, as patrons can sit and observe the street life of Hoi An.</li>
  <li><strong>Sociable Spot:</strong> Easy to strike up conversations with other travelers and locals, making it a good choice for solo travelers or those looking to meet new people.</li>
  <li><strong>Consistent Quality:</strong> Many repeat visitors praise its consistent quality of service and atmosphere.</li>
</ul>

<h6>Location:</h6>
<p>Roots Bar is typically found in the main tourist area of Hoi An, often on or near Bch ng Street, close to the river or within the Ancient Town. Its exact address may vary slightly or it might be a small, easily missed spot, but it's generally well-known among locals and frequent visitors.</p>
<p><strong>Please verify the exact address locally or on recent online maps as businesses in popular tourist areas can sometimes change locations slightly.</strong></p>

<h6>Visitor Tips:</h6>
<ul>
  <li><strong>Go in the Evening:</strong> The bar truly comes alive as the sun sets.</li>
  <li><strong>Ask for Recommendations:</strong> The staff are usually very knowledgeable and can recommend drinks.</li>
  <li><strong>Enjoy the Vibe:</strong> It's a place to chill and enjoy the simple pleasures of Hoi An.</li>
</ul>
      `,internalImageNames:[]},es:{title:"Roots Bar",description:"Un bar popular y animado en Hoi An, conocido por su ambiente amigable, buena msica y variada seleccin de bebidas.",fullDescription:`
<p><strong>Roots Bar</strong> es un lugar bien considerado y vibrante en Hoi An, a menudo elogiado por los visitantes por su ambiente acogedor y sus noches animadas. Es una opcin popular para quienes buscan relajarse, disfrutar de una bebida y sumergirse en la encantadora vida nocturna de la ciudad.</p>

<h6>Ambiente y Vibe:</h6>
<ul>
  <li><strong>Amigable y Acogedor:</strong> Roots Bar recibe constantemente altas calificaciones por su personal muy amable y atento, que contribuye significativamente a su ambiente acogedor.</li>
  <li><strong>Animado pero Relajado:</strong> Aunque puede estar concurrido y enrgico, especialmente por las noches, generalmente mantiene una sensacin cmoda y relajada. Es adecuado tanto para reuniones sociales como para disfrutar en solitario.</li>
  <li><strong>Buena Msica:</strong> Muchas reseas destacan la calidad de la msica que se reproduce, lo que contribuye a la experiencia positiva general. Esto a menudo incluye una mezcla de gneros que atraen a una amplia audiencia.</li>
  <li><strong>Asientos Cmodos:</strong> Ofrece una combinacin de asientos interiores y exteriores, a menudo con cojines cmodos y mesas bajas, perfectos para conversaciones prolongadas.</li>
</ul>

<h6>Bebidas y Ofertas:</h6>
<ul>
  <li><strong>Amplio Men de Bebidas:</strong> Roots Bar cuenta con una amplia seleccin de bebidas, incluyendo cervezas locales e internacionales, una variedad de licores y ccteles bien elaborados.</li>
  <li><strong>Precios Asequibles:</strong> Los visitantes suelen comentar sobre los precios razonables, lo que lo convierte en una opcin accesible para los viajeros conscientes de su presupuesto.</li>
  <li><strong>Shisha/Narguile:</strong> Para quienes lo disfrutan, la shisha (narguile) suele estar disponible, aadiendo otro elemento al ambiente relajante.</li>
  <li><strong>Opciones de Comida Sencillas:</strong> Aunque es principalmente un bar, es posible que haya algunos alimentos o bocadillos sencillos. Es mejor verificar en el lugar si planeas comer.</li>
</ul>

<h6>Por qu a los Visitantes les Encanta:</h6>
<ul>
  <li><strong>Ideal para Observar a la Gente:</strong> Su ubicacin a menudo permite observar a la gente, ya que los clientes pueden sentarse y observar la vida callejera de Hoi An.</li>
  <li><strong>Lugar Sociable:</strong> Es fcil entablar conversaciones con otros viajeros y lugareos, lo que lo convierte en una buena opcin para viajeros solitarios o aquellos que buscan conocer gente nueva.</li>
  <li><strong>Calidad Consistente:</strong> Muchos visitantes recurrentes elogian su calidad constante de servicio y ambiente.</li>
</ul>

<h6>Ubicacin:</h6>
<p>Roots Bar se encuentra tpicamente en la principal zona turstica de Hoi An, a menudo en o cerca de la calle Bch ng, cerca del ro o dentro del Casco Antiguo. Su direccin exacta puede variar ligeramente o podra ser un lugar pequeo y fcil de pasar por alto, pero generalmente es bien conocido entre los lugareos y los visitantes frecuentes.</p>
<p><strong>Por favor, verifique la direccin exacta a nivel local o en mapas en lnea recientes, ya que los negocios en reas tursticas populares a veces pueden cambiar de ubicacin ligeramente.</strong></p>

<h6>Consejos para Visitantes:</h6>
<ul>
  <li><strong>Ir por la Noche:</strong> El bar cobra vida realmente al anochecer.</li>
  <li><strong>Pedir Recomendaciones:</strong> El personal suele ser muy conocedor y puede recomendar bebidas.</li>
  <li><strong>Disfrutar del Ambiente:</strong> Es un lugar para relajarse y disfrutar de los placeres sencillos de Hoi An.</li>
</ul>
      `,internalImageNames:[]},fr:{title:"Roots Bar",description:"Un bar populaire et anim  Hoi An, rput pour son ambiance conviviale, sa bonne musique et sa slection varie de boissons.",fullDescription:`
<p>Le <strong>Roots Bar</strong> est un lieu bien considr et dynamique  Hoi An, souvent salu par les visiteurs pour son ambiance accueillante et ses soires animes. C'est un choix populaire pour ceux qui cherchent  se dtendre,  prendre un verre et  s'imprgner de la charmante vie nocturne de la ville.</p>

<h6>Ambiance & Vibe :</h6>
<ul>
  <li><strong>Convivial et Accueillant :</strong> Le Roots Bar reoit constamment d'excellentes notes pour son personnel trs amical et attentif, qui contribue de manire significative  son ambiance invitante.</li>
  <li><strong>Anim mais Relaxant :</strong> Bien qu'il puisse tre trs frquent et nergique, surtout le soir, il conserve gnralement une atmosphre confortable et dcontracte. Il convient aussi bien aux rassemblements sociaux qu'aux moments de dtente en solo.</li>
  <li><strong>Bonne Musique :</strong> De nombreux avis soulignent la qualit de la musique diffuse, ce qui contribue  l'exprience positive globale. Cela inclut souvent un mlange de genres qui plat  un large public.</li>
  <li><strong>Places Assises Confortables :</strong> Propose un mlange de places assises intrieures et extrieures, souvent avec des coussins confortables et des tables basses, parfaites pour des conversations prolonges.</li>
</ul>

<h6>Boissons et Offres :</h6>
<ul>
  <li><strong>Menu de Boissons tendu :</strong> Le Roots Bar propose une large slection de boissons, y compris des bires locales et internationales, une varit de spiritueux et des cocktails bien prpars.</li>
  <li><strong>Prix Abordables :</strong> Les visiteurs commentent souvent les prix raisonnables, ce qui en fait une option accessible pour les voyageurs soucieux de leur budget.</li>
  <li><strong>Chicha/Narguil :</strong> Pour ceux qui l'apprcient, la chicha (narguil) est gnralement disponible, ajoutant un autre lment  l'atmosphre relaxante.</li>
  <li><strong>Options de Restauration Simples :</strong> Bien qu'il s'agisse principalement d'un bar, des plats ou des collations simples peuvent tre disponibles. Il est prfrable de vrifier sur place si vous prvoyez de manger.</li>
</ul>

<h6>Pourquoi les Visiteurs l'Adorent :</h6>
<ul>
  <li><strong>Idal pour Observer les Gens :</strong> Son emplacement permet souvent d'observer les passants, car les clients peuvent s'asseoir et observer la vie de rue de Hoi An.</li>
  <li><strong>Lieu Sociable :</strong> Facile d'engager des conversations avec d'autres voyageurs et des habitants, ce qui en fait un bon choix pour les voyageurs solitaires ou ceux qui cherchent  rencontrer de nouvelles personnes.</li>
  <li><strong>Qualit Constante :</strong> De nombreux visiteurs rguliers louent sa qualit constante de service et son atmosphre.</li>
</ul>

<h6>Localisation :</h6>
<p>Le Roots Bar se trouve gnralement dans la principale zone touristique de Hoi An, souvent sur ou prs de la rue Bch ng, prs de la rivire ou  l'intrieur de la Vieille Ville. Son adresse exacte peut varier lgrement ou il pourrait s'agir d'un petit endroit facilement manqu, mais il est gnralement bien connu des habitants et des visiteurs frquents.</p>
<p><strong>Veuillez vrifier l'adresse exacte localement ou sur des cartes en ligne rcentes, car les commerces des zones touristiques populaires peuvent parfois changer lgrement d'emplacement.</strong></p>

<h6>Conseils pour les Visiteurs :</h6>
<ul>
  <li><strong>Allez-y le Soir :</strong> Le bar prend vraiment vie au coucher du soleil.</li>
  <li><strong>Demandez des Recommandations :</strong> Le personnel est gnralement trs comptent et peut recommander des boissons.</li>
  <li><strong>Profitez de l'Ambiance :</strong> C'est un endroit pour se dtendre et profiter des plaisirs simples de Hoi An.</li>
</ul>
      `,internalImageNames:[]},ru:{title:"Roots Bar",description:"     ,    ,      .",fullDescription:`
<p><strong>Roots Bar</strong>          ,         .     ,   ,       .</p>

<h6>  :</h6>
<ul>
  <li><strong>  :</strong> Roots Bar          ,        .</li>
  <li><strong>,  :</strong>       ,   ,     ,  .    ,     .</li>
  <li><strong> :</strong>      ,     .    ,    .</li>
  <li><strong>   :</strong>        ,       ,     .</li>
</ul>

<h6>  :</h6>
<ul>
  <li><strong>  :</strong> Roots Bar     ,     ,       .</li>
  <li><strong> :</strong>     ,          .</li>
  <li><strong>/:</strong>  ,  ,  ()  ,       .</li>
  <li><strong>  :</strong>     ,        .    ,    .</li>
</ul>

<h6>   :</h6>
<ul>
  <li><strong>     :</strong>        ,           .</li>
  <li><strong> :</strong>         ,          ,      .</li>
  <li><strong> :</strong>          .</li>
</ul>

<h6>:</h6>
<p>Roots Bar       ,         ,        .      ,     ,   ,           .</p>
<p><strong>,         -,             .</strong></p>

<h6>  :</h6>
<ul>
  <li><strong> :</strong>  -    .</li>
  <li><strong> :</strong>         .</li>
  <li><strong> :</strong>  ,       .</li>
</ul>
      `,internalImageNames:[]},vn:{title:"Roots Bar",description:"Mt qun bar ni ting v si ng  Hi An, c bit n vi khng kh thn thin, m nhc hay v a dng la chn  ung.",fullDescription:`
<p><strong>Roots Bar</strong> l mt a im c nh gi cao v si ng  Hi An, thng c du khch ca ngi v khng kh cho n v nhng bui ti sng ng. y l la chn ph bin cho nhng ai mun th gin, thng thc  ung v ha mnh vo cuc sng v m quyn r ca thnh ph.</p>

<h6>Bu khng kh & Cm nhn:</h6>
<ul>
  <li><strong>Thn thin & n tip:</strong> Roots Bar lin tc nhn c im cao v i ng nhn vin rt thn thin v chu o, nhng ngi ng gp ng k vo khng kh mi gi ca qun.</li>
  <li><strong>Si ng nhng Th gin:</strong> Mc d c th ng c v nng ng, c bit vo bui ti, nhng qun thng duy tr cm gic thoi mi, th thi. Ni y ph hp cho c nhng bui gp g x hi v tn hng mt mnh.</li>
  <li><strong>m nhc hay:</strong> Nhiu nh gi lm ni bt cht lng m nhc c pht, gp phn vo tri nghim tch cc chung. iu ny thng bao gm s pha trn cc th loi thu ht nhiu i tng.</li>
  <li><strong>Ch ngi thoi mi:</strong> Cung cp nhiu loi ch ngi trong nh v ngoi tri, thng c m m i v bn thp, hon ho cho nhng cuc tr chuyn ko di.</li>
</ul>

<h6> ung & u i:</h6>
<ul>
  <li><strong>Thc n  ung phong ph:</strong> Roots Bar t ho c nhiu la chn  ung, bao gm bia a phng v quc t, nhiu loi ru mnh v cocktail c pha ch tt.</li>
  <li><strong>Gi c phi chng:</strong> Du khch thng nhn xt v gi c hp l, khin ni y tr thnh mt la chn d tip cn cho nhng du khch c ngn sch hn ch.</li>
  <li><strong>Shisha/Thuc lo:</strong> i vi nhng ai thch, shisha (thuc lo) thng c sn, thm mt yu t khc vo khng kh th gin.</li>
  <li><strong>Cc la chn  n n gin:</strong> Mc d ch yu l mt qun bar, nhng c th c mt s mn n hoc  n nh n gin. Tt nht nn hi ti ch nu bn nh n.</li>
</ul>

<h6>Ti sao du khch yu thch ni y:</h6>
<ul>
  <li><strong>Tuyt vi  ngm ngi qua li:</strong> V tr ca qun thng cho php ngm ngi qua li tt, v khch hng c th ngi v quan st cuc sng ng ph Hi An.</li>
  <li><strong>a im giao lu:</strong> D dng bt chuyn vi nhng du khch v ngi dn a phng khc, khin ni y tr thnh la chn tt cho nhng ngi i du lch mt mnh hoc nhng ngi mun gp g nhng ngi mi.</li>
  <li><strong>Cht lng nht qun:</strong> Nhiu du khch quay li khen ngi cht lng dch v v khng kh nht qun ca qun.</li>
</ul>

<h6>V tr:</h6>
<p>Roots Bar thng nm trong khu du lch chnh ca Hi An, thng  hoc gn ph Bch ng, gn sng hoc trong Ph c. a ch chnh xc ca qun c th thay i mt cht hoc  c th l mt a im nh, d b qua, nhng qun thng c bit n rng ri trong s ngi dn a phng v du khch thng xuyn.</p>
<p><strong>Vui lng xc minh a ch chnh xc ti a phng hoc trn bn  trc tuyn gn y v cc doanh nghip trong cc khu du lch ni ting i khi c th thay i v tr mt cht.</strong></p>

<h6>Mo dnh cho du khch:</h6>
<ul>
  <li><strong>i vo bui ti:</strong> Qun bar thc s sng ng khi mt tri ln.</li>
  <li><strong>Hi li khuyn:</strong> Nhn vin thng rt am hiu v c th gii thiu  ung.</li>
  <li><strong>Tn hng khng kh:</strong> y l ni  th gin v tn hng nhng th vui n gin ca Hi An.</li>
</ul>
      `,internalImageNames:[]},slug:{en:"japanese-covered-bridge",ru:"yaponskiy-krytyy-most",es:"puente-cubierto-japones",fr:"pont-couvert-japonais",vn:"cau-chua-nhat-ban"}},{id:"saranai",coordinates:[15.93523065687307,108.31362357169075],category:["clubs"],imageUrl:"56.jpg",en:{title:"Saranai Beach House",description:"A serene and stylish beachfront retreat in Hoi An, offering a relaxed atmosphere, delicious food, and direct access to An Bang Beach.",fullDescription:`
<p><strong>Saranai Beach House</strong> is a hidden gem in Hoi An, offering a perfect blend of a tranquil beachfront escape and a vibrant social hub. Located directly on the golden sands of An Bang Beach, it's an ideal spot for those looking to unwind, enjoy delicious food and drinks, and soak up the sun and sea.</p>

<h6>Concept & Atmosphere:</h6>
<ul>
  <li><strong>Beachfront Bliss:</strong> Saranai provides direct access to An Bang Beach, making it perfect for sunbathing, swimming, or simply enjoying the ocean breeze.</li>
  <li><strong>Relaxed & Bohemian Vibe:</strong> The design often features natural materials, comfortable seating areas, and a laid-back, rustic-chic aesthetic that blends seamlessly with the coastal environment. It's designed for comfort and ease.</li>
  <li><strong>Multipurpose Venue:</strong> Functions as a restaurant, bar, and sometimes offers accommodation or hosts events, making it versatile for different visitor needs.</li>
  <li><strong>Family-Friendly:</strong> Often praised for being a great spot for families, with space for children to play on the beach.</li>
</ul>

<h6>Food & Drinks:</h6>
<ul>
  <li><strong>Diverse Menu:</strong> Saranai offers a comprehensive menu featuring a mix of Vietnamese specialties and Western dishes, catering to various tastes. Seafood is a natural highlight.</li>
  <li><strong>Fresh Ingredients:</strong> Emphasis is often placed on fresh, local ingredients, especially seafood, ensuring high-quality meals.</li>
  <li><strong>Refreshing Beverages:</strong> A wide selection of drinks is available, including fresh juices, smoothies, local beers, cocktails, and wines  perfect for a hot beach day.</li>
  <li><strong>Breakfast, Lunch & Dinner:</strong> Serves meals throughout the day, from hearty breakfasts to romantic dinners by the sea.</li>
</ul>

<h6>Amenities & Experiences:</h6>
<ul>
  <li><strong>Beach Chairs & Umbrellas:</strong> Guests can often use comfortable beach chairs and umbrellas, sometimes with a minimum spend on food/drinks.</li>
  <li><strong>Stunning Views:</strong> Enjoy panoramic views of the ocean, especially beautiful during sunrise or sunset.</li>
  <li><strong>Music & Events:</strong> While generally laid-back, Saranai may host occasional live music or special events, particularly during peak season or holidays.</li>
  <li><strong>Showers & Facilities:</strong> Basic facilities for changing and showering after a swim are usually available.</li>
</ul>

<h6>Location:</h6>
<p>Saranai Beach House is situated right on **An Bang Beach** (Bin An Bng) in Hoi An. An Bang Beach is located a few kilometers east of Hoi An Ancient Town and is easily accessible by bicycle, motorbike, or taxi.</p>
<p>Its exact spot is typically found along the main stretch of beach where many beach clubs and restaurants are located.</p>

<h6>Visitor Tips:</h6>
<ul>
  <li><strong>Go for Sunset:</strong> The sunsets over An Bang Beach are spectacular, and Saranai offers a prime viewing spot.</li>
  <li><strong>Stay for a Day:</strong> It's a great place to spend an entire day, combining swimming, sunbathing, eating, and relaxing.</li>
  <li><strong>Try the Seafood:</strong> Given its beachfront location, fresh seafood is highly recommended.</li>
  <li><strong>Book Ahead (Peak Season):</strong> During busy periods, consider booking a table, especially for larger groups or dinner.</li>
</ul>
      `,internalImageNames:[]},es:{title:"Saranai Beach House",description:"Un retiro sereno y elegante frente a la playa en Hoi An, que ofrece un ambiente relajado, deliciosa comida y acceso directo a la playa de An Bang.",fullDescription:`
<p><strong>Saranai Beach House</strong> es una joya escondida en Hoi An, que ofrece una combinacin perfecta de una escapada tranquila frente a la playa y un vibrante centro social. Ubicado directamente en las doradas arenas de la playa de An Bang, es un lugar ideal para aquellos que buscan relajarse, disfrutar de deliciosas comidas y bebidas, y tomar el sol y el mar.</p>

<h6>Concepto y Ambiente:</h6>
<ul>
  <li><strong>Felicidad Frente a la Playa:</strong> Saranai ofrece acceso directo a la playa de An Bang, lo que lo hace perfecto para tomar el sol, nadar o simplemente disfrutar de la brisa del ocano.</li>
  <li><strong>Vibe Relajado y Bohemio:</strong> El diseo a menudo presenta materiales naturales, cmodas reas de descanso y una esttica relajada y rstica-chic que se integra perfectamente con el entorno costero. Est diseado para la comodidad y la facilidad.</li>
  <li><strong>Lugar Multiusos:</strong> Funciona como restaurante, bar y, a veces, ofrece alojamiento o alberga eventos, lo que lo hace verstil para las diferentes necesidades de los visitantes.</li>
  <li><strong>Ideal para Familias:</strong> A menudo elogiado por ser un gran lugar para familias, con espacio para que los nios jueguen en la playa.</li>
</ul>

<h6>Comida y Bebidas:</h6>
<ul>
  <li><strong>Men Diverso:</strong> Saranai ofrece un men completo con una mezcla de especialidades vietnamitas y platos occidentales, para satisfacer diversos gustos. Los mariscos son un punto culminante natural.</li>
  <li><strong>Ingredientes Frescos:</strong> A menudo se hace hincapi en los ingredientes frescos y locales, especialmente los mariscos, lo que garantiza comidas de alta calidad.</li>
  <li><strong>Bebidas Refrescantes:</strong> Hay una amplia seleccin de bebidas disponibles, incluidos zumos frescos, batidos, cervezas locales, ccteles y vinos, perfectos para un da caluroso en la playa.</li>
  <li><strong>Desayuno, Almuerzo y Cena:</strong> Sirve comidas durante todo el da, desde desayunos abundantes hasta cenas romnticas junto al mar.</li>
</ul>

<h6>Servicios y Experiencias:</h6>
<ul>
  <li><strong>Sillas de Playa y Sombrillas:</strong> Los huspedes a menudo pueden usar cmodas sillas de playa y sombrillas, a veces con un consumo mnimo en alimentos/bebidas.</li>
  <li><strong>Vistas Impresionantes:</strong> Disfrute de vistas panormicas del ocano, especialmente hermosas durante el amanecer o el atardecer.</li>
  <li><strong>Msica y Eventos:</strong> Aunque generalmente es relajado, Saranai puede albergar msica en vivo ocasional o eventos especiales, particularmente durante la temporada alta o las vacaciones.</li>
  <li><strong>Duchas e Instalaciones:</strong> Por lo general, hay instalaciones bsicas para cambiarse y ducharse despus de nadar.</li>
</ul>

<h6>Ubicacin:</h6>
<p>Saranai Beach House est situado directamente en la <strong>playa de An Bang</strong> (Bin An Bng) en Hoi An. La playa de An Bang se encuentra a pocos kilmetros al este del casco antiguo de Hoi An y es fcilmente accesible en bicicleta, moto o taxi.</p>
<p>Su ubicacin exacta suele encontrarse a lo largo del tramo principal de la playa donde se encuentran muchos clubes de playa y restaurantes.</p>

<h6>Consejos para Visitantes:</h6>
<ul>
  <li><strong>Vaya al Atardecer:</strong> Los atardeceres sobre la playa de An Bang son espectaculares, y Saranai ofrece un lugar privilegiado para verlos.</li>
  <li><strong>Qudese un Da:</strong> Es un lugar ideal para pasar todo el da, combinando natacin, tomar el sol, comer y relajarse.</li>
  <li><strong>Pruebe los Mariscos:</strong> Dada su ubicacin frente a la playa, se recomienda encarecidamente probar los mariscos frescos.</li>
  <li><strong>Reserve con Anticipacin (Temporada Alta):</strong> Durante los perodos de mayor afluencia, considere reservar una mesa, especialmente para grupos grandes o cenas.</li>
</ul>
      `,internalImageNames:[]},fr:{title:"Saranai Beach House",description:"Un havre de paix lgant et serein en bord de mer  Hoi An, offrant une ambiance dcontracte, une cuisine dlicieuse et un accs direct  la plage d'An Bang.",fullDescription:`
<p><strong>Saranai Beach House</strong> est un joyau cach  Hoi An, offrant un mlange parfait d'vasion tranquille en bord de mer et de centre social anim. Situ directement sur les sables dors de la plage d'An Bang, c'est un endroit idal pour ceux qui cherchent  se dtendre,  savourer de dlicieux plats et boissons, et  profiter du soleil et de la mer.</p>

<h6>Concept & Ambiance :</h6>
<ul>
  <li><strong>Bonheur en Bord de Mer :</strong> Saranai offre un accs direct  la plage d'An Bang, ce qui le rend parfait pour bronzer, nager ou simplement profiter de la brise marine.</li>
  <li><strong>Ambiance Dcontracte et Bohme :</strong> Le design prsente souvent des matriaux naturels, des coins salons confortables et une esthtique dcontracte et rustique-chic qui s'intgre parfaitement  l'environnement ctier. Il est conu pour le confort et la facilit.</li>
  <li><strong>Lieu Polyvalent :</strong> Fonctionne comme un restaurant, un bar et propose parfois des hbergements ou organise des vnements, ce qui le rend polyvalent pour les diffrents besoins des visiteurs.</li>
  <li><strong>Idal pour les Familles :</strong> Souvent salu pour tre un excellent endroit pour les familles, avec de l'espace pour que les enfants puissent jouer sur la plage.</li>
</ul>

<h6>Cuisine & Boissons :</h6>
<ul>
  <li><strong>Menu Diversifi :</strong> Saranai propose un menu complet comprenant un mlange de spcialits vietnamiennes et de plats occidentaux, pour satisfaire les gots varis. Les fruits de mer sont naturellement un point fort.</li>
  <li><strong>Ingrdients Frais :</strong> L'accent est souvent mis sur les ingrdients frais et locaux, en particulier les fruits de mer, garantissant des repas de haute qualit.</li>
  <li><strong>Boissons Rafrachissantes :</strong> Un large choix de boissons est disponible, y compris des jus frais, des smoothies, des bires locales, des cocktails et des vins  parfaits pour une chaude journe  la plage.</li>
  <li><strong>Petit-djeuner, Djeuner & Dner :</strong> Sert des repas tout au long de la journe, des petits-djeuners copieux aux dners romantiques en bord de mer.</li>
</ul>

<h6>Commodits & Expriences :</h6>
<ul>
  <li><strong>Chaises de Plage & Parasols :</strong> Les clients peuvent souvent utiliser des chaises de plage confortables et des parasols, parfois avec une dpense minimale en nourriture/boissons.</li>
  <li><strong>Vues Imprenables :</strong> Profitez de vues panoramiques sur l'ocan, particulirement belles au lever ou au coucher du soleil.</li>
  <li><strong>Musique & vnements :</strong> Bien que gnralement dcontract, Saranai peut parfois organiser des concerts ou des vnements spciaux, notamment pendant la haute saison ou les vacances.</li>
  <li><strong>Douches & Installations :</strong> Des installations de base pour se changer et se doucher aprs une baignade sont gnralement disponibles.</li>
</ul>

<h6>Localisation :</h6>
<p>Saranai Beach House est situ directement sur la <strong>plage d'An Bang</strong> (Bin An Bng)  Hoi An. La plage d'An Bang est situe  quelques kilomtres  l'est de la vieille ville de Hoi An et est facilement accessible  vlo, en moto ou en taxi.</p>
<p>Son emplacement exact se trouve gnralement le long de la principale tendue de plage o se trouvent de nombreux clubs de plage et restaurants.</p>

<h6>Conseils pour les Visiteurs :</h6>
<ul>
  <li><strong>Allez-y au Coucher du Soleil :</strong> Les couchers de soleil sur la plage d'An Bang sont spectaculaires, et Saranai offre un point de vue privilgi.</li>
  <li><strong>Restez une Journe :</strong> C'est un excellent endroit pour passer une journe entire, combinant natation, bronzage, repas et dtente.</li>
  <li><strong>Gotez aux Fruits de Mer :</strong> Compte tenu de son emplacement en bord de mer, les fruits de mer frais sont fortement recommands.</li>
  <li><strong>Rservez  l'Avance (Haute Saison) :</strong> Pendant les priodes de forte affluence, pensez  rserver une table, surtout pour les grands groupes ou le dner.</li>
</ul>
      `,internalImageNames:[]},ru:{title:"Saranai Beach House",description:"      ,   ,         .",fullDescription:`
<p><strong>Saranai Beach House</strong>      ,          .        ,     ,   ,     ,        .</p>

<h6>  :</h6>
<ul>
  <li><strong> :</strong> Saranai       ,        ,      .</li>
  <li><strong>   :</strong>     ,     , - ,      .      .</li>
  <li><strong> :</strong>   ,        ,        .</li>
  <li><strong>   :</strong>        ,       .</li>
</ul>

<h6>  :</h6>
<ul>
  <li><strong> :</strong> Saranai   ,     ,    ,   . , ,  .</li>
  <li><strong> :</strong>       ,  ,     .</li>
  <li><strong> :</strong>    ,   , ,  ,         .</li>
  <li><strong>,   :</strong>      ,        .</li>
</ul>

<h6>  :</h6>
<ul>
  <li><strong>   :</strong>         ,      /.</li>
  <li><strong> :</strong>     ,        .</li>
  <li><strong>  :</strong>    Saranai   ,            ,      .</li>
  <li><strong>  :</strong>           .</li>
</ul>

<h6>:</h6>
<p>Saranai Beach House    <strong>  </strong> (Bin An Bng)  .                  ,   .</p>
<p>        ,       .</p>

<h6>  :</h6>
<ul>
  <li><strong>  :</strong>      ,  Saranai      .</li>
  <li><strong>   :</strong>   ,    ,  ,   ,   .</li>
  <li><strong> :</strong>     ,    .</li>
  <li><strong>  ( ):</strong>        ,      .</li>
</ul>
      `,internalImageNames:[]},vn:{title:"Saranai Beach House",description:"Mt ni ngh dng bn b bin thanh bnh v y phong cch  Hi An, mang n khng gian th gin,  n ngon v li i thng ra Bi bin An Bng.",fullDescription:`
<p><strong>Saranai Beach House</strong> l mt vin ngc n mnh ti Hi An, mang n s kt hp hon ho gia mt ni ngh dng yn bnh bn b bin v mt trung tm x hi si ng. Nm ngay trn bi ct vng ca Bi bin An Bng, y l a im l tng cho nhng ai mun th gin, thng thc  n v thc ung ngon, v tn hng nh nng mt tri cng bin c.</p>

<h6>Khi nim & Bu khng kh:</h6>
<ul>
  <li><strong>Hnh phc bn b bin:</strong> Saranai cung cp li i thng ra Bi bin An Bng, gip ni y hon ho  tm nng, bi li hoc n gin l tn hng ln gi bin.</li>
  <li><strong>Phong cch th gin & Bohemian:</strong> Thit k thng s dng vt liu t nhin, cc khu vc ch ngi thoi mi v mt phong cch mc mc, sang trng, hi ha vi mi trng ven bin. Ni y c thit k  mang li s thoi mi v d chu.</li>
  <li><strong>a im a nng:</strong> Hot ng nh mt nh hng, qun bar v i khi cung cp ch  hoc t chc s kin, lm cho ni y linh hot cho cc nhu cu khc nhau ca du khch.</li>
  <li><strong>Thn thin vi Gia nh:</strong> Thng c ca ngi l mt a im tuyt vi cho gia nh, vi khng gian cho tr em chi trn bi bin.</li>
</ul>

<h6> n & Thc ung:</h6>
<ul>
  <li><strong>Thc n a dng:</strong> Saranai cung cp mt thc n phong ph gm cc mn c sn Vit Nam v cc mn n phng Ty, phc v nhiu khu v khc nhau. Hi sn l im nhn t nhin.</li>
  <li><strong>Nguyn liu Ti sng:</strong> S nhn mnh thng c t vo cc nguyn liu ti, a phng, c bit l hi sn, m bo cc ba n cht lng cao.</li>
  <li><strong>Thc ung Gii kht:</strong> C sn nhiu la chn  ung, bao gm nc p ti, sinh t, bia a phng, cocktail v ru vang  hon ho cho mt ngy nng nng trn bi bin.</li>
  <li><strong>Ba sng, Ba tra & Ba ti:</strong> Phc v cc ba n sut c ngy, t ba sng thnh son n ba ti lng mn bn b bin.</li>
</ul>

<h6>Tin nghi & Tri nghim:</h6>
<ul>
  <li><strong>Gh bi bin & :</strong> Khch thng c th s dng gh bi bin thoi mi v , i khi c yu cu chi tiu ti thiu cho  n/thc ung.</li>
  <li><strong>Tm nhn Tuyt p:</strong> Tn hng tm nhn ton cnh ra i dng, c bit p vo lc bnh minh hoc hong hn.</li>
  <li><strong>m nhc & S kin:</strong> Mc d thng yn tnh, Saranai c th t chc cc bui biu din nhc sng hoc cc s kin c bit, c bit l trong ma cao im hoc ngy l.</li>
  <li><strong>Vi sen & Tin nghi:</strong> Thng c sn cc tin nghi c bn  thay  v tm sau khi bi.</li>
</ul>

<h6>V tr:</h6>
<p>Saranai Beach House nm ngay trn <strong>Bi bin An Bng</strong> (Bin An Bng)  Hi An. Bi bin An Bng nm cch Ph c Hi An vi km v pha ng v d dng tip cn bng xe p, xe my hoc taxi.</p>
<p>V tr chnh xc ca n thng nm dc theo on bi bin chnh ni c nhiu cu lc b bi bin v nh hng.</p>

<h6>Mo dnh cho Du khch:</h6>
<ul>
  <li><strong>i vo lc hong hn:</strong> Hong hn trn Bi bin An Bng rt ngon mc, v Saranai cung cp mt v tr c a  ngm cnh.</li>
  <li><strong> li c ngy:</strong> y l mt ni tuyt vi  dnh c ngy, kt hp bi li, tm nng, n ung v th gin.</li>
  <li><strong>Th hi sn:</strong> Vi v tr ngay bi bin, hi sn ti sng rt c khuyn khch.</li>
  <li><strong>t trc (Ma cao im):</strong> Trong thi gian cao im, hy cn nhc t bn, c bit i vi cc nhm ln hoc ba ti.</li>
</ul>
      `,internalImageNames:[]},slug:{en:"japanese-covered-bridge",ru:"yaponskiy-krytyy-most",es:"puente-cubierto-japones",fr:"pont-couvert-japonais",vn:"cau-chua-nhat-ban"}}],zC=[...M6,...R6,...z6,...L6],LC={museum:"#1976d2","food-drinks":"#ed6c02","art-galleries":"#9c27b0",clubs:"#000",default:"#ff980"},P0=a=>LC[a]||LC.default,D6=ue.memo(function({filteredLandmarks:l,activeIndex:m,hasInteractedWithMarkers:_,isContentLoaded:w,snackbarImages:C,getImageUrl:M,getLocalizedContent:r,onSlideChange:O,onSlideOrButtonDetailClick:V,swiperRef:U}){const{t:Z}=Gl(),ie=gl();return Ne.jsx($s,{sx:{width:"100%",height:{xs:"auto",md:"auto"},flexShrink:0,p:1,display:"flex",alignItems:"center",justifyContent:"center",position:"fixed",bottom:0,zIndex:1e3,overscrollBehaviorY:"contain",overscrollBehaviorX:"contain"},children:Ne.jsxs(iI,{spaceBetween:8,breakpoints:{0:{slidesPerView:1,spaceBetween:8},600:{slidesPerView:2,spaceBetween:8},900:{slidesPerView:3,spaceBetween:8},1200:{slidesPerView:4,spaceBetween:8}},centeredSlides:!0,pagination:{clickable:!0},style:{width:"100%",height:"100%"},onSwiper:de=>U.current=de,initialSlide:m!==null&&l.length>0?m:0,onSlideChange:O,children:[!_&&Ne.jsx(I0,{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-end",padding:"8px",boxSizing:"border-box",cursor:"pointer",backgroundColor:ie.palette.background.paper,borderRadius:"8px",textAlign:"center",height:"172px",opacity:w?1:0,transform:w?"translateY(0)":"translateY(100px)",transition:"opacity 1s ease-out, transform 1s cubic-bezier(0.25, 1, 0.5, 1)"},children:Ne.jsxs($s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end",width:"100%",height:"100%"},children:[Ne.jsx($s,{component:"img",src:C.welcome,alt:"Welcome",sx:{width:{xs:72},height:{xs:"auto"},objectFit:"contain",mb:1,mt:1}}),Ne.jsx(na,{variant:"h6",component:"h3",sx:{mb:0},children:Z("swiperWelcomeTitle")}),Ne.jsx(na,{variant:"body2",color:"text.secondary",sx:{mb:1},children:Z("swiperWelcomeSubtitle")})]})}),l.map((de,se)=>{const ne=r(de),Se=120;let me=ne.description;return me&&me.length>Se&&(me=me.substring(0,Se),me=me.substring(0,Math.min(me.length,me.lastIndexOf(" "))),me+="..."),Ne.jsx(I0,{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",padding:"8px",boxSizing:"border-box",backgroundColor:m===se?ie.palette.background.paper:p0(ie.palette.background.paper,.9),borderRadius:"8px"},onClick:Re=>{V(se,Re)},children:Ne.jsxs($s,{sx:{display:"flex",gap:1,flexDirection:{xs:"row",md:"row"},width:"100%"},children:[de.imageUrl&&Ne.jsx($s,{sx:{flexShrink:0,width:{xs:"124px",md:"124px"},height:"100%",borderRadius:"8px",overflow:"hidden",display:"flex",alignItems:"center",aspectRatio:"4/5",justifyContent:"center"},children:Ne.jsx($s,{component:"img",src:M(de.imageUrl),alt:ne.title,sx:{width:"100%",height:"100%",objectFit:"cover"}})}),Ne.jsxs($s,{sx:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"flex-start",minWidth:0},children:[de.category&&de.category.length>0&&Ne.jsx(Rm,{direction:"row",spacing:.5,sx:{mt:.5,flexWrap:"wrap"},children:de.category.map(Re=>{const ye=P0(Re);return Ne.jsx(C3,{label:Z(`categories.${Re}`),size:"small",variant:"filled",sx:{height:18,fontSize:"0.75rem",backgroundColor:ye,color:ie.palette.getContrastText(ye),"&:hover":{backgroundColor:p0(ye,.8)}}},Re)})}),Ne.jsx(na,{variant:"body1",component:"h3",sx:{mb:.5,mt:1,lineHeight:1.4,textAlign:"left",width:"100%",WebkitLineClamp:2,WebkitBoxOrient:"vertical",textOverflow:"ellipsis"},children:ne.title}),Ne.jsx(na,{variant:"caption",color:"text.secondary",sx:{mb:1,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:me}),Ne.jsx(nb,{size:"small",onClick:Re=>{Re.stopPropagation(),V(se,Re)},sx:{mt:0,p:0},children:Ne.jsx(na,{variant:"caption",children:Z("moreDetails")})})]})]})},de.id)})]})})}),O6="/assets/1-CGI0Vlw7.jpg",B6=Object.freeze(Object.defineProperty({__proto__:null,default:O6},Symbol.toStringTag,{value:"Module"})),F6="/assets/10-DSWljDet.jpg",j6=Object.freeze(Object.defineProperty({__proto__:null,default:F6},Symbol.toStringTag,{value:"Module"})),N6="/assets/11-9G2iCV8p.jpg",V6=Object.freeze(Object.defineProperty({__proto__:null,default:N6},Symbol.toStringTag,{value:"Module"})),q6="/assets/12-BF6n2yob.jpg",H6=Object.freeze(Object.defineProperty({__proto__:null,default:q6},Symbol.toStringTag,{value:"Module"})),U6="/assets/13-B96CBMMh.jpg",$6=Object.freeze(Object.defineProperty({__proto__:null,default:U6},Symbol.toStringTag,{value:"Module"})),G6="/assets/14-B1yt2nI3.jpg",W6=Object.freeze(Object.defineProperty({__proto__:null,default:G6},Symbol.toStringTag,{value:"Module"})),Z6="/assets/15-fSbRZtMy.jpg",K6=Object.freeze(Object.defineProperty({__proto__:null,default:Z6},Symbol.toStringTag,{value:"Module"})),X6="/assets/16-ClroVASi.jpg",Y6=Object.freeze(Object.defineProperty({__proto__:null,default:X6},Symbol.toStringTag,{value:"Module"})),Q6="/assets/17-CV3IegS3.jpg",J6=Object.freeze(Object.defineProperty({__proto__:null,default:Q6},Symbol.toStringTag,{value:"Module"})),eV="/assets/18-eoEq9D_C.jpg",tV=Object.freeze(Object.defineProperty({__proto__:null,default:eV},Symbol.toStringTag,{value:"Module"})),nV="/assets/19-BIscYJ4k.jpg",iV=Object.freeze(Object.defineProperty({__proto__:null,default:nV},Symbol.toStringTag,{value:"Module"})),rV="/assets/2-B3C2ayi2.jpg",sV=Object.freeze(Object.defineProperty({__proto__:null,default:rV},Symbol.toStringTag,{value:"Module"})),oV="/assets/20-DkqZXr3-.jpg",aV=Object.freeze(Object.defineProperty({__proto__:null,default:oV},Symbol.toStringTag,{value:"Module"})),lV="/assets/21-BZcqIYr3.jpg",cV=Object.freeze(Object.defineProperty({__proto__:null,default:lV},Symbol.toStringTag,{value:"Module"})),uV="/assets/22-BzklSMKz.jpg",hV=Object.freeze(Object.defineProperty({__proto__:null,default:uV},Symbol.toStringTag,{value:"Module"})),dV="/assets/23-BXFp1hHv.jpg",pV=Object.freeze(Object.defineProperty({__proto__:null,default:dV},Symbol.toStringTag,{value:"Module"})),fV="/assets/24-D8Wb9wXh.jpg",mV=Object.freeze(Object.defineProperty({__proto__:null,default:fV},Symbol.toStringTag,{value:"Module"})),gV="/assets/25-DjMbkjzt.jpg",_V=Object.freeze(Object.defineProperty({__proto__:null,default:gV},Symbol.toStringTag,{value:"Module"})),yV="/assets/26-xiB-Tv12.jpg",vV=Object.freeze(Object.defineProperty({__proto__:null,default:yV},Symbol.toStringTag,{value:"Module"})),xV="/assets/27-BBUTsHfh.jpg",bV=Object.freeze(Object.defineProperty({__proto__:null,default:xV},Symbol.toStringTag,{value:"Module"})),wV="/assets/28-CTHfuGGI.jpg",TV=Object.freeze(Object.defineProperty({__proto__:null,default:wV},Symbol.toStringTag,{value:"Module"})),SV="/assets/29-_894_kEU.jpg",CV=Object.freeze(Object.defineProperty({__proto__:null,default:SV},Symbol.toStringTag,{value:"Module"})),EV="/assets/3-6Qg8obZP.jpg",AV=Object.freeze(Object.defineProperty({__proto__:null,default:EV},Symbol.toStringTag,{value:"Module"})),IV="/assets/30-C7mbz-SH.jpg",PV=Object.freeze(Object.defineProperty({__proto__:null,default:IV},Symbol.toStringTag,{value:"Module"})),kV="/assets/31-DsQIeCQ7.jpg",MV=Object.freeze(Object.defineProperty({__proto__:null,default:kV},Symbol.toStringTag,{value:"Module"})),RV="/assets/32-Bp7RtVdI.jpg",zV=Object.freeze(Object.defineProperty({__proto__:null,default:RV},Symbol.toStringTag,{value:"Module"})),LV="/assets/33-9Ripstaw.jpg",DV=Object.freeze(Object.defineProperty({__proto__:null,default:LV},Symbol.toStringTag,{value:"Module"})),OV="/assets/34-BkZ2k5Ip.jpg",BV=Object.freeze(Object.defineProperty({__proto__:null,default:OV},Symbol.toStringTag,{value:"Module"})),FV="/assets/35-BV6BbL_A.jpg",jV=Object.freeze(Object.defineProperty({__proto__:null,default:FV},Symbol.toStringTag,{value:"Module"})),NV="/assets/36-JTmUNWzL.jpg",VV=Object.freeze(Object.defineProperty({__proto__:null,default:NV},Symbol.toStringTag,{value:"Module"})),qV="/assets/37-BNtxzS8T.jpg",HV=Object.freeze(Object.defineProperty({__proto__:null,default:qV},Symbol.toStringTag,{value:"Module"})),UV="/assets/38-DHD00hgZ.jpg",$V=Object.freeze(Object.defineProperty({__proto__:null,default:UV},Symbol.toStringTag,{value:"Module"})),GV="/assets/39-BqCB5Gvw.jpg",WV=Object.freeze(Object.defineProperty({__proto__:null,default:GV},Symbol.toStringTag,{value:"Module"})),ZV="/assets/4-BIDAL2Bb.jpg",KV=Object.freeze(Object.defineProperty({__proto__:null,default:ZV},Symbol.toStringTag,{value:"Module"})),XV="/assets/40-BYIyDbJH.jpg",YV=Object.freeze(Object.defineProperty({__proto__:null,default:XV},Symbol.toStringTag,{value:"Module"})),QV="/assets/41-Da2PYH9y.jpg",JV=Object.freeze(Object.defineProperty({__proto__:null,default:QV},Symbol.toStringTag,{value:"Module"})),eq="/assets/42-B3Gm9tMk.jpg",tq=Object.freeze(Object.defineProperty({__proto__:null,default:eq},Symbol.toStringTag,{value:"Module"})),nq="/assets/43-NW0FnZ21.jpg",iq=Object.freeze(Object.defineProperty({__proto__:null,default:nq},Symbol.toStringTag,{value:"Module"})),rq="/assets/44-ZGoPsOaU.jpg",sq=Object.freeze(Object.defineProperty({__proto__:null,default:rq},Symbol.toStringTag,{value:"Module"})),oq="/assets/45-CmxDdCCI.jpg",aq=Object.freeze(Object.defineProperty({__proto__:null,default:oq},Symbol.toStringTag,{value:"Module"})),lq="/assets/46-BXclbjmH.jpg",cq=Object.freeze(Object.defineProperty({__proto__:null,default:lq},Symbol.toStringTag,{value:"Module"})),uq="/assets/47-DKe_aU-Z.jpg",hq=Object.freeze(Object.defineProperty({__proto__:null,default:uq},Symbol.toStringTag,{value:"Module"})),dq="/assets/48-BmYacCKW.jpg",pq=Object.freeze(Object.defineProperty({__proto__:null,default:dq},Symbol.toStringTag,{value:"Module"})),fq="/assets/49-HzDPfrsp.jpg",mq=Object.freeze(Object.defineProperty({__proto__:null,default:fq},Symbol.toStringTag,{value:"Module"})),gq="/assets/5-Bn0vIn5S.jpg",_q=Object.freeze(Object.defineProperty({__proto__:null,default:gq},Symbol.toStringTag,{value:"Module"})),yq="/assets/50-B1bMsjsX.jpg",vq=Object.freeze(Object.defineProperty({__proto__:null,default:yq},Symbol.toStringTag,{value:"Module"})),xq="/assets/51-C7m48e91.jpg",bq=Object.freeze(Object.defineProperty({__proto__:null,default:xq},Symbol.toStringTag,{value:"Module"})),wq="/assets/52-BJMtknZe.jpg",Tq=Object.freeze(Object.defineProperty({__proto__:null,default:wq},Symbol.toStringTag,{value:"Module"})),Sq="/assets/53-BTi2D3GK.jpg",Cq=Object.freeze(Object.defineProperty({__proto__:null,default:Sq},Symbol.toStringTag,{value:"Module"})),Eq="/assets/54-CmmC1X1q.jpg",Aq=Object.freeze(Object.defineProperty({__proto__:null,default:Eq},Symbol.toStringTag,{value:"Module"})),Iq="/assets/55-BZda06qO.jpg",Pq=Object.freeze(Object.defineProperty({__proto__:null,default:Iq},Symbol.toStringTag,{value:"Module"})),kq="/assets/56-BMhby0JT.jpg",Mq=Object.freeze(Object.defineProperty({__proto__:null,default:kq},Symbol.toStringTag,{value:"Module"})),Rq="/assets/57-BRmhovHH.jpg",zq=Object.freeze(Object.defineProperty({__proto__:null,default:Rq},Symbol.toStringTag,{value:"Module"})),Lq="/assets/58-D8oim3zP.jpg",Dq=Object.freeze(Object.defineProperty({__proto__:null,default:Lq},Symbol.toStringTag,{value:"Module"})),Oq="/assets/59-56YSzuZ-.jpg",Bq=Object.freeze(Object.defineProperty({__proto__:null,default:Oq},Symbol.toStringTag,{value:"Module"})),Fq="/assets/6-BcThggzA.jpg",jq=Object.freeze(Object.defineProperty({__proto__:null,default:Fq},Symbol.toStringTag,{value:"Module"})),Nq="/assets/60-CyRgQgfF.jpg",Vq=Object.freeze(Object.defineProperty({__proto__:null,default:Nq},Symbol.toStringTag,{value:"Module"})),qq="/assets/7-DfLBYiKl.jpg",Hq=Object.freeze(Object.defineProperty({__proto__:null,default:qq},Symbol.toStringTag,{value:"Module"})),Uq="/assets/8-TSzkn7Oo.jpg",$q=Object.freeze(Object.defineProperty({__proto__:null,default:Uq},Symbol.toStringTag,{value:"Module"})),Gq="/assets/9-CSNFRg_J.jpg",Wq=Object.freeze(Object.defineProperty({__proto__:null,default:Gq},Symbol.toStringTag,{value:"Module"})),Zq="/assets/dragon-CWGVTYOO.png",Kq=Object.freeze(Object.defineProperty({__proto__:null,default:Zq},Symbol.toStringTag,{value:"Module"})),rI={},DC=Object.assign({"../assets/img/pictures/1.jpg":B6,"../assets/img/pictures/10.jpg":j6,"../assets/img/pictures/11.jpg":V6,"../assets/img/pictures/12.jpg":H6,"../assets/img/pictures/13.jpg":$6,"../assets/img/pictures/14.jpg":W6,"../assets/img/pictures/15.jpg":K6,"../assets/img/pictures/16.jpg":Y6,"../assets/img/pictures/17.jpg":J6,"../assets/img/pictures/18.jpg":tV,"../assets/img/pictures/19.jpg":iV,"../assets/img/pictures/2.jpg":sV,"../assets/img/pictures/20.jpg":aV,"../assets/img/pictures/21.jpg":cV,"../assets/img/pictures/22.jpg":hV,"../assets/img/pictures/23.jpg":pV,"../assets/img/pictures/24.jpg":mV,"../assets/img/pictures/25.jpg":_V,"../assets/img/pictures/26.jpg":vV,"../assets/img/pictures/27.jpg":bV,"../assets/img/pictures/28.jpg":TV,"../assets/img/pictures/29.jpg":CV,"../assets/img/pictures/3.jpg":AV,"../assets/img/pictures/30.jpg":PV,"../assets/img/pictures/31.jpg":MV,"../assets/img/pictures/32.jpg":zV,"../assets/img/pictures/33.jpg":DV,"../assets/img/pictures/34.jpg":BV,"../assets/img/pictures/35.jpg":jV,"../assets/img/pictures/36.jpg":VV,"../assets/img/pictures/37.jpg":HV,"../assets/img/pictures/38.jpg":$V,"../assets/img/pictures/39.jpg":WV,"../assets/img/pictures/4.jpg":KV,"../assets/img/pictures/40.jpg":YV,"../assets/img/pictures/41.jpg":JV,"../assets/img/pictures/42.jpg":tq,"../assets/img/pictures/43.jpg":iq,"../assets/img/pictures/44.jpg":sq,"../assets/img/pictures/45.jpg":aq,"../assets/img/pictures/46.jpg":cq,"../assets/img/pictures/47.jpg":hq,"../assets/img/pictures/48.jpg":pq,"../assets/img/pictures/49.jpg":mq,"../assets/img/pictures/5.jpg":_q,"../assets/img/pictures/50.jpg":vq,"../assets/img/pictures/51.jpg":bq,"../assets/img/pictures/52.jpg":Tq,"../assets/img/pictures/53.jpg":Cq,"../assets/img/pictures/54.jpg":Aq,"../assets/img/pictures/55.jpg":Pq,"../assets/img/pictures/56.jpg":Mq,"../assets/img/pictures/57.jpg":zq,"../assets/img/pictures/58.jpg":Dq,"../assets/img/pictures/59.jpg":Bq,"../assets/img/pictures/6.jpg":jq,"../assets/img/pictures/60.jpg":Vq,"../assets/img/pictures/7.jpg":Hq,"../assets/img/pictures/8.jpg":$q,"../assets/img/pictures/9.jpg":Wq,"../assets/img/pictures/dragon.png":Kq});for(const a in DC){const l=a.split("/").pop(),m=DC[a];m&&typeof m=="object"&&"default"in m?rI[l]=m.default:console.warn(`Warning: Module for ${l} did not have a 'default' export. Path: ${a}`,m)}const Xq=({open:a,onClose:l,selectedLandmark:m})=>{const{t:_,i18n:w}=Gl(),C=ue.useRef(null),[M,r]=ue.useState(new Set),O=ue.useCallback(U=>{const Z=w.language;return Z==="ru"&&U.ru?U.ru:Z==="es"&&U.es?U.es:Z==="fr"&&U.fr?U.fr:Z==="vn"&&U.vn?U.vn:U.en},[w.language]),V=ue.useCallback(U=>{const Z=O(U),ie=Z.fullDescription,de=Z.internalImageNames;if(!ie)return"";let se=ie;return de&&de.length>0&&de.forEach(ne=>{const Se=rI[ne];Se?se=se.replace(new RegExp(`src="${ne}"`,"g"),`src="${Se}"`):console.warn(`Warning: Image ${ne} specified in internalImageNames but not found in fullDescriptionImageMap for landmark ${U.id}.`)}),se=se.replace(/<img([^>]+?)\/?>/g,'<div class="landmark__img-wrapper"><img class="image-fade-in"$1/></div>'),se},[O]);return ue.useEffect(()=>{a&&C.current&&(C.current.scrollTop=0,C.current.querySelectorAll(".landmark-details-content .landmark__img-wrapper img").forEach(Z=>{const ie=Z;if(ie.complete)ie.classList.add("loaded");else{const de=()=>{ie.classList.add("loaded"),ie.removeEventListener("load",de),ie.removeEventListener("error",se)},se=()=>{ie.classList.add("loaded"),ie.removeEventListener("load",de),ie.removeEventListener("error",se)};ie.addEventListener("load",de),ie.addEventListener("error",se)}}))},[a,m]),Ne.jsxs(hE,{open:a,onClose:l,maxWidth:"sm",fullWidth:!0,sx:{"& .MuiDialog-paper":{width:"100%",m:1,maxHeight:"calc(100dvh - 16px)"}},children:[Ne.jsx(fE,{sx:{p:2,pt:1,pb:1},children:Ne.jsxs(Rm,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[Ne.jsx(na,{variant:"h6",children:m?O(m).title:_("details")}),Ne.jsx(Hl,{edge:"end",color:"inherit",onClick:l,"aria-label":"close",children:Ne.jsx(Nm,{})})]})}),Ne.jsx(pE,{dividers:!0,ref:C,sx:{pl:2,pr:2},children:m?Ne.jsxs($s,{children:[m.imageUrl&&Ne.jsx($s,{component:"img",src:Ep(m.imageUrl),alt:O(m).title,className:`image-fade-in ${M.has(Ep(m.imageUrl))?"loaded":""}`,onLoad:()=>r(U=>new Set(U).add(Ep(m.imageUrl))),onError:()=>r(U=>new Set(U).add(Ep(m.imageUrl))),sx:{width:"100%",aspectRatio:"4/3",objectFit:"cover",borderRadius:"8px"}}),O(m).fullDescription?Ne.jsx($s,{className:"landmark-details-content",sx:{mb:2},dangerouslySetInnerHTML:{__html:V(m)}}):Ne.jsx(na,{children:_("noDetailsAvailable")})]}):Ne.jsx(na,{children:_("noDetailsAvailable")})}),Ne.jsxs(dE,{children:[Ne.jsx(nb,{onClick:l,autoFocus:!0,children:_("close")})," "]})]})},Yq=Object.assign({"../assets/img/pictures/1.jpg":kE,"../assets/img/pictures/10.jpg":ME,"../assets/img/pictures/11.jpg":RE,"../assets/img/pictures/12.jpg":zE,"../assets/img/pictures/13.jpg":LE,"../assets/img/pictures/14.jpg":DE,"../assets/img/pictures/15.jpg":OE,"../assets/img/pictures/16.jpg":BE,"../assets/img/pictures/17.jpg":FE,"../assets/img/pictures/18.jpg":jE,"../assets/img/pictures/19.jpg":NE,"../assets/img/pictures/2.jpg":VE,"../assets/img/pictures/20.jpg":qE,"../assets/img/pictures/21.jpg":HE,"../assets/img/pictures/22.jpg":UE,"../assets/img/pictures/23.jpg":$E,"../assets/img/pictures/24.jpg":GE,"../assets/img/pictures/25.jpg":WE,"../assets/img/pictures/26.jpg":ZE,"../assets/img/pictures/27.jpg":KE,"../assets/img/pictures/28.jpg":XE,"../assets/img/pictures/29.jpg":YE,"../assets/img/pictures/3.jpg":QE,"../assets/img/pictures/30.jpg":JE,"../assets/img/pictures/31.jpg":eA,"../assets/img/pictures/32.jpg":tA,"../assets/img/pictures/33.jpg":nA,"../assets/img/pictures/34.jpg":iA,"../assets/img/pictures/35.jpg":rA,"../assets/img/pictures/36.jpg":sA,"../assets/img/pictures/37.jpg":oA,"../assets/img/pictures/38.jpg":aA,"../assets/img/pictures/39.jpg":lA,"../assets/img/pictures/4.jpg":cA,"../assets/img/pictures/40.jpg":uA,"../assets/img/pictures/41.jpg":hA,"../assets/img/pictures/42.jpg":dA,"../assets/img/pictures/43.jpg":pA,"../assets/img/pictures/44.jpg":fA,"../assets/img/pictures/45.jpg":mA,"../assets/img/pictures/46.jpg":gA,"../assets/img/pictures/47.jpg":_A,"../assets/img/pictures/48.jpg":yA,"../assets/img/pictures/49.jpg":vA,"../assets/img/pictures/5.jpg":xA,"../assets/img/pictures/50.jpg":bA,"../assets/img/pictures/51.jpg":wA,"../assets/img/pictures/52.jpg":TA,"../assets/img/pictures/53.jpg":SA,"../assets/img/pictures/54.jpg":CA,"../assets/img/pictures/55.jpg":EA,"../assets/img/pictures/56.jpg":AA,"../assets/img/pictures/57.jpg":IA,"../assets/img/pictures/58.jpg":PA,"../assets/img/pictures/59.jpg":kA,"../assets/img/pictures/6.jpg":MA,"../assets/img/pictures/60.jpg":RA,"../assets/img/pictures/7.jpg":zA,"../assets/img/pictures/8.jpg":LA,"../assets/img/pictures/9.jpg":DA,"../assets/img/pictures/dragon.png":OA}),Ep=a=>Yq[`../assets/img/pictures/${a}`],OC={welcome:Ep("dragon.png"),error:Ep("dragon.png")};function Qq({selectedCategorySlugs:a,filteredLandmarks:l,activeIndex:m,setActiveIndex:_,setHasUserInteracted:w,hasInteractedWithMarkers:C,getLocalizedContent:M,onShowSnackbar:r}){const{t:O,i18n:V}=Gl(),U=ue.useRef(null),[Z,ie]=ue.useState(!1),[de,se]=ue.useState(null),[ne,Se]=ue.useState(!1),[me,Re]=ue.useState(!0);ue.useEffect(()=>{const Oe=[OC.welcome,...l.map(Ge=>Ep(Ge.imageUrl)).filter(Boolean)];let Ee=0;const qe=Oe.length;if(qe===0){Se(!0);return}const $e=()=>{Ee++,Ee===qe&&Se(!0)};Oe.forEach(Ge=>{if(Ge){const et=new Image;et.src=Ge,et.onload=$e,et.onerror=$e}else $e()})},[l]),ue.useEffect(()=>{if(ne){const Oe=setTimeout(()=>{Re(!1)},500);return()=>clearTimeout(Oe)}},[ne]),ue.useEffect(()=>{U.current&&m!==null&&U.current.activeIndex!==m&&U.current.slideTo(m)},[m]),ue.useEffect(()=>{if(!me&&V.isInitialized){const Oe=setTimeout(()=>{r(O("welcomeMessage"),"welcome")},100);return()=>clearTimeout(Oe)}},[me,V.isInitialized,V.language,r,O]);const ye=ue.useCallback(Oe=>{se(Oe),ie(!0)},[]),Le=ue.useCallback(()=>{ie(!1),se(null)},[]),De=ue.useCallback((Oe,Ee)=>{_(Oe);const qe=l[Oe];qe&&(ye(qe),w(!0))},[ye,l,_,w]);return Ne.jsxs($s,{component:"section",id:"hero",sx:{width:"100vw",minHeight:"100vh",overflow:"hidden",display:"flex",flexDirection:"column",flexWrap:"nowrap"},children:[Ne.jsx(xB,{maxWidth:!1,disableGutters:!0,sx:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:0,width:"100%",height:"100dvh",overflow:"hidden"},children:Ne.jsx(rC,{container:!0,sx:{flexGrow:1,width:"100%",display:"flex",flexDirection:"column",minHeight:0,height:"100dvh",overflow:"hidden"},children:Ne.jsx(rC,{item:!0,xs:12,sx:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:0,height:"100dvh",overflow:"hidden"},children:Ne.jsx(D6,{filteredLandmarks:l,activeIndex:m,hasInteractedWithMarkers:C,isContentLoaded:ne,snackbarImages:OC,getImageUrl:Ep,getLocalizedContent:M,onSlideChange:Oe=>{Oe.activeIndex!==m&&_(Oe.activeIndex),C||w(!0)},onSlideOrButtonDetailClick:De,swiperRef:U})})})}),Ne.jsx(Xq,{open:Z,onClose:Le,selectedLandmark:de}),Ne.jsx(t4,{isLoading:me})]})}const Jq=ue.memo(Qq);var Cy={exports:{}},eH=Cy.exports,BC;function tH(){return BC||(BC=1,function(a,l){(function(m,_){a.exports=_()})(eH,function(){var m,_,w;function C(r,O){if(!m)m=O;else if(!_)_=O;else{var V="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+m+")(sharedChunk); ("+_+")(sharedChunk); self.onerror = null;",U={};m(U),w=O(U),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(w.workerUrl=window.URL.createObjectURL(new Blob([V],{type:"text/javascript"})))}}C(["exports"],function(r){var O=1e-6,V=typeof Float32Array<"u"?Float32Array:Array;function U(i,e){var n=e[0],o=e[1],c=e[2],d=e[3],p=n*d-c*o;return p?(i[0]=d*(p=1/p),i[1]=-o*p,i[2]=-c*p,i[3]=n*p,i):null}function Z(){var i=new V(9);return V!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function ie(i,e){var n=e[0],o=e[1],c=e[2],d=e[3],p=e[4],x=e[5],T=e[6],S=e[7],P=e[8];return i[0]=p*P-x*S,i[1]=c*S-o*P,i[2]=o*x-c*p,i[3]=x*T-d*P,i[4]=n*P-c*T,i[5]=c*d-n*x,i[6]=d*S-p*T,i[7]=o*T-n*S,i[8]=n*p-o*d,i}function de(i,e,n){var o=e[0],c=e[1],d=e[2],p=e[3],x=e[4],T=e[5],S=e[6],P=e[7],k=e[8],R=n[0],B=n[1],j=n[2],$=n[3],K=n[4],ee=n[5],le=n[6],ce=n[7],W=n[8];return i[0]=R*o+B*p+j*S,i[1]=R*c+B*x+j*P,i[2]=R*d+B*T+j*k,i[3]=$*o+K*p+ee*S,i[4]=$*c+K*x+ee*P,i[5]=$*d+K*T+ee*k,i[6]=le*o+ce*p+W*S,i[7]=le*c+ce*x+W*P,i[8]=le*d+ce*T+W*k,i}function se(){var i=new V(16);return V!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i}function ne(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Se(i,e){var n=e[0],o=e[1],c=e[2],d=e[3],p=e[4],x=e[5],T=e[6],S=e[7],P=e[8],k=e[9],R=e[10],B=e[11],j=e[12],$=e[13],K=e[14],ee=e[15],le=n*x-o*p,ce=n*T-c*p,W=n*S-d*p,ae=o*T-c*x,he=o*S-d*x,ge=c*S-d*T,Be=P*$-k*j,ke=P*K-R*j,je=P*ee-B*j,Ze=k*K-R*$,ut=k*ee-B*$,Rt=R*ee-B*K,wt=le*Rt-ce*ut+W*Ze+ae*je-he*ke+ge*Be;return wt?(i[0]=(x*Rt-T*ut+S*Ze)*(wt=1/wt),i[1]=(c*ut-o*Rt-d*Ze)*wt,i[2]=($*ge-K*he+ee*ae)*wt,i[3]=(R*he-k*ge-B*ae)*wt,i[4]=(T*je-p*Rt-S*ke)*wt,i[5]=(n*Rt-c*je+d*ke)*wt,i[6]=(K*W-j*ge-ee*ce)*wt,i[7]=(P*ge-R*W+B*ce)*wt,i[8]=(p*ut-x*je+S*Be)*wt,i[9]=(o*je-n*ut-d*Be)*wt,i[10]=(j*he-$*W+ee*le)*wt,i[11]=(k*W-P*he-B*le)*wt,i[12]=(x*ke-p*Ze-T*Be)*wt,i[13]=(n*Ze-o*ke+c*Be)*wt,i[14]=($*ce-j*ae-K*le)*wt,i[15]=(P*ae-k*ce+R*le)*wt,i):null}function me(i,e,n){var o=e[0],c=e[1],d=e[2],p=e[3],x=e[4],T=e[5],S=e[6],P=e[7],k=e[8],R=e[9],B=e[10],j=e[11],$=e[12],K=e[13],ee=e[14],le=e[15],ce=n[0],W=n[1],ae=n[2],he=n[3];return i[0]=ce*o+W*x+ae*k+he*$,i[1]=ce*c+W*T+ae*R+he*K,i[2]=ce*d+W*S+ae*B+he*ee,i[3]=ce*p+W*P+ae*j+he*le,i[4]=(ce=n[4])*o+(W=n[5])*x+(ae=n[6])*k+(he=n[7])*$,i[5]=ce*c+W*T+ae*R+he*K,i[6]=ce*d+W*S+ae*B+he*ee,i[7]=ce*p+W*P+ae*j+he*le,i[8]=(ce=n[8])*o+(W=n[9])*x+(ae=n[10])*k+(he=n[11])*$,i[9]=ce*c+W*T+ae*R+he*K,i[10]=ce*d+W*S+ae*B+he*ee,i[11]=ce*p+W*P+ae*j+he*le,i[12]=(ce=n[12])*o+(W=n[13])*x+(ae=n[14])*k+(he=n[15])*$,i[13]=ce*c+W*T+ae*R+he*K,i[14]=ce*d+W*S+ae*B+he*ee,i[15]=ce*p+W*P+ae*j+he*le,i}function Re(i,e,n){var o,c,d,p,x,T,S,P,k,R,B,j,$=n[0],K=n[1],ee=n[2];return e===i?(i[12]=e[0]*$+e[4]*K+e[8]*ee+e[12],i[13]=e[1]*$+e[5]*K+e[9]*ee+e[13],i[14]=e[2]*$+e[6]*K+e[10]*ee+e[14],i[15]=e[3]*$+e[7]*K+e[11]*ee+e[15]):(c=e[1],d=e[2],p=e[3],x=e[4],T=e[5],S=e[6],P=e[7],k=e[8],R=e[9],B=e[10],j=e[11],i[0]=o=e[0],i[1]=c,i[2]=d,i[3]=p,i[4]=x,i[5]=T,i[6]=S,i[7]=P,i[8]=k,i[9]=R,i[10]=B,i[11]=j,i[12]=o*$+x*K+k*ee+e[12],i[13]=c*$+T*K+R*ee+e[13],i[14]=d*$+S*K+B*ee+e[14],i[15]=p*$+P*K+j*ee+e[15]),i}function ye(i,e,n){var o=n[0],c=n[1],d=n[2];return i[0]=e[0]*o,i[1]=e[1]*o,i[2]=e[2]*o,i[3]=e[3]*o,i[4]=e[4]*c,i[5]=e[5]*c,i[6]=e[6]*c,i[7]=e[7]*c,i[8]=e[8]*d,i[9]=e[9]*d,i[10]=e[10]*d,i[11]=e[11]*d,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Le(i,e,n){var o=Math.sin(n),c=Math.cos(n),d=e[4],p=e[5],x=e[6],T=e[7],S=e[8],P=e[9],k=e[10],R=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=d*c+S*o,i[5]=p*c+P*o,i[6]=x*c+k*o,i[7]=T*c+R*o,i[8]=S*c-d*o,i[9]=P*c-p*o,i[10]=k*c-x*o,i[11]=R*c-T*o,i}function De(i,e,n){var o=Math.sin(n),c=Math.cos(n),d=e[0],p=e[1],x=e[2],T=e[3],S=e[8],P=e[9],k=e[10],R=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=d*c-S*o,i[1]=p*c-P*o,i[2]=x*c-k*o,i[3]=T*c-R*o,i[8]=d*o+S*c,i[9]=p*o+P*c,i[10]=x*o+k*c,i[11]=T*o+R*c,i}function Oe(i,e,n){var o=Math.sin(n),c=Math.cos(n),d=e[0],p=e[1],x=e[2],T=e[3],S=e[4],P=e[5],k=e[6],R=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=d*c+S*o,i[1]=p*c+P*o,i[2]=x*c+k*o,i[3]=T*c+R*o,i[4]=S*c-d*o,i[5]=P*c-p*o,i[6]=k*c-x*o,i[7]=R*c-T*o,i}function Ee(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function qe(i,e,n){var o,c,d,p=n[0],x=n[1],T=n[2],S=Math.hypot(p,x,T);return S<O?null:(p*=S=1/S,x*=S,T*=S,o=Math.sin(e),c=Math.cos(e),i[0]=p*p*(d=1-c)+c,i[1]=x*p*d+T*o,i[2]=T*p*d-x*o,i[3]=0,i[4]=p*x*d-T*o,i[5]=x*x*d+c,i[6]=T*x*d+p*o,i[7]=0,i[8]=p*T*d+x*o,i[9]=x*T*d-p*o,i[10]=T*T*d+c,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}function $e(i,e){var n=e[0],o=e[1],c=e[2],d=e[3],p=n+n,x=o+o,T=c+c,S=n*p,P=o*p,k=o*x,R=c*p,B=c*x,j=c*T,$=d*p,K=d*x,ee=d*T;return i[0]=1-k-j,i[1]=P+ee,i[2]=R-K,i[3]=0,i[4]=P-ee,i[5]=1-S-j,i[6]=B+$,i[7]=0,i[8]=R+K,i[9]=B-$,i[10]=1-S-k,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var Ge=me;function et(){var i=new V(3);return V!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function mt(i){var e=new V(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function St(i){return Math.hypot(i[0],i[1],i[2])}function xt(i,e,n){var o=new V(3);return o[0]=i,o[1]=e,o[2]=n,o}function At(i,e,n){return i[0]=e[0]+n[0],i[1]=e[1]+n[1],i[2]=e[2]+n[2],i}function Ct(i,e,n){return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],i}function Ut(i,e,n){return i[0]=e[0]*n[0],i[1]=e[1]*n[1],i[2]=e[2]*n[2],i}function at(i,e,n){return i[0]=Math.min(e[0],n[0]),i[1]=Math.min(e[1],n[1]),i[2]=Math.min(e[2],n[2]),i}function kt(i,e,n){return i[0]=Math.max(e[0],n[0]),i[1]=Math.max(e[1],n[1]),i[2]=Math.max(e[2],n[2]),i}function qt(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i}function lt(i,e,n,o){return i[0]=e[0]+n[0]*o,i[1]=e[1]+n[1]*o,i[2]=e[2]+n[2]*o,i}function Ht(i,e){var n=e[0]-i[0],o=e[1]-i[1],c=e[2]-i[2];return n*n+o*o+c*c}function Nn(i){var e=i[0],n=i[1],o=i[2];return e*e+n*n+o*o}function zn(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i}function xn(i,e){var n=e[0],o=e[1],c=e[2],d=n*n+o*o+c*c;return d>0&&(d=1/Math.sqrt(d)),i[0]=e[0]*d,i[1]=e[1]*d,i[2]=e[2]*d,i}function An(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function ti(i,e,n){var o=e[0],c=e[1],d=e[2],p=n[0],x=n[1],T=n[2];return i[0]=c*T-d*x,i[1]=d*p-o*T,i[2]=o*x-c*p,i}function Hn(i,e,n,o){var c=e[0],d=e[1],p=e[2];return i[0]=c+o*(n[0]-c),i[1]=d+o*(n[1]-d),i[2]=p+o*(n[2]-p),i}function bn(i,e,n){var o=e[0],c=e[1],d=e[2],p=n[3]*o+n[7]*c+n[11]*d+n[15];return i[0]=(n[0]*o+n[4]*c+n[8]*d+n[12])/(p=p||1),i[1]=(n[1]*o+n[5]*c+n[9]*d+n[13])/p,i[2]=(n[2]*o+n[6]*c+n[10]*d+n[14])/p,i}function Zi(i,e,n){var o=e[0],c=e[1],d=e[2];return i[0]=o*n[0]+c*n[3]+d*n[6],i[1]=o*n[1]+c*n[4]+d*n[7],i[2]=o*n[2]+c*n[5]+d*n[8],i}function Ci(i,e,n){var o=n[0],c=n[1],d=n[2],p=e[0],x=e[1],T=e[2],S=c*T-d*x,P=d*p-o*T,k=o*x-c*p,R=c*k-d*P,B=d*S-o*k,j=o*P-c*S,$=2*n[3];return P*=$,k*=$,B*=2,j*=2,i[0]=p+(S*=$)+(R*=2),i[1]=x+P+B,i[2]=T+k+j,i}function Yi(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}var Vn=Ct,ki=Ut,zi=St;function Pr(){var i=new V(4);return V!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function Gr(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i}function ys(i,e){var n=e[0],o=e[1],c=e[2],d=e[3],p=n*n+o*o+c*c+d*d;return p>0&&(p=1/Math.sqrt(p)),i[0]=n*p,i[1]=o*p,i[2]=c*p,i[3]=d*p,i}function zr(i,e,n){var o=e[0],c=e[1],d=e[2],p=e[3];return i[0]=n[0]*o+n[4]*c+n[8]*d+n[12]*p,i[1]=n[1]*o+n[5]*c+n[9]*d+n[13]*p,i[2]=n[2]*o+n[6]*c+n[10]*d+n[14]*p,i[3]=n[3]*o+n[7]*c+n[11]*d+n[15]*p,i}function Or(){var i=new V(4);return V!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function sr(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function Ss(i,e,n){n*=.5;var o=e[0],c=e[1],d=e[2],p=e[3],x=Math.sin(n),T=Math.cos(n);return i[0]=o*T+p*x,i[1]=c*T+d*x,i[2]=d*T-c*x,i[3]=p*T-o*x,i}function as(i,e,n){n*=.5;var o=e[0],c=e[1],d=e[2],p=e[3],x=Math.sin(n),T=Math.cos(n);return i[0]=o*T-d*x,i[1]=c*T+p*x,i[2]=d*T+o*x,i[3]=p*T-c*x,i}et(),Pr();var Hi,Gs,ho,Jr,xr,ci=ys,Cs=(Hi=et(),Gs=xt(1,0,0),ho=xt(0,1,0),function(i,e,n){var o=An(e,n);return o<-.999999?(ti(Hi,Gs,e),zi(Hi)<1e-6&&ti(Hi,ho,e),xn(Hi,Hi),function(c,d,p){p*=.5;var x=Math.sin(p);c[0]=x*d[0],c[1]=x*d[1],c[2]=x*d[2],c[3]=Math.cos(p)}(i,Hi,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(ti(Hi,e,n),i[0]=Hi[0],i[1]=Hi[1],i[2]=Hi[2],i[3]=1+o,ci(i,i))});function Wr(){var i=new V(2);return V!=Float32Array&&(i[0]=0,i[1]=0),i}function Ws(i,e){var n=new V(2);return n[0]=i,n[1]=e,n}function hi(i,e,n){return i[0]=e[0]+n[0],i[1]=e[1]+n[1],i}function br(i,e,n){return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i}function is(i,e,n){return i[0]=e[0]*n,i[1]=e[1]*n,i}function ro(i){return Math.hypot(i[0],i[1])}function Ca(i,e){var n=e[0],o=e[1],c=n*n+o*o;return c>0&&(c=1/Math.sqrt(c)),i[0]=e[0]*c,i[1]=e[1]*c,i}function or(i,e){return i[0]*e[0]+i[1]*e[1]}function qa(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}Or(),Or(),Z(),Wr();var Wl,Ls,Zl=function(){if(xr)return Jr;function i(e,n,o,c){this.cx=3*e,this.bx=3*(o-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(c-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=o,this.p2y=c}return xr=1,Jr=i,i.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var o=e,c=0;c<8;c++){var d=this.sampleCurveX(o)-e;if(Math.abs(d)<n)return o;var p=this.sampleCurveDerivativeX(o);if(Math.abs(p)<1e-6)break;o-=d/p}var x=0,T=1;for(o=e,c=0;c<20&&(d=this.sampleCurveX(o),!(Math.abs(d-e)<n));c++)e>d?x=o:T=o,o=.5*(T-x)+x;return o},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},Jr}(),Sh=qa(Zl);function Kl(){if(Ls)return Wl;function i(e,n){this.x=e,this.y=n}return Ls=1,Wl=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,n){return this.clone()._rotateAround(e,n)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var n=e.x-this.x,o=e.y-this.y;return n*n+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,n){return Math.atan2(this.x*n-this.y*e,this.x*e+this.y*n)},_matMult:function(e){var n=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=n,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var n=Math.cos(e),o=Math.sin(e),c=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=c,this},_rotateAround:function(e,n){var o=Math.cos(e),c=Math.sin(e),d=n.y+c*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-c*(this.y-n.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(e){return e instanceof i?e:Array.isArray(e)?new i(e[0],e[1]):e},Wl}var Wt=qa(Kl());function Ha(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let n=0;n<i.length;n++)if(!Ha(i[n],e[n]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(const n in i)if(!Ha(i[n],e[n]))return!1;return!0}return i===e}const Td=Math.PI/180,Rc=180/Math.PI;function Ei(i){return i*Td}function it(i){return i*Rc}const te=[[0,0],[1,0],[1,1],[0,1]];function oe(i){if(i<=0)return 0;if(i>=1)return 1;const e=i*i,n=e*i;return 4*(i<.5?n:3*(i-e)+n-.75)}function xe(i,e,n,o){const c=new Sh(i,e,n,o);return function(d){return c.solve(d)}}const ze=xe(.25,.1,.25,1);function Ce(i,e,n){return Math.min(n,Math.max(e,i))}function He(i,e,n){return(n=Ce((n-i)/(e-i),0,1))*n*(3-2*n)}function Je(i,e,n){const o=n-e,c=((i-e)%o+o)%o+e;return c===e?n:c}function Ue(i,e,n){if(!i.length)return n(null,[]);let o=i.length;const c=new Array(i.length);let d=null;i.forEach((p,x)=>{e(p,(T,S)=>{T&&(d=T),c[x]=S,--o==0&&n(d,c)})})}function tt(i,...e){for(const n of e)for(const o in n)i[o]=n[o];return i}let bt=1;function rt(){return bt++}function Gt(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function an(i,e){i.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function hn(i,e,n){const o={};for(const c in i)o[c]=e.call(this,i[c],c,i);return o}function Rn(i,e,n){const o={};for(const c in i)e.call(this,i[c],c,i)&&(o[c]=i[c]);return o}function Ln(i){return Array.isArray(i)?i.map(Ln):typeof i=="object"&&i?hn(i,Ln):i}function On(i,e){for(let n=0;n<i.length;n++)if(e.indexOf(i[n])>=0)return!0;return!1}const ni={};function Un(i){ni[i]||(typeof console<"u"&&console.warn(i),ni[i]=!0)}function Ki(i,e,n){return(n.y-i.y)*(e.x-i.x)>(e.y-i.y)*(n.x-i.x)}function fi(i){let e=0;for(let n,o,c=0,d=i.length,p=d-1;c<d;p=c++)n=i[c],o=i[p],e+=(o.x-n.x)*(n.y+o.y);return e}function pr([i,e,n]){const o=Ei(e+90),c=Ei(n);return{x:i*Math.cos(o)*Math.sin(c),y:i*Math.sin(o)*Math.sin(c),z:i*Math.cos(c),azimuthal:e,polar:n}}function Li(i){return(typeof self<"u"||i!==void 0)&&typeof WorkerGlobalScope<"u"&&(i!==void 0?i:self)instanceof WorkerGlobalScope}function Ii(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,o,c,d)=>{const p=c||d;return e[o]=!p||p.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let kr=null;function Lr(i,e){return[i[4*e],i[4*e+1],i[4*e+2],i[4*e+3]]}function Sr(i,e,n,o){for(;e<n;){const c=e+n>>1;i[c]<o?e=c+1:n=c}return e}function ds(i,e,n,o){for(;e<n;){const c=e+n>>1;i[c]<=o?e=c+1:n=c}return e}function ls(i){return i>0?1/(1.001-i):1+i}function so(i){return i>0?1-1/(1.001-i):-i}function Ao(i,e,n){return(i-e.min)*(n.max-n.min)/(e.max-e.min)+n.min}const Ds={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ds.API_URL)return null;try{const i=new URL(Ds.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v0.3.0.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Xl(i){return Ds.API_URL_REGEX.test(i)}function Sd(i){return Ds.API_SPRITE_REGEX.test(i)}let Yl,Ql,Jl,zc,Lc,Ch;function Cu(){return Yl==null&&(Yl=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Yl}const fa={now:()=>zc!==void 0?zc:performance.now(),setNow(i){zc=i},restoreNow(){zc=void 0},frame(i){const e=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(i,e=0){const{width:n,height:o}=i;Lc||(Lc=document.createElement("canvas"));const c=Lc.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return(n>Lc.width||o>Lc.height)&&(Lc.width=n,Lc.height=o),c.clearRect(-e,-e,n+2*e,o+2*e),c.drawImage(i,0,0,n,o),c.getImageData(-e,-e,n+2*e,o+2*e)},resolveURL:i=>(Ql||(Ql=document.createElement("a")),Ql.href=i,Ql.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Jl==null&&(Jl=window.matchMedia("(prefers-reduced-motion: reduce)")),Jl.matches)},hasCanvasFingerprintNoise(){if(Ch!==void 0)return Ch;if(!Cu())return Ch=!1,!1;const i=new OffscreenCanvas(85,1),e=i.getContext("2d",{willReadFrequently:!0});let n=0;for(let c=0;c<i.width;++c)e.fillStyle=`rgba(${n++},${n++},${n++}, 255)`,e.fillRect(c,0,1,1);const o=e.getImageData(0,0,i.width,i.height);n=0;for(let c=0;c<o.data.length;++c)if(c%4!=3&&n++!==o.data[c])return Ch=!0,!0;return Ch=!1,!1}};function Io(i,e){const n=i.indexOf("?");if(n<0)return`${i}?${new URLSearchParams(e).toString()}`;const o=new URLSearchParams(i.slice(n));for(const c in e)o.set(c,e[c]);return`${i.slice(0,n)}?${o.toString()}`}function po(i,e={persistentParams:[]}){const n=i.indexOf("?");if(n<0)return i;const o=new URLSearchParams,c=new URLSearchParams(i.slice(n));for(const p of e.persistentParams){const x=c.get(p);x&&o.set(p,x)}const d=o.toString();return`${i.slice(0,n)}${d.length>0?`?${d}`:""}`}const _l="mapbox-tiles";let ia=500,ar=50;const Eu=["language","worldview","jobid"];let Ea,Dc;function ec(){try{return caches}catch{}}function Oc(){const i=ec();i&&Ea==null&&(Ea=i.open(_l))}let Cd=1/0;const Eh={supported:!1,testSupport:function(i){!ma&&No&&(ra?Iu(i):Zs=i)}};let Zs,No,ma=!1,ra=!1;const Au=typeof self<"u"?self:{};function Iu(i){const e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,No),i.isContextLost())return;Eh.supported=!0}catch{}i.deleteTexture(e),ma=!0}Au.document&&(No=Au.document.createElement("img"),No.onload=function(){Zs&&Iu(Zs),Zs=null,ra=!0},No.onerror=function(){ma=!0,Zs=null},No.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ga={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(ga);class wi extends Error{constructor(e,n,o){n===401&&Xl(o)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=o}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ah=Li()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Ua=function(i,e){if(!(/^file:/.test(n=i.url)||/^file:/.test(Ah())&&!/^\w+:/.test(n))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(o,c){const d=new AbortController,p=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:Ah(),referrerPolicy:o.referrerPolicy,signal:d.signal});let x=!1,T=!1;const S=(P=p.url).indexOf("sku=")>0&&Xl(P);var P;o.type==="json"&&p.headers.set("Accept","application/json");const k=(B,j,$)=>{if(T)return;if(B&&B.message!=="SecurityError"&&Un(B.toString()),j&&$)return R(j);const K=Date.now();fetch(p).then(ee=>{if(ee.ok){const le=S?ee.clone():null;return R(ee,le,K)}return c(new wi(ee.statusText,ee.status,o.url))}).catch(ee=>{ee.name!=="AbortError"&&c(new Error(`${ee.message} ${o.url}`))})},R=(B,j,$)=>{(o.type==="arrayBuffer"?B.arrayBuffer():o.type==="json"?B.json():B.text()).then(K=>{T||(j&&$&&function(ee,le,ce){if(Oc(),Ea==null)return;const W=Ii(le.headers.get("Cache-Control")||"");if(W["no-store"])return;const ae={status:le.status,statusText:le.statusText,headers:new Headers};le.headers.forEach((Be,ke)=>ae.headers.set(ke,Be)),W["max-age"]&&ae.headers.set("Expires",new Date(ce+1e3*W["max-age"]).toUTCString());const he=ae.headers.get("Expires");if(!he||new Date(he).getTime()-ce<42e4)return;let ge=po(ee.url,{persistentParams:Eu});if(le.status===206){const Be=ee.headers.get("Range");if(!Be)return;ae.status=200,ge=Io(ge,{range:Be})}(function(Be,ke){if(Dc===void 0)try{new Response(new ReadableStream),Dc=!0}catch{Dc=!1}Dc?ke(Be.body):Be.blob().then(ke).catch(je=>Un(je.message))})(le,Be=>{const ke=new Response((je=le.status)!==200&&je!==404&&[101,103,204,205,304].includes(je)?null:Be,ae);var je;Oc(),Ea!=null&&Ea.then(Ze=>Ze.put(ge,ke)).catch(Ze=>Un(Ze.message))})}(p,j,$),x=!0,c(null,K,B.headers.get("Cache-Control"),B.headers.get("Expires")))}).catch(K=>{T||c(new Error(K.message))})};return S?function(B,j){if(Oc(),Ea==null)return j(null);Ea.then($=>{let K=po(B.url,{persistentParams:Eu});const ee=B.headers.get("Range");ee&&(K=Io(K,{range:ee})),$.match(K).then(le=>{const ce=function(W){if(!W)return!1;const ae=new Date(W.headers.get("Expires")||0),he=Ii(W.headers.get("Cache-Control")||"");return Number(ae)>Date.now()&&!he["no-cache"]}(le);$.delete(K).catch(j),ce&&$.put(K,le.clone()).catch(j),j(null,le,ce)}).catch(j)}).catch(j)}(p,k):k(null,null),{cancel:()=>{T=!0,x||d.abort()}}}(i,e);if(Li(self)&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var n;return function(o,c){const d=new XMLHttpRequest;d.open(o.method||"GET",o.url,!0),o.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const p in o.headers)d.setRequestHeader(p,o.headers[p]);return o.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=o.credentials==="include",d.onerror=()=>{c(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let p=d.response;if(o.type==="json")try{p=JSON.parse(d.response)}catch(x){return c(x)}c(null,p,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else c(new wi(d.statusText,d.status,o.url))},d.send(o.body),{cancel:()=>d.abort()}}(i,e)},Ih=function(i,e){return Ua(tt(i,{type:"arrayBuffer"}),e)};function Rf(i){const e=document.createElement("a");return e.href=i,e.protocol===location.protocol&&e.host===location.host}const tc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let nc,ic;nc=[],ic=0;const Bc=function(i,e){if(Eh.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),ic>=Ds.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:i,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return nc.push(d),d}ic++;let n=!1;const o=()=>{if(!n)for(n=!0,ic--;nc.length&&ic<Ds.MAX_PARALLEL_IMAGE_REQUESTS;){const d=nc.shift(),{requestParameters:p,callback:x,cancelled:T}=d;T||(d.cancel=Bc(p,x).cancel)}},c=Ih(i,(d,p,x,T)=>{o(),d?e(d):p&&(self.createImageBitmap?function(S,P){const k=new Blob([new Uint8Array(S)],{type:"image/png"});createImageBitmap(k).then(R=>{P(null,R)}).catch(R=>{P(new Error(`Could not load image because of ${R.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(p,(S,P)=>e(S,P,x,T)):function(S,P){const k=new Image;k.onload=()=>{P(null,k),URL.revokeObjectURL(k.src),k.onload=null,requestAnimationFrame(()=>{k.src=tc})},k.onerror=()=>P(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const R=new Blob([new Uint8Array(S)],{type:"image/png"});k.src=S.byteLength?URL.createObjectURL(R):tc}(p,(S,P)=>e(S,P,x,T)))});return{cancel:()=>{c.cancel(),o()}}};var Fc,_a,Ph,yl={exports:{}},Ed={exports:{}},Pu={exports:{}},Vo=function(){if(Ph)return yl.exports;Ph=1;var i=(Fc||(Fc=1,Ed.exports=function(n,o){var c,d,p,x,T,S,P,k;for(d=n.length-(c=3&n.length),p=o,T=3432918353,S=461845907,k=0;k<d;)P=255&n.charCodeAt(k)|(255&n.charCodeAt(++k))<<8|(255&n.charCodeAt(++k))<<16|(255&n.charCodeAt(++k))<<24,++k,p=27492+(65535&(x=5*(65535&(p=(p^=P=(65535&(P=(P=(65535&P)*T+(((P>>>16)*T&65535)<<16)&4294967295)<<15|P>>>17))*S+(((P>>>16)*S&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(P=0,c){case 3:P^=(255&n.charCodeAt(k+2))<<16;case 2:P^=(255&n.charCodeAt(k+1))<<8;case 1:p^=P=(65535&(P=(P=(65535&(P^=255&n.charCodeAt(k)))*T+(((P>>>16)*T&65535)<<16)&4294967295)<<15|P>>>17))*S+(((P>>>16)*S&65535)<<16)&4294967295}return p^=n.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}),Ed.exports),e=(_a||(_a=1,Pu.exports=function(n,o){for(var c,d=n.length,p=o^d,x=0;d>=4;)c=1540483477*(65535&(c=255&n.charCodeAt(x)|(255&n.charCodeAt(++x))<<8|(255&n.charCodeAt(++x))<<16|(255&n.charCodeAt(++x))<<24))+((1540483477*(c>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++x;switch(d){case 3:p^=(255&n.charCodeAt(x+2))<<16;case 2:p^=(255&n.charCodeAt(x+1))<<8;case 1:p=1540483477*(65535&(p^=255&n.charCodeAt(x)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}),Pu.exports);return yl.exports=i,yl.exports.murmur3=i,yl.exports.murmur2=e,yl.exports}(),jc=qa(Vo);class rc{constructor(e,...n){tt(this,n[0]||{}),this.type=e}}class Aa extends rc{constructor(e,n={}){super("error",tt({error:e},n))}}function kh(i,e,n){n[i]&&n[i].indexOf(e)!==-1||(n[i]=n[i]||[],n[i].push(e))}function Nc(i,e,n){if(n&&n[i]){const o=n[i].indexOf(e);o!==-1&&n[i].splice(o,1)}}class sc{on(e,n){return this._listeners=this._listeners||{},kh(e,n,this._listeners),this}off(e,n){return Nc(e,n,this._listeners),Nc(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},kh(e,n,this._oneTimeListeners),this):new Promise(o=>{this.once(e,o)})}fire(e,n){const o=typeof e=="string"?new rc(e,n):e,c=o.type;if(this.listens(c)){o.target=this;const d=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const T of d)T.call(this,o);const p=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const T of p)Nc(c,T,this._oneTimeListeners),T.call(this,o);const x=this._eventedParent;x&&(tt(o,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(o))}else o instanceof Aa&&console.error(o.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}class oo{constructor(e){typeof e=="string"?this.name=e:(this.name=e.name,this.iconsetId=e.iconsetId)}static from(e){return new oo(e)}static toString(e){return e.iconsetId?`${e.name}${e.iconsetId}`:e.name}static parse(e){const[n,o]=e.split("");return new oo({name:n,iconsetId:o})}static isEqual(e,n){return e.name===n.name&&e.iconsetId===n.iconsetId}toString(){return oo.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var ku,Vc={},Os=function(){if(ku)return Vc;ku=1;var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function e(d){return(d=Math.round(d))<0?0:d>255?255:d}function n(d){return e(d[d.length-1]==="%"?parseFloat(d)/100*255:parseInt(d))}function o(d){return(p=d[d.length-1]==="%"?parseFloat(d)/100:parseFloat(d))<0?0:p>1?1:p;var p}function c(d,p,x){return x<0?x+=1:x>1&&(x-=1),6*x<1?d+(p-d)*x*6:2*x<1?p:3*x<2?d+(p-d)*(2/3-x)*6:d}try{Vc.parseCSSColor=function(d){var p,x=d.replace(/ /g,"").toLowerCase();if(x in i)return i[x].slice();if(x[0]==="#")return x.length===4?(p=parseInt(x.substr(1),16))>=0&&p<=4095?[(3840&p)>>4|(3840&p)>>8,240&p|(240&p)>>4,15&p|(15&p)<<4,1]:null:x.length===7&&(p=parseInt(x.substr(1),16))>=0&&p<=16777215?[(16711680&p)>>16,(65280&p)>>8,255&p,1]:null;var T=x.indexOf("("),S=x.indexOf(")");if(T!==-1&&S+1===x.length){var P=x.substr(0,T),k=x.substr(T+1,S-(T+1)).split(","),R=1;switch(P){case"rgba":if(k.length!==4)return null;R=o(k.pop());case"rgb":return k.length!==3?null:[n(k[0]),n(k[1]),n(k[2]),R];case"hsla":if(k.length!==4)return null;R=o(k.pop());case"hsl":if(k.length!==3)return null;var B=(parseFloat(k[0])%360+360)%360/360,j=o(k[1]),$=o(k[2]),K=$<=.5?$*(j+1):$+j-$*j,ee=2*$-K;return[e(255*c(ee,K,B+1/3)),e(255*c(ee,K,B)),e(255*c(ee,K,B-1/3)),R];default:return null}}return null}}catch{}return Vc}();class Ti{constructor(e,n,o,c=1){this.r=e,this.g=n,this.b=o,this.a=c}static parse(e){if(!e)return;if(e instanceof Ti)return e;if(typeof e!="string")return;const n=Os.parseCSSColor(e);return n?new Ti(n[0]/255,n[1]/255,n[2]/255,n[3]):void 0}toString(){const[e,n,o,c]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*e)},${Math.round(255*n)},${Math.round(255*o)},${c})`}toNonPremultipliedRenderColor(e){const{r:n,g:o,b:c,a:d}=this;return new Mh(e,n,o,c,d)}toPremultipliedRenderColor(e){const{r:n,g:o,b:c,a:d}=this;return new Pp(e,n*d,o*d,c*d,d)}clone(){return new Ti(this.r,this.g,this.b,this.a)}}class sa{constructor(e,n,o,c,d,p=!1){if(this.premultiplied=!1,this.premultiplied=p,e){const x=e.image.height,T=x*x;this.premultiplied?(n=d===0?0:n/d*(x-1),o=d===0?0:o/d*(x-1),c=d===0?0:c/d*(x-1)):(n*=x-1,o*=x-1,c*=x-1);const S=Math.floor(n),P=Math.floor(o),k=Math.floor(c),R=Math.ceil(n),B=Math.ceil(o),j=Math.ceil(c),$=n-S,K=o-P,ee=c-k,le=e.image.data,ce=4*(S+P*T+k*x),W=4*(S+P*T+j*x),ae=4*(S+B*T+k*x),he=4*(S+B*T+j*x),ge=4*(R+P*T+k*x),Be=4*(R+P*T+j*x),ke=4*(R+B*T+k*x),je=4*(R+B*T+j*x);if(ce<0||je>=le.length)throw new Error("out of range");this.r=Cn(Cn(Cn(le[ce],le[W],ee),Cn(le[ae],le[he],ee),K),Cn(Cn(le[ge],le[Be],ee),Cn(le[ke],le[je],ee),K),$)/255*(this.premultiplied?d:1),this.g=Cn(Cn(Cn(le[ce+1],le[W+1],ee),Cn(le[ae+1],le[he+1],ee),K),Cn(Cn(le[ge+1],le[Be+1],ee),Cn(le[ke+1],le[je+1],ee),K),$)/255*(this.premultiplied?d:1),this.b=Cn(Cn(Cn(le[ce+2],le[W+2],ee),Cn(le[ae+2],le[he+2],ee),K),Cn(Cn(le[ge+2],le[Be+2],ee),Cn(le[ke+2],le[je+2],ee),K),$)/255*(this.premultiplied?d:1),this.a=d}else this.r=n,this.g=o,this.b=c,this.a=d}toArray(){const{r:e,g:n,b:o,a:c}=this;return[255*e,255*n,255*o,c]}toHslaArray(){let{r:e,g:n,b:o,a:c}=this;if(this.premultiplied){if(c===0)return[0,0,0,0];e/=c,n/=c,o/=c}const d=Math.min(Math.max(e,0),1),p=Math.min(Math.max(n,0),1),x=Math.min(Math.max(o,0),1),T=Math.min(d,p,x),S=Math.max(d,p,x),P=(T+S)/2;if(T===S)return[0,0,100*P,c];const k=S-T,R=P>.5?k/(2-S-T):k/(S+T);let B=0;return S===d?B=(p-x)/k+(p<x?6:0):S===p?B=(x-d)/k+2:S===x&&(B=(d-p)/k+4),B*=60,[Math.min(Math.max(B,0),360),Math.min(Math.max(100*R,0),100),Math.min(Math.max(100*P,0),100),c]}toArray01(){const{r:e,g:n,b:o,a:c}=this;return[e,n,o,c]}toArray01Scaled(e){const{r:n,g:o,b:c}=this;return[n*e,o*e,c*e]}toArray01Linear(){const{r:e,g:n,b:o,a:c}=this;return[Math.pow(e,2.2),Math.pow(n,2.2),Math.pow(o,2.2),c]}}class Mh extends sa{constructor(e,n,o,c,d){super(e,n,o,c,d,!1)}}class Pp extends sa{constructor(e,n,o,c,d){super(e,n,o,c,d,!0)}}function Cn(i,e,n){return i*(1-n)+e*n}function Mu(i,e,n){return i.map((o,c)=>Cn(o,e[c],n))}Ti.black=new Ti(0,0,0,1),Ti.white=new Ti(1,1,1,1),Ti.transparent=new Ti(0,0,0,0),Ti.red=new Ti(1,0,0,1),Ti.blue=new Ti(0,0,1,1);var vl=Object.freeze({__proto__:null,array:Mu,color:function(i,e,n){return new Ti(Cn(i.r,e.r,n),Cn(i.g,e.g,n),Cn(i.b,e.b,n),Cn(i.a,e.a,n))},number:Cn});function $a(i,...e){for(const n of e)for(const o in n)i[o]=n[o];return i}class qo extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class kp{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[o,c]of n)this.bindings[o]=c}concat(e){return new kp(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Ru={kind:"null"},pn={kind:"number"},Bi={kind:"string"},Di={kind:"boolean"},Ho={kind:"color"},xl={kind:"object"},Fi={kind:"value"},Ad={kind:"collator"},zu={kind:"formatted"},Rh={kind:"resolvedImage"};function fo(i,e){return{kind:"array",itemType:i,N:e}}function cs(i){if(i.kind==="array"){const e=cs(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const Vm=[Ru,pn,Bi,Di,Ho,zu,xl,fo(Fi),Rh];function oc(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!oc(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const n of Vm)if(!oc(n,e))return null}}return`Expected ${cs(i)} but found ${cs(e)} instead.`}function ac(i,e){return e.some(n=>n.kind===i.kind)}function zh(i,e){return e.some(n=>n==="null"?i===null:n==="array"?Array.isArray(i):n==="object"?i&&!Array.isArray(i)&&typeof i=="object":n===typeof i)}function Id(i,e){return i.kind==="array"&&e.kind==="array"?i.N===e.N&&Id(i.itemType,e.itemType):i.kind===e.kind}class Lu{constructor(e,n,o){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Pd{constructor(e,n,o,c,d){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=o,this.fontStack=c,this.textColor=d}}class mo{constructor(e){this.sections=e}static fromString(e){return new mo([new Pd(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||!!e.image&&e.image.hasPrimary())}static factory(e){return e instanceof mo?e:mo.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){const c=n.image.getPrimary().id.toString();e.push(["image",c]);continue}e.push(n.text);const o={};n.fontStack&&(o["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(o["font-scale"]=n.scale),n.textColor&&(o["text-color"]=["rgba"].concat(n.textColor.toNonPremultipliedRenderColor(null).toArray())),e.push(o)}return e}}class bl{constructor(e,n={}){if(this.id=oo.from(e),this.options=Object.assign({},n),n.transform){const{a:o,b:c,c:d,d:p,e:x,f:T}=n.transform;this.options.transform=new DOMMatrix([o,c,d,p,x,T])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:e,b:n,c:o,d:c,e:d,f:p}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:e,b:n,c:o,d:c,e:d,f:p}})}static parse(e){let n,o,c,d;try{({name:n,iconsetId:o,params:c,transform:d}=JSON.parse(e)||{})}catch{return null}if(!n)return null;const{a:p,b:x,c:T,d:S,e:P,f:k}=d||{};return new bl({name:n,iconsetId:o},{params:c,transform:new DOMMatrix([p,x,T,S,P,k])})}scaleSelf(e,n){return this.options.transform.scaleSelf(e,n),this}}class Po{constructor(e,n,o,c,d=!1){this.primaryId=oo.from(e),this.primaryOptions=n,o&&(this.secondaryId=oo.from(o)),this.secondaryOptions=c,this.available=d}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new bl(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new bl(this.secondaryId,this.secondaryOptions):null}static from(e){return typeof e=="string"?Po.build({name:e}):e}static build(e,n,o,c){return!e||typeof e=="object"&&!("name"in e)?null:new Po(e,o,n,c)}}function qc(i,e,n,o){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[i,e,n,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[i,e,n,o]:[i,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ii(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Ti||i instanceof Lu||i instanceof mo||i instanceof Po)return!0;if(Array.isArray(i)){for(const e of i)if(!ii(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!ii(i[e]))return!1;return!0}return!1}function sn(i){if(i===null)return Ru;if(typeof i=="string")return Bi;if(typeof i=="boolean")return Di;if(typeof i=="number")return pn;if(i instanceof Ti)return Ho;if(i instanceof Lu)return Ad;if(i instanceof mo)return zu;if(i instanceof Po)return Rh;if(Array.isArray(i)){const e=i.length;let n;for(const o of i){const c=sn(o);if(n){if(n===c)continue;n=Fi;break}n=c}return fo(n||Fi,e)}return xl}function Uo(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof mo||i instanceof Po||i instanceof Ti?i.toString():JSON.stringify(i)}class In{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ii(e[1]))return n.error("invalid value");const o=e[1];let c=sn(o);const d=n.expectedType;return c.kind!=="array"||c.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(c=d),new In(c,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ti?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof mo?this.value.serialize():this.value}}class rs{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Du={string:Bi,number:pn,boolean:Di,object:xl};class Sn{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let o,c=1;const d=e[0];if(d==="array"){let x,T;if(e.length>2){const S=e[1];if(typeof S!="string"||!(S in Du)||S==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);x=Du[S],c++}else x=Fi;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);T=e[2],c++}o=fo(x,T)}else o=Du[d];const p=[];for(;c<e.length;c++){const x=n.parse(e[c],c,Fi);if(!x)return null;p.push(x)}return new Sn(o,p)}evaluate(e){for(let n=0;n<this.args.length;n++){const o=this.args[n].evaluate(e);if(!oc(this.type,sn(o)))return o;if(n===this.args.length-1)throw new rs(`The expression ${JSON.stringify(this.args[n].serialize())} evaluated to ${cs(sn(o))} but was expected to be of type ${cs(this.type)}.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if(e.kind==="array"){const o=e.itemType;if(o.kind==="string"||o.kind==="number"||o.kind==="boolean"){n.push(o.kind);const c=e.N;(typeof c=="number"||this.args.length>1)&&n.push(c)}}return n.concat(this.args.map(o=>o.serialize()))}}class Hc{constructor(e){this.type=zu,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return n.error("First argument must be an image or text section.");const c=[];let d=!1;for(let p=1;p<=e.length-1;++p){const x=e[p];if(d&&typeof x=="object"&&!Array.isArray(x)){d=!1;let T=null;if(x["font-scale"]&&(T=n.parseObjectValue(x["font-scale"],p,"font-scale",pn),!T))return null;let S=null;if(x["text-font"]&&(S=n.parseObjectValue(x["text-font"],p,"text-font",fo(Bi)),!S))return null;let P=null;if(x["text-color"]&&(P=n.parseObjectValue(x["text-color"],p,"text-color",Ho),!P))return null;const k=c[c.length-1];k.scale=T,k.font=S,k.textColor=P}else{const T=n.parse(e[p],p,Fi);if(!T)return null;const S=T.type.kind;if(S!=="string"&&S!=="value"&&S!=="null"&&S!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,c.push({content:T,scale:null,font:null,textColor:null})}}return new Hc(c)}evaluate(e){return new mo(this.sections.map(n=>{const o=n.content.evaluate(e);return Id(sn(o),Rh)?new Pd("",o,null,null,null):new Pd(Uo(o),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const o={};n.scale&&(o["font-scale"]=n.scale.serialize()),n.font&&(o["text-font"]=n.font.serialize()),n.textColor&&(o["text-color"]=n.textColor.serialize()),e.push(o)}return e}}class Uc{constructor(e,n,o,c){this._imageWarnHistory={},this.type=Rh,this.namePrimary=e,this.nameSecondary=n,o&&(this.paramsPrimary=o.params,this.iconsetIdPrimary=o.iconset?o.iconset.id:void 0),c&&(this.paramsSecondary=c.params,this.iconsetIdSecondary=c.iconset?c.iconset.id:void 0)}static parse(e,n){if(e.length<2)return n.error("Expected two or more arguments.");let o=1;const c=[];function d(){if(o<e.length){const x=n.parse(e[o],o++,Bi);return x?(c.push({image:x,options:{}}),!0):(n.error(c.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function p(){if(o<e.length){const T=e[o];if((x=T)===null||typeof x!="object"||Array.isArray(x))return!0;const S=T.params,P=T.iconset,k=n.concat(o);if(!S&&!P)return o++,!0;if(S){if(typeof S!="object"||S.constructor!==Object)return k.error('Image options "params" should be an object'),!1;const R={},B=k.concat(void 0,"params");for(const j in S){if(!j)return B.error("Image parameter name should be non-empty"),!1;const $=B.concat(void 0,j).parse(S[j],void 0,Ho,void 0,{typeAnnotation:"coerce"});if(!$)return!1;R[j]=$}c[c.length-1].options.params=R}if(P){if(typeof P!="object"||P.constructor!==Object)return k.error('Image options "iconset" should be an object'),!1;if(!P.id)return k.error('Image options "iconset" should have an "id" property'),!1;c[c.length-1].options.iconset=P}return o++,!0}var x;return!0}for(let x=0;x<2;x++)if(!d()||!p())return;return new Uc(c[0].image,c[1]?c[1].image:void 0,c[0].options,c[1]?c[1].options:void 0)}evaluateParams(e,n){const o={};if(n){for(const c in n)if(n[c])try{o[c]=n[c].evaluate(e)}catch{continue}if(Object.keys(o).length!==0)return{params:o}}}evaluate(e){const n={name:this.namePrimary.evaluate(e),iconsetId:this.iconsetIdPrimary},o=this.nameSecondary?{name:this.nameSecondary.evaluate(e),iconsetId:this.iconsetIdSecondary}:void 0,c=Po.build(n,o,this.paramsPrimary?this.evaluateParams(e,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(e,this.paramsSecondary):void 0);if(c&&e.availableImages){const d=c.getPrimary().id;if(c.available=e.availableImages.some(p=>oo.isEqual(p,d)),c.available){const p=c.getSecondary()?c.getSecondary().id:null;p&&(c.available=e.availableImages.some(x=>oo.isEqual(x,p)))}}return c}eachChild(e){if(e(this.namePrimary),this.paramsPrimary)for(const n in this.paramsPrimary)this.paramsPrimary[n]&&e(this.paramsPrimary[n]);if(this.nameSecondary&&(e(this.nameSecondary),this.paramsSecondary))for(const n in this.paramsSecondary)this.paramsSecondary[n]&&e(this.paramsSecondary[n])}outputDefined(){return!1}serializeOptions(e,n){const o={};if(n&&(o.iconset={id:n}),e){o.params={};for(const c in e)e[c]&&(o.params[c]=e[c].serialize())}return Object.keys(o).length>0?o:void 0}serialize(){const e=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const n=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);n&&e.push(n)}if(this.nameSecondary&&(e.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const n=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);n&&e.push(n)}return e}}function wl(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}const $c={"to-boolean":Di,"to-color":Ho,"to-number":pn,"to-string":Bi};class ya{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[0],c=[];let d=Ru;if(o==="to-array"){if(!Array.isArray(e[1]))return null;const p=e[1].length;if(n.expectedType){if(n.expectedType.kind!=="array")return n.error(`Expected ${n.expectedType.kind} but found array.`);d=fo(n.expectedType.itemType,p)}else{if(!(p>0&&ii(e[1][0])))return null;d=fo(sn(e[1][0]),p)}for(let x=0;x<p;x++){const T=e[1][x];let S;if(wl(T)==="array")S=n.parse(T,void 0,d.itemType);else{const P=wl(T);if(P!==d.itemType.kind)return n.error(`Expected ${d.itemType.kind} but found ${P}.`);S=n.registry.literal.parse(["literal",T===void 0?null:T],n)}if(!S)return null;c.push(S)}}else{if((o==="to-boolean"||o==="to-string")&&e.length!==2)return n.error("Expected one argument.");d=$c[o];for(let p=1;p<e.length;p++){const x=n.parse(e[p],p,Fi);if(!x)return null;c.push(x)}}return new ya(d,c)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let n,o;for(const c of this.args){if(n=c.evaluate(e),o=null,n instanceof Ti)return n;if(typeof n=="string"){const d=e.parseColor(n);if(d)return d}else if(Array.isArray(n)&&(o=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:qc(n[0],n[1],n[2],n[3]),!o))return new Ti(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new rs(o||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const o of this.args){if(n=o.evaluate(e),n===null)return 0;const c=Number(n);if(!isNaN(c))return c}throw new rs(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?mo.fromString(Uo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Po.build(Uo(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(n=>n.evaluate(e)):Uo(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Hc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Uc(this.args[0]).serialize();const e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}const go=["Unknown","Point","LineString","Polygon"];class Lh{constructor(e,n){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=e,this.options=n}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?go[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:o,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(o*n-e[0])+this.featureDistanceData.bearing[1]*(c*n-e[1])}return 0}parseColor(e){let n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=Ti.parse(e)),n}getConfig(e){return this.options?this.options.get(e):null}}class vs{constructor(e,n,o,c,d){this.name=e,this.type=n,this._evaluate=o,this.args=c,this._overloadIndex=d}evaluate(e){if(!this._evaluate){const n=vs.definitions[this.name];this._evaluate=Array.isArray(n)?n[2]:n.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const o=e[0],c=vs.definitions[o];if(!c)return n.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(c)?c[0]:c.type,p=Array.isArray(c)?[[c[1],c[2]]]:c.overloads,x=[];let T=null,S=-1;for(const[P,k]of p){if(Array.isArray(P)&&P.length!==e.length-1)continue;x.push(P),S++,T=new Uu(n.registry,n.path,null,n.scope,void 0,n._scope,n.options);const R=[];let B=!1;for(let j=1;j<e.length;j++){const $=e[j],K=Array.isArray(P)?P[j-1]:P.type,ee=T.parse($,1+R.length,K);if(!ee){B=!0;break}R.push(ee)}if(!B)if(Array.isArray(P)&&P.length!==R.length)T.error(`Expected ${P.length} arguments, but found ${R.length} instead.`);else{for(let j=0;j<R.length;j++){const $=Array.isArray(P)?P[j]:P.type,K=R[j];T.concat(j+1).checkSubtype($,K.type)}if(T.errors.length===0)return new vs(o,d,k,R,S)}}if(x.length===1)n.errors.push(...T.errors);else{const P=(x.length?x:p.map(([R])=>R)).map(kd).join(" | "),k=[];for(let R=1;R<e.length;R++){const B=n.parse(e[R],1+k.length);if(!B)return null;k.push(cs(B.type))}n.error(`Expected arguments of type ${P}, but found (${k.join(", ")}) instead.`)}return null}static register(e,n){vs.definitions=n;for(const o in n)e[o]=vs}}function kd(i){return Array.isArray(i)?`(${i.map(cs).join(", ")})`:`(${cs(i.type)}...)`}class $o{constructor(e,n,o){this.type=Ad,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return n.error("Collator options argument must be an object.");const c=o["case-sensitive"]===void 0?n.parse(!1,1,Di):n.parseObjectValue(o["case-sensitive"],1,"case-sensitive",Di);if(!c)return null;const d=o["diacritic-sensitive"]===void 0?n.parse(!1,1,Di):n.parseObjectValue(o["diacritic-sensitive"],1,"diacritic-sensitive",Di);if(!d)return null;let p=null;return o.locale&&(p=n.parseObjectValue(o.locale,1,"locale",Bi),!p)?null:new $o(c,d,p)}evaluate(e){return new Lu(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}function xs(i,e,n=0,o=i.length-1,c=Md){for(;o>n;){if(o-n>600){const T=o-n+1,S=e-n+1,P=Math.log(T),k=.5*Math.exp(2*P/3),R=.5*Math.sqrt(P*k*(T-k)/T)*(S-T/2<0?-1:1);xs(i,e,Math.max(n,Math.floor(e-S*k/T+R)),Math.min(o,Math.floor(e+(T-S)*k/T+R)),c)}const d=i[e];let p=n,x=o;for(Dh(i,n,e),c(i[o],d)>0&&Dh(i,n,o);p<x;){for(Dh(i,p,x),p++,x--;c(i[p],d)<0;)p++;for(;c(i[x],d)>0;)x--}c(i[n],d)===0?Dh(i,n,x):(x++,Dh(i,x,o)),x<=e&&(n=x+1),e<=x&&(o=x-1)}}function Dh(i,e,n){const o=i[e];i[e]=i[n],i[n]=o}function Md(i,e){return i<e?-1:i>e?1:0}function qm(i){let e=0;for(let n,o,c=0,d=i.length,p=d-1;c<d;p=c++)n=i[c],o=i[p],e+=(o.x-n.x)*(n.y+o.y);return e}function Tl(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function lc(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function Sl(i,e,n){const o=i[0]-e[0],c=i[1]-e[1],d=i[0]-n[0],p=i[1]-n[1];return o*p-d*c==0&&o*d<=0&&c*p<=0}function Gc(i,e,n=!1){let o=!1;for(let x=0,T=e.length;x<T;x++){const S=e[x];for(let P=0,k=S.length,R=k-1;P<k;R=P++){const B=S[R],j=S[P];if(Sl(i,B,j))return n;(d=B)[1]>(c=i)[1]!=(p=j)[1]>c[1]&&c[0]<(p[0]-d[0])*(c[1]-d[1])/(p[1]-d[1])+d[0]&&(o=!o)}}var c,d,p;return o}function Mp(i,e,n,o){const c=o[0]-n[0],d=o[1]-n[1],p=(i[0]-n[0])*d-c*(i[1]-n[1]),x=(e[0]-n[0])*d-c*(e[1]-n[1]);return p>0&&x<0||p<0&&x>0}function Oh(i,e,n,o){return(c=[o[0]-n[0],o[1]-n[1]])[0]*(d=[e[0]-i[0],e[1]-i[1]])[1]-c[1]*d[0]!=0&&!(!Mp(i,e,n,o)||!Mp(n,o,i,e));var c,d}function Rp(i){const e=new Wt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),n=new Wt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const o of i[0])e.x>o.x&&(e.x=o.x),e.y>o.y&&(e.y=o.y),n.x<o.x&&(n.x=o.x),n.y<o.y&&(n.y=o.y);return{min:e,max:n}}const Cl=8192;function Hm(i,e){const n=(180+i[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,c=Math.pow(2,e.z);return[Math.round(n*c*Cl),Math.round(o*c*Cl)]}function Um(i,e){for(let n=0;n<e.length;n++)if(Gc(i,e[n]))return!0;return!1}function zf(i,e,n){for(const o of n)for(let c=0,d=o.length,p=d-1;c<d;p=c++)if(Oh(i,e,o[p],o[c]))return!0;return!1}function va(i,e){for(let n=0;n<i.length;++n)if(!Gc(i[n],e))return!1;for(let n=0;n<i.length-1;++n)if(zf(i[n],i[n+1],e))return!1;return!0}function Ia(i,e){for(let n=0;n<e.length;n++)if(va(i,e[n]))return!0;return!1}function Rd(i,e,n){const o=[];for(let c=0;c<i.length;c++){const d=[];for(let p=0;p<i[c].length;p++){const x=Hm(i[c][p],n);Tl(e,x),d.push(x)}o.push(d)}return o}function zp(i,e,n){const o=[];for(let c=0;c<i.length;c++){const d=Rd(i[c],e,n);o.push(d)}return o}function Bh(i,e,n,o){if(i[0]<n[0]||i[0]>n[2]){const c=.5*o;let d=i[0]-n[0]>c?-o:n[0]-i[0]>c?o:0;d===0&&(d=i[0]-n[2]>c?-o:n[2]-i[0]>c?o:0),i[0]+=d}Tl(e,i)}function zd(i,e,n,o){const c=Math.pow(2,o.z)*Cl,d=[o.x*Cl,o.y*Cl],p=[];if(!i)return p;for(const x of i)for(const T of x){const S=[T.x+d[0],T.y+d[1]];Bh(S,e,n,c),p.push(S)}return p}function Fh(i,e,n,o){const c=Math.pow(2,o.z)*Cl,d=[o.x*Cl,o.y*Cl],p=[];if(!i)return p;for(const T of i){const S=[];for(const P of T){const k=[P.x+d[0],P.y+d[1]];Tl(e,k),S.push(k)}p.push(S)}if(e[2]-e[0]<=c/2){(x=e)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const T of p)for(const S of T)Bh(S,e,n,c)}var x;return p}class ao{constructor(e,n){this.type=Di,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ii(e[1])){const o=e[1];if(o.type==="FeatureCollection")for(let c=0;c<o.features.length;++c){const d=o.features[c].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new ao(o,o.features[c].geometry)}else if(o.type==="Feature"){const c=o.geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new ao(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new ao(o,o)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,o){const c=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],p=n.canonicalID();if(!p)return!1;if(o.type==="Polygon"){const x=Rd(o.coordinates,d,p),T=zd(n.geometry(),c,d,p);if(!lc(c,d))return!1;for(const S of T)if(!Gc(S,x))return!1}if(o.type==="MultiPolygon"){const x=zp(o.coordinates,d,p),T=zd(n.geometry(),c,d,p);if(!lc(c,d))return!1;for(const S of T)if(!Um(S,x))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,o){const c=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],p=n.canonicalID();if(!p)return!1;if(o.type==="Polygon"){const x=Rd(o.coordinates,d,p),T=Fh(n.geometry(),c,d,p);if(!lc(c,d))return!1;for(const S of T)if(!va(S,x))return!1}if(o.type==="MultiPolygon"){const x=zp(o.coordinates,d,p),T=Fh(n.geometry(),c,d,p);if(!lc(c,d))return!1;for(const S of T)if(!Ia(S,x))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const jh={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},cc=1/298.257223563,Nh=cc*(2-cc),Ga=Math.PI/180;class uc{static fromTile(e,n,o){const c=Math.PI*(1-2*(e+.5)/Math.pow(2,n)),d=Math.atan(.5*(Math.exp(c)-Math.exp(-c)))/Ga;return new uc(d,o)}static get units(){return jh}constructor(e,n){if(e===void 0)throw new Error("No latitude given.");if(n&&!jh[n])throw new Error(`Unknown unit ${n}. Use one of: ${Object.keys(jh).join(", ")}`);const o=6378.137*Ga*(n?jh[n]:1),c=Math.cos(e*Ga),d=1/(1-Nh*(1-c*c)),p=Math.sqrt(d);this.kx=o*p*c,this.ky=o*p*d*(1-Nh)}distance(e,n){const o=Ks(e[0]-n[0])*this.kx,c=(e[1]-n[1])*this.ky;return Math.sqrt(o*o+c*c)}bearing(e,n){const o=Ks(n[0]-e[0])*this.kx;return Math.atan2(o,(n[1]-e[1])*this.ky)/Ga}destination(e,n,o){const c=o*Ga;return this.offset(e,Math.sin(c)*n,Math.cos(c)*n)}offset(e,n,o){return[e[0]+n/this.kx,e[1]+o/this.ky]}lineDistance(e){let n=0;for(let o=0;o<e.length-1;o++)n+=this.distance(e[o],e[o+1]);return n}area(e){let n=0;for(let o=0;o<e.length;o++){const c=e[o];for(let d=0,p=c.length,x=p-1;d<p;x=d++)n+=Ks(c[d][0]-c[x][0])*(c[d][1]+c[x][1])*(o?-1:1)}return Math.abs(n)/2*this.kx*this.ky}along(e,n){let o=0;if(n<=0)return e[0];for(let c=0;c<e.length-1;c++){const d=e[c],p=e[c+1],x=this.distance(d,p);if(o+=x,o>n)return Wc(d,p,(n-(o-x))/x)}return e[e.length-1]}pointToSegmentDistance(e,n,o){let[c,d]=n,p=Ks(o[0]-c)*this.kx,x=(o[1]-d)*this.ky;if(p!==0||x!==0){const T=(Ks(e[0]-c)*this.kx*p+(e[1]-d)*this.ky*x)/(p*p+x*x);T>1?(c=o[0],d=o[1]):T>0&&(c+=p/this.kx*T,d+=x/this.ky*T)}return p=Ks(e[0]-c)*this.kx,x=(e[1]-d)*this.ky,Math.sqrt(p*p+x*x)}pointOnLine(e,n){let o=1/0,c=e[0][0],d=e[0][1],p=0,x=0;for(let T=0;T<e.length-1;T++){let S=e[T][0],P=e[T][1],k=Ks(e[T+1][0]-S)*this.kx,R=(e[T+1][1]-P)*this.ky,B=0;k===0&&R===0||(B=(Ks(n[0]-S)*this.kx*k+(n[1]-P)*this.ky*R)/(k*k+R*R),B>1?(S=e[T+1][0],P=e[T+1][1]):B>0&&(S+=k/this.kx*B,P+=R/this.ky*B)),k=Ks(n[0]-S)*this.kx,R=(n[1]-P)*this.ky;const j=k*k+R*R;j<o&&(o=j,c=S,d=P,p=T,x=B)}return{point:[c,d],index:p,t:Math.max(0,Math.min(1,x))}}lineSlice(e,n,o){let c=this.pointOnLine(o,e),d=this.pointOnLine(o,n);if(c.index>d.index||c.index===d.index&&c.t>d.t){const S=c;c=d,d=S}const p=[c.point],x=c.index+1,T=d.index;!Ld(o[x],p[0])&&x<=T&&p.push(o[x]);for(let S=x+1;S<=T;S++)p.push(o[S]);return Ld(o[T],d.point)||p.push(d.point),p}lineSliceAlong(e,n,o){let c=0;const d=[];for(let p=0;p<o.length-1;p++){const x=o[p],T=o[p+1],S=this.distance(x,T);if(c+=S,c>e&&d.length===0&&d.push(Wc(x,T,(e-(c-S))/S)),c>=n)return d.push(Wc(x,T,(n-(c-S))/S)),d;c>e&&d.push(T)}return d}bufferPoint(e,n){const o=n/this.ky,c=n/this.kx;return[e[0]-c,e[1]-o,e[0]+c,e[1]+o]}bufferBBox(e,n){const o=n/this.ky,c=n/this.kx;return[e[0]-c,e[1]-o,e[2]+c,e[3]+o]}insideBBox(e,n){return Ks(e[0]-n[0])>=0&&Ks(e[0]-n[2])<=0&&e[1]>=n[1]&&e[1]<=n[3]}}function Ld(i,e){return i[0]===e[0]&&i[1]===e[1]}function Wc(i,e,n){const o=Ks(e[0]-i[0]);return[i[0]+o*n,i[1]+(e[1]-i[1])*n]}function Ks(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}class Ou{constructor(e=[],n=(o,c)=>o<c?-1:o>c?1:0){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:o}=this,c=n[e];for(;e>0;){const d=e-1>>1,p=n[d];if(o(c,p)>=0)break;n[e]=p,e=d}n[e]=c}_down(e){const{data:n,compare:o}=this,c=this.length>>1,d=n[e];for(;e<c;){let p=1+(e<<1);const x=p+1;if(x<this.length&&o(n[x],n[p])<0&&(p=x),o(n[p],d)>=0)break;n[e]=n[p],e=p}n[e]=d}}var Kt=8192;function Bu(i,e){return e.dist-i.dist}const Zc=100,Kc=50;function Fu(i){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==i.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==i[n])return!1;return!0}function ju(i){return i[1]-i[0]+1}function Pa(i,e){const n=i[1]>=i[0]&&i[1]<e;return n||console.warn("Distance Expression: Index is out of range"),n}function Vh(i,e){if(i[0]>i[1])return[null,null];const n=ju(i);if(e){if(n===2)return[i,null];const o=Math.floor(n/2);return[[i[0],i[0]+o],[i[0]+o,i[1]]]}{if(n===1)return[i,null];const o=Math.floor(n/2)-1;return[[i[0],i[0]+o],[i[0]+o+1,i[1]]]}}function Bs(i,e){const n=[1/0,1/0,-1/0,-1/0];if(!Pa(e,i.length))return n;for(let o=e[0];o<=e[1];++o)Tl(n,i[o]);return n}function di(i){const e=[1/0,1/0,-1/0,-1/0];for(let n=0;n<i.length;++n)for(let o=0;o<i[n].length;++o)Tl(e,i[n][o]);return e}function hc(i,e,n){if(Fu(i)||Fu(e))return NaN;let o=0,c=0;return i[2]<e[0]&&(o=e[0]-i[2]),i[0]>e[2]&&(o=i[0]-e[2]),i[1]>e[3]&&(c=i[1]-e[3]),i[3]<e[1]&&(c=e[1]-i[3]),n.distance([0,0],[o,c])}function $m(i){return 360*i-180}function Gm(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function dc(i,e){const n=Math.pow(2,e.z),o=(i.y/Kt+e.y)/n;return[$m((i.x/Kt+e.x)/n),Gm(o)]}function Wm(i,e){const n=[];for(let o=0;o<i.length;++o)n.push(dc(i[o],e));return n}function Cr(i,e,n){const o=n.pointOnLine(e,i).point;return n.distance(i,o)}function Lp(i,e,n,o,c){const d=n.slice(o[0],o[1]+1);let p=1/0;for(let x=e[0];x<=e[1];++x)if((p=Math.min(p,Cr(i[x],d,c)))===0)return 0;return p}function Zr(i,e,n,o,c){const d=Math.min(c.pointToSegmentDistance(i,n,o),c.pointToSegmentDistance(e,n,o)),p=Math.min(c.pointToSegmentDistance(n,i,e),c.pointToSegmentDistance(o,i,e));return Math.min(d,p)}function Dp(i,e,n,o,c){if(!Pa(e,i.length)||!Pa(o,n.length))return NaN;let d=1/0;for(let p=e[0];p<e[1];++p)for(let x=o[0];x<o[1];++x){if(Oh(i[p],i[p+1],n[x],n[x+1]))return 0;d=Math.min(d,Zr(i[p],i[p+1],n[x],n[x+1],c))}return d}function Dd(i,e,n,o,c){if(!Pa(e,i.length)||!Pa(o,n.length))return NaN;let d=1/0;for(let p=e[0];p<=e[1];++p)for(let x=o[0];x<=o[1];++x)if((d=Math.min(d,c.distance(i[p],n[x])))===0)return d;return d}function qh(i,e,n){if(Gc(i,e,!0))return 0;let o=1/0;for(const c of e){const d=c.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(c[0]!==c[d-1]&&(o=Math.min(o,n.pointToSegmentDistance(i,c[d-1],c[0])))===0||(o=Math.min(o,Cr(i,c,n)))===0)return o}return o}function Lf(i,e,n,o){if(!Pa(e,i.length))return NaN;for(let d=e[0];d<=e[1];++d)if(Gc(i[d],n,!0))return 0;let c=1/0;for(let d=e[0];d<e[1];++d)for(const p of n)for(let x=0,T=p.length,S=T-1;x<T;S=x++){if(Oh(i[d],i[d+1],p[S],p[x]))return 0;c=Math.min(c,Zr(i[d],i[d+1],p[S],p[x],o))}return c}function Od(i,e){for(const n of i)for(let o=0;o<=n.length-1;++o)if(Gc(n[o],e,!0))return!0;return!1}function Hh(i,e,n,o=1/0){const c=di(i),d=di(e);if(o!==1/0&&hc(c,d,n)>=o)return o;if(lc(c,d)){if(Od(i,e))return 0}else if(Od(e,i))return 0;let p=o;for(const x of i)for(let T=0,S=x.length,P=S-1;T<S;P=T++)for(const k of e)for(let R=0,B=k.length,j=B-1;R<B;j=R++){if(Oh(x[P],x[T],k[j],k[R]))return 0;p=Math.min(p,Zr(x[P],x[T],k[j],k[R],n))}return p}function Xc(i,e,n,o,c,d,p){if(d===null||p===null)return;const x=hc(Bs(o,d),Bs(c,p),n);x<e&&i.push({dist:x,range1:d,range2:p})}function Nu(i,e,n,o,c=1/0){let d=Math.min(o.distance(i[0],n[0][0]),c);if(d===0)return d;const p=new Ou([{dist:0,range1:[0,i.length-1],range2:[0,0]}],Bu),x=e?Kc:Zc,T=di(n);for(;p.length;){const S=p.pop();if(S.dist>=d)continue;const P=S.range1;if(ju(P)<=x){if(!Pa(P,i.length))return NaN;if(e){const k=Lf(i,P,n,o);if((d=Math.min(d,k))===0)return d}else for(let k=P[0];k<=P[1];++k){const R=qh(i[k],n,o);if((d=Math.min(d,R))===0)return d}}else{const k=Vh(P,e);if(k[0]!==null){const R=hc(Bs(i,k[0]),T,o);R<d&&p.push({dist:R,range1:k[0],range2:[0,0]})}if(k[1]!==null){const R=hc(Bs(i,k[1]),T,o);R<d&&p.push({dist:R,range1:k[1],range2:[0,0]})}}}return d}function Op(i,e,n,o,c,d=1/0){let p=Math.min(d,c.distance(i[0],n[0]));if(p===0)return p;const x=new Ou([{dist:0,range1:[0,i.length-1],range2:[0,n.length-1]}],Bu),T=e?Kc:Zc,S=o?Kc:Zc;for(;x.length;){const P=x.pop();if(P.dist>=p)continue;const k=P.range1,R=P.range2;if(ju(k)<=T&&ju(R)<=S){if(!Pa(k,i.length)||!Pa(R,n.length))return NaN;if(e&&o?p=Math.min(p,Dp(i,k,n,R,c)):e||o?e&&!o?p=Math.min(p,Lp(n,R,i,k,c)):!e&&o&&(p=Math.min(p,Lp(i,k,n,R,c))):p=Math.min(p,Dd(i,k,n,R,c)),p===0)return p}else{const B=Vh(k,e),j=Vh(R,o);Xc(x,p,c,i,n,B[0],j[0]),Xc(x,p,c,i,n,B[0],j[1]),Xc(x,p,c,i,n,B[1],j[0]),Xc(x,p,c,i,n,B[1],j[1])}}return p}function Bp(i,e,n,o,c=1/0){let d=c;const p=Bs(i,[0,i.length-1]);for(const x of n)if(!(d!==1/0&&hc(p,Bs(x,[0,x.length-1]),o)>=d)&&(d=Math.min(d,Op(i,e,x,!0,o,d)),d===0))return d;return d}function Bd(i,e,n,o,c=1/0){let d=c;const p=Bs(i,[0,i.length-1]);for(const x of n){if(d!==1/0&&hc(p,di(x),o)>=d)continue;const T=Nu(i,e,x,o,d);if(isNaN(T))return T;if((d=Math.min(d,T))===0)return d}return d}function Fd(i){return i==="Point"||i==="MultiPoint"||i==="LineString"||i==="MultiLineString"||i==="Polygon"||i==="MultiPolygon"}class Wa{constructor(e,n){this.type=pn,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(ii(e[1])){const o=e[1];if(o.type==="FeatureCollection"){for(let c=0;c<o.features.length;++c)if(Fd(o.features[c].geometry.type))return new Wa(o,o.features[c].geometry)}else if(o.type==="Feature"){if(Fd(o.geometry.type))return new Wa(o,o.geometry)}else if(Fd(o.type))return new Wa(o,o)}return n.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const n=e.geometry(),o=e.canonicalID();if(n!=null&&o!=null){if(e.geometryType()==="Point")return function(c,d,p){const x=[];for(const S of c)for(const P of S)x.push(dc(P,d));const T=new uc(x[0][1],"meters");return p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString"?Op(x,!1,p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",T):p.type==="MultiLineString"?Bp(x,!1,p.coordinates,T):p.type==="Polygon"||p.type==="MultiPolygon"?Bd(x,!1,p.type==="Polygon"?[p.coordinates]:p.coordinates,T):null}(n,o,this.geometries);if(e.geometryType()==="LineString")return function(c,d,p){const x=[];for(const S of c){const P=[];for(const k of S)P.push(dc(k,d));x.push(P)}const T=new uc(x[0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return Bp(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",x,T);if(p.type==="MultiLineString"){let S=1/0;for(let P=0;P<p.coordinates.length;P++){const k=Bp(p.coordinates[P],!0,x,T,S);if(isNaN(k))return k;if((S=Math.min(S,k))===0)return S}return S}if(p.type==="Polygon"||p.type==="MultiPolygon"){let S=1/0;for(let P=0;P<x.length;P++){const k=Bd(x[P],!0,p.type==="Polygon"?[p.coordinates]:p.coordinates,T,S);if(isNaN(k))return k;if((S=Math.min(S,k))===0)return S}return S}return null}(n,o,this.geometries);if(e.geometryType()==="Polygon")return function(c,d,p){const x=[];for(const S of function(P,k){const R=P.length;if(R<=1)return[P];const B=[];let j,$;for(let K=0;K<R;K++){const ee=qm(P[K]);ee!==0&&(P[K].area=Math.abs(ee),$===void 0&&($=ee<0),$===ee<0?(j&&B.push(j),j=[P[K]]):j.push(P[K]))}return j&&B.push(j),B}(c)){const P=[];for(let k=0;k<S.length;++k)P.push(Wm(S[k],d));x.push(P)}const T=new uc(x[0][0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return Bd(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",x,T);if(p.type==="MultiLineString"){let S=1/0;for(let P=0;P<p.coordinates.length;P++){const k=Bd(p.coordinates[P],!0,x,T,S);if(isNaN(k))return k;if((S=Math.min(S,k))===0)return S}return S}return p.type==="Polygon"||p.type==="MultiPolygon"?function(S,P,k){let R=1/0;for(const B of S)for(const j of P){const $=Hh(B,j,k,R);if(isNaN($))return $;if((R=Math.min(R,$))===0)return R}return R}(p.type==="Polygon"?[p.coordinates]:p.coordinates,x,T):null}(n,o,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function El(i){if(i instanceof vs&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof ao||i instanceof Wa)return!1;if(i instanceof Hu)return i.featureConstant;let e=!0;return i.eachChild(n=>{e&&!El(n)&&(e=!1)}),e}function Vu(i){if(i instanceof vs&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(n=>{e&&!Vu(n)&&(e=!1)}),e}function qu(i){if(i instanceof Hu)return new Set([i.key]);let e=new Set;return i.eachChild(n=>{e=new Set([...e,...qu(n)])}),e}function pc(i,e){if(i instanceof vs&&e.indexOf(i.name)>=0)return!1;let n=!0;return i.eachChild(o=>{n&&!pc(o,e)&&(n=!1)}),n}function jd(i,e,n){return[i,e,n].filter(Boolean).join("")}function Fp(i,e){switch(i){case"string":return Uo(e);case"number":return+e;case"boolean":return!!e;case"color":return Ti.parse(e);case"formatted":return mo.fromString(Uo(e));case"resolvedImage":return Po.build(Uo(e))}return e}function jp(i,e,n,o){return o!==void 0&&(i=o*Math.round(i/o)),e!==void 0&&i<e&&(i=e),n!==void 0&&i>n&&(i=n),i}class Hu{constructor(e,n,o,c=!1){this.type=e,this.key=n,this.scope=o,this.featureConstant=c}static parse(e,n){let o=n.expectedType;if(o==null&&(o=Fi),e.length<2||e.length>3)return n.error("Invalid number of arguments for 'config' expression.");const c=n.parse(e[1],1);if(!(c instanceof In))return n.error("Key name of 'config' expression must be a string literal.");let d,p=!0;const x=Uo(c.value);if(e.length>=3){const T=n.parse(e[2],2);if(!(T instanceof In))return n.error("Scope of 'config' expression must be a string literal.");d=Uo(T.value)}if(n.options){const T=jd(x,d,n._scope),S=n.options.get(T);S&&(p=El(S.value||S.default))}return new Hu(o,x,d,p)}evaluate(e){const n=jd(this.key,this.scope,e.scope),o=e.getConfig(n);if(!o)return null;const{type:c,value:d,values:p,minValue:x,maxValue:T,stepValue:S}=o,P=o.default.evaluate(e);let k=P;if(d){const R=e.scope;e.scope=(R||"").split("").slice(1).join(""),k=d.evaluate(e),e.scope=R}return c&&(k=Fp(c,k)),k===void 0||x===void 0&&T===void 0&&S===void 0||(typeof k=="number"?k=jp(k,x,T,S):Array.isArray(k)&&(k=k.map(R=>typeof R=="number"?jp(R,x,T,S):R))),d!==void 0&&k!==void 0&&p&&!p.includes(k)&&(k=P,c&&(k=Fp(c,k))),(c&&c!==this.type||k!==void 0&&!Id(sn(k),this.type))&&(k=Fp(this.type.kind,k)),k}eachChild(){}outputDefined(){return!1}serialize(){const e=["config",this.key];return this.scope&&e.concat(this.scope),e}}class Nd{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const o=e[1];return n.scope.has(o)?new Nd(o,n.scope.get(o)):n.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Uu{constructor(e,n=[],o,c=new kp,d=[],p,x){this.registry=e,this.path=n,this.key=n.map(T=>typeof T=="string"?`['${T}']`:`[${T}]`).join(""),this.scope=c,this.errors=d,this.expectedType=o,this._scope=p,this.options=x}parse(e,n,o,c,d={}){return n||o?this.concat(n,null,o,c)._parse(e,d):this._parse(e,d)}parseObjectValue(e,n,o,c,d,p={}){return this.concat(n,o,c,d)._parse(e,p)}_parse(e,n){function o(c,d,p){return p==="assert"?new Sn(d,[c]):p==="coerce"?new ya(d,[c]):c}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const c=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(c){let d=c.parse(e,this);if(!d)return null;if(this.expectedType){const p=this.expectedType,x=d.type;if(p.kind!=="string"&&p.kind!=="number"&&p.kind!=="boolean"&&p.kind!=="object"&&p.kind!=="array"||x.kind!=="value")if(p.kind!=="color"&&p.kind!=="formatted"&&p.kind!=="resolvedImage"||x.kind!=="value"&&x.kind!=="string"){if(this.checkSubtype(p,x))return null}else d=o(d,p,n.typeAnnotation||"coerce");else d=o(d,p,n.typeAnnotation||"assert")}if(!(d instanceof In)&&d.type.kind!=="resolvedImage"&&Za(d)){const p=new Lh(this._scope,this.options);try{d=new In(d.type,d.evaluate(p))}catch(x){return this.error(x.message),null}}return d}return ya.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,o,c){let d=typeof e=="number"?this.path.concat(e):this.path;d=typeof n=="string"?d.concat(n):d;const p=c?this.scope.concat(c):this.scope;return new Uu(this.registry,d,o||null,p,this.errors,this._scope,this.options)}error(e,...n){const o=`${this.key}${n.map(c=>`[${c}]`).join("")}`;this.errors.push(new qo(o,e))}checkSubtype(e,n){const o=oc(e,n);return o&&this.error(o),o}}function Za(i){if(i instanceof Nd)return Za(i.boundExpression);if(i instanceof vs&&i.name==="error"||i instanceof $o||i instanceof ao||i instanceof Wa||i instanceof Hu)return!1;const e=i instanceof ya||i instanceof Sn;let n=!0;return i.eachChild(o=>{n=e?n&&Za(o):n&&o instanceof In}),!!n&&El(i)&&pc(i,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Uh(i,e){const n=i.length-1;let o,c,d=0,p=n,x=0;for(;d<=p;)if(x=Math.floor((d+p)/2),o=i[x],c=i[x+1],o<=e){if(x===n||e<c)return x;d=x+1}else{if(!(o>e))throw new rs("Input is not a number.");p=x-1}return 0}class Ka{constructor(e,n,o){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[c,d]of o)this.labels.push(c),this.outputs.push(d)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const o=n.parse(e[1],1,pn);if(!o)return null;const c=[];let d=null;n.expectedType&&n.expectedType.kind!=="value"&&(d=n.expectedType);for(let p=1;p<e.length;p+=2){const x=p===1?-1/0:e[p],T=e[p+1],S=p,P=p+1;if(typeof x!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(c.length&&c[c.length-1][0]>=x)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);const k=n.parse(T,P,d);if(!k)return null;d=d||k.type,c.push([x,k])}return new Ka(d,o,c)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const c=this.input.evaluate(e);if(c<=n[0])return o[0].evaluate(e);const d=n.length;return c>=n[d-1]?o[d-1].evaluate(e):o[Uh(n,c)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}const ka=.95047,$u=1.08883,Xa=4/29,Ya=6/29,Df=3*Ya*Ya,Of=Ya*Ya*Ya,Yc=Math.PI/180,$h=180/Math.PI;function fc(i){return i>Of?Math.pow(i,1/3):i/Df+Xa}function Qc(i){return i>Ya?i*i*i:Df*(i-Xa)}function Gu(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function oa(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Qa(i){const e=oa(i.r),n=oa(i.g),o=oa(i.b),c=fc((.4124564*e+.3575761*n+.1804375*o)/ka),d=fc((.2126729*e+.7151522*n+.072175*o)/1);return{l:116*d-16,a:500*(c-d),b:200*(d-fc((.0193339*e+.119192*n+.9503041*o)/$u)),alpha:i.a}}function Kr(i){let e=(i.l+16)/116,n=isNaN(i.a)?e:e+i.a/500,o=isNaN(i.b)?e:e-i.b/200;return e=1*Qc(e),n=ka*Qc(n),o=$u*Qc(o),new Ti(Gu(3.2404542*n-1.5371385*e-.4985314*o),Gu(-.969266*n+1.8760108*e+.041556*o),Gu(.0556434*n-.2040259*e+1.0572252*o),i.alpha)}function es(i,e,n){const o=e-i;return i+n*(o>180||o<-180?o-360*Math.round(o/360):o)}const Go={forward:Qa,reverse:Kr,interpolate:function(i,e,n){return{l:Cn(i.l,e.l,n),a:Cn(i.a,e.a,n),b:Cn(i.b,e.b,n),alpha:Cn(i.alpha,e.alpha,n)}}},fs={forward:function(i){const{l:e,a:n,b:o}=Qa(i),c=Math.atan2(o,n)*$h;return{h:c<0?c+360:c,c:Math.sqrt(n*n+o*o),l:e,alpha:i.a}},reverse:function(i){const e=i.h*Yc,n=i.c;return Kr({l:i.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:i.alpha})},interpolate:function(i,e,n){return{h:es(i.h,e.h,n),c:Cn(i.c,e.c,n),l:Cn(i.l,e.l,n),alpha:Cn(i.alpha,e.alpha,n)}}};var ko=Object.freeze({__proto__:null,hcl:fs,lab:Go});class Fs{constructor(e,n,o,c,d){this.type=e,this.operator=n,this.interpolation=o,this.input=c,this.labels=[],this.outputs=[];for(const[p,x]of d)this.labels.push(p),this.outputs.push(x)}static interpolationFactor(e,n,o,c){let d=0;if(e.name==="exponential")d=Al(n,e.base,o,c);else if(e.name==="linear")d=Al(n,1,o,c);else if(e.name==="cubic-bezier"){const p=e.controlPoints;d=new Sh(p[0],p[1],p[2],p[3]).solve(Al(n,1,o,c))}return d}static parse(e,n){let[o,c,d,...p]=e;if(!Array.isArray(c)||c.length===0)return n.error("Expected an interpolation type expression.",1);if(c[0]==="linear")c={name:"linear"};else if(c[0]==="exponential"){const S=c[1];if(typeof S!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);c={name:"exponential",base:S}}else{if(c[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(c[0])}`,1,0);{const S=c.slice(1);if(S.length!==4||S.some(P=>typeof P!="number"||P<0||P>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);c={name:"cubic-bezier",controlPoints:S}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length-1>3&&(e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(d=n.parse(d,2,pn),!d)return null;const x=[];let T=null;o==="interpolate-hcl"||o==="interpolate-lab"?T=Ho:n.expectedType&&n.expectedType.kind!=="value"&&(T=n.expectedType);for(let S=0;S<p.length;S+=2){const P=p[S],k=p[S+1],R=S+3,B=S+4;if(typeof P!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(x.length&&x[x.length-1][0]>=P)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const j=n.parse(k,B,T);if(!j)return null;T=T||j.type,x.push([P,j])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new Fs(T,o,c,d,x):n.error(`Type ${cs(T)} is not interpolatable.`)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const c=this.input.evaluate(e);if(c<=n[0])return o[0].evaluate(e);const d=n.length;if(c>=n[d-1])return o[d-1].evaluate(e);const p=Uh(n,c),x=Fs.interpolationFactor(this.interpolation,c,n[p],n[p+1]),T=o[p].evaluate(e),S=o[p+1].evaluate(e);return this.operator==="interpolate"?vl[this.type.kind.toLowerCase()](T,S,x):this.operator==="interpolate-hcl"?fs.reverse(fs.interpolate(fs.forward(T),fs.forward(S),x)):Go.reverse(Go.interpolate(Go.forward(T),Go.forward(S),x))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const n=[this.operator,e,this.input.serialize()];for(let o=0;o<this.labels.length;o++)n.push(this.labels[o],this.outputs[o].serialize());return n}}function Al(i,e,n,o){const c=o-n,d=i-n;return c===0?0:e===1?d/c:(Math.pow(e,d)-1)/(Math.pow(e,c)-1)}class Xs{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let o=null;const c=n.expectedType;c&&c.kind!=="value"&&(o=c);const d=[];for(const x of e.slice(1)){const T=n.parse(x,1+d.length,o,void 0,{typeAnnotation:"omit"});if(!T)return null;o=o||T.type,d.push(T)}const p=c&&d.some(x=>oc(c,x.type));return new Xs(p?Fi:o,d)}evaluate(e){let n,o=null,c=0;for(const d of this.args){if(c++,o=d.evaluate(e),o&&o instanceof Po&&!o.available&&(n||(n=o),o=null,c===this.args.length))return n;if(o!==null)break}return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class Jc{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let d=1;d<e.length-1;d+=2){const p=e[d];if(typeof p!="string")return n.error(`Expected string, but found ${typeof p} instead.`,d);if(/[^a-zA-Z0-9_]/.test(p))return n.error("Variable names must contain only alphanumeric characters or '_'.",d);const x=n.parse(e[d+1],d+1);if(!x)return null;o.push([p,x])}const c=n.parse(e[e.length-1],e.length-1,n.expectedType,o);return c?new Jc(o,c):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,o]of this.bindings)e.push(n,o.serialize());return e.push(this.result.serialize()),e}}class Vd{constructor(e,n,o){this.type=e,this.index=n,this.input=o}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,pn),c=n.parse(e[2],2,fo(n.expectedType||Fi));return o&&c?new Vd(c.type.itemType,o,c):null}evaluate(e){const n=this.index.evaluate(e),o=this.input.evaluate(e);if(n<0)throw new rs(`Array index out of bounds: ${n} < 0.`);if(n>=o.length)throw new rs(`Array index out of bounds: ${n} > ${o.length-1}.`);if(n!==Math.floor(n))throw new rs(`Array index must be an integer, but found ${n} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return o[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class qd{constructor(e,n,o){this.type=e,this.index=n,this.input=o}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,pn),c=n.parse(e[2],2,fo(n.expectedType||Fi));return o&&c?new qd(c.type.itemType,o,c):null}evaluate(e){const n=this.index.evaluate(e),o=this.input.evaluate(e);if(n<0)throw new rs(`Array index out of bounds: ${n} < 0.`);if(n>o.length-1)throw new rs(`Array index out of bounds: ${n} > ${o.length-1}.`);if(n===Math.floor(n))return o[n];const c=Math.floor(n),d=Math.ceil(n),p=o[c],x=o[d];if(typeof p!="number"||typeof x!="number")throw new rs(`Cannot interpolate between non-number values at index ${n}.`);const T=n-c;return p*(1-T)+x*T}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class eu{constructor(e,n){this.type=Di,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,Fi),c=n.parse(e[2],2,Fi);return o&&c?ac(o.type,[Di,Bi,pn,Ru,Fi])?new eu(o,c):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${cs(o.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(o==null)return!1;if(!zh(n,["boolean","string","number","null"]))throw new rs(`Expected first argument to be of type boolean, string, number or null, but found ${cs(sn(n))} instead.`);if(!zh(o,["string","array"]))throw new rs(`Expected second argument to be of type array or string, but found ${cs(sn(o))} instead.`);return o.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Wu{constructor(e,n,o){this.type=pn,this.needle=e,this.haystack=n,this.fromIndex=o}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,Fi),c=n.parse(e[2],2,Fi);if(!o||!c)return null;if(!ac(o.type,[Di,Bi,pn,Ru,Fi]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${cs(o.type)} instead`);if(e.length===4){const d=n.parse(e[3],3,pn);return d?new Wu(o,c,d):null}return new Wu(o,c)}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!zh(n,["boolean","string","number","null"]))throw new rs(`Expected first argument to be of type boolean, string, number or null, but found ${cs(sn(n))} instead.`);if(!zh(o,["string","array"]))throw new rs(`Expected second argument to be of type array or string, but found ${cs(sn(o))} instead.`);if(this.fromIndex){const c=this.fromIndex.evaluate(e);return o.indexOf(n,c)}return o.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Wo{constructor(e,n,o,c,d,p){this.inputType=e,this.type=n,this.input=o,this.cases=c,this.outputs=d,this.otherwise=p}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let o,c;n.expectedType&&n.expectedType.kind!=="value"&&(c=n.expectedType);const d={},p=[];for(let S=2;S<e.length-1;S+=2){let P=e[S];const k=e[S+1];Array.isArray(P)||(P=[P]);const R=n.concat(S);if(P.length===0)return R.error("Expected at least one branch label.");for(const j of P){if(typeof j!="number"&&typeof j!="string")return R.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return R.error("Numeric branch labels must be integer values.");if(o){if(R.checkSubtype(o,sn(j)))return null}else o=sn(j);if(d[String(j)]!==void 0)return R.error("Branch labels must be unique.");d[String(j)]=p.length}const B=n.parse(k,S,c);if(!B)return null;c=c||B.type,p.push(B)}const x=n.parse(e[1],1,Fi);if(!x)return null;const T=n.parse(e[e.length-1],e.length-1,c);return T?x.type.kind!=="value"&&n.concat(1).checkSubtype(o,x.type)?null:new Wo(o,c,x,d,p,T):null}evaluate(e){const n=this.input.evaluate(e);return(Id(sn(n),this.inputType)&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),o=[],c={};for(const p of n){const x=c[this.cases[p]];x===void 0?(c[this.cases[p]]=o.length,o.push([this.cases[p],[p]])):o[x][1].push(p)}const d=p=>this.inputType.kind==="number"?Number(p):p;for(const[p,x]of o)e.push(x.length===1?d(x[0]):x.map(d)),e.push(this.outputs[p].serialize());return e.push(this.otherwise.serialize()),e}}class Zu{constructor(e,n,o){this.type=e,this.branches=n,this.otherwise=o}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let o;n.expectedType&&n.expectedType.kind!=="value"&&(o=n.expectedType);const c=[];for(let p=1;p<e.length-1;p+=2){const x=n.parse(e[p],p,Di);if(!x)return null;const T=n.parse(e[p+1],p+1,o);if(!T)return null;c.push([x,T]),o=o||T.type}const d=n.parse(e[e.length-1],e.length-1,o);return d?new Zu(o,c,d):null}evaluate(e){for(const[n,o]of this.branches)if(n.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,o]of this.branches)e(n),e(o);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class tu{constructor(e,n,o,c){this.type=e,this.input=n,this.beginIndex=o,this.endIndex=c}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,Fi),c=n.parse(e[2],2,pn);if(!o||!c)return null;if(!ac(o.type,[fo(Fi),Bi,Fi]))return n.error(`Expected first argument to be of type array or string, but found ${cs(o.type)} instead`);if(e.length===4){const d=n.parse(e[3],3,pn);return d?new tu(o.type,o,c,d):null}return new tu(o.type,o,c)}evaluate(e){const n=this.input.evaluate(e),o=this.beginIndex.evaluate(e);if(!zh(n,["string","array"]))throw new rs(`Expected first argument to be of type array or string, but found ${cs(sn(n))} instead.`);if(this.endIndex){const c=this.endIndex.evaluate(e);return n.slice(o,c)}return n.slice(o)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Np(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Bf(i,e,n,o){return o.compare(e,n)===0}function Zo(i,e,n){const o=i!=="=="&&i!=="!=";return class sI{constructor(d,p,x){this.type=Di,this.lhs=d,this.rhs=p,this.collator=x,this.hasUntypedArgument=d.type.kind==="value"||p.type.kind==="value"}static parse(d,p){if(d.length!==3&&d.length!==4)return p.error("Expected two or three arguments.");const x=d[0];let T=p.parse(d[1],1,Fi);if(!T)return null;if(!Np(x,T.type))return p.concat(1).error(`"${x}" comparisons are not supported for type '${cs(T.type)}'.`);let S=p.parse(d[2],2,Fi);if(!S)return null;if(!Np(x,S.type))return p.concat(2).error(`"${x}" comparisons are not supported for type '${cs(S.type)}'.`);if(T.type.kind!==S.type.kind&&T.type.kind!=="value"&&S.type.kind!=="value")return p.error(`Cannot compare types '${cs(T.type)}' and '${cs(S.type)}'.`);o&&(T.type.kind==="value"&&S.type.kind!=="value"?T=new Sn(S.type,[T]):T.type.kind!=="value"&&S.type.kind==="value"&&(S=new Sn(T.type,[S])));let P=null;if(d.length===4){if(T.type.kind!=="string"&&S.type.kind!=="string"&&T.type.kind!=="value"&&S.type.kind!=="value")return p.error("Cannot use collator to compare non-string types.");if(P=p.parse(d[3],3,Ad),!P)return null}return new sI(T,S,P)}evaluate(d){const p=this.lhs.evaluate(d),x=this.rhs.evaluate(d);if(o&&this.hasUntypedArgument){const T=sn(p),S=sn(x);if(T.kind!==S.kind||T.kind!=="string"&&T.kind!=="number")throw new rs(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${T.kind}, ${S.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const T=sn(p),S=sn(x);if(T.kind!=="string"||S.kind!=="string")return e(d,p,x)}return this.collator?n(d,p,x,this.collator.evaluate(d)):e(d,p,x)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[i];return this.eachChild(p=>{d.push(p.serialize())}),d}}}const nu=Zo("==",function(i,e,n){return e===n},Bf),Ku=Zo("!=",function(i,e,n){return e!==n},function(i,e,n,o){return!Bf(0,e,n,o)}),Hd=Zo("<",function(i,e,n){return e<n},function(i,e,n,o){return o.compare(e,n)<0}),Ud=Zo(">",function(i,e,n){return e>n},function(i,e,n,o){return o.compare(e,n)>0}),Mo=Zo("<=",function(i,e,n){return e<=n},function(i,e,n,o){return o.compare(e,n)<=0}),xa=Zo(">=",function(i,e,n){return e>=n},function(i,e,n,o){return o.compare(e,n)>=0});class Ja{constructor(e,n,o,c,d,p){this.type=Bi,this.number=e,this.locale=n,this.currency=o,this.unit=c,this.minFractionDigits=d,this.maxFractionDigits=p}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const o=n.parse(e[1],1,pn);if(!o)return null;const c=e[2];if(typeof c!="object"||Array.isArray(c))return n.error("NumberFormat options argument must be an object.");let d=null;if(c.locale&&(d=n.parseObjectValue(c.locale,2,"locale",Bi),!d))return null;let p=null;if(c.currency&&(p=n.parseObjectValue(c.currency,2,"currency",Bi),!p))return null;let x=null;if(c.unit&&(x=n.parseObjectValue(c.unit,2,"unit",Bi),!x))return null;let T=null;if(c["min-fraction-digits"]&&(T=n.parseObjectValue(c["min-fraction-digits"],2,"min-fraction-digits",pn),!T))return null;let S=null;return c["max-fraction-digits"]&&(S=n.parseObjectValue(c["max-fraction-digits"],2,"max-fraction-digits",pn),!S)?null:new Ja(o,d,p,x,T,S)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Ma{constructor(e){this.type=pn,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=n.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${cs(o.type)} instead.`):new Ma(o):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new rs(`Expected value to be of type string or array, but found ${cs(sn(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}function el(i){return function(){i=1831565813+(i|=0)|0;let e=Math.imul(i^i>>>15,1|i);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const aa={"==":nu,"!=":Ku,">":Ud,"<":Hd,">=":xa,"<=":Mo,array:Sn,at:Vd,"at-interpolated":qd,boolean:Sn,case:Zu,coalesce:Xs,collator:$o,format:Hc,image:Uc,in:eu,"index-of":Wu,interpolate:Fs,"interpolate-hcl":Fs,"interpolate-lab":Fs,length:Ma,let:Jc,literal:In,match:Wo,number:Sn,"number-format":Ja,object:Sn,slice:tu,step:Ka,string:Sn,"to-boolean":ya,"to-color":ya,"to-number":ya,"to-string":ya,var:Nd,within:ao,distance:Wa,config:Hu};function $d(i,[e,n,o,c]){e=e.evaluate(i),n=n.evaluate(i),o=o.evaluate(i);const d=c?c.evaluate(i):1,p=qc(e,n,o,d);if(p)throw new rs(p);return new Ti(e/255,n/255,o/255,d)}function Gh(i,[e,n,o,c]){e=e.evaluate(i),n=n.evaluate(i),o=o.evaluate(i);const d=c?c.evaluate(i):1,p=function(S,P,k,R){return typeof S=="number"&&S>=0&&S<=360?typeof P=="number"&&P>=0&&P<=100&&typeof k=="number"&&k>=0&&k<=100?R===void 0||typeof R=="number"&&R>=0&&R<=1?null:`Invalid hsla value [${[S,P,k,R].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof R=="number"?[S,P,k,R]:[S,P,k]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof R=="number"?[S,P,k,R]:[S,P,k]).join(", ")}]: 'h' must be between 0 and 360.`}(e,n,o,d);if(p)throw new rs(p);const x=`hsla(${e}, ${n}%, ${o}%, ${d})`,T=Ti.parse(x);if(!T)throw new rs(`Failed to parse HSLA color: ${x}`);return T}function Gd(i,e){return i in e}function Es(i,e){const n=e[i];return n===void 0?null:n}function js(i){return{type:i}}function ss(i){return{result:"success",value:i}}function Ys(i){return{result:"error",value:i}}function Wh(i,e){return!!i&&!!i.parameters&&i.parameters.indexOf(e)>-1}function Xu(i){return i["property-type"]==="data-driven"}function Zh(i){return Wh(i.expression,"measure-light")}function Kh(i){return Wh(i.expression,"zoom")}function Yu(i){return!!i.expression&&i.expression.interpolated}function mc(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Vp(i){return i}function iu(i,e){const n=e.type==="color",o=i.stops&&typeof i.stops[0][0]=="object",c=o||!(o||i.property!==void 0),d=i.type||(Yu(e)?"exponential":"interval");if(n&&((i=$a({},i)).stops&&(i.stops=i.stops.map(S=>[S[0],Ti.parse(S[1])])),i.default=Ti.parse(i.default?i.default:e.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!ko[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let p,x,T;if(d==="exponential")p=Qu;else if(d==="interval")p=Xh;else if(d==="categorical"){p=Zm,x=Object.create(null);for(const S of i.stops)x[S[0]]=S[1];T=typeof i.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);p=Ff}if(o){const S={},P=[];for(let B=0;B<i.stops.length;B++){const j=i.stops[B],$=j[0].zoom;S[$]===void 0&&(S[$]={zoom:$,type:i.type,property:i.property,default:i.default,stops:[]},P.push($)),S[$].stops.push([j[0].value,j[1]])}const k=[];for(const B of P)k.push([S[B].zoom,iu(S[B],e)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:Fs.interpolationFactor.bind(void 0,R),zoomStops:k.map(B=>B[0]),evaluate:({zoom:B},j)=>Qu({stops:k,base:i.base},e,B).evaluate(B,j)}}if(c){const S=d==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:S,interpolationFactor:Fs.interpolationFactor.bind(void 0,S),zoomStops:i.stops.map(P=>P[0]),evaluate:({zoom:P})=>p(i,e,P,x,T)}}return{kind:"source",evaluate(S,P){const k=P&&P.properties?P.properties[i.property]:void 0;return k===void 0?Ko(i.default,e.default):p(i,e,k,x,T)}}}function Ko(i,e,n){return i!==void 0?i:e!==void 0?e:n!==void 0?n:void 0}function Zm(i,e,n,o,c){return Ko(typeof n===c?o[n]:void 0,i.default,e.default)}function Xh(i,e,n){if(wl(n)!=="number")return Ko(i.default,e.default);const o=i.stops.length;if(o===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[o-1][0])return i.stops[o-1][1];const c=Uh(i.stops.map(d=>d[0]),n);return i.stops[c][1]}function Qu(i,e,n){const o=i.base!==void 0?i.base:1;if(wl(n)!=="number")return Ko(i.default,e.default);const c=i.stops.length;if(c===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[c-1][0])return i.stops[c-1][1];const d=Uh(i.stops.map(P=>P[0]),n),p=function(P,k,R,B){const j=B-R,$=P-R;return j===0?0:k===1?$/j:(Math.pow(k,$)-1)/(Math.pow(k,j)-1)}(n,o,i.stops[d][0],i.stops[d+1][0]),x=i.stops[d][1],T=i.stops[d+1][1];let S=vl[e.type]||Vp;if(i.colorSpace&&i.colorSpace!=="rgb"){const P=ko[i.colorSpace];S=(k,R)=>P.reverse(P.interpolate(P.forward(k),P.forward(R),p))}return typeof x.evaluate=="function"?{evaluate(...P){const k=x.evaluate.apply(void 0,P),R=T.evaluate.apply(void 0,P);if(k!==void 0&&R!==void 0)return S(k,R,p)}}:S(x,T,p)}function Ff(i,e,n){return e.type==="color"?n=Ti.parse(n):e.type==="formatted"?n=mo.fromString(n.toString()):e.type==="resolvedImage"?n=Po.build(n.toString()):wl(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),Ko(n,i.default,e.default)}vs.register(aa,{error:[{kind:"error"},[Bi],(i,[e])=>{throw new rs(e.evaluate(i))}],typeof:[Bi,[Fi],(i,[e])=>cs(sn(e.evaluate(i)))],"to-rgba":[fo(pn,4),[Ho],(i,[e])=>e.evaluate(i).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[fo(pn,4),[Ho],(i,[e])=>e.evaluate(i).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[Ho,[pn,pn,pn],$d],rgba:[Ho,[pn,pn,pn,pn],$d],hsl:[Ho,[pn,pn,pn],Gh],hsla:[Ho,[pn,pn,pn,pn],Gh],has:{type:Di,overloads:[[[Bi],(i,[e])=>Gd(e.evaluate(i),i.properties())],[[Bi,xl],(i,[e,n])=>Gd(e.evaluate(i),n.evaluate(i))]]},get:{type:Fi,overloads:[[[Bi],(i,[e])=>Es(e.evaluate(i),i.properties())],[[Bi,xl],(i,[e,n])=>Es(e.evaluate(i),n.evaluate(i))]]},"feature-state":[Fi,[Bi],(i,[e])=>Es(e.evaluate(i),i.featureState||{})],properties:[xl,[],i=>i.properties()],"geometry-type":[Bi,[],i=>i.geometryType()],worldview:[Bi,[],i=>i.globals.worldview||""],id:[Fi,[],i=>i.id()],zoom:[pn,[],i=>i.globals.zoom],pitch:[pn,[],i=>i.globals.pitch||0],"distance-from-center":[pn,[],i=>i.distanceFromCenter()],"measure-light":[pn,[Bi],(i,[e])=>i.measureLight(e.evaluate(i))],"heatmap-density":[pn,[],i=>i.globals.heatmapDensity||0],"line-progress":[pn,[],i=>i.globals.lineProgress||0],"raster-value":[pn,[],i=>i.globals.rasterValue||0],"raster-particle-speed":[pn,[],i=>i.globals.rasterParticleSpeed||0],"sky-radial-progress":[pn,[],i=>i.globals.skyRadialProgress||0],accumulated:[Fi,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[pn,js(pn),(i,e)=>{let n=0;for(const o of e)n+=o.evaluate(i);return n}],"*":[pn,js(pn),(i,e)=>{let n=1;for(const o of e)n*=o.evaluate(i);return n}],"-":{type:pn,overloads:[[[pn,pn],(i,[e,n])=>e.evaluate(i)-n.evaluate(i)],[[pn],(i,[e])=>-e.evaluate(i)]]},"/":[pn,[pn,pn],(i,[e,n])=>e.evaluate(i)/n.evaluate(i)],"%":[pn,[pn,pn],(i,[e,n])=>e.evaluate(i)%n.evaluate(i)],ln2:[pn,[],()=>Math.LN2],pi:[pn,[],()=>Math.PI],e:[pn,[],()=>Math.E],"^":[pn,[pn,pn],(i,[e,n])=>Math.pow(e.evaluate(i),n.evaluate(i))],sqrt:[pn,[pn],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[pn,[pn],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[pn,[pn],(i,[e])=>Math.log(e.evaluate(i))],log2:[pn,[pn],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[pn,[pn],(i,[e])=>Math.sin(e.evaluate(i))],cos:[pn,[pn],(i,[e])=>Math.cos(e.evaluate(i))],tan:[pn,[pn],(i,[e])=>Math.tan(e.evaluate(i))],asin:[pn,[pn],(i,[e])=>Math.asin(e.evaluate(i))],acos:[pn,[pn],(i,[e])=>Math.acos(e.evaluate(i))],atan:[pn,[pn],(i,[e])=>Math.atan(e.evaluate(i))],min:[pn,js(pn),(i,e)=>Math.min(...e.map(n=>n.evaluate(i)))],max:[pn,js(pn),(i,e)=>Math.max(...e.map(n=>n.evaluate(i)))],abs:[pn,[pn],(i,[e])=>Math.abs(e.evaluate(i))],round:[pn,[pn],(i,[e])=>{const n=e.evaluate(i);return n<0?-Math.round(-n):Math.round(n)}],floor:[pn,[pn],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[pn,[pn],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Di,[Bi,Fi],(i,[e,n])=>i.properties()[e.value]===n.value],"filter-id-==":[Di,[Fi],(i,[e])=>i.id()===e.value],"filter-type-==":[Di,[Bi],(i,[e])=>i.geometryType()===e.value],"filter-<":[Di,[Bi,Fi],(i,[e,n])=>{const o=i.properties()[e.value],c=n.value;return typeof o==typeof c&&o<c}],"filter-id-<":[Di,[Fi],(i,[e])=>{const n=i.id(),o=e.value;return typeof n==typeof o&&n<o}],"filter->":[Di,[Bi,Fi],(i,[e,n])=>{const o=i.properties()[e.value],c=n.value;return typeof o==typeof c&&o>c}],"filter-id->":[Di,[Fi],(i,[e])=>{const n=i.id(),o=e.value;return typeof n==typeof o&&n>o}],"filter-<=":[Di,[Bi,Fi],(i,[e,n])=>{const o=i.properties()[e.value],c=n.value;return typeof o==typeof c&&o<=c}],"filter-id-<=":[Di,[Fi],(i,[e])=>{const n=i.id(),o=e.value;return typeof n==typeof o&&n<=o}],"filter->=":[Di,[Bi,Fi],(i,[e,n])=>{const o=i.properties()[e.value],c=n.value;return typeof o==typeof c&&o>=c}],"filter-id->=":[Di,[Fi],(i,[e])=>{const n=i.id(),o=e.value;return typeof n==typeof o&&n>=o}],"filter-has":[Di,[Fi],(i,[e])=>e.value in i.properties()],"filter-has-id":[Di,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Di,[fo(Bi)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Di,[fo(Fi)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Di,[Bi,fo(Fi)],(i,[e,n])=>n.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Di,[Bi,fo(Fi)],(i,[e,n])=>function(o,c,d,p){for(;d<=p;){const x=d+p>>1;if(c[x]===o)return!0;c[x]>o?p=x-1:d=x+1}return!1}(i.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Di,overloads:[[[Di,Di],(i,[e,n])=>e.evaluate(i)&&n.evaluate(i)],[js(Di),(i,e)=>{for(const n of e)if(!n.evaluate(i))return!1;return!0}]]},any:{type:Di,overloads:[[[Di,Di],(i,[e,n])=>e.evaluate(i)||n.evaluate(i)],[js(Di),(i,e)=>{for(const n of e)if(n.evaluate(i))return!0;return!1}]]},"!":[Di,[Di],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Di,[Bi],(i,[e])=>{const n=i.globals&&i.globals.isSupportedScript;return!n||n(e.evaluate(i))}],upcase:[Bi,[Bi],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[Bi,[Bi],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[Bi,js(Fi),(i,e)=>e.map(n=>Uo(n.evaluate(i))).join("")],"resolved-locale":[Bi,[Ad],(i,[e])=>e.evaluate(i).resolvedLocale()],random:[pn,[pn,pn,Fi],(i,e)=>{const[n,o,c]=e.map(p=>p.evaluate(i));if(n>o||n===o)return n;let d;if(typeof c=="string")d=function(p){let x=0;if(p.length===0)return x;for(let T=0;T<p.length;T++)x=(x<<5)-x+p.charCodeAt(T),x|=0;return x}(c);else{if(typeof c!="number")throw new rs(`Invalid seed input: ${c}`);d=c}return n+el(d)()*(o-n)}]});class ru{constructor(e,n,o,c){this.expression=e,this._warningHistory={},this._evaluator=new Lh(o,c),this._defaultValue=n?function(d){return d.type==="color"&&(mc(d.default)||Array.isArray(d.default))?new Ti(0,0,0,0):d.type==="color"?Ti.parse(d.default)||null:d.default===void 0?null:d.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null,this.configDependencies=qu(e)}evaluateWithoutErrorHandling(e,n,o,c,d,p,x,T){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=o,this._evaluator.canonical=c||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=p,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,o,c,d,p,x,T){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=o||null,this._evaluator.canonical=c||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=p||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=T||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new rs(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${S.message}`)),this._defaultValue}}}function Il(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in aa}function tl(i,e,n,o){const c=new Uu(aa,[],e?function(p){const x={color:Ho,string:Bi,number:pn,enum:Bi,boolean:Di,formatted:zu,resolvedImage:Rh};return p.type==="array"?fo(x[p.value]||Fi,p.length):x[p.type]}(e):void 0,void 0,void 0,n,o),d=c.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?ss(new ru(d,e,n,o)):Ys(c.errors)}class gc{constructor(e,n,o,c){this.kind=e,this._styleExpression=n,this.isLightConstant=o,this.isLineProgressConstant=c,this.isStateDependent=e!=="constant"&&!Vu(n.expression),this.configDependencies=qu(n.expression)}evaluateWithoutErrorHandling(e,n,o,c,d,p){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,c,d,p)}evaluate(e,n,o,c,d,p){return this._styleExpression.evaluate(e,n,o,c,d,p)}}class _c{constructor(e,n,o,c,d,p){this.kind=e,this.zoomStops=o,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Vu(n.expression),this.isLightConstant=d,this.isLineProgressConstant=p,this.configDependencies=qu(n.expression),this.interpolationType=c}evaluateWithoutErrorHandling(e,n,o,c,d,p){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,c,d,p)}evaluate(e,n,o,c,d,p){return this._styleExpression.evaluate(e,n,o,c,d,p)}interpolationFactor(e,n,o){return this.interpolationType?Fs.interpolationFactor(this.interpolationType,e,n,o):0}}function su(i,e,n,o){if((i=tl(i,e,n,o)).result==="error")return i;const c=i.value.expression,d=El(c);if(!d&&!Xu(e))return Ys([new qo("","data expressions not supported")]);const p=pc(c,["zoom","pitch","distance-from-center"]);if(!p&&!Kh(e))return Ys([new qo("","zoom expressions not supported")]);const x=pc(c,["measure-light"]);if(!x&&!Zh(e))return Ys([new qo("","measure-light expression not supported")]);const T=pc(c,["line-progress"]);if(!T&&!function(k){return Wh(k.expression,"line-progress")}(e))return Ys([new qo("","line-progress expression not supported")]);const S=e.expression&&e.expression.relaxZoomRestriction,P=vc(c);return P||p||S?P instanceof qo?Ys([P]):P instanceof Fs&&!Yu(e)?Ys([new qo("",'"interpolate" expressions cannot be used with this property')]):ss(P?new _c(d&&T?"camera":"composite",i.value,P.labels,P instanceof Fs?P.interpolation:void 0,x,T):new gc(d&&T?"constant":"source",i.value,x,T)):Ys([new qo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class yc{constructor(e,n){this._parameters=e,this._specification=n,$a(this,iu(this._parameters,this._specification))}static deserialize(e){return new yc(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function vc(i){let e=null;if(i instanceof Jc)e=vc(i.result);else if(i instanceof Xs){for(const n of i.args)if(e=vc(n),e)break}else(i instanceof Ka||i instanceof Fs)&&i.input instanceof vs&&i.input.name==="zoom"&&(e=i);return e instanceof qo||i.eachChild(n=>{const o=vc(n);o instanceof qo?e=o:e&&o&&e!==o&&(e=new qo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}var Ju,Yh,xc=function(){if(Yh)return Ju;Yh=1,Ju=e;var i=3;function e(n,o,c){var d=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var p=new Int32Array(this.arrayBuffer);n=p[0],this.d=(o=p[1])+2*(c=p[2]);for(var x=0;x<this.d*this.d;x++){var T=p[i+x],S=p[i+x+1];d.push(T===S?null:p.subarray(T,S))}var P=p[i+d.length+1];this.keys=p.subarray(p[i+d.length],P),this.bboxes=p.subarray(P),this.insert=this._insertReadonly}else{this.d=o+2*c;for(var k=0;k<this.d*this.d;k++)d.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=n,this.padding=c,this.scale=o/n,this.uid=0;var R=c/o*n;this.min=-R,this.max=n+R}return e.prototype.insert=function(n,o,c,d,p){this._forEachCell(o,c,d,p,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(p)},e.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},e.prototype._insertCell=function(n,o,c,d,p,x){this.cells[p].push(x)},e.prototype.query=function(n,o,c,d,p){var x=this.min,T=this.max;if(n<=x&&o<=x&&T<=c&&T<=d&&!p)return Array.prototype.slice.call(this.keys);var S=[];return this._forEachCell(n,o,c,d,this._queryCell,S,{},p),S},e.prototype._queryCell=function(n,o,c,d,p,x,T,S){var P=this.cells[p];if(P!==null)for(var k=this.keys,R=this.bboxes,B=0;B<P.length;B++){var j=P[B];if(T[j]===void 0){var $=4*j;(S?S(R[$+0],R[$+1],R[$+2],R[$+3]):n<=R[$+2]&&o<=R[$+3]&&c>=R[$+0]&&d>=R[$+1])?(T[j]=!0,x.push(k[j])):T[j]=!1}}},e.prototype._forEachCell=function(n,o,c,d,p,x,T,S){for(var P=this._convertToCellCoord(n),k=this._convertToCellCoord(o),R=this._convertToCellCoord(c),B=this._convertToCellCoord(d),j=P;j<=R;j++)for(var $=k;$<=B;$++){var K=this.d*$+j;if((!S||S(this._convertFromCellCoord(j),this._convertFromCellCoord($),this._convertFromCellCoord(j+1),this._convertFromCellCoord($+1)))&&p.call(this,n,o,c,d,K,x,T,S))return}},e.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},e.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},e.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,o=i+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;var p=new Int32Array(o+c+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var x=o,T=0;T<n.length;T++){var S=n[T];p[i+T]=x,p.set(S,x),x+=S.length}return p[i+n.length]=x,p.set(this.keys,x),p[i+n.length+1]=x+=this.keys.length,p.set(this.bboxes,x),x+=this.bboxes.length,p.buffer},Ju}(),As=qa(xc);const Ro={};function nn(i,e,n={}){Object.defineProperty(i,"_classRegistryKey",{value:e,writable:!1}),Ro[e]={klass:i,omit:n.omit||[]}}nn(Object,"Object"),As.serialize=function(i,e){const n=i.toArrayBuffer();return e&&e.add(n),{buffer:n}},As.deserialize=function(i){return new As(i.buffer)},Object.defineProperty(As,"name",{value:"Grid"}),nn(As,"Grid"),typeof DOMMatrix<"u"&&nn(DOMMatrix,"DOMMatrix"),nn(Ti,"Color"),nn(Error,"Error"),nn(mo,"Formatted"),nn(Pd,"FormattedSection"),nn(wi,"AJAXError"),nn(Po,"ResolvedImage"),nn(yc,"StylePropertyFunction"),nn(ru,"StyleExpression",{omit:["_evaluator"]}),nn(oo,"ImageId"),nn(bl,"ImageVariant"),nn(_c,"ZoomDependentExpression"),nn(gc,"ZoomConstantExpression"),nn(vs,"CompoundExpression",{omit:["_evaluate"]});for(const i in aa)Ro[aa[i]._classRegistryKey]||nn(aa[i],`Expression${i}`);function qp(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function nl(i){return self.ImageBitmap&&i instanceof ImageBitmap}function zo(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(qp(i)||nl(i))return e&&e.add(i),i;if(ArrayBuffer.isView(i))return e&&e.add(i.buffer),i;if(i instanceof ImageData)return e&&e.add(i.data.buffer),i;if(Array.isArray(i)){const n=[];for(const o of i)n.push(zo(o,e));return n}if(i instanceof Map){const n={$name:"Map",entries:[]};for(const[o,c]of i.entries())n.entries.push(zo(o),zo(c,e));return n}if(i instanceof Set){const n={$name:"Set"};let o=0;for(const c of i.values())n[++o]=zo(c);return n}if(i instanceof DOMMatrix){const n={$name:"DOMMatrix"},o=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const c of o)n[c]=i[c];return n}if(typeof i=="bigint")return{$name:"BigInt",value:i.toString()};if(typeof i=="object"){const n=i.constructor,o=n._classRegistryKey;if(!o)throw new Error(`Can't serialize object of unregistered class "${n.name}".`);const c=n.serialize?n.serialize(i,e):{};if(!n.serialize){for(const d in i)i.hasOwnProperty(d)&&(Ro[o].omit.indexOf(d)>=0||(c[d]=zo(i[d],e)));i instanceof Error&&(c.message=i.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(c.$name=o),c}throw new Error("can't serialize object of type "+typeof i)}function il(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||qp(i)||nl(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(il);if(typeof i=="object"){const e=i.$name||"Object";if(e==="Map"){const c=i.entries||[],d=new Map;for(let p=0;p<c.length;p+=2)d.set(il(c[p]),il(c[p+1]));return d}if(e==="Set"){const c=new Set;for(const d of Object.keys(i))d!=="$name"&&c.add(il(i[d]));return c}if(e==="DOMMatrix"){let c;return c=i.is2D?[i.a,i.b,i.c,i.d,i.e,i.f]:[i.m11,i.m12,i.m13,i.m14,i.m21,i.m22,i.m23,i.m24,i.m31,i.m32,i.m33,i.m34,i.m41,i.m42,i.m43,i.m44],new DOMMatrix(c)}if(e==="BigInt")return BigInt(i.value);const{klass:n}=Ro[e];if(!n)throw new Error(`Can't deserialize unregistered class "${e}".`);if(n.deserialize)return n.deserialize(i);const o=Object.create(n.prototype);for(const c of Object.keys(i))c!=="$name"&&(o[c]=il(i[c]));return o}throw new Error("can't deserialize object of type "+typeof i)}const wn={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519,Osage:i=>i>=66736&&i<=66815,"CJK Unified Ideographs Extension B":i=>i>=131072&&i<=173791};function la(i){for(const e of i)if(Zd(e.charCodeAt(0)))return!0;return!1}function bc(i){for(const e of i)if(!Wd(e.charCodeAt(0)))return!1;return!0}function Wd(i){return!(wn.Arabic(i)||wn["Arabic Supplement"](i)||wn["Arabic Extended-A"](i)||wn["Arabic Presentation Forms-A"](i)||wn["Arabic Presentation Forms-B"](i))}function Zd(i){return!(i!==746&&i!==747&&(i<4352||!(wn["Bopomofo Extended"](i)||wn.Bopomofo(i)||wn["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||wn["CJK Compatibility Ideographs"](i)||wn["CJK Compatibility"](i)||wn["CJK Radicals Supplement"](i)||wn["CJK Strokes"](i)||!(!wn["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||wn["CJK Unified Ideographs Extension A"](i)||wn["CJK Unified Ideographs"](i)||wn["Enclosed CJK Letters and Months"](i)||wn["Hangul Compatibility Jamo"](i)||wn["Hangul Jamo Extended-A"](i)||wn["Hangul Jamo Extended-B"](i)||wn["Hangul Jamo"](i)||wn["Hangul Syllables"](i)||wn.Hiragana(i)||wn["Ideographic Description Characters"](i)||wn.Kanbun(i)||wn["Kangxi Radicals"](i)||wn["Katakana Phonetic Extensions"](i)||wn.Katakana(i)&&i!==12540||!(!wn["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!wn["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||wn["Unified Canadian Aboriginal Syllabics"](i)||wn["Unified Canadian Aboriginal Syllabics Extended"](i)||wn["Vertical Forms"](i)||wn["Yijing Hexagram Symbols"](i)||wn["Yi Syllables"](i)||wn["Yi Radicals"](i))))}function Qh(i){return!(Zd(i)||function(e){return!!(wn["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||wn["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||wn["Letterlike Symbols"](e)||wn["Number Forms"](e)||wn["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||wn["Control Pictures"](e)&&e!==9251||wn["Optical Character Recognition"](e)||wn["Enclosed Alphanumerics"](e)||wn["Geometric Shapes"](e)||wn["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||wn["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||wn["CJK Symbols and Punctuation"](e)||wn.Katakana(e)||wn["Private Use Area"](e)||wn["CJK Compatibility Forms"](e)||wn["Small Form Variants"](e)||wn["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function jf(i){return wn.Arabic(i)||wn["Arabic Supplement"](i)||wn["Arabic Extended-A"](i)||wn["Arabic Presentation Forms-A"](i)||wn["Arabic Presentation Forms-B"](i)}function eh(i){return i>=1424&&i<=2303||wn["Arabic Presentation Forms-A"](i)||wn["Arabic Presentation Forms-B"](i)}function rl(i,e){return!(!e&&eh(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||wn.Khmer(i))}function Jh(i){for(const e of i)if(eh(e.charCodeAt(0)))return!0;return!1}const Qs={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let Pl=null,Js=Qs.unavailable,Xo=null;const wc=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(Js=Qs.error),Pl&&Pl(i)};function th(){ts.fire(new rc("pluginStateChange",{pluginStatus:Js,pluginURL:Xo}))}const ts=new sc,kl=function(){return Js},Kd=function(){if(Js!==Qs.deferred||!Xo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Js=Qs.loading,th(),Xo&&Ih({url:Xo},i=>{i?wc(i):(Js=Qs.loaded,th())})},Ra={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Js===Qs.loaded||Ra.applyArabicShaping!=null,isLoading:()=>Js===Qs.loading,setState(i){Js=i.pluginStatus,Xo=i.pluginURL},isParsing:()=>Js===Qs.parsing,isParsed:()=>Js===Qs.parsed,getPluginURL:()=>Xo};class ji{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch,this.brightness=n.brightness,this.worldview=n.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(n,o){for(const c of n)if(!rl(c.charCodeAt(0),o))return!1;return!0}(e,Ra.isLoaded())}}class ou{constructor(e,n,o,c){this.property=e,this.value=n,this.expression=function(d,p,x,T){if(mc(d))return new yc(d,p);if(Il(d)||Array.isArray(d)&&d.length>0){const S=su(d,p,x,T);if(S.result==="error")throw new Error(S.value.map(P=>`${P.key}: ${P.message}`).join(", "));return S.value}{let S=d;return typeof d=="string"&&p.type==="color"&&(S=Ti.parse(d)),{kind:"constant",configDependencies:new Set,evaluate:()=>S}}}(n===void 0?e.specification.default:n,e.specification,o,c)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,o){return this.property.possiblyEvaluate(this,e,n,o)}}class Yo{constructor(e,n,o){this.property=e,this.value=new ou(e,void 0,n,o)}transitioned(e,n){return new Is(this.property,this.value,n,tt({},e.transition,this.transition),e.now)}untransitioned(){return new Is(this.property,this.value,null,{},0)}}class us{constructor(e,n,o){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=n,this._options=o,this.configDependencies=new Set}getValue(e){return Ln(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Yo(this._values[e].property,this._scope,this._options)),this._values[e].value=new ou(this._values[e].property,n===null?void 0:Ln(n),this._scope,this._options),this._values[e].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].value.expression.configDependencies]))}setTransitionOrValue(e,n){n&&(this._options=n);const o=this._properties.properties;if(e)for(const c in e){const d=e[c];if(c.endsWith("-transition")){const p=c.slice(0,-11);o[p]&&this.setTransition(p,d)}else o.hasOwnProperty(c)&&this.setValue(c,d)}}getTransition(e){return Ln(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Yo(this._values[e].property)),this._values[e].transition=Ln(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o);const c=this.getTransition(n);c!==void 0&&(e[`${n}-transition`]=c)}return e}transitioned(e,n){const o=new Ns(this._properties);for(const c of Object.keys(this._values))o._values[c]=this._values[c].transitioned(e,n._values[c]);return o}untransitioned(){const e=new Ns(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class Is{constructor(e,n,o,c,d){const p=c.delay||0,x=c.duration||0;d=d||0,this.property=e,this.value=n,this.begin=d+p,this.end=this.begin+x,e.specification.transition&&(c.delay||c.duration)&&(this.prior=o)}possiblyEvaluate(e,n,o){const c=e.now||0,d=this.value.possiblyEvaluate(e,n,o),p=this.prior;if(p){if(c>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(c<this.begin)return p.possiblyEvaluate(e,n,o);{const x=(c-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(e,n,o),d,oe(x))}}return d}}class Ns{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,o){const c=new za(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].possiblyEvaluate(e,n,o);return c}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Xd{constructor(e,n,o){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=n,this._options=o,this.configDependencies=new Set}getValue(e){return Ln(this._values[e].value)}setValue(e,n){this._values[e]=new ou(this._values[e].property,n===null?void 0:Ln(n),this._scope,this._options),this._values[e].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].expression.configDependencies]))}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o)}return e}possiblyEvaluate(e,n,o){const c=new za(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].possiblyEvaluate(e,n,o);return c}}class sl{constructor(e,n,o){this.property=e,this.value=n,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,o,c){return this.property.evaluate(this.value,this.parameters,e,n,o,c)}}class za{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ot{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,o){const c=vl[this.specification.type];return c?c(e,n,o):e}}class Zt{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,o,c){return new sl(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},o,c)}:e.expression,n)}interpolate(e,n,o){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new sl(this,{kind:"constant",value:void 0},e.parameters);const c=vl[this.specification.type];return c?new sl(this,{kind:"constant",value:c(e.value.value,n.value.value,o)},e.parameters):e}evaluate(e,n,o,c,d,p){return e.kind==="constant"?e.value:e.evaluate(n,o,c,d,p)}}class Ml{constructor(e){this.specification=e}possiblyEvaluate(e,n,o,c){return!!e.expression.evaluate(n,null,{},o,c)}interpolate(){return!1}}class Er{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new ji(0,{});for(const o in e){const c=e[o];c.specification.overridable&&this.overridableProperties.push(o);const d=this.defaultPropertyValues[o]=new ou(c,void 0),p=this.defaultTransitionablePropertyValues[o]=new Yo(c);this.defaultTransitioningPropertyValues[o]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=d.possiblyEvaluate(n)}}}nn(Zt,"DataDrivenProperty"),nn(Ot,"DataConstantProperty"),nn(Ml,"ColorRampProperty");var Xe=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-wall-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function Ps(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Lo(i){if(Array.isArray(i))return i.map(Lo);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const n in i)e[n]=Lo(i[n]);return e}return Ps(i)}function Tc(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!Tc(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function ed(i,e="",n=null,o="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Tc(i)||(i=td(i));const c=i;let d=!0;try{d=function(P){if(!au(P))return P;let k=Lo(P);return Hp(k),k=Yd(k),k}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(c,null,2)}
        `)}let p=null,x=null;if(o!=="background"&&o!=="sky"&&o!=="slot"){x=Xe[`filter_${o}`];const P=tl(d,x,e,n);if(P.result==="error")throw new Error(P.value.map(k=>`${k.key}: ${k.message}`).join(", "));p=(k,R,B)=>P.value.evaluate(k,R,{},B)}let T=null,S=null;if(d!==c){const P=tl(c,x,e,n);if(P.result==="error")throw new Error(P.value.map(k=>`${k.key}: ${k.message}`).join(", "));T=(k,R,B,j,$)=>P.value.evaluate(k,R,{},B,void 0,void 0,j,$),S=!El(P.value.expression)}return{filter:p,dynamicFilter:T||void 0,needGeometry:Up(d),needFeature:!!S}}function Yd(i){if(!Array.isArray(i))return i;const e=function(n){if(Nf.has(n[0])){for(let o=1;o<n.length;o++)if(au(n[o]))return!0}return n}(i);return e===!0?e:e.map(n=>Yd(n))}function Hp(i){let e=!1;const n=[];if(i[0]==="case"){for(let o=1;o<i.length-1;o+=2)e=e||au(i[o]),n.push(i[o+1]);n.push(i[i.length-1])}else if(i[0]==="match"){e=e||au(i[1]);for(let o=2;o<i.length-1;o+=2)n.push(i[o+1]);n.push(i[i.length-1])}else if(i[0]==="step"){e=e||au(i[1]);for(let o=1;o<i.length-1;o+=2)n.push(i[o+1])}e&&(i.length=0,i.push("any",...n));for(let o=1;o<i.length;o++)Hp(i[o])}function au(i){if(!Array.isArray(i))return!1;if((e=i[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<i.length;n++)if(au(i[n]))return!0;return!1}const Nf=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Vf(i,e){return i<e?-1:i>e?1:0}function Up(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let e=1;e<i.length;e++)if(Up(i[e]))return!0;return!1}function td(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?Qd(i[1],i[2],"=="):e==="!="?nd(Qd(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Qd(i[1],i[2],e):e==="any"?(n=i.slice(1),["any"].concat(n.map(td))):e==="all"?["all"].concat(i.slice(1).map(td)):e==="none"?["all"].concat(i.slice(1).map(td).map(nd)):e==="in"?Jd(i[1],i.slice(2)):e==="!in"?nd(Jd(i[1],i.slice(2))):e==="has"?nh(i[1]):e!=="!has"||nd(nh(i[1]));var n}function Qd(i,e,n){switch(i){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,i,e]}}function Jd(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",i,["literal",e.sort(Vf)]]:["filter-in-small",i,["literal",e]]}}function nh(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function nd(i){return["!",i]}const Sc="";function ol(i,e){return e?`${i}${Sc}${e}`:i}const ep="-transition",al=new Set(["fill","line","background","hillshade","raster"]);class eo extends sc{constructor(e,n,o,c,d){if(super(),this.id=e.id,this.fqid=ol(this.id,o),this.type=e.type,this.scope=o,this.lut=c,this.options=d,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,e.type!=="custom"){if(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type&&e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"){this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter;const p=tl(this.filter,Xe[`filter_${e.type}`]);p.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...p.value.configDependencies]))}if(e.slot&&(this.slot=e.slot),n.layout&&(this._unevaluatedLayout=new Xd(n.layout,this.scope,d),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),n.paint){this._transitionablePaint=new us(n.paint,this.scope,d);for(const p in e.paint)this.setPaintProperty(p,e.paint[p]);for(const p in e.layout)this.setLayoutProperty(p,e.layout[p]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new za(n.paint)}}}onAdd(e){}onRemove(e){}isDraped(e){return!this.is3D(!0)&&al.has(this.type)}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n){if(this.type==="custom"&&e==="visibility")return void(this.visibility=n);const o=this._unevaluatedLayout;o._properties.properties[e]&&(o.setValue(e,n),this.configDependencies=new Set([...this.configDependencies,...o.configDependencies]),e==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(e){return e.endsWith(ep)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n){const o=this._transitionablePaint,c=o._properties.properties;if(e.endsWith(ep)){const k=e.slice(0,-11);return c[k]&&o.setTransition(k,n||void 0),!1}if(!c[e])return!1;const d=o._values[e],p=d.value.isDataDriven(),x=d.value;o.setValue(e,n),this.configDependencies=new Set([...this.configDependencies,...o.configDependencies]),this._handleSpecialPaintPropertyUpdate(e);const T=o._values[e].value,S=T.isDataDriven(),P=e.endsWith("pattern")||e==="line-dasharray";return S||p||P||this._handleOverridablePaintPropertyUpdate(e,x,T)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,n,o){return null}_handleOverridablePaintPropertyUpdate(e,n,o){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){return Rn({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,n)=>!(e===void 0||n==="layout"&&!Object.keys(e).length||n==="paint"&&!Object.keys(e).length))}is3D(e){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof sl&&Xu(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(e){this._filterCompiled||(this._featureFilter=ed(this.filter,this.scope,e),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&(e.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(e){}queryIntersectsFeature(e,n,o,c,d,p,x,T,S){}}const qf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ih{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class lr{constructor(){this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&n.add(e.arrayBuffer),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...e){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...e){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function xi(i,e=1){let n=0,o=0;return{members:i.map(c=>{const d=qf[c.type].BYTES_PER_ELEMENT,p=n=tp(n,Math.max(e,d)),x=c.components||1;return o=Math.max(o,d),n+=d*x,{name:c.name,type:c.type,components:x,offset:p}}),size:tp(n,Math.max(o,e)),alignment:e}}function tp(i,e){return Math.ceil(i/e)*e}class ll extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const c=2*e;return this.int16[c+0]=n,this.int16[c+1]=o,e}}ll.prototype.bytesPerElement=4,nn(ll,"StructArrayLayout2i4");class rh extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,n,o)}emplace(e,n,o,c){const d=3*e;return this.int16[d+0]=n,this.int16[d+1]=o,this.int16[d+2]=c,e}}rh.prototype.bytesPerElement=6,nn(rh,"StructArrayLayout3i6");class sh extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,o,c)}emplace(e,n,o,c,d){const p=4*e;return this.int16[p+0]=n,this.int16[p+1]=o,this.int16[p+2]=c,this.int16[p+3]=d,e}}sh.prototype.bytesPerElement=8,nn(sh,"StructArrayLayout4i8");class Rl extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Rl.prototype.bytesPerElement=4,nn(Rl,"StructArrayLayout1f4");class $p extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,n,o)}emplace(e,n,o,c){const d=4*e,p=2*e;return this.int16[d+0]=n,this.int16[d+1]=o,this.float32[p+1]=c,e}}$p.prototype.bytesPerElement=8,nn($p,"StructArrayLayout2i1f8");class np extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,n,o)}emplace(e,n,o,c){const d=4*e;return this.int16[d+0]=n,this.int16[d+1]=o,this.int16[d+2]=c,e}}np.prototype.bytesPerElement=8,nn(np,"StructArrayLayout3i8");class lu extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,o,c,d)}emplace(e,n,o,c,d,p){const x=5*e;return this.int16[x+0]=n,this.int16[x+1]=o,this.int16[x+2]=c,this.int16[x+3]=d,this.int16[x+4]=p,e}}lu.prototype.bytesPerElement=10,nn(lu,"StructArrayLayout5i10");class ip extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x){const T=this.length;return this.resize(T+1),this.emplace(T,e,n,o,c,d,p,x)}emplace(e,n,o,c,d,p,x,T){const S=6*e,P=12*e,k=3*e;return this.int16[S+0]=n,this.int16[S+1]=o,this.uint8[P+4]=c,this.uint8[P+5]=d,this.uint8[P+6]=p,this.uint8[P+7]=x,this.float32[k+2]=T,e}}ip.prototype.bytesPerElement=12,nn(ip,"StructArrayLayout2i4ub1f12");class La extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,n,o)}emplace(e,n,o,c){const d=3*e;return this.float32[d+0]=n,this.float32[d+1]=o,this.float32[d+2]=c,e}}La.prototype.bytesPerElement=12,nn(La,"StructArrayLayout3f12");class Da extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,o,c,d)}emplace(e,n,o,c,d,p){const x=6*e,T=3*e;return this.uint16[x+0]=n,this.uint16[x+1]=o,this.uint16[x+2]=c,this.uint16[x+3]=d,this.float32[T+2]=p,e}}Da.prototype.bytesPerElement=12,nn(Da,"StructArrayLayout4ui1f12");class id extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,o,c)}emplace(e,n,o,c,d){const p=4*e;return this.uint16[p+0]=n,this.uint16[p+1]=o,this.uint16[p+2]=c,this.uint16[p+3]=d,e}}id.prototype.bytesPerElement=8,nn(id,"StructArrayLayout4ui8");class rp extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,o,c,d,p)}emplace(e,n,o,c,d,p,x){const T=6*e;return this.int16[T+0]=n,this.int16[T+1]=o,this.int16[T+2]=c,this.int16[T+3]=d,this.int16[T+4]=p,this.int16[T+5]=x,e}}rp.prototype.bytesPerElement=12,nn(rp,"StructArrayLayout6i12");class oh extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x,T,S,P,k,R){const B=this.length;return this.resize(B+1),this.emplace(B,e,n,o,c,d,p,x,T,S,P,k,R)}emplace(e,n,o,c,d,p,x,T,S,P,k,R,B){const j=12*e;return this.int16[j+0]=n,this.int16[j+1]=o,this.int16[j+2]=c,this.int16[j+3]=d,this.uint16[j+4]=p,this.uint16[j+5]=x,this.uint16[j+6]=T,this.uint16[j+7]=S,this.int16[j+8]=P,this.int16[j+9]=k,this.int16[j+10]=R,this.int16[j+11]=B,e}}oh.prototype.bytesPerElement=24,nn(oh,"StructArrayLayout4i4ui4i24");class _o extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,o,c,d,p)}emplace(e,n,o,c,d,p,x){const T=10*e,S=5*e;return this.int16[T+0]=n,this.int16[T+1]=o,this.int16[T+2]=c,this.float32[S+2]=d,this.float32[S+3]=p,this.float32[S+4]=x,e}}_o.prototype.bytesPerElement=20,nn(_o,"StructArrayLayout3i3f20");class bs extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,o,c)}emplace(e,n,o,c,d){const p=4*e;return this.float32[p+0]=n,this.float32[p+1]=o,this.float32[p+2]=c,this.float32[p+3]=d,e}}bs.prototype.bytesPerElement=16,nn(bs,"StructArrayLayout4f16");class zl extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}zl.prototype.bytesPerElement=4,nn(zl,"StructArrayLayout1ul4");class Ll extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const c=2*e;return this.uint16[c+0]=n,this.uint16[c+1]=o,e}}Ll.prototype.bytesPerElement=4,nn(Ll,"StructArrayLayout2ui4");class sp extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x,T,S,P,k,R,B){const j=this.length;return this.resize(j+1),this.emplace(j,e,n,o,c,d,p,x,T,S,P,k,R,B)}emplace(e,n,o,c,d,p,x,T,S,P,k,R,B,j){const $=20*e,K=10*e;return this.int16[$+0]=n,this.int16[$+1]=o,this.int16[$+2]=c,this.int16[$+3]=d,this.int16[$+4]=p,this.float32[K+3]=x,this.float32[K+4]=T,this.float32[K+5]=S,this.float32[K+6]=P,this.int16[$+14]=k,this.uint32[K+8]=R,this.uint16[$+18]=B,this.uint16[$+19]=j,e}}sp.prototype.bytesPerElement=40,nn(sp,"StructArrayLayout5i4f1i1ul2ui40");class rd extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x){const T=this.length;return this.resize(T+1),this.emplace(T,e,n,o,c,d,p,x)}emplace(e,n,o,c,d,p,x,T){const S=8*e;return this.int16[S+0]=n,this.int16[S+1]=o,this.int16[S+2]=c,this.int16[S+4]=d,this.int16[S+5]=p,this.int16[S+6]=x,this.int16[S+7]=T,e}}rd.prototype.bytesPerElement=16,nn(rd,"StructArrayLayout3i2i2i16");class sd extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,o,c,d)}emplace(e,n,o,c,d,p){const x=4*e,T=8*e;return this.float32[x+0]=n,this.float32[x+1]=o,this.float32[x+2]=c,this.int16[T+6]=d,this.int16[T+7]=p,e}}sd.prototype.bytesPerElement=16,nn(sd,"StructArrayLayout2f1f2i16");class cl extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,o,c,d,p)}emplace(e,n,o,c,d,p,x){const T=20*e,S=5*e;return this.uint8[T+0]=n,this.uint8[T+1]=o,this.float32[S+1]=c,this.float32[S+2]=d,this.float32[S+3]=p,this.float32[S+4]=x,e}}cl.prototype.bytesPerElement=20,nn(cl,"StructArrayLayout2ub4f20");class ws extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,n,o)}emplace(e,n,o,c){const d=3*e;return this.uint16[d+0]=n,this.uint16[d+1]=o,this.uint16[d+2]=c,e}}ws.prototype.bytesPerElement=6,nn(ws,"StructArrayLayout3ui6");class cu extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K,ee,le,ce,W,ae){const he=this.length;return this.resize(he+1),this.emplace(he,e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K,ee,le,ce,W,ae)}emplace(e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K,ee,le,ce,W,ae,he){const ge=30*e,Be=15*e,ke=60*e;return this.int16[ge+0]=n,this.int16[ge+1]=o,this.int16[ge+2]=c,this.float32[Be+2]=d,this.float32[Be+3]=p,this.uint16[ge+8]=x,this.uint16[ge+9]=T,this.uint32[Be+5]=S,this.uint32[Be+6]=P,this.uint32[Be+7]=k,this.uint16[ge+16]=R,this.uint16[ge+17]=B,this.uint16[ge+18]=j,this.float32[Be+10]=$,this.float32[Be+11]=K,this.uint8[ke+48]=ee,this.uint8[ke+49]=le,this.uint8[ke+50]=ce,this.uint32[Be+13]=W,this.int16[ge+28]=ae,this.uint8[ke+58]=he,e}}cu.prototype.bytesPerElement=60,nn(cu,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Gp extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K,ee,le,ce,W,ae,he,ge,Be,ke,je,Ze,ut,Rt,wt,Mt,Dt,dt){const Pt=this.length;return this.resize(Pt+1),this.emplace(Pt,e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K,ee,le,ce,W,ae,he,ge,Be,ke,je,Ze,ut,Rt,wt,Mt,Dt,dt)}emplace(e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K,ee,le,ce,W,ae,he,ge,Be,ke,je,Ze,ut,Rt,wt,Mt,Dt,dt,Pt){const ct=20*e,ht=40*e,Nt=80*e;return this.float32[ct+0]=n,this.float32[ct+1]=o,this.int16[ht+4]=c,this.int16[ht+5]=d,this.int16[ht+6]=p,this.int16[ht+7]=x,this.int16[ht+8]=T,this.int16[ht+9]=S,this.int16[ht+10]=P,this.int16[ht+11]=k,this.int16[ht+12]=R,this.uint16[ht+13]=B,this.uint16[ht+14]=j,this.uint16[ht+15]=$,this.uint16[ht+16]=K,this.uint16[ht+17]=ee,this.uint16[ht+18]=le,this.uint16[ht+19]=ce,this.uint16[ht+20]=W,this.uint16[ht+21]=ae,this.uint16[ht+22]=he,this.uint16[ht+23]=ge,this.uint16[ht+24]=Be,this.uint16[ht+25]=ke,this.uint16[ht+26]=je,this.uint16[ht+27]=Ze,this.uint32[ct+14]=ut,this.float32[ct+15]=Rt,this.float32[ct+16]=wt,this.float32[ct+17]=Mt,this.float32[ct+18]=Dt,this.uint8[Nt+76]=dt,this.uint16[ht+39]=Pt,e}}Gp.prototype.bytesPerElement=80,nn(Gp,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class op extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,o,c,d,p)}emplace(e,n,o,c,d,p,x){const T=6*e;return this.float32[T+0]=n,this.float32[T+1]=o,this.float32[T+2]=c,this.float32[T+3]=d,this.float32[T+4]=p,this.float32[T+5]=x,e}}op.prototype.bytesPerElement=24,nn(op,"StructArrayLayout6f24");class Dl extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,o,c,d)}emplace(e,n,o,c,d,p){const x=5*e;return this.float32[x+0]=n,this.float32[x+1]=o,this.float32[x+2]=c,this.float32[x+3]=d,this.float32[x+4]=p,e}}Dl.prototype.bytesPerElement=20,nn(Dl,"StructArrayLayout5f20");class ah extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x){const T=this.length;return this.resize(T+1),this.emplace(T,e,n,o,c,d,p,x)}emplace(e,n,o,c,d,p,x,T){const S=7*e;return this.float32[S+0]=n,this.float32[S+1]=o,this.float32[S+2]=c,this.float32[S+3]=d,this.float32[S+4]=p,this.float32[S+5]=x,this.float32[S+6]=T,e}}ah.prototype.bytesPerElement=28,nn(ah,"StructArrayLayout7f28");class ap extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x,T,S,P,k){const R=this.length;return this.resize(R+1),this.emplace(R,e,n,o,c,d,p,x,T,S,P,k)}emplace(e,n,o,c,d,p,x,T,S,P,k,R){const B=11*e;return this.float32[B+0]=n,this.float32[B+1]=o,this.float32[B+2]=c,this.float32[B+3]=d,this.float32[B+4]=p,this.float32[B+5]=x,this.float32[B+6]=T,this.float32[B+7]=S,this.float32[B+8]=P,this.float32[B+9]=k,this.float32[B+10]=R,e}}ap.prototype.bytesPerElement=44,nn(ap,"StructArrayLayout11f44");class od extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x,T,S){const P=this.length;return this.resize(P+1),this.emplace(P,e,n,o,c,d,p,x,T,S)}emplace(e,n,o,c,d,p,x,T,S,P){const k=9*e;return this.float32[k+0]=n,this.float32[k+1]=o,this.float32[k+2]=c,this.float32[k+3]=d,this.float32[k+4]=p,this.float32[k+5]=x,this.float32[k+6]=T,this.float32[k+7]=S,this.float32[k+8]=P,e}}od.prototype.bytesPerElement=36,nn(od,"StructArrayLayout9f36");class uu extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const c=2*e;return this.float32[c+0]=n,this.float32[c+1]=o,e}}uu.prototype.bytesPerElement=8,nn(uu,"StructArrayLayout2f8");class yo extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,o,c)}emplace(e,n,o,c,d){const p=6*e;return this.uint32[3*e+0]=n,this.uint16[p+2]=o,this.uint16[p+3]=c,this.uint16[p+4]=d,e}}yo.prototype.bytesPerElement=12,nn(yo,"StructArrayLayout1ul3ui12");class Vs extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}Vs.prototype.bytesPerElement=2,nn(Vs,"StructArrayLayout1ui2");class hu extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K){const ee=this.length;return this.resize(ee+1),this.emplace(ee,e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K)}emplace(e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K,ee){const le=16*e;return this.float32[le+0]=n,this.float32[le+1]=o,this.float32[le+2]=c,this.float32[le+3]=d,this.float32[le+4]=p,this.float32[le+5]=x,this.float32[le+6]=T,this.float32[le+7]=S,this.float32[le+8]=P,this.float32[le+9]=k,this.float32[le+10]=R,this.float32[le+11]=B,this.float32[le+12]=j,this.float32[le+13]=$,this.float32[le+14]=K,this.float32[le+15]=ee,e}}hu.prototype.bytesPerElement=64,nn(hu,"StructArrayLayout16f64");class lh extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,c,d,p,x){const T=this.length;return this.resize(T+1),this.emplace(T,e,n,o,c,d,p,x)}emplace(e,n,o,c,d,p,x,T){const S=10*e,P=5*e;return this.uint16[S+0]=n,this.uint16[S+1]=o,this.uint16[S+2]=c,this.uint16[S+3]=d,this.float32[P+2]=p,this.float32[P+3]=x,this.float32[P+4]=T,e}}lh.prototype.bytesPerElement=20,nn(lh,"StructArrayLayout4ui3f20");class lp extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.int16[1*e+0]=n,e}}lp.prototype.bytesPerElement=2,nn(lp,"StructArrayLayout1i2");class ad extends lr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint8[1*e+0]=n,e}}ad.prototype.bytesPerElement=1,nn(ad,"StructArrayLayout1ub1");class Wp extends ih{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Wp.prototype.size=40;class ch extends sp{get(e){return new Wp(this,e)}}nn(ch,"CollisionBoxArray");class Zp extends ih{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Zp.prototype.size=60;class cp extends cu{get(e){return new Zp(this,e)}}nn(cp,"PlacedSymbolArray");class Kp extends ih{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}Kp.prototype.size=80;class Xp extends Gp{get(e){return new Kp(this,e)}}nn(Xp,"SymbolInstanceArray");class ld extends Rl{getoffsetX(e){return this.float32[1*e+0]}}nn(ld,"GlyphOffsetArray");class up extends ll{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}nn(up,"SymbolLineVertexArray");class Yp extends ih{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Yp.prototype.size=12;class hp extends yo{get(e){return new Yp(this,e)}}nn(hp,"FeatureIndexArray");class cd extends Ll{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}nn(cd,"FillExtrusionCentroidArray");class Hf extends ih{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Hf.prototype.size=6;class Qp extends rh{get(e){return new Hf(this,e)}}nn(Qp,"FillExtrusionWallArray");const Jp=xi([{name:"a_pos",components:2,type:"Int16"}],4),Uf=xi([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),du=xi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Qi{constructor(e=[]){this.segments=e}_prepareSegment(e,n,o,c){let d=this.segments[this.segments.length-1];return e>Qi.MAX_VERTEX_ARRAY_LENGTH&&Un(`Max vertices per segment is ${Qi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!d||d.vertexLength+e>Qi.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==c)&&(d={vertexOffset:n,primitiveOffset:o,vertexLength:0,primitiveLength:0},c!==void 0&&(d.sortKey=c),this.segments.push(d)),d}prepareSegment(e,n,o,c){return this._prepareSegment(e,n.length,o.length,c)}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,o,c){return new Qi([{vertexOffset:e,primitiveOffset:n,vertexLength:o,primitiveLength:c,vaos:{},sortKey:0}])}}function $f(i,e){return 256*(i=Ce(Math.floor(i),0,255))+Ce(Math.floor(e),0,255)}Qi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nn(Qi,"SegmentVector");const ud=xi([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),hd=xi([{name:"a_pattern_b",components:4,type:"Uint16"}]),ef=xi([{name:"a_dash",components:4,type:"Uint16"}]);class uh{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,n,o,c){this.ids.push(pu(e)),this.positions.push(n,o,c)}eachPosition(e,n){const o=pu(e);let c=0,d=this.ids.length-1;for(;c<d;){const p=c+d>>1;this.ids[p]>=o?d=p:c=p+1}for(;this.ids[c]===o;)n(this.positions[3*c],this.positions[3*c+1],this.positions[3*c+2]),c++}static serialize(e,n){const o=new Float64Array(e.ids),c=new Uint32Array(e.positions);return qs(o,c,0,o.length-1),n&&(n.add(o.buffer),n.add(c.buffer)),{ids:o,positions:c}}static deserialize(e){const n=new uh;let o;n.ids=e.ids,n.positions=e.positions;for(const c of n.ids)c!==o&&n.uniqueIds.push(c),o=c;return n.indexed=!0,n}}function pu(i){const e=+i;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:jc(String(i))}function qs(i,e,n,o){for(;n<o;){const c=i[n+o>>1];let d=n-1,p=o+1;for(;;){do d++;while(i[d]<c);do p--;while(i[p]>c);if(d>=p)break;dd(i,d,p),dd(e,3*d,3*p),dd(e,3*d+1,3*p+1),dd(e,3*d+2,3*p+2)}p-n<o-p?(qs(i,e,n,p),n=p+1):(qs(i,e,p+1,o),o=p)}}function dd(i,e,n){const o=i[e];i[e]=i[n],i[n]=o}nn(uh,"FeaturePositionMap");class Ol{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}set(e,n,o){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class fu extends Ol{constructor(e){super(e),this.current=0}set(e,n,o){this.fetchUniformLocation(e,n)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}}class Ui extends Ol{constructor(e){super(e),this.current=0}set(e,n,o){this.fetchUniformLocation(e,n)&&this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class ul extends Ol{constructor(e){super(e),this.current=[0,0]}set(e,n,o){this.fetchUniformLocation(e,n)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}}class Fn extends Ol{constructor(e){super(e),this.current=[0,0,0]}set(e,n,o){this.fetchUniformLocation(e,n)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}}class Bl extends Ol{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,o){this.fetchUniformLocation(e,n)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3])))}}class dp extends Ol{constructor(e){super(e),this.current=Ti.transparent.toPremultipliedRenderColor(null)}set(e,n,o){this.fetchUniformLocation(e,n)&&(o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a)))}}const Gf=new Float32Array(16);class hh extends Ol{constructor(e){super(e),this.current=Gf}set(e,n,o){if(this.fetchUniformLocation(e,n)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let c=1;c<16;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}}const mu=new Float32Array(9),ca=new Float32Array(4);class gu extends Ol{constructor(e){super(e),this.current=ca}set(e,n,o){if(this.fetchUniformLocation(e,n)){for(let c=0;c<4;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}}}function pp(i){return[$f(255*i.r,255*i.g),$f(255*i.b,255*i.a)]}class dh{constructor(e,n,o,c){this.value=e,this.uniformNames=n.map(d=>`u_${d}`),this.type=o,this.context=c}setUniform(e,n,o,c,d){const p=c.constantOr(this.value);n.set(e,d,p instanceof Ti?p.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):p)}getBinding(e,n){return this.type==="color"?new dp(e):new Ui(e)}}class _u{constructor(e,n){this.uniformNames=n.map(o=>`u_${o}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(e,n){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br),this.patternTransition=n?n.tl.concat(n.br):this.pattern}setUniform(e,n,o,c,d){let p=null;d!=="u_pattern"&&d!=="u_dash"||(p=this.pattern),d==="u_pattern_b"&&(p=this.patternTransition),d==="u_pixel_ratio"&&(p=this.pixelRatio),p&&n.set(e,d,p)}getBinding(e,n){return n==="u_pattern"||n==="u_pattern_b"||n==="u_dash"?new Bl(e):new Ui(e)}}class Oa{constructor(e,n,o,c){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=n.map(d=>({name:`a_${d}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new c}populatePaintArray(e,n,o,c,d,p,x,T){const S=this.paintVertexArray.length,P=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new ji(0,{brightness:p,worldview:T}),n,{},d,c,x):this.expression.kind==="constant"&&this.expression.value,k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ji(0,{brightness:p,worldview:T}),n,{},d,c,x):this.lutExpression.value)==="none";this.paintVertexArray.resize(e),this._setPaintValue(S,e,P,k?null:this.context.lut)}updatePaintArray(e,n,o,c,d,p,x,T){const S=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:x,worldview:T},o,c,void 0,d):this.expression.kind==="constant"&&this.expression.value,P=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ji(0,{brightness:x,worldview:T}),o,c,void 0,d):this.lutExpression.value)==="none";this._setPaintValue(e,n,S,P?null:this.context.lut)}_setPaintValue(e,n,o,c){if(this.type==="color"){const d=pp(o.toPremultipliedRenderColor(c));for(let p=e;p<n;p++)this.paintVertexArray.emplace(p,d[0],d[1])}else{for(let d=e;d<n;d++)this.paintVertexArray.emplace(d,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ua{constructor(e,n,o,c,d,p){this.expression=e,this.uniformNames=n.map(x=>`u_${x}_t`),this.type=o,this.useIntegerZoom=c,this.context=d,this.maxValue=0,this.paintVertexAttributes=n.map(x=>({name:`a_${x}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new p}populatePaintArray(e,n,o,c,d,p,x,T){const S=this.expression.evaluate(new ji(this.context.zoom,{brightness:p,worldview:T}),n,{},d,c,x),P=this.expression.evaluate(new ji(this.context.zoom+1,{brightness:p,worldview:T}),n,{},d,c,x),k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ji(0,{brightness:p,worldview:T}),n,{},d,c,x):this.lutExpression.value)==="none",R=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(R,e,S,P,k?null:this.context.lut)}updatePaintArray(e,n,o,c,d,p,x,T){const S=this.expression.evaluate({zoom:this.context.zoom,brightness:x,worldview:T},o,c,void 0,d),P=this.expression.evaluate({zoom:this.context.zoom+1,brightness:x,worldview:T},o,c,void 0,d),k=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ji(0,{brightness:x,worldview:T}),o,c,void 0,d):this.lutExpression.value)==="none";this._setPaintValue(e,n,S,P,k?null:this.context.lut)}_setPaintValue(e,n,o,c,d){if(this.type==="color"){const p=pp(o.toPremultipliedRenderColor(d)),x=pp(o.toPremultipliedRenderColor(d));for(let T=e;T<n;T++)this.paintVertexArray.emplace(T,p[0],p[1],x[0],x[1])}else{for(let p=e;p<n;p++)this.paintVertexArray.emplace(p,o,c);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(c))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,o,c,d){const p=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,x=Ce(this.expression.interpolationFactor(p,this.context.zoom,this.context.zoom+1),0,1);n.set(e,d,x)}getBinding(e,n){return new Ui(e)}}class qr{constructor(e,n,o,c,d){this.expression=e,this.layerId=d,this.paintVertexAttributes=(o==="array"?ef:ud).members;for(let p=0;p<n.length;++p);this.paintVertexArray=new c,this.paintTransitionVertexArray=new id}populatePaintArray(e,n,o,c){const d=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(d,e,n.patterns&&n.patterns[this.layerId],o)}updatePaintArray(e,n,o,c,d,p,x){this._setPaintValues(e,n,o.patterns&&o.patterns[this.layerId],p)}_setPaintValues(e,n,o,c){if(!c||!o)return;const d=c[o[0]],p=c[o[1]];if(d){if(d){const{tl:x,br:T,pixelRatio:S}=d;for(let P=e;P<n;P++)this.paintVertexArray.emplace(P,x[0],x[1],T[0],T[1],S)}if(p){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:x,br:T}=p;for(let S=e;S<n;S++)this.paintTransitionVertexArray.emplace(S,x[0],x[1],T[0],T[1])}}}upload(e){const n=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,n)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=e.createVertexBuffer(this.paintTransitionVertexArray,hd.members,n))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class vo{constructor(e,n,o=()=>!0){this.binders={},this._buffers=[],this.context=n;const c=[];for(const d in e.paint._values){const p=e.paint.get(d);if(d.endsWith("-use-theme")||!o(d)||!(p instanceof sl&&Xu(p.property.specification)))continue;const x=s(d,e.type),T=p.value,S=p.property.specification.type,P=!!p.property.useIntegerZoom,k=d==="line-dasharray"||d.endsWith("pattern"),R=e.paint.get(`${d}-use-theme`),B=d==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant"||R&&R.value.kind!=="constant";if(T.kind!=="constant"||B)if(T.kind==="source"||B||k){const j=v(d,S,"source");this.binders[d]=k?new qr(T,x,S,j,e.id):new Oa(T,x,S,j),c.push(`/a_${d}`)}else{const j=v(d,S,"composite");this.binders[d]=new ua(T,x,S,P,n,j),c.push(`/z_${d}`)}else this.binders[d]=k?new _u(T.value,x):new dh(T.value,x,S,n),c.push(`/u_${d}`);R&&(this.binders[d].lutExpression=R.value)}this.cacheKey=c.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof Oa||n instanceof ua?n.maxValue:0}populatePaintArrays(e,n,o,c,d,p,x,T){for(const S in this.binders){const P=this.binders[S];P.context=this.context,(P instanceof Oa||P instanceof ua||P instanceof qr)&&P.populatePaintArray(e,n,o,c,d,p,x,T)}}setConstantPatternPositions(e,n){for(const o in this.binders){const c=this.binders[o];c instanceof _u&&c.setConstantPatternPositions(e,n)}}getPatternTransitionVertexBuffer(e){const n=this.binders[e];return n instanceof qr?n.paintTransitionVertexBuffer:null}updatePaintArrays(e,n,o,c,d,p,x,T,S,P){let k=!1;const R=Object.keys(e),B=R.length!==0&&!T,j=B?R:n.uniqueIds;this.context.lut=d.lut;for(const $ in this.binders){const K=this.binders[$];if(K.context=this.context,(K instanceof Oa||K instanceof ua||K instanceof qr)&&K.expression&&K.expression.kind&&K.expression.kind!=="constant"&&(K.expression.isStateDependent===!0||K.expression.isLightConstant===!1)){const ee=d.paint.get($);K.expression=ee.value;for(const le of j){const ce=e[le.toString()];n.eachPosition(le,(W,ae,he)=>{const ge=c.feature(W);K.updatePaintArray(ae,he,ge,ce,p,x,S,P)})}if(!B)for(const le of o.uniqueIds){const ce=e[le.toString()];o.eachPosition(le,(W,ae,he)=>{const ge=c.feature(W);K.updatePaintArray(ae,he,ge,ce,p,x,S,P)})}k=!0}}return k}defines(){const e=[];for(const n in this.binders){const o=this.binders[n];(o instanceof dh||o instanceof _u)&&e.push(...o.uniformNames.map(c=>`#define HAS_UNIFORM_${c}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof Oa||o instanceof ua||o instanceof qr)for(let c=0;c<o.paintVertexAttributes.length;c++)e.push(o.paintVertexAttributes[c].name);if(o instanceof qr)for(let c=0;c<hd.members.length;c++)e.push(hd.members[c].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof dh||o instanceof _u||o instanceof ua)for(const c of o.uniformNames)e.push(c)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof dh||c instanceof _u||c instanceof ua)for(const d of c.uniformNames)n.push({name:d,property:o,binding:c.getBinding(e,d)})}return n}setUniforms(e,n,o,c,d){for(const{name:p,property:x,binding:T}of o)this.binders[x].setUniform(e,T,d,c.get(x),p)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const n=this.binders[e];(n instanceof Oa||n instanceof ua||n instanceof qr)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer),n instanceof qr&&n.paintTransitionVertexBuffer&&this._buffers.push(n.paintTransitionVertexBuffer)}}upload(e){for(const n in this.binders){const o=this.binders[n];(o instanceof Oa||o instanceof ua||o instanceof qr)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof Oa||n instanceof ua||n instanceof qr)&&n.destroy()}}}class u{constructor(e,n,o=()=>!0){this.programConfigurations={};for(const c of e)this.programConfigurations[c.id]=new vo(c,n,o);this.needsUpload=!1,this._featureMap=new uh,this._featureMapWithoutIds=new uh,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,n,o,c,d,p,x,T,S){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(e,n,c,d,p,x,T,S);n.id!==void 0?this._featureMap.add(n.id,o,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,o,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,o,c,d,p,x,T){for(const S of o)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,n,S,c,d,p,x||0,T)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const t={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function s(i,e){return t[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}const h={"line-pattern":{source:Da,composite:Da},"fill-pattern":{source:Da,composite:Da},"fill-extrusion-pattern":{source:Da,composite:Da},"line-dasharray":{source:id,composite:id}},g={color:{source:uu,composite:bs},number:{source:Rl,composite:uu}};function v(i,e,n){const o=h[i];return o&&o[n]||g[e][n]}nn(dh,"ConstantBinder"),nn(_u,"PatternConstantBinder"),nn(Oa,"SourceExpressionBinder"),nn(qr,"PatternCompositeBinder"),nn(ua,"CompositeExpressionBinder"),nn(vo,"ProgramConfiguration",{omit:["_buffers"]}),nn(u,"ProgramConfigurationSet");const b=Kt/Math.PI/2,E=5,I=6,z=16383,L=64,N=[L,32,16],F=-b,q=b;function X(i,e,n,o=b){return n=Ei(n),[i*Math.sin(n)*o,-e*o,i*Math.cos(n)*o]}function G(i,e,n){return X(Math.cos(Ei(i)),Math.sin(Ei(i)),e,n)}const Y=63710088e-1,J=2*Math.PI*Y;class re{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new re(Je(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,o=this.lat*n,c=e.lat*n,d=Math.sin(o)*Math.sin(c)+Math.cos(o)*Math.cos(c)*Math.cos((e.lng-this.lng)*n);return Y*Math.acos(Math.min(d,1))}toBounds(e=0){const n=360*e/40075017,o=n/Math.cos(Math.PI/180*this.lat);return new pe({lng:this.lng-o,lat:this.lat-n},{lng:this.lng+o,lat:this.lat+n})}toEcef(e){return G(this.lat,this.lng,b+e*b/Y)}static convert(e){if(e instanceof re)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new re(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new re(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class pe{constructor(e,n){if(e)if(n)this.setSouthWest(e).setNorthEast(n);else if(e.length===4){const o=e;this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]])}else{const o=e;this.setSouthWest(o[0]).setNorthEast(o[1])}}setNorthEast(e){return this._ne=e instanceof re?new re(e.lng,e.lat):re.convert(e),this}setSouthWest(e){return this._sw=e instanceof re?new re(e.lng,e.lat):re.convert(e),this}extend(e){const n=this._sw,o=this._ne;let c,d;if(e instanceof re)c=e,d=e;else{if(!(e instanceof pe))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(pe.convert(e)):this.extend(re.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(re.convert(e)):this;if(c=e._sw,d=e._ne,!c||!d)return this}return n||o?(n.lng=Math.min(c.lng,n.lng),n.lat=Math.min(c.lat,n.lat),o.lng=Math.max(d.lng,o.lng),o.lat=Math.max(d.lat,o.lat)):(this._sw=new re(c.lng,c.lat),this._ne=new re(d.lng,d.lat)),this}getCenter(){return new re((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new re(this.getWest(),this.getNorth())}getSouthEast(){return new re(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:o}=re.convert(e);let c=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&c}static convert(e){if(e)return e instanceof pe?e:new pe(e)}}const _e=0,Ae=25.5;function Ie(i){return J*Math.cos(i*Math.PI/180)}function Te(i){return(180+i)/360}function ve(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Pe(i,e){return i/Ie(e)}function Me(i){return 360*i-180}function We(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Qe(i,e){return i*Ie(We(e))}const ft=85.051129;function pt(i){return Math.cos(Ei(Ce(i,-85.051129,ft)))}function Et(i,e){const n=Ce(e,_e,Ae),o=Math.pow(2,n);return pt(i)*J/(512*o)}function Ke(i){return 1/Math.cos(i*Math.PI/180)}function st(i,e=0){const n=Math.exp(Math.PI*(1-(i.y+e/Kt)/(1<<i.z)*2));return 80150034*n/(n*n+1)/Kt/(1<<i.z)}class Ve{constructor(e,n,o=0){this.x=+e,this.y=+n,this.z=+o}static fromLngLat(e,n=0){const o=re.convert(e);return new Ve(Te(o.lng),ve(o.lat),Pe(n,o.lat))}toLngLat(){return new re(Me(this.x),We(this.y))}toAltitude(){return Qe(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/J*Ke(We(this.y))}}function _t(i,e,n,o,c,d,p,x,T){const S=(e+o)/2,P=(n+c)/2,k=new Wt(S,P);x(k),function(R,B,j,$,K,ee){const le=j-K,ce=$-ee;return Math.abs(($-B)*le-(j-R)*ce)/Math.hypot(le,ce)}(k.x,k.y,d.x,d.y,p.x,p.y)>=T?(_t(i,e,n,S,P,d,k,x,T),_t(i,S,P,o,c,k,p,x,T)):i.push(p)}function nt(i,e,n){let o=i[0],c=o.x,d=o.y;e(o);const p=[o];for(let x=1;x<i.length;x++){const T=i[x],{x:S,y:P}=T;e(T),_t(p,c,d,S,P,o,T,e,n),c=S,d=P,o=T}return p}function Tt(i,e,n,o){if(o(e,n)){const c=e.add(n)._mult(.5);Tt(i,e,c,o),Tt(i,c,n,o)}else i.push(n)}function jt(i,e){let n=i[0];const o=[n];for(let c=1;c<i.length;c++){const d=i[c];Tt(o,n,d,e),n=d}return o}const yt=Math.pow(2,14)-1,Lt=-yt-1;function Yt(i,e){const n=Math.round(i.x*e),o=Math.round(i.y*e);return i.x=Ce(n,Lt,yt),i.y=Ce(o,Lt,yt),(n<i.x||n>i.x+1||o<i.y||o>i.y+1)&&Un("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function tn(i,e,n){const o=i.loadGeometry(),c=i.extent,d=Kt/c;if(e&&n&&n.projection.isReprojectedInTileSpace){const p=1<<e.z,{scale:x,x:T,y:S,projection:P}=n,k=R=>{const B=Me((e.x+R.x/c)/p),j=We((e.y+R.y/c)/p),$=P.project(B,j);R.x=($.x*x-T)*c,R.y=($.y*x-S)*c};for(let R=0;R<o.length;R++)if(i.type!==1)o[R]=nt(o[R],k,1);else{const B=[];for(const j of o[R])j.x<0||j.x>=c||j.y<0||j.y>=c||(k(j),B.push(j));o[R]=B}}for(const p of o)for(const x of p)Yt(x,d);return o}function Xt(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?tn(i):[]}}var rn,fn,_n,Pn,Wn,vi,Ji,Oi={};function Ai(){if(fn)return rn;fn=1;var i=Kl();function e(c,d,p,x,T){this.properties={},this.extent=p,this.type=0,this._pbf=c,this._geometry=-1,this._keys=x,this._values=T,c.readFields(n,this,d)}function n(c,d,p){c==1?d.id=p.readVarint():c==2?function(x,T){for(var S=x.readVarint()+x.pos;x.pos<S;){var P=T._keys[x.readVarint()],k=T._values[x.readVarint()];T.properties[P]=k}}(p,d):c==3?d.type=p.readVarint():c==4&&(d._geometry=p.pos)}function o(c){for(var d,p,x=0,T=0,S=c.length,P=S-1;T<S;P=T++)x+=((p=c[P]).x-(d=c[T]).x)*(d.y+p.y);return x}return rn=e,e.types=["Unknown","Point","LineString","Polygon"],e.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var d,p=c.readVarint()+c.pos,x=1,T=0,S=0,P=0,k=[];c.pos<p;){if(T<=0){var R=c.readVarint();x=7&R,T=R>>3}if(T--,x===1||x===2)S+=c.readSVarint(),P+=c.readSVarint(),x===1&&(d&&k.push(d),d=[]),d.push(new i(S,P));else{if(x!==7)throw new Error("unknown command "+x);d&&d.push(d[0].clone())}}return d&&k.push(d),k},e.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var d=c.readVarint()+c.pos,p=1,x=0,T=0,S=0,P=1/0,k=-1/0,R=1/0,B=-1/0;c.pos<d;){if(x<=0){var j=c.readVarint();p=7&j,x=j>>3}if(x--,p===1||p===2)(T+=c.readSVarint())<P&&(P=T),T>k&&(k=T),(S+=c.readSVarint())<R&&(R=S),S>B&&(B=S);else if(p!==7)throw new Error("unknown command "+p)}return[P,R,k,B]},e.prototype.toGeoJSON=function(c,d,p){var x,T,S=this.extent*Math.pow(2,p),P=this.extent*c,k=this.extent*d,R=this.loadGeometry(),B=e.types[this.type];function j(ee){for(var le=0;le<ee.length;le++){var ce=ee[le];ee[le]=[360*(ce.x+P)/S-180,360/Math.PI*Math.atan(Math.exp((180-360*(ce.y+k)/S)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(x=0;x<R.length;x++)$[x]=R[x][0];j(R=$);break;case 2:for(x=0;x<R.length;x++)j(R[x]);break;case 3:for(R=function(ee){var le=ee.length;if(le<=1)return[ee];for(var ce,W,ae=[],he=0;he<le;he++){var ge=o(ee[he]);ge!==0&&(W===void 0&&(W=ge<0),W===ge<0?(ce&&ae.push(ce),ce=[ee[he]]):ce.push(ee[he]))}return ce&&ae.push(ce),ae}(R),x=0;x<R.length;x++)for(T=0;T<R[x].length;T++)j(R[x][T])}R.length===1?R=R[0]:B="Multi"+B;var K={type:"Feature",geometry:{type:B,coordinates:R},properties:this.properties};return"id"in this&&(K.id=this.id),K},rn}function Dr(){if(Pn)return _n;Pn=1;var i=Ai();function e(o,c){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(n,this,c),this.length=this._features.length}function n(o,c,d){o===15?c.version=d.readVarint():o===1?c.name=d.readString():o===5?c.extent=d.readVarint():o===2?c._features.push(d.pos):o===3?c._keys.push(d.readString()):o===4&&c._values.push(function(p){for(var x=null,T=p.readVarint()+p.pos;p.pos<T;){var S=p.readVarint()>>3;x=S===1?p.readString():S===2?p.readFloat():S===3?p.readDouble():S===4?p.readVarint64():S===5?p.readVarint():S===6?p.readSVarint():S===7?p.readBoolean():null}return x}(d))}return _n=e,e.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var c=this._pbf.readVarint()+this._pbf.pos;return new i(this._pbf,c,this.extent,this._keys,this._values)},_n}function Dn(){return Ji||(Ji=1,Oi.VectorTile=function(){if(vi)return Wn;vi=1;var i=Dr();function e(n,o,c){if(n===3){var d=new i(c,c.readVarint()+c.pos);d.length&&(o[d.name]=d)}}return Wn=function(n,o){this.layers=n.readFields(e,{},o)},Wn}(),Oi.VectorTileFeature=Ai(),Oi.VectorTileLayer=Dr()),Oi}var Zn=Dn();const si="3d_elevation_id",er="level";class Hr{constructor(){this._valid=!1}reset(e){return this.feature=e,this._valid=!0,this._geometry=e.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(e,n){return this._valid&&e(n(this._geometry)),this}require(e,n,o){return this.get(e,!0,n,o)}optional(e,n,o){return this.get(e,!1,n,o)}success(){return this._valid}get(e,n,o,c){const d=this.feature.properties.hasOwnProperty(e)?+this.feature.properties[e]:void 0;return this._valid&&d!==void 0&&!Number.isNaN(d)?o(c?c(d):d):n&&(this._valid=!1),this}}class nr{constructor(e,n){this.featureFunc=e,this.vertexFunc=n}parseFeature(e,n,o){return this.featureFunc(e,n,o)}parseVertex(e,n,o){return this.vertexFunc(e,n,o)}}const Mi=new nr((i,e,n)=>i.reset(e).require(si,o=>{n.id=o}).optional("fixed_height_relative",o=>{n.constantHeight=o},yi.decodeRelativeHeight).geometry(o=>{n.bounds=o},Rp).success(),(i,e,n)=>i.reset(e).require(si,o=>{n.id=o}).require("elevation_idx",o=>{n.idx=o}).require("extent",o=>{n.extent=o}).require("height_relative",o=>{n.height=o},yi.decodeRelativeHeight).geometry(o=>{n.position=o},yi.getPoint).success()),Mr=new nr((i,e,n)=>i.reset(e).require(si,o=>{n.id=o}).optional("fixed_height",o=>{n.constantHeight=o},yi.decodeMetricHeight).geometry(o=>{n.bounds=o},Rp).success(),(i,e,n)=>i.reset(e).require(si,o=>{n.id=o}).require("elevation_idx",o=>{n.idx=o}).require("extent",o=>{n.extent=o}).require("height",o=>{n.height=o},yi.decodeMetricHeight).geometry(o=>{n.position=o},yi.getPoint).success());class yi{static getPoint(e){return Ws(e[0][0].x,e[0][0].y)}static decodeRelativeHeight(e){return 1e-4*e*5}static decodeMetricHeight(e){return 1e-4*e}static parse(e){const n=[],o=[],c=e.length,d=new Hr;for(let x=0;x<c;x++){const T=e.feature(x),S=T.properties.hasOwnProperty("version")?String(T.properties.version):void 0,P=(p=S)?p==="1.0.1"?Mr:void 0:Mi;if(P===void 0){Un(`Unknown elevation feature version number ${S||"(unknown)"}`);continue}const k=T.properties.hasOwnProperty("type")?T.properties.type:void 0;if(k){if(Zn.VectorTileFeature.types[T.type]==="Point"&&k==="curve_point"){const R={};P.parseVertex(d,T,R)&&n.push(R)}else if(Zn.VectorTileFeature.types[T.type]==="Polygon"&&k==="curve_meta"){const R={};P.parseFeature(d,T,R)&&o.push(R)}}}var p;return{vertices:n,features:o}}}class Rr{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,o){const c=or(n,this.dir);if(Math.abs(c)<1e-6)return!1;const d=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1])/c;return o[0]=this.pos[0]+this.dir[0]*d,o[1]=this.pos[1]+this.dir[1]*d,!0}}class cr{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,o){const c=An(n,this.dir);if(Math.abs(c)<1e-6)return!1;const d=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/c;return o[0]=this.pos[0]+this.dir[0]*d,o[1]=this.pos[1]+this.dir[1]*d,o[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(e,n,o){if(function(B,j){var $=B[0],K=B[1],ee=B[2],le=j[0],ce=j[1],W=j[2];return Math.abs($-le)<=O*Math.max(1,Math.abs($),Math.abs(le))&&Math.abs(K-ce)<=O*Math.max(1,Math.abs(K),Math.abs(ce))&&Math.abs(ee-W)<=O*Math.max(1,Math.abs(ee),Math.abs(W))}(this.pos,e)||n===0)return o[0]=o[1]=o[2]=0,!1;const[c,d,p]=this.dir,x=this.pos[0]-e[0],T=this.pos[1]-e[1],S=this.pos[2]-e[2],P=c*c+d*d+p*p,k=2*(x*c+T*d+S*p),R=k*k-4*P*(x*x+T*T+S*S-n*n);if(R<0){const B=Math.max(-k/2,0),j=x+c*B,$=T+d*B,K=S+p*B,ee=Math.hypot(j,$,K);return o[0]=j*n/ee,o[1]=$*n/ee,o[2]=K*n/ee,!1}{const B=(-k-Math.sqrt(R))/(2*P);if(B<0){const j=Math.hypot(x,T,S);return o[0]=x*n/j,o[1]=T*n/j,o[2]=S*n/j,!1}return o[0]=x+c*B,o[1]=T+d*B,o[2]=S+p*B,!0}}}class Ni{constructor(e,n,o,c,d){this.TL=e,this.TR=n,this.BR=o,this.BL=c,this.horizon=d}static fromInvProjectionMatrix(e,n,o){const c=[-1,1,1],d=[1,1,1],p=[1,-1,1],x=[-1,-1,1],T=bn(c,c,e),S=bn(d,d,e),P=bn(p,p,e),k=bn(x,x,e);return new Ni(T,S,P,k,n/o)}}function ir(i,e,n){let o=1/0,c=-1/0;const d=[];for(const p of i){Vn(d,p,e);const x=An(d,n);o=Math.min(o,x),c=Math.max(c,x)}return[o,c]}function $n(i,e){let n=!0;for(let o=0;o<i.planes.length;o++){const c=i.planes[o];let d=0;for(let p=0;p<e.length;p++)d+=An(c,e[p])+c[3]>=0;if(d===0)return 0;d!==e.length&&(n=!1)}return n?2:1}function Br(i,e){for(const n of i.projections){const o=ir(e,i.points[0],n.axis);if(n.projection[1]<o[0]||n.projection[0]>o[1])return 0}return 1}function ks(i,e){let n=0;const o=[0,0,0,0];for(let p=0;p<i.length;p++)o[0]=i[p][0],o[1]=i[p][1],o[2]=i[p][2],o[3]=1,(c=o)[0]*(d=e)[0]+c[1]*d[1]+c[2]*d[2]+c[3]*d[3]>=0&&n++;var c,d;return n}class fr{constructor(e,n){this.points=e||new Array(8).fill([0,0,0]),this.planes=n||new Array(6).fill([0,0,0,0]),this.bounds=Pi.fromPoints(this.points),this.projections=[],this.frustumEdges=[Vn([],this.points[2],this.points[3]),Vn([],this.points[0],this.points[3]),Vn([],this.points[4],this.points[0]),Vn([],this.points[5],this.points[1]),Vn([],this.points[6],this.points[2]),Vn([],this.points[7],this.points[3])];for(const o of this.frustumEdges){const c=[0,-o[2],o[1]],d=[o[2],0,-o[0]];this.projections.push({axis:c,projection:ir(this.points,this.points[0],c)}),this.projections.push({axis:d,projection:ir(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(e,n,o,c){const d=Math.pow(2,o),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const P=zr([],S,e),k=1/P[3]/n*d;return(R=P)[0]=(B=P)[0]*(j=[k,k,c?1/P[3]:k,k])[0],R[1]=B[1]*j[1],R[2]=B[2]*j[2],R[3]=B[3]*j[3],R;var R,B,j}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const P=xn([],ti([],Vn([],p[S[0]],p[S[1]]),Vn([],p[S[2]],p[S[1]]))),k=-An(P,p[S[1]]);return P.concat(k)}),T=[];for(let S=0;S<p.length;S++)T.push([p[S][0],p[S][1],p[S][2]]);return new fr(T,x)}intersectsPrecise(e,n,o){for(let c=0;c<n.length;c++)if(!ks(e,n[c]))return 0;for(let c=0;c<this.planes.length;c++)if(!ks(e,this.planes[c]))return 0;for(const c of o)for(const d of this.frustumEdges){const p=ti([],c,d),x=St(p);if(x===0)continue;qt(p,p,1/x);const T=ir(this.points,this.points[0],p),S=ir(e,this.points[0],p);if(T[0]>S[1]||S[0]>T[1])return 0}return 1}containsPoint(e){for(const n of this.planes){const o=n[3];if(An([n[0],n[1],n[2]],e)+o<0)return!1}return!0}}class Pi{static fromPoints(e){const n=[1/0,1/0,1/0],o=[-1/0,-1/0,-1/0];for(const c of e)at(n,n,c),kt(o,o,c);return new Pi(n,o)}static fromTileIdAndHeight(e,n,o){const c=1<<e.canonical.z,d=e.canonical.x,p=e.canonical.y;return new Pi([d/c,p/c,n],[(d+1)/c,(p+1)/c,o])}static applyTransform(e,n){const o=e.getCorners();for(let c=0;c<o.length;++c)bn(o[c],o[c],n);return Pi.fromPoints(o)}static applyTransformFast(e,n){const o=[n[12],n[13],n[14]],c=[...o];for(let d=0;d<3;d++)for(let p=0;p<3;p++){const x=n[4*p+d],T=x*e.min[p],S=x*e.max[p];o[d]+=Math.min(T,S),c[d]+=Math.max(T,S)}return new Pi(o,c)}static projectAabbCorners(e,n){const o=e.getCorners();for(let c=0;c<o.length;++c)bn(o[c],o[c],n);return o}constructor(e,n){this.min=e,this.max=n,this.center=qt([],At([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],o=mt(this.min),c=mt(this.max);for(let d=0;d<n.length;d++)o[d]=n[d]?this.min[d]:this.center[d],c[d]=n[d]?this.center[d]:this.max[d];return c[2]=this.max[2],new Pi(o,c)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?$n(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?$n(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,n){return n||this.intersects(e)?Br(e,this.getCorners()):0}intersectsPreciseFlat(e,n){return n||this.intersectsFlat(e)?Br(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let n=0;n<3;++n)if(this.min[n]>e.max[n]||e.min[n]>this.max[n])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],e.min[n]),this.max[n]=Math.max(this.max[n],e.max[n])}encapsulatePoint(e){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],e[n]),this.max[n]=Math.max(this.max[n],e[n])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}nn(Pi,"Aabb");class Do{constructor(e,n){this.feature=e,this.metersToTile=n,this.index=0}get(){const e=this.feature.vertices[this.index],n=this.feature.vertexProps[this.index].dir,o=n[1],c=-n[0],d=(e.extent+1)*this.metersToTile;return[new Wt(Math.trunc(e.position[0]+o*d),Math.trunc(e.position[1]+c*d)),new Wt(Math.trunc(e.position[0]-o*d),Math.trunc(e.position[1]-c*d))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class xo{constructor(e,n,o,c,d,p){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=e,this.heightRange={min:o,max:o},this.safeArea=n,this.constantHeight=o,this.constantHeight==null&&(this.constantHeight!=null||c.length!==0)){this.vertices=c,this.edges=d,this.edges=this.edges.filter(x=>{return x.a<this.vertices.length&&x.b<this.vertices.length&&!((T=this.vertices[x.a].position)[0]===(S=this.vertices[x.b].position)[0]&&T[1]===S[1]);var T,S}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const x of this.vertices)this.vertexProps.push({dir:Ws(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,x.height),this.heightRange.max=Math.max(this.heightRange.max,x.height);for(const x of this.edges){const T=this.vertices[x.a].position,S=this.vertices[x.b].position,P=br(Wr(),S,T),k=ro(P),R=is(Wr(),P,1/k);this.edgeProps.push({vec:P,dir:R,len:k});const B=this.vertexProps[x.a].dir,j=this.vertexProps[x.b].dir;hi(B,B,R),hi(j,j,R)}for(const x of this.vertexProps)x.dir[0]===0&&x.dir[1]===0||Ca(x.dir,x.dir);this.tessellate(p)}}pointElevation(e){if(this.constantHeight!=null)return this.constantHeight;const n=this.getClosestEdge(e);if(n==null)return 0;const[o,c]=n;return Cn(this.vertices[this.edges[o].a].height,this.vertices[this.edges[o].b].height,c)}computeSlopeNormal(e,n){const o=this.getClosestEdge(e);if(!o)return xt(0,0,1);const c=o[0],d=this.edges[c],p=this.edgeProps[c].vec,x=xt(p[0],p[1],(this.vertices[d.b].height-this.vertices[d.a].height)*n),T=xt(x[1],-x[0],0);ti(T,T,x);const S=St(T);return S>0?qt(T,T,1/S):xt(0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(e){if(this.edges.length===0)return;let n=0,o=Number.POSITIVE_INFINITY,c=0;const d=Ws(e.x,e.y);for(let p=0;p<this.edges.length;p++){const x=this.edges[p],T=this.edgeProps[p].dir,S=new Rr(d,this.edgeProps[p].dir),P=this.vertices[x.a].position,k=this.vertices[x.b].position,R=Wr(),B=Wr(),j=S.intersectsPlane(P,this.vertexProps[x.a].dir,R),$=S.intersectsPlane(k,this.vertexProps[x.b].dir,B);if(!j||!$)continue;const K=br(Wr(),B,R),ee=br(Wr(),d,R),le=or(K,K),ce=le>0?or(ee,K)/le:0,W=Ce(ce,0,1),ae=Math.abs((ce-W)*this.edgeProps[p].len),he=br(Wr(),d,P),ge=ae+Math.abs(or(he,Ws(T[1],-T[0])));ge<o&&(n=p,o=ge,c=W)}return[n,c]}tessellate(e){for(let n=this.edges.length-1;n>=0;--n){const o=this.edges[n].a,c=this.edges[n].b,{position:d,height:p,extent:x}=this.vertices[o],{position:T,height:S,extent:P}=this.vertices[c],k=this.vertexProps[o].dir,R=this.vertexProps[c].dir,B=xt(d[0]/e,d[1]/e,p),j=xt(T[0]/e,T[1]/e,S),$=xt(k[1],-k[0],0);qt($,$,x);const K=xt(R[1],-R[0],0);if(qt(K,K,P),this.distSqLines(xt(B[0]+.5*$[0],B[1]+.5*$[1],B[2]+.5*$[2]),xt(j[0]-.5*K[0],j[1]-.5*K[1],j[2]-.5*K[2]),xt(B[0]-.5*$[0],B[1]-.5*$[1],B[2]-.5*$[2]),xt(j[0]+.5*K[0],j[1]+.5*K[1],j[2]+.5*K[2]))<=.0025000000000000005)continue;const ee=this.vertices.length,le=hi(Wr(),d,T);this.vertices.push({position:is(le,le,.5),height:.5*(p+S),extent:.5*(x+P)});const ce=hi(Wr(),k,R);this.vertexProps.push({dir:Ca(ce,ce)}),this.edges.splice(n,1),this.edgeProps.splice(n,1),this.edges.push({a:o,b:ee}),this.edges.push({a:ee,b:c});const W=br(Wr(),this.vertices[ee].position,d),ae=ro(W),he={vec:W,dir:is(Wr(),W,1/ae),len:ae};this.edgeProps.push(he),this.edgeProps.push(he)}}distSqLines(e,n,o,c){const d=Ct(et(),n,e),p=Ct(et(),c,o),x=Ct(et(),e,o),T=An(d,d),S=An(d,p),P=An(d,x),k=An(p,p),R=An(p,x),B=T*k-S*S;if(B===0){const K=An(x,p)/An(p,p);return Ht(Hn(et(),o,c,K),e)}const j=(S*R-P*k)/B,$=(T*R-S*P)/B;return Ht(Hn(et(),e,n,j),Hn(et(),o,c,$))}}class ha{static parseFrom(e,n){const o=yi.parse(e);if(!o)return[];let{vertices:c,features:d}=o;const p=1/st(n);d.sort((P,k)=>P.id-k.id),c.sort((P,k)=>P.id-k.id||P.idx-k.idx),c=c.filter((P,k,R)=>k===R.findIndex(B=>B.id===P.id&&B.idx===P.idx));const x=new Array;let T=0;const S=c.length;for(const P of d){if(P.constantHeight){x.push(new xo(P.id,P.bounds,P.constantHeight));continue}for(;T!==S&&c[T].id<P.id;)T++;if(T===S||c[T].id!==P.id)continue;const k=new Array,R=new Array,B=T;for(;T!==S&&c[T].id===P.id;){const j=c[T];if(k.push({position:j.position,height:j.height,extent:j.extent}),T!==B&&c[T-1].idx===j.idx-1){const $=T-B;R.push({a:$-1,b:$})}T++}x.push(new xo(P.id,P.bounds,void 0,k,R,p))}return x}static getElevationFeature(e,n){if(!n)return;const o=+e.properties[si];return Number.isNaN(o)?void 0:n.find(c=>c.id===o)}}class ms{constructor(e,n){this.zScale=1,this.xOffset=0,this.yOffset=0,e.equals(n)||(this.zScale=Math.pow(2,n.z-e.z),this.xOffset=(e.x*this.zScale-n.x)*Kt,this.yOffset=(e.y*this.zScale-n.y)*Kt)}constantElevation(e,n){if(e.constantHeight!=null)return this.computeBiasedHeight(e.constantHeight,n)}pointElevation(e,n,o){const c=this.constantElevation(n,o);return c??(e.x=e.x*this.zScale+this.xOffset,e.y=e.y*this.zScale+this.yOffset,this.computeBiasedHeight(n.pointElevation(e),o))}computeBiasedHeight(e,n){return n<=0?e:e+n*He(0,n,e>=0?e:Math.abs(.5*e))}}nn(xo,"ElevationFeature");class Qo{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new ll,this.indexArray=new ws,this.segments=new Qi,this.programConfigurations=new u(e.layers,{zoom:e.zoom,lut:e.lut}),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new Rl),this.worldview=e.worldview}updateFootprints(e,n){}populate(e,n,o,c){const d=this.layers[0],p=[];let x=null;d.type==="circle"&&(x=d.layout.get("circle-sort-key"));for(const{feature:S,id:P,index:k,sourceLayerIndex:R}of e){const B=this.layers[0]._featureFilter.needGeometry,j=Xt(S,B);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{worldview:this.worldview}),j,o))continue;const $=x?x.evaluate(j,{},o):void 0,K={id:P,properties:S.properties,type:S.type,sourceLayerIndex:R,index:k,geometry:B?j.geometry:tn(S,o,c),patterns:{},sortKey:$};p.push(K)}x&&p.sort((S,P)=>S.sortKey-P.sortKey);let T=null;c.projection.name==="globe"&&(this.globeExtVertexArray=new rp,T=c.projection);for(const S of p){const{geometry:P,index:k,sourceLayerIndex:R}=S,B=e[k].feature;this.addFeature(S,P,k,n.availableImages,o,T,n.brightness,n.elevationFeatures),n.featureIndex.insert(B,P,k,R,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(e,n,o,c,d,p,x){this.programConfigurations.updatePaintArrays(e,n,d,o,c,p,x,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jp.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,du.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=e.createVertexBuffer(this.elevatedLayoutVertexArray,Uf.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(e,n,o,c,d,p,x,T){let S;this.elevationMode!=="none"&&(S=ha.getElevationFeature(e,T));for(const P of n)for(const k of P){const R=k.x,B=k.y;if(R<0||R>=Kt||B<0||B>=Kt)continue;if(p){const K=p.projectTilePoint(R,B,d),ee=p.upVector(d,R,B);this.addGlobeExtVertex(K,ee),this.addGlobeExtVertex(K,ee),this.addGlobeExtVertex(K,ee),this.addGlobeExtVertex(K,ee)}const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),$=j.vertexLength;if(this.addCircleVertex(R,B,-1,-1),this.addCircleVertex(R,B,1,-1),this.addCircleVertex(R,B,1,1),this.addCircleVertex(R,B,-1,1),this.elevationMode!=="none"){const K=S?S.pointElevation(new Wt(R,B)):0;this.hasElevation=this.hasElevation||K!==0;for(let ee=0;ee<4;ee++)this.elevatedLayoutVertexArray.emplaceBack(K)}this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{},c,d,x,void 0,this.worldview)}addCircleVertex(e,n,o,c){this.layoutVertexArray.emplaceBack(2*e+(o+1)/2,2*n+(c+1)/2)}addGlobeExtVertex(e,n){this.globeExtVertexArray.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}}function Oo(i,e){for(let n=0;n<i.length;n++)if(Ba(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(Ba(i,e[n]))return!0;return!!Cc(i,e)}function Bo(i,e,n){return!!Ba(i,e)||!!yu(e,i,n)}function Jo(i,e){if(i.length===1)return fd(e,i[0]);for(let n=0;n<e.length;n++){const o=e[n];for(let c=0;c<o.length;c++)if(Ba(i,o[c]))return!0}for(let n=0;n<i.length;n++)if(fd(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(Cc(i,e[n]))return!0;return!1}function ea(i,e,n){if(i.length>1){if(Cc(i,e))return!0;for(let o=0;o<e.length;o++)if(yu(e[o],i,n))return!0}for(let o=0;o<i.length;o++)if(yu(i[o],e,n))return!0;return!1}function Cc(i,e){if(i.length===0||e.length===0)return!1;for(let n=0;n<i.length-1;n++){const o=i[n],c=i[n+1];for(let d=0;d<e.length-1;d++)if(pd(o,c,e[d],e[d+1]))return!0}return!1}function pd(i,e,n,o){return Ki(i,n,o)!==Ki(e,n,o)&&Ki(i,e,n)!==Ki(i,e,o)}function Ec(i,e,n){return(i.x-n.x)*(e.y-n.y)-(i.y-n.y)*(e.x-n.x)}function tf(i,e,n,o){const c=Ec(i,e,o),d=Ec(i,e,n);if(Math.sign(c)===Math.sign(d))return;const p=Ec(n,o,i),x=p+d-c;return Math.sign(p)!==Math.sign(x)?[p/(p-x),d/(d-c)]:void 0}function yu(i,e,n){const o=n*n;if(e.length===1)return i.distSqr(e[0])<o;for(let c=1;c<e.length;c++)if(fp(i,e[c-1],e[c])<o)return!0;return!1}function fp(i,e,n){const o=e.distSqr(n);if(o===0)return i.distSqr(e);const c=((i.x-e.x)*(n.x-e.x)+(i.y-e.y)*(n.y-e.y))/o;return i.distSqr(c<0?e:c>1?n:n.sub(e)._mult(c)._add(e))}function fd(i,e){let n,o,c,d=!1;for(let p=0;p<i.length;p++){n=i[p];for(let x=0,T=n.length-1;x<n.length;T=x++)o=n[x],c=n[T],o.y>e.y!=c.y>e.y&&e.x<(c.x-o.x)*(e.y-o.y)/(c.y-o.y)+o.x&&(d=!d)}return d}function Ba(i,e){let n=!1;for(let o=0,c=i.length-1;o<i.length;c=o++){const d=i[o],p=i[c];d.y>e.y!=p.y>e.y&&e.x<(p.x-d.x)*(e.y-d.y)/(p.y-d.y)+d.x&&(n=!n)}return n}function Fl(i,e,n,o,c){for(const p of i)if(e<=p.x&&n<=p.y&&o>=p.x&&c>=p.y)return!0;const d=[new Wt(e,n),new Wt(e,c),new Wt(o,c),new Wt(o,n)];if(i.length>2){for(const p of d)if(Ba(i,p))return!0}for(let p=0;p<i.length-1;p++)if(hl(i[p],i[p+1],d))return!0;return!1}function hl(i,e,n){const o=n[0],c=n[2];if(i.x<o.x&&e.x<o.x||i.x>c.x&&e.x>c.x||i.y<o.y&&e.y<o.y||i.y>c.y&&e.y>c.y)return!1;const d=Ki(i,e,n[0]);return d!==Ki(i,e,n[1])||d!==Ki(i,e,n[2])||d!==Ki(i,e,n[3])}function jl(i,e,n,o,c,d){let p=e.y-i.y,x=i.x-e.x;if(d=d||0){const T=p*p+x*x;if(T===0)return!0;const S=Math.sqrt(T);p/=S,x/=S}return!((n.x-i.x)*p+(n.y-i.y)*x-d<0||(o.x-i.x)*p+(o.y-i.y)*x-d<0||(c.x-i.x)*p+(c.y-i.y)*x-d<0)}function nf(i,e,n,o,c,d,p){return!(jl(i,e,o,c,d,p)||jl(e,n,o,c,d,p)||jl(n,i,o,c,d,p)||jl(o,c,i,e,n,p)||jl(c,d,i,e,n,p)||jl(d,o,i,e,n,p))}function mp(i,e,n){const o=e.paint.get(i).value;return o.kind==="constant"?o.value:n.programConfigurations.get(e.id).getMaxValue(i)}function rf(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Wf(i,e,n,o,c){if(!e[0]&&!e[1])return i;const d=Wt.convert(e)._mult(c);n==="viewport"&&d._rotate(-o);const p=[];for(let x=0;x<i.length;x++)p.push(i[x].sub(d));return p}function sf(i,e,n,o){const c=Wt.convert(i)._mult(o);return e==="viewport"&&c._rotate(-n),c}let Zf,of;function Km(i,e,n){var o=2*Math.PI*6378137/256/Math.pow(2,n);return[i*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}nn(Qo,"CircleBucket",{omit:["layers"]});class md{constructor(e,n,o){this.z=e,this.x=n,this.y=o,this.key=Ac(0,e,e,n,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const o=function(d,p,x){var T=Km(256*d,256*(p=Math.pow(2,x)-p-1),x),S=Km(256*(d+1),256*(p+1),x);return T[0]+","+T[1]+","+S[0]+","+S[1]}(this.x,this.y,this.z),c=function(d,p,x){let T,S="";for(let P=d;P>0;P--)T=1<<P-1,S+=(p&T?1:0)+(x&T?2:0);return S}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",c).replace("{bbox-epsg-3857}",o)}toString(){return`${this.z}/${this.x}/${this.y}`}}class af{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Ac(e,n.z,n.z,n.x,n.y)}}class bo{constructor(e,n,o,c,d){this.overscaledZ=e,this.wrap=n,this.canonical=new md(o,+c,+d),this.key=n===0&&e===o?this.canonical.key:Ac(n,e,o,c,d)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new bo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new bo(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return Ac(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const o=this.canonical.z-e;return Ac(this.wrap*+n,e,e,this.canonical.x>>o,this.canonical.y>>o)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new bo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,o=2*this.canonical.x,c=2*this.canonical.y;return[new bo(n,this.wrap,n,o,c),new bo(n,this.wrap,n,o+1,c),new bo(n,this.wrap,n,o,c+1),new bo(n,this.wrap,n,o+1,c+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new bo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new bo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new af(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ac(i,e,n,o,c){const d=1<<Math.min(n,22);let p=d*(c%d)+o%d;return i&&n<22&&(p+=d*d*((i<0?-2*i-1:2*i)%(1<<2*(22-n)))),16*(32*p+n)+(e-n)}const dv=[i=>{let e=i.canonical.x-1,n=i.wrap;return e<0&&(e=(1<<i.canonical.z)-1,n--),new bo(i.overscaledZ,n,i.canonical.z,e,i.canonical.y)},i=>{let e=i.canonical.x+1,n=i.wrap;return e===1<<i.canonical.z&&(e=0,n++),new bo(i.overscaledZ,n,i.canonical.z,e,i.canonical.y)},i=>new bo(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,(i.canonical.y===0?1<<i.canonical.z:i.canonical.y)-1),i=>new bo(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y===(1<<i.canonical.z)-1?0:i.canonical.y+1)];nn(md,"CanonicalTileID"),nn(bo,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Kf=xi([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:f}=Kf,y=xi([{name:"a_pos_3",components:3,type:"Int16"}]);var A=xi([{name:"a_pos",type:"Int16",components:2}]);function D(i){return i*b/Y}const H=[new Pi([F,F,F],[q,q,q]),new Pi([F,F,F],[0,0,q]),new Pi([0,F,F],[q,0,q]),new Pi([F,0,F],[0,q,q]),new Pi([0,0,F],[q,q,q])];function Q(i,e,n,o=!0){const c=qt([],i._camera.position,i.worldSize),d=[e,n,1,1];zr(d,d,i.pixelMatrixInverse),Gr(d,d,1/d[3]);const p=xn([],Vn([],d,c)),x=i.globeMatrix,T=[x[12],x[13],x[14]],S=Vn([],T,c),P=St(S),k=xn([],S),R=i.worldSize/(2*Math.PI),B=An(k,p),j=Math.asin(R/P);if(j<Math.acos(B)){if(!o)return null;const je=[],Ze=[];qt(je,p,P/B),xn(Ze,Vn(Ze,je,S)),xn(p,At(p,S,qt(p,Ze,Math.tan(j)*P)))}const $=[];new cr(c,p).closestPointOnSphere(T,R,$);const K=xn([],Lr(x,0)),ee=xn([],Lr(x,1)),le=xn([],Lr(x,2)),ce=An(K,$),W=An(ee,$),ae=An(le,$),he=it(Math.asin(-W/R));let ge=it(Math.atan2(ce,ae));ge=i.center.lng+function(je,Ze){const ut=(Ze-je+180)%360-180;return ut<-180?ut+360:ut}(i.center.lng,ge);const Be=Te(ge),ke=Ce(ve(he),0,1);return new Ve(Be,ke)}class be{constructor(e,n,o){this.a=Vn([],e,o),this.b=Vn([],n,o),this.center=o;const c=xn([],this.a),d=xn([],this.b);this.angle=Math.acos(An(c,d))}}function Ye(i,e){if(i.angle===0)return null;let n;return n=i.a[e]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[e]/i.a[e]/Math.sin(i.angle)-1/Math.tan(i.angle)),n<0||n>1?null:function(o,c,d,p){const x=Math.sin(d);return o*(Math.sin((1-p)*d)/x)+c*(Math.sin(p*d)/x)}(i.a[e],i.b[e],i.angle,Ce(n,0,1))+i.center[e]}function ot(i){if(i.z<=1)return H[i.z+2*i.y+i.x];const e=jn(dn(i));return Pi.fromPoints(e)}function Bt(i,e,n){return qt(i,i,1-n),lt(i,i,e,n)}function mn(i,e,n){for(const o of i)bn(o,o,e),qt(o,o,n)}function gn(i,e,n,o){const c=e/i.worldSize,d=i.globeMatrix;if(n.z<=1){const ke=ot(n).getCorners();return mn(ke,d,c),Pi.fromPoints(ke)}const p=dn(n,o),x=jn(p,b+D(i._tileCoverLift));mn(x,d,c);const T=Number.MAX_VALUE,S=[-T,-T,-T],P=[T,T,T];if(p.contains(i.center)){for(const Ze of x)at(P,P,Ze),kt(S,S,Ze);S[2]=0;const ke=i.point,je=[ke.x*c,ke.y*c,0];return at(P,P,je),kt(S,S,je),new Pi(P,S)}if(i._tileCoverLift>0){for(const ke of x)at(P,P,ke),kt(S,S,ke);return new Pi(P,S)}const k=[d[12]*c,d[13]*c,d[14]*c],R=p.getCenter(),B=Ce(i.center.lat,-85.051129,ft),j=Ce(R.lat,-85.051129,ft),$=Te(i.center.lng),K=ve(B);let ee=$-Te(R.lng);const le=K-ve(j);ee>.5?ee-=1:ee<-.5&&(ee+=1);let ce=0;Math.abs(ee)>Math.abs(le)?ce=ee>=0?1:3:(ce=le>=0?0:2,lt(k,k,[d[4]*c,d[5]*c,d[6]*c],-Math.sin(Ei(le>=0?p.getSouth():p.getNorth()))*b));const W=x[ce],ae=x[(ce+1)%4],he=new be(W,ae,k),ge=[Ye(he,0)||W[0],Ye(he,1)||W[1],Ye(he,2)||W[2]],Be=pi(i.zoom);if(Be>0){const ke=function({x:Ze,y:ut,z:Rt},wt,Mt,Dt,dt){const Pt=1/(1<<Rt);let ct=Ze*Pt,ht=ct+Pt,Nt=ut*Pt,Vt=Nt+Pt,yn=0;const cn=(ct+ht)/2-Dt;return cn>.5?yn=-1:cn<-.5&&(yn=1),ct=((ct+yn)*wt-(Dt*=wt))*Mt+Dt,ht=((ht+yn)*wt-Dt)*Mt+Dt,Nt=(Nt*wt-(dt*=wt))*Mt+dt,Vt=(Vt*wt-dt)*Mt+dt,[[ct,Vt,0],[ht,Vt,0],[ht,Nt,0],[ct,Nt,0]]}(n,e,i._pixelsPerMercatorPixel,$,K);for(let Ze=0;Ze<x.length;Ze++)Bt(x[Ze],ke[Ze],Be);const je=At([],ke[ce],ke[(ce+1)%4]);qt(je,je,.5),Bt(ge,je,Be)}for(const ke of x)at(P,P,ke),kt(S,S,ke);return P[2]=Math.min(W[2],ae[2]),at(P,P,ge),kt(S,S,ge),new Pi(P,S)}function dn({x:i,y:e,z:n},o=!1){const c=1/(1<<n),d=new re(Me(i*c),e===(1<<n)-1&&o?-90:We((e+1)*c)),p=new re(Me((i+1)*c),e===0&&o?90:We(e*c));return new pe(d,p)}function jn(i,e=b){const n=Ei(i.getNorth()),o=Ei(i.getSouth()),c=Math.cos(n),d=Math.cos(o),p=Math.sin(n),x=Math.sin(o),T=i.getWest(),S=i.getEast();return[X(d,x,T,e),X(d,x,S,e),X(c,p,S,e),X(c,p,T,e)]}function Kn(i,e,n,o){const c=1<<n.z,d=(i/Kt+n.x)/c;return G(We((e/Kt+n.y)/c),Me(d),o)}function ei({min:i,max:e}){return z/Math.max(e[0]-i[0],e[1]-i[1],e[2]-i[2])}const Ms=new Float64Array(16);function It(i){const e=ei(i),n=Ee(Ms,[e,e,e]);return Re(n,n,zn([],i.min))}function vt(i){const e=(o=i.min,(n=Ms)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=o[0],n[13]=o[1],n[14]=o[2],n[15]=1,n);var n,o;const c=1/ei(i);return ye(e,e,[c,c,c])}function zt(i){const e=Kt/(2*Math.PI);return i/(2*Math.PI)/e}function Tn(i,e){return Kt/(512*Math.pow(2,i))*ei(ot(e))}function ui(i,e,n,o,c){const d=zt(n),p=[i,e,-n/(2*Math.PI)],x=ne(new Float64Array(16));return Re(x,x,p),ye(x,x,[d,d,d]),Le(x,x,Ei(-c)),De(x,x,Ei(-o)),x}function pi(i){return He(E,I,i)}function bi(i,e){const n=G(e.lat,e.lng),o=function(j){const $=G(j._center.lat,j._center.lng);let K=ti([],xt(0,1,0),$);const ee=qe([],-j.angle,$);K=bn(K,K,ee),qe(ee,-j._pitch,K);const le=xn([],$);return qt(le,le,D(j.cameraToCenterDistance/j.pixelsPerMeter)),bn(le,le,ee),At([],$,le)}(i);return p=(c=Ct([],o,n))[0],x=c[1],T=c[2],S=(d=n)[0],P=d[1],k=d[2],B=(R=Math.sqrt(p*p+x*x+T*T)*Math.sqrt(S*S+P*P+k*k))&&An(c,d)/R,Math.acos(Math.min(Math.max(B,-1),1));var c,d,p,x,T,S,P,k,R,B}function Ri(i,e){return bi(i,e)>Math.PI/2*1.01}const lo=Ei(85),Nr=Math.cos(lo),ph=Math.sin(lo),pv=se(),ub=i=>{const e=[];return i.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),i.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e};function hb(i,e,n,o,c,d,p,x,T){if(d&&i.queryGeometry.isAboveHorizon)return!1;d&&(T*=i.pixelToTileUnitsFactor);const S=i.tileID.canonical,P=n.projection.upVectorScale(S,n.center.lat,n.worldSize).metersToTile;for(const k of e)for(const R of k){const B=R.add(x),j=c&&n.elevation?n.elevation.exaggeration()*c.getElevationAt(B.x,B.y,!0):0,$=n.projection.projectTilePoint(B.x,B.y,S);if(j>0){const ce=n.projection.upVector(S,B.x,B.y);$.x+=ce[0]*P*j,$.y+=ce[1]*P*j,$.z+=ce[2]*P*j}const K=d?B:dI($.x,$.y,$.z,o),ee=d?i.tilespaceRays.map(ce=>fI(ce,j)):i.queryGeometry.screenGeometry,le=zr([],[$.x,$.y,$.z,1],o);if(!p&&d?T*=le[3]/n.cameraToCenterDistance:p&&!d&&(T*=n.cameraToCenterDistance/le[3]),d){const ce=We((R.y/Kt+S.y)/(1<<S.z));T/=n.projection.pixelsPerMeter(ce,1)/Pe(1,ce)}if(Bo(ee,K,T))return!0}return!1}function dI(i,e,n,o){const c=zr([],[i,e,n,1],o);return new Wt(c[0]/c[3],c[1]/c[3])}const db=xt(0,0,0),pI=xt(0,0,1);function fI(i,e){const n=et();return db[2]=e,i.intersectsPlane(db,pI,n),new Wt(n[0],n[1])}class pb extends Qo{}let fb,mb,gb,_b;function yb(i,{width:e,height:n},o,c){if(c){if(c instanceof Uint8ClampedArray)c=new Uint8Array(c.buffer);else if(c.length!==e*n*o)throw new RangeError("mismatched image size")}else c=new Uint8Array(e*n*o);return i.width=e,i.height=n,i.data=c,i}function vb(i,e,n){const{width:o,height:c}=e;o===i.width&&c===i.height||(fv(i,e,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,o),height:Math.min(i.height,c)},n,null),i.width=o,i.height=c,i.data=e.data)}function fv(i,e,n,o,c,d,p,x){if(c.width===0||c.height===0)return e;if(c.width>i.width||c.height>i.height||n.x>i.width-c.width||n.y>i.height-c.height)throw new RangeError("out of range source coordinates for image copy");if(c.width>e.width||c.height>e.height||o.x>e.width-c.width||o.y>e.height-c.height)throw new RangeError("out of range destination coordinates for image copy");const T=i.data,S=e.data,P=d===4&&x;for(let k=0;k<c.height;k++){const R=((n.y+k)*i.width+n.x)*d,B=((o.y+k)*e.width+o.x)*d;if(P)for(let j=0;j<c.width;j++){const $=R+j*d+3,K=B+j*d;S[K+0]=255,S[K+1]=255,S[K+2]=255,S[K+3]=T[$]}else if(p)for(let j=0;j<c.width;j++){const $=R+j*d,K=B+j*d,ee=new Ti(T[$+0]/255,T[$+1]/255,T[$+2]/255,T[$+3]).toNonPremultipliedRenderColor(p).toArray();S[K+0]=ee[0],S[K+1]=ee[1],S[K+2]=ee[2],S[K+3]=ee[3]}else for(let j=0;j<c.width*d;j++)S[B+j]=T[R+j]}return e}nn(pb,"HeatmapBucket",{omit:["layers"]});class gp{constructor(e,n){yb(this,e,1,n)}resize(e){vb(this,new gp(e),1)}clone(){return new gp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,c,d){fv(e,n,o,c,d,1,null)}}class wo{constructor(e,n){yb(this,e,4,n)}resize(e){vb(this,new wo(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new wo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,c,d,p,x){fv(e,n,o,c,d,4,p,x)}}class xb{constructor(e,n){this.width=e.width,this.height=e.height,this.data=n instanceof Uint8Array?new Float32Array(n.buffer):n}}function Xm(i){const e={},n=i.resolution||256,o=i.clips?i.clips.length:1,c=i.image||new wo({width:n,height:o}),d=(p,x,T)=>{e[i.evaluationKey]=T;const S=i.expression.evaluate(e),P=S?S.toNonPremultipliedRenderColor(null):null;P&&(c.data[p+x+0]=Math.floor(255*P.r),c.data[p+x+1]=Math.floor(255*P.g),c.data[p+x+2]=Math.floor(255*P.b),c.data[p+x+3]=Math.floor(255*P.a))};if(i.clips)for(let p=0,x=0;p<o;++p,x+=4*n)for(let T=0,S=0;T<n;T++,S+=4){const P=T/(n-1),{start:k,end:R}=i.clips[p];d(x,S,k*(1-P)+R*P)}else for(let p=0,x=0;p<n;p++,x+=4)d(0,x,p/(n-1));return c}nn(gp,"AlphaImage"),nn(wo,"RGBAImage");const mI=xi([{name:"a_pos",components:2,type:"Int16"}],4),gI=xi([{name:"a_road_z_offset",components:1,type:"Float32"}],4),_I=xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),yI=xi([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function Ym(i,e,n=2){const o=e&&e.length,c=o?e[0]*n:i.length;let d=bb(i,0,c,n,!0);const p=[];if(!d||d.next===d.prev)return p;let x,T,S;if(o&&(d=function(P,k,R,B){const j=[];for(let $=0,K=k.length;$<K;$++){const ee=bb(P,k[$]*B,$<K-1?k[$+1]*B:P.length,B,!1);ee===ee.next&&(ee.steiner=!0),j.push(EI(ee))}j.sort(TI);for(let $=0;$<j.length;$++)R=SI(j[$],R);return R}(i,e,d,n)),i.length>80*n){x=1/0,T=1/0;let P=-1/0,k=-1/0;for(let R=n;R<c;R+=n){const B=i[R],j=i[R+1];B<x&&(x=B),j<T&&(T=j),B>P&&(P=B),j>k&&(k=j)}S=Math.max(P-x,k-T),S=S!==0?32767/S:0}return Qm(d,p,n,x,T,S,0),p}function bb(i,e,n,o,c){let d;if(c===function(p,x,T,S){let P=0;for(let k=x,R=T-S;k<T;k+=S)P+=(p[R]-p[k])*(p[k+1]+p[R+1]),R=k;return P}(i,e,n,o)>0)for(let p=e;p<n;p+=o)d=Cb(p/o|0,i[p],i[p+1],d);else for(let p=n-o;p>=e;p-=o)d=Cb(p/o|0,i[p],i[p+1],d);return d&&Xf(d,d.next)&&(tg(d),d=d.next),d}function lf(i,e){if(!i)return i;e||(e=i);let n,o=i;do if(n=!1,o.steiner||!Xf(o,o.next)&&Hs(o.prev,o,o.next)!==0)o=o.next;else{if(tg(o),o=e=o.prev,o===o.next)break;n=!0}while(n||o!==e);return e}function Qm(i,e,n,o,c,d,p){if(!i)return;!p&&d&&function(T,S,P,k){let R=T;do R.z===0&&(R.z=mv(R.x,R.y,S,P,k)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==T);R.prevZ.nextZ=null,R.prevZ=null,function(B){let j,$=1;do{let K,ee=B;B=null;let le=null;for(j=0;ee;){j++;let ce=ee,W=0;for(let he=0;he<$&&(W++,ce=ce.nextZ,ce);he++);let ae=$;for(;W>0||ae>0&&ce;)W!==0&&(ae===0||!ce||ee.z<=ce.z)?(K=ee,ee=ee.nextZ,W--):(K=ce,ce=ce.nextZ,ae--),le?le.nextZ=K:B=K,K.prevZ=le,le=K;ee=ce}le.nextZ=null,$*=2}while(j>1)}(R)}(i,o,c,d);let x=i;for(;i.prev!==i.next;){const T=i.prev,S=i.next;if(d?xI(i,o,c,d):vI(i))e.push(T.i,i.i,S.i),tg(i),i=S.next,x=S.next;else if((i=S)===x){p?p===1?Qm(i=bI(lf(i),e),e,n,o,c,d,2):p===2&&wI(i,e,n,o,c,d):Qm(lf(i),e,n,o,c,d,1);break}}}function vI(i){const e=i.prev,n=i,o=i.next;if(Hs(e,n,o)>=0)return!1;const c=e.x,d=n.x,p=o.x,x=e.y,T=n.y,S=o.y,P=Math.min(c,d,p),k=Math.min(x,T,S),R=Math.max(c,d,p),B=Math.max(x,T,S);let j=o.next;for(;j!==e;){if(j.x>=P&&j.x<=R&&j.y>=k&&j.y<=B&&Jm(c,x,d,T,p,S,j.x,j.y)&&Hs(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function xI(i,e,n,o){const c=i.prev,d=i,p=i.next;if(Hs(c,d,p)>=0)return!1;const x=c.x,T=d.x,S=p.x,P=c.y,k=d.y,R=p.y,B=Math.min(x,T,S),j=Math.min(P,k,R),$=Math.max(x,T,S),K=Math.max(P,k,R),ee=mv(B,j,e,n,o),le=mv($,K,e,n,o);let ce=i.prevZ,W=i.nextZ;for(;ce&&ce.z>=ee&&W&&W.z<=le;){if(ce.x>=B&&ce.x<=$&&ce.y>=j&&ce.y<=K&&ce!==c&&ce!==p&&Jm(x,P,T,k,S,R,ce.x,ce.y)&&Hs(ce.prev,ce,ce.next)>=0||(ce=ce.prevZ,W.x>=B&&W.x<=$&&W.y>=j&&W.y<=K&&W!==c&&W!==p&&Jm(x,P,T,k,S,R,W.x,W.y)&&Hs(W.prev,W,W.next)>=0))return!1;W=W.nextZ}for(;ce&&ce.z>=ee;){if(ce.x>=B&&ce.x<=$&&ce.y>=j&&ce.y<=K&&ce!==c&&ce!==p&&Jm(x,P,T,k,S,R,ce.x,ce.y)&&Hs(ce.prev,ce,ce.next)>=0)return!1;ce=ce.prevZ}for(;W&&W.z<=le;){if(W.x>=B&&W.x<=$&&W.y>=j&&W.y<=K&&W!==c&&W!==p&&Jm(x,P,T,k,S,R,W.x,W.y)&&Hs(W.prev,W,W.next)>=0)return!1;W=W.nextZ}return!0}function bI(i,e){let n=i;do{const o=n.prev,c=n.next.next;!Xf(o,c)&&Tb(o,n,n.next,c)&&eg(o,c)&&eg(c,o)&&(e.push(o.i,n.i,c.i),tg(n),tg(n.next),n=i=c),n=n.next}while(n!==i);return lf(n)}function wI(i,e,n,o,c,d){let p=i;do{let x=p.next.next;for(;x!==p.prev;){if(p.i!==x.i&&AI(p,x)){let T=Sb(p,x);return p=lf(p,p.next),T=lf(T,T.next),Qm(p,e,n,o,c,d,0),void Qm(T,e,n,o,c,d,0)}x=x.next}p=p.next}while(p!==i)}function TI(i,e){let n=i.x-e.x;return n===0&&(n=i.y-e.y,n===0)&&(n=(i.next.y-i.y)/(i.next.x-i.x)-(e.next.y-e.y)/(e.next.x-e.x)),n}function SI(i,e){const n=function(c,d){let p=d;const x=c.x,T=c.y;let S,P=-1/0;if(Xf(c,p))return p;do{if(Xf(c,p.next))return p.next;if(T<=p.y&&T>=p.next.y&&p.next.y!==p.y){const $=p.x+(T-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if($<=x&&$>P&&(P=$,S=p.x<p.next.x?p:p.next,$===x))return S}p=p.next}while(p!==d);if(!S)return null;const k=S,R=S.x,B=S.y;let j=1/0;p=S;do{if(x>=p.x&&p.x>=R&&x!==p.x&&wb(T<B?x:P,T,R,B,T<B?P:x,T,p.x,p.y)){const $=Math.abs(T-p.y)/(x-p.x);eg(p,c)&&($<j||$===j&&(p.x>S.x||p.x===S.x&&CI(S,p)))&&(S=p,j=$)}p=p.next}while(p!==k);return S}(i,e);if(!n)return e;const o=Sb(n,i);return lf(o,o.next),lf(n,n.next)}function CI(i,e){return Hs(i.prev,i,e.prev)<0&&Hs(e.next,i,i.next)<0}function mv(i,e,n,o,c){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-n)*c|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*c|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function EI(i){let e=i,n=i;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==i);return n}function wb(i,e,n,o,c,d,p,x){return(c-p)*(e-x)>=(i-p)*(d-x)&&(i-p)*(o-x)>=(n-p)*(e-x)&&(n-p)*(d-x)>=(c-p)*(o-x)}function Jm(i,e,n,o,c,d,p,x){return!(i===p&&e===x)&&wb(i,e,n,o,c,d,p,x)}function AI(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(n,o){let c=n;do{if(c.i!==n.i&&c.next.i!==n.i&&c.i!==o.i&&c.next.i!==o.i&&Tb(c,c.next,n,o))return!0;c=c.next}while(c!==n);return!1}(i,e)&&(eg(i,e)&&eg(e,i)&&function(n,o){let c=n,d=!1;const p=(n.x+o.x)/2,x=(n.y+o.y)/2;do c.y>x!=c.next.y>x&&c.next.y!==c.y&&p<(c.next.x-c.x)*(x-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next;while(c!==n);return d}(i,e)&&(Hs(i.prev,i,e.prev)||Hs(i,e.prev,e))||Xf(i,e)&&Hs(i.prev,i,i.next)>0&&Hs(e.prev,e,e.next)>0)}function Hs(i,e,n){return(e.y-i.y)*(n.x-e.x)-(e.x-i.x)*(n.y-e.y)}function Xf(i,e){return i.x===e.x&&i.y===e.y}function Tb(i,e,n,o){const c=v_(Hs(i,e,n)),d=v_(Hs(i,e,o)),p=v_(Hs(n,o,i)),x=v_(Hs(n,o,e));return c!==d&&p!==x||!(c!==0||!y_(i,n,e))||!(d!==0||!y_(i,o,e))||!(p!==0||!y_(n,i,o))||!(x!==0||!y_(n,e,o))}function y_(i,e,n){return e.x<=Math.max(i.x,n.x)&&e.x>=Math.min(i.x,n.x)&&e.y<=Math.max(i.y,n.y)&&e.y>=Math.min(i.y,n.y)}function v_(i){return i>0?1:i<0?-1:0}function eg(i,e){return Hs(i.prev,i,i.next)<0?Hs(i,e,i.next)>=0&&Hs(i,i.prev,e)>=0:Hs(i,e,i.prev)<0||Hs(i,i.next,e)<0}function Sb(i,e){const n=gv(i.i,i.x,i.y),o=gv(e.i,e.x,e.y),c=i.next,d=e.prev;return i.next=e,e.prev=i,n.next=c,c.prev=n,o.next=n,n.prev=o,d.next=o,o.prev=d,o}function Cb(i,e,n,o){const c=gv(i,e,n);return o?(c.next=o.next,c.prev=o,o.next.prev=c,o.next=c):(c.prev=c,c.next=c),c}function tg(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function gv(i,e,n){return{i,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function x_(i,e){const n=i.length;if(n<=1)return[i];const o=[];let c,d;for(let p=0;p<n;p++){const x=fi(i[p]);x!==0&&(i[p].area=Math.abs(x),d===void 0&&(d=x<0),d===x<0?(c&&o.push(c),c=[i[p]]):c.push(i[p]))}if(c&&o.push(c),e>1)for(let p=0;p<o.length;p++)o[p].length<=e||(xs(o[p],e,1,o[p].length-1,II),o[p]=o[p].slice(0,e));return o}function II(i,e){return e.area-i.area}function Eb(i,e,n=1){if(!i)return null;const o=typeof i=="string"?Po.from(i).getPrimary():i.getPrimary(),c=typeof i=="string"?null:i.getSecondary();for(const d of[o,c]){if(!d)continue;const p=d.id.toString();e.has(p)||e.set(p,[]),d.scaleSelf(n),e.get(p).push(d)}return{primary:o.toString(),secondary:c?c.toString():null}}function _v(i,e,n,o){const c=o.patternDependencies;let d=!1;for(const p of e){const x=p.paint.get(`${i}-pattern`);x.isConstant()||(d=!0),Eb(x.constantOr(null),c,n)&&(d=!0)}return d}function yv(i,e,n,o,c,d){const p=d.patternDependencies;for(const x of e){const T=x.paint.get(`${i}-pattern`).value;if(T.kind!=="constant"){let S=T.evaluate({zoom:o},n,{},d.availableImages);S=S&&S.name?S.name:S;const P=Eb(S,p,c);if(!P)continue;const{primary:k,secondary:R}=P;k&&(n.patterns[x.id]=[k,R].filter(Boolean))}}return n}class Ab{constructor(){this.polygons=new Map}add(e,...n){this.polygons.has(e)?this.polygons.get(e).push(...n):this.polygons.set(e,n)}merge(e){for(const[n,o]of e.polygons)this.add(n,...o)}}class cf{constructor(){this.portals=[]}static evaluate(e){if(e.length===0)return new cf;let n=[];for(const S of e)n.push(...S.portals);if(n.length===0)return new cf;const o=(S,P)=>S<=0&&P<=0||S>=Kt&&P>=Kt;for(const S of n){const P=S.va,k=S.vb;(o(P.x,k.x)||o(P.y,k.y))&&(S.type="border")}const c=n.filter(S=>S.type!=="unevaluated"),d=n.filter(S=>S.type==="unevaluated");if(d.length===0)return new cf;d.sort((S,P)=>S.hash===P.hash?S.isTunnel===P.isTunnel?0:S.isTunnel?-1:1:S.hash<P.hash?1:-1),n=c.concat(d);let p=c.length,x=p,T=p;do if(x++,x===n.length||n[p].hash!==n[x].hash){if(x-p==2){T<p&&(n[T]=n[p],n[p]=null);const S=n[T],P=n[x-1];S.type=S.isTunnel!==P.isTunnel?"tunnel":"polygon",S.connection={a:S.connection.a,b:P.connection.a},T++}p=x}while(p!==n.length);return n.splice(T),n.sort((S,P)=>S.hash<P.hash?1:-1),{portals:n}}}nn(cf,"ElevationPortalGraph"),nn(Ab,"ElevationPolygons");class PI{constructor(e,n,o){this.outPositions=e,this.outNormals=n,this.outIndices=o,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(e,n,o){let c=e[2];o!=null&&(c*=o);const d=this.getVec3Bits(e)<<96n|this.getVec3Bits(n),p=this.vertexLookup.get(d);if(p!=null)return p;const x=this.outPositions.length;this.vertexLookup.set(d,x);const T=Math.trunc(16384*n[0]),S=Math.trunc(16384*n[1]),P=Math.trunc(16384*n[2]);return this.outPositions.emplaceBack(e[0],e[1],c),this.outNormals.emplaceBack(T,S,P),x}addVertices(e,n,...o){const c=[];for(const d of o){const p=this.addVertex(d,e,n);c.push(p)}return c}addTriangles(e,n,o){if(n&&o){const c=o.length===1,d=xt(0,0,0);for(let p=0;p<e.length;p+=3){const x=n[e[p+0]],T=n[e[p+1]],S=n[e[p+2]],P=c?o[0]:o[e[p+1]],k=c?o[0]:o[e[p+2]],R=this.addVertex(xt(x.x,x.y,c?o[0]:o[e[p+0]]),d),B=this.addVertex(xt(T.x,T.y,P),d),j=this.addVertex(xt(S.x,S.y,k),d);this.outIndices.emplaceBack(R,B,j)}}else for(let c=0;c<e.length;c+=3)this.outIndices.emplaceBack(e[c+0],e[c+1],e[c+2])}addQuad(e,n){const o=this.addVertices(n,void 0,...e.map(T=>xt(T.coord.x,T.coord.y,T.height))),[c,d,p,x]=o;this.addTriangles([c,d,p,p,x,c])}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}getBits(e){return this.view.setFloat32(0,e),BigInt(this.view.getUint32(0))}getVec3Bits(e){return this.getBits(e[0])<<64n|this.getBits(e[1])<<32n|this.getBits(e[2])}}class dl{constructor(e,n,o,c){this.unevaluatedPortals=new cf,this.portalPolygons=new Ab,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new $p,this.vertexNormals=new np,this.indexArray=new ws,this.tileToMeters=st(e),this.bridgeProgramConfigurations=new u(n,{zoom:o,lut:c},d=>d!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new u(n,{zoom:o,lut:c},d=>d!=="fill-bridge-guard-rail-color")}addVertices(e,n){const o=this.unevalVertices.length;for(let c=0;c<e.length;c++)this.unevalVertices.push(e[c]),this.unevalHeights.push(n[c]);return o}addTriangles(e,n,o){const c=o?this.unevalTunnelTriangles:this.unevalTriangles;for(const d of e)c.push(d+n)}addRenderableRing(e,n,o,c,d,p){const x=[new Wt(d.min.x,d.min.y),new Wt(d.max.x,d.min.y),new Wt(d.max.x,d.max.y),new Wt(d.min.x,d.max.y)];for(let T=0;T<o-1;T++){const S=n+T,P=S+1,k=this.unevalVertices[S],R=this.unevalVertices[P];if(!(k.x>=d.min.x&&k.x<=d.max.x&&k.y>=d.min.y&&k.y<=d.max.y||R.x>=d.min.x&&R.x<=d.max.x&&R.y>=d.min.y&&R.y<=d.max.y||hl(k,R,x))||this.isOnBorder(k.x,R.x)||this.isOnBorder(k.y,R.y))continue;const B=dl.computeEdgeHash(this.unevalVertices[S],this.unevalVertices[P]);let j,$=this.vertexHashLookup.get(dl.computePosHash(k));$!=null?j=$.next:($=this.vertexHashLookup.get(dl.computePosHash(R)),j=$!=null?$.prev:B),this.unevalEdges.push({polygonIdx:e,a:S,b:P,hash:B,portalHash:j,isTunnel:c,type:"unevaluated",featureInfo:p})}}addPortalCandidates(e,n,o,c,d){if(n.length===0)return;this.portalPolygons.add(e,{geometry:n,zLevel:d});const p=n[0];this.vertexHashLookup.clear();let x=dl.computeEdgeHash(p[p.length-2],p[p.length-1]);for(let T=0;T<p.length-1;T++){const S=p[T+0],P=p[T+1],k=Ws(P.x-S.x,P.y-S.y),R=ro(k);if(R===0)continue;let B="unevaluated";const j=c.pointElevation(S),$=c.pointElevation(P);Math.abs(j)<.01&&Math.abs($)<.01?B="entrance":(this.isOnBorder(S.x,P.x)||this.isOnBorder(S.y,P.y))&&(B="border");const K=dl.computeEdgeHash(S,P);this.unevaluatedPortals.portals.push({connection:{a:e,b:void 0},va:S,vb:P,vab:k,length:R,hash:K,isTunnel:o,type:B});const ee=dl.computePosHash(S);this.vertexHashLookup.set(ee,{prev:x,next:K}),x=K}}construct(e){if(this.unevalVertices.length===0)return;const n=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),o=R=>{R.primitiveLength=this.indexArray.length-R.primitiveOffset},c=new PI(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(e.portals,this.unevalEdges);const d=n(),p=n(),x=n(),T=(R,B)=>{R.sort(($,K)=>$.type===B&&K.type!==B?-1:$.type!==B&&K.type===B?1:0);const j=R.findIndex($=>$.type!==B);return j>=0?j:R.length};let S=0;this.unevalEdges.length>0&&(S=T(this.unevalEdges,"none"),this.constructBridgeStructures(c,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:S},this.tileToMeters)),o(x);const P=n(),k=n();if(this.unevalEdges.length>0){const R=this.unevalEdges.splice(S),B=T(R,"tunnel")+S;this.unevalEdges.push(...R),this.constructTunnelStructures(c,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:S},{min:S,max:B})}o(P),c.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),o(k),c.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),o(p),c.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),o(d),this.maskSegments=Qi.simpleSegment(0,k.primitiveOffset,0,k.primitiveLength),this.depthSegments=Qi.simpleSegment(0,p.primitiveOffset,0,p.primitiveLength),this.renderableBridgeSegments=Qi.simpleSegment(0,x.primitiveOffset,0,x.primitiveLength),this.renderableTunnelSegments=Qi.simpleSegment(0,P.primitiveOffset,0,P.primitiveLength),this.shadowCasterSegments=Qi.simpleSegment(0,d.primitiveOffset,0,d.primitiveLength)}update(e,n,o,c,d,p,x,T){this.bridgeProgramConfigurations.updatePaintArrays(e,n,d,o,c,p,x,T),this.tunnelProgramConfigurations.updatePaintArrays(e,n,d,o,c,p,x,T)}upload(e){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=e.createVertexBuffer(this.vertexPositions,_I.members),this.vertexBufferNormal=e.createVertexBuffer(this.vertexNormals,yI.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(e),this.tunnelProgramConfigurations.upload(e))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(e,n,o,c,d){const p=(x,T)=>{for(let S=0;S<T.length-1;S++){const P=T[S].featureIndex,k=T[S+1].vertexStart,R=e.feature(P);x.populatePaintArrays(k,R,P,{},o,n,c,void 0,d)}};p(this.bridgeProgramConfigurations,this.bridgeFeatureSections),p(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(e,n,o,c,d){const p=new Map;for(let x=c;x<d;x++){const T=o[x],S=T.a,P=T.b,k=dl.computePosHash(e[S]),R=dl.computePosHash(e[P]);p.has(k)||p.set(k,{}),p.has(R)||p.set(R,{});const B=p.get(k),j=p.get(R);n[S]<=0&&n[P]<=0||(B.to=P,j.from=S)}return p}constructBridgeStructures(e,n,o,c,d,p){e.clearVertexLookup();const x=this.computeVertexConnections(n,o,c,d.min,d.max),T=1/p,S=.5*T,P=B=>xt(n[B].x,n[B].y,o[B]*T),k=B=>{const j=x.get(dl.computePosHash(n[B])),$=j.from,K=j.to;if(!$||!K)return;const ee=P($),le=P(B),ce=P(K),W=xt(0,0,0);if(!Yi(ee,le)){const he=Vn(et(),le,ee);At(W,W,xn(he,he))}if(!Yi(ce,le)){const he=Vn(et(),ce,le);At(W,W,xn(he,he))}const ae=zi(W);return ae>0?qt(W,W,1/ae):void 0};let R=Number.POSITIVE_INFINITY;this.sortSubarray(c,d.min,d.max,(B,j)=>B.featureInfo.featureIndex-j.featureInfo.featureIndex);for(let B=d.min;B<d.max;B++){const j=c[B];if(!j.featureInfo.guardRailEnabled)continue;const $=this.prepareEdgePoints(n,o,j,(Bn,ln)=>Bn>ln);if($==null)continue;const K=$[0],ee=$[1],le=xt(K.coord.x,K.coord.y,T*K.height),ce=xt(ee.coord.x,ee.coord.y,T*ee.height);if(Yi(le,ce))continue;const W=Vn(et(),ce,le);xn(W,W);const ae=Bn=>xn(Bn,Bn),he=k(j.a)||W,ge=k(j.b)||W,Be=ae(xt(he[1],-he[0],0)),ke=ae(xt(ge[1],-ge[0],0)),je=ae(ti(et(),Be,he)),Ze=ae(ti(et(),ke,ge)),ut=et(),Rt=[At(et(),le,qt(ut,Vn(ut,Be,je),S)),At(et(),le,qt(ut,At(ut,Be,je),S)),At(et(),le,qt(ut,je,S)),le],wt=[At(et(),ce,qt(ut,Vn(ut,ke,Ze),S)),At(et(),ce,qt(ut,At(ut,ke,Ze),S)),At(et(),ce,qt(ut,Ze,S)),ce];R=this.addFeatureSection(j.featureInfo.featureIndex,R,this.bridgeFeatureSections,e);const[Mt,Dt]=e.addVertices(Be,p,Rt[0],Rt[1]),[dt,Pt]=e.addVertices(ke,p,wt[0],wt[1]);e.addTriangles([Mt,Dt,dt,Dt,Pt,dt]);const[ct,ht]=e.addVertices(je,p,Rt[1],Rt[2]),[Nt,Vt]=e.addVertices(Ze,p,wt[1],wt[2]);e.addTriangles([ct,ht,Nt,ht,Vt,Nt]);const[yn,cn]=e.addVertices(zn(Be,Be),p,Rt[2],Rt[3]),[Jt,Ft]=e.addVertices(zn(ke,ke),p,wt[2],wt[3]);e.addTriangles([yn,cn,Jt,cn,Ft,Jt])}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:e.getVertexCount()})}constructTunnelStructures(e,n,o,c,d,p){e.clearVertexLookup();let x=Number.POSITIVE_INFINITY;const T=(P,k)=>P.featureInfo.featureIndex-k.featureInfo.featureIndex;this.sortSubarray(c,d.min,d.max,T),this.sortSubarray(c,p.min,p.max,T);const S=P=>xn(P,P);for(let P=d.min;P<d.max;P++){const k=this.prepareEdgePoints(n,o,c[P],($,K)=>$<K);if(k==null)continue;const[R,B]=k,j=S(xt(-(B.coord.y-R.coord.y),B.coord.x-R.coord.x,0));x=this.addFeatureSection(c[P].featureInfo.featureIndex,x,this.tunnelFeatureSections,e),e.addQuad([R,B,{coord:B.coord,height:c[P].isTunnel?-.1:0},{coord:R.coord,height:c[P].isTunnel?-.1:0}],j)}for(let P=p.min;P<p.max;P++){const k=c[P];k.isTunnel&&([k.a,k.b]=[k.b,k.a]);const R=n[k.a],B=n[k.b],j=S(xt(-(B.y-R.y),B.x-R.x,0));x=this.addFeatureSection(k.featureInfo.featureIndex,x,this.tunnelFeatureSections,e),e.addQuad([{coord:B,height:0},{coord:R,height:0},{coord:R,height:o[k.a]+4},{coord:B,height:o[k.b]+4}],j),e.addQuad([{coord:R,height:0},{coord:B,height:0},{coord:B,height:o[k.b]+4},{coord:R,height:o[k.a]+4}],j)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:e.getVertexCount()})}prepareEdgePoints(e,n,o,c){let d=n[o.a],p=n[o.b];const x=c(d,0),T=c(p,0);if(x&&T)return[{coord:e[o.a],height:d},{coord:e[o.b],height:p}];if(!x&&!T)return;const S=e[o.a].clone(),P=e[o.b].clone();if(x){if(!T){const k=p/(p-d);P.x=Cn(P.x,S.x,k),P.y=Cn(P.y,S.y,k),p=Cn(p,d,k)}}else{const k=d/(d-p);S.x=Cn(S.x,P.x,k),S.y=Cn(S.y,P.y,k),d=Cn(d,p,k)}return[{coord:S,height:d},{coord:P,height:p}]}prepareEdges(e,n){if(n.length===0)return;n.sort((x,T)=>x.hash===T.hash?T.polygonIdx-x.polygonIdx:T.hash>x.hash?1:-1);let o=0,c=0,d=0,p=n[o].polygonIdx;do c++,(c===n.length||n[o].hash!==n[c].hash)&&((c-o==1||n[c-1].polygonIdx!==p)&&(d<o&&(n[d]=n[o],n[o]=null),n[d].type="none",d++),o=c,o!==n.length&&(p=n[o].polygonIdx));while(o!==n.length);if(n.splice(d),n.length!==0&&e.length!==0){n.sort((S,P)=>S.portalHash<P.portalHash?1:-1);let x=0,T=0;for(;x!==n.length&&T!==e.length;){const S=n[x],P=e[T];S.portalHash>P.hash?x++:P.hash>S.portalHash?T++:(S.type=P.type,x++)}}}isOnBorder(e,n){return e<=0&&n<=0||e>=Kt&&n>=Kt}addFeatureSection(e,n,o,c){return e!==n&&(n=e,o.push({featureIndex:e,vertexStart:c.getVertexCount()}),c.clearVertexLookup()),n}sortSubarray(e,n,o,c){const d=e.slice(n,o);d.sort(c),e.splice(n,d.length,...d)}static computeEdgeHash(e,n){return(e.y===n.y&&e.x>n.x||e.y>n.y)&&([e,n]=[n,e]),BigInt(dl.computePosHash(e))<<32n|BigInt(dl.computePosHash(n))}static computePosHash(e){return((65535&e.x)<<16|65535&e.y)>>>0}}var Ib,Pb={exports:{}},kb=(Ib||(Ib=1,function(i,e){(function(n){function o(fe,we){return fe>we?1:fe<we?-1:0}var c=function(fe,we){fe===void 0&&(fe=o),we===void 0&&(we=!1),this._compare=fe,this._root=null,this._size=0,this._noDuplicates=!!we},d={size:{configurable:!0}};function p(fe,we,gt,$t,en){var Qt=en-$t;if(Qt>0){var on=$t+Math.floor(Qt/2),kn={key:we[on],data:gt[on],parent:fe};return kn.left=p(kn,we,gt,$t,on),kn.right=p(kn,we,gt,on+1,en),kn}return null}function x(fe,we,gt,$t,en){if(!(gt>=$t)){for(var Qt=fe[gt+$t>>1],on=gt-1,kn=$t+1;;){do on++;while(en(fe[on],Qt)<0);do kn--;while(en(fe[kn],Qt)>0);if(on>=kn)break;var mi=fe[on];fe[on]=fe[kn],fe[kn]=mi,mi=we[on],we[on]=we[kn],we[kn]=mi}x(fe,we,gt,kn,en),x(fe,we,kn+1,$t,en)}}c.prototype.rotateLeft=function(fe){var we=fe.right;we&&(fe.right=we.left,we.left&&(we.left.parent=fe),we.parent=fe.parent),fe.parent?fe===fe.parent.left?fe.parent.left=we:fe.parent.right=we:this._root=we,we&&(we.left=fe),fe.parent=we},c.prototype.rotateRight=function(fe){var we=fe.left;we&&(fe.left=we.right,we.right&&(we.right.parent=fe),we.parent=fe.parent),fe.parent?fe===fe.parent.left?fe.parent.left=we:fe.parent.right=we:this._root=we,we&&(we.right=fe),fe.parent=we},c.prototype._splay=function(fe){for(;fe.parent;){var we=fe.parent;we.parent?we.left===fe&&we.parent.left===we?(this.rotateRight(we.parent),this.rotateRight(we)):we.right===fe&&we.parent.right===we?(this.rotateLeft(we.parent),this.rotateLeft(we)):we.left===fe&&we.parent.right===we?(this.rotateRight(we),this.rotateLeft(we)):(this.rotateLeft(we),this.rotateRight(we)):we.left===fe?this.rotateRight(we):this.rotateLeft(we)}},c.prototype.splay=function(fe){for(var we,gt,$t,en,Qt;fe.parent;)(gt=(we=fe.parent).parent)&&gt.parent?(($t=gt.parent).left===gt?$t.left=fe:$t.right=fe,fe.parent=$t):(fe.parent=null,this._root=fe),en=fe.left,Qt=fe.right,fe===we.left?(gt&&(gt.left===we?(we.right?(gt.left=we.right,gt.left.parent=gt):gt.left=null,we.right=gt,gt.parent=we):(en?(gt.right=en,en.parent=gt):gt.right=null,fe.left=gt,gt.parent=fe)),Qt?(we.left=Qt,Qt.parent=we):we.left=null,fe.right=we,we.parent=fe):(gt&&(gt.right===we?(we.left?(gt.right=we.left,gt.right.parent=gt):gt.right=null,we.left=gt,gt.parent=we):(Qt?(gt.left=Qt,Qt.parent=gt):gt.left=null,fe.right=gt,gt.parent=fe)),en?(we.right=en,en.parent=we):we.right=null,fe.left=we,we.parent=fe)},c.prototype.replace=function(fe,we){fe.parent?fe===fe.parent.left?fe.parent.left=we:fe.parent.right=we:this._root=we,we&&(we.parent=fe.parent)},c.prototype.minNode=function(fe){if(fe===void 0&&(fe=this._root),fe)for(;fe.left;)fe=fe.left;return fe},c.prototype.maxNode=function(fe){if(fe===void 0&&(fe=this._root),fe)for(;fe.right;)fe=fe.right;return fe},c.prototype.insert=function(fe,we){var gt=this._root,$t=null,en=this._compare;if(this._noDuplicates)for(;gt;){if($t=gt,en(gt.key,fe)===0)return;gt=en(gt.key,fe)<0?gt.right:gt.left}else for(;gt;)$t=gt,gt=en(gt.key,fe)<0?gt.right:gt.left;return gt={key:fe,data:we,left:null,right:null,parent:$t},$t?en($t.key,gt.key)<0?$t.right=gt:$t.left=gt:this._root=gt,this.splay(gt),this._size++,gt},c.prototype.find=function(fe){for(var we=this._root,gt=this._compare;we;){var $t=gt(we.key,fe);if($t<0)we=we.right;else{if(!($t>0))return we;we=we.left}}return null},c.prototype.contains=function(fe){for(var we=this._root,gt=this._compare;we;){var $t=gt(fe,we.key);if($t===0)return!0;we=$t<0?we.left:we.right}return!1},c.prototype.remove=function(fe){var we=this.find(fe);if(!we)return!1;if(this.splay(we),we.left)if(we.right){var gt=this.minNode(we.right);gt.parent!==we&&(this.replace(gt,gt.right),gt.right=we.right,gt.right.parent=gt),this.replace(we,gt),gt.left=we.left,gt.left.parent=gt}else this.replace(we,we.left);else this.replace(we,we.right);return this._size--,!0},c.prototype.removeNode=function(fe){if(!fe)return!1;if(this.splay(fe),fe.left)if(fe.right){var we=this.minNode(fe.right);we.parent!==fe&&(this.replace(we,we.right),we.right=fe.right,we.right.parent=we),this.replace(fe,we),we.left=fe.left,we.left.parent=we}else this.replace(fe,fe.left);else this.replace(fe,fe.right);return this._size--,!0},c.prototype.erase=function(fe){var we=this.find(fe);if(we){this.splay(we);var gt=we.left,$t=we.right,en=null;gt&&(gt.parent=null,en=this.maxNode(gt),this.splay(en),this._root=en),$t&&(gt?en.right=$t:this._root=$t,$t.parent=en),this._size--}},c.prototype.pop=function(){var fe=this._root,we=null;if(fe){for(;fe.left;)fe=fe.left;we={key:fe.key,data:fe.data},this.remove(fe.key)}return we},c.prototype.next=function(fe){var we=fe;if(we)if(we.right)for(we=we.right;we&&we.left;)we=we.left;else for(we=fe.parent;we&&we.right===fe;)fe=we,we=we.parent;return we},c.prototype.prev=function(fe){var we=fe;if(we)if(we.left)for(we=we.left;we&&we.right;)we=we.right;else for(we=fe.parent;we&&we.left===fe;)fe=we,we=we.parent;return we},c.prototype.forEach=function(fe){for(var we=this._root,gt=[],$t=!1,en=0;!$t;)we?(gt.push(we),we=we.left):gt.length>0?(fe(we=gt.pop(),en++),we=we.right):$t=!0;return this},c.prototype.range=function(fe,we,gt,$t){for(var en=[],Qt=this._compare,on=this._root;en.length!==0||on;)if(on)en.push(on),on=on.left;else{if(Qt((on=en.pop()).key,we)>0)break;if(Qt(on.key,fe)>=0&&gt.call($t,on))return this;on=on.right}return this},c.prototype.keys=function(){for(var fe=this._root,we=[],gt=[],$t=!1;!$t;)fe?(we.push(fe),fe=fe.left):we.length>0?(fe=we.pop(),gt.push(fe.key),fe=fe.right):$t=!0;return gt},c.prototype.values=function(){for(var fe=this._root,we=[],gt=[],$t=!1;!$t;)fe?(we.push(fe),fe=fe.left):we.length>0?(fe=we.pop(),gt.push(fe.data),fe=fe.right):$t=!0;return gt},c.prototype.at=function(fe){for(var we=this._root,gt=[],$t=!1,en=0;!$t;)if(we)gt.push(we),we=we.left;else if(gt.length>0){if(we=gt.pop(),en===fe)return we;en++,we=we.right}else $t=!0;return null},c.prototype.load=function(fe,we,gt){if(fe===void 0&&(fe=[]),we===void 0&&(we=[]),gt===void 0&&(gt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var $t=fe.length;return gt&&x(fe,we,0,$t-1,this._compare),this._root=p(null,fe,we,0,$t),this._size=$t,this},c.prototype.min=function(){var fe=this.minNode(this._root);return fe?fe.key:null},c.prototype.max=function(){var fe=this.maxNode(this._root);return fe?fe.key:null},c.prototype.isEmpty=function(){return this._root===null},d.size.get=function(){return this._size},c.createTree=function(fe,we,gt,$t,en){return new c(gt,en).load(fe,we,$t)},Object.defineProperties(c.prototype,d);var T=0,S=1,P=2,k=3,R=0,B=1,j=2,$=3;function K(fe,we,gt){we===null?(fe.inOut=!1,fe.otherInOut=!0):(fe.isSubject===we.isSubject?(fe.inOut=!we.inOut,fe.otherInOut=we.otherInOut):(fe.inOut=!we.otherInOut,fe.otherInOut=we.isVertical()?!we.inOut:we.inOut),we&&(fe.prevInResult=!ee(we,gt)||we.isVertical()?we.prevInResult:we));var $t=ee(fe,gt);fe.resultTransition=$t?function(en,Qt){var on,kn=!en.inOut,mi=!en.otherInOut;switch(Qt){case R:on=kn&&mi;break;case B:on=kn||mi;break;case $:on=kn^mi;break;case j:on=en.isSubject?kn&&!mi:mi&&!kn}return on?1:-1}(fe,gt):0}function ee(fe,we){switch(fe.type){case T:switch(we){case R:return!fe.otherInOut;case B:return fe.otherInOut;case j:return fe.isSubject&&fe.otherInOut||!fe.isSubject&&!fe.otherInOut;case $:return!0}break;case P:return we===R||we===B;case k:return we===j;case S:return!1}return!1}var le=function(fe,we,gt,$t,en){this.left=we,this.point=fe,this.otherEvent=gt,this.isSubject=$t,this.type=en||T,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},ce={inResult:{configurable:!0}};function W(fe,we){return fe[0]===we[0]&&fe[1]===we[1]}le.prototype.isBelow=function(fe){var we=this.point,gt=this.otherEvent.point;return this.left?(we[0]-fe[0])*(gt[1]-fe[1])-(gt[0]-fe[0])*(we[1]-fe[1])>0:(gt[0]-fe[0])*(we[1]-fe[1])-(we[0]-fe[0])*(gt[1]-fe[1])>0},le.prototype.isAbove=function(fe){return!this.isBelow(fe)},le.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},ce.inResult.get=function(){return this.resultTransition!==0},le.prototype.clone=function(){var fe=new le(this.point,this.left,this.otherEvent,this.isSubject,this.type);return fe.contourId=this.contourId,fe.resultTransition=this.resultTransition,fe.prevInResult=this.prevInResult,fe.isExteriorRing=this.isExteriorRing,fe.inOut=this.inOut,fe.otherInOut=this.otherInOut,fe},Object.defineProperties(le.prototype,ce);var ae=11102230246251565e-32,he=134217729,ge=(3+8*ae)*ae;function Be(fe,we,gt,$t,en){var Qt,on,kn,mi,gi=we[0],Jn=$t[0],$i=0,ur=0;Jn>gi==Jn>-gi?(Qt=gi,gi=we[++$i]):(Qt=Jn,Jn=$t[++ur]);var _i=0;if($i<fe&&ur<gt)for(Jn>gi==Jn>-gi?(kn=Qt-((on=gi+Qt)-gi),gi=we[++$i]):(kn=Qt-((on=Jn+Qt)-Jn),Jn=$t[++ur]),Qt=on,kn!==0&&(en[_i++]=kn);$i<fe&&ur<gt;)Jn>gi==Jn>-gi?(kn=Qt-((on=Qt+gi)-(mi=on-Qt))+(gi-mi),gi=we[++$i]):(kn=Qt-((on=Qt+Jn)-(mi=on-Qt))+(Jn-mi),Jn=$t[++ur]),Qt=on,kn!==0&&(en[_i++]=kn);for(;$i<fe;)kn=Qt-((on=Qt+gi)-(mi=on-Qt))+(gi-mi),gi=we[++$i],Qt=on,kn!==0&&(en[_i++]=kn);for(;ur<gt;)kn=Qt-((on=Qt+Jn)-(mi=on-Qt))+(Jn-mi),Jn=$t[++ur],Qt=on,kn!==0&&(en[_i++]=kn);return Qt===0&&_i!==0||(en[_i++]=Qt),_i}function ke(fe){return new Float64Array(fe)}var je=33306690738754716e-32,Ze=22204460492503146e-32,ut=11093356479670487e-47,Rt=ke(4),wt=ke(8),Mt=ke(12),Dt=ke(16),dt=ke(4);function Pt(fe,we,gt){var $t=function(en,Qt,on,kn,mi,gi){var Jn=(Qt-gi)*(on-mi),$i=(en-mi)*(kn-gi),ur=Jn-$i;if(Jn===0||$i===0||Jn>0!=$i>0)return ur;var _i=Math.abs(Jn+$i);return Math.abs(ur)>=je*_i?ur:-function(Fr,gr,qi,Ur,wr,hr,_r){var Wi,ri,Xi,jr,En,Si,Tr,Vr,Ar,gs,tr,ps,ba,To,co,wa,gh,_s,Rs=Fr-wr,So=qi-wr,ta=gr-hr,Fo=Ur-hr;Rt[0]=(co=(Vr=Rs-(Tr=(Si=he*Rs)-(Si-Rs)))*(gs=Fo-(Ar=(Si=he*Fo)-(Si-Fo)))-((To=Rs*Fo)-Tr*Ar-Vr*Ar-Tr*gs))-((tr=co-(gh=(Vr=ta-(Tr=(Si=he*ta)-(Si-ta)))*(gs=So-(Ar=(Si=he*So)-(Si-So)))-((wa=ta*So)-Tr*Ar-Vr*Ar-Tr*gs)))+(En=co-tr))+(En-gh),Rt[1]=(ba=To-((ps=To+tr)-(En=ps-To))+(tr-En))-((tr=ba-wa)+(En=ba-tr))+(En-wa),Rt[2]=ps-((_s=ps+tr)-(En=_s-ps))+(tr-En),Rt[3]=_s;var wp=function(sU,jT){for(var NT=jT[0],Tx=1;Tx<4;Tx++)NT+=jT[Tx];return NT}(0,Rt),Pg=Ze*_r;if(wp>=Pg||-wp>=Pg||(Wi=Fr-(Rs+(En=Fr-Rs))+(En-wr),Xi=qi-(So+(En=qi-So))+(En-wr),ri=gr-(ta+(En=gr-ta))+(En-hr),jr=Ur-(Fo+(En=Ur-Fo))+(En-hr),Wi===0&&ri===0&&Xi===0&&jr===0)||(Pg=ut*_r+ge*Math.abs(wp),(wp+=Rs*jr+Fo*Wi-(ta*Xi+So*ri))>=Pg||-wp>=Pg))return wp;dt[0]=(co=(Vr=Wi-(Tr=(Si=he*Wi)-(Si-Wi)))*(gs=Fo-(Ar=(Si=he*Fo)-(Si-Fo)))-((To=Wi*Fo)-Tr*Ar-Vr*Ar-Tr*gs))-((tr=co-(gh=(Vr=ri-(Tr=(Si=he*ri)-(Si-ri)))*(gs=So-(Ar=(Si=he*So)-(Si-So)))-((wa=ri*So)-Tr*Ar-Vr*Ar-Tr*gs)))+(En=co-tr))+(En-gh),dt[1]=(ba=To-((ps=To+tr)-(En=ps-To))+(tr-En))-((tr=ba-wa)+(En=ba-tr))+(En-wa),dt[2]=ps-((_s=ps+tr)-(En=_s-ps))+(tr-En),dt[3]=_s;var _M=Be(4,Rt,4,dt,wt);dt[0]=(co=(Vr=Rs-(Tr=(Si=he*Rs)-(Si-Rs)))*(gs=jr-(Ar=(Si=he*jr)-(Si-jr)))-((To=Rs*jr)-Tr*Ar-Vr*Ar-Tr*gs))-((tr=co-(gh=(Vr=ta-(Tr=(Si=he*ta)-(Si-ta)))*(gs=Xi-(Ar=(Si=he*Xi)-(Si-Xi)))-((wa=ta*Xi)-Tr*Ar-Vr*Ar-Tr*gs)))+(En=co-tr))+(En-gh),dt[1]=(ba=To-((ps=To+tr)-(En=ps-To))+(tr-En))-((tr=ba-wa)+(En=ba-tr))+(En-wa),dt[2]=ps-((_s=ps+tr)-(En=_s-ps))+(tr-En),dt[3]=_s;var yM=Be(_M,wt,4,dt,Mt);dt[0]=(co=(Vr=Wi-(Tr=(Si=he*Wi)-(Si-Wi)))*(gs=jr-(Ar=(Si=he*jr)-(Si-jr)))-((To=Wi*jr)-Tr*Ar-Vr*Ar-Tr*gs))-((tr=co-(gh=(Vr=ri-(Tr=(Si=he*ri)-(Si-ri)))*(gs=Xi-(Ar=(Si=he*Xi)-(Si-Xi)))-((wa=ri*Xi)-Tr*Ar-Vr*Ar-Tr*gs)))+(En=co-tr))+(En-gh),dt[1]=(ba=To-((ps=To+tr)-(En=ps-To))+(tr-En))-((tr=ba-wa)+(En=ba-tr))+(En-wa),dt[2]=ps-((_s=ps+tr)-(En=_s-ps))+(tr-En),dt[3]=_s;var vM=Be(yM,Mt,4,dt,Dt);return Dt[vM-1]}(en,Qt,on,kn,mi,gi,_i)}(fe[0],fe[1],we[0],we[1],gt[0],gt[1]);return $t>0?-1:$t<0?1:0}function ct(fe,we){var gt=fe.point,$t=we.point;return gt[0]>$t[0]?1:gt[0]<$t[0]?-1:gt[1]!==$t[1]?gt[1]>$t[1]?1:-1:function(en,Qt,on,kn){return en.left!==Qt.left?en.left?1:-1:Pt(on,en.otherEvent.point,Qt.otherEvent.point)!==0?en.isBelow(Qt.otherEvent.point)?-1:1:!en.isSubject&&Qt.isSubject?1:-1}(fe,we,gt)}function ht(fe,we,gt){var $t=new le(we,!1,fe,fe.isSubject),en=new le(we,!0,fe.otherEvent,fe.isSubject);return W(fe.point,fe.otherEvent.point)&&console.warn("what is that, a collapsed segment?",fe),$t.contourId=en.contourId=fe.contourId,ct(en,fe.otherEvent)>0&&(fe.otherEvent.left=!0,en.left=!1),fe.otherEvent.otherEvent=en,fe.otherEvent=$t,gt.push(en),gt.push($t),gt}function Nt(fe,we){return fe[0]*we[1]-fe[1]*we[0]}function Vt(fe,we){return fe[0]*we[0]+fe[1]*we[1]}function yn(fe,we,gt){var $t=function(mi,gi,Jn,$i,ur){var _i=[gi[0]-mi[0],gi[1]-mi[1]],Fr=[$i[0]-Jn[0],$i[1]-Jn[1]];function gr(Si,Tr,Vr){return[Si[0]+Tr*Vr[0],Si[1]+Tr*Vr[1]]}var qi=[Jn[0]-mi[0],Jn[1]-mi[1]],Ur=Nt(_i,Fr),wr=Ur*Ur,hr=Vt(_i,_i);if(wr>0){var _r=Nt(qi,Fr)/Ur;if(_r<0||_r>1)return null;var Wi=Nt(qi,_i)/Ur;return Wi<0||Wi>1?null:_r===0||_r===1?[gr(mi,_r,_i)]:Wi===0||Wi===1?[gr(Jn,Wi,Fr)]:[gr(mi,_r,_i)]}if((wr=(Ur=Nt(qi,_i))*Ur)>0)return null;var ri=Vt(_i,qi)/hr,Xi=ri+Vt(_i,Fr)/hr,jr=Math.min(ri,Xi),En=Math.max(ri,Xi);return jr<=1&&En>=0?jr===1?[gr(mi,jr>0?jr:0,_i)]:En===0?[gr(mi,En<1?En:1,_i)]:[gr(mi,jr>0?jr:0,_i),gr(mi,En<1?En:1,_i)]:null}(fe.point,fe.otherEvent.point,we.point,we.otherEvent.point),en=$t?$t.length:0;if(en===0||en===1&&(W(fe.point,we.point)||W(fe.otherEvent.point,we.otherEvent.point))||en===2&&fe.isSubject===we.isSubject)return 0;if(en===1)return W(fe.point,$t[0])||W(fe.otherEvent.point,$t[0])||ht(fe,$t[0],gt),W(we.point,$t[0])||W(we.otherEvent.point,$t[0])||ht(we,$t[0],gt),1;var Qt=[],on=!1,kn=!1;return W(fe.point,we.point)?on=!0:ct(fe,we)===1?Qt.push(we,fe):Qt.push(fe,we),W(fe.otherEvent.point,we.otherEvent.point)?kn=!0:ct(fe.otherEvent,we.otherEvent)===1?Qt.push(we.otherEvent,fe.otherEvent):Qt.push(fe.otherEvent,we.otherEvent),on&&kn||on?(we.type=S,fe.type=we.inOut===fe.inOut?P:k,on&&!kn&&ht(Qt[1].otherEvent,Qt[0].point,gt),2):kn?(ht(Qt[0],Qt[1].point,gt),3):Qt[0]!==Qt[3].otherEvent?(ht(Qt[0],Qt[1].point,gt),ht(Qt[1],Qt[2].point,gt),3):(ht(Qt[0],Qt[1].point,gt),ht(Qt[3].otherEvent,Qt[2].point,gt),3)}function cn(fe,we){if(fe===we)return 0;if(Pt(fe.point,fe.otherEvent.point,we.point)!==0||Pt(fe.point,fe.otherEvent.point,we.otherEvent.point)!==0)return W(fe.point,we.point)?fe.isBelow(we.otherEvent.point)?-1:1:fe.point[0]===we.point[0]?fe.point[1]<we.point[1]?-1:1:ct(fe,we)===1?we.isAbove(fe.point)?-1:1:fe.isBelow(we.point)?-1:1;if(fe.isSubject!==we.isSubject)return fe.isSubject?-1:1;var gt=fe.point,$t=we.point;return gt[0]===$t[0]&&gt[1]===$t[1]?(gt=fe.otherEvent.point)[0]===($t=we.otherEvent.point)[0]&&gt[1]===$t[1]?0:fe.contourId>we.contourId?1:-1:ct(fe,we)===1?1:-1}var Jt=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Ft(fe,we,gt,$t){var en,Qt=fe+1,on=we[fe].point,kn=we.length;for(Qt<kn&&(en=we[Qt].point);Qt<kn&&en[0]===on[0]&&en[1]===on[1];){if(!gt[Qt])return Qt;++Qt<kn&&(en=we[Qt].point)}for(Qt=fe-1;gt[Qt]&&Qt>$t;)Qt--;return Qt}Jt.prototype.isExterior=function(){return this.holeOf==null};var Bn=un,ln=un;function un(fe,we){if(!(this instanceof un))return new un(fe,we);if(this.data=fe||[],this.length=this.data.length,this.compare=we||Mn,this.length>0)for(var gt=(this.length>>1)-1;gt>=0;gt--)this._down(gt)}function Mn(fe,we){return fe<we?-1:fe>we?1:0}un.prototype={push:function(fe){this.data.push(fe),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var fe=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),fe}},peek:function(){return this.data[0]},_up:function(fe){for(var we=this.data,gt=this.compare,$t=we[fe];fe>0;){var en=fe-1>>1,Qt=we[en];if(gt($t,Qt)>=0)break;we[fe]=Qt,fe=en}we[fe]=$t},_down:function(fe){for(var we=this.data,gt=this.compare,$t=this.length>>1,en=we[fe];fe<$t;){var Qt=1+(fe<<1),on=Qt+1,kn=we[Qt];if(on<this.length&&gt(we[on],kn)<0&&(Qt=on,kn=we[on]),gt(kn,en)>=0)break;we[fe]=kn,fe=Qt}we[fe]=en}},Bn.default=ln;var Xn=Math.max,Gn=Math.min,ai=0;function Qn(fe,we,gt,$t,en,Qt){var on,kn,mi,gi,Jn,$i;for(on=0,kn=fe.length-1;on<kn;on++)if(gi=fe[on+1],Jn=new le(mi=fe[on],!1,void 0,we),$i=new le(gi,!1,Jn,we),Jn.otherEvent=$i,mi[0]!==gi[0]||mi[1]!==gi[1]){Jn.contourId=$i.contourId=gt,Qt||(Jn.isExteriorRing=!1,$i.isExteriorRing=!1),ct(Jn,$i)>0?$i.left=!0:Jn.left=!0;var ur=mi[0],_i=mi[1];en[0]=Gn(en[0],ur),en[1]=Gn(en[1],_i),en[2]=Xn(en[2],ur),en[3]=Xn(en[3],_i),$t.push(Jn),$t.push($i)}}var li=[];function Vi(fe,we,gt){typeof fe[0][0][0]=="number"&&(fe=[fe]),typeof we[0][0][0]=="number"&&(we=[we]);var $t=function(_i,Fr,gr){var qi=null;return _i.length*Fr.length==0&&(gr===R?qi=li:gr===j?qi=_i:gr!==B&&gr!==$||(qi=_i.length===0?Fr:_i)),qi}(fe,we,gt);if($t)return $t===li?null:$t;var en=[1/0,1/0,-1/0,-1/0],Qt=[1/0,1/0,-1/0,-1/0],on=function(_i,Fr,gr,qi,Ur){var wr,hr,_r,Wi,ri,Xi,jr=new Bn(null,ct);for(_r=0,Wi=_i.length;_r<Wi;_r++)for(ri=0,Xi=(wr=_i[_r]).length;ri<Xi;ri++)(hr=ri===0)&&ai++,Qn(wr[ri],!0,ai,jr,gr,hr);for(_r=0,Wi=Fr.length;_r<Wi;_r++)for(ri=0,Xi=(wr=Fr[_r]).length;ri<Xi;ri++)hr=ri===0,Ur===j&&(hr=!1),hr&&ai++,Qn(wr[ri],!1,ai,jr,qi,hr);return jr}(fe,we,en,Qt,gt);if($t=function(_i,Fr,gr,qi,Ur){var wr=null;return(gr[0]>qi[2]||qi[0]>gr[2]||gr[1]>qi[3]||qi[1]>gr[3])&&(Ur===R?wr=li:Ur===j?wr=_i:Ur!==B&&Ur!==$||(wr=_i.concat(Fr))),wr}(fe,we,en,Qt,gt))return $t===li?null:$t;for(var kn=function(_i){var Fr,gr,qi=function(_r){var Wi,ri,Xi,jr,En=[];for(ri=0,Xi=_r.length;ri<Xi;ri++)((Wi=_r[ri]).left&&Wi.inResult||!Wi.left&&Wi.otherEvent.inResult)&&En.push(Wi);for(var Si=!1;!Si;)for(Si=!0,ri=0,Xi=En.length;ri<Xi;ri++)ri+1<Xi&&ct(En[ri],En[ri+1])===1&&(jr=En[ri],En[ri]=En[ri+1],En[ri+1]=jr,Si=!1);for(ri=0,Xi=En.length;ri<Xi;ri++)(Wi=En[ri]).otherPos=ri;for(ri=0,Xi=En.length;ri<Xi;ri++)(Wi=En[ri]).left||(jr=Wi.otherPos,Wi.otherPos=Wi.otherEvent.otherPos,Wi.otherEvent.otherPos=jr);return En}(_i),Ur={},wr=[],hr=function(){if(!Ur[Fr]){var _r=wr.length,Wi=function(En,Si,Tr){var Vr=new Jt;if(En.prevInResult!=null){var Ar=En.prevInResult,gs=Ar.outputContourId;if(Ar.resultTransition>0){var tr=Si[gs];if(tr.holeOf!=null){var ps=tr.holeOf;Si[ps].holeIds.push(Tr),Vr.holeOf=ps,Vr.depth=Si[gs].depth}else Si[gs].holeIds.push(Tr),Vr.holeOf=gs,Vr.depth=Si[gs].depth+1}else Vr.holeOf=null,Vr.depth=Si[gs].depth}else Vr.holeOf=null,Vr.depth=0;return Vr}(qi[Fr],wr,_r),ri=function(En){Ur[En]=!0,En<qi.length&&qi[En]&&(qi[En].outputContourId=_r)},Xi=Fr,jr=Fr;for(Wi.points.push(qi[Fr].point);ri(Xi),ri(Xi=qi[Xi].otherPos),Wi.points.push(qi[Xi].point),!((Xi=Ft(Xi,qi,Ur,jr))==jr||Xi>=qi.length)&&qi[Xi];);wr.push(Wi)}};for(Fr=0,gr=qi.length;Fr<gr;Fr++)hr();return wr}(function(_i,Fr,gr,qi,Ur,wr){for(var hr,_r,Wi,ri=new c(cn),Xi=[],jr=Math.min(qi[2],Ur[2]);_i.length!==0;){var En=_i.pop();if(Xi.push(En),wr===R&&En.point[0]>jr||wr===j&&En.point[0]>qi[2])break;if(En.left){_r=hr=ri.insert(En),hr=hr!==(Wi=ri.minNode())?ri.prev(hr):null,_r=ri.next(_r);var Si=hr?hr.key:null;if(K(En,Si,wr),_r&&yn(En,_r.key,_i)===2&&(K(En,Si,wr),K(_r.key,En,wr)),hr&&yn(hr.key,En,_i)===2){var Tr=hr;K(Si,(Tr=Tr!==Wi?ri.prev(Tr):null)?Tr.key:null,wr),K(En,Si,wr)}}else _r=hr=ri.find(En=En.otherEvent),hr&&_r&&(hr=hr!==Wi?ri.prev(hr):null,_r=ri.next(_r),ri.remove(En),_r&&hr&&yn(hr.key,_r.key,_i))}return Xi}(on,0,0,en,Qt,gt)),mi=[],gi=0;gi<kn.length;gi++){var Jn=kn[gi];if(Jn.isExterior()){for(var $i=[Jn.points],ur=0;ur<Jn.holeIds.length;ur++)$i.push(kn[Jn.holeIds[ur]].points);mi.push($i)}}return mi}var mr={UNION:B,DIFFERENCE:j,INTERSECTION:R,XOR:$};n.diff=function(fe,we){return Vi(fe,we,j)},n.intersection=function(fe,we){return Vi(fe,we,R)},n.operations=mr,n.union=function(fe,we){return Vi(fe,we,B)},n.xor=function(fe,we){return Vi(fe,we,$)},Object.defineProperty(n,"__esModule",{value:!0})})(e)}(0,Pb.exports)),Pb.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function b_(i,e,n,o){const c=[],d=o===0?(p,x,T,S,P,k)=>{p.push(new Wt(k,T+(k-x)/(S-x)*(P-T)))}:(p,x,T,S,P,k)=>{p.push(new Wt(x+(k-T)/(P-T)*(S-x),k))};for(const p of i){const x=[];for(const T of p){if(T.length<=2)continue;const S=[];for(let R=0;R<T.length-1;R++){const B=T[R].x,j=T[R].y,$=T[R+1].x,K=T[R+1].y,ee=o===0?B:j,le=o===0?$:K;ee<e?le>e&&d(S,B,j,$,K,e):ee>n?le<n&&d(S,B,j,$,K,n):S.push(T[R]),le<e&&ee>=e&&d(S,B,j,$,K,e),le>n&&ee<=n&&d(S,B,j,$,K,n)}let P=T[T.length-1];const k=o===0?P.x:P.y;k>=e&&k<=n&&S.push(P),S.length&&(P=S[S.length-1],S[0].x===P.x&&S[0].y===P.y||S.push(S[0]),x.push(S))}x.length&&c.push(x)}return c}function kI(i,e){const n=vv(i),o=vv([e]),c=kb.intersection(n,o);return c==null?[]:Mb(c)}function MI(i,e){let o=vv(i,65536);for(;e.valid();e.next()){const[c,d]=e.get(),p=c.x*65536,x=c.y*65536,T=d.x*65536,S=d.y*65536,P=T-p,k=S-x,R=Math.hypot(P,k),B=Math.trunc(k/R*3),j=-Math.trunc(P/R*3);o=kb.diff(o,[[[p,x],[T,S],[T+B,S+j],[p+B,x+j],[p,x]]])}return Mb(o,1/65536)}function vv(i,e=1){return[i.map(n=>n.map(o=>[o.x*e,o.y*e]))]}function Mb(i,e=1){return i.map(n=>n.map((o,c)=>{const d=o.map(p=>new Wt(p[0]*e,p[1]*e).round());return c>0&&d.reverse(),d}))}class xv{constructor(e,n){this.layoutVertexArray=new ll,this.indexArray=new ws,this.lineIndexArray=new Ll,this.triangleSegments=new Qi,this.lineSegments=new Qi,this.programConfigurations=new u(e.layers,{zoom:e.zoom,lut:e.lut}),this.uploaded=!1,n&&(this.elevatedLayoutVertexArray=new Rl)}update(e,n,o,c,d,p,x,T){this.programConfigurations.updatePaintArrays(e,n,d,o,c,p,x,T)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mI.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.lineIndexBuffer=e.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=e.createVertexBuffer(this.elevatedLayoutVertexArray,gI.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(e,n,o,c,d,p,x){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,o,c,d,p,void 0,x)}}class bv{constructor(e){this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=e.lut,this.bufferData=new xv(e,!1),this.elevationBufferData=new xv(e,!0),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=e.sourceLayerIndex,this.worldview=e.worldview}updateFootprints(e,n){}populate(e,n,o,c){this.hasPattern=_v("fill",this.layers,this.pixelRatio,n);const d=this.layers[0].layout.get("fill-sort-key"),p=[];for(const{feature:x,id:T,index:S,sourceLayerIndex:P}of e){const k=this.layers[0]._featureFilter.needGeometry,R=Xt(x,k);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{worldview:this.worldview}),R,o))continue;const B=d?d.evaluate(R,{},o,n.availableImages):void 0,j={id:T,properties:x.properties,type:x.type,sourceLayerIndex:P,index:S,geometry:k?R.geometry:tn(x,o,c),patterns:{},sortKey:B};p.push(j)}d&&p.sort((x,T)=>x.sortKey-T.sortKey);for(const x of p){const{geometry:T,index:S,sourceLayerIndex:P}=x;if(this.hasPattern){const k=yv("fill",this.layers,x,this.zoom,this.pixelRatio,n);this.patternFeatures.push(k)}else this.addFeature(x,T,S,o,{},n.availableImages,n.brightness,n.elevationFeatures);n.featureIndex.insert(e[S].feature,T,S,P,this.index)}}update(e,n,o,c,d,p,x){this.bufferData.update(e,n,o,c,d,p,x,this.worldview),this.elevationBufferData.update(e,n,o,c,d,p,x,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(e,n,o,c,d,p,x,this.worldview)}addFeatures(e,n,o,c,d,p){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,n,o,c,p,e.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(e){this.bufferData.upload(e),this.elevationBufferData.upload(e),this.elevatedStructures&&this.elevatedStructures.upload(e)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(e,n,o,c,d,p=[],x,T){const S=x_(n,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(e,S,c,o,T):this.addGeometry(S,this.bufferData),this.bufferData.populatePaintArrays(e,o,d,p,c,x,this.worldview),this.elevationBufferData.populatePaintArrays(e,o,d,p,c,x,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(e,n,o,c,d){this.elevatedStructures&&(this.elevatedStructures.construct(e),this.elevatedStructures.populatePaintArrays(n,o,c,d,this.worldview))}addElevatedRoadFeature(e,n,o,c,d){const p=new Array,x=ha.getElevationFeature(e,d);if(!x)return void this.addGeometry(n,this.bufferData);{const S=this.clipPolygonsToTile(n,1);S.length>0&&p.push({polygons:S,elevationFeature:x,elevationTileID:o})}const T={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(e,{},o),featureIndex:c};for(const S of p)if(S.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new dl(S.elevationTileID,this.layers,this.zoom,this.lut));const k=S.elevationFeature.isTunnel();let R=0;e.properties.hasOwnProperty(er)&&(R=+e.properties[er]);for(const B of S.polygons)this.elevatedStructures.addPortalCandidates(S.elevationFeature.id,B,k,S.elevationFeature,R)}S.elevationFeature.constantHeight==null&&(S.polygons=this.prepareElevatedPolygons(S.polygons,S.elevationFeature,S.elevationTileID));const P=new ms(o,S.elevationTileID);this.addElevatedGeometry(S.polygons,P,S.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,c,T)}}addElevatedGeometry(e,n,o,c,d,p){const x={elevation:o,elevationSampler:n,bias:c,index:d,featureInfo:p},[T,S]=this.addGeometry(e,this.elevationBufferData,x);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:T,max:S}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,T),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,S))}addGeometry(e,n,o){let c=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,p=null;o&&(p=o.elevationSampler.constantElevation(o.elevation,o.bias),p!=null&&(c=p,d=p));const x=(T,S,P)=>{if(o!=null)if(S.push(T),p!=null)n.elevatedLayoutVertexArray.emplaceBack(p),P.push(p);else{const k=o.elevationSampler.pointElevation(T,o.elevation,o.bias);n.elevatedLayoutVertexArray.emplaceBack(k),P.push(k),c=Math.min(c,k),d=Math.max(d,k)}};for(const T of e){let S=0;for(const ce of T)S+=ce.length;const P=n.triangleSegments.prepareSegment(S,n.layoutVertexArray,n.indexArray),k=P.vertexLength,R=[],B=[],j=[],$=[],K=[],ee=n.layoutVertexArray.length;for(const ce of T){if(ce.length===0)continue;ce!==T[0]&&B.push(R.length/2);const W=n.lineSegments.prepareSegment(ce.length,n.layoutVertexArray,n.lineIndexArray),ae=W.vertexLength;o&&K.push(n.layoutVertexArray.length-ee),x(ce[0],j,$),n.layoutVertexArray.emplaceBack(ce[0].x,ce[0].y),n.lineIndexArray.emplaceBack(ae+ce.length-1,ae),R.push(ce[0].x),R.push(ce[0].y);for(let he=1;he<ce.length;he++)x(ce[he],j,$),n.layoutVertexArray.emplaceBack(ce[he].x,ce[he].y),n.lineIndexArray.emplaceBack(ae+he-1,ae+he),R.push(ce[he].x),R.push(ce[he].y);W.vertexLength+=ce.length,W.primitiveLength+=ce.length}const le=Ym(R,B);for(let ce=0;ce<le.length;ce+=3)n.indexArray.emplaceBack(k+le[ce],k+le[ce+1],k+le[ce+2]);if(le.length>0&&o&&this.elevationMode==="hd-road-base"){const ce=o.elevation.isTunnel(),W=o.elevation.safeArea,ae=this.elevatedStructures.addVertices(j,$);this.elevatedStructures.addTriangles(le,ae,ce);const he=K.length;if(he>0){for(let ge=0;ge<he-1;ge++)this.elevatedStructures.addRenderableRing(o.index,K[ge]+ae,K[ge+1]-K[ge],ce,W,o.featureInfo);this.elevatedStructures.addRenderableRing(o.index,K[he-1]+ae,j.length-K[he-1],ce,W,o.featureInfo)}}P.vertexLength+=S,P.primitiveLength+=le.length/3}return[c,d]}prepareElevatedPolygons(e,n,o){const c=1/st(o),d=[];for(const p of e){const x=MI(p,new Do(n,c));d.push(...x)}return d}clipPolygonsToTile(e,n){const o=-n,c=-n,d=Kt+n,p=Kt+n;let x=0;const T=[],S=[];for(;x<e.length;x++){const R=e[x],B=Rp(R);(B.min.x>=o&&B.max.x<=d&&B.min.y>=c&&B.max.y<=p?T:S).push(R)}if(T.length===e.length)return e;const P=[new Wt(o,c),new Wt(d,c),new Wt(d,p),new Wt(o,p),new Wt(o,c)],k=T;for(const R of S)k.push(...kI(R,P));return k}}let Rb,zb,Lb,Db;nn(bv,"FillBucket",{omit:["layers","patternFeatures"]}),nn(xv,"FillBufferData"),nn(dl,"ElevatedStructures");class wv{constructor(e,n,o,c){if(this.triangleCount=n.length/3,this.min=new Wt(0,0),this.max=new Wt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0)return;const[d,p]=[e[0].clone(),e[0].clone()];for(let k=1;k<e.length;++k){const R=e[k];d.x=Math.min(d.x,R.x),d.y=Math.min(d.y,R.y),p.x=Math.max(p.x,R.x),p.y=Math.max(p.y,R.y)}if(c){const k=Math.ceil(Math.max(p.x-d.x,p.y-d.y)/c);o=Math.max(o,k)}if(o===0)return;this.min=d,this.max=p;const x=this.max.sub(this.min);x.x=Math.max(x.x,1),x.y=Math.max(x.y,1);const T=Math.max(x.x,x.y)/o;this.cellsX=Math.max(1,Math.ceil(x.x/T)),this.cellsY=Math.max(1,Math.ceil(x.y/T)),this.xScale=1/T,this.yScale=1/T;const S=[];for(let k=0;k<this.triangleCount;k++){const R=e[n[3*k+0]].sub(this.min),B=e[n[3*k+1]].sub(this.min),j=e[n[3*k+2]].sub(this.min),$=fh(Math.floor(Math.min(R.x,B.x,j.x)),this.xScale,this.cellsX),K=fh(Math.floor(Math.max(R.x,B.x,j.x)),this.xScale,this.cellsX),ee=fh(Math.floor(Math.min(R.y,B.y,j.y)),this.yScale,this.cellsY),le=fh(Math.floor(Math.max(R.y,B.y,j.y)),this.yScale,this.cellsY),ce=new Wt(0,0),W=new Wt(0,0),ae=new Wt(0,0),he=new Wt(0,0);for(let ge=ee;ge<=le;++ge){ce.y=W.y=ge*T,ae.y=he.y=(ge+1)*T;for(let Be=$;Be<=K;++Be)ce.x=ae.x=Be*T,W.x=he.x=(Be+1)*T,(nf(R,B,j,ce,W,he)||nf(R,B,j,ce,he,ae))&&S.push({cellIdx:ge*this.cellsX+Be,triIdx:k})}}if(S.length===0)return;S.sort((k,R)=>k.cellIdx-R.cellIdx||k.triIdx-R.triIdx);let P=0;for(;P<S.length;){const k=S[P].cellIdx,R={start:this.payload.length,len:0};for(;P<S.length&&S[P].cellIdx===k;)++R.len,this.payload.push(S[P++].triIdx);this.cells[k]=R}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(e,n){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>e.x||e.y>this.max.y||this.min.y>e.y)return;const o=fh(e.x-this.min.x,this.xScale,this.cellsX),c=fh(e.y-this.min.y,this.yScale,this.cellsY),d=this.cells[c*this.cellsX+o];if(d){this._lazyInitLookup();for(let p=0;p<d.len;p++){const x=this.payload[d.start+p],T=Math.floor(x/8),S=1<<x%8;if(!(this.lookup[T]&S)&&(this.lookup[T]|=S,n.push(x),n.length===this.triangleCount))return}}}query(e,n,o){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>n.x||e.y>this.max.y||this.min.y>n.y)return;this._lazyInitLookup();const c=fh(e.x-this.min.x,this.xScale,this.cellsX),d=fh(n.x-this.min.x,this.xScale,this.cellsX),p=fh(e.y-this.min.y,this.yScale,this.cellsY),x=fh(n.y-this.min.y,this.yScale,this.cellsY);for(let T=p;T<=x;T++)for(let S=c;S<=d;S++){const P=this.cells[T*this.cellsX+S];if(P)for(let k=0;k<P.len;k++){const R=this.payload[P.start+k],B=Math.floor(R/8),j=1<<R%8;if(!(this.lookup[B]&j)&&(this.lookup[B]|=j,o.push(R),o.length===this.triangleCount))return}}}}function fh(i,e,n){return Math.max(0,Math.min(n-1,Math.floor(i*e)))}nn(wv,"TriangleGridIndex");class Ob{constructor(e){this.zoom=e.zoom,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.footprints=[],this.worldview=e.worldview}updateFootprints(e,n){for(const o of this.footprints)n.push({footprint:o,id:e})}populate(e,n,o,c){const d=[];for(const{feature:p,id:x,index:T,sourceLayerIndex:S}of e){const P=this.layers[0]._featureFilter.needGeometry,k=Xt(p,P);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{worldview:this.worldview}),k,o))continue;const R={id:x,properties:p.properties,type:p.type,sourceLayerIndex:S,index:T,geometry:P?k.geometry:tn(p,o,c),patterns:{}};d.push(R)}for(const p of d){const{geometry:x,index:T,sourceLayerIndex:S}=p;this.addFeature(p,x,T,o,{},n.availableImages,n.brightness),n.featureIndex.insert(e[T].feature,x,T,S,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(e){}update(e,n,o,c,d,p,x){}destroy(){}addFeature(e,n,o,c,d,p=[],x){for(const T of x_(n,2)){const S=[],P=[],k=[],R=new Wt(1/0,1/0),B=new Wt(-1/0,-1/0);for(const K of T)if(K.length!==0){K!==T[0]&&k.push(P.length/2);for(let ee=0;ee<K.length;ee++)P.push(K[ee].x),P.push(K[ee].y),S.push(K[ee]),R.x=Math.min(R.x,K[ee].x),R.y=Math.min(R.y,K[ee].y),B.x=Math.max(B.x,K[ee].x),B.y=Math.max(B.y,K[ee].y)}const j=Ym(P,k),$=new wv(S,j,8,256);this.footprints.push({vertices:S,indices:j,grid:$,min:R,max:B})}}}nn(Ob,"ClipBucket",{omit:["layers"]});const RI=xi([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),zI=xi([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),LI=xi([{name:"a_centroid_pos",components:2,type:"Uint16"}]),DI=xi([{name:"a_join_normal_inside",components:3,type:"Int16"}]),OI=xi([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),BI=xi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:FI}=RI,w_=Number.MAX_SAFE_INTEGER;function Bb(i,e,n,o){return i.order<e||i.order===w_||!(i.clipMask&n)||function(c,d){return d.length!==0&&d.find(p=>p===c)===void 0}(o,i.clipScope)}function T_(i,e){return i.x-e.x||i.y-e.y}function Fb(i,e){return T_(i.min,e.min)===0&&T_(i.max,e.max)===0}function Tv(i,e){return!(i.min.x>e.max.x||i.max.x<e.min.x||i.min.y>e.max.y||i.max.y<e.min.y)}function Sv(i,e){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++)if(i[n].sourceId!==e[n].sourceId||!Fb(i[n],e[n])||i[n].order!==e[n].order||i[n].clipMask!==e[n].clipMask||!Ha(i[n].clipScope,e[n].clipScope))return!1;return!0}function jb(i,e,n){const o=1/Kt,c=1/(1<<n.canonical.z),d=(e.x*o+n.canonical.x)*c+n.wrap,p=(e.y*o+n.canonical.y)*c;return{min:new Wt((i.x*o+n.canonical.x)*c+n.wrap,(i.y*o+n.canonical.y)*c),max:new Wt(d,p)}}function jI(i,e,n){const o=1<<n.canonical.z,c=((e.x-n.wrap)*o-n.canonical.x)*Kt,d=(e.y*o-n.canonical.y)*Kt;return{min:new Wt(((i.x-n.wrap)*o-n.canonical.x)*Kt,(i.y*o-n.canonical.y)*Kt),max:new Wt(c,d)}}function Nb(i,e,n,o,c,d,p){const x=i.indices,T=i.vertices,S=[];for(let P=o;P<o+c;P+=3){const k=e[n[P+0]+d],R=e[n[P+1]+d],B=e[n[P+2]+d],j=Math.min(k.x,R.x,B.x),$=Math.max(k.x,R.x,B.x),K=Math.min(k.y,R.y,B.y),ee=Math.max(k.y,R.y,B.y);S.length=0,i.grid.query(new Wt(j,K),new Wt($,ee),S);for(let le=0;le<S.length;le++){const ce=S[le];if(nf(T[x[3*ce+0]],T[x[3*ce+1]],T[x[3*ce+2]],k,R,B,p))return!0}}return!1}function Vb(i,e,n,o){if(!i||!n)return!1;let c=i.vertices;if(!e.canonical.equals(o.canonical)||e.wrap!==o.wrap){if(n.vertices.length<i.vertices.length)return Vb(n,o,i,e);const d=e.canonical,p=o.canonical,x=Math.pow(2,p.z-d.z);c=i.vertices.map(T=>new Wt((T.x+d.x*Kt)*x-p.x*Kt,(T.y+d.y*Kt)*x-p.y*Kt))}return Nb(n,c,i.indices,0,i.indices.length,0,0)}function qb(i,e,n,o){const c=Math.pow(2,o.z-n.z);return new Wt((i+n.x*Kt)*c-o.x*Kt,(e+n.y*Kt)*c-o.y*Kt)}function Hb(i,e){const n=[];e.grid.queryPoint(i,n);const o=e.indices,c=e.vertices;for(let d=0;d<n.length;d++){const p=n[d];if(Ba([c[o[3*p+0]],c[o[3*p+1]],c[o[3*p+2]]],i))return!0}return!1}const Cv=[new Wt(0,0),new Wt(Kt,0),new Wt(Kt,Kt),new Wt(0,Kt)];function Ub(i,e){const n=[];let o=[];if(!e||i.length<2)return[i];if(i.length===2)return hl(i[0],i[1],Cv)?[i]:[];for(let c=0;c<i.length+2;c++){const d=i[c%i.length],p=i[(c+1)%i.length],x=hl(c===0?i[i.length-1]:i[(c-1)%i.length],d,Cv),T=hl(d,p,Cv),S=x||T;S&&o.push(d),S&&T||o.length>0&&(o.length>1&&n.push(o),o=[])}return o.length>1&&n.push(o),n}const Ev=Zn.VectorTileFeature.types,NI=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],VI=["fill-extrusion-flood-light-ground-radius"],qI=Math.pow(2,13),HI=Math.pow(2,15)-1,$b=new Wt(0,1),_p=2147483648;function ng(i,e,n,o,c,d,p,x){i.emplaceBack((e<<1)+p,(n<<1)+d,(Math.floor(o*qI)<<1)+c,Math.round(x))}function ig(i,e,n){i.emplaceBack(e.x*Kt,e.y*Kt,n?1:0)}function S_(i,e,n,o,c,d){i.emplaceBack(e.x,e.y,(n.x<<1)+o,(n.y<<1)+c,d)}function rg(i,e,n){i.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class Gb{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Wb{constructor(){this.centroidXY=new Wt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Wt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Wt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Wt(this.max.x-this.min.x,this.max.y-this.min.y)}}class Zb{constructor(){this.acc=new Wt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,n){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=n.x,e.min.y=e.max.y=n.y)}appendEdge(e,n,o){this.accCount++,this.acc._add(n);let c=!!this.borders;n.x<e.min.x?(e.min.x=n.x,c=!0):n.x>e.max.x&&(e.max.x=n.x,c=!0),n.y<e.min.y?(e.min.y=n.y,c=!0):n.y>e.max.y&&(e.max.y=n.y,c=!0),((n.x===0||n.x===Kt)&&n.x===o.x)!=((n.y===0||n.y===Kt)&&n.y===o.y)&&this.processBorderOverlap(n,o),c&&this.checkBorderIntersection(n,o)}checkBorderIntersection(e,n){n.x<0!=e.x<0&&this.addBorderIntersection(0,Cn(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>Kt!=e.x>Kt&&this.addBorderIntersection(1,Cn(n.y,e.y,(Kt-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,Cn(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>Kt!=e.y>Kt&&this.addBorderIntersection(3,Cn(n.x,e.x,(Kt-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const o=this.borders[e];n<o[0]&&(o[0]=n),n>o[1]&&(o[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const o=e.x===0?0:1;this.addBorderIntersection(o,n.y),this.addBorderIntersection(o,e.y)}else{const o=e.y===0?2:3;this.addBorderIntersection(o,n.x),this.addBorderIntersection(o,e.x)}}centroid(){return this.accCount===0?new Wt(0,0):new Wt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0):0}}function Kb(i,e){const n=i.add(e)._unit(),o=Ce(i.x*n.x+i.y*n.y,-1,1);var c,d,p;return c=Math.acos(o),Math.min(4,Math.max(-4,Math.tan(c)))/4*HI*((d=i).x*(p=e).y-d.y*p.x<0?-1:1)}const UI=[i=>i.x<0,i=>i.x>Kt,i=>i.y<0,i=>i.y>Kt];function $I(i,e,n,o){const c=[4];if(o===0)return c;n._mult(o);const d=i.sub(n),p=e.sub(n),x=[i,e,d,p];for(let T=0;T<4;T++)for(const S of x)if(UI[T](S)){c.push(T);break}return c}class Xb{constructor(e){this.vertexArray=new lu,this.indexArray=new ws,this.programConfigurations=new u(e.layers,{zoom:e.zoom,lut:e.lut},n=>VI.includes(n)),this._segments=new Qi,this.hiddenByLandmarkVertexArray=new ad,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Qi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(e,n,o,c=!1){const d=e.length;if(d>2){let p=Math.max(0,this._segments.get().length-1);const x=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[p].length);let T;p!==this._segments.get().length-1&&(p++,this._segmentToGroundQuads[p]=[],this._segmentToRegionTriCounts[p]=[0,0,0,0,0]);{const S=e[0],P=e[1];T=Kb(S.sub(e[d-1])._perp()._unit(),P.sub(S)._perp()._unit())}for(let S=0;S<d;S++){const P=S===d-1?0:S+1,k=e[S],R=e[P],B=e[P===d-1?0:P+1],j=R.sub(k)._perp()._unit(),$=Kb(j,B.sub(R)._perp()._unit()),K=T,ee=$;if(Av(k,R,n)||c&&Jb(k,n)&&Jb(R,n)){T=$;continue}const le=x.vertexLength;S_(this.vertexArray,k,R,1,1,K),S_(this.vertexArray,k,R,1,0,K),S_(this.vertexArray,k,R,0,1,ee),S_(this.vertexArray,k,R,0,0,ee),x.vertexLength+=4;const ce=$I(k,R,j,o);for(const W of ce)this._segmentToGroundQuads[p].push({id:le,region:W}),this._segmentToRegionTriCounts[p][W]+=2,x.primitiveLength+=2;T=$}}}prepareBorderSegments(){if(!this.hasData())return;const e=this._segments.get(),n=e.length;for(let o=0;o<n;o++)this._segmentToGroundQuads[o].sort((c,d)=>c.region-d.region);for(let o=0;o<n;o++){const c=this._segmentToGroundQuads[o],d=e[o],p=this._segmentToRegionTriCounts[o];p.reduce((T,S)=>T+S,0);let x=0;for(let T=0;T<=4;T++){const S=p[T];if(S!==0){let P=this.regionSegments[T];P||(P=this.regionSegments[T]=new Qi);const k={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+x,vertexLength:d.vertexLength,primitiveLength:S};P.get().push(k)}x+=S}for(let T=0;T<c.length;T++){const S=c[T].id;this.indexArray.emplaceBack(S,S+1,S+3),this.indexArray.emplaceBack(S,S+3,S+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,n,o,c,d,p,x){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,n,o,c,d,p,void 0,x)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,zI.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,n,o,c,d,p,x,T){this.hasData()&&this.programConfigurations.updatePaintArrays(e,n,o,c,d,p,x,T)}updateHiddenByLandmark(e){if(!this.hasData())return;const n=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;const o=e.flags&_p?1:0;for(let c=e.groundVertexArrayOffset;c<n;++c)this.hiddenByLandmarkVertexArray.emplace(c,o);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,OI.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){const n=this.regionSegments[e];n&&n.destroy()}}}}class C_{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.pixelRatio=e.pixelRatio,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ws,this.footprintVertices=new ll,this.footprintSegments=[],this.layoutVertexArray=new sh,this.centroidVertexArray=new cd,this.wallVertexArray=new Qp,this.indexArray=new ws,this.programConfigurations=new u(e.layers,{zoom:e.zoom,lut:e.lut},n=>NI.includes(n)),this.segments=new Qi,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.groundEffect=new Xb(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=e.worldview}updateFootprints(e,n){}populate(e,n,o,c){this.features=[],this.hasPattern=_v("fill-extrusion",this.layers,this.pixelRatio,n),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=st(o),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:d,id:p,index:x,sourceLayerIndex:T}of e){const S=this.layers[0]._featureFilter.needGeometry,P=Xt(d,S);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{worldview:this.worldview}),P,o))continue;const k={id:p,sourceLayerIndex:T,index:x,geometry:S?P.geometry:tn(d,o,c),properties:d.properties,type:d.type,patterns:{}},R=this.layoutVertexArray.length,B=Ev[k.type]==="Polygon";if(this.hasPattern)this.features.push(yv("fill-extrusion",this.layers,k,this.zoom,this.pixelRatio,n));else if(this.wallMode)for(const j of k.geometry)for(const $ of Ub(j,B))this.addFeature(k,[$],x,o,{},n.availableImages,c,n.brightness);else this.addFeature(k,k.geometry,x,o,{},n.availableImages,c,n.brightness);n.featureIndex.insert(d,k.geometry,x,T,this.index,R)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,n,o,c,d,p){for(const x of this.features){const T=Ev[x.type]==="Polygon",{geometry:S}=x;if(this.wallMode)for(const P of S)for(const k of Ub(P,T))this.addFeature(x,[k],x.index,n,o,c,d,p);else this.addFeature(x,S,x.index,n,o,c,d,p)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(e,n,o,c,d,p,x){this.programConfigurations.updatePaintArrays(e,n,d,o,c,p,x,this.worldview),this.groundEffect.update(e,n,d,o,c,p,x,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,FI),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.wallVertexBuffer=e.createVertexBuffer(this.wallVertexArray,DI.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,BI.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,LI.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,o,c,d,p,x,T){const S=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,P=[new Wt(0,0),new Wt(Kt,Kt)],k=x.projection,R=k.name==="globe",B=this.wallMode||Ev[e.type]==="Polygon",j=new Zb;j.centroidDataIndex=this.centroidData.length;const $=new Wb,K=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},c)<=0,ee=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},c);let le;if($.height=ee,$.vertexArrayOffset=this.layoutVertexArray.length,$.groundVertexArrayOffset=this.groundEffect.vertexArray.length,R&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new rp),this.wallMode){if(R)return void Un("Non zero fill-extrusion-line-width is not yet supported on globe.");if(n.length!==1)return;le=function(je){const Ze=je[0].x===je[je.length-1].x&&je[0].y===je[je.length-1].y;(function(Jt){let Ft=0;const Bn=Jt.length;for(let ln=0;ln<Bn;ln++)Ft+=(Jt[(ln+1)%Bn].x-Jt[ln].x)*(Jt[(ln+1)%Bn].y+Jt[ln].y);return Ft>=0})(je)||(je=je.reverse());const Rt={geometry:[],joinNormals:[],indices:[]},wt=[],Mt=[],Dt=[];let dt=je.length;for(;dt>=2&&je[dt-1].equals(je[dt-2]);)dt--;if(dt<(Ze?3:2))return Rt;let Pt,ct,ht,Nt,Vt,yn=0;for(;yn<dt-1&&je[yn].equals(je[yn+1]);)yn++;Ze&&(Pt=je[dt-2],Vt=je[yn].sub(Pt)._unit()._perp());for(let Jt=yn;Jt<dt;Jt++){if(ht=Jt===dt-1?Ze?je[yn+1]:void 0:je[Jt+1],ht&&je[Jt].equals(ht))continue;Vt&&(Nt=Vt),Pt&&(ct=Pt),Pt=je[Jt],Vt=ht?ht.sub(Pt)._unit()._perp():Nt,Nt=Nt||Vt;let Ft=Nt.add(Vt);Ft.x===0&&Ft.y===0||Ft._unit();const Bn=Ft.x*Vt.x+Ft.y*Vt.y,ln=Bn!==0?1/Bn:1/0,un=Nt.x*Vt.y-Nt.y*Vt.x>0;let Mn="miter";const Xn=2;Mn==="miter"&&ln>Xn&&(Mn="bevel"),Mn==="bevel"&&(ln>100&&(Mn="flipbevel"),ln<Xn&&(Mn="miter"));const Gn=(ai,Qn,li,Vi)=>{const mr=new Wt(ai.x,ai.y),fe=new Wt(ai.x,ai.y);mr.x+=Qn.x*Vi,mr.y+=Qn.y*Vi,fe.x-=Qn.x*Math.max(li,1),fe.y-=Qn.y*Math.max(li,1),Dt.push(Qn),wt.push(mr),Mt.push(fe)};if(Mn==="miter")Ft._mult(ln),Gn(Pt,Ft,0,0);else if(Mn==="flipbevel")Ft=Vt.mult(-1),Gn(Pt,Ft,0,0),Gn(Pt,Ft.mult(-1),0,0);else{const ai=-Math.sqrt(ln*ln-1),Qn=un?ai:0,li=un?0:ai;ct&&Gn(Pt,Nt,Qn,li),ht&&Gn(Pt,Vt,Qn,li)}}Rt.geometry=[...wt,...Mt.reverse(),wt[0]],Rt.joinNormals=[...Dt,...Dt.reverse(),Dt[Dt.length-1]];const cn=Rt.geometry.length-1;for(let Jt=0;Jt<cn/2;Jt++)if(Jt+1<cn/2){let Ft=Jt,Bn=Jt+1,ln=cn-1-Jt,un=cn-2-Jt;Ft=Ft===0?cn-1:Ft-1,Bn=Bn===0?cn-1:Bn-1,ln=ln===0?cn-1:ln-1,un=un===0?cn-1:un-1,Rt.indices.push(ln),Rt.indices.push(Bn),Rt.indices.push(Ft),Rt.indices.push(ln),Rt.indices.push(un),Rt.indices.push(Bn)}return Rt}(n[0]),n=[le.geometry]}const ce=(je,Ze)=>je<(Ze.length-1)/2||je===Ze.length-1,W=this.wallMode?[n]:x_(n,500);for(let je=W.length-1;je>=0;je--){const Ze=W[je];(Ze.length===0||(ae=Ze[0]).every(ut=>ut.x<=0)||ae.every(ut=>ut.x>=Kt)||ae.every(ut=>ut.y<=0)||ae.every(ut=>ut.y>=Kt))&&W.splice(je,1)}var ae;let he;if(R)he=i1(W,P,c);else{he=[];for(const je of W)he.push({polygon:je,bounds:P})}const ge=B?this.edgeRadius:0,Be=ge>0&&this.zoom<17,ke=(je,Ze)=>{if(je.length===0)return!1;const ut=je[je.length-1];return Ze.x===ut.x&&Ze.y===ut.y};for(const{polygon:je,bounds:Ze}of he){let ut=0,Rt=0;for(const dt of je)B&&!dt[0].equals(dt[dt.length-1])&&dt.push(dt[0]),Rt+=B?dt.length-1:dt.length;const wt=this.segments.prepareSegment((B?5:4)*Rt,this.layoutVertexArray,this.indexArray);$.footprintSegIdx<0&&($.footprintSegIdx=this.footprintSegments.length),$.polygonSegIdx<0&&($.polygonSegIdx=this.polygonSegments.length);const Mt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Dt=new Gb;if(Dt.vertexOffset=this.footprintVertices.length,Dt.indexOffset=3*this.footprintIndices.length,Dt.ringIndices=[],B){const dt=[],Pt=[];ut=wt.vertexLength;for(let ht=0;ht<je.length;ht++){const Nt=je[ht];Nt.length&&ht!==0&&Pt.push(dt.length/2);const Vt=[];let yn,cn;yn=Nt[1].sub(Nt[0])._perp()._unit(),Dt.ringIndices.push(Nt.length-1);for(let Jt=1;Jt<Nt.length;Jt++){const Ft=Nt[Jt],Bn=Nt[Jt===Nt.length-1?1:Jt+1],ln=Ft.clone();if(ge){cn=Bn.sub(Ft)._perp()._unit();const un=yn.add(cn)._unit(),Mn=ge*Math.min(4,1/(yn.x*un.x+yn.y*un.y));ln.x+=Mn*un.x,ln.y+=Mn*un.y,ln.x=Math.round(ln.x),ln.y=Math.round(ln.y),yn=cn}if(!K||ge!==0&&!Be||ke(Vt,ln)||Vt.push(ln),ng(this.layoutVertexArray,ln.x,ln.y,0,0,1,1,0),this.wallMode){const un=ce(Jt,Nt);ig(this.wallVertexArray,le.joinNormals[Jt],!un)}wt.vertexLength++,this.footprintVertices.emplaceBack(Ft.x,Ft.y),dt.push(Ft.x,Ft.y),R&&rg(this.layoutVertexExtArray,k.projectTilePoint(ln.x,ln.y,c),k.upVector(c,ln.x,ln.y))}K&&(ge===0||Be)&&(Vt.length!==0&&ke(Vt,Vt[0])&&Vt.pop(),this.groundEffect.addData(Vt,Ze,S))}const ct=this.wallMode?le.indices:Ym(dt,Pt);for(let ht=0;ht<ct.length;ht+=3)this.footprintIndices.emplaceBack(Dt.vertexOffset+ct[ht+0],Dt.vertexOffset+ct[ht+1],Dt.vertexOffset+ct[ht+2]),this.indexArray.emplaceBack(ut+ct[ht],ut+ct[ht+2],ut+ct[ht+1]),wt.primitiveLength++;Dt.indexCount+=ct.length,Dt.vertexCount+=this.footprintVertices.length-Dt.vertexOffset}for(let dt=0;dt<je.length;dt++){const Pt=je[dt];j.startRing($,Pt[0]);let ct=Pt.length>4&&e1(Pt[Pt.length-2],Pt[0],Pt[1]),ht=ge?GI(Pt[Pt.length-2],Pt[0],Pt[1],ge):0;const Nt=[];let Vt,yn,cn;yn=Pt[1].sub(Pt[0])._perp()._unit();let Jt=!0;for(let Ft=1,Bn=0;Ft<Pt.length;Ft++){let ln=Pt[Ft-1],un=Pt[Ft];const Mn=Pt[Ft===Pt.length-1?1:Ft+1];if(j.appendEdge($,un,ln),Av(un,ln,Ze)){ge&&(yn=Mn.sub(un)._perp()._unit(),Jt=!Jt);continue}const Xn=un.sub(ln)._perp(),Gn=Xn.x/(Math.abs(Xn.x)+Math.abs(Xn.y)),ai=Xn.y>0?1:0,Qn=ln.dist(un);if(Bn+Qn>32768&&(Bn=0),ge){cn=Mn.sub(un)._perp()._unit();let fe=Qb(ln,un,Mn,Yb(yn,cn),ge);isNaN(fe)&&(fe=0);const we=un.sub(ln)._unit();ln=ln.add(we.mult(ht))._round(),un=un.add(we.mult(-fe))._round(),ht=fe,yn=cn,K&&this.zoom>=17&&(ke(Nt,ln)||Nt.push(ln),ke(Nt,un)||Nt.push(un))}const li=wt.vertexLength,Vi=Pt.length>4&&e1(ln,un,Mn);let mr=t1(Bn,ct,Jt);if(ng(this.layoutVertexArray,ln.x,ln.y,Gn,ai,0,0,mr),ng(this.layoutVertexArray,ln.x,ln.y,Gn,ai,0,1,mr),this.wallMode){const fe=ce(Ft-1,Pt),we=le.joinNormals[Ft-1];ig(this.wallVertexArray,we,fe),ig(this.wallVertexArray,we,fe)}if(Bn+=Qn,mr=t1(Bn,Vi,!Jt),ct=Vi,ng(this.layoutVertexArray,un.x,un.y,Gn,ai,0,0,mr),ng(this.layoutVertexArray,un.x,un.y,Gn,ai,0,1,mr),this.wallMode){const fe=ce(Ft,Pt),we=le.joinNormals[Ft];ig(this.wallVertexArray,we,fe),ig(this.wallVertexArray,we,fe)}if(wt.vertexLength+=4,this.indexArray.emplaceBack(li+0,li+1,li+2),this.indexArray.emplaceBack(li+1,li+3,li+2),wt.primitiveLength+=2,ge){const fe=ut+(Ft===1?Pt.length-2:Ft-2),we=Ft===1?ut:fe+1;if(this.indexArray.emplaceBack(li+1,fe,li+3),this.indexArray.emplaceBack(fe,we,li+3),wt.primitiveLength+=2,Vt===void 0&&(Vt=li),!Av(Mn,Pt[Ft],Ze)){const gt=Ft===Pt.length-1?Vt:wt.vertexLength;this.indexArray.emplaceBack(li+2,li+3,gt),this.indexArray.emplaceBack(li+3,gt+1,gt),this.indexArray.emplaceBack(li+3,we,gt+1),wt.primitiveLength+=3}Jt=!Jt}if(R){const fe=this.layoutVertexExtArray,we=k.projectTilePoint(ln.x,ln.y,c),gt=k.projectTilePoint(un.x,un.y,c),$t=k.upVector(c,ln.x,ln.y),en=k.upVector(c,un.x,un.y);rg(fe,we,$t),rg(fe,we,$t),rg(fe,gt,en),rg(fe,gt,en)}}B&&(ut+=Pt.length-1),K&&ge&&this.zoom>=17&&(Nt.length!==0&&ke(Nt,Nt[0])&&Nt.pop(),this.groundEffect.addData(Nt,Ze,S,ge>0))}this.footprintSegments.push(Dt),Mt.triangleCount=this.indexArray.length-Mt.triangleArrayOffset,this.polygonSegments.push(Mt),++$.footprintSegLen,++$.polygonSegLen}if($.vertexCount=this.layoutVertexArray.length-$.vertexArrayOffset,$.groundVertexCount=this.groundEffect.vertexArray.length-$.groundVertexArrayOffset,$.vertexCount!==0){if($.centroidXY=j.borders?$b:this.encodeCentroid(j,$),this.centroidData.push($),j.borders){this.featuresOnBorder.push(j);const je=this.featuresOnBorder.length-1;for(let Ze=0;Ze<j.borders.length;Ze++)j.borders[Ze][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ze].push(je)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,d,p,c,T,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(e,o,d,p,c,T,this.worldview),this.maxHeight=Math.max(this.maxHeight,ee)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((n,o)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[o].borders[e][0])}splitToSubtiles(){const e=[];for(let x=0;x<this.centroidData.length;x++){const T=this.centroidData[x],S=+(T.min.y+T.max.y>Kt),P=2*S+(+(T.min.x+T.max.x>Kt)^S);for(let k=0;k<T.polygonSegLen;k++){const R=T.polygonSegIdx+k;e.push({centroidIdx:x,subtile:P,polygonSegmentIdx:R,triangleSegmentIdx:this.polygonSegments[R].triangleSegIdx})}}const n=new ws;e.sort((x,T)=>x.triangleSegmentIdx===T.triangleSegmentIdx?x.subtile-T.subtile:x.triangleSegmentIdx-T.triangleSegmentIdx);let o=0,c=0,d=0;for(const x of e){if(x.triangleSegmentIdx!==o)break;d++}const p=e.length;for(;c!==e.length;){o=e[c].triangleSegmentIdx;let x=0,T=c,S=c;for(let P=T;P<d&&e[P].subtile===x;P++)S++;for(;T!==d;){const P=e[T];x=P.subtile;const k=this.centroidData[P.centroidIdx].min.clone(),R=this.centroidData[P.centroidIdx].max.clone(),B={vertexOffset:this.segments.segments[o].vertexOffset,primitiveOffset:n.length,vertexLength:this.segments.segments[o].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let j=T;j<S;j++){const $=e[j],K=this.polygonSegments[$.polygonSegmentIdx],ee=this.centroidData[$.centroidIdx].min,le=this.centroidData[$.centroidIdx].max,ce=this.indexArray.uint16;for(let W=K.triangleArrayOffset;W<K.triangleArrayOffset+K.triangleCount;W++)n.emplaceBack(ce[3*W],ce[3*W+1],ce[3*W+2]);B.primitiveLength+=K.triangleCount,k.x=Math.min(k.x,ee.x),k.y=Math.min(k.y,ee.y),R.x=Math.max(R.x,le.x),R.y=Math.max(R.y,le.y)}B.primitiveLength>0&&this.triangleSubSegments.push({segment:B,min:k,max:R}),T=S;for(let j=T;j<d&&e[j].subtile===e[T].subtile;j++)S++}c=d;for(let P=c;P<p&&e[P].triangleSegmentIdx===e[c].triangleSegmentIdx;P++)d++}n._trim(),this.indexArray=n}getVisibleSegments(e,n,o){const c=new Qi;if(this.wallMode){for(const $ of this.triangleSubSegments)c.segments.push($.segment);return c}let d=0,p=0;const x=1<<e.canonical.z;if(n){const $=n.getMinMaxForTile(e);$&&(d=$.min,p=$.max)}p+=this.maxHeight;const T=e.toUnwrapped();let S;const P=[T.canonical.x/x+T.wrap,T.canonical.y/x],k=[(T.canonical.x+1)/x+T.wrap,(T.canonical.y+1)/x],R=($,K,ee)=>[$[0]*(1-ee[0])+K[0]*ee[0],$[1]*(1-ee[1])+K[1]*ee[1]],B=[],j=[];for(const $ of this.triangleSubSegments){B[0]=$.min.x/Kt,B[1]=$.min.y/Kt,j[0]=$.max.x/Kt,j[1]=$.max.y/Kt;const K=R(P,k,B),ee=R(P,k,j);if(new Pi([K[0],K[1],d],[ee[0],ee[1],p]).intersectsPrecise(o)===0){S&&(c.segments.push(S),S=void 0);continue}const le=$.segment;S&&S.vertexOffset!==le.vertexOffset&&(c.segments.push(S),S=void 0),S?(S.vertexLength+=le.vertexLength,S.primitiveLength+=le.primitiveLength):S={vertexOffset:le.vertexOffset,primitiveLength:le.primitiveLength,vertexLength:le.vertexLength,primitiveOffset:le.primitiveOffset,sortKey:void 0,vaos:{}}}return S&&c.segments.push(S),c}encodeCentroid(e,n){const o=e.centroid(),c=n.span(),d=Math.min(7,Math.round(c.x*this.tileToMeter/10)),p=Math.min(7,Math.round(c.y*this.tileToMeter/10));return new Wt(Ce(o.x,1,Kt-1)<<3|d,Ce(o.y,1,Kt-1)<<3|p)}encodeBorderCentroid(e){if(!e.borders)return new Wt(0,0);const n=e.borders,o=Number.MAX_VALUE;if(n[0][0]!==o||n[1][0]!==o){const c=n[0][0]!==o?0:1;return new Wt(6|(n[0][0]!==o?0:65528),(n[c][0]+n[c][1])/2<<3|6)}{const c=n[2][0]!==o?2:3;return new Wt((n[c][0]+n[c][1])/2<<3|6,6|(n[2][0]!==o?0:65528))}}showCentroid(e){const n=this.centroidData[e.centroidDataIndex];n.flags&=_p,n.centroidXY.x=0,n.centroidXY.y=0,this.writeCentroidToBuffer(n)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const n=e.vertexArrayOffset,o=e.vertexCount+e.vertexArrayOffset,c=e.flags&_p?$b:e.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(n);if(this.centroidVertexArray.geta_centroid_pos1(n)!==c.y||d!==c.x){for(let p=n;p<o;++p)this.centroidVertexArray.emplace(p,c.x,c.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,n,o){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;const c=n.getReplacementRegionsForTile(e.toUnwrapped());if(Sv(this.activeReplacements,c))return;if(this.activeReplacements=c,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const p of this.centroidData)p.flags&=2147483647;const d=[];for(const p of this.activeReplacements){if(p.order<o)continue;const x=Math.max(1,Math.pow(2,p.footprintTileId.canonical.z-e.canonical.z));for(const T of this.centroidData)if(!(T.flags&_p||p.min.x>T.max.x||T.min.x>p.max.x||p.min.y>T.max.y||T.min.y>p.max.y))for(let S=0;S<T.footprintSegLen;S++){const P=this.footprintSegments[T.footprintSegIdx+S];if(d.length=0,WI(this.footprintVertices,P.vertexOffset,P.vertexCount,p.footprintTileId.canonical,e.canonical,d),Nb(p.footprint,d,this.footprintIndices.uint16,P.indexOffset,P.indexCount,-P.vertexOffset,-x)){T.flags|=_p;break}}}for(const p of this.centroidData)this.writeCentroidToBuffer(p);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,n,o){let c=!1;for(let d=0;d<o.footprintSegLen;d++){const p=this.footprintSegments[o.footprintSegIdx+d];let x=0;for(const T of p.ringIndices){for(let S=x,P=T+x-1;S<T+x;P=S++){const k=this.footprintVertices.int16[2*(S+p.vertexOffset)+0],R=this.footprintVertices.int16[2*(S+p.vertexOffset)+1],B=this.footprintVertices.int16[2*(P+p.vertexOffset)+1];R>n!=B>n&&e<(this.footprintVertices.int16[2*(P+p.vertexOffset)+0]-k)*(n-R)/(B-R)+k&&(c=!c)}x=T}}return c}getHeightAtTileCoord(e,n){let o=Number.NEGATIVE_INFINITY,c=!0;const d=4*(e+Kt)*Kt+(n+Kt);if(this.partLookup.hasOwnProperty(d)){const p=this.partLookup[d];return p?{height:p.height,hidden:!!(p.flags&_p)}:void 0}for(const p of this.centroidData)e>p.max.x||p.min.x>e||n>p.max.y||p.min.y>n||this.footprintContainsPoint(e,n,p)&&p&&p.height>o&&(o=p.height,this.partLookup[d]=p,c=!!(p.flags&_p));if(o!==Number.NEGATIVE_INFINITY)return{height:o,hidden:c};this.partLookup[d]=void 0}}function Yb(i,e){const n=i.add(e)._unit();return i.x*n.x+i.y*n.y}function GI(i,e,n,o){const c=e.sub(i)._perp()._unit(),d=n.sub(e)._perp()._unit();return Qb(i,e,n,Yb(c,d),o)}function Qb(i,e,n,o,c){const d=Math.sqrt(1-o*o);return Math.min(i.dist(e)/3,e.dist(n)/3,c*d/o)}function Av(i,e,n){return i.x<n[0].x&&e.x<n[0].x||i.x>n[1].x&&e.x>n[1].x||i.y<n[0].y&&e.y<n[0].y||i.y>n[1].y&&e.y>n[1].y}function Jb(i,e){return i.x<e[0].x||i.x>e[1].x||i.y<e[0].y||i.y>e[1].y}function e1(i,e,n){if(i.x<0||i.x>=Kt||e.x<0||e.x>=Kt||n.x<0||n.x>=Kt)return!1;const o=n.sub(e),c=o.perp(),d=i.sub(e);return(o.x*d.x+o.y*d.y)/Math.sqrt((o.x*o.x+o.y*o.y)*(d.x*d.x+d.y*d.y))>-.866&&c.x*d.x+c.y*d.y<0}function t1(i,e,n){const o=e?2|i:-3&i;return n?1|o:-2&o}function n1(){const i=Math.PI/32,e=Math.tan(i),n=Y;return n*Math.sqrt(1+2*e*e)-n}function i1(i,e,n){const o=1<<n.z,c=Me(n.x/o),d=Me((n.x+1)/o),p=We(n.y/o),x=We((n.y+1)/o);return function(T,S,P,k,R=0,B){const j=[];if(!T.length||!P||!k)return j;const $=(he,ge)=>{for(const Be of he)j.push({polygon:Be,bounds:ge})},K=Math.ceil(Math.log2(P)),ee=Math.ceil(Math.log2(k)),le=K-ee,ce=[];for(let he=0;he<Math.abs(le);he++)ce.push(le>0?0:1);for(let he=0;he<Math.min(K,ee);he++)ce.push(0),ce.push(1);let W=T;if(W=b_(W,S[0].y-R,S[1].y+R,1),W=b_(W,S[0].x-R,S[1].x+R,0),!W.length)return j;const ae=[];for(ce.length?ae.push({polygons:W,bounds:S,depth:0}):$(W,S);ae.length;){const he=ae.pop(),ge=he.depth,Be=ce[ge],ke=he.bounds[0],je=he.bounds[1],Ze=Be===0?ke.x:ke.y,ut=Be===0?je.x:je.y,Rt=B?B(Be,Ze,ut):.5*(Ze+ut),wt=b_(he.polygons,Ze-R,Rt+R,Be),Mt=b_(he.polygons,Rt-R,ut+R,Be);if(wt.length){const Dt=[ke,new Wt(Be===0?Rt:je.x,Be===1?Rt:je.y)];ce.length>ge+1?ae.push({polygons:wt,bounds:Dt,depth:ge+1}):$(wt,Dt)}if(Mt.length){const Dt=[new Wt(Be===0?Rt:ke.x,Be===1?Rt:ke.y),je];ce.length>ge+1?ae.push({polygons:Mt,bounds:Dt,depth:ge+1}):$(Mt,Dt)}}return j}(i,e,Math.ceil((d-c)/11.25),Math.ceil((p-x)/11.25),1,(T,S,P)=>{if(T===0)return .5*(S+P);{const k=We((n.y+S/Kt)/o);return(ve(.5*(We((n.y+P/Kt)/o)+k))*o-n.y)*Kt}})}function WI(i,e,n,o,c,d){const p=Math.pow(2,o.z-c.z);for(let x=0;x<n;x++){let T=i.int16[2*(x+e)+0],S=i.int16[2*(x+e)+1];T=(T+c.x*Kt)*p-o.x*Kt,S=(S+c.y*Kt)*p-o.y*Kt,d.push(new Wt(T,S))}}let r1,s1;nn(C_,"FillExtrusionBucket",{omit:["layers","features"]}),nn(Wb,"PartData"),nn(Gb,"FootprintSegment"),nn(Zb,"BorderCentroidData"),nn(Xb,"GroundEffect");class uf extends Wt{constructor(e,n,o){super(e,n),this.z=o}}class o1 extends uf{constructor(e,n,o,c){super(e,n,o),this.w=c}}function a1(i,e,n,o){const c=n==="x"?"y":"x",d=(o-i[n])/(e[n]-i[n]);i[c]=Math.round(i[c]+(e[c]-i[c])*d),i[n]=o,i.hasOwnProperty("z")&&(i.z=Cn(i.z,e.z,d)),i.hasOwnProperty("w")&&(i.w=Cn(i.w,e.w,d))}function l1(i,e,n,o){const c=n,d=o;for(const p of["x","y"]){let x=i,T=e;x[p]>=T[p]&&(x=e,T=i),x[p]<c&&T[p]>c&&a1(x,T,p,c),x[p]<d&&T[p]>d&&a1(T,x,p,d)}}function E_(i,e,n,o,c,d){const p=[];for(let x=0;x<i.length;x++){const T=i[x];let S;const P=p.length;let k=0;for(let R=0;R<T.length-1;R++){let B=T[R],j=T[R+1],$=0;const K=k;let ee,le;d&&($=Math.hypot(j.x-B.x,j.y-B.y),k+=$,ee=B,le=j),B.x<e&&j.x<e||(B.x<e?B=new Wt(e,B.y+(e-B.x)/(j.x-B.x)*(j.y-B.y))._round():j.x<e&&(j=new Wt(e,B.y+(e-B.x)/(j.x-B.x)*(j.y-B.y))._round()),B.y<n&&j.y<n||(B.y<n?B=new Wt(B.x+(n-B.y)/(j.y-B.y)*(j.x-B.x),n)._round():j.y<n&&(j=new Wt(B.x+(n-B.y)/(j.y-B.y)*(j.x-B.x),n)._round()),B.x>=o&&j.x>=o||(B.x>=o?B=new Wt(o,B.y+(o-B.x)/(j.x-B.x)*(j.y-B.y))._round():j.x>=o&&(j=new Wt(o,B.y+(o-B.x)/(j.x-B.x)*(j.y-B.y))._round()),B.y>=c&&j.y>=c||(B.y>=c?B=new Wt(B.x+(c-B.y)/(j.y-B.y)*(j.x-B.x),c)._round():j.y>=c&&(j=new Wt(B.x+(c-B.y)/(j.y-B.y)*(j.x-B.x),c)._round()),S&&B.equals(S[S.length-1])||(S=[B],p.push(S),d&&d.push({progress:{min:K+c1(ee,le,B)*$,max:1},parentIndex:x,prevPoint:ee,nextPoint:le})),S.push(j),d&&(d[d.length-1].progress.max=K+c1(ee,le,j)*$,d[d.length-1].nextPoint=le)))))}if(d&&k>0)for(let R=P;R<p.length;R++)d[R].progress.min/=k,d[R].progress.max/=k}return p}function ZI(i,e,n,o,c){if(i.length<2)return void o.push(i);const d=[];for(;e.valid();){const[S,P]=e.get();for(let k=0;k<i.length-1;k++){const R=i[k],B=i[k+1],j=tf(R,B,S,P);if(j){const[$]=j,K=new Wt(Cn(R.x,B.x,$),Cn(R.y,B.y,$));d.push({t:k+$,distance:0,point:K})}}e.next()}if(d.length===0)return void o.push(i);d.sort((S,P)=>S.t-P.t);let p=0,x=0,T=[];for(o.push(T);p!==i.length;){if(x===d.length){for(;p!==i.length;)T.length!==0&&T[T.length-1].equals(i[p])||T.push(i[p]),p++;break}d[x].t<=p?(T.length!==0&&T[T.length-1].equals(d[x].point)||T.push(d[x].point),Math.trunc(d[x].t),x++):(T.length!==0&&T[T.length-1].equals(i[p])||T.push(i[p]),p++)}}function c1(i,e,n){return i.x!==e.x?(n.x-i.x)/(e.x-i.x):i.y!==e.y?(n.y-i.y)/(e.y-i.y):0}function sg(i,e){return i.x*e.x+i.y*e.y}function u1(i,e){if(i.length===1){let n=0;const o=e[n++];let c;for(;!c||o.equals(c);)if(c=e[n++],!c)return 1/0;for(;n<e.length;n++){const d=e[n],p=i[0],x=c.sub(o),T=d.sub(o),S=p.sub(o),P=sg(x,x),k=sg(x,T),R=sg(T,T),B=sg(S,x),j=sg(S,T),$=P*R-k*k,K=(R*B-k*j)/$,ee=(P*j-k*B)/$,le=o.z*(1-K-ee)+c.z*K+d.z*ee;if(isFinite(le))return le}return 1/0}{let n=1/0;for(const o of e)n=Math.min(n,o.z);return n}}function h1(i,e,n,o,c,d,p,x){const T=p*c.getElevationAt(i,e,!0,!0),S=d[0]!==0,P=S?d[1]===0?p*(d[0]/7-450):p*function(k,R,B){const j=Math.floor(R[0]/8),$=Math.floor(R[1]/8),K=10*(R[0]-8*j),ee=10*(R[1]-8*$),le=k.getElevationAt(j,$,!0,!0),ce=k.getMeterToDEM(B),W=Math.floor(.5*(K*ce-1)),ae=Math.floor(.5*(ee*ce-1)),he=k.tileCoordToPixel(j,$),ge=2*W+1,Be=2*ae+1,ke=function(Mt,Dt,dt,Pt,ct){return[Mt.getElevationAtPixel(Dt,dt,!0),Mt.getElevationAtPixel(Dt+ct,dt,!0),Mt.getElevationAtPixel(Dt,dt+ct,!0),Mt.getElevationAtPixel(Dt+Pt,dt+ct,!0)]}(k,he.x-W,he.y-ae,ge,Be),je=Math.abs(ke[0]-ke[1]),Ze=Math.abs(ke[2]-ke[3]),ut=Math.abs(ke[0]-ke[2])+Math.abs(ke[1]-ke[3]),Rt=Math.min(.25,.5*ce*(je+Ze)/ge),wt=Math.min(.25,.5*ce*ut/Be);return le+Math.max(Rt*K,wt*ee)}(c,d,x):T;return{base:T+(n===0?-1:n),top:S?Math.max(P+o,T+n+2):T+o}}class KI{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class XI{constructor(){this.tasks={},this.taskQueue=[],an(["process"],this),this.invoker=new KI(this.process),this.nextId=0}add(e,n){const o=this.nextId++,c=function({type:d,isSymbolTile:p,zoom:x}){return x=x||0,d==="message"?0:d!=="maybePrepare"||p?d!=="parseTile"||p?d==="parseTile"&&p?300-x:d==="maybePrepare"&&p?400-x:500:200-x:100-x}(n);if(c===0){try{e()}finally{}return null}return this.tasks[o]={fn:e,metadata:n,priority:c,id:o},this.taskQueue.push(o),this.invoker.trigger(),{cancel:()=>{delete this.tasks[o]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(o=>!!this.tasks[o]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let c=0;c<this.taskQueue.length;c++){const d=this.tasks[this.taskQueue[c]];d.priority<n&&(n=d.priority,e=c)}if(e===null)return null;const o=this.taskQueue[e];return this.taskQueue.splice(e,1),o}remove(){this.invoker.remove()}}class d1{constructor(e,n,o){this.target=e,this.parent=n,this.mapId=o,this.callbacks={},this.cancelCallbacks={},an(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new XI}send(e,n,o,c,d=!1,p){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=p,this.callbacks[x]=o);const T=new Set;return this.target.postMessage({id:x,type:e,hasCallback:!!o,targetMapId:c,mustQueue:d,sourceMapId:this.mapId,data:zo(n,T)},T),{cancel:()=>{o&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(e){const n=e.data;if(!n)return;const o=n.id;if(o&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const c=this.cancelCallbacks[o];delete this.cancelCallbacks[o],c&&c.cancel()}else if(n.mustQueue||Li(self)){const c=this.callbacks[o],d=this.scheduler.add(()=>this.processTask(o,n),c&&c.metadata||{type:"message"});d&&(this.cancelCallbacks[o]=d)}else this.processTask(o,n)}processTask(e,n){if(delete this.cancelCallbacks[e],n.type==="<response>"){const o=this.callbacks[e];delete this.callbacks[e],o&&(n.error?o(il(n.error)):o(null,il(n.data)))}else{const o=new Set,c=n.hasCallback?(p,x)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:p?zo(p):null,data:zo(x,o)},o)}:()=>{},d=il(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,d,c);else if(this.parent.getWorkerSource){const p=n.type.split("."),{source:x,scope:T}=d;this.parent.getWorkerSource(n.sourceMapId,p[0],x,T)[p[1]](d,c)}else c(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var og={workerUrl:"",workerClass:null,workerParams:void 0};const Iv="mapboxgl_preloaded_worker_pool";class hf{constructor(){this.active={}}acquire(e,n=hf.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<n;)this.workers.push(og.workerClass!=null?new og.workerClass:new self.Worker(og.workerUrl,og.workerParams));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Iv]}numActive(){return Object.keys(this.active).length}}hf.workerCount=2;class Yf{constructor(e,n,o="Worker",c=hf.workerCount){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=rt();const d=this.workerPool.acquire(this.id,c);for(let p=0;p<d.length;p++){const x=new Yf.Actor(d[p],n,this.id);x.name=`${o} ${p}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,n,o){Ue(this.actors,(c,d)=>{c.send(e,n,d)},o=o||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}let ag,Pv;function A_(){return ag||(ag=new hf),ag}Yf.Actor=d1;class YI{constructor(e){this.module=e}createIntArray(e){const n=new Int32Array(e),o=this.module.malloc(n.length*n.BYTES_PER_ELEMENT);return this.module.heap32.set(n,o/n.BYTES_PER_ELEMENT),o}createFloatArray(e){const n=new Float32Array(e),o=this.module.malloc(n.length*n.BYTES_PER_ELEMENT);return this.module.heapF32.set(n,o/n.BYTES_PER_ELEMENT),o}createStringBuffer(e){const n=this.module.malloc(e.length+1);for(let o=0;o<e.length;++o)this.module.heapU8[n+o]=e.charCodeAt(o);return this.module.heapU8[n+e.length]=0,n}readStringBuffer(e){let n="";for(;this.module.heapU8[e]!==0;)n+=String.fromCharCode(this.module.heapU8[e]),++e;return n}setStyle(e){const n=e.entranceColorRgb,o=e.facadeGlazingColorRgb,c=e.roofColorRgb,d=e.wallColorRgb,p=e.normalScale;this.module.setStyle(n[0],n[1],n[2],o[0],o[1],o[2],c[0],c[1],c[2],d[0],d[1],d[2],p[0],p[1],p[2],e.tileToMeters)}setAOOptions(e,n){this.module.setAOOptions(e?1:0,n)}setMetricOptions(e,n){this.module.setMetricOptions(e?1:0,n)}setFacadeOptions(e,n,o){this.module.setFacadeOptions(e,n,o)}generateMesh(e,n){for(const x of e){const T=this.createStringBuffer(x.roofType),S=[0],P=[];for(const B of x.coordinates)if(Array.isArray(B)){for(const j of B)P.push(j.x),P.push(j.y);S.push(P.length)}const k=this.createIntArray(S),R=this.createFloatArray(P);this.module.addFeature(x.id,x.sourceId,x.minHeight,x.height,T,x.roofType.length,R,k,S.length-1),this.module.free(T),this.module.free(k),this.module.free(R)}for(const x of n){let T;T=x.entrances?JSON.parse(x.entrances):[];const S=this.createFloatArray(T),P=[];for(const R of x.coordinates)P.push(R.x),P.push(R.y);const k=this.createFloatArray(P);this.module.addFacade(x.sourceId,x.crossPerc,x.distanceToRoad,S,T.length,k,P.length),this.module.free(S),this.module.free(k)}if(!this.module.generateMesh()){const x=this.module.getLastError();return this.readStringBuffer(x)}const o=this.module.getMeshCount(),c=new Array(o);for(let x=0;x<o;x++){const T=this.module.getPositionsPtr(x),S=this.module.getPositionsLength(x),P=new Float32Array(this.module.heapF32.buffer,T,S),k=this.module.getNormalsPtr(x),R=this.module.getNormalsLength(x),B=new Float32Array(this.module.heapF32.buffer,k,R),j=this.module.getColorsPtr(x),$=this.module.getColorsLength(x),K=new Uint8Array(this.module.heapU8.buffer,j,$),ee=this.module.getAOPtr(x),le=this.module.getAOLength(x),ce=new Float32Array(this.module.heapF32.buffer,ee,le),W=this.module.getIndicesPtr(x),ae=this.module.getIndicesLength(x),he=new Int32Array(this.module.heap32.buffer,W,ae),ge=this.module.getBuildingPart(x),Be=this.readStringBuffer(ge);c[x]={positions:P,normals:B,colors:K,ao:ce,indices:he,buildingPart:Be}}const d=this.module.getRingCount(),p=[];for(let x=0;x<d;x++){const T=this.module.getRingPtr(x),S=this.module.getRingLength(x),P=new Float32Array(this.module.heapF32.buffer,T,S);p.push(P)}return{meshes:c,modifiedPolygonRings:p}}}let lg,kv,vu,Qf,Mv,Jf=null,em=null,p1=null,Rv=null;function f1(){return Li(self)&&self.worker.dracoUrl?self.worker.dracoUrl:kv||Ds.DRACO_URL}function m1(){if(Li(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Qf)return Qf;const i=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Qf=WebAssembly.validate(i)?Ds.MESHOPT_SIMD_URL:Ds.MESHOPT_URL,Qf}const I_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},QI={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},cg={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function g1(i,e,n){const o=n.json.bufferViews.length,c=n.buffers.length;e.bufferView=o,n.json.bufferViews[o]={buffer:c,byteLength:i.byteLength},n.buffers[c]=i}const zv="KHR_draco_mesh_compression";function JI(i,e){const n=i.extensions&&i.extensions[zv];if(!n)return;const o=new vu.Decoder,c=x1(e,n.bufferView),d=new vu.Mesh;if(!o.DecodeArrayToMesh(c,c.byteLength,d))throw new Error("Failed to decode Draco mesh");const p=e.json.accessors[i.indices],x=I_[p.componentType],T=p.count*x.BYTES_PER_ELEMENT,S=vu._malloc(T);x===Uint16Array?o.GetTrianglesUInt16Array(d,T,S):o.GetTrianglesUInt32Array(d,T,S),g1(vu.memory.buffer.slice(S,S+T),p,e),vu._free(S);for(const P of Object.keys(n.attributes)){const k=o.GetAttributeByUniqueId(d,n.attributes[P]),R=e.json.accessors[i.attributes[P]],B=QI[R.componentType],j=R.count*cg[R.type]*I_[R.componentType].BYTES_PER_ELEMENT,$=vu._malloc(j);o.GetAttributeDataArrayForAllPoints(d,k,vu[B],j,$),g1(vu.memory.buffer.slice($,$+j),R,e),vu._free($)}o.destroy(),d.destroy(),delete i.extensions[zv]}const P_="EXT_meshopt_compression";function eP(i,e){if(!i.extensions||!i.extensions[P_])return;const n=i.extensions[P_],o=new Uint8Array(e.buffers[n.buffer],n.byteOffset||0,n.byteLength||0),c=new Uint8Array(n.count*n.byteStride);Mv.decodeGltfBuffer(c,n.count,n.byteStride,o,n.mode,n.filter),i.buffer=e.buffers.length,i.byteOffset=0,e.buffers[i.buffer]=c.buffer,delete i.extensions[P_]}const _1=1179937895,y1=new TextDecoder("utf8");function v1(i,e){return new URL(i,e).href}function tP(i,e,n,o){return fetch(v1(i.uri,o)).then(c=>c.arrayBuffer()).then(c=>{e.buffers[n]=c})}function x1(i,e){const n=i.json.bufferViews[e];return new Uint8Array(i.buffers[n.buffer],n.byteOffset||0,n.byteLength)}function nP(i,e,n,o){if(i.uri){const c=v1(i.uri,o);return fetch(c).then(d=>d.blob()).then(d=>createImageBitmap(d)).then(d=>{e.images[n]=d})}if(i.bufferView!==void 0){const c=x1(e,i.bufferView),d=new Blob([c],{type:i.mimeType});return createImageBitmap(d).then(p=>{e.images[n]=p})}}function b1(i,e=0,n){const o={json:null,images:[],buffers:[]};if(new Uint32Array(i,e,1)[0]===_1){const P=new Uint32Array(i,e);let k=2;const R=(P[k++]>>2)-3,B=P[k++]>>2;if(k++,o.json=JSON.parse(y1.decode(P.subarray(k,k+B))),k+=B,k<R){const j=P[k++];k++;const $=e+(k<<2);o.buffers[0]=i.slice($,$+j)}}else o.json=JSON.parse(y1.decode(new Uint8Array(i,e)));const{buffers:c,images:d,meshes:p,extensionsUsed:x,bufferViews:T}=o.json;let S=Promise.resolve();if(c){const P=[];for(let k=0;k<c.length;k++){const R=c[k];R.uri?P.push(tP(R,o,k,n)):o.buffers[k]||(o.buffers[k]=null)}S=Promise.all(P)}return S.then(()=>{const P=[],k=x&&x.includes(zv),R=x&&x.includes(P_);if(k&&P.push(function(){if(!vu)return lg??(lg=function(B){let j,$=null;function K(){j=new Uint8Array($.buffer)}function ee(){throw new Error("Unexpected Draco error.")}const le={a:{a:ee,d:function(ce,W,ae){return j.copyWithin(ce,W,W+ae)},c:function(ce){const W=j.length,ae=Math.max(ce>>>0,Math.ceil(1.2*W)),he=Math.ceil((ae-W)/65536);try{return $.grow(he),K(),!0}catch{return!1}},b:ee}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(B,le):B.then(ce=>ce.arrayBuffer()).then(ce=>WebAssembly.instantiate(ce,le))).then(ce=>{const{Rb:W,Qb:ae,P:he,T:ge,X:Be,Ja:ke,La:je,Qa:Ze,Va:ut,Wa:Rt,eb:wt,jb:Mt,f:Dt,e:dt,yb:Pt,zb:ct,Ab:ht,Bb:Nt,Db:Vt,Gb:yn}=ce.instance.exports;$=dt;const cn=(()=>{let Jt=0,Ft=0,Bn=0,ln=0;return un=>{Bn&&(W(ln),W(Jt),Ft+=Bn,Bn=Jt=0),Jt||(Ft+=128,Jt=ae(Ft));const Mn=un.length+7&-8;let Xn=Jt;Mn>=Ft&&(Bn=Mn,Xn=ln=ae(Mn));for(let Gn=0;Gn<un.length;Gn++)j[Xn+Gn]=un[Gn];return Xn}})();return K(),Dt(),{memory:dt,_free:W,_malloc:ae,Mesh:class{constructor(){this.ptr=he()}destroy(){ge(this.ptr)}},Decoder:class{constructor(){this.ptr=ke()}destroy(){Mt(this.ptr)}DecodeArrayToMesh(Jt,Ft,Bn){const ln=cn(Jt),un=je(this.ptr,ln,Ft,Bn.ptr);return!!Be(un)}GetAttributeByUniqueId(Jt,Ft){return{ptr:Ze(this.ptr,Jt.ptr,Ft)}}GetTrianglesUInt16Array(Jt,Ft,Bn){ut(this.ptr,Jt.ptr,Ft,Bn)}GetTrianglesUInt32Array(Jt,Ft,Bn){Rt(this.ptr,Jt.ptr,Ft,Bn)}GetAttributeDataArrayForAllPoints(Jt,Ft,Bn,ln,un){wt(this.ptr,Jt.ptr,Ft.ptr,Bn,ln,un)}},DT_INT8:Pt(),DT_UINT8:ct(),DT_INT16:ht(),DT_UINT16:Nt(),DT_UINT32:Vt(),DT_FLOAT32:yn()}})}(fetch(f1())),lg.then(B=>{vu=B,lg=void 0}))}()),R&&P.push(function(){if(Mv)return;const B=function(j){let $;const K=WebAssembly.instantiateStreaming(j,{}).then(ce=>{$=ce.instance,$.exports.__wasm_call_ctors()}),ee={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},le={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:K,supported:!0,decodeGltfBuffer(ce,W,ae,he,ge,Be){(function(ke,je,Ze,ut,Rt,wt,Mt){const Dt=ke.exports.sbrk,dt=ut+3&-4,Pt=Dt(dt*Rt),ct=Dt(wt.length),ht=new Uint8Array(ke.exports.memory.buffer);ht.set(wt,ct);const Nt=je(Pt,ut,Rt,ct,wt.length);if(Nt===0&&Mt&&Mt(Pt,dt,Rt),Ze.set(ht.subarray(Pt,Pt+ut*Rt)),Dt(Pt-Dt(0)),Nt!==0)throw new Error(`Malformed buffer data: ${Nt}`)})($,$.exports[le[ge]],ce,W,ae,he,$.exports[ee[Be]])}}}(fetch(m1()));return B.ready.then(()=>{Mv=B})}()),d)for(let B=0;B<d.length;B++)P.push(nP(d[B],o,B,n));return(P.length?Promise.all(P):Promise.resolve()).then(()=>{if(k&&p)for(const{primitives:B}of p)for(const j of B)JI(j,o);if(R&&p&&T)for(const B of T)eP(B,o);return o})})}class w1{constructor(e){this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.hasPattern=!1,this.worldview=e.worldview}updateFootprints(e,n){}prepare(){return function(){if(Rv!=null||p1!=null)return null;if(em!=null)return em;const e=fetch(Ds.BUILDING_GEN_URL);return em=function(n){let o,c,d,p;function x(){o=new Uint8Array(p.buffer),c=new Int32Array(p.buffer),d=new Float32Array(p.buffer)}function T(){throw new Error("Unexpected BuildingGen error.")}const S=()=>{},P={a:{a:T,f:function(k){const R=o.length,B=Math.max(k>>>0,Math.ceil(1.2*R)),j=Math.ceil((B-R)/65536);try{return p.grow(j),x(),!0}catch{return!1}},g:T,b:S,c:S,d:S,e:S}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(n,P):n.then(k=>k.arrayBuffer()).then(k=>WebAssembly.instantiate(k,P))).then(k=>{const R=k.instance.exports;return(0,R.g)(),p=R.f,x(),new YI({setStyle:R.h,setAOOptions:R.i,setMetricOptions:R.j,setFacadeOptions:R.k,addFeature:R.l,addFacade:R.m,generateMesh:R.n,getLastError:R.o,getMeshCount:R.p,getPositionsPtr:R.q,getPositionsLength:R.r,getNormalsPtr:R.s,getNormalsLength:R.t,getColorsPtr:R.u,getColorsLength:R.v,getAOPtr:R.w,getAOLength:R.x,getIndicesPtr:R.y,getIndicesLength:R.z,getBuildingPart:R.A,getRingCount:R.B,getRingPtr:R.C,getRingLength:R.D,free:R.E,malloc:R.F,heapU8:o,heap32:c,heapF32:d})})}(e).then(n=>(em=null,Rv=n,Rv)).catch(n=>{Un("Could not load building-gen"),em=null,p1=n}),em}()}populate(e,n,o,c){}update(e,n,o,c,d,p,x){}isEmpty(){return!1}uploadPending(){return!1}upload(e){}destroy(){}getHeightAtTileCoord(e,n){return{height:Number.NEGATIVE_INFINITY,hidden:!0}}}let T1,S1;nn(w1,"BuildingBucket",{omit:["layers"]});const iP=xi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),rP=xi([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:sP}=iP,oP=xi([{name:"a_packed",components:3,type:"Float32"}]),{members:aP}=oP,lP=xi([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:cP}=lP;class C1{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new gp({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const o=this.getKey(e,n);return this.positions[o]}trim(){const e=this.width,n=this.height=Gt(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,o){const c=[];let d=e.length%2==1?-e[e.length-1]*o:0,p=e[0]*o,x=!0;c.push({left:d,right:p,isDash:x,zeroLength:e[0]===0});let T=e[0];for(let S=1;S<e.length;S++){x=!x;const P=e[S];d=T*o,T+=P,p=T*o,c.push({left:d,right:p,isDash:x,zeroLength:P===0})}return c}addRoundDash(e,n,o){const c=n/2;for(let d=-o;d<=o;d++){const p=this.width*(this.nextRow+o+d);let x=0,T=e[x];for(let S=0;S<this.width;S++){S/T.right>1&&(T=e[++x]);const P=Math.abs(S-T.left),k=Math.abs(S-T.right),R=Math.min(P,k);let B;const j=d/o*(c+1);if(T.isDash){const $=c-Math.abs(j);B=Math.sqrt(R*R+$*$)}else B=c-Math.sqrt(R*R+j*j);this.image.data[p+S]=Math.max(0,Math.min(255,B+128))}}}addRegularDash(e,n){for(let T=e.length-1;T>=0;--T){const S=e[T],P=e[T+1];S.zeroLength?e.splice(T,1):P&&P.isDash===S.isDash&&(P.left=S.left,e.splice(T,1))}const o=e[0],c=e[e.length-1];o.isDash===c.isDash&&(o.left=c.left-this.width,c.right=o.right+this.width);const d=this.width*this.nextRow;let p=0,x=e[p];for(let T=0;T<this.width;T++){T/x.right>1&&(x=e[++p]);const S=Math.abs(T-x.left),P=Math.abs(T-x.right),k=Math.min(S,P);this.image.data[d+T]=Math.max(0,Math.min(255,(x.isDash?k:-k)+n+128))}}addDash(e,n){const o=this.getKey(e,n);if(this.positions[o])return this.positions[o];const c=n==="round",d=c?7:0,p=2*d+1;if(this.nextRow+p>this.height)return Un("LineAtlas out of space"),null;e.length===0&&e.push(1);let x=0;for(let P=0;P<e.length;P++)e[P]<0&&(Un("Negative value is found in line dasharray, replacing values with 0"),e[P]=0),x+=e[P];if(x!==0){const P=this.width/x,k=this.getDashRanges(e,this.width,P);c?this.addRoundDash(k,P,d):this.addRegularDash(k,n==="square"?.5*P:0)}const T=this.nextRow+d;this.nextRow+=p;const S={tl:[T,d],br:[x,0]};return this.positions[o]=S,S}}nn(C1,"LineAtlas");const uP=Zn.VectorTileFeature.types,hP=Math.cos(Math.PI/180*37.5),dP=Math.cos(Math.PI/180*5);class Lv{constructor(e){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=e.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=e.overscaling,this.pixelRatio=e.pixelRatio,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new ip,this.layoutVertexArray2=new La,this.patternVertexArray=new La,this.indexArray=new ws,this.programConfigurations=new u(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new Qi,this.maxLineLength=0,this.zOffsetVertexArray=new La,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.tessellationStep=e.tessellationStep?e.tessellationStep:Kt/64,this.worldview=e.worldview}updateFootprints(e,n){}populate(e,n,o,c){this.hasPattern=_v("line",this.layers,this.pixelRatio,n);const d=this.layers[0].layout.get("line-sort-key");this.tileToMeter=st(o);const p=this.layers[0].layout.get("line-elevation-reference");if(p==="hd-road-markup")this.elevationType="road";else{const R=this.layers[0].layout.get("line-z-offset"),B=R.isConstant()&&!R.constantOr(0);this.elevationType=p!=="sea"&&p!=="ground"&&B?"none":"offset",this.elevationType==="offset"&&p==="none"&&Un(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const x=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&x!==void 0;const T=[];for(const{feature:R,id:B,index:j,sourceLayerIndex:$}of e){const K=this.layers[0]._featureFilter.needGeometry,ee=Xt(R,K);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{worldview:this.worldview}),ee,o))continue;const le=d?d.evaluate(ee,{},o):void 0,ce={id:B,properties:R.properties,type:R.type,sourceLayerIndex:$,index:j,geometry:K?ee.geometry:tn(R,o,c),patterns:{},sortKey:le};T.push(ce)}d&&T.sort((R,B)=>R.sortKey-B.sortKey);const{lineAtlas:S,featureIndex:P}=n,k=this.addConstantDashes(S);for(const R of T){const{geometry:B,index:j,sourceLayerIndex:$}=R;if(k&&this.addFeatureDashes(R,S),this.hasPattern){const K=yv("line",this.layers,R,this.zoom,this.pixelRatio,n);this.patternFeatures.push(K)}else this.addFeature(R,B,j,o,S.positions,n.availableImages,n.brightness,n.elevationFeatures);P.insert(e[j].feature,B,j,$,this.index)}}addConstantDashes(e){let n=!1;for(const o of this.layers){const c=o.paint.get("line-dasharray").value,d=o.layout.get("line-cap").value;if(c.kind!=="constant"||d.kind!=="constant")n=!0;else{const p=d.value,x=c.value;if(!x)continue;e.addDash(x,p)}}return n}addFeatureDashes(e,n){const o=this.zoom;for(const c of this.layers){const d=c.paint.get("line-dasharray").value,p=c.layout.get("line-cap").value;if(d.kind==="constant"&&p.kind==="constant")continue;let x,T;if(d.kind==="constant"){if(x=d.value,!x)continue}else x=d.evaluate({zoom:o},e);T=p.kind==="constant"?p.value:p.evaluate({zoom:o},e),n.addDash(x,T),e.patterns[c.id]=[n.getKey(x,T)]}}update(e,n,o,c,d,p,x,T){this.programConfigurations.updatePaintArrays(e,n,d,o,c,p,x,T)}addFeatures(e,n,o,c,d,p){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,n,o,c,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,aP)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=e.createVertexBuffer(this.patternVertexArray,cP)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,rP.members,!0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sP),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,o,c,d,p,x,T){const S=this.layers[0].layout,P=S.get("line-join").evaluate(e,{}),k=S.get("line-cap").evaluate(e,{}),R=S.get("line-miter-limit"),B=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(e),this.lineFeature=e,this.zOffsetValue=S.get("line-z-offset").value;const j=this.layers[0].paint.get("line-width").value;if(j.kind!=="constant"&&j.isLineProgressConstant===!1&&(this.variableWidthValue=j),this.elevationType==="road"){const $=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(e,n,c,T,P,k,R,B)){const[K,ee]=this.clipRuntimeLinesToTile(n,1);for(let le=0;le<K.length;le++){const ce=K[le],W=ee[le],ae={progress:{min:W.progress.min,max:W.progress.max},nextDir:this.computeSegNextDir(W,ce),prevDir:this.computeSegPrevDir(W,ce)};this.addLine(ce,e,c,P,k,R,B,ae)}this.fillNonElevatedRoadSegment($)}}else for(const $ of n)this.addLine($,e,c,P,k,R,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,d,p,c,x,void 0,this.worldview)}computeSegNextDir(e,n){return e.nextPoint.sub(n.at(-2)).unit()}computeSegPrevDir(e,n){return n[1].sub(e.prevPoint).unit()}clipLinesToTile(e,n){return E_(e,-n,-n,Kt+n,Kt+n)}clipRuntimeLinesToTile(e,n){const o=[];return[E_(e,-n,-n,Kt+n,Kt+n,o),o]}addElevatedRoadFeature(e,n,o,c,d,p,x,T){const S=[],P=ha.getElevationFeature(e,c);if(P){const k=this.clipLinesToTile(n,1),R=this.prepareElevatedLines(k,P,o);for(const B of R)S.push({geometry:B,elevation:P,elevationTileID:o,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(S.length===0)return!1;for(const k of S){const R=this.layoutVertexArray.length;this.addLine(k.geometry,e,o,d,p,x,T);const B=new ms(o,k.elevationTileID);if(k.elevation)for(let j=R;j<this.layoutVertexArray.length;j++){const $=new Wt(this.layoutVertexArray.int16[6*j]>>1,this.layoutVertexArray.int16[6*j+1]>>1),K=B.pointElevation($,k.elevation,.05);this.updateHeightRange(K),this.zOffsetVertexArray.emplaceBack(K,0,0)}else this.fillNonElevatedRoadSegment(R)}return!0}prepareElevatedLines(e,n,o){if(n.constantHeight!=null)return e;const c=[],d=1/st(o);for(const p of e)ZI(p,new Do(n,d),0,c);return c}fillNonElevatedRoadSegment(e){for(let n=e;n<this.layoutVertexArray.length;n++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(e){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,e),this.heightRange.max=Math.max(this.heightRange.max,e)):this.heightRange={min:e,max:e}}addLine(e,n,o,c,d,p,x,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const S=c==="none";this.patternJoinNone=this.hasPattern&&S,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const P=T&&T.progress.min>0,k=T&&T.progress.max<1;if(this.lineClips){let Be={min:this.lineClips.start,max:this.lineClips.end},ke=1;if(T){const ut=this.lineClips.end-this.lineClips.start;Be=function(Rt,wt,Mt){return{min:Ao(Rt.min,wt,Mt),max:Ao(Rt.max,wt,Mt)}}(T.progress,{min:0,max:1},Be),ut>0&&(ke=(Be.max-Be.min)/ut)}const je=+n.properties.mapbox_clip_feature_len,Ze=+n.properties.mapbox_clip_seg_len;if(Number.isNaN(je)||Number.isNaN(Ze)){for(let Rt=0;Rt<e.length-1;Rt++)this.totalDistance+=e[Rt].dist(e[Rt+1]);const ut=this.totalDistance/(Be.max-Be.min);this.totalFeatureLength=Number.isFinite(ut)?ut:0,this.lineClips.start=Be.min,this.lineClips.end=Be.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=je,this.distance=Ze*ke,this.lineClips.start=Be.min,this.lineClips.end=Be.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const R=uP[n.type]==="Polygon";let B=e.length;for(;B>=2&&e[B-1].equals(e[B-2]);)B--;let j=0;for(;j<B-1&&e[j].equals(e[j+1]);)j++;if(B<(R?3:2))return;c==="bevel"&&(p=1.05);const $=this.segments.prepareSegment(10*B,this.layoutVertexArray,this.indexArray);let K,ee,le,ce,W,ae,he,ge;T&&T.prevDir&&(ae=T.prevDir.perp()),T&&T.nextDir&&(he=T.nextDir.perp()),this.e1=this.e2=-1,R&&(K=e[B-2],W=e[j].sub(K)._unit()._perp());for(let Be=j;Be<B;Be++){if(le=Be===B-1?R?e[j+1]:void 0:e[Be+1],le&&e[Be].equals(le))continue;W&&(ce=W),K&&(ee=K),K=e[Be],ge=this.evaluateLineProgressFeatures(ee?ee.dist(K):0),W=le?le.sub(K)._unit()._perp():ce,ce=ce||W;const ke=ee&&le;let je=ke?c:R||S?"butt":d;const Ze=ce.x*W.x+ce.y*W.y;if(S){const ct=function(ht){if(ht.patternJoinNone){const Nt=ht.segmentPoints.length/2,Vt=ht.lineSoFar-ht.segmentStart;for(let yn=0;yn<Nt;++yn){const cn=ht.segmentPoints[2*yn+1],Jt=Math.round(ht.segmentPoints[2*yn])+.5+.25*cn;ht.patternVertexArray.emplaceBack(Jt,Vt,ht.segmentStart),ht.patternVertexArray.emplaceBack(Jt,Vt,ht.segmentStart)}ht.segmentPoints.length=0}ht.e1=ht.e2=-1};if(ke&&Ze<dP){this.updateDistance(ee,K),this.addCurrentVertex(K,ce,1,1,$,ge),ct(this),this.addCurrentVertex(K,W,-1,-1,$,ge);continue}if(ee){if(!le){this.updateDistance(ee,K),this.addCurrentVertex(K,ce,1,1,$,ge),ct(this);continue}je="miter"}}let ut=ce.add(W);ut.x===0&&ut.y===0||ut._unit();const Rt=ut.x*W.x+ut.y*W.y,wt=Rt!==0?1/Rt:1/0,Mt=2*Math.sqrt(2-2*Rt),Dt=Rt<hP&&ee&&le,dt=ce.x*W.y-ce.y*W.x>0,Pt=this.overscaling<=16?15*Kt/(512*this.overscaling):0;if(ke&&je==="round"){if(wt<x)je="miter";else if(wt<=2){const ct=Dv(K,-10,Kt+10);je=this.elevationType==="offset"&&(ct||this.hasCrossSlope)?"miter":"fakeround"}}if(je==="miter"&&wt>p&&(je="bevel"),je==="bevel"&&(wt>2&&(je="flipbevel"),wt<p&&(je="miter")),ee&&!(je==="miter"&&Dt)&&this.updateDistance(ee,K),je==="miter")if(Dt){const ct=K.dist(ee);if(ct>2*Pt){const Nt=K.sub(K.sub(ee)._mult(Pt/ct)._round());this.updateDistance(ee,Nt),this.addCurrentVertex(Nt,ce,0,0,$,ge),ee=Nt}this.updateDistance(ee,K),ut._mult(wt),this.addCurrentVertex(K,ut,0,0,$,ge);const ht=K.dist(le);if(ht>2*Pt){const Nt=K.add(le.sub(K)._mult(Pt/ht)._round());this.updateDistance(K,Nt),this.addCurrentVertex(Nt,W,0,0,$,ge),K=Nt}}else ut._mult(wt),this.addCurrentVertex(K,ut,0,0,$,ge);else if(je==="flipbevel"){if(wt>100)ut=W.mult(-1);else{const ct=wt*ce.add(W).mag()/ce.sub(W).mag();ut._perp()._mult(ct*(dt?-1:1))}this.addCurrentVertex(K,ut,0,0,$,ge),this.addCurrentVertex(K,ut.mult(-1),0,0,$,ge)}else if(je==="bevel"||je==="fakeround"){ge!=null&&ee&&this.addCurrentVertex(K,he||ce,-1,-1,$,ge);const ct=K.dist(ee)<=2*Pt&&je!=="bevel",ht=ut.mult(dt?1:-1);ht._mult(wt);const Nt=W.mult(dt?-1:1),Vt=ce.mult(dt?-1:1),yn=this.evaluateLineProgressFeatures(this.distance);if(ge==null&&(this.addHalfVertex(K,ht.x,ht.y,!1,!dt,0,$,yn),ct||this.addHalfVertex(K,ht.x+2*Vt.x,ht.y+2*Vt.y,!1,dt,0,$,yn)),je==="fakeround"){const cn=Math.round(180*Mt/Math.PI/20);this.addHalfVertex(K,Vt.x,Vt.y,!1,dt,0,$,yn);for(let Jt=0;Jt<cn;Jt++){let Ft=Jt/cn;if(Ft!==.5){const ln=Ft-.5;Ft+=Ft*ln*(Ft-1)*((1.0904+Ze*(Ze*(3.55645-1.43519*Ze)-3.2452))*ln*ln+(.848013+Ze*(.215638*Ze-1.06021)))}const Bn=Nt.sub(Vt)._mult(Ft)._add(Vt)._unit();this.addHalfVertex(K,Bn.x,Bn.y,!1,dt,0,$,yn)}this.addHalfVertex(K,Nt.x,Nt.y,!1,dt,0,$,yn)}ct||ge!=null||this.addHalfVertex(K,ht.x+2*Nt.x,ht.y+2*Nt.y,!1,dt,0,$,yn),ge!=null&&le&&this.addCurrentVertex(K,ae||W,1,1,$,ge)}else if(je==="butt")this.addCurrentVertex(K,ut,0,0,$,ge);else if(je==="square"){if(!ee){const ct=P?0:-1;this.addCurrentVertex(K,ut,ct,ct,$,ge)}if(this.addCurrentVertex(K,ut,0,0,$,ge),ee){const ct=k?0:1;this.addCurrentVertex(K,ut,ct,ct,$,ge)}}else if(je==="round"){if(ee){const ct=!ke&&he?he:ce;this.addCurrentVertex(K,ct,0,0,$,ge),!ke&&k||this.addCurrentVertex(K,ct,1,1,$,ge,!0)}if(le){const ct=!ke&&ae?ae:W;!ke&&P||this.addCurrentVertex(K,ct,-1,-1,$,ge,!0),this.addCurrentVertex(K,ct,0,0,$,ge)}}}}addVerticesTo(e,n,o,c,d,p,x,T,S,P){const k=(n.w-e.w)/this.tessellationStep|0;let R=0;const B=this.scaledDistance;if(k>1){this.lineSoFar=e.w;const $=(n.x-e.x)/k,K=(n.y-e.y)/k,ee=(n.z-e.z)/k,le=(n.w-e.w)/k;for(let ce=1;ce<k;++ce){e.x+=$,e.y+=K,e.z+=ee,this.lineSoFar+=le,R+=le;const W=this.evaluateLineProgressFeatures(this.prevDistance+R);this.scaledDistance=(this.prevDistance+R)/this.totalDistance,this.addHalfVertex(e,o,c,P,!1,x,S,W),this.addHalfVertex(e,d,p,P,!0,-T,S,W)}}this.lineSoFar=n.w,this.scaledDistance=B;const j=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(n,o,c,P,!1,x,S,j),this.addHalfVertex(n,d,p,P,!0,-T,S,j)}evaluateLineProgressFeatures(e){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+e)/this.totalFeatureLength):Un(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let n=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(n=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:n}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:n}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:n}}addCurrentVertex(e,n,o,c,d,p,x=!1){const T=n.x+n.y*o,S=n.y-n.x*o,P=n.y*c-n.x,k=-n.y-n.x*c;if(p!=null){const R=this.elevationType==="offset",B=-10,j=Kt+10,$=p.zOffset,K=new o1(e.x,e.y,$,this.lineSoFar),ee=!!R&&Dv(e,B,j),le=this.lineSoFar,ce=this.distance;if(this.currentVertex)if(ee){const W=this.currentVertexIsOutside,ae=this.currentVertex,he=new o1(e.x,e.y,$,this.lineSoFar);if(l1(ae,he,B,j),!Dv(he,B,j)){if(W){this.e1=this.e2=-1,this.distance-=ae.dist(K),this.lineSoFar=ae.w;const ge=this.evaluateLineProgressFeatures(ae.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ae,T,S,x,!1,o,d,ge),this.addHalfVertex(ae,P,k,x,!0,-c,d,ge),this.prevDistance=this.distance}this.distance=this.prevDistance+ae.dist(he),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ae,he,T,S,P,k,o,c,d,x),this.distance=ce,this.scaledDistance=this.distance/this.totalDistance}}else{const W=this.currentVertex;if(this.currentVertexIsOutside){l1(W,K,B,j),this.e1=this.e2=-1,this.distance-=W.dist(K),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=W.w;const ae=this.evaluateLineProgressFeatures(W.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(W,T,S,x,!1,o,d,ae),this.addHalfVertex(W,P,k,x,!0,-c,d,ae),this.prevDistance=this.distance,this.distance=ce,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(W,K,T,S,P,k,o,c,d,x)}else ee||(this.addHalfVertex(e,T,S,x,!1,o,d,p),this.addHalfVertex(e,P,k,x,!0,-c,d,p));this.currentVertex=K,this.currentVertexIsOutside=ee,this.lineSoFar=le}else this.addHalfVertex(e,T,S,x,!1,o,d,p),this.addHalfVertex(e,P,k,x,!0,-c,d,p)}addHalfVertex({x:e,y:n},o,c,d,p,x,T,S){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),p||this.segmentPoints.push(this.lineSoFar-this.segmentStart,x)),this.layoutVertexArray.emplaceBack((e<<1)+(d?1:0),(n<<1)+(p?1:0),Math.round(63*o)+128,Math.round(63*c)+128,1+(x===0?0:x<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const k=Cn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,k)}const P=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),T.primitiveLength++),p?this.e2=P:this.e1=P,S!=null&&this.zOffsetVertexArray.emplaceBack(S.zOffset,S.variableWidth,S.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(e,n){this.prevDistance=this.distance,this.distance+=e.dist(n),this.updateScaledDistance()}}function Dv(i,e,n){return i.x<e||i.x>n||i.y<e||i.y>n}let E1,A1;function I1(i,e,n){return e*(Kt/(i.tileSize*Math.pow(2,n-i.tileID.overscaledZ)))}nn(Lv,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const P1=(i,e,n)=>(1-n)*i+n*e;function k1(i,e){return 1/I1(i,1,e.tileZoom)}function M1(i,e,n,o){return i.translatePosMatrix(o||e.tileID.projMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const R1=i=>{const e=[];z1(i)&&e.push("RENDER_LINE_DASH"),i.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const n=i.paint.get("line-trim-offset");n[0]===0&&n[1]===0||e.push("RENDER_LINE_TRIM_OFFSET"),i.paint.get("line-border-width").constantOr(1)!==0&&e.push("RENDER_LINE_BORDER");const o=i.layout.get("line-join").constantOr("miter")==="none",c=!!i.paint.get("line-pattern").constantOr(1);return o&&c&&e.push("LINE_JOIN_NONE"),e};function z1(i){const e=i.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}let Ov;const L1=()=>Ov||(Ov={layout:E1||(E1=new Er({"line-cap":new Zt(Xe.layout_line["line-cap"]),"line-join":new Zt(Xe.layout_line["line-join"]),"line-miter-limit":new Ot(Xe.layout_line["line-miter-limit"]),"line-round-limit":new Ot(Xe.layout_line["line-round-limit"]),"line-sort-key":new Zt(Xe.layout_line["line-sort-key"]),"line-z-offset":new Zt(Xe.layout_line["line-z-offset"]),"line-elevation-reference":new Ot(Xe.layout_line["line-elevation-reference"]),"line-cross-slope":new Ot(Xe.layout_line["line-cross-slope"]),visibility:new Ot(Xe.layout_line.visibility),"line-width-unit":new Ot(Xe.layout_line["line-width-unit"])})),paint:A1||(A1=new Er({"line-opacity":new Zt(Xe.paint_line["line-opacity"]),"line-color":new Zt(Xe.paint_line["line-color"]),"line-translate":new Ot(Xe.paint_line["line-translate"]),"line-translate-anchor":new Ot(Xe.paint_line["line-translate-anchor"]),"line-width":new Zt(Xe.paint_line["line-width"]),"line-gap-width":new Zt(Xe.paint_line["line-gap-width"]),"line-offset":new Zt(Xe.paint_line["line-offset"]),"line-blur":new Zt(Xe.paint_line["line-blur"]),"line-dasharray":new Zt(Xe.paint_line["line-dasharray"]),"line-pattern":new Zt(Xe.paint_line["line-pattern"]),"line-pattern-cross-fade":new Ot(Xe.paint_line["line-pattern-cross-fade"]),"line-gradient":new Ml(Xe.paint_line["line-gradient"]),"line-trim-offset":new Ot(Xe.paint_line["line-trim-offset"]),"line-trim-fade-range":new Ot(Xe.paint_line["line-trim-fade-range"]),"line-trim-color":new Ot(Xe.paint_line["line-trim-color"]),"line-emissive-strength":new Ot(Xe.paint_line["line-emissive-strength"]),"line-border-width":new Zt(Xe.paint_line["line-border-width"]),"line-border-color":new Zt(Xe.paint_line["line-border-color"]),"line-occlusion-opacity":new Ot(Xe.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},Ov);class pP extends Zt{possiblyEvaluate(e,n){return n=new ji(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,transition:n.transition,worldview:n.worldview}),super.possiblyEvaluate(e,n)}evaluate(e,n,o,c){return n=tt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(e,n,o,c)}}let ug;function D1(i,e){return e>0?e+2*i:i}const fP=xi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mP=xi([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),gP=xi([{name:"a_projected_pos",components:4,type:"Float32"}],4);xi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const _P=xi([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),yP=xi([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),vP=xi([{name:"a_texb",components:2,type:"Uint16"}]),xP=xi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),bP=xi([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);xi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const O1=xi([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),wP=xi([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);xi([{name:"triangle",components:3,type:"Uint16"}]),xi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),xi([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),xi([{type:"Float32",name:"offsetX"}]),xi([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var to=24;function TP(i,e,n){return i.sections.forEach(o=>{o.text=function(c,d,p){const x=d.layout.get("text-transform").evaluate(p,{});return x==="uppercase"?c=c.toLocaleUpperCase():x==="lowercase"&&(c=c.toLocaleLowerCase()),Ra.applyArabicShaping&&(c=Ra.applyArabicShaping(c)),c}(o.text,e,n)}),i}const hg={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function SP(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}function CP(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}var B1,Bv,F1,Fv={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function EP(){return B1||(B1=1,Fv.read=function(i,e,n,o,c){var d,p,x=8*c-o-1,T=(1<<x)-1,S=T>>1,P=-7,k=n?c-1:0,R=n?-1:1,B=i[e+k];for(k+=R,d=B&(1<<-P)-1,B>>=-P,P+=x;P>0;d=256*d+i[e+k],k+=R,P-=8);for(p=d&(1<<-P)-1,d>>=-P,P+=o;P>0;p=256*p+i[e+k],k+=R,P-=8);if(d===0)d=1-S;else{if(d===T)return p?NaN:1/0*(B?-1:1);p+=Math.pow(2,o),d-=S}return(B?-1:1)*p*Math.pow(2,d-o)},Fv.write=function(i,e,n,o,c,d){var p,x,T,S=8*d-c-1,P=(1<<S)-1,k=P>>1,R=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=o?0:d-1,j=o?1:-1,$=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(x=isNaN(e)?1:0,p=P):(p=Math.floor(Math.log(e)/Math.LN2),e*(T=Math.pow(2,-p))<1&&(p--,T*=2),(e+=p+k>=1?R/T:R*Math.pow(2,1-k))*T>=2&&(p++,T/=2),p+k>=P?(x=0,p=P):p+k>=1?(x=(e*T-1)*Math.pow(2,c),p+=k):(x=e*Math.pow(2,k-1)*Math.pow(2,c),p=0));c>=8;i[n+B]=255&x,B+=j,x/=256,c-=8);for(p=p<<c|x,S+=c;S>0;i[n+B]=255&p,B+=j,p/=256,S-=8);i[n+B-j]|=128*$}),Fv}function j1(){if(F1)return Bv;F1=1,Bv=e;var i=EP();function e(W){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(W)?W:new Uint8Array(W||0),this.pos=0,this.type=0,this.length=this.buf.length}e.Varint=0,e.Fixed64=1,e.Bytes=2,e.Fixed32=5;var n=4294967296,o=1/n,c=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function d(W){return W.type===e.Bytes?W.readVarint()+W.pos:W.pos+1}function p(W,ae,he){return he?4294967296*ae+(W>>>0):4294967296*(ae>>>0)+(W>>>0)}function x(W,ae,he){var ge=ae<=16383?1:ae<=2097151?2:ae<=268435455?3:Math.floor(Math.log(ae)/(7*Math.LN2));he.realloc(ge);for(var Be=he.pos-1;Be>=W;Be--)he.buf[Be+ge]=he.buf[Be]}function T(W,ae){for(var he=0;he<W.length;he++)ae.writeVarint(W[he])}function S(W,ae){for(var he=0;he<W.length;he++)ae.writeSVarint(W[he])}function P(W,ae){for(var he=0;he<W.length;he++)ae.writeFloat(W[he])}function k(W,ae){for(var he=0;he<W.length;he++)ae.writeDouble(W[he])}function R(W,ae){for(var he=0;he<W.length;he++)ae.writeBoolean(W[he])}function B(W,ae){for(var he=0;he<W.length;he++)ae.writeFixed32(W[he])}function j(W,ae){for(var he=0;he<W.length;he++)ae.writeSFixed32(W[he])}function $(W,ae){for(var he=0;he<W.length;he++)ae.writeFixed64(W[he])}function K(W,ae){for(var he=0;he<W.length;he++)ae.writeSFixed64(W[he])}function ee(W,ae){return(W[ae]|W[ae+1]<<8|W[ae+2]<<16)+16777216*W[ae+3]}function le(W,ae,he){W[he]=ae,W[he+1]=ae>>>8,W[he+2]=ae>>>16,W[he+3]=ae>>>24}function ce(W,ae){return(W[ae]|W[ae+1]<<8|W[ae+2]<<16)+(W[ae+3]<<24)}return e.prototype={destroy:function(){this.buf=null},readFields:function(W,ae,he){for(he=he||this.length;this.pos<he;){var ge=this.readVarint(),Be=ge>>3,ke=this.pos;this.type=7&ge,W(Be,ae,this),this.pos===ke&&this.skip(ge)}return ae},readMessage:function(W,ae){return this.readFields(W,ae,this.readVarint()+this.pos)},readFixed32:function(){var W=ee(this.buf,this.pos);return this.pos+=4,W},readSFixed32:function(){var W=ce(this.buf,this.pos);return this.pos+=4,W},readFixed64:function(){var W=ee(this.buf,this.pos)+ee(this.buf,this.pos+4)*n;return this.pos+=8,W},readSFixed64:function(){var W=ee(this.buf,this.pos)+ce(this.buf,this.pos+4)*n;return this.pos+=8,W},readFloat:function(){var W=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,W},readDouble:function(){var W=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,W},readVarint:function(W){var ae,he,ge=this.buf;return ae=127&(he=ge[this.pos++]),he<128?ae:(ae|=(127&(he=ge[this.pos++]))<<7,he<128?ae:(ae|=(127&(he=ge[this.pos++]))<<14,he<128?ae:(ae|=(127&(he=ge[this.pos++]))<<21,he<128?ae:function(Be,ke,je){var Ze,ut,Rt=je.buf;if(Ze=(112&(ut=Rt[je.pos++]))>>4,ut<128||(Ze|=(127&(ut=Rt[je.pos++]))<<3,ut<128)||(Ze|=(127&(ut=Rt[je.pos++]))<<10,ut<128)||(Ze|=(127&(ut=Rt[je.pos++]))<<17,ut<128)||(Ze|=(127&(ut=Rt[je.pos++]))<<24,ut<128)||(Ze|=(1&(ut=Rt[je.pos++]))<<31,ut<128))return p(Be,Ze,ke);throw new Error("Expected varint not more than 10 bytes")}(ae|=(15&(he=ge[this.pos]))<<28,W,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var W=this.readVarint();return W%2==1?(W+1)/-2:W/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var W=this.readVarint()+this.pos,ae=this.pos;return this.pos=W,W-ae>=12&&c?function(he,ge,Be){return c.decode(he.subarray(ge,Be))}(this.buf,ae,W):function(he,ge,Be){for(var ke="",je=ge;je<Be;){var Ze,ut,Rt,wt=he[je],Mt=null,Dt=wt>239?4:wt>223?3:wt>191?2:1;if(je+Dt>Be)break;Dt===1?wt<128&&(Mt=wt):Dt===2?(192&(Ze=he[je+1]))==128&&(Mt=(31&wt)<<6|63&Ze)<=127&&(Mt=null):Dt===3?(ut=he[je+2],(192&(Ze=he[je+1]))==128&&(192&ut)==128&&((Mt=(15&wt)<<12|(63&Ze)<<6|63&ut)<=2047||Mt>=55296&&Mt<=57343)&&(Mt=null)):Dt===4&&(ut=he[je+2],Rt=he[je+3],(192&(Ze=he[je+1]))==128&&(192&ut)==128&&(192&Rt)==128&&((Mt=(15&wt)<<18|(63&Ze)<<12|(63&ut)<<6|63&Rt)<=65535||Mt>=1114112)&&(Mt=null)),Mt===null?(Mt=65533,Dt=1):Mt>65535&&(Mt-=65536,ke+=String.fromCharCode(Mt>>>10&1023|55296),Mt=56320|1023&Mt),ke+=String.fromCharCode(Mt),je+=Dt}return ke}(this.buf,ae,W)},readBytes:function(){var W=this.readVarint()+this.pos,ae=this.buf.subarray(this.pos,W);return this.pos=W,ae},readPackedVarint:function(W,ae){if(this.type!==e.Bytes)return W.push(this.readVarint(ae));var he=d(this);for(W=W||[];this.pos<he;)W.push(this.readVarint(ae));return W},readPackedSVarint:function(W){if(this.type!==e.Bytes)return W.push(this.readSVarint());var ae=d(this);for(W=W||[];this.pos<ae;)W.push(this.readSVarint());return W},readPackedBoolean:function(W){if(this.type!==e.Bytes)return W.push(this.readBoolean());var ae=d(this);for(W=W||[];this.pos<ae;)W.push(this.readBoolean());return W},readPackedFloat:function(W){if(this.type!==e.Bytes)return W.push(this.readFloat());var ae=d(this);for(W=W||[];this.pos<ae;)W.push(this.readFloat());return W},readPackedDouble:function(W){if(this.type!==e.Bytes)return W.push(this.readDouble());var ae=d(this);for(W=W||[];this.pos<ae;)W.push(this.readDouble());return W},readPackedFixed32:function(W){if(this.type!==e.Bytes)return W.push(this.readFixed32());var ae=d(this);for(W=W||[];this.pos<ae;)W.push(this.readFixed32());return W},readPackedSFixed32:function(W){if(this.type!==e.Bytes)return W.push(this.readSFixed32());var ae=d(this);for(W=W||[];this.pos<ae;)W.push(this.readSFixed32());return W},readPackedFixed64:function(W){if(this.type!==e.Bytes)return W.push(this.readFixed64());var ae=d(this);for(W=W||[];this.pos<ae;)W.push(this.readFixed64());return W},readPackedSFixed64:function(W){if(this.type!==e.Bytes)return W.push(this.readSFixed64());var ae=d(this);for(W=W||[];this.pos<ae;)W.push(this.readSFixed64());return W},skip:function(W){var ae=7&W;if(ae===e.Varint)for(;this.buf[this.pos++]>127;);else if(ae===e.Bytes)this.pos=this.readVarint()+this.pos;else if(ae===e.Fixed32)this.pos+=4;else{if(ae!==e.Fixed64)throw new Error("Unimplemented type: "+ae);this.pos+=8}},writeTag:function(W,ae){this.writeVarint(W<<3|ae)},realloc:function(W){for(var ae=this.length||16;ae<this.pos+W;)ae*=2;if(ae!==this.length){var he=new Uint8Array(ae);he.set(this.buf),this.buf=he,this.length=ae}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(W){this.realloc(4),le(this.buf,W,this.pos),this.pos+=4},writeSFixed32:function(W){this.realloc(4),le(this.buf,W,this.pos),this.pos+=4},writeFixed64:function(W){this.realloc(8),le(this.buf,-1&W,this.pos),le(this.buf,Math.floor(W*o),this.pos+4),this.pos+=8},writeSFixed64:function(W){this.realloc(8),le(this.buf,-1&W,this.pos),le(this.buf,Math.floor(W*o),this.pos+4),this.pos+=8},writeVarint:function(W){(W=+W||0)>268435455||W<0?function(ae,he){var ge,Be;if(ae>=0?(ge=ae%4294967296|0,Be=ae/4294967296|0):(Be=~(-ae/4294967296),4294967295^(ge=~(-ae%4294967296))?ge=ge+1|0:(ge=0,Be=Be+1|0)),ae>=18446744073709552e3||ae<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");he.realloc(10),function(ke,je,Ze){Ze.buf[Ze.pos++]=127&ke|128,ke>>>=7,Ze.buf[Ze.pos++]=127&ke|128,ke>>>=7,Ze.buf[Ze.pos++]=127&ke|128,ke>>>=7,Ze.buf[Ze.pos++]=127&ke|128,Ze.buf[Ze.pos]=127&(ke>>>=7)}(ge,0,he),function(ke,je){var Ze=(7&ke)<<4;je.buf[je.pos++]|=Ze|((ke>>>=3)?128:0),ke&&(je.buf[je.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(je.buf[je.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(je.buf[je.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(je.buf[je.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(je.buf[je.pos++]=127&ke)))))}(Be,he)}(W,this):(this.realloc(4),this.buf[this.pos++]=127&W|(W>127?128:0),W<=127||(this.buf[this.pos++]=127&(W>>>=7)|(W>127?128:0),W<=127||(this.buf[this.pos++]=127&(W>>>=7)|(W>127?128:0),W<=127||(this.buf[this.pos++]=W>>>7&127))))},writeSVarint:function(W){this.writeVarint(W<0?2*-W-1:2*W)},writeBoolean:function(W){this.writeVarint(!!W)},writeString:function(W){W=String(W),this.realloc(4*W.length),this.pos++;var ae=this.pos;this.pos=function(ge,Be,ke){for(var je,Ze,ut=0;ut<Be.length;ut++){if((je=Be.charCodeAt(ut))>55295&&je<57344){if(!Ze){je>56319||ut+1===Be.length?(ge[ke++]=239,ge[ke++]=191,ge[ke++]=189):Ze=je;continue}if(je<56320){ge[ke++]=239,ge[ke++]=191,ge[ke++]=189,Ze=je;continue}je=Ze-55296<<10|je-56320|65536,Ze=null}else Ze&&(ge[ke++]=239,ge[ke++]=191,ge[ke++]=189,Ze=null);je<128?ge[ke++]=je:(je<2048?ge[ke++]=je>>6|192:(je<65536?ge[ke++]=je>>12|224:(ge[ke++]=je>>18|240,ge[ke++]=je>>12&63|128),ge[ke++]=je>>6&63|128),ge[ke++]=63&je|128)}return ke}(this.buf,W,this.pos);var he=this.pos-ae;he>=128&&x(ae,he,this),this.pos=ae-1,this.writeVarint(he),this.pos+=he},writeFloat:function(W){this.realloc(4),i.write(this.buf,W,this.pos,!0,23,4),this.pos+=4},writeDouble:function(W){this.realloc(8),i.write(this.buf,W,this.pos,!0,52,8),this.pos+=8},writeBytes:function(W){var ae=W.length;this.writeVarint(ae),this.realloc(ae);for(var he=0;he<ae;he++)this.buf[this.pos++]=W[he]},writeRawMessage:function(W,ae){this.pos++;var he=this.pos;W(ae,this);var ge=this.pos-he;ge>=128&&x(he,ge,this),this.pos=he-1,this.writeVarint(ge),this.pos+=ge},writeMessage:function(W,ae,he){this.writeTag(W,e.Bytes),this.writeRawMessage(ae,he)},writePackedVarint:function(W,ae){ae.length&&this.writeMessage(W,T,ae)},writePackedSVarint:function(W,ae){ae.length&&this.writeMessage(W,S,ae)},writePackedBoolean:function(W,ae){ae.length&&this.writeMessage(W,R,ae)},writePackedFloat:function(W,ae){ae.length&&this.writeMessage(W,P,ae)},writePackedDouble:function(W,ae){ae.length&&this.writeMessage(W,k,ae)},writePackedFixed32:function(W,ae){ae.length&&this.writeMessage(W,B,ae)},writePackedSFixed32:function(W,ae){ae.length&&this.writeMessage(W,j,ae)},writePackedFixed64:function(W,ae){ae.length&&this.writeMessage(W,$,ae)},writePackedSFixed64:function(W,ae){ae.length&&this.writeMessage(W,K,ae)},writeBytesField:function(W,ae){this.writeTag(W,e.Bytes),this.writeBytes(ae)},writeFixed32Field:function(W,ae){this.writeTag(W,e.Fixed32),this.writeFixed32(ae)},writeSFixed32Field:function(W,ae){this.writeTag(W,e.Fixed32),this.writeSFixed32(ae)},writeFixed64Field:function(W,ae){this.writeTag(W,e.Fixed64),this.writeFixed64(ae)},writeSFixed64Field:function(W,ae){this.writeTag(W,e.Fixed64),this.writeSFixed64(ae)},writeVarintField:function(W,ae){this.writeTag(W,e.Varint),this.writeVarint(ae)},writeSVarintField:function(W,ae){this.writeTag(W,e.Varint),this.writeSVarint(ae)},writeStringField:function(W,ae){this.writeTag(W,e.Bytes),this.writeString(ae)},writeFloatField:function(W,ae){this.writeTag(W,e.Fixed32),this.writeFloat(ae)},writeDoubleField:function(W,ae){this.writeTag(W,e.Fixed64),this.writeDouble(ae)},writeBooleanField:function(W,ae){this.writeVarintField(W,!!ae)}},Bv}var k_=qa(j1());const jv=3;function AP(i,e,n){e.glyphs=[],i===1&&n.readMessage(IP,e)}function IP(i,e,n){if(i===3){const{id:o,bitmap:c,width:d,height:p,left:x,top:T,advance:S}=n.readMessage(PP,{});e.glyphs.push({id:o,bitmap:new gp({width:d+2*jv,height:p+2*jv},c),metrics:{width:d,height:p,left:x,top:T,advance:S}})}else i===4?e.ascender=n.readSVarint():i===5&&(e.descender=n.readSVarint())}function PP(i,e,n){i===1?e.id=n.readVarint():i===2?e.bitmap=n.readBytes():i===3?e.width=n.readVarint():i===4?e.height=n.readVarint():i===5?e.left=n.readSVarint():i===6?e.top=n.readSVarint():i===7&&(e.advance=n.readVarint())}const kP=jv,Fa={horizontal:1,vertical:2,horizontalOnly:3};class dg{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(e,n){const o=new dg;return o.scale=e||1,o.fontStack=n,o}static forImage(e){const n=new dg;return n.image=e,n}}class tm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n,o){const c=new tm;for(let d=0;d<e.sections.length;d++){const p=e.sections[d];p.image?c.addImageSection(p,o):c.addTextSection(p,n)}return c}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(n,o){let c="";for(let d=0;d<n.length;d++){const p=n.charCodeAt(d+1)||null,x=n.charCodeAt(d-1)||null;c+=!o&&(p&&Qh(p)&&!hg[n[d+1]]||x&&Qh(x)&&!hg[n[d-1]])||!hg[n[d]]?n[d]:hg[n[d]]}return c}(this.text,e)}trim(){let e=0;for(let o=0;o<this.text.length&&M_[this.text.charCodeAt(o)];o++)e++;let n=this.text.length;for(let o=this.text.length-1;o>=0&&o>=e&&M_[this.text.charCodeAt(o)];o--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const o=new tm;return o.text=this.text.substring(e,n),o.sectionIndex=this.sectionIndex.slice(e,n),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(dg.forText(e.scale,e.fontStack||n));const o=this.sections.length-1;for(let c=0;c<e.text.length;++c)this.sectionIndex.push(o)}addImageSection(e,n){const o=e.image?e.image.getPrimary():null;if(!o)return void Un("Can't add FormattedSection with an empty image.");o.scaleSelf(n);const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(dg.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Un("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Nv(i,e,n,o,c,d,p,x,T,S,P,k,R,B,j,$=1){const K=tm.fromFeature(i,c,$);k===Fa.vertical&&K.verticalizePunctuation(R);let ee=[];const le=function(ge,Be,ke,je,Ze,ut){if(!ge)return[];const Rt=[],wt=function(Pt,ct,ht,Nt,Vt,yn){let cn=0;for(let Jt=0;Jt<Pt.length();Jt++){const Ft=Pt.getSection(Jt);cn+=N1(Pt.getCodePoint(Jt),Ft,Nt,Vt,ct,yn)}return cn/Math.max(1,Math.ceil(cn/ht))}(ge,Be,ke,je,Ze,ut),Mt=ge.text.indexOf("")>=0;let Dt=0;for(let Pt=0;Pt<ge.length();Pt++){const ct=ge.getSection(Pt),ht=ge.getCodePoint(Pt);if(M_[ht]||(Dt+=N1(ht,ct,je,Ze,Be,ut)),Pt<ge.length()-1){const Nt=!((dt=ht)<11904||!(wn["Bopomofo Extended"](dt)||wn.Bopomofo(dt)||wn["CJK Compatibility Forms"](dt)||wn["CJK Compatibility Ideographs"](dt)||wn["CJK Compatibility"](dt)||wn["CJK Radicals Supplement"](dt)||wn["CJK Strokes"](dt)||wn["CJK Symbols and Punctuation"](dt)||wn["CJK Unified Ideographs Extension A"](dt)||wn["CJK Unified Ideographs"](dt)||wn["Enclosed CJK Letters and Months"](dt)||wn["Halfwidth and Fullwidth Forms"](dt)||wn.Hiragana(dt)||wn["Ideographic Description Characters"](dt)||wn["Kangxi Radicals"](dt)||wn["Katakana Phonetic Extensions"](dt)||wn.Katakana(dt)||wn["Vertical Forms"](dt)||wn["Yi Radicals"](dt)||wn["Yi Syllables"](dt)));(MP[ht]||Nt||ct.image)&&Rt.push(q1(Pt+1,Dt,wt,Rt,RP(ht,ge.getCodePoint(Pt+1),Nt&&Mt),!1))}}var dt;return H1(q1(ge.length(),Dt,wt,Rt,0,!0))}(K,S,d,e,o,B),{processBidirectionalText:ce,processStyledBidirectionalText:W}=Ra;if(ce&&K.sections.length===1){const ge=ce(K.toString(),le);for(const Be of ge){const ke=new tm;ke.text=Be,ke.sections=K.sections;for(let je=0;je<Be.length;je++)ke.sectionIndex.push(0);ee.push(ke)}}else if(W){const ge=W(K.text,K.sectionIndex,le);for(const Be of ge){const ke=new tm;ke.text=Be[0],ke.sectionIndex=Be[1],ke.sections=K.sections,ee.push(ke)}}else ee=function(ge,Be){const ke=[],je=ge.text;let Ze=0;for(const ut of Be)ke.push(ge.substring(Ze,ut)),Ze=ut;return Ze<je.length&&ke.push(ge.substring(Ze,je.length)),ke}(K,le);const ae=[],he={positionedLines:ae,text:K.toString(),top:P[1],bottom:P[1],left:P[0],right:P[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(ge,Be,ke,je,Ze,ut,Rt,wt,Mt,Dt,dt,Pt){let ct=0,ht=0,Nt=0;const Vt=wt==="right"?1:wt==="left"?0:.5;let yn=!1;for(const un of Ze){const Mn=un.getSections();for(const Xn of Mn){if(Xn.image)continue;const Gn=Be[Xn.fontStack];if(Gn&&(yn=Gn.ascender!==void 0&&Gn.descender!==void 0,!yn))break}if(!yn)break}let cn=0;for(const un of Ze){un.trim();const Mn=un.getMaxScale(),Xn=(Mn-1)*to,Gn={positionedGlyphs:[],lineOffset:0};ge.positionedLines[cn]=Gn;const ai=Gn.positionedGlyphs;let Qn=0;if(!un.length()){ht+=ut,++cn;continue}let li=0,Vi=0;for(let fe=0;fe<un.length();fe++){const we=un.getSection(fe),gt=un.getSectionIndex(fe),$t=un.getCodePoint(fe);let en=we.scale,Qt=null,on=null,kn=null,mi=to,gi=0;Mt===Fa.vertical&&((Jt=$t)===12312||Jt===12313||Jt===12316||Jt===12540||Jt===12448)&&(Mt=Fa.horizontal);const Jn=!(Mt===Fa.horizontal||!dt&&!Zd($t)||dt&&(M_[$t]||jf($t)));if(we.image){const $i=je.get(we.image.toString());if(!$i)continue;kn=we.image,ge.iconsInText=ge.iconsInText||!0,on=$i.paddedRect;const ur=$i.displaySize;en=en*to/Pt,Qt={width:ur[0],height:ur[1],left:0,top:-3,advance:Jn?ur[1]:ur[0],localGlyph:!1},gi=yn?-Qt.height*en:Mn*to-17-ur[1]*en,mi=Qt.advance;const _i=(Jn?ur[0]:ur[1])*en-to*Mn;_i>0&&_i>Qn&&(Qn=_i)}else{const $i=ke[we.fontStack];if(!$i)continue;$i[$t]&&(on=$i[$t]);const ur=Be[we.fontStack];if(!ur)continue;const _i=ur.glyphs[$t];if(!_i)continue;if(Qt=_i.metrics,mi=$t!==8203?to:0,yn){const Fr=ur.ascender!==void 0?Math.abs(ur.ascender):0,gr=ur.descender!==void 0?Math.abs(ur.descender):0,qi=(Fr+gr)*en;li<qi&&(li=qi,Vi=(Fr-gr)/2*en),gi=-Fr*en}else gi=(Mn-en)*to-17}Jn?(ge.verticalizable=!0,ai.push({glyph:$t,image:kn,x:ct,y:ht+gi,vertical:Jn,scale:en,localGlyph:Qt.localGlyph,fontStack:we.fontStack,sectionIndex:gt,metrics:Qt,rect:on}),ct+=mi*en+Dt):(ai.push({glyph:$t,image:kn,x:ct,y:ht+gi,vertical:Jn,scale:en,localGlyph:Qt.localGlyph,fontStack:we.fontStack,sectionIndex:gt,metrics:Qt,rect:on}),ct+=Qt.advance*en+Dt)}ai.length!==0&&(Nt=Math.max(ct-Dt,Nt),yn?U1(ai,Vt,Qn,Vi,ut*Mn/2):U1(ai,Vt,Qn,0,ut/2)),ct=0;const mr=ut*Mn+Qn;Gn.lineOffset=Math.max(Qn,Xn),ht+=mr,++cn}var Jt;const Ft=ht,{horizontalAlign:Bn,verticalAlign:ln}=Vv(Rt);(function(un,Mn,Xn,Gn,ai,Qn){const li=(Mn-Xn)*ai,Vi=-Qn*Gn;for(const mr of un)for(const fe of mr.positionedGlyphs)fe.x+=li,fe.y+=Vi})(ge.positionedLines,Vt,Bn,ln,Nt,Ft),ge.top+=-ln*Ft,ge.bottom=ge.top+Ft,ge.left+=-Bn*Nt,ge.right=ge.left+Nt,ge.hasBaseline=yn}(he,e,n,o,ee,p,x,T,k,S,R,j),!function(ge){for(const Be of ge)if(Be.positionedGlyphs.length!==0)return!1;return!0}(ae))return he}const M_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},MP={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function N1(i,e,n,o,c,d){if(e.image){const p=o.get(e.image.toString());return p?p.displaySize[0]*e.scale*to/d+c:0}{const p=n[e.fontStack],x=p&&p.glyphs[i];return x?x.metrics.advance*e.scale+c:0}}function V1(i,e,n,o){const c=Math.pow(i-e,2);return o?i<e?c/2:2*c:c+Math.abs(n)*n}function RP(i,e,n){let o=0;return i===10&&(o-=1e4),n&&(o+=150),i!==40&&i!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function q1(i,e,n,o,c,d){let p=null,x=V1(e,n,c,d);for(const T of o){const S=V1(e-T.x,n,c,d)+T.badness;S<=x&&(p=T,x=S)}return{index:i,x:e,priorBreak:p,badness:x}}function H1(i){return i?H1(i.priorBreak).concat(i.index):[]}function Vv(i){let e=.5,n=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function U1(i,e,n,o,c){if(!(e||n||o||c))return;const d=i.length-1,p=i[d],x=(p.x+p.metrics.advance*p.scale)*e;for(let T=0;T<=d;T++)i[T].x-=x,i[T].y+=n+o+c}function $1(i){return i.imagePrimary!==void 0&&i.top!==void 0&&i.bottom!==void 0&&i.left!==void 0&&i.right!==void 0}function zP(i,e,n,o){const{horizontalAlign:c,verticalAlign:d}=Vv(o),p=n[0]-i.displaySize[0]*c,x=n[1]-i.displaySize[1]*d;return{imagePrimary:i,imageSecondary:e,top:x,bottom:x+i.displaySize[1],left:p,right:p+i.displaySize[0]}}function G1(i,e,n,o,c,d){const p=i.imagePrimary;let x;if(p.content){const K=p.content,ee=p.pixelRatio||1;x=[K[0]/ee,K[1]/ee,p.displaySize[0]-K[2]/ee,p.displaySize[1]-K[3]/ee]}const T=e.left*d,S=e.right*d;let P,k,R,B;n==="width"||n==="both"?(B=c[0]+T-o[3],k=c[0]+S+o[1]):(B=c[0]+(T+S-p.displaySize[0])/2,k=B+p.displaySize[0]);const j=e.top*d,$=e.bottom*d;return n==="height"||n==="both"?(P=c[1]+j-o[0],R=c[1]+$+o[2]):(P=c[1]+(j+$-p.displaySize[1])/2,R=P+p.displaySize[1]),{imagePrimary:p,imageSecondary:void 0,top:P,right:k,bottom:R,left:B,collisionPadding:x}}function W1(i){return!i.imagePrimary.stretchX}function Z1(i){return!i.imagePrimary.stretchY}function K1(i){return{width:i.right-i.left,height:i.bottom-i.top}}const mh=128;function X1(i,e,n){const{expression:o}=e;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new ji(i+1,{worldview:n}))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:d}=o;let p=0;for(;p<c.length&&c[p]<=i;)p++;p=Math.max(0,p-1);let x=p;for(;x<c.length&&c[x]<i+1;)x++;x=Math.min(c.length-1,x);const T=c[p],S=c[x];return o.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:S,interpolationType:d}:{kind:"camera",minZoom:T,maxZoom:S,minSize:o.evaluate(new ji(T,{worldview:n})),maxSize:o.evaluate(new ji(S,{worldview:n})),interpolationType:d}}}function qv(i,{uSize:e,uSizeT:n},{lowerSize:o,upperSize:c}){return i.kind==="source"?o/mh:i.kind==="composite"?Cn(o/mh,c/mh,n):e}function pg(i,e,n=1){let o=0,c=0;if(i.kind==="constant")c=i.layoutSize*n;else if(i.kind!=="source"){const{interpolationType:d,minZoom:p,maxZoom:x}=i,T=d?Ce(Fs.interpolationFactor(d,e,p,x),0,1):0;i.kind==="camera"?c=Cn(i.minSize,i.maxSize,T)*n:o=T*n}return{uSizeT:o,uSize:c}}class gd extends Wt{constructor(e,n,o,c,d){super(e,n),this.angle=c,this.z=o,d!==void 0&&(this.segment=d)}clone(){return new gd(this.x,this.y,this.z,this.angle,this.segment)}}function Y1(i,e,n,o,c){if(e.segment===void 0)return!0;let d=e,p=e.segment+1,x=0;for(;x>-n/2;){if(p--,p<0)return!1;x-=i[p].dist(d),d=i[p]}x+=i[p].dist(i[p+1]),p++;const T=[];let S=0;for(;x<n/2;){const P=i[p],k=i[p+1];if(!k)return!1;let R=i[p-1].angleTo(P)-P.angleTo(k);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:x,angleDelta:R}),S+=R;x-T[0].distance>o;)S-=T.shift().angleDelta;if(S>c)return!1;p++,x+=P.dist(k)}return!0}function Q1(i){let e=0;for(let n=0;n<i.length-1;n++)e+=i[n].dist(i[n+1]);return e}function J1(i,e,n){return i?.6*e*n:0}function ew(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function LP(i,e,n,o,c,d){const p=J1(n,c,d),x=ew(n,o)*d;let T=0;const S=Q1(i)/2;for(let P=0;P<i.length-1;P++){const k=i[P],R=i[P+1],B=k.dist(R);if(T+B>S){const j=(S-T)/B,$=Cn(k.x,R.x,j),K=Cn(k.y,R.y,j),ee=new gd($,K,0,R.angleTo(k),P);return!p||Y1(i,ee,x,p,e)?ee:void 0}T+=B}}function DP(i,e,n,o,c,d,p,x,T){const S=J1(o,d,p),P=ew(o,c),k=P*p,R=i[0].x===0||i[0].x===T||i[0].y===0||i[0].y===T;return e-k<e/4&&(e=k+e/4),tw(i,R?e/2*x%e:(P/2+2*d)*p*x%e,e,S,n,k,R,!1,T)}function tw(i,e,n,o,c,d,p,x,T){const S=d/2,P=Q1(i);let k=0,R=e-n,B=[];for(let j=0;j<i.length-1;j++){const $=i[j],K=i[j+1],ee=$.dist(K),le=K.angleTo($);for(;R+n<k+ee;){R+=n;const ce=(R-k)/ee,W=Cn($.x,K.x,ce),ae=Cn($.y,K.y,ce);if(W>=0&&W<T&&ae>=0&&ae<T&&R-S>=0&&R+S<=P){const he=new gd(W,ae,0,le,j);o&&!Y1(i,he,d,o,c)||B.push(he)}}k+=ee}return x||B.length||p||(B=tw(i,k/2,n,o,c,d,p,!0,T)),B}function nw(i){let e=0,n=0;for(const p of i)e+=p.w*p.h,n=Math.max(n,p.w);i.sort((p,x)=>x.h-p.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let c=0,d=0;for(const p of i)for(let x=o.length-1;x>=0;x--){const T=o[x];if(!(p.w>T.w||p.h>T.h)){if(p.x=T.x,p.y=T.y,d=Math.max(d,p.y+p.h),c=Math.max(c,p.x+p.w),p.w===T.w&&p.h===T.h){const S=o.pop();x<o.length&&(o[x]=S)}else p.h===T.h?(T.x+=p.w,T.w-=p.w):p.w===T.w?(T.y+=p.h,T.h-=p.h):(o.push({x:T.x+p.w,y:T.y,w:T.w-p.w,h:p.h}),T.y+=p.h,T.h-=p.h);break}}return{w:c,h:d,fill:e/(c*d)||0}}nn(gd,"Anchor");const df=1;class fg{static getImagePositionScale(e,n,o){if(n&&e&&e.options&&e.options.transform){const c=e.options.transform;return{x:c.a,y:c.d}}return{x:o,y:o}}constructor(e,n,o,c){this.paddedRect=e;const{pixelRatio:d,version:p,stretchX:x,stretchY:T,content:S,sdf:P,usvg:k}=n;this.pixelRatio=d,this.stretchX=x,this.stretchY=T,this.content=S,this.version=p,this.padding=o,this.sdf=P,this.usvg=k,this.scale=fg.getImagePositionScale(c,k,d)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function Hv(i,e,n){const o=bl.parse(i),c=function(d,p,x=[1,1]){return{x:0,y:0,w:(d.data?d.data.width:d.width*x[0])+2*p,h:(d.data?d.data.height:d.height*x[1])+2*p}}(e,n,[o.options.transform.a,o.options.transform.d]);return{bin:c,imagePosition:new fg(c,e,n,o),imageVariant:o}}class iw{constructor(e,n,o){const c=new Map,d=new Map;this.haveRenderCallbacks=[];const p=[];this.addImages(e,c,df,p),this.addImages(n,d,2,p);const{w:x,h:T}=nw(p),S=new wo({width:x||1,height:T||1});for(const[P,k]of e.entries()){const R=c.get(P).paddedRect;wo.copy(k.data,S,{x:0,y:0},{x:R.x+df,y:R.y+df},k.data,o,k.sdf)}for(const[P,k]of n.entries()){const R=d.get(P),B=R.paddedRect;let j=R.padding;const $=B.x+j,K=B.y+j,ee=k.data.width,le=k.data.height;j=j>1?j-1:j,wo.copy(k.data,S,{x:0,y:0},{x:$,y:K},k.data,o),wo.copy(k.data,S,{x:0,y:le-j},{x:$,y:K-j},{width:ee,height:j},o),wo.copy(k.data,S,{x:0,y:0},{x:$,y:K+le},{width:ee,height:j},o),wo.copy(k.data,S,{x:ee-j,y:0},{x:$-j,y:K},{width:j,height:le},o),wo.copy(k.data,S,{x:0,y:0},{x:$+ee,y:K},{width:j,height:le},o),wo.copy(k.data,S,{x:ee-j,y:le-j},{x:$-j,y:K-j},{width:j,height:j},o),wo.copy(k.data,S,{x:0,y:le-j},{x:$+ee,y:K-j},{width:j,height:j},o),wo.copy(k.data,S,{x:0,y:0},{x:$+ee,y:K+le},{width:j,height:j},o),wo.copy(k.data,S,{x:ee-j,y:0},{x:$-j,y:K+le},{width:j,height:j},o)}this.lut=o,this.image=S,this.iconPositions=c,this.patternPositions=d}addImages(e,n,o,c){for(const[d,p]of e.entries()){const{bin:x,imagePosition:T,imageVariant:S}=Hv(d,p,o);n.set(d,T),c.push(x),p.hasRenderCallback&&this.haveRenderCallbacks.push(S.id)}}patchUpdatedImages(e,n,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>e.hasImage(c,o)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,o);for(const c of e.getUpdatedImages(o)){for(const d of this.iconPositions.keys()){const p=bl.parse(d);if(oo.isEqual(p.id,c)){const x=e.getImage(c,o);this.patchUpdatedImage(this.iconPositions.get(d),x,n)}}for(const d of this.patternPositions.keys()){const p=bl.parse(d);if(oo.isEqual(p.id,c)){const x=e.getImage(c,o);this.patchUpdatedImage(this.patternPositions.get(d),x,n)}}}}patchUpdatedImage(e,n,o){if(!e||!n||e.version===n.version)return;e.version=n.version;const[c,d]=e.tl,p=e.sdf;if(this.lut||p){const x={width:n.data.width,height:n.data.height},T=new wo(x);wo.copy(n.data,T,{x:0,y:0},{x:0,y:0},x,this.lut,p),o.update(T,{position:{x:c,y:d}})}else o.update(n.data,{position:{x:c,y:d}})}}nn(fg,"ImagePosition"),nn(iw,"ImageAtlas");const R_=1e20;function rw(i,e,n,o,c,d,p,x,T){for(let S=e;S<e+o;S++)sw(i,n*d+S,d,c,p,x,T);for(let S=n;S<n+c;S++)sw(i,S*d+e,1,o,p,x,T)}function sw(i,e,n,o,c,d,p){d[0]=0,p[0]=-1e20,p[1]=R_,c[0]=i[e];for(let x=1,T=0,S=0;x<o;x++){c[x]=i[e+x*n];const P=x*x;do{const k=d[T];S=(c[x]-c[k]+P-k*k)/(x-k)/2}while(S<=p[T]&&--T>-1);T++,d[T]=x,p[T]=S,p[T+1]=R_}for(let x=0,T=0;x<o;x++){for(;p[T+1]<x;)T++;const S=d[T],P=x-S;i[e+x*n]=c[S]+P*P}}const xu=2,Uv={none:0,ideographs:1,all:2};class nm{constructor(e,n,o){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=o,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,n){this.urls[n]=e}getGlyphs(e,n,o){const c=[],d=this.urls[n]||Ds.GLYPHS_URL;for(const p in e)for(const x of e[p])c.push({stack:p,id:x});Ue(c,({stack:p,id:x},T)=>{let S=this.entries[p];S||(S=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let P=S.glyphs[x];if(P!==void 0)return void T(null,{stack:p,id:x,glyph:P});if(P=this._tinySDF(S,p,x),P)return S.glyphs[x]=P,void T(null,{stack:p,id:x,glyph:P});const k=Math.floor(x/256);if(256*k>65535)return Un("glyphs > 65535 not supported"),void T(null,{stack:p,id:x,glyph:P});if(S.ranges[k])return void T(null,{stack:p,id:x,glyph:P});let R=S.requests[k];R||(R=S.requests[k]=[],nm.loadGlyphRange(p,k,d,this.requestManager,(B,j)=>{if(j){S.ascender=j.ascender,S.descender=j.descender;for(const $ in j.glyphs)this._doesCharSupportLocalGlyph(+$)||(S.glyphs[+$]=j.glyphs[+$]);S.ranges[k]=!0}for(const $ of R)$(B,j);delete S.requests[k]})),R.push((B,j)=>{B?T(B):j&&T(null,{stack:p,id:x,glyph:j.glyphs[x]||null})})},(p,x)=>{if(p)o(p);else if(x){const T={};for(const{stack:S,id:P,glyph:k}of x)T[S]===void 0&&(T[S]={}),T[S].glyphs===void 0&&(T[S].glyphs={}),T[S].glyphs[P]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},T[S].ascender=this.entries[S].ascender,T[S].descender=this.entries[S].descender;o(null,T)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Uv.none&&(this.localGlyphMode===Uv.all?!!this.localFontFamily:!!this.localFontFamily&&(wn["CJK Unified Ideographs"](e)||wn["Hangul Syllables"](e)||wn.Hiragana(e)||wn.Katakana(e)||wn["CJK Symbols and Punctuation"](e)||wn["CJK Unified Ideographs Extension A"](e)||wn["CJK Unified Ideographs Extension B"](e)||wn.Osage(e)))}_tinySDF(e,n,o){const c=this.localFontFamily;if(!c||!this._doesCharSupportLocalGlyph(o))return;let d=e.tinySDF;if(!d){let $="400";/bold/i.test(n)?$="900":/medium/i.test(n)?$="500":/light/i.test(n)&&($="200"),d=e.tinySDF=new nm.TinySDF({fontFamily:c,fontWeight:$,fontSize:24*xu,buffer:3*xu,radius:8*xu}),d.fontWeight=$}if(this.localGlyphs[d.fontWeight][o])return this.localGlyphs[d.fontWeight][o];const p=String.fromCodePoint(o),{data:x,width:T,height:S,glyphWidth:P,glyphHeight:k,glyphLeft:R,glyphTop:B,glyphAdvance:j}=d.draw(p);return this.localGlyphs[d.fontWeight][o]={id:o,bitmap:new gp({width:T,height:S},x),metrics:{width:P/xu,height:k/xu,left:R/xu,top:B/xu-27,advance:j/xu,localGlyph:!0}}}}nm.loadGlyphRange=function(i,e,n,o,c){const d=256*e,p=d+255,x=o.transformRequest(o.normalizeGlyphsURL(n).replace("{fontstack}",i).replace("{range}",`${d}-${p}`),ga.Glyphs);Ih(x,(T,S)=>{if(T)c(T);else if(S){const P={},k=function(R){return new k_(R).readFields(AP,{})}(S);for(const R of k.glyphs)P[R.id]=R;c(null,{glyphs:P,ascender:k.ascender,descender:k.descender})}})},nm.TinySDF=class{constructor({fontSize:i=24,buffer:e=3,radius:n=8,cutoff:o=.25,fontFamily:c="sans-serif",fontWeight:d="normal",fontStyle:p="normal"}={}){this.buffer=e,this.cutoff=o,this.radius=n;const x=this.size=i+4*e,T=this._createCanvas(x),S=this.ctx=T.getContext("2d",{willReadFrequently:!0});S.font=`${p} ${d} ${i}px ${c}`,S.textBaseline="alphabetic",S.textAlign="left",S.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(i){const e=document.createElement("canvas");return e.width=e.height=i,e}draw(i){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:o,actualBoundingBoxLeft:c,actualBoundingBoxRight:d}=this.ctx.measureText(i),p=Math.ceil(n),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-c))),T=Math.min(this.size-this.buffer,p+Math.ceil(o)),S=x+2*this.buffer,P=T+2*this.buffer,k=Math.max(S*P,0),R=new Uint8ClampedArray(k),B={data:R,width:S,height:P,glyphWidth:x,glyphHeight:T,glyphTop:p,glyphLeft:0,glyphAdvance:e};if(x===0||T===0)return B;const{ctx:j,buffer:$,gridInner:K,gridOuter:ee}=this;j.clearRect($,$,x,T),j.fillText(i,$,$+p);const le=j.getImageData($,$,x,T);ee.fill(R_,0,k),K.fill(0,0,k);for(let ce=0;ce<T;ce++)for(let W=0;W<x;W++){const ae=le.data[4*(ce*x+W)+3]/255;if(ae===0)continue;const he=(ce+$)*S+W+$;if(ae===1)ee[he]=0,K[he]=R_;else{const ge=.5-ae;ee[he]=ge>0?ge*ge:0,K[he]=ge<0?ge*ge:0}}rw(ee,0,0,S,P,S,this.f,this.v,this.z),rw(K,$,$,x,T,S,this.f,this.v,this.z);for(let ce=0;ce<k;ce++){const W=Math.sqrt(ee[ce])-Math.sqrt(K[ce]);R[ce]=Math.round(255-255*(W/this.radius+this.cutoff))}return B}};const pf=df;function ow(i,e){return i+e[1]-e[0]}function aw(i,e,n,o,c=1){const d=[],p=i.imagePrimary,x=p.pixelRatio,T=p.paddedRect.w-2*pf,S=p.paddedRect.h-2*pf,P=(i.right-i.left)*c,k=(i.bottom-i.top)*c,R=p.stretchX||[[0,T]],B=p.stretchY||[[0,S]],j=R.reduce(ow,0),$=B.reduce(ow,0),K=T-j,ee=S-$;let le=0,ce=j,W=0,ae=$,he=0,ge=K,Be=0,ke=ee;if(p.content&&o){const Ze=p.content;le=z_(R,0,Ze[0]),W=z_(B,0,Ze[1]),ce=z_(R,Ze[0],Ze[2]),ae=z_(B,Ze[1],Ze[3]),he=Ze[0]-le,Be=Ze[1]-W,ge=Ze[2]-Ze[0]-ce,ke=Ze[3]-Ze[1]-ae}const je=(Ze,ut,Rt,wt)=>{const Mt=L_(Ze.stretch-le,ce,P,i.left*c),Dt=D_(Ze.fixed-he,ge,Ze.stretch,j),dt=L_(ut.stretch-W,ae,k,i.top*c),Pt=D_(ut.fixed-Be,ke,ut.stretch,$),ct=L_(Rt.stretch-le,ce,P,i.left*c),ht=D_(Rt.fixed-he,ge,Rt.stretch,j),Nt=L_(wt.stretch-W,ae,k,i.top*c),Vt=D_(wt.fixed-Be,ke,wt.stretch,$),yn=new Wt(Mt,dt),cn=new Wt(ct,dt),Jt=new Wt(ct,Nt),Ft=new Wt(Mt,Nt),Bn=new Wt(Dt/x,Pt/x),ln=new Wt(ht/x,Vt/x),un=e*Math.PI/180;if(un){const li=Math.sin(un),Vi=Math.cos(un),mr=[Vi,-li,li,Vi];yn._matMult(mr),cn._matMult(mr),Ft._matMult(mr),Jt._matMult(mr)}const Mn=Ze.stretch+Ze.fixed,Xn=Rt.stretch+Rt.fixed,Gn=ut.stretch+ut.fixed,ai=wt.stretch+wt.fixed,Qn=i.imageSecondary;return{tl:yn,tr:cn,bl:Ft,br:Jt,texPrimary:{x:p.paddedRect.x+pf+Mn,y:p.paddedRect.y+pf+Gn,w:Xn-Mn,h:ai-Gn},texSecondary:Qn?{x:Qn.paddedRect.x+pf+Mn,y:Qn.paddedRect.y+pf+Gn,w:Xn-Mn,h:ai-Gn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Bn,pixelOffsetBR:ln,minFontScaleX:ge/x/P,minFontScaleY:ke/x/k,isSDF:n}};if(o&&(p.stretchX||p.stretchY)){const Ze=lw(R,K,j),ut=lw(B,ee,$);for(let Rt=0;Rt<Ze.length-1;Rt++){const wt=Ze[Rt],Mt=Ze[Rt+1];for(let Dt=0;Dt<ut.length-1;Dt++)d.push(je(wt,ut[Dt],Mt,ut[Dt+1]))}}else d.push(je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:S+1}));return d}function z_(i,e,n){let o=0;for(const c of i)o+=Math.max(e,Math.min(n,c[1]))-Math.max(e,Math.min(n,c[0]));return o}function lw(i,e,n){const o=[{fixed:-1,stretch:0}];for(const[c,d]of i){const p=o[o.length-1];o.push({fixed:c-p.stretch,stretch:p.stretch}),o.push({fixed:c-p.stretch,stretch:p.stretch+(d-c)})}return o.push({fixed:e+pf,stretch:n}),o}function L_(i,e,n,o){return i/e*n+o}function D_(i,e,n,o){return i-e*n/o}function OP(i,e,n,o){const c=e+i.positionedLines[o].lineOffset;return o===0?n+c/2:n+(c+(e+i.positionedLines[o-1].lineOffset))/2}function BP(i,e=1,n=!1){let o=1/0,c=1/0,d=-1/0,p=-1/0;const x=i[0];for(let B=0;B<x.length;B++){const j=x[B];(!B||j.x<o)&&(o=j.x),(!B||j.y<c)&&(c=j.y),(!B||j.x>d)&&(d=j.x),(!B||j.y>p)&&(p=j.y)}const T=Math.min(d-o,p-c);let S=T/2;const P=new Ou([],FP);if(T===0)return new Wt(o,c);for(let B=o;B<d;B+=T)for(let j=c;j<p;j+=T)P.push(new im(B+S,j+S,S,i));let k=function(B){let j=0,$=0,K=0;const ee=B[0];for(let le=0,ce=ee.length,W=ce-1;le<ce;W=le++){const ae=ee[le],he=ee[W],ge=ae.x*he.y-he.x*ae.y;$+=(ae.x+he.x)*ge,K+=(ae.y+he.y)*ge,j+=3*ge}return new im($/j,K/j,0,B)}(i),R=P.length;for(;P.length;){const B=P.pop();(B.d>k.d||!k.d)&&(k=B,n&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,R)),B.max-k.d<=e||(S=B.h/2,P.push(new im(B.p.x-S,B.p.y-S,S,i)),P.push(new im(B.p.x+S,B.p.y-S,S,i)),P.push(new im(B.p.x-S,B.p.y+S,S,i)),P.push(new im(B.p.x+S,B.p.y+S,S,i)),R+=4)}return n&&(console.log(`num probes: ${R}`),console.log(`best distance: ${k.d}`)),k.p}function FP(i,e){return e.max-i.max}class im{constructor(e,n,o,c){this.p=new Wt(e,n),this.h=o,this.d=function(d,p){let x=!1,T=1/0;for(let S=0;S<p.length;S++){const P=p[S];for(let k=0,R=P.length,B=R-1;k<R;B=k++){const j=P[k],$=P[B];j.y>d.y!=$.y>d.y&&d.x<($.x-j.x)*(d.y-j.y)/($.y-j.y)+j.x&&(x=!x),T=Math.min(T,fp(d,j,$))}}return(x?1:-1)*Math.sqrt(T)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}}const jP=Object.keys,$v=Number.POSITIVE_INFINITY,NP=Math.sqrt(2);function cw(i,[e,n]){let o=0,c=0;if(n===$v){e<0&&(e=0);const d=e/NP;switch(i){case"top-right":case"top-left":c=d-7;break;case"bottom-right":case"bottom-left":c=7-d;break;case"bottom":c=7-e;break;case"top":c=e-7}switch(i){case"top-right":case"bottom-right":o=-d;break;case"top-left":case"bottom-left":o=d;break;case"left":o=e;break;case"right":o=-e}}else{switch(e=Math.abs(e),n=Math.abs(n),i){case"top-right":case"top-left":case"top":c=n-7;break;case"bottom-right":case"bottom-left":case"bottom":c=7-n}switch(i){case"top-right":case"bottom-right":case"right":o=-e;break;case"top-left":case"bottom-left":case"left":o=e}}return[o,c]}function O_(i,e,n,o,c,d,p,x,T){if(!e||!e.usvg)return;const S=K1(o),P=K1(c),k=d!=="both"&&d!=="width"||!W1(o)?1:P.width/S.width,R=d!=="both"&&d!=="height"||!Z1(o)?1:P.height/S.height;n.scaleSelf(k,R);const B=n.toString();p.set(B,n),x.set(B,e);const{imagePosition:j}=Hv(B,e,df);T.set(B,j)}function uw(i,e,n,o,c,d,p,x,T){if(!i)return;const S=function(P,k,R,B,j,$){if(P.kind==="camera")return P.maxSize;if(P.kind==="composite"){const K=k.possiblyEvaluate(new ji(P.maxZoom,{worldview:$}),R).evaluate(j,{},R),ee=k.possiblyEvaluate(new ji(P.minZoom,{worldview:$}),R).evaluate(j,{},R);return Math.max(K,ee)}return k.possiblyEvaluate(new ji(B,{worldview:$})).evaluate(j,{},R)}(e,n,o,c,d,T);return i.scaleSelf(S*x*p)}function hw(i,e,n,o,c,d,p,x,T){return{iconPrimary:uw(i.getPrimary(),e,n,o,c,d,p,x,T),iconSecondary:uw(i.getSecondary(),e,n,o,c,d,p,x,T)}}function VP(i,e,n){if(!e)return;const o=n.get(i.toString()),c=n.get(e.toString());c&&(o.paddedRect.w===c.paddedRect.w&&o.paddedRect.h===c.paddedRect.h||Un(`Mismatch in icon variant sizes: ${i.toString()} and ${e.toString()}`),o.usvg!==c.usvg&&Un(`Mismatch in icon variant image types: ${i.id} and ${e.id}`))}function dw(i,e,n,o){if(!i)return;const c=e.get(n.toString());if(i.imagePrimary=c,o){const d=e.get(o.toString());i.imageSecondary=d}}function qP(i,e){for(const n in i.horizontal)pw(i.horizontal[n],e);pw(i.vertical,e)}function pw(i,e){if(i){for(const n of i.positionedLines)for(const o of n.positionedGlyphs)if(o.image!==null){const c=o.image.toString();o.rect=e.get(c).paddedRect}}}function Gv(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function HP(i,e,n,o,c,d,p,x,T){const S=Wv(d.horizontal)||d.vertical,P=n.get("icon-text-fit-padding").evaluate(o,{},c);let k,R=e;return e&&T!=="none"&&(i.allowVerticalPlacement&&d.vertical&&(k=G1(e,d.vertical,T,P,x,p)),S&&(R=G1(e,S,T,P,x,p))),{defaultShapedIcon:R,verticallyShapedIcon:k}}function UP(i,e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K,ee,le,ce){let W=p.textMaxSize.evaluate(e,{},R);W===void 0?W=x*p.textScaleFactor:W*=p.textScaleFactor;const ae=i.layers[0].layout,he=Wv(n.horizontal)||n.vertical,ge=B.name==="globe",Be=to,ke=i.tilePixelRatio*W/Be,je=(Dt=i.overscaling,i.zoom>18&&Dt>2&&(Dt>>=1),Math.max(Kt/(512*Dt),1)*ae.get("symbol-spacing")),Ze=ae.get("text-padding")*i.tilePixelRatio,ut=ae.get("icon-padding")*i.tilePixelRatio,Rt=Ei(ae.get("text-max-angle")),wt=ae.get("icon-rotation-alignment")==="map"&&ce!=="point",Mt=je/2;var Dt;i.hasAnyIconTextFit===!1&&K!=="none"&&(i.hasAnyIconTextFit=!0);const dt=e.properties?+e.properties[si]:null,Pt=dt&&i.elevationFeatureIdToIndex?i.elevationFeatureIdToIndex.get(dt):65535,ct=(ht,Nt,Vt)=>{if(Nt.x<0||Nt.x>=Kt||Nt.y<0||Nt.y>=Kt)return;let yn=null;if(ge){const{x:cn,y:Jt,z:Ft}=B.projectTilePoint(Nt.x,Nt.y,Vt);yn={anchor:new gd(cn,Jt,Ft,0,void 0),up:B.upVector(Vt,Nt.x,Nt.y)}}(function(cn,Jt,Ft,Bn,ln,un,Mn,Xn,Gn,ai,Qn,li,Vi,mr,fe,we,gt,$t,en,Qt,on,kn,mi,gi,Jn,$i,ur,_i,Fr){const gr=cn.addToLineVertexArray(Jt,Bn);let qi,Ur,wr,hr,_r,Wi,ri,Xi=0,jr=0,En=0,Si=0,Tr=-1,Vr=-1;const Ar={};let gs=jc("");const tr=Ft?Ft.anchor:Jt,ps=_i!=="none";let ba=0,To=0;if(Gn._unevaluatedLayout.getValue("text-radial-offset")===void 0){const _s=Gn.layout.get("text-offset").evaluate(on,{},Jn);ba=_s[0]*to,To=_s[1]*to}else ba=Gn.layout.get("text-radial-offset").evaluate(on,{},Jn)*to,To=$v;if(cn.allowVerticalPlacement&&ln.vertical){const _s=ln.vertical;if(fe)Wi=Zv(_s),Xn&&(ri=Zv(Xn));else{const Rs=Gn.layout.get("text-rotate").evaluate(on,{},Jn)+90;wr=B_(ai,tr,Jt,Qn,li,Vi,_s,mr,Rs,we),Xn&&(hr=B_(ai,tr,Jt,Qn,li,Vi,Xn,$t,Rs))}}if(un){const _s=cn.iconSizeData,Rs=Gn.layout.get("icon-rotate").evaluate(on,{},Jn),So=aw(un,Rs,mi,ps,kn.iconScaleFactor),ta=Xn?aw(Xn,Rs,mi,ps,kn.iconScaleFactor):void 0;Ur=B_(ai,tr,Jt,Qn,li,Vi,un,$t,Rs,null),Xi=4*So.length;let Fo=null;_s.kind==="source"?(Fo=[mh*Gn.layout.get("icon-size").evaluate(on,{},Jn)*kn.iconScaleFactor],Fo[0]>yp&&Un(`${cn.layerIds[0]}: Value for "icon-size" is >= ${mg}. Reduce your "icon-size".`)):_s.kind==="composite"&&(Fo=[mh*kn.compositeIconSizes[0].evaluate(on,{},Jn)*kn.iconScaleFactor,mh*kn.compositeIconSizes[1].evaluate(on,{},Jn)*kn.iconScaleFactor],(Fo[0]>yp||Fo[1]>yp)&&Un(`${cn.layerIds[0]}: Value for "icon-size" is >= ${mg}. Reduce your "icon-size".`)),cn.addSymbols(cn.icon,So,Fo,Qt,en,on,void 0,Ft,Jt,gr.lineStartIndex,gr.lineLength,-1,gi,Jn,$i,ur),Tr=cn.icon.placedSymbolArray.length-1,ta&&(jr=4*ta.length,cn.addSymbols(cn.icon,ta,Fo,Qt,en,on,Fa.vertical,Ft,Jt,gr.lineStartIndex,gr.lineLength,-1,gi,Jn,$i,ur),Vr=cn.icon.placedSymbolArray.length-1)}for(const _s in ln.horizontal){const Rs=_s,So=ln.horizontal[Rs];qi||(gs=jc(So.text),fe?_r=Zv(So):qi=B_(ai,tr,Jt,Qn,li,Vi,So,mr,Gn.layout.get("text-rotate").evaluate(on,{},Jn),we));const ta=So.positionedLines.length===1;if(En+=fw(cn,Ft,Jt,So,Mn,Gn,fe,on,we,gr,ln.vertical?Fa.horizontal:Fa.horizontalOnly,ta?jP(ln.horizontal):[Rs],Ar,Tr,kn,gi,Jn,$i),ta)break}ln.vertical&&(Si+=fw(cn,Ft,Jt,ln.vertical,Mn,Gn,fe,on,we,gr,Fa.vertical,["vertical"],Ar,Vr,kn,gi,Jn,$i));let co=-1;const wa=(_s,Rs)=>_s?Math.max(_s,Rs):Rs;co=wa(_r,co),co=wa(Wi,co),co=wa(ri,co);const gh=co>-1?1:0;cn.glyphOffsetArray.length>=65535&&Un("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),on.sortKey!==void 0&&cn.addToSortKeyRanges(cn.symbolInstances.length,on.sortKey),cn.symbolInstances.emplaceBack(Jt.x,Jt.y,tr.x,tr.y,tr.z,Ar.right>=0?Ar.right:-1,Ar.center>=0?Ar.center:-1,Ar.left>=0?Ar.left:-1,Ar.vertical>=0?Ar.vertical:-1,Tr,Vr,gs,qi!==void 0?qi:cn.collisionBoxArray.length,qi!==void 0?qi+1:cn.collisionBoxArray.length,wr!==void 0?wr:cn.collisionBoxArray.length,wr!==void 0?wr+1:cn.collisionBoxArray.length,Ur!==void 0?Ur:cn.collisionBoxArray.length,Ur!==void 0?Ur+1:cn.collisionBoxArray.length,hr||cn.collisionBoxArray.length,hr?hr+1:cn.collisionBoxArray.length,Qn,En,Si,Xi,jr,gh,0,ba,To,co,0,ps?1:0,Fr)})(i,Nt,yn,ht,n,o,d,c,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,Ze,le,S,0,ut,wt,ee,e,p,P,k,R,j,$,K,Pt)};if(ce==="line")for(const ht of E_(e.geometry,0,0,Kt,Kt)){const Nt=DP(ht,je,Rt,n.vertical||he,o,Be,ke,i.overscaling,Kt);for(const Vt of Nt)he&&$P(i,he.text,Mt,Vt)||ct(ht,Vt,R)}else if(ce==="line-center"){for(const ht of e.geometry)if(ht.length>1){const Nt=LP(ht,Rt,n.vertical||he,o,Be,ke);Nt&&ct(ht,Nt,R)}}else if(e.type==="Polygon")for(const ht of x_(e.geometry,0)){const Nt=BP(ht,16);ct(ht[0],new gd(Nt.x,Nt.y,0,0,void 0),R)}else if(e.type==="LineString")for(const ht of e.geometry)ct(ht,new gd(ht[0].x,ht[0].y,0,0,void 0),R);else if(e.type==="Point")for(const ht of e.geometry)for(const Nt of ht)ct([Nt],new gd(Nt.x,Nt.y,0,0,void 0),R)}const mg=255,yp=mg*mh;function fw(i,e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K,ee){const le=function(ae,he,ge,Be,ke,je,Ze,ut){const Rt=[];if(he.positionedLines.length===0)return Rt;const wt=Be.layout.get("text-rotate").evaluate(je,{})*Math.PI/180,Mt=function(ht){const Nt=ht[0],Vt=ht[1],yn=Nt*Vt;return yn>0?[Nt,-Vt]:yn<0?[-Nt,Vt]:Nt===0?[Vt,Nt]:[Vt,-Nt]}(ge);let Dt=Math.abs(he.top-he.bottom);for(const ht of he.positionedLines)Dt-=ht.lineOffset;const dt=he.positionedLines.length,Pt=Dt/dt;let ct=he.top-ge[1];for(let ht=0;ht<dt;++ht){const Nt=he.positionedLines[ht];ct=OP(he,Pt,ct,ht);for(const Vt of Nt.positionedGlyphs){if(!Vt.rect)continue;const yn=Vt.rect||{};let cn=kP+1,Jt=!0,Ft=1,Bn=0;if(Vt.image){const on=Ze.get(Vt.image.toString());if(!on)continue;if(on.sdf){Un("SDF images are not supported in formatted text and will be ignored.");continue}Jt=!1,Ft=on.pixelRatio,cn=df/Ft}const ln=(ke||ut)&&Vt.vertical,un=Vt.metrics.advance*Vt.scale/2,Mn=Vt.metrics,Xn=Vt.rect;if(Xn===null)continue;ut&&he.verticalizable&&(Bn=Vt.image?un-Vt.metrics.width*Vt.scale/2:0);const Gn=ke?[Vt.x+un,Vt.y]:[0,0];let ai=[0,0],Qn=[0,0],li=!1;ke||(ln?(Qn=[Vt.x+un+Mt[0],Vt.y+Mt[1]-Bn],li=!0):ai=[Vt.x+un+ge[0],Vt.y+ge[1]-Bn]);const Vi=Xn.w*Vt.scale/(Ft*(Vt.localGlyph?xu:1)),mr=Xn.h*Vt.scale/(Ft*(Vt.localGlyph?xu:1));let fe,we,gt,$t;if(ln){const on=Vt.y-ct,kn=new Wt(-un,un-on),mi=-Math.PI/2,gi=new Wt(...Qn);fe=new Wt(-un+ai[0],ai[1]),fe._rotateAround(mi,kn)._add(gi),fe.x+=-on+un,fe.y-=(Mn.left-cn)*Vt.scale;const Jn=Vt.image?Mn.advance*Vt.scale:to*Vt.scale,$i=String.fromCodePoint(Vt.glyph);SP($i)?fe.x+=(1-cn)*Vt.scale:CP($i)?fe.x+=Jn-Mn.height*Vt.scale+(-cn-1)*Vt.scale:fe.x+=Vt.image||Mn.width+2*cn===Xn.w&&Mn.height+2*cn===Xn.h?(Jn-mr)/2:(Jn-(Mn.height+2*cn)*Vt.scale)/2,we=new Wt(fe.x,fe.y-Vi),gt=new Wt(fe.x+mr,fe.y),$t=new Wt(fe.x+mr,fe.y-Vi)}else{const on=(Mn.left-cn)*Vt.scale-un+ai[0],kn=(-Mn.top-cn)*Vt.scale+ai[1],mi=on+Vi,gi=kn+mr;fe=new Wt(on,kn),we=new Wt(mi,kn),gt=new Wt(on,gi),$t=new Wt(mi,gi)}if(wt){let on;on=ke?new Wt(0,0):li?new Wt(Mt[0],Mt[1]):new Wt(ge[0],ge[1]),fe._rotateAround(wt,on),we._rotateAround(wt,on),gt._rotateAround(wt,on),$t._rotateAround(wt,on)}const en=new Wt(0,0),Qt=new Wt(0,0);Rt.push({tl:fe,tr:we,bl:gt,br:$t,texPrimary:yn,texSecondary:void 0,writingMode:he.writingMode,glyphOffset:Gn,sectionIndex:Vt.sectionIndex,isSDF:Jt,pixelOffsetTL:en,pixelOffsetBR:Qt,minFontScaleX:0,minFontScaleY:0})}}return Rt}(0,o,T,d,p,x,c,i.allowVerticalPlacement),ce=i.textSizeData;let W=null;ce.kind==="source"?(W=[mh*d.layout.get("text-size").evaluate(x,{},K)*j.textScaleFactor],W[0]>yp&&Un(`${i.layerIds[0]}: Value for "text-size" is >= ${mg}. Reduce your "text-size".`)):ce.kind==="composite"&&(W=[mh*j.compositeTextSizes[0].evaluate(x,{},K)*j.textScaleFactor,mh*j.compositeTextSizes[1].evaluate(x,{},K)*j.textScaleFactor],(W[0]>yp||W[1]>yp)&&Un(`${i.layerIds[0]}: Value for "text-size" is >= ${mg}. Reduce your "text-size".`)),i.addSymbols(i.text,le,W,T,p,x,P,e,n,S.lineStartIndex,S.lineLength,B,$,K,ee,!1);for(const ae of k)R[ae]=i.text.placedSymbolArray.length-1;return 4*le.length}function Wv(i){for(const e in i)return i[e];return null}function B_(i,e,n,o,c,d,p,x,T,S){let P=p.top,k=p.bottom,R=p.left,B=p.right;if($1(p)&&p.collisionPadding){const j=p.collisionPadding;R-=j[0],P-=j[1],B+=j[2],k+=j[3]}if(T){const j=new Wt(R,P),$=new Wt(B,P),K=new Wt(R,k),ee=new Wt(B,k),le=Ei(T);let ce=new Wt(0,0);S&&(ce=new Wt(S[0],S[1])),j._rotateAround(le,ce),$._rotateAround(le,ce),K._rotateAround(le,ce),ee._rotateAround(le,ce),R=Math.min(j.x,$.x,K.x,ee.x),B=Math.max(j.x,$.x,K.x,ee.x),P=Math.min(j.y,$.y,K.y,ee.y),k=Math.max(j.y,$.y,K.y,ee.y)}return i.emplaceBack(e.x,e.y,e.z,n.x,n.y,R,P,B,k,x,o,c,d),i.length-1}function Zv(i){$1(i)&&i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const e=i.bottom-i.top;return e>0?Math.max(10,e):null}function $P(i,e,n,o){const c=i.compareText;if(e in c){const d=c[e];for(let p=d.length-1;p>=0;p--)if(o.dist(d[p])<n)return!0}else c[e]=[];return c[e].push(o),!1}function mw(i,e){const n=i.fovAboveCenter,o=i.elevation?i.elevation.getMinElevationBelowMSL()*e:0,c=(i._camera.position[2]*i.worldSize-o)/Math.cos(i._pitch),d=Math.sin(n)*c/Math.sin(Math.max(Math.PI/2-i._pitch-n,.01));let p=Math.sin(i._pitch)*d+c;const x=c*(1/i._horizonShift);if(!i.elevation||i.elevation.exaggeration()===0){let T=Math.max(i.zoom-17,0);i.isOrthographic&&(T/=10),p*=1+T}return Math.min(1.01*p,x)}function gg(i,e){if(!e.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:e};const n=Math.pow(2,-i.z),o=i.x*n,c=(i.x+1)*n,d=i.y*n,p=(i.y+1)*n,x=Me(o),T=Me(c),S=We(d),P=We(p),k=e.project(x,S),R=e.project(T,S),B=e.project(T,P),j=e.project(x,P);let $=Math.min(k.x,R.x,B.x,j.x),K=Math.min(k.y,R.y,B.y,j.y),ee=Math.max(k.x,R.x,B.x,j.x),le=Math.max(k.y,R.y,B.y,j.y);const ce=n/16;function W(he,ge,Be,ke,je,Ze){const ut=(Be+je)/2,Rt=(ke+Ze)/2,wt=e.project(Me(ut),We(Rt)),Mt=Math.max(0,$-wt.x,K-wt.y,wt.x-ee,wt.y-le);$=Math.min($,wt.x),ee=Math.max(ee,wt.x),K=Math.min(K,wt.y),le=Math.max(le,wt.y),Mt>ce&&(W(he,wt,Be,ke,ut,Rt),W(wt,ge,ut,Rt,je,Ze))}W(k,R,o,d,c,d),W(R,B,c,d,c,p),W(B,j,c,p,o,p),W(j,k,o,p,o,d),$-=ce,K-=ce,ee+=ce,le+=ce;const ae=1/Math.max(ee-$,le-K);return{scale:ae,x:$*ae,y:K*ae,x2:ee*ae,y2:le*ae,projection:e}}function gw(i,{x:e,y:n},o=0){return new Wt(((e-o)*i.scale-i.x)*Kt,(n*i.scale-i.y)*Kt)}const GP=ne(new Float32Array(16));class vp{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new re(0,0)}projectTilePoint(e,n,o){return{x:e,y:n,z:0}}locationPoint(e,n,o,c=!0){return e._coordinatePoint(e.locationCoordinate(n,o),c)}pixelsPerMeter(e,n){return Pe(1,e)*n}pixelSpaceConversion(e,n,o){return 1}farthestPixelDistance(e){return mw(e,e.pixelsPerMeter)}pointCoordinate(e,n,o,c){const d=e.horizonLineFromTop(!1),p=new Wt(n,Math.max(d,o));return e.rayIntersectionCoordinate(e.pointRayIntersection(p,c))}pointCoordinate3D(e,n,o){const c=new Wt(n,o);if(e.elevation)return e.elevation.pointCoordinate(c);{const d=this.pointCoordinate(e,c.x,c.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(e,n){if(e.elevation&&e.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(e,n.x,n.y);const o=e.horizonLineFromTop();return n.y<o}createInversionMatrix(e,n){return GP}createTileMatrix(e,n,o){let c,d,p;const x=o.canonical,T=ne(new Float64Array(16));if(this.isReprojectedInTileSpace){const S=gg(x,this);c=1,d=S.x+o.wrap*S.scale,p=S.y,ye(T,T,[c/S.scale,c/S.scale,e.pixelsPerMeter/n])}else c=n/e.zoomScale(x.z),d=(x.x+Math.pow(2,x.z)*o.wrap)*c,p=x.y*c;return Re(T,T,[d,p,0]),ye(T,T,[c/Kt,c/Kt,1]),T}upVector(e,n,o){return[0,0,1]}upVectorScale(e,n,o){return{metersToTile:1}}}class WP extends vp{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,o]=this.parallels=e.parallels||[29.5,45.5],c=Math.sin(Ei(n));this.n=(c+Math.sin(Ei(o)))/2,this.c=1+c*(2*this.n-c),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:o,c,r0:d}=this,p=Ei(e-this.center[0]),x=Ei(n),T=Math.sqrt(c-2*o*Math.sin(x))/o;return{x:T*Math.sin(p*o),y:T*Math.cos(p*o)-d,z:0}}unproject(e,n){const{n:o,c,r0:d}=this,p=d+n;let x=Math.atan2(e,Math.abs(p))*Math.sign(p);p*o<0&&(x-=Math.PI*Math.sign(e)*Math.sign(p));const T=Ei(this.center[0])*o;x=Je(x,-Math.PI-T,Math.PI-T);const S=Ce(it(x/o)+this.center[0],-180,180),P=Math.asin(Ce((c-(e*e+p*p)*o*o)/(2*o),-1,1)),k=Ce(it(P),-85.051129,ft);return new re(S,k)}}const _g=1.340264,yg=-.081106,vg=893e-6,xg=.003796,F_=Math.sqrt(3)/2;class ZP extends vp{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const o=Math.asin(F_*Math.sin(n)),c=o*o,d=c*c*c;return{x:.5*(e*Math.cos(o)/(F_*(_g+3*yg*c+d*(7*vg+9*xg*c)))/Math.PI+.5),y:1-.5*(o*(_g+yg*c+d*(vg+xg*c))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let o=n=(2*(1-n)-1)*Math.PI,c=o*o,d=c*c*c;for(let P,k,R,B=0;B<12&&(k=o*(_g+yg*c+d*(vg+xg*c))-n,R=_g+3*yg*c+d*(7*vg+9*xg*c),P=k/R,o=Ce(o-P,-Math.PI/3,Math.PI/3),c=o*o,d=c*c*c,!(Math.abs(P)<1e-12));++B);const p=F_*e*(_g+3*yg*c+d*(7*vg+9*xg*c))/Math.cos(o),x=Math.asin(Math.sin(o)/F_),T=Ce(180*p/Math.PI,-180,180),S=Ce(180*x/Math.PI,-85.051129,ft);return new re(T,S)}}class KP extends vp{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const o=360*(e-.5),c=Ce(360*(.5-n),-85.051129,ft);return new re(o,c)}}const rm=Math.PI/2;function j_(i){return Math.tan((rm+i)/2)}class XP extends vp{constructor(e){super(e),this.center=e.center||[0,30];const[n,o]=this.parallels=e.parallels||[30,30];let c=Ei(n),d=Ei(o);this.southernCenter=c+d<0,this.southernCenter&&(c=-c,d=-d);const p=Math.cos(c),x=j_(c);this.n=c===d?Math.sin(c):Math.log(p/Math.cos(d))/Math.log(j_(d)/x),this.f=p*Math.pow(j_(c),this.n)/this.n}project(e,n){n=Ei(n),this.southernCenter&&(n=-n),e=Ei(e-this.center[0]);const o=1e-6,{n:c,f:d}=this;d>0?n<-rm+o&&(n=-rm+o):n>rm-o&&(n=rm-o);const p=d/Math.pow(j_(n),c);let x=p*Math.sin(c*e),T=d-p*Math.cos(c*e);return x=.5*(x/Math.PI+.5),T=.5*(T/Math.PI+.5),{x,y:this.southernCenter?T:1-T,z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;const{n:o,f:c}=this,d=c-n,p=Math.sign(d),x=Math.sign(o)*Math.sqrt(e*e+d*d);let T=Math.atan2(e,Math.abs(d))*p;d*o<0&&(T-=Math.PI*Math.sign(e)*p);const S=Ce(it(T/o)+this.center[0],-180,180),P=Ce(it(2*Math.atan(Math.pow(c/x,1/o))-rm),-85.051129,ft);return new re(S,this.southernCenter?-P:P)}}class _w extends vp{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:Te(e),y:ve(n),z:0}}unproject(e,n){const o=Me(e),c=We(n);return new re(o,c)}}const yw=Ei(ft);class YP extends vp{project(e,n){const o=(n=Ei(n))*n,c=o*o;return{x:.5*((e=Ei(e))*(.8707-.131979*o+c*(c*(.003971*o-.001529*c)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+o*(.015085+c*(.028874*o-.044475-.005916*c)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let o=n=(2*(1-n)-1)*Math.PI,c=25,d=0,p=o*o;do{p=o*o;const S=p*p;d=(o*(1.007226+p*(.015085+S*(.028874*p-.044475-.005916*S)))-n)/(1.007226+p*(.045255+S*(.259866*p-.311325-.005916*11*S))),o=Ce(o-d,-yw,yw)}while(Math.abs(d)>1e-6&&--c>0);p=o*o;const x=Ce(it(e/(.8707+p*(p*(p*p*p*(.003971-.001529*p)-.013791)-.131979))),-180,180),T=it(o);return new re(x,T)}}const vw=Ei(ft);class QP extends vp{project(e,n){n=Ei(n),e=Ei(e);const o=Math.cos(n),c=2/Math.PI,d=Math.acos(o*Math.cos(e/2)),p=Math.sin(d)/d,x=.5*(e*c+2*o*Math.sin(e/2)/p)||0,T=.5*(n+Math.sin(n)/p)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(e,n){let o=e=(2*e-.5)*Math.PI,c=n=(2*(1-n)-1)*Math.PI,d=25;const p=1e-6;let x=0,T=0;do{const S=Math.cos(c),P=Math.sin(c),k=2*P*S,R=P*P,B=S*S,j=Math.cos(o/2),$=Math.sin(o/2),K=2*j*$,ee=$*$,le=1-B*j*j,ce=le?1/le:0,W=le?Math.acos(S*j)*Math.sqrt(1/le):0,ae=.5*(2*W*S*$+2*o/Math.PI)-e,he=.5*(W*P+c)-n,ge=.5*ce*(B*ee+W*S*j*R)+1/Math.PI,Be=ce*(K*k/4-W*P*$),ke=.125*ce*(k*$-W*P*B*K),je=.5*ce*(R*j+W*ee*S)+.5,Ze=Be*ke-je*ge;x=(he*Be-ae*je)/Ze,T=(ae*ke-he*ge)/Ze,o=Ce(o-x,-Math.PI,Math.PI),c=Ce(c-T,-vw,vw)}while((Math.abs(x)>p||Math.abs(T)>p)&&--d>0);return new re(it(o),it(c))}}class xw extends vp{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ei(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:o,cosPhi:c}=this;return{x:Ei(e)*c*o+.5,y:-Math.sin(Ei(n))/c*o+.5,z:0}}unproject(e,n){const{scale:o,cosPhi:c}=this,d=-(n-.5)/o,p=Ce(it((e-.5)/o)/c,-180,180),x=Math.asin(Ce(d*c,-1,1)),T=Ce(it(x),-85.051129,ft);return new re(p,T)}}class JP extends _w{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,n,o){const c=Kn(e,n,o);return bn(c,c,It(ot(o))),{x:c[0],y:c[1],z:c[2]}}locationPoint(e,n,o){const c=G(n.lat,n.lng),d=xn([],c),p=o?e._centerAltitude+o:e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude;lt(c,c,d,Pe(1,0)*Kt*p);const x=ne(new Float64Array(16));return me(x,e.pixelMatrix,e.globeMatrix),bn(c,c,x),new Wt(c[0],c[1])}pixelsPerMeter(e,n){return Pe(1,0)*n}pixelSpaceConversion(e,n,o){const c=Pe(1,e)*n,d=Cn(Pe(1,45)*n,c,o);return this.pixelsPerMeter(e,n)/d}createTileMatrix(e,n,o){const c=vt(ot(o.canonical));return me(new Float64Array(16),e.globeMatrix,c)}createInversionMatrix(e,n){const{center:o}=e,c=It(ot(n));return De(c,c,Ei(o.lng)),Le(c,c,Ei(o.lat)),ye(c,c,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(c)}pointCoordinate(e,n,o,c){return Q(e,n,o,!0)||new Ve(0,0)}pointCoordinate3D(e,n,o){const c=this.pointCoordinate(e,n,o,0);return[c.x,c.y,c.z]}isPointAboveHorizon(e,n){return!Q(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(c,d){const p=c.cameraToCenterDistance,x=c._centerAltitude*d,T=c._camera,S=c._camera.forward(),P=At([],qt([],S,-p),[0,0,x]),k=c.worldSize/(2*Math.PI),R=[0,0,-k],B=c.width/c.height,j=Math.tan(c.fovAboveCenter),$=qt([],T.up(),j),K=qt([],T.right(),j*B),ee=xn([],At([],At([],S,$),K)),le=[];let ce;if(new cr(P,ee).closestPointOnSphere(R,k,le)){const W=At([],le,R),ae=Vn([],W,P);ce=Math.cos(c.fovAboveCenter)*St(ae)}else{const W=Vn([],P,R),ae=Vn([],R,P);xn(ae,ae);const he=St(W)-k;ce=Math.sqrt(he*(he+2*k));const ge=Math.acos(ce/(k+he))-Math.acos(An(S,ae));ce*=Math.cos(ge)}return 1.01*ce}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),o=pi(e.zoom);if(o>0){const c=mw(e,Pe(1,e.center.lat)*e.worldSize),d=e.worldSize/(2*Math.PI),p=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Cn(n,c+d*(1-Math.cos(p)),Math.pow(o,10))}return n}upVector(e,n,o){return Kn(n,o,e,1)}upVectorScale(e){return{metersToTile:D(ei(ot(e)))}}}function bw(i){const e=i.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(i.name){case"mercator":return new _w(i);case"equirectangular":return new KP(i);case"naturalEarth":return new YP(i);case"equalEarth":return new ZP(i);case"winkelTripel":return new QP(i);case"albers":return n?new xw(i):new WP(i);case"lambertConformalConic":return n?new xw(i):new XP(i);case"globe":return new JP(i)}throw new Error(`Invalid projection name: ${i.name}`)}const ek=Zn.VectorTileFeature.types,tk=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function N_(i,e,n,o,c,d,p,x,T,S,P,k,R){const B=x?Math.min(yp,Math.round(x[0])):0,j=x?Math.min(yp,Math.round(x[1])):0;i.emplaceBack(e,n,Math.round(32*o),Math.round(32*c),d,p,(B<<1)+(T?1:0),j,16*S,16*P,256*k,256*R)}function V_(i,e,n){i.emplaceBack(e,n)}function q_(i,e,n,o,c,d,p){i.emplaceBack(e,n,o,c,d,p)}const H_=(i,e,n,o)=>{for(let c=0;c<e;c++)i.emplaceBack(n[0],n[1],n[2],o[0],o[1],o[2])};function U_(i,e,n,o,c){i.emplaceBack(e,n,o,c),i.emplaceBack(e,n,o,c),i.emplaceBack(e,n,o,c),i.emplaceBack(e,n,o,c)}function nk(i){for(const e of i.sections)if(Jh(e.text))return!0;return!1}class Kv{constructor(e){this.layoutVertexArray=new oh,this.indexArray=new ws,this.programConfigurations=e,this.segments=new Qi,this.dynamicLayoutVertexArray=new bs,this.opacityVertexArray=new zl,this.placedSymbolArray=new cp,this.iconTransitioningVertexArray=new Ll,this.globeExtVertexArray=new _o,this.zOffsetVertexArray=new Rl,this.orientationVertexArray=new op}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,n,o,c,d){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fP.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,gP.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,tk,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,vP.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,mP.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,_P.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=e.createVertexBuffer(this.orientationVertexArray,yP.members,!0)),this.opacityVertexBuffer.itemSize=1),(o||c)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}nn(Kv,"SymbolBuffers");class Xv{constructor(e,n,o){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new o,this.segments=new Qi,this.collisionVertexArray=new cl,this.collisionVertexArrayExt=new bs}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,xP.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,bP.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}nn(Xv,"CollisionBuffers");class $_{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.lut=e.lut,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ne([]),this.placementViewportMatrix=ne([]);const n=this.layers[0]._unevaluatedLayout._values;this.worldview=e.worldview,this.textSizeData=X1(this.zoom,n["text-size"],this.worldview),this.iconSizeData=X1(this.zoom,n["icon-size"],this.worldview);const o=this.layers[0].layout,c=o.get("symbol-sort-key"),d=o.get("symbol-z-order");this.canOverlap=o.get("text-allow-overlap")||o.get("icon-allow-overlap")||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&c.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=o.get("text-writing-mode").map(p=>Fa[p]),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Kv(new u(this.layers,{zoom:this.zoom,lut:this.lut},e=>e.startsWith("text")||e.startsWith("symbol"))),this.icon=new Kv(new u(this.layers,{zoom:this.zoom,lut:this.lut},e=>e.startsWith("icon")||e.startsWith("symbol"))),this.glyphOffsetArray=new ld,this.lineVertexArray=new up,this.symbolInstances=new Xp}calculateGlyphDependencies(e,n,o,c,d){for(const p of e){const x=p.codePointAt(0);if(x===void 0)break;if(n[x]=!0,c&&d&&x<=65535){const T=hg[p];T&&(n[T.charCodeAt(0)]=!0)}}}updateFootprints(e,n){}updateReplacement(e,n){if(n.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=n.updateTime;const o=n.getReplacementRegionsForTile(e.toUnwrapped(),!0);return!Sv(this.activeReplacements,o)&&(this.activeReplacements=o,!0)}populate(e,n,o,c){const d=this.layers[0],p=d.layout,x=this.projection.name==="globe",T=p.get("text-font"),S=p.get("text-field"),P=p.get("icon-image"),[k,R]=p.get("icon-size-scale-range"),B=Ce(n.scaleFactor||1,k,R),j=(S.value.kind!=="constant"||S.value.value instanceof mo&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),$=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,K=p.get("symbol-sort-key");if(this.features=[],!j&&!$)return;const ee=n.iconDependencies,le=n.glyphDependencies,ce=n.availableImages,W=new ji(this.zoom,{worldview:this.worldview});for(const{feature:ae,id:he,index:ge,sourceLayerIndex:Be}of e){const ke=d._featureFilter.needGeometry,je=Xt(ae,ke);if(!d._featureFilter.filter(W,je,o))continue;if(ke||(je.geometry=tn(ae,o,c)),x&&ae.type!==1&&o.z<=5){const Mt=je.geometry,Dt=.98078528056,dt=(Pt,ct)=>An(Kn(Pt.x,Pt.y,o,1),Kn(ct.x,ct.y,o,1))<Dt;for(let Pt=0;Pt<Mt.length;Pt++)Mt[Pt]=jt(Mt[Pt],dt)}let Ze,ut;if(j){const Mt=d.getValueAndResolveTokens("text-field",je,o,ce),Dt=mo.factory(Mt);nk(Dt)&&(this.hasRTLText=!0),(!this.hasRTLText||kl()==="unavailable"||this.hasRTLText&&Ra.isParsed())&&(Ze=TP(Dt,d,je))}if($){const Mt=d.getValueAndResolveTokens("icon-image",je,o,ce);ut=typeof Mt=="string"?Po.build(Mt):Mt}if(!Ze&&!ut)continue;const Rt=this.sortFeaturesByKey?K.evaluate(je,{},o):void 0,wt={id:he,text:Ze,icon:ut,index:ge,sourceLayerIndex:Be,geometry:je.geometry,properties:ae.properties,type:ek[ae.type],sortKey:Rt};if(this.features.push(wt),ut){const Mt=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Dt,iconSecondary:dt}=hw(ut,this.iconSizeData,Mt["icon-size"],o,this.zoom,wt,this.pixelRatio,B,this.worldview),Pt=Dt.id.toString();if(ee.has(Pt)?ee.get(Pt).push(Dt):ee.set(Pt,[Dt]),dt){const ct=dt.id.toString();ee.has(ct)?ee.get(ct).push(dt):ee.set(ct,[dt])}}if(Ze){const Mt=T.evaluate(je,{},o).join(","),Dt=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Fa.vertical)>=0;for(const dt of Ze.sections)if(dt.image){const Pt=dt.image.getPrimary().scaleSelf(this.pixelRatio),ct=Pt.id.toString(),ht=ee.get(ct)||[];ht.push(Pt),ee.set(ct,ht)}else{const Pt=la(Ze.toString()),ct=dt.fontStack||Mt,ht=le[ct]=le[ct]||{};this.calculateGlyphDependencies(dt.text,ht,Dt,this.allowVerticalPlacement,Pt)}}}if(p.get("symbol-placement")==="line"&&(this.features=function(ae){const he={},ge={},Be=[];let ke=0;function je(wt){Be.push(ae[wt]),ke++}function Ze(wt,Mt,Dt){const dt=ge[wt];return delete ge[wt],ge[Mt]=dt,Be[dt].geometry[0].pop(),Be[dt].geometry[0]=Be[dt].geometry[0].concat(Dt[0]),dt}function ut(wt,Mt,Dt){const dt=he[Mt];return delete he[Mt],he[wt]=dt,Be[dt].geometry[0].shift(),Be[dt].geometry[0]=Dt[0].concat(Be[dt].geometry[0]),dt}function Rt(wt,Mt,Dt){const dt=Dt?Mt[0][Mt[0].length-1]:Mt[0][0];return`${wt}:${dt.x}:${dt.y}`}for(let wt=0;wt<ae.length;wt++){const Mt=ae[wt],Dt=Mt.geometry,dt=Mt.text?Mt.text.toString():null;if(!dt){je(wt);continue}const Pt=Rt(dt,Dt),ct=Rt(dt,Dt,!0);if(Pt in ge&&ct in he&&ge[Pt]!==he[ct]){const ht=ut(Pt,ct,Dt),Nt=Ze(Pt,ct,Be[ht].geometry);delete he[Pt],delete ge[ct],ge[Rt(dt,Be[Nt].geometry,!0)]=Nt,Be[ht].geometry=null}else Pt in ge?Ze(Pt,ct,Dt):ct in he?ut(Pt,ct,Dt):(je(wt),he[Pt]=ke-1,ge[ct]=ke-1)}return Be.filter(wt=>wt.geometry)}(this.features)),p.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",n.elevationFeatures){!this.elevationFeatures&&n.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const ae of n.elevationFeatures)this.elevationFeatureIdToIndex.set(ae.id,this.elevationFeatures.length),this.elevationFeatures.push(ae)}}else p.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((ae,he)=>ae.sortKey-he.sortKey)}update(e,n,o,c,d,p,x){this.text.programConfigurations.updatePaintArrays(e,n,d,o,c,p,x,this.worldview),this.icon.programConfigurations.updatePaintArrays(e,n,d,o,c,p,x,this.worldview)}updateRoadElevation(e){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let n=!1;const o=st(e),c=1/o;let d=!1,p=!1;for(let x=0;x<this.symbolInstances.length;x++){const T=this.symbolInstances.get(x),S=xt(1,0,0),P=xt(0,1,0),{numHorizontalGlyphVertices:k,numVerticalGlyphVertices:R,numIconVertices:B,numVerticalIconVertices:j}=T,$=k>0||R>0,K=B>0,ee=this.elevationFeatures[T.elevationFeatureIndex];if(ee){const le=new Wt(T.tileAnchorX,T.tileAnchorY),ce=.075+ee.pointElevation(le);T.zOffset!==ce&&(n=!0,T.zOffset=ce);const W=ee.computeSlopeNormal(le,c),ae=Cs(Or(),xt(0,0,1),W);Ci(S,S,ae),Ci(P,P,ae),S[2]*=o,P[2]*=o,S[0]===1&&S[1]===0&&S[2]===0&&P[0]===0&&P[1]===1&&P[2]===0||(d=d||$,p=p||K)}if($&&(H_(this.text.orientationVertexArray,k,S,P),H_(this.text.orientationVertexArray,R,S,P)),K){const{placedIconSymbolIndex:le,verticalPlacedIconSymbolIndex:ce}=T;le>=0&&H_(this.icon.orientationVertexArray,B,S,P),ce>=0&&H_(this.icon.orientationVertexArray,j,S,P)}}d||(this.text.orientationVertexArray=void 0),p||(this.icon.orientationVertexArray=void 0),n&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const e=(d,p,x)=>{o+=p,o>d.length&&d.resize(o);for(let T=-p;T<0;T++)d.emplace(T+o,x)},n=(d,p,x)=>{c+=p,c>d.length&&d.resize(c);for(let T=-p;T<0;T++)d.emplace(T+c,x)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let o=0,c=0;for(let d=0;d<this.symbolInstances.length;d++){const p=this.symbolInstances.get(d),{numHorizontalGlyphVertices:x,numVerticalGlyphVertices:T,numIconVertices:S}=p,P=p.zOffset,k=S>0;if((x>0||T>0)&&(e(this.text.zOffsetVertexArray,x,P),e(this.text.zOffsetVertexArray,T,P)),k){const{placedIconSymbolIndex:R,verticalPlacedIconSymbolIndex:B}=p;R>=0&&n(this.icon.zOffsetVertexArray,S,P),B>=0&&n(this.icon.zOffsetVertexArray,p.numVerticalIconVertices,P)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=bw(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const o=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:c,y:d}of n)this.lineVertexArray.emplaceBack(c,d);return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,n,o,c,d,p,x,T,S,P,k,R,B,j,$,K){const ee=e.indexArray,le=e.layoutVertexArray,ce=e.globeExtVertexArray,W=e.segments.prepareSegment(4*n.length,le,ee,this.canOverlap?p.sortKey:void 0),ae=this.glyphOffsetArray.length,he=W.vertexLength,ge=this.allowVerticalPlacement&&x===Fa.vertical?Math.PI/2:0,Be=p.text&&p.text.sections;for(let je=0;je<n.length;je++){const{tl:Ze,tr:ut,bl:Rt,br:wt,texPrimary:Mt,texSecondary:Dt,pixelOffsetTL:dt,pixelOffsetBR:Pt,minFontScaleX:ct,minFontScaleY:ht,glyphOffset:Nt,isSDF:Vt,sectionIndex:yn}=n[je],cn=W.vertexLength,Jt=Nt[1];if(N_(le,S.x,S.y,Ze.x,Jt+Ze.y,Mt.x,Mt.y,o,Vt,dt.x,dt.y,ct,ht),N_(le,S.x,S.y,ut.x,Jt+ut.y,Mt.x+Mt.w,Mt.y,o,Vt,Pt.x,dt.y,ct,ht),N_(le,S.x,S.y,Rt.x,Jt+Rt.y,Mt.x,Mt.y+Mt.h,o,Vt,dt.x,Pt.y,ct,ht),N_(le,S.x,S.y,wt.x,Jt+wt.y,Mt.x+Mt.w,Mt.y+Mt.h,o,Vt,Pt.x,Pt.y,ct,ht),T){const{x:Ft,y:Bn,z:ln}=T.anchor,[un,Mn,Xn]=T.up;q_(ce,Ft,Bn,ln,un,Mn,Xn),q_(ce,Ft,Bn,ln,un,Mn,Xn),q_(ce,Ft,Bn,ln,un,Mn,Xn),q_(ce,Ft,Bn,ln,un,Mn,Xn),U_(e.dynamicLayoutVertexArray,Ft,Bn,ln,ge)}else U_(e.dynamicLayoutVertexArray,S.x,S.y,S.z,ge);if(K){const Ft=Dt||Mt;V_(e.iconTransitioningVertexArray,Ft.x,Ft.y),V_(e.iconTransitioningVertexArray,Ft.x+Ft.w,Ft.y),V_(e.iconTransitioningVertexArray,Ft.x,Ft.y+Ft.h),V_(e.iconTransitioningVertexArray,Ft.x+Ft.w,Ft.y+Ft.h)}ee.emplaceBack(cn,cn+1,cn+2),ee.emplaceBack(cn+1,cn+2,cn+3),W.vertexLength+=4,W.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Nt[0]),je!==n.length-1&&yn===n[je+1].sectionIndex||e.programConfigurations.populatePaintArrays(le.length,p,p.index,{},B,j,$,Be&&Be[yn],this.worldview)}const ke=T?T.anchor:S;e.placedSymbolArray.emplaceBack(ke.x,ke.y,ke.z,S.x,S.y,ae,this.glyphOffsetArray.length-ae,he,P,k,S.segment,o?o[0]:0,o?o[1]:0,c[0],c[1],x,0,0,0,R,0)}_commitLayoutVertex(e,n,o,c,d,p,x){e.emplaceBack(n,o,c,d,p,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(e,n,o,c,d,p,x){const T=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),S=T.vertexLength,P=x.tileAnchorX,k=x.tileAnchorY;for(let B=0;B<4;B++)o.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(o.collisionVertexArrayExt,n,e.padding,x.zOffset),this._commitLayoutVertex(o.layoutVertexArray,c,d,p,P,k,new Wt(e.x1,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,c,d,p,P,k,new Wt(e.x2,e.y1)),this._commitLayoutVertex(o.layoutVertexArray,c,d,p,P,k,new Wt(e.x2,e.y2)),this._commitLayoutVertex(o.layoutVertexArray,c,d,p,P,k,new Wt(e.x1,e.y2)),T.vertexLength+=4;const R=o.indexArray;R.emplaceBack(S,S+1),R.emplaceBack(S+1,S+2),R.emplaceBack(S+2,S+3),R.emplaceBack(S+3,S),T.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,o,c,d,p){for(let x=c;x<d;x++){const T=o.get(x),S=this.getSymbolInstanceTextSize(e,p,n,x);this._addCollisionDebugVertices(T,S,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,p)}}_addIconDebugCollisionBoxes(e,n,o,c,d,p){for(let x=c;x<d;x++){const T=o.get(x),S=this.getSymbolInstanceIconSize(e,n,p.placedIconSymbolIndex);this._addCollisionDebugVertices(T,S,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,p)}}generateCollisionDebugBuffers(e,n,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xv(rd,O1.members,Ll),this.iconCollisionBox=new Xv(rd,O1.members,Ll);const c=pg(this.iconSizeData,e),d=pg(this.textSizeData,e,o);for(let p=0;p<this.symbolInstances.length;p++){const x=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(d,e,n,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(d,e,n,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(c,e,n,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(c,e,n,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(e,n,o,c){const d=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:c),p=qv(this.textSizeData,e,d)/to;return this.tilePixelRatio*p}getSymbolInstanceIconSize(e,n,o){const c=this.icon.placedSymbolArray.get(o),d=qv(this.iconSizeData,e,c);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(e,n,o,c){e.emplaceBack(n,-o,-o,c),e.emplaceBack(n,o,-o,c),e.emplaceBack(n,o,o,c),e.emplaceBack(n,-o,o,c)}_updateTextDebugCollisionBoxes(e,n,o,c,d,p,x){for(let T=c;T<d;T++){const S=o.get(T),P=this.getSymbolInstanceTextSize(e,p,n,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,P,S.padding,p.zOffset)}}_updateIconDebugCollisionBoxes(e,n,o,c,d,p,x){for(let T=c;T<d;T++){const S=o.get(T),P=this.getSymbolInstanceIconSize(e,n,p.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,P,S.padding,p.zOffset)}}updateCollisionDebugBuffers(e,n,o,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=pg(this.iconSizeData,e,c),p=pg(this.textSizeData,e,o);for(let x=0;x<this.symbolInstances.length;x++){const T=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(p,e,n,T.textBoxStartIndex,T.textBoxEndIndex,T,o),this._updateTextDebugCollisionBoxes(p,e,n,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T,o),this._updateIconDebugCollisionBoxes(d,e,n,T.iconBoxStartIndex,T.iconBoxEndIndex,T,c),this._updateIconDebugCollisionBoxes(d,e,n,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T,c)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,o,c,d,p,x,T,S){const P={};if(n<o){const{x1:k,y1:R,x2:B,y2:j,padding:$,projectedAnchorX:K,projectedAnchorY:ee,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:W,featureIndex:ae}=e.get(n);P.textBox={x1:k,y1:R,x2:B,y2:j,padding:$,projectedAnchorX:K,projectedAnchorY:ee,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:W},P.textFeatureIndex=ae}if(c<d){const{x1:k,y1:R,x2:B,y2:j,padding:$,projectedAnchorX:K,projectedAnchorY:ee,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:W,featureIndex:ae}=e.get(c);P.verticalTextBox={x1:k,y1:R,x2:B,y2:j,padding:$,projectedAnchorX:K,projectedAnchorY:ee,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:W},P.verticalTextFeatureIndex=ae}if(p<x){const{x1:k,y1:R,x2:B,y2:j,padding:$,projectedAnchorX:K,projectedAnchorY:ee,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:W,featureIndex:ae}=e.get(p);P.iconBox={x1:k,y1:R,x2:B,y2:j,padding:$,projectedAnchorX:K,projectedAnchorY:ee,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:W},P.iconFeatureIndex=ae}if(T<S){const{x1:k,y1:R,x2:B,y2:j,padding:$,projectedAnchorX:K,projectedAnchorY:ee,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:W,featureIndex:ae}=e.get(T);P.verticalIconBox={x1:k,y1:R,x2:B,y2:j,padding:$,projectedAnchorX:K,projectedAnchorY:ee,projectedAnchorZ:le,tileAnchorX:ce,tileAnchorY:W},P.verticalIconFeatureIndex=ae}return P}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,n){const o=e.placedSymbolArray.get(n),c=o.vertexStartIndex+4*o.numGlyphs;for(let d=o.vertexStartIndex;d<c;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),o=Math.cos(e),c=[],d=[],p=[];for(let x=0;x<this.symbolInstances.length;++x){p.push(x);const T=this.symbolInstances.get(x);c.push(0|Math.round(n*T.tileAnchorX+o*T.tileAnchorY)),d.push(T.featureIndex)}return p.sort((x,T)=>c[x]-c[T]||d[T]-d[x]),p}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((e,n)=>this.symbolInstances.get(n).zOffset-this.symbolInstances.get(e).zOffset)}addToSortKeyRanges(e,n){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===n?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const o=this.symbolInstances.get(n);this.featureSortOrder.push(o.featureIndex);const{rightJustifiedTextSymbolIndex:c,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:p,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:S}=o;c>=0&&this.addIndicesForPlacedSymbol(this.text,c),d>=0&&d!==c&&this.addIndicesForPlacedSymbol(this.text,d),p>=0&&p!==d&&p!==c&&this.addIndicesForPlacedSymbol(this.text,p),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ww,Tw,Yv;nn($_,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),$_.addDynamicAttributes=U_;class Sw{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Ru,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}nn(Sw,"FormatSectionOverride",{omit:["defaultValue"]});const Qv=()=>Yv||(Yv={layout:ww||(ww=new Er({"symbol-placement":new Ot(Xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Ot(Xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ot(Xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Zt(Xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ot(Xe.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Ot(Xe.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Ot(Xe.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Ot(Xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ot(Xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ot(Xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ot(Xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Zt(Xe.layout_symbol["icon-size"]),"icon-size-scale-range":new Ot(Xe.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Zt(Xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Zt(Xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Zt(Xe.layout_symbol["icon-image"]),"icon-rotate":new Zt(Xe.layout_symbol["icon-rotate"]),"icon-padding":new Ot(Xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Ot(Xe.layout_symbol["icon-keep-upright"]),"icon-offset":new Zt(Xe.layout_symbol["icon-offset"]),"icon-anchor":new Zt(Xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ot(Xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ot(Xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ot(Xe.layout_symbol["text-rotation-alignment"]),"text-field":new Zt(Xe.layout_symbol["text-field"]),"text-font":new Zt(Xe.layout_symbol["text-font"]),"text-size":new Zt(Xe.layout_symbol["text-size"]),"text-size-scale-range":new Ot(Xe.layout_symbol["text-size-scale-range"]),"text-max-width":new Zt(Xe.layout_symbol["text-max-width"]),"text-line-height":new Zt(Xe.layout_symbol["text-line-height"]),"text-letter-spacing":new Zt(Xe.layout_symbol["text-letter-spacing"]),"text-justify":new Zt(Xe.layout_symbol["text-justify"]),"text-radial-offset":new Zt(Xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ot(Xe.layout_symbol["text-variable-anchor"]),"text-anchor":new Zt(Xe.layout_symbol["text-anchor"]),"text-max-angle":new Ot(Xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Ot(Xe.layout_symbol["text-writing-mode"]),"text-rotate":new Zt(Xe.layout_symbol["text-rotate"]),"text-padding":new Ot(Xe.layout_symbol["text-padding"]),"text-keep-upright":new Ot(Xe.layout_symbol["text-keep-upright"]),"text-transform":new Zt(Xe.layout_symbol["text-transform"]),"text-offset":new Zt(Xe.layout_symbol["text-offset"]),"text-allow-overlap":new Ot(Xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ot(Xe.layout_symbol["text-ignore-placement"]),"text-optional":new Ot(Xe.layout_symbol["text-optional"]),visibility:new Ot(Xe.layout_symbol.visibility)})),paint:Tw||(Tw=new Er({"icon-opacity":new Zt(Xe.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Zt(Xe.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Zt(Xe.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Zt(Xe.paint_symbol["text-emissive-strength"]),"icon-color":new Zt(Xe.paint_symbol["icon-color"]),"icon-halo-color":new Zt(Xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Zt(Xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Zt(Xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Ot(Xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ot(Xe.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ot(Xe.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Zt(Xe.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Zt(Xe.paint_symbol["text-occlusion-opacity"]),"text-color":new Zt(Xe.paint_symbol["text-color"],{runtimeType:Ho,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Zt(Xe.paint_symbol["text-halo-color"]),"text-halo-width":new Zt(Xe.paint_symbol["text-halo-width"]),"text-halo-blur":new Zt(Xe.paint_symbol["text-halo-blur"]),"text-translate":new Ot(Xe.paint_symbol["text-translate"]),"text-translate-anchor":new Ot(Xe.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Ot(Xe.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Ot(Xe.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Ot(Xe.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Ot(Xe.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Zt(Xe.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},Yv);class G_ extends eo{constructor(e,n,o,c){super(e,Qv(),n,o,c),this._colorAdjustmentMatrix=ne([]),this.hasInitialOcclusionOpacityProperties=e.paint!==void 0&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const o=this.layout.get("text-writing-mode");if(o){const c=[];for(const d of o)c.indexOf(d)<0&&c.push(d);this.layout._values["text-writing-mode"]=c}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,n,o,c){return this._saturation===e&&this._contrast===n&&this._brightnessMin===o&&this._brightnessMax===c||(this._colorAdjustmentMatrix=function(d,p,x,T){d=so(d),p=ls(p);const S=se(),P=d/3,k=1-2*P,R=[k,P,P,0,P,k,P,0,P,P,k,0,0,0,0,1],B=.5-.5*p,j=T-x;return me(S,[j,0,0,0,0,j,0,0,0,0,j,0,x,x,x,1],[p,0,0,0,0,p,0,0,0,0,p,0,B,B,B,1]),me(S,S,R),S}(e,n,o,c),this._saturation=e,this._contrast=n,this._brightnessMin=o,this._brightnessMax=c),this._colorAdjustmentMatrix}getValueAndResolveTokens(e,n,o,c){const d=this.layout.get(e).evaluate(n,{},o,c),p=this._unevaluatedLayout._values[e];return p.isDataDriven()||Il(p.value)||!d?d:function(x,T){return T.replace(/{([^{}]+)}/g,(S,P)=>P in x?String(x[P]):"")}(n.properties,d)}createBucket(e){return new $_(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Qv().paint.overridableProperties){if(!G_.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),o=new Sw(n),c=new ru(o,n.property.specification,this.scope,this.options);let d=null;d=n.value.kind==="constant"||n.value.kind==="source"?new gc("source",c):new _c("composite",c,n.value.zoomStops,n.value.interpolationType),this.paint._values[e]=new sl(n.property,d,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,o){return!(!this.layout||n.isDataDriven()||o.isDataDriven())&&G_.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const o=e.get("text-field"),c=Qv().paint.properties[n];let d=!1;const p=x=>{for(const T of x)if(c.overrides&&c.overrides.hasOverride(T))return void(d=!0)};if(o.value.kind==="constant"&&o.value.value instanceof mo)p(o.value.value.sections);else if(o.value.kind==="source"){const x=S=>{d||(S instanceof In&&sn(S.value)===zu?p(S.value.sections):S instanceof Hc?p(S.sections):S.eachChild(x))},T=o.value;T._styleExpression&&x(T._styleExpression.expression)}return d}getProgramIds(){return["symbol"]}getDefaultProgramParams(e,n,o){return{config:new vo(this,{zoom:n,lut:o}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let Cw,Ew,Aw,Iw;var Jv=xi([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function ex(i){switch(i){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function tx(i){switch(i){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class nx{constructor(e,n,o,c){this.context=e,this.format=o,this.useMipmap=c&&c.useMipmap,this.texture=e.gl.createTexture(),this.update(n,{premultiply:c&&c.premultiply})}update(e,n){const o=e&&e instanceof HTMLVideoElement&&e.width===0?e.videoWidth:e.width,c=e&&e instanceof HTMLVideoElement&&e.height===0?e.videoHeight:e.height,{context:d}=this,{gl:p}=d,{x,y:T}=n&&n.position?n.position:{x:0,y:0},S=x+o,P=T+c;!this.size||this.size[0]===S&&this.size[1]===P||(p.bindTexture(p.TEXTURE_2D,null),p.deleteTexture(this.texture),this.texture=p.createTexture(),this.size=null),p.bindTexture(p.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===p.RGBA8&&(!n||n.premultiply!==!1));const k=e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap;if(!this.size&&S>0&&P>0){const R=this.useMipmap?Math.floor(Math.log2(Math.max(S,P)))+1:1;p.texStorage2D(p.TEXTURE_2D,R,this.format,S,P),this.size=[S,P]}if(this.size)if(k)p.texSubImage2D(p.TEXTURE_2D,0,x,T,ex(this.format),tx(this.format),e);else{const R=e.data;R&&p.texSubImage2D(p.TEXTURE_2D,0,x,T,o,c,ex(this.format),tx(this.format),R)}this.useMipmap&&p.generateMipmap(p.TEXTURE_2D)}bind(e,n,o=!1){const{context:c}=this,{gl:d}=c;d.bindTexture(d.TEXTURE_2D,this.texture),e!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,e),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap&&!o?e===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),n!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,n),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,n),this.wrapS=n)}bindExtraParam(e,n,o,c,d){const{context:p}=this,{gl:x}=p;x.bindTexture(x.TEXTURE_2D,this.texture),n!==this.magFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,n),this.magFilter=n),e!==this.minFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,this.useMipmap?e===x.NEAREST?x.NEAREST_MIPMAP_NEAREST:x.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),o!==this.wrapS&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,o),this.wrapS=o),c!==this.wrapT&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,c),this.wrapT=c),d!==this.compareMode&&(d?(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_COMPARE_MODE,x.COMPARE_REF_TO_TEXTURE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_COMPARE_FUNC,d)):x.texParameteri(x.TEXTURE_2D,x.TEXTURE_COMPARE_MODE,x.NONE),this.compareMode=d)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class W_{constructor(e,n){this.context=e,this.texture=n}bind(e,n){const{context:o}=this,{gl:c}=o;c.bindTexture(c.TEXTURE_2D,this.texture),e!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,e),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,e),this.minFilter=e),n!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,n),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,n),this.wrapS=n)}}function Z_(i,e,n,o,c,d,p,x){const T=[i,e,1,n,o,1,c,d,1],S=[p,x,1],P=ie([],T),[k,R,B]=Zi(S,S,P);return de(T,T,[k,0,0,0,R,0,0,0,B])}function Pw(i,e,n,o,c,d,p,x){const T=function(S,P,k,R,B,j,$,K){const ee=Z_(0,0,1,0,1,1,0,1),le=Z_(S,P,k,R,B,j,$,K);return de(le,le,ie([],ee))}(i,e,n,o,c,d,p,x);return[T[2]/T[8]/Kt,T[5]/T[8]/Kt]}function K_(i){return[i[0],Math.min(Math.max(i[1],-85.051129),ft)]}class kw extends sc{constructor(e,n,o,c){super(),this.id=e,this.dispatcher=o,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(c),this.options=n,this._dirty=!1}load(e,n){if(this._loaded=n||!1,this.fire(new rc("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=Bc(this.map._requestManager.transformRequest(this.url,ga.Image),(o,c)=>{this._imageRequest=null,this._loaded=!0,o?this.fire(new Aa(o)):c&&(this.image=c instanceof HTMLImageElement?fa.getImageData(c):c,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())})}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new W_(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new rc("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(e){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof W_||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let n=e[0][1],o=e[0][1];for(const d of e)d[1]>o&&(o=d[1]),d[1]<n&&(n=d[1]);const c=(o+n)/2;if(c>ft?this.onNorthPole=!0:c<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const d=e.map(Ve.fromLngLat);this.tileID=function(p){let x=1/0,T=1/0,S=-1/0,P=-1/0;for(const $ of p)x=Math.min(x,$.x),T=Math.min(T,$.y),S=Math.max(S,$.x),P=Math.max(P,$.y);const k=Math.max(S-x,P-T),R=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),B=Math.pow(2,R);let j=Math.floor((x+S)/2*B);return j>1&&(j-=1),new md(R,j,Math.floor((T+P)/2*B))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new rc("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const ee in this.tiles){const le=this.tiles[ee];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const n=gg(new md(0,0,0),this.map.transform.projection),o=[n.projection.project(this.coordinates[0][0],this.coordinates[0][1]),n.projection.project(this.coordinates[1][0],this.coordinates[1][1]),n.projection.project(this.coordinates[2][0],this.coordinates[2][1]),n.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ee){const le=ee[1].x-ee[0].x,ce=ee[1].y-ee[0].y,W=ee[2].x-ee[1].x,ae=ee[2].y-ee[1].y,he=ee[3].x-ee[2].x,ge=ee[3].y-ee[2].y,Be=ee[0].x-ee[3].x,ke=ee[0].y-ee[3].y,je=le*ae-W*ce,Ze=W*ge-he*ae,ut=he*ke-Be*ge,Rt=Be*ce-le*ke;return je>0&&Ze>0&&ut>0&&Rt>0||je<0&&Ze<0&&ut<0&&Rt<0}(o))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const c=gg(this.tileID,this.map.transform.projection),[d,p,x,T]=this.coordinates.map(ee=>{const le=c.projection.project(ee[0],ee[1]);return gw(c,le)._round()});this.perspectiveTransform=Pw(d.x,d.y,p.x,p.y,x.x,x.y,T.x,T.y);const S=this._boundsArray=new sh;S.emplaceBack(d.x,d.y,0,0),S.emplaceBack(p.x,p.y,Kt,0),S.emplaceBack(T.x,T.y,0,Kt),S.emplaceBack(x.x,x.y,Kt,Kt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(S,Jv.members),this.boundsSegments=Qi.simpleSegment(0,0,4,2);const P=[],k=[K_((R=this.coordinates)[0]),K_(R[1]),K_(R[2]),K_(R[3])];var R;const[B,j,$,K]=function(ee){let le=ee[0][0],ce=le,W=ee[0][1],ae=W;for(let he=1;he<ee.length;he++)ee[he][0]<le?le=ee[he][0]:ee[he][0]>ce&&(ce=ee[he][0]),ee[he][1]<W?W=ee[he][1]:ee[he][1]>ae&&(ae=ee[he][1]);return[le,W,ce-le,ae-W]}(k);{const ee=new sh,[le,ce,W,ae]=function(dt){let Pt=dt[0].x,ct=Pt,ht=dt[0].y,Nt=ht;for(let Vt=1;Vt<dt.length;Vt++)dt[Vt].x<Pt?Pt=dt[Vt].x:dt[Vt].x>ct&&(ct=dt[Vt].x),dt[Vt].y<ht?ht=dt[Vt].y:dt[Vt].y>Nt&&(Nt=dt[Vt].y);return[Pt,ht,ct-Pt,Nt-ht]}(o),he=dt=>[(dt.x-le)/W,(dt.y-ce)/ae],[ge,Be,ke,je]=o.map(he),Ze=function(dt,Pt,ct,ht,Nt,Vt,yn,cn){const Jt=Z_(0,0,1,0,1,1,0,1);return de(Jt,Jt,ie([],Z_(dt,Pt,ct,ht,Nt,Vt,yn,cn)))}(ge[0],ge[1],Be[0],Be[1],ke[0],ke[1],je[0],je[1]);this.elevatedGlobePerspectiveTransform=Pw(ge[0],ge[1],Be[0],Be[1],ke[0],ke[1],je[0],je[1]);const ut=(dt,Pt)=>{P.push(dt.lng);const ct=Math.round((dt.lng-B)/$*Kt),ht=Math.round((dt.lat-j)/K*Kt),Nt=he(Pt),Vt=Zi([],[Nt[0],Nt[1],1],Ze),yn=Math.round(Vt[0]/Vt[2]*Kt),cn=Math.round(Vt[1]/Vt[2]*Kt);ee.emplaceBack(ct,ht,yn,cn)},Rt=o[3].x-o[0].x,wt=o[3].y-o[0].y,Mt=o[2].x-o[1].x,Dt=o[2].y-o[1].y;for(let dt=0;dt<65;dt++){const Pt=dt/64,ct=[o[0].x+Pt*Rt,o[0].y+Pt*wt],ht=[o[1].x+Pt*Mt,o[1].y+Pt*Dt],Nt=ht[0]-ct[0],Vt=ht[1]-ct[1];for(let yn=0;yn<65;yn++){const cn=yn/64,Jt={x:ct[0]+Nt*cn,y:ct[1]+Vt*cn};ut(n.projection.unproject(Jt.x,Jt.y),Jt)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(ee,Jv.members)}{this.maxLongitudeTriangleSize=0;let ee=[],le=new ws;const ce=(W,ae,he)=>{le.emplaceBack(W,ae,he);const ge=P[W],Be=P[ae],ke=P[he],je=Math.min(Math.min(ge,Be),ke),Ze=Math.max(Math.max(ge,Be),ke)-je;Ze>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ze),ee.push(je+Ze/2)};for(let W=0;W<64;W++)for(let ae=0;ae<64;ae++){const he=65*W+ae,ge=he+1,Be=he+65,ke=Be+1;ce(he,Be,ge),ce(ge,Be,ke)}[ee,le]=function(W,ae){const he=Array.from({length:W.length},(ke,je)=>je);he.sort((ke,je)=>W[ke]-W[je]);const ge=[],Be=new ws;for(let ke=0;ke<he.length;ke++){const je=he[ke];ge.push(W[je]);const Ze=3*je,ut=Ze+1;Be.emplaceBack(ae.uint16[Ze],ae.uint16[ut],ae.uint16[ut+1])}return[ge,Be]}(ee,le),this.elevatedGlobeTrianglesCenterLongitudes=ee,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(le)}this.elevatedGlobeSegments=Qi.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,$/Kt,0,K/Kt,0,0,j,B,0])}prepare(){const e=Object.keys(this.tiles).length!==0;if(this.tileID&&!e)return;const n=this.map.painter.context,o=n.gl;!this._dirty||this.texture instanceof W_||(this.texture?this.texture.update(this.image):(this.texture=new nx(n,this.image,o.RGBA8),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(n)}loadTile(e,n){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},n(null)):(e.state="errored",n(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){const n=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!n)return null;const o=this.elevatedGlobeTrianglesCenterLongitudes;let c=(d=e+180)+360*Math.round((o[0]-d)/360);var d;const p=new Qi,x=(k,R)=>{p.segments.push({vertexOffset:0,primitiveOffset:k,vertexLength:n.segments[0].vertexLength,primitiveLength:R,sortKey:void 0,vaos:{}})},T=.51*this.maxLongitudeTriangleSize;if(Math.abs(o[0]-c)<=T){const k=ds(o,0,o.length,c+T);return k===o.length||x(k,Sr(o,k+1,o.length,c+360-T)-k),p}c<o[0]&&(c+=360);const S=Sr(o,0,o.length,c-T);if(S===o.length)return x(0,o.length),p;x(0,S-0);const P=ds(o,S+1,o.length,c+T);return P!==o.length&&x(P,o.length-P),p}}const ik=(Math.pow(256,2)-1)/16907520;class Mw extends eo{constructor(e,n,o,c){super(e,{layout:Aw||(Aw=new Er({visibility:new Ot(Xe.layout_raster.visibility)})),paint:Iw||(Iw=new Er({"raster-opacity":new Ot(Xe.paint_raster["raster-opacity"]),"raster-color":new Ml(Xe.paint_raster["raster-color"]),"raster-color-mix":new Ot(Xe.paint_raster["raster-color-mix"]),"raster-color-range":new Ot(Xe.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ot(Xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ot(Xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ot(Xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Ot(Xe.paint_raster["raster-saturation"]),"raster-contrast":new Ot(Xe.paint_raster["raster-contrast"]),"raster-resampling":new Ot(Xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Ot(Xe.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Ot(Xe.paint_raster["raster-emissive-strength"]),"raster-array-band":new Ot(Xe.paint_raster["raster-array-band"]),"raster-elevation":new Ot(Xe.paint_raster["raster-elevation"]),"raster-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},n,o,c),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(e){return!(e&&e._source instanceof kw&&(e._source.onNorthPole||e._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(e){e!=="raster-color"&&e!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(e){if(!this.hasColorMap()||!this._curRampRange)return;const n=this._transitionablePaint._values["raster-color"].value.expression,[o,c]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(o)&&isNaN(c)||o===this._curRampRange[0]&&c===this._curRampRange[1]||(this.colorRamp=Xm({expression:n,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:o,end:c}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[o,c])}}let Rw,zw,Lw,Dw,Ow;class Bw extends eo{constructor(e,n,o,c){super(e,{layout:Rw||(Rw=new Er({visibility:new Ot(Xe["layout_raster-particle"].visibility)})),paint:zw||(zw=new Er({"raster-particle-array-band":new Ot(Xe["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Ot(Xe["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Ml(Xe["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Ot(Xe["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Ot(Xe["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Ot(Xe["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Ot(Xe["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Ot(Xe["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},n,o,c),this._updateColorRamp(),this.lastInvalidatedAt=fa.now()}onRemove(e){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){e!=="raster-particle-color"&&e!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),e==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-particle-color"].value.expression,n=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Xm({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:n}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=fa.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class rk extends eo{constructor(e,n){super(e,{},n,null),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(e){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(e){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}function ix(i,e,n){const o=[0,0,1],c=sr([]);return as(c,c,n?-Ei(i)+Math.PI:Ei(i)),Ss(c,c,-Ei(e)),Ci(o,o,c),xn(o,o)}function Fw(i,e){const n=X_(i.projection,i.zoom,i.width,i.height),o=function(d,p,x,T,S){const P=new re(x.lng-180*xp,x.lat),k=new re(x.lng+180*xp,x.lat),R=d.project(P.lng,P.lat),B=d.project(k.lng,k.lat),j=-Math.atan2(B.y-R.y,B.x-R.x),$=Ve.fromLngLat(x);$.y=Ce($.y,-1+xp,1-xp);const K=$.toLngLat(),ee=d.project(K.lng,K.lat),le=Ve.fromLngLat(K);le.x+=xp;const ce=le.toLngLat(),W=d.project(ce.lng,ce.lat),ae=Nw(W.x-ee.x,W.y-ee.y,j),he=Ve.fromLngLat(K);he.y+=xp;const ge=he.toLngLat(),Be=d.project(ge.lng,ge.lat),ke=Nw(Be.x-ee.x,Be.y-ee.y,j),je=Math.abs(ae.x)/Math.abs(ke.y),Ze=ne([]);Oe(Ze,Ze,-j*(1-(S?0:T)));const ut=ne([]);return ye(ut,ut,[1,1-(1-je)*T,1]),ut[4]=-ke.x/ke.y*T,Oe(ut,ut,j),me(ut,Ze,ut),ut}(i.projection,0,i.center,n,e),c=jw(i);return ye(o,o,[c,c,1]),o}function jw(i){const e=i.projection,n=X_(i.projection,i.zoom,i.width,i.height),o=rx(e,i.center),c=rx(e,re.convert(e.center));return Math.pow(2,o*n+(1-n)*c)}function X_(i,e,n,o,c=1/0){const d=i.range;if(!d)return 0;const p=Math.min(c,Math.max(n,o)),x=Math.log(p/1024)/Math.LN2;return He(d[0]+x,d[1]+x,e)}const xp=1/4e4;function rx(i,e){const n=Ce(e.lat,-85.051129,ft),o=new re(e.lng-180*xp,n),c=new re(e.lng+180*xp,n),d=i.project(o.lng,n),p=i.project(c.lng,n),x=Ve.fromLngLat(o),T=Ve.fromLngLat(c),S=p.x-d.x,P=p.y-d.y,k=T.x-x.x,R=T.y-x.y,B=Math.sqrt((k*k+R*R)/(S*S+P*P));return Math.log(B)/Math.LN2}function Nw(i,e,n){const o=Math.cos(n),c=Math.sin(n);return{x:i*o-e*c,y:i*c+e*o}}function Vw(i,e,n){ne(i),Oe(i,i,Ei(e[2])),Le(i,i,Ei(e[0])),De(i,i,Ei(e[1])),ye(i,i,n),me(i,i,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Y_(i,e,n,o,c,d,p,x){const T=[n[0]-e[0],n[1]-e[1],0],S=[o[0]-e[0],o[1]-e[1],0];if(St(T)<1e-12||St(S)<1e-12)return sr(i);const P=ti([],T,S);xn(P,P),Ct(S,o,e),T[2]=(d-c)*x,S[2]=(p-c)*x;const k=T;return ti(k,T,S),xn(k,k),Cs(i,P,k)}function sx(i,e,n=!1){const o=pi(e.zoom),c=function(d,p,x){const T=p.worldSize,S=[d[12],d[13],d[14]],P=We(S[1]/T),k=Me(S[0]/T),R=ne([]),B=Pe(1,P)*T,j=Pe(1,0)*T*Et(P,p.zoom),$=1/zt(T);let K=j*$;if(x){const W=X_(p.projection,p.zoom,p.width,p.height,1024);K=$*p.projection.pixelSpaceConversion(p.center.lat,T,W)}const ee=G(P,k);At(ee,ee,qt([],xn([],ee),B*K*S[2]));const le=function(W){const ae=[W[0],W[1],W[2]];let he=[0,1,0];const ge=ti([],he,ae);return ti(he,ae,ge),Nn(he)===0&&(he=[0,1,0],ti(ge,ae,he)),xn(ge,ge),xn(he,he),xn(ae,ae),[ge[0],ge[1],ge[2],0,he[0],he[1],he[2],0,ae[0],ae[1],ae[2],0,W[0],W[1],W[2],1]}(ee);ye(R,R,[K,K,K*B]),Re(R,R,[-S[0],-S[1],-S[2]]);const ce=me([],p.globeMatrix,le);return me(ce,ce,R),me(ce,ce,d),ce}(i,e,n);if(o>0){const d=function(p,x){const T=x.worldSize,S=Pe(1,0)*T*Et(x.center.lat,x.zoom)/zt(T),P=Pe(1,x.center.lat)*T,k=ne([]);return De(k,k,Ei(x.center.lng)),Le(k,k,Ei(x.center.lat)),Re(k,k,[0,0,b]),ye(k,k,[S,S,S*P]),Re(k,k,[x.point.x-.5*T,x.point.y-.5*T,0]),me(k,k,p),me(k,x.globeMatrix,k)}(i,e);return function(p,x,T){const S=(j,$,K)=>{const ee=St(j),le=St($),ce=Bt(j,$,K);return qt(ce,ce,1/St(ce)*Cn(ee,le,K))},P=S([p[0],p[1],p[2]],[x[0],x[1],x[2]],T),k=S([p[4],p[5],p[6]],[x[4],x[5],x[6]],T),R=S([p[8],p[9],p[10]],[x[8],x[9],x[10]],T),B=Bt([p[12],p[13],p[14]],[x[12],x[13],x[14]],T);return[P[0],P[1],P[2],0,k[0],k[1],k[2],0,R[0],R[1],R[2],0,B[0],B[1],B[2],1]}(c,d,o)}return c}function qw(i,e,n,o){const c=Pi.projectAabbCorners(o,n);let d=Number.MAX_VALUE,p=-1;for(let S=0;S<c.length;++S){const P=c[S];P[0]=(.5*P[0]+.5)*e.width,P[1]=(.5-.5*P[1])*e.height,P[2]<d&&(p=S,d=P[2])}const x=S=>new Wt(c[S][0],c[S][1]);let T;switch(p){case 0:case 6:T=[x(1),x(5),x(4),x(7),x(3),x(2),x(1)];break;case 1:case 7:T=[x(0),x(4),x(5),x(6),x(2),x(3),x(0)];break;case 3:case 5:T=[x(1),x(0),x(4),x(7),x(6),x(2),x(1)];break;default:T=[x(1),x(5),x(6),x(7),x(3),x(0),x(1)]}if(Oo(i,T))return d}const sk=xi([{name:"a_pos_3f",components:3,type:"Float32"}]),ok=xi([{name:"a_color_3f",components:3,type:"Float32"}]),ak=xi([{name:"a_color_4f",components:4,type:"Float32"}]),lk=xi([{name:"a_uv_2f",components:2,type:"Float32"}]),ck=xi([{name:"a_normal_3f",components:3,type:"Float32"}]),uk=xi([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),hk=xi([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),Hw={None:0,Model:1,Symbol:2,FillExtrusion:4};class Q_{constructor(e,n,o,c){this.message=(e?`${e}: `:"")+o,c&&(this.identifier=c),n!=null&&n.__line__&&(this.line=n.__line__)}}function ox(i,e){const n=i.indexOf("://")===-1;try{return new URL(i,n&&e?"http://example.com":void 0),!0}catch{return!1}}class Uw{constructor(e,n){this.feature=e,this.instancedDataOffset=n,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class $w{constructor(){this.instancedDataArray=new hu,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class ax{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.projection=e.projection,this.index=e.index,this.worldview=e.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=e.styleDefinedModelURLs}updateFootprints(e,n){}populate(e,n,o,c){this.tileToMeter=st(o);const d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:p,id:x,index:T,sourceLayerIndex:S}of e){const P=x??(p.properties&&p.properties.hasOwnProperty("id")?p.properties.id:void 0),k=Xt(p,d);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom,{worldview:this.worldview}),k,o))continue;const R={id:P,sourceLayerIndex:S,index:T,geometry:d?k.geometry:tn(p,o,c),properties:p.properties,type:p.type,patterns:{}},B=this.addFeature(R,R.geometry,k);B&&n.featureIndex.insert(p,R.geometry,T,S,this.index,this.instancesPerModel[B].instancedDataArray.length,Kt/32)}this.lookup=null}update(e,n,o,c){for(const d in this.instancesPerModel){const p=this.instancesPerModel[d];for(const x in e)p.idToFeaturesIndex.hasOwnProperty(x)&&(this.evaluate(p.features[p.idToFeaturesIndex[x]],e[x],p,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const n in this.instancesPerModel){const o=this.instancesPerModel[n];for(const c of o.features){const d=this.layers[0],p=c.feature,x=this.canonical,T=d.paint.get("model-rotation").evaluate(p,{},x),S=d.paint.get("model-scale").evaluate(p,{},x),P=d.paint.get("model-translation").evaluate(p,{},x);Yi(c.rotation,T)&&Yi(c.scale,S)&&Yi(c.translation,P)||(this.evaluate(c,c.featureStates,o,!0),e=!0)}}return e}updateReplacement(e,n,o,c){if(n.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=n.updateTime;const d=n.getReplacementRegionsForTile(e.toUnwrapped(),!0);if(Sv(this.activeReplacements,d))return!1;this.activeReplacements=d;let p=!1;for(const x in this.instancesPerModel){const T=this.instancesPerModel[x],S=T.instancedDataArray;for(const P of T.features){const k=P.instancedDataOffset,R=P.instancedDataCount;for(let B=0;B<R;B++){const j=16*(B+k);let $=S.float32[j+0];const K=$>Kt;$=K?$-Kt:$;const ee=Math.floor($),le=S.float32[j+1];let ce=!1;for(const W of this.activeReplacements)if(!Bb(W,o,Hw.Model,c)&&!(W.min.x>ee||ee>W.max.x||W.min.y>le||le>W.max.y)&&(ce=Hb(qb(ee,le,e.canonical,W.footprintTileId.canonical),W.footprint),ce))break;S.float32[j]=ce?$+Kt:$,p=p||ce!==K}}}return p}isEmpty(){for(const e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(const n in this.instancesPerModel){const o=this.instancesPerModel[n];o.instancedDataArray.length<0||o.instancedDataArray.length===0||(o.instancedDataBuffer?o.instancedDataBuffer.updateData(o.instancedDataArray):o.instancedDataBuffer=e.createVertexBuffer(o.instancedDataArray,uk.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const n in this.instancesPerModel){const o=this.instancesPerModel[n];o.instancedDataArray.length!==0&&o.instancedDataBuffer&&o.instancedDataBuffer.destroy()}const e=this.layers[0].modelManager;if(e&&this.modelUris&&this.modelsRequested)for(const n of this.modelUris)e.removeModel(n,"",!0)}addFeature(e,n,o){const c=this.layers[0],d=c.layout.get("model-id").evaluate(o,{},this.canonical);if(!d)return Un(`modelId is not evaluated for layer ${c.id} and it is not going to get rendered.`),d;(ox(d,!1)||this.styleDefinedModelURLs[d]!==void 0)&&(this.modelUris.includes(d)||this.modelUris.push(d)),this.instancesPerModel[d]||(this.instancesPerModel[d]=new $w);const p=this.instancesPerModel[d],x=p.instancedDataArray,T=new Uw(o,x.length);for(const S of n)for(const P of S){if(P.x<0||P.x>=Kt||P.y<0||P.y>=Kt)continue;const k=(this.lookupDim-1)/Kt,R=this.lookupDim*(P.y*k|0)+P.x*k|0;if(this.lookup){if(this.lookup[R]!==0)continue;this.lookup[R]=1}this.instanceCount++;const B=x.length;x.resize(B+1),p.instancesEvaluatedElevation.push(0),x.float32[16*B]=P.x,x.float32[16*B+1]=P.y}return T.instancedDataCount=p.instancedDataArray.length-T.instancedDataOffset,T.instancedDataCount>0&&(e.id&&(p.idToFeaturesIndex[e.id]=p.features.length),p.features.push(T),this.evaluate(T,{},p,!1)),d}getModelUris(){return this.modelUris}evaluate(e,n,o,c){const d=this.layers[0],p=e.feature,x=this.canonical,T=e.rotation=d.paint.get("model-rotation").evaluate(p,n,x),S=e.scale=d.paint.get("model-scale").evaluate(p,n,x),P=e.translation=d.paint.get("model-translation").evaluate(p,n,x),k=d.paint.get("model-color").evaluate(p,n,x);k.a=d.paint.get("model-color-mix-intensity").evaluate(p,n,x);const R=[];this.maxVerticalOffset<P[2]&&(this.maxVerticalOffset=P[2]),this.maxScale=Math.max(Math.max(this.maxScale,S[0]),Math.max(S[1],S[2])),Vw(R,T,S);const B=Math.round(100*k.a)+k.b/1.05;for(let j=0;j<e.instancedDataCount;++j){const $=e.instancedDataOffset+j,K=16*$,ee=o.instancedDataArray.float32;let le=0;c&&(le=ee[K+6]-o.instancesEvaluatedElevation[$]);const ce=0|ee[K+1];ee[K]=(0|ee[K])+k.r/1.05,ee[K+1]=ce+k.g/1.05,ee[K+2]=B,ee[K+3]=1/(x.z>10?this.tileToMeter:st(x,ce)),ee[K+4]=P[0],ee[K+5]=P[1],ee[K+6]=P[2]+le,ee[K+7]=R[0],ee[K+8]=R[1],ee[K+9]=R[2],ee[K+10]=R[4],ee[K+11]=R[5],ee[K+12]=R[6],ee[K+13]=R[8],ee[K+14]=R[9],ee[K+15]=R[10],o.instancesEvaluatedElevation[$]=P[2]}}}let Gw,Ww;nn(ax,"ModelBucket",{omit:["layers"]}),nn($w,"PerModelAttributes"),nn(Uw,"ModelFeature");const ff=64,sm={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function Zw(i,e,n,o,c,d,p,x,T,S=!1){const P=n.zoom,k=n.project(o),R=Et(o.lat,P),B=1/R;ne(i),Re(i,i,[k.x+p[0]*B,k.y+p[1]*B,p[2]]);let j=1,$=1;const K=n.worldSize;if(S){if(n.projection.name==="mercator"){let W=0;n.elevation&&(W=n.elevation.getAtPointOrZero(new Ve(k.x/K,k.y/K),0));const ae=zr([],[k.x,k.y,W,1],n.projMatrix)[3]/n.cameraToCenterDistance;j=ae,$=ae*Et(n.center.lat,P)}else if(n.projection.name==="globe"){const W=sx(i,n),ae=[0,0,0,1];zr(ae,ae,me([],n.projMatrix,W));const he=ae[3]/n.cameraToCenterDistance,ge=pi(P),Be=n.projection.pixelsPerMeter(o.lat,K)*Et(o.lat,P),ke=n.projection.pixelsPerMeter(n.center.lat,K)*Et(n.center.lat,P);j=he/Cn(Be,pt(n.center.lat),ge),$=he*R/Be,j*=ke,$*=ke}}else j=B;ye(i,i,[j,j,$]);const ee=[...i],le=e.orientation,ce=[];if(Vw(ce,[le[0]+c[0],le[1]+c[1],le[2]+c[2]],d),me(i,ee,ce),x&&n.elevation){let W=0;const ae=[];if(T&&n.elevation){W=function(ge,Be,ke,je,Ze){const ut=Be.elevation;if(!ut)return 0;const Rt=Pi.projectAabbCorners(ke,je),wt=Pe(1,Ze.lat)*Be.worldSize,Mt=function(Ft,Bn){const ln=[0,0,1],un=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Mn of un){const Xn=Ft[Mn.corners[0]],Gn=Ft[Mn.corners[1]],ai=Ft[Mn.corners[2]],Qn=[Gn[0]-Xn[0],Gn[1]-Xn[1],Bn*(Gn[2]-Xn[2])],li=ti(Qn,Qn,[ai[0]-Xn[0],ai[1]-Xn[1],Bn*(ai[2]-Xn[2])]);xn(li,li),Mn.dotProductWithUp=An(li,ln)}return un.sort((Mn,Xn)=>Mn.dotProductWithUp-Xn.dotProductWithUp),un[0].corners}(Rt,wt),Dt=Rt[Mt[0]],dt=Rt[Mt[1]],Pt=Rt[Mt[2]],ct=Rt[Mt[3]],ht=ut.getAtPointOrZero(new Ve(Dt[0]/Be.worldSize,Dt[1]/Be.worldSize),0),Nt=ut.getAtPointOrZero(new Ve(dt[0]/Be.worldSize,dt[1]/Be.worldSize),0),Vt=ut.getAtPointOrZero(new Ve(Pt[0]/Be.worldSize,Pt[1]/Be.worldSize),0),yn=ut.getAtPointOrZero(new Ve(ct[0]/Be.worldSize,ct[1]/Be.worldSize),0),cn=(ht+yn)/2,Jt=(Nt+Vt)/2;return cn>Jt?Nt<Vt?Y_(ge,dt,ct,Dt,Nt,yn,ht,wt):Y_(ge,Pt,Dt,ct,Vt,ht,yn,wt):ht<yn?Y_(ge,Dt,dt,Pt,ht,Nt,Vt,wt):Y_(ge,ct,Pt,dt,yn,Vt,Nt,wt),Math.max(cn,Jt)}(ae,n,e.aabb,i,o);const he=me([],$e([],ae),ce);me(i,ee,he)}else W=n.elevation.getAtPointOrZero(new Ve(k.x/K,k.y/K),0);W!==0&&(i[14]+=W)}}function bg(i,e,n=!1){i.uploaded||(i.gfxTexture=new nx(e,i.image,n?e.gl.R8:e.gl.RGBA8,{useMipmap:i.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),i.uploaded=!0,i.image=null)}function dk(i,e,n){i.indexBuffer=e.createIndexBuffer(i.indexArray,!1,!0),i.vertexBuffer=e.createVertexBuffer(i.vertexArray,sk.members,!1,!0),i.normalArray&&(i.normalBuffer=e.createVertexBuffer(i.normalArray,ck.members,!1,!0)),i.texcoordArray&&(i.texcoordBuffer=e.createVertexBuffer(i.texcoordArray,lk.members,!1,!0)),i.colorArray&&(i.colorBuffer=e.createVertexBuffer(i.colorArray,(i.colorArray.bytesPerElement===12?ok:ak).members,!1,!0)),i.featureArray&&(i.pbrBuffer=e.createVertexBuffer(i.featureArray,hk.members,!0)),i.segments=Qi.simpleSegment(0,0,i.vertexArray.length,i.indexArray.length);const o=i.material;o.pbrMetallicRoughness.baseColorTexture&&bg(o.pbrMetallicRoughness.baseColorTexture,e),o.pbrMetallicRoughness.metallicRoughnessTexture&&bg(o.pbrMetallicRoughness.metallicRoughnessTexture,e),o.normalTexture&&bg(o.normalTexture,e),o.occlusionTexture&&bg(o.occlusionTexture,e,n),o.emissionTexture&&bg(o.emissionTexture,e)}function lx(i,e,n){if(i.meshes)for(const o of i.meshes)dk(o,e,n);if(i.children)for(const o of i.children)lx(o,e,n)}function J_(i){if(i.meshes)for(const e of i.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(i.children)for(const e of i.children)J_(e)}function cx(i){if(i.meshes)for(const n of i.meshes)n.vertexBuffer&&(n.vertexBuffer.destroy(),n.indexBuffer.destroy(),n.normalBuffer&&n.normalBuffer.destroy(),n.texcoordBuffer&&n.texcoordBuffer.destroy(),n.colorBuffer&&n.colorBuffer.destroy(),n.pbrBuffer&&n.pbrBuffer.destroy(),n.segments.destroy(),n.material&&((e=n.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(i.children)for(const n of i.children)cx(n)}class om{constructor(e,n,o){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=o}static create(e,n,o){const c=o||e.findDEMTileFor(n);if(!c||!c.dem)return;const d=c.dem,p=c.tileID,x=1<<n.canonical.z-p.canonical.z;return new om(c,d.dim/Kt/x,[(n.canonical.x/x-p.canonical.x)*d.dim,(n.canonical.y/x-p.canonical.y)*d.dim])}tileCoordToPixel(e,n){const o=n*this._scale+this._offset[1],c=Math.floor(e*this._scale+this._offset[0]),d=Math.floor(o);return new Wt(c,d)}getElevationAt(e,n,o,c){const d=e*this._scale+this._offset[0],p=n*this._scale+this._offset[1],x=Math.floor(d),T=Math.floor(p),S=this._dem;return c=!!c,o?Cn(Cn(S.get(x,T,c),S.get(x,T+1,c),p-T),Cn(S.get(x+1,T,c),S.get(x+1,T+1,c),p-T),d-x):S.get(x,T,c)}getElevationAtPixel(e,n,o){return this._dem.get(e,n,!!o)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Pe(1,e)*this._dem.stride}}const ux=new Float32Array(262144),mf=new Uint8Array(262144);function Kw(i){let e=0;if(i.meshes)for(const n of i.meshes)e=Math.max(e,n.aabb.max[2]);if(i.children)for(const n of i.children)e=Math.max(e,Kw(n));return e}function Xw(i,e,n){if(i.meshes)for(const o of i.meshes){if(o.aabb.min[0]===1/0)continue;const c=Pi.applyTransform(o.aabb,i.matrix);n.insert(e,c.min[0],c.min[1],c.max[0],c.max[1])}if(i.children)for(const o of i.children)Xw(o,e,n)}const Yw=["","wall","door","roof","window","lamp","logo"];class Qw{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:e.id,geometry:[],properties:{height:Kw(e)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Pi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0;const n=new Pi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const o of this.node.meshes)this.node.lightMeshIndex!==e&&(o.transformedAabb=Pi.applyTransformFast(o.aabb,this.node.matrix),n.encapsulate(o.transformedAabb)),e++;this.aabb=n}return this.aabb}}class ey{constructor(e,n,o,c,d,p,x,T){this.id=o,this.layers=e,this.layerIds=this.layers.map(S=>S.fqid),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.modelTraits|=sm.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,c&&(this.modelTraits|=sm.HasMapboxMeshFeatures),d&&(this.modelTraits|=sm.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=p,this.worldview=T,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const S of n)this.nodesInfo.push(new Qw(S)),Xw(S,x.featureIndexArray.length,x.grid),x.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,x.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(e,n){for(const o of this.getNodesInfo()){const c=o.node;c.footprint&&n.push({footprint:c.footprint,id:e})}}update(e){const n=Object.keys(e).length!==0;if(n&&!this.stateDependentLayers.length)return;const o=n?this.stateDependentLayers:this.layers;if(!Ha(e,this.states))for(const c of o)this.evaluate(c,e);this.states=structuredClone(e)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const n=this.getNodesInfo();for(const o of n){const c=o.node;this.uploaded?this.updatePbrBuffer(c):lx(c,e,!0)}for(const o of n)J_(o.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let n=!1;if(!e.meshes)return n;for(const o of e.meshes)o.pbrBuffer&&(o.pbrBuffer.updateData(o.featureArray),n=!0);return n}needsReEvaluation(e,n,o){const c=e.transform.projectionOptions,d=e.style.getBrightness(),p=this.brightness!==d;if(!this.uploaded||this.dirty||c.name!==this.projection.name||wg(o.paint.get("model-color").value,p)||wg(o.paint.get("model-color-mix-intensity").value,p)||wg(o.paint.get("model-roughness").value,p)||wg(o.paint.get("model-emissive-strength").value,p)||wg(o.paint.get("model-height-based-emissive-strength-multiplier").value,p)){this.projection=c,this.brightness=d;const x=this.getNodesInfo();for(const T of x)T.state=null;return!0}return!1}evaluateTransform(e,n){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const o=this.getNodesInfo(),c=this.id.canonical;for(const d of o){const p=d.feature;d.evaluatedTranslation=n.paint.get("model-translation").evaluate(p,{},c),d.evaluatedScale=n.paint.get("model-scale").evaluate(p,{},c)}}evaluate(e,n){const o=this.getNodesInfo();for(const c of o){if(!c.node.meshes)continue;const d=c.feature,p=n&&n[d.id];if(Ha(p,c.state))continue;c.state=structuredClone(p);const x=c.node.meshes&&c.node.meshes[0].featureData,T=c.evaluatedColor[2],S=c.evaluatedRMEA[2],P=this.id.canonical;if(c.hasTranslucentParts=!1,x){for(let k=0;k<Yw.length;k++){const R=Yw[k];R.length&&(d.properties.part=R);const B=e.paint.get("model-color").evaluate(d,p,P).toPremultipliedRenderColor(null),j=e.paint.get("model-color-mix-intensity").evaluate(d,p,P);c.evaluatedColor[k]=[B.r,B.g,B.b,j],c.evaluatedRMEA[k][0]=e.paint.get("model-roughness").evaluate(d,p,P),c.evaluatedRMEA[k][2]=e.paint.get("model-emissive-strength").evaluate(d,p,P),c.evaluatedRMEA[k][3]=B.a,c.emissionHeightBasedParams[k]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(d,p,P),!c.hasTranslucentParts&&B.a<1&&(c.hasTranslucentParts=!0)}delete d.properties.part,fk(c,T!==c.evaluatedColor[2]||S!==c.evaluatedRMEA[2],this.modelTraits)}else c.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(d,p,P);c.evaluatedTranslation=e.paint.get("model-translation").evaluate(d,p,P),c.evaluatedScale=e.paint.get("model-scale").evaluate(d,p,P),this.updatePbrBuffer(c.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,n,o,c){const d=e.findDEMTileFor(o);if(d&&(d.tileID.canonical!==this.terrainTile||n!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;const p=om.create(e,o,d);if(!p)return;this.modelTraits&sm.HasMapboxMeshFeatures&&this.updateDEM(e,p,o,c);for(const x of this.getNodesInfo()){const T=x.node;if(!T.footprint||!T.footprint.vertices||!T.footprint.vertices.length)continue;const S=T.footprint.vertices;let P=p.getElevationAt(S[0].x,S[0].y,!0,!0);for(let k=1;k<S.length;k++)P=Math.min(P,p.getElevationAt(S[k].x,S[k].y,!0,!0));T.elevation=P}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=n}}updateDEM(e,n,o,c){let d=n._dem._modifiedForSources[c];if(d===void 0&&(n._dem._modifiedForSources[c]=[],d=n._dem._modifiedForSources[c]),d.includes(o.canonical))return;const p=n._dem.dim;d.push(o.canonical);let x=!1;for(const T of this.getNodesInfo()){const S=T.node;if(!S.footprint||!S.footprint.grid)continue;const P=S.footprint.grid,k=n.tileCoordToPixel(P.min.x,P.min.y),R=n.tileCoordToPixel(P.max.x,P.max.y),B=Math.min(Math.min(p-R.y,k.x),Math.min(k.y,p-R.x));if(B<0)continue;const j=Ce(B,2,5);let $=Math.max(0,k.x-j),K=Math.max(0,k.y-j),ee=Math.min(R.x+j,p-1),le=Math.min(R.y+j,p-1);for(let he=K;he<=le;++he)for(let ge=$;ge<=ee;++ge)mf[he*p+ge]=255;let ce=0,W=0;for(let he=0;he<P.cellsY;++he)for(let ge=0;ge<P.cellsX;++ge){if(!P.cells[he*P.cellsX+ge])continue;const Be=n.tileCoordToPixel(P.min.x+ge/P.xScale,P.min.y+he/P.yScale),ke=n.tileCoordToPixel(P.min.x+(ge+1)/P.xScale,P.min.y+(he+1)/P.yScale);for(let je=Be.y;je<=Math.min(ke.y+1,p-1);++je)for(let Ze=Be.x;Ze<=Math.min(ke.x+1,p-1);++Ze)mf[je*p+Ze]===255&&(mf[je*p+Ze]=0,ce+=n.getElevationAtPixel(Ze,je),W++)}const ae=ce/W;$=Math.max(1,k.x-j),K=Math.max(1,k.y-j),ee=Math.min(R.x+j,p-2),le=Math.min(R.y+j,p-2),x=!0;for(let he=K;he<=le;++he)for(let ge=$;ge<=ee;++ge)mf[he*p+ge]===0&&(ux[he*p+ge]=n._dem.set(ge,he,ae));for(let he=1;he<j;++he){$=Math.max(1,k.x-he),K=Math.max(1,k.y-he),ee=Math.min(R.x+he,p-2),le=Math.min(R.y+he,p-2);for(let ge=K;ge<=le;++ge)for(let Be=$;Be<=ee;++Be){const ke=ge*p+Be;if(mf[ke]===255){let je=0,Ze=0,ut=-1,Rt=-1;for(let wt=-1;wt<=1;++wt)for(let Mt=-1;Mt<=1;++Mt){const Dt=(ge+wt)*p+Be+Mt;if(mf[Dt]>=he)continue;const dt=ux[Dt],Pt=Math.abs(dt);Pt>Ze&&(je=dt,Ze=Pt,ut=Mt,Rt=wt)}if(Ze>.1){const wt=1-(he+.5*Math.abs(ut*Rt))/j;let Mt=n._dem.get(Be,ge)+je*wt;const Dt=n._dem.get(Be+ut,ge+Rt),dt=n._dem.get(Be-ut,ge-Rt,!0);(Mt-Dt)*(Mt-dt)>0&&(Mt=(Dt+dt)/2),ux[ke]=n._dem.set(Be,ge,Mt),mf[ke]=he}}}}}x&&(n._demTile.needsDEMTextureUpload=!0,n._dem._timestamp=fa.now())}setFilter(e){this.filter=e?ed(e):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(e=>this.filter.filter(new ji(this.id.overscaledZ,{worldview:this.worldview}),e.feature,this.id.canonical)):this.nodesInfo}destroy(){const e=this.getNodesInfo();for(const n of e)J_(n.node),cx(n.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,n){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;const o=n.getReplacementRegionsForTile(e.toUnwrapped());for(const c of this.getNodesInfo()){const d=c.node.footprint;c.hiddenByReplacement=!!d&&!o.find(p=>p.footprint===d)}}getHeightAtTileCoord(e,n){const o=[],c=[0,0,0],d=ne([]);for(const p of this.getNodesInfo()){const x=p.node.meshes[0],T=x.transformedAabb;if(e<T.min[0]||n<T.min[1]||e>T.max[0]||n>T.max[1])continue;if(p.node.hidden===!0)return{height:1/0,maxHeight:p.feature.properties.height,hidden:!1,verticalScale:p.evaluatedScale[2]};Se(d,p.node.matrix),c[0]=e,c[1]=n,bn(c,c,d);const S=(c[0]-x.aabb.min[0])/(x.aabb.max[0]-x.aabb.min[0])*ff|0,P=Math.min(63,(c[1]-x.aabb.min[1])/(x.aabb.max[1]-x.aabb.min[1])*ff|0)*ff+Math.min(63,S),k=x.heightmap[P];if(!(k<0&&p.node.footprint))return p.hiddenByReplacement?void 0:{height:k,maxHeight:p.feature.properties.height,hidden:!1,verticalScale:p.evaluatedScale[2]};if(p.node.footprint.grid.query(new Wt(e,n),new Wt(e,n),o),o.length>0)return{height:void 0,maxHeight:p.feature.properties.height,hidden:p.hiddenByReplacement,verticalScale:p.evaluatedScale[2]}}}}function wg(i,e){return i instanceof gc&&!i.isLightConstant&&e}function pk(i,e,n,o,c,d,p,x){let T=(61440&e|(61440&e)>>4)>>8,S=(3840&e|(3840&e)>>4)>>4,P=240&e|(240&e)>>4;n[3]>0&&(T=Cn(T,255*n[0],n[3]),S=Cn(S,255*n[1],n[3]),P=Cn(P,255*n[2],n[3]));const k=T<<8|S,R=P<<8|Math.floor(255*o[3]),B=function(he){const ge=Ce(he,0,2);return Math.min(Math.round(.5*ge*255),255)}(o[2])<<8|15*o[0]<<4|15*o[1],j=Ce(c[0],0,1),$=Ce(c[1],0,1),K=Ce(c[2],0,1),ee=Ce(c[3],0,1);let le,ce,W,ae;if(j!==$&&p!==d&&$!==j){const he=p-d;ce=1/(he*($-j)),W=-(d+he*j)/(he*($-j));const ge=Ce(c[4],-1,1);ae=Math.pow(10,ge),le=255*K<<8|255*ee}else le=65535,ce=0,W=1,ae=1;if(i.emplaceBack(k,R,B,le,ce,W,ae),x){const he=x.length;x.clear();for(let ge=0;ge<he;ge++)x.emplaceBack(k,R,B,le,ce,W,ae)}}function fk(i,e,n){const o=i.node;let c=0;const d=n&sm.HasMeshoptCompression;for(const p of o.meshes){if(o.lights&&o.lightMeshIndex===c||!p.featureData)continue;p.featureArray=new lh,p.featureArray.reserve(p.featureData.length);let x=e;for(const T of p.featureData){const S=d?65535&T:T>>16&65535,P=d?T>>16&65535:65535&T,k=(15&P)<8?15&P:0,R=i.evaluatedRMEA[k],B=i.evaluatedColor[k],j=i.emissionHeightBasedParams[k];let $;if(x&&k===2&&o.lights&&($=new lh,$.resize(10*o.lights.length)),pk(p.featureArray,S,B,R,j,p.aabb.min[2],p.aabb.max[2],$),$&&x){x=!1;const K=o.meshes[o.lightMeshIndex];K.featureArray=$,K.featureArray._trim()}}p.featureArray._trim(),c++}}function Jw(i,e,n,o){const c=1<<i.z;e.lat=We((o/Kt+i.y)/c),e.lng=Me((n/Kt+i.x)/c)}function mk(i,e,n,o){const c=i.getNodesInfo()[e];if(!c||c.hiddenByReplacement||!c.node.meshes)return;let d=Number.MAX_VALUE;const p=c.node,x=n.tile,T=o.calculatePosMatrix(x.tileID.toUnwrapped(),o.worldSize),S=c.evaluatedScale;let P=0;o.elevation&&p.elevation&&(P=p.elevation*o.elevation.exaggeration()),Re(T,T,[(p.anchor?p.anchor[0]:0)*(S[0]-1),(p.anchor?p.anchor[1]:0)*(S[1]-1),P]),ye(T,T,S);const k=n.queryGeometry,R=k.isPointQuery()?k.screenBounds:k.screenGeometry,B=function($){const K=me([],T,$.matrix);me(K,o.expandedFarZProjMatrix,K);for(let ee=0;ee<$.meshes.length;++ee){const le=$.meshes[ee];if(ee===$.lightMeshIndex)continue;const ce=qw(R,o,K,le.aabb);ce!=null&&(d=Math.min(ce,d))}if($.children)for(const ee of $.children)B(ee)};if(B(p),d===Number.MAX_VALUE)return;const j=new re(0,0);return Jw(x.tileID.canonical,j,c.node.anchor[0],c.node.anchor[1]),{intersectionZ:d,position:j,feature:c.feature}}nn(ey,"Tiled3dModelBucket",{omit:["layers"]}),nn(Qw,"Tiled3dModelFeature");const gk={circle:class extends eo{constructor(i,e,n,o){super(i,{layout:Zf||(Zf=new Er({"circle-sort-key":new Zt(Xe.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Ot(Xe.layout_circle["circle-elevation-reference"]),visibility:new Ot(Xe.layout_circle.visibility)})),paint:of||(of=new Er({"circle-radius":new Zt(Xe.paint_circle["circle-radius"]),"circle-color":new Zt(Xe.paint_circle["circle-color"]),"circle-blur":new Zt(Xe.paint_circle["circle-blur"]),"circle-opacity":new Zt(Xe.paint_circle["circle-opacity"]),"circle-translate":new Ot(Xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Ot(Xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ot(Xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ot(Xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Zt(Xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Zt(Xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Zt(Xe.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ot(Xe.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},e,n,o)}createBucket(i){return new Qo(i)}queryRadius(i){const e=i;return mp("circle-radius",this,e)+mp("circle-stroke-width",this,e)+rf(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,n,o,c,d,p,x){const T=sf(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,i.pixelToTileUnitsFactor),S=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return hb(i,o,d,p,x,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,S)}getProgramIds(){return["circle"]}getDefaultProgramParams(i,e,n){const o=ub(this);return{config:new vo(this,{zoom:e,lut:n}),defines:o,overrideFog:!1}}is3D(i){return!i&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends eo{createBucket(i){return new pb(i)}constructor(i,e,n,o){super(i,{layout:fb||(fb=new Er({visibility:new Ot(Xe.layout_heatmap.visibility)})),paint:mb||(mb=new Er({"heatmap-radius":new Zt(Xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Zt(Xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ot(Xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ml(Xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ot(Xe.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},e,n,o),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Xm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return mp("heatmap-radius",this,i)}queryIntersectsFeature(i,e,n,o,c,d,p,x){const T=this.paint.get("heatmap-radius").evaluate(e,n);return hb(i,o,d,p,x,!0,!0,new Wt(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(i,e,n){return i==="heatmap"?{config:new vo(this,{zoom:e,lut:n}),overrideFog:!1}:{}}},hillshade:class extends eo{constructor(i,e,n,o){super(i,{layout:gb||(gb=new Er({visibility:new Ot(Xe.layout_hillshade.visibility)})),paint:_b||(_b=new Er({"hillshade-illumination-direction":new Ot(Xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ot(Xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ot(Xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ot(Xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ot(Xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ot(Xe.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Ot(Xe.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},e,n,o)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(i,e,n){return{overrideFog:!1}}},fill:class extends eo{constructor(i,e,n,o){super(i,{layout:Rb||(Rb=new Er({"fill-sort-key":new Zt(Xe.layout_fill["fill-sort-key"]),visibility:new Ot(Xe.layout_fill.visibility),"fill-elevation-reference":new Ot(Xe.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new Zt(Xe.layout_fill["fill-construct-bridge-guard-rail"])})),paint:zb||(zb=new Er({"fill-antialias":new Ot(Xe.paint_fill["fill-antialias"]),"fill-opacity":new Zt(Xe.paint_fill["fill-opacity"]),"fill-color":new Zt(Xe.paint_fill["fill-color"]),"fill-outline-color":new Zt(Xe.paint_fill["fill-outline-color"]),"fill-translate":new Ot(Xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Ot(Xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Zt(Xe.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Ot(Xe.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Ot(Xe.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Zt(Xe.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new Zt(Xe.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new Zt(Xe.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},e,n,o)}getProgramIds(){const i=this.paint.get("fill-pattern"),e=i&&i.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getDefaultProgramParams(i,e,n){return{config:new vo(this,{zoom:e,lut:n}),overrideFog:!1}}recalculate(i,e){super.recalculate(i,e);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new bv(i)}queryRadius(){return rf(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,n,o,c,d){return!i.queryGeometry.isAboveHorizon&&Jo(Wf(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,i.pixelToTileUnitsFactor),o)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(i){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const e=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return i!=null?e&&!i:e}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends eo{constructor(i,e,n,o){super(i,{layout:r1||(r1=new Er({visibility:new Ot(Xe["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ot(Xe["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:s1||(s1=new Er({"fill-extrusion-opacity":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Zt(Xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Zt(Xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new Zt(Xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Zt(Xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Zt(Xe["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Zt(Xe["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Zt(Xe["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Zt(Xe["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Ot(Xe["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},e,n,o),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(i){return new C_(i)}queryRadius(){return rf(this.paint.get("fill-extrusion-translate"))}is3D(i){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(i,e,n,o,c,d,p,x,T){const S=sf(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,i.pixelToTileUnitsFactor),P=this.paint.get("fill-extrusion-height").evaluate(e,n),k=this.paint.get("fill-extrusion-base").evaluate(e,n),R=[0,0],B=x&&d.elevation,j=d.elevation?d.elevation.exaggeration():1,$=i.tile.getBucket(this);if(B&&$ instanceof C_){const W=$.centroidVertexArray,ae=T+1;ae<W.length&&(R[0]=W.geta_centroid_pos0(ae),R[1]=W.geta_centroid_pos1(ae))}if(R[0]===0&&R[1]===1)return!1;d.projection.name==="globe"&&(o=i1([o],[new Wt(0,0),new Wt(Kt,Kt)],i.tileID.canonical).map(W=>W.polygon).flat());const K=B?x:null,[ee,le]=function(W,ae,he,ge,Be,ke,je,Ze,ut,Rt,wt){return W.projection.name==="globe"?function(Mt,Dt,dt,Pt,ct,ht,Nt,Vt,yn,cn,Jt){const Ft=[],Bn=[],ln=Mt.projection.upVectorScale(Jt,Mt.center.lat,Mt.worldSize).metersToTile,un=[0,0,0,1],Mn=[0,0,0,1],Xn=(ai,Qn,li,Vi)=>{ai[0]=Qn,ai[1]=li,ai[2]=Vi,ai[3]=1},Gn=n1();dt>0&&(dt+=Gn),Pt+=Gn;for(const ai of Dt){const Qn=[],li=[];for(const Vi of ai){const mr=Vi.x+ct.x,fe=Vi.y+ct.y,we=Mt.projection.projectTilePoint(mr,fe,Jt),gt=Mt.projection.upVector(Jt,Vi.x,Vi.y);let $t=dt,en=Pt;if(Nt){const Qt=h1(mr,fe,dt,Pt,Nt,Vt,yn,cn);$t+=Qt.base,en+=Qt.top}dt!==0?Xn(un,we.x+gt[0]*ln*$t,we.y+gt[1]*ln*$t,we.z+gt[2]*ln*$t):Xn(un,we.x,we.y,we.z),Xn(Mn,we.x+gt[0]*ln*en,we.y+gt[1]*ln*en,we.z+gt[2]*ln*en),bn(un,un,ht),bn(Mn,Mn,ht),Qn.push(new uf(un[0],un[1],un[2])),li.push(new uf(Mn[0],Mn[1],Mn[2]))}Ft.push(Qn),Bn.push(li)}return[Ft,Bn]}(W,ae,he,ge,Be,ke,je,Ze,ut,Rt,wt):je?function(Mt,Dt,dt,Pt,ct,ht,Nt,Vt,yn){const cn=[],Jt=[],Ft=[0,0,0,1];for(const Bn of Mt){const ln=[],un=[];for(const Mn of Bn){const Xn=Mn.x+Pt.x,Gn=Mn.y+Pt.y,ai=h1(Xn,Gn,Dt,dt,ht,Nt,Vt,yn);Ft[0]=Xn,Ft[1]=Gn,Ft[2]=ai.base,Ft[3]=1,zr(Ft,Ft,ct),Ft[3]=Math.max(Ft[3],1e-5);const Qn=new uf(Ft[0]/Ft[3],Ft[1]/Ft[3],Ft[2]/Ft[3]);Ft[0]=Xn,Ft[1]=Gn,Ft[2]=ai.top,Ft[3]=1,zr(Ft,Ft,ct),Ft[3]=Math.max(Ft[3],1e-5);const li=new uf(Ft[0]/Ft[3],Ft[1]/Ft[3],Ft[2]/Ft[3]);ln.push(Qn),un.push(li)}cn.push(ln),Jt.push(un)}return[cn,Jt]}(ae,he,ge,Be,ke,je,Ze,ut,Rt):function(Mt,Dt,dt,Pt,ct){const ht=[],Nt=[],Vt=ct[8]*Dt,yn=ct[9]*Dt,cn=ct[10]*Dt,Jt=ct[11]*Dt,Ft=ct[8]*dt,Bn=ct[9]*dt,ln=ct[10]*dt,un=ct[11]*dt;for(const Mn of Mt){const Xn=[],Gn=[];for(const ai of Mn){const Qn=ai.x+Pt.x,li=ai.y+Pt.y,Vi=ct[0]*Qn+ct[4]*li+ct[12],mr=ct[1]*Qn+ct[5]*li+ct[13],fe=ct[2]*Qn+ct[6]*li+ct[14],we=ct[3]*Qn+ct[7]*li+ct[15],gt=Vi+Vt,$t=mr+yn,en=fe+cn,Qt=Math.max(we+Jt,1e-5),on=Vi+Ft,kn=mr+Bn,mi=fe+ln,gi=Math.max(we+un,1e-5);Xn.push(new uf(gt/Qt,$t/Qt,en/Qt)),Gn.push(new uf(on/gi,kn/gi,mi/gi))}ht.push(Xn),Nt.push(Gn)}return[ht,Nt]}(ae,he,ge,Be,ke)}(d,o,k,P,S,p,K,R,j,d.center.lat,i.tileID.canonical),ce=i.queryGeometry;return function(W,ae,he){let ge=1/0;Jo(he,ae)&&(ge=u1(he,ae[0]));for(let Be=0;Be<ae.length;Be++){const ke=ae[Be],je=W[Be];for(let Ze=0;Ze<ke.length-1;Ze++){const ut=ke[Ze],Rt=[ut,ke[Ze+1],je[Ze+1],je[Ze],ut];Oo(he,Rt)&&(ge=Math.min(ge,u1(he,Rt)))}}return ge!==1/0&&ge}(ee,le,ce.isPointQuery()?ce.screenBounds:ce.screenGeometry)}},building:class extends eo{constructor(i,e,n,o){super(i,{layout:T1||(T1=new Er({visibility:new Ot(Xe.layout_building.visibility),"building-roof-shape":new Zt(Xe.layout_building["building-roof-shape"]),"building-height":new Zt(Xe.layout_building["building-height"]),"building-base":new Zt(Xe.layout_building["building-base"])})),paint:S1||(S1=new Er({"building-opacity":new Ot(Xe.paint_building["building-opacity"]),"building-ambient-occlusion-wall-intensity":new Ot(Xe.paint_building["building-ambient-occlusion-wall-intensity"]),"building-ambient-occlusion-ground-intensity":new Ot(Xe.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new Ot(Xe.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new Ot(Xe.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new Ot(Xe.paint_building["building-vertical-scale"]),"building-cast-shadows":new Ot(Xe.paint_building["building-cast-shadows"]),"building-color":new Zt(Xe.paint_building["building-color"]),"building-emissive-strength":new Zt(Xe.paint_building["building-emissive-strength"]),"building-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},e,n,o),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(i){return new w1(i)}},line:class extends eo{constructor(i,e,n,o){const c=L1();super(i,c,e,n,o),c.layout&&(this.layout=new za(c.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ka,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=(()=>{if(ug)return ug;const n=L1();return ug=new pP(n.paint.properties["line-width"].specification),ug.useIntegerZoom=!0,ug})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Lv(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(i,e,n){const o=R1(this);return{config:new vo(this,{zoom:e,lut:n}),defines:o,overrideFog:!1}}queryRadius(i){const e=i,n=D1(mp("line-width",this,e),mp("line-gap-width",this,e)),o=mp("line-offset",this,e);return n/2+Math.abs(o)+rf(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,n,o,c,d){if(i.queryGeometry.isAboveHorizon)return!1;const p=Wf(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,i.pixelToTileUnitsFactor),x=i.pixelToTileUnitsFactor/2*D1(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),T=this.paint.get("line-offset").evaluate(e,n);return T&&(o=function(S,P){const k=[],R=new Wt(0,0);for(let B=0;B<S.length;B++){const j=S[B],$=[];for(let K=0;K<j.length;K++){const ee=j[K],le=j[K+1],ce=K===0?R:ee.sub(j[K-1])._unit()._perp(),W=K===j.length-1?R:le.sub(ee)._unit()._perp(),ae=ce._add(W)._unit();ae._mult(1/(ae.x*W.x+ae.y*W.y)),$.push(ae._mult(P)._add(ee))}k.push($)}return k}(o,T*i.pixelToTileUnitsFactor)),function(S,P,k){for(let R=0;R<P.length;R++){const B=P[R];if(S.length>=3){for(let j=0;j<B.length;j++)if(Ba(S,B[j]))return!0}if(ea(S,B,k))return!0}return!1}(p,o,x)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(i){return!this.hasElevatedBuckets}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:G_,background:class extends eo{constructor(i,e,n,o){super(i,{layout:Cw||(Cw=new Er({visibility:new Ot(Xe.layout_background.visibility)})),paint:Ew||(Ew=new Er({"background-pitch-alignment":new Ot(Xe.paint_background["background-pitch-alignment"]),"background-color":new Ot(Xe.paint_background["background-color"]),"background-pattern":new Ot(Xe.paint_background["background-pattern"]),"background-opacity":new Ot(Xe.paint_background["background-opacity"]),"background-emissive-strength":new Ot(Xe.paint_background["background-emissive-strength"]),"background-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},e,n,o)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(i,e,n){return{overrideFog:!1}}is3D(i){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:Mw,"raster-particle":Bw,sky:class extends eo{constructor(i,e,n,o){super(i,{layout:Lw||(Lw=new Er({visibility:new Ot(Xe.layout_sky.visibility)})),paint:Dw||(Dw=new Er({"sky-type":new Ot(Xe.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ot(Xe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ot(Xe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ot(Xe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ot(Xe.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ml(Xe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ot(Xe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ot(Xe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ot(Xe.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},e,n,o),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Xm({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(i,e){if(this.paint.get("sky-type")==="atmosphere"){const o=this.paint.get("sky-atmosphere-sun"),c=!o,d=i.style.light,p=d.properties.get("position");return c&&d.properties.get("anchor")==="viewport"&&Un("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),c?ix(p.azimuthal,90-p.polar,e):ix(o[0],90-o[1],e)}const n=this.paint.get("sky-gradient-center");return ix(n[0],90-n[1],e)}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}},slot:class extends eo{constructor(i,e,n,o){super(i,{paint:Ow||(Ow=new Er({}))},e,null)}},model:class extends eo{constructor(i,e,n,o){super(i,{layout:Gw||(Gw=new Er({visibility:new Ot(Xe.layout_model.visibility),"model-id":new Zt(Xe.layout_model["model-id"])})),paint:Ww||(Ww=new Er({"model-opacity":new Zt(Xe.paint_model["model-opacity"]),"model-rotation":new Zt(Xe.paint_model["model-rotation"]),"model-scale":new Zt(Xe.paint_model["model-scale"]),"model-translation":new Zt(Xe.paint_model["model-translation"]),"model-color":new Zt(Xe.paint_model["model-color"]),"model-color-mix-intensity":new Zt(Xe.paint_model["model-color-mix-intensity"]),"model-type":new Ot(Xe.paint_model["model-type"]),"model-cast-shadows":new Ot(Xe.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ot(Xe.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ot(Xe.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Zt(Xe.paint_model["model-emissive-strength"]),"model-roughness":new Zt(Xe.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Zt(Xe.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Ot(Xe.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Ot(Xe.paint_model["model-front-cutoff"]),"model-color-use-theme":new Zt({type:"string",default:"default","property-type":"data-driven"})}))},e,n,o),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(i){return new ax(i)}getProgramIds(){return["model"]}is3D(i){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(i){return i instanceof ey?Kt-1:0}queryIntersectsFeature(i,e,n,o,c,d){if(!this.modelManager)return!1;const p=this.modelManager,x=i.tile.getBucket(this);if(!(x&&x instanceof ax))return!1;for(const T in x.instancesPerModel){const S=x.instancesPerModel[T],P=e.id!==void 0?e.id:e.properties&&e.properties.hasOwnProperty("id")?e.properties.id:void 0;if(S.idToFeaturesIndex.hasOwnProperty(P)){const k=S.features[S.idToFeaturesIndex[P]],R=p.getModel(T,this.scope);if(!R)return!1;let B=se();const j=new re(0,0),$=x.canonical;let K=Number.MAX_VALUE;for(let ee=0;ee<k.instancedDataCount;++ee){const le=16*(k.instancedDataOffset+ee),ce=S.instancedDataArray.float32,W=[ce[le+4],ce[le+5],ce[le+6]];Jw($,j,ce[le],0|ce[le+1]),Zw(B,R,d,j,k.rotation,k.scale,W,!1,!1,!1),d.projection.name==="globe"&&(B=sx(B,d));const ae=me([],d.projMatrix,B),he=i.queryGeometry,ge=qw(he.isPointQuery()?he.screenBounds:he.screenGeometry,d,ae,R.aabb);ge!=null&&(K=Math.min(ge,K))}return K!==Number.MAX_VALUE&&K}}return!1}_handleOverridablePaintPropertyUpdate(i,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven()||i!=="model-color"&&i!=="model-color-mix-intensity"&&i!=="model-rotation"&&i!=="model-scale"&&i!=="model-translation"&&i!=="model-emissive-strength")}_isPropertyZoomDependent(i){const e=this._transitionablePaint._values[i];return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof _c}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends eo{constructor(i,e,n,o){super(i,{layout:Lb||(Lb=new Er({"clip-layer-types":new Ot(Xe.layout_clip["clip-layer-types"]),"clip-layer-scope":new Ot(Xe.layout_clip["clip-layer-scope"])})),paint:Db||(Db=new Er({}))},e,n,o)}recalculate(i,e){super.recalculate(i,e)}createBucket(i){return new Ob(i)}is3D(i){return!0}}},hx=new Ti(0,0,0),dx={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},px={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},ty={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},_k={PAINT_ORDER_FILL_AND_STROKE:1},Tg={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},eT={MASK_TYPE_LUMINANCE:1};function yk(i,e,n){i===1&&e.icons.push(function(o,c){return function(d){if(d.usvg_tree.height||(d.usvg_tree.height=d.usvg_tree.width),!d.metadata)return d;const{metadata:p}=d;if(p.content_area){const{content_area:x}=p;x.top==null&&(x.top=x.left),x.width==null&&(x.width=d.usvg_tree.width),x.height==null&&(x.height=x.width)}return p.stretch_x&&p.stretch_x.length&&tT(p,"x"),p.stretch_y&&p.stretch_y.length&&tT(p,"y"),d}(o.readFields(vk,{name:void 0},c))}(n,n.readVarint()+n.pos))}function tT(i,e){const n=[],o=i[`stretch_${e}`];let c=null;for(let d=0;d<o.length;d++)c===null?c=n.length===0?o[0]:n[n.length-1][1]+o[d]:(n.push([c,c+o[d]]),c=null);i[`stretch_${e}_areas`]=n}function vk(i,e,n){i===1?e.name=n.readString():i===2?e.metadata=function(o,c){return o.readFields(xk,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},c)}(n,n.readVarint()+n.pos):i===3&&(e.usvg_tree=function(o,c){return o.readFields(Tk,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},c)}(n,n.readVarint()+n.pos),e.data="usvg_tree")}function xk(i,e,n){i===1?e.stretch_x=n.readPackedVarint():i===2?e.stretch_y=n.readPackedVarint():i===3?e.content_area=function(o,c){return o.readFields(bk,{left:0},c)}(n,n.readVarint()+n.pos):i===4&&e.variables.push(function(o,c){return o.readFields(wk,{name:void 0},c)}(n,n.readVarint()+n.pos))}function bk(i,e,n){i===1?e.left=n.readVarint():i===2?e.width=n.readVarint():i===3?e.top=n.readVarint():i===4&&(e.height=n.readVarint())}function wk(i,e,n){i===1?e.name=n.readString():i===2&&(e.rgb_color=ry(n.readVarint()),e.value="rgb_color")}function Tk(i,e,n){i===1?e.width=e.height=n.readVarint():i===2?e.height=n.readVarint():i===3?e.children.push(ny(n,n.readVarint()+n.pos)):i===4?e.linear_gradients.push(function(o,c){return o.readFields(kk,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},c)}(n,n.readVarint()+n.pos)):i===5?e.radial_gradients.push(function(o,c){return o.readFields(Rk,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},c)}(n,n.readVarint()+n.pos)):i===7?e.clip_paths.push(function(o,c){return o.readFields(zk,{children:[]},c)}(n,n.readVarint()+n.pos)):i===8&&e.masks.push(function(o,c){const d=o.readFields(Lk,{left:0,width:20,mask_type:eT.MASK_TYPE_LUMINANCE,children:[]},c);return d.height==null&&(d.height=d.width),d.top==null&&(d.top=d.left),d}(n,n.readVarint()+n.pos))}function ny(i,e){return i.readFields(Sk,{},e)}function Sk(i,e,n){i===1?(e.group=function(o,c){return o.readFields(Ck,{opacity:255,children:[]},c)}(n,n.readVarint()+n.pos),e.node="group"):i===2&&(e.path=function(o,c){return o.readFields(Ak,{paint_order:1,commands:[],step:1,diffs:[],rule:dx.PATH_RULE_NON_ZERO},c)}(n,n.readVarint()+n.pos),e.node="path")}function Ck(i,e,n){i===1?e.transform=iy(n,n.readVarint()+n.pos):i===2?e.opacity=n.readVarint():i===5?e.clip_path_idx=n.readVarint():i===6?e.mask_idx=n.readVarint():i===7&&e.children.push(ny(n,n.readVarint()+n.pos))}function iy(i,e){return i.readFields(Ek,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},e)}function Ek(i,e,n){i===1?e.sx=n.readFloat():i===2?e.ky=n.readFloat():i===3?e.kx=n.readFloat():i===4?e.sy=n.readFloat():i===5?e.tx=n.readFloat():i===6&&(e.ty=n.readFloat())}function Ak(i,e,n){i===1?e.fill=function(o,c){return o.readFields(Ik,{rgb_color:hx,paint:"rgb_color",opacity:255},c)}(n,n.readVarint()+n.pos):i===2?e.stroke=function(o,c){return o.readFields(Pk,{rgb_color:hx,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},c)}(n,n.readVarint()+n.pos):i===3?e.paint_order=n.readVarint():i===5?n.readPackedVarint(e.commands):i===6?e.step=n.readFloat():i===7?n.readPackedSVarint(e.diffs):i===8&&(e.rule=n.readVarint())}function Ik(i,e,n){i===1?(e.rgb_color=ry(n.readVarint()),e.paint="rgb_color"):i===2?(e.linear_gradient_idx=n.readVarint(),e.paint="linear_gradient_idx"):i===3?(e.radial_gradient_idx=n.readVarint(),e.paint="radial_gradient_idx"):i===5&&(e.opacity=n.readVarint())}function ry(i){return new Ti((i>>16&255)/255,(i>>8&255)/255,(255&i)/255,1)}function Pk(i,e,n){i===1?(e.rgb_color=ry(n.readVarint()),e.paint="rgb_color"):i===2?(e.linear_gradient_idx=n.readVarint(),e.paint="linear_gradient_idx"):i===3?(e.radial_gradient_idx=n.readVarint(),e.paint="radial_gradient_idx"):i===5?n.readPackedFloat(e.dasharray):i===6?e.dashoffset=n.readFloat():i===7?e.miterlimit=n.readFloat():i===8?e.opacity=n.readVarint():i===9?e.width=n.readFloat():i===10?e.linecap=n.readVarint():i===11&&(e.linejoin=n.readVarint())}function kk(i,e,n){i===1?e.transform=iy(n,n.readVarint()+n.pos):i===2?e.spread_method=n.readVarint():i===3?e.stops.push(nT(n,n.readVarint()+n.pos)):i===4?e.x1=n.readFloat():i===5?e.y1=n.readFloat():i===6?e.x2=n.readFloat():i===7&&(e.y2=n.readFloat())}function nT(i,e){return i.readFields(Mk,{offset:0,opacity:255,rgb_color:hx},e)}function Mk(i,e,n){i===1?e.offset=n.readFloat():i===2?e.opacity=n.readVarint():i===3&&(e.rgb_color=ry(n.readVarint()))}function Rk(i,e,n){i===1?e.transform=iy(n,n.readVarint()+n.pos):i===2?e.spread_method=n.readVarint():i===3?e.stops.push(nT(n,n.readVarint()+n.pos)):i===4?e.cx=n.readFloat():i===5?e.cy=n.readFloat():i===6?e.r=n.readFloat():i===7?e.fx=n.readFloat():i===8?e.fy=n.readFloat():i===9&&(e.fr=n.readFloat())}function zk(i,e,n){i===1?e.transform=iy(n,n.readVarint()+n.pos):i===2?e.clip_path_idx=n.readVarint():i===3&&e.children.push(ny(n,n.readVarint()+n.pos))}function Lk(i,e,n){i===1?e.left=e.top=n.readFloat():i===2?e.width=e.height=n.readFloat():i===3?e.top=n.readFloat():i===4?e.height=n.readFloat():i===5?e.mask_type=n.readVarint():i===6?e.mask_idx=n.readVarint():i===7&&e.children.push(ny(n,n.readVarint()+n.pos))}class Dk{static calculate(e={},n=[]){const o=new Map,c=new Map;if(Object.keys(e).length===0)return o;n.forEach(d=>{c.set(d.name,d.rgb_color||new Ti(0,0,0))});for(const[d,p]of Object.entries(e))c.has(d)?o.set(c.get(d).toString(),p):console.warn(`Ignoring unknown image variable "${d}"`);return o}}function am(i,e=255,n){const o=e/255,c=i.toString(),d=n.has(c)?n.get(c).clone():i.clone();return d.a*=o,d.toString()}function Sg(i,e){if(!Cu()){const n=document.createElement("canvas");return n.width=i,n.height=e,n}return new OffscreenCanvas(i,e)}function Ok(i,e){const n=Dk.calculate(e.params,i.metadata?i.metadata.variables:[]),o=i.usvg_tree,c=o.width,d=o.height,p=e.transform?e.transform:new DOMMatrix,x=Math.max(1,Math.round(c*p.a)),T=Math.max(1,Math.round(d*p.d)),S=new DOMMatrix([x/c,0,0,T/d,0,0]),P=Sg(x,T).getContext("2d");return fx(P,S,o,o,n),P.getImageData(0,0,x,T)}function fx(i,e,n,o,c){for(const d of o.children)iT(i,e,n,d,c)}function iT(i,e,n,o,c){o.group?(i.save(),function(d,p,x,T,S){const P=T.mask_idx!=null?x.masks[T.mask_idx]:null,k=T.clip_path_idx!=null?x.clip_paths[T.clip_path_idx]:null;if(T.transform&&(p=lm(T.transform).preMultiplySelf(p)),!function(j,$,K){return j.opacity!==255||$||K}(T,k!=null,P!=null))return void fx(d,p,x,T,S);const R=Sg(d.canvas.width,d.canvas.height),B=R.getContext("2d");fx(B,p,x,T,S),k&&uT(B,p,x,k),P&&hT(B,p,x,P,S),d.globalAlpha=T.opacity/255,d.drawImage(R,0,0)}(i,e,n,o.group,c),i.restore()):o.path&&(i.save(),function(d,p,x,T,S){d.setTransform(p),T.paint_order===_k.PAINT_ORDER_FILL_AND_STROKE?(rT(d,x,T,S),oT(d,x,T,S)):(oT(d,x,T,S),rT(d,x,T,S))}(i,e,n,o.path,c),i.restore())}function rT(i,e,n,o){const c=n.fill;if(!c)return;const d=c.opacity/255;switch(i.save(),i.beginPath(),dT(n,i),c.paint){case"rgb_color":i.fillStyle=am(c.rgb_color,c.opacity,o);break;case"linear_gradient_idx":{const p=e.linear_gradients[c.linear_gradient_idx];p.transform&&i.setTransform(lm(p.transform).preMultiplySelf(i.getTransform())),i.fillStyle=aT(i,p,d,o);break}case"radial_gradient_idx":{const p=e.radial_gradients[c.radial_gradient_idx];p.transform&&i.setTransform(lm(p.transform).preMultiplySelf(i.getTransform())),i.fillStyle=lT(i,p,d,o)}}i.fill(sT(n)),i.restore()}function sT(i){return i.rule===dx.PATH_RULE_NON_ZERO?"nonzero":i.rule===dx.PATH_RULE_EVEN_ODD?"evenodd":void 0}function oT(i,e,n,o){const c=n.stroke;if(!c)return;const d=pT(n);i.lineWidth=c.width,i.miterLimit=c.miterlimit,i.setLineDash(c.dasharray),i.lineDashOffset=c.dashoffset;const p=c.opacity/255;switch(c.paint){case"rgb_color":i.strokeStyle=am(c.rgb_color,c.opacity,o);break;case"linear_gradient_idx":i.strokeStyle=aT(i,e.linear_gradients[c.linear_gradient_idx],p,o,!0);break;case"radial_gradient_idx":i.strokeStyle=lT(i,e.radial_gradients[c.radial_gradient_idx],p,o,!0)}switch(c.linejoin){case ty.LINE_JOIN_MITER_CLIP:case ty.LINE_JOIN_MITER:i.lineJoin="miter";break;case ty.LINE_JOIN_ROUND:i.lineJoin="round";break;case ty.LINE_JOIN_BEVEL:i.lineJoin="bevel"}switch(c.linecap){case px.LINE_CAP_BUTT:i.lineCap="butt";break;case px.LINE_CAP_ROUND:i.lineCap="round";break;case px.LINE_CAP_SQUARE:i.lineCap="square"}i.stroke(d)}function aT(i,e,n,o,c=!1){if(e.stops.length===1){const R=e.stops[0];return am(R.rgb_color,R.opacity*n,o)}const{x1:d,y1:p,x2:x,y2:T}=e;let S=new DOMPoint(d,p),P=new DOMPoint(x,T);if(c){const R=lm(e.transform);S=R.transformPoint(S),P=R.transformPoint(P)}const k=i.createLinearGradient(S.x,S.y,P.x,P.y);for(const R of e.stops)k.addColorStop(R.offset,am(R.rgb_color,R.opacity*n,o));return k}function lT(i,e,n,o,c=!1){if(e.stops.length===1){const ee=e.stops[0];return am(ee.rgb_color,ee.opacity*n,o)}const d=lm(e.transform),{fx:p,fy:x,fr:T,cx:S,cy:P,r:k}=e;let R=new DOMPoint(p,x),B=new DOMPoint(S,P),j=T,$=k;if(c){R=d.transformPoint(R),B=d.transformPoint(B);const ee=(d.a+d.d)/2;j=T*ee,$=e.r*ee}const K=i.createRadialGradient(R.x,R.y,j,B.x,B.y,$);for(const ee of e.stops)K.addColorStop(ee.offset,am(ee.rgb_color,ee.opacity*n,o));return K}function cT(i,e,n,o){const c=o.transform?lm(o.transform).preMultiplySelf(e):e,d=Sg(i.canvas.width,i.canvas.height),p=d.getContext("2d");for(const T of o.children)if(T.group)cT(p,c,n,T.group);else if(T.path){const S=T.path,P=new Path2D;P.addPath(pT(S),c),p.fill(P,sT(S))}const x=o.clip_path_idx!=null?n.clip_paths[o.clip_path_idx]:null;x&&uT(p,c,n,x),i.globalCompositeOperation="source-over",i.drawImage(d,0,0)}function uT(i,e,n,o){const c=Sg(i.canvas.width,i.canvas.height);cT(c.getContext("2d"),e,n,o),i.globalCompositeOperation="destination-in",i.drawImage(c,0,0)}function hT(i,e,n,o,c){if(o.children.length===0)return;const d=o.mask_idx!=null?n.masks[o.mask_idx]:null;d&&hT(i,e,n,d,c);const p=i.canvas.width,x=i.canvas.height,T=Sg(p,x),S=T.getContext("2d"),P=o.width,k=o.height,R=o.left,B=o.top,j=new Path2D,$=new Path2D;$.rect(R,B,P,k),j.addPath($,e),S.clip(j);for(const le of o.children)iT(S,e,n,le,c);const K=S.getImageData(0,0,p,x),ee=K.data;if(o.mask_type===eT.MASK_TYPE_LUMINANCE)for(let le=0;le<ee.length;le+=4)ee[le+3]=ee[le+3]/255*(.2126*ee[le]+.7152*ee[le+1]+.0722*ee[le+2]);S.putImageData(K,0,0),i.globalCompositeOperation="destination-in",i.drawImage(T,0,0)}function lm(i){return i?new DOMMatrix([i.sx,i.ky,i.kx,i.sy,i.tx,i.ty]):new DOMMatrix}function dT(i,e){const n=i.step;let o=i.diffs[0]*n,c=i.diffs[1]*n;e.moveTo(o,c);for(let d=0,p=2;d<i.commands.length;d++)switch(i.commands[d]){case Tg.PATH_COMMAND_MOVE:o+=i.diffs[p++]*n,c+=i.diffs[p++]*n,e.moveTo(o,c);break;case Tg.PATH_COMMAND_LINE:o+=i.diffs[p++]*n,c+=i.diffs[p++]*n,e.lineTo(o,c);break;case Tg.PATH_COMMAND_QUAD:{const x=o+i.diffs[p++]*n,T=c+i.diffs[p++]*n;o=x+i.diffs[p++]*n,c=T+i.diffs[p++]*n,e.quadraticCurveTo(x,T,o,c);break}case Tg.PATH_COMMAND_CUBIC:{const x=o+i.diffs[p++]*n,T=c+i.diffs[p++]*n,S=x+i.diffs[p++]*n,P=T+i.diffs[p++]*n;o=S+i.diffs[p++]*n,c=P+i.diffs[p++]*n,e.bezierCurveTo(x,T,S,P,o,c);break}case Tg.PATH_COMMAND_CLOSE:e.closePath()}return e}function pT(i){return dT(i,new Path2D)}class sy{constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const n=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,n),n}put(e,n){this.cache.has(e)?this.cache.delete(e):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(e,n)}delete(e){this.cache.delete(e)}}nn(sy,"LRUCache");class mx{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(e){return new wo(e,e.data)}getFromCache(e,n,o){return this.cacheMap.has(o)||this.cacheMap.set(o,new sy(150)),this.cacheMap.get(o).get(ol(e.toString(),n))}setInCache(e,n,o,c){this.cacheDependenciesMap.has(c)||this.cacheDependenciesMap.set(c,new Map),this.cacheMap.has(c)||this.cacheMap.set(c,new sy(150));const d=this.cacheDependenciesMap.get(c),p=ol(e.id.toString(),o);d.get(p)||d.set(p,new Set);const x=this.cacheMap.get(c),T=e.toString();d.get(p).add(T),x.put(ol(e.toString(),o),n)}removeImagesFromCacheByIds(e,n,o=0){if(!this.cacheMap.has(o)||!this.cacheDependenciesMap.has(o))return;const c=this.cacheMap.get(o),d=this.cacheDependenciesMap.get(o);for(const p of e){const x=ol(p.toString(),n);if(d.has(x)){for(const T of d.get(x))c.delete(T);d.delete(x)}}}rasterize(e,n,o,c,d=Ok){const p=this.getFromCache(e,o,c);if(p)return p.clone();const x=d(n.icon,e.options),T=mx._getImage(x);return this.setInCache(e,T,o,c),T.clone()}}class fT{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const o=this.toIdx(e,n);return{min:this.minimums[o],max:this.maximums[o]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function mT(i,e,n,o){let c=0,d=Number.MAX_VALUE;for(let p=0;p<3;p++)if(Math.abs(o[p])<1e-15){if(n[p]<i[p]||n[p]>e[p])return null}else{const x=1/o[p];let T=(i[p]-n[p])*x,S=(e[p]-n[p])*x;if(T>S){const P=T;T=S,S=P}if(T>c&&(c=T),S<d&&(d=S),c>d)return null}return c}function gT(i,e,n,o,c,d,p,x,T,S,P){const k=o-i,R=c-e,B=d-n,j=p-i,$=x-e,K=T-n,ee=P[1]*K-P[2]*$,le=P[2]*j-P[0]*K,ce=P[0]*$-P[1]*j,W=k*ee+R*le+B*ce;if(Math.abs(W)<1e-15)return null;const ae=1/W,he=S[0]-i,ge=S[1]-e,Be=S[2]-n,ke=(he*ee+ge*le+Be*ce)*ae;if(ke<0||ke>1)return null;const je=ge*B-Be*R,Ze=Be*k-he*B,ut=he*R-ge*k,Rt=(P[0]*je+P[1]*Ze+P[2]*ut)*ae;return Rt<0||ke+Rt>1?null:(j*je+$*Ze+K*ut)*ae}function _T(i,e,n){return(i-e)/(n-e)}function yT(i,e,n,o,c,d,p,x,T){const S=1<<n,P=d-o,k=p-c,R=(i+1)/S*P+o,B=(e+0)/S*k+c,j=(e+1)/S*k+c;x[0]=(i+0)/S*P+o,x[1]=B,T[0]=R,T[1]=j}class vT{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(d){const p=Math.ceil(Math.log2(d.dim/8)),x=[];let T=Math.ceil(Math.pow(2,p));const S=1/T,P=(B,j,$,K,ee)=>{const le=K?1:0,ce=(B+1)*$-le,W=j*$,ae=(j+1)*$-le;ee[0]=B*$,ee[1]=W,ee[2]=ce,ee[3]=ae};let k=new fT(T);const R=[];for(let B=0;B<T*T;B++){P(B%T,Math.floor(B/T),S,!1,R);const j=bp(R[0],R[1],d),$=bp(R[2],R[1],d),K=bp(R[2],R[3],d),ee=bp(R[0],R[3],d);k.minimums.push(Math.min(j,$,K,ee)),k.maximums.push(Math.max(j,$,K,ee)),k.leaves.push(1)}for(x.push(k),T/=2;T>=1;T/=2){const B=x[x.length-1];k=new fT(T);for(let j=0;j<T*T;j++){P(j%T,Math.floor(j/T),2,!0,R);const $=B.getElevation(R[0],R[1]),K=B.getElevation(R[2],R[1]),ee=B.getElevation(R[2],R[3]),le=B.getElevation(R[0],R[3]),ce=B.isLeaf(R[0],R[1]),W=B.isLeaf(R[2],R[1]),ae=B.isLeaf(R[2],R[3]),he=B.isLeaf(R[0],R[3]),ge=Math.min($.min,K.min,ee.min,le.min),Be=Math.max($.max,K.max,ee.max,le.max),ke=ce&&W&&ae&&he;k.maximums.push(Be),k.minimums.push(ge),k.leaves.push(Be-ge<=5&&ke?1:0)}x.push(k)}return x}(this.dem),o=n.length-1,c=n[o];this._addNode(c.minimums[0],c.maximums[0],c.leaves[0]),this._construct(n,0,0,o,0)}raycastRoot(e,n,o,c,d,p,x=1){return mT([e,n,-100],[o,c,this.maximums[0]*x],d,p)}raycast(e,n,o,c,d,p,x=1){if(!this.nodeCount)return null;const T=this.raycastRoot(e,n,o,c,d,p,x);if(T==null)return null;const S=[],P=[],k=[],R=[],B=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;B.length>0;){const{idx:j,t:$,nodex:K,nodey:ee,depth:le}=B.pop();if(this.leaves[j]){yT(K,ee,le,e,n,o,c,k,R);const W=1<<le,ae=(K+0)/W,he=(K+1)/W,ge=(ee+0)/W,Be=(ee+1)/W,ke=bp(ae,ge,this.dem)*x,je=bp(he,ge,this.dem)*x,Ze=bp(he,Be,this.dem)*x,ut=bp(ae,Be,this.dem)*x,Rt=gT(k[0],k[1],ke,R[0],k[1],je,R[0],R[1],Ze,d,p),wt=gT(R[0],R[1],Ze,k[0],R[1],ut,k[0],k[1],ke,d,p),Mt=Math.min(Rt!==null?Rt:Number.MAX_VALUE,wt!==null?wt:Number.MAX_VALUE);if(Mt!==Number.MAX_VALUE)return Mt;{const Dt=lt([],d,p,$);if(xT(ke,je,ut,Ze,_T(Dt[0],k[0],R[0]),_T(Dt[1],k[1],R[1]))>=Dt[2])return $}continue}let ce=0;for(let W=0;W<this._siblingOffset.length;W++){yT((K<<1)+this._siblingOffset[W][0],(ee<<1)+this._siblingOffset[W][1],le+1,e,n,o,c,k,R),k[2]=-100,R[2]=this.maximums[this.childOffsets[j]+W]*x;const ae=mT(k,R,d,p);if(ae!=null){const he=ae;S[W]=he;let ge=!1;for(let Be=0;Be<ce&&!ge;Be++)he>=S[P[Be]]&&(P.splice(Be,0,W),ge=!0);ge||(P[ce]=W),ce++}}for(let W=0;W<ce;W++){const ae=P[W];B.push({idx:this.childOffsets[j]+ae,t:S[ae],nodex:(K<<1)+this._siblingOffset[ae][0],nodey:(ee<<1)+this._siblingOffset[ae][1],depth:le+1})}}return null}_addNode(e,n,o){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(o),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,o,c,d){if(e[c].isLeaf(n,o)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const p=c-1,x=e[p];let T=0,S=0;for(let P=0;P<this._siblingOffset.length;P++){const k=2*n+this._siblingOffset[P][0],R=2*o+this._siblingOffset[P][1],B=x.getElevation(k,R),j=x.isLeaf(k,R),$=this._addNode(B.min,B.max,j);j&&(T|=1<<P),S||(S=$)}for(let P=0;P<this._siblingOffset.length;P++)T&1<<P||this._construct(e,2*n+this._siblingOffset[P][0],2*o+this._siblingOffset[P][1],p,S+P)}}function xT(i,e,n,o,c,d){return Cn(Cn(i,n,d),Cn(e,o,d),c)}function bp(i,e,n){const o=n.dim,c=Ce(i*o-.5,0,o-1),d=Ce(e*o-.5,0,o-1),p=Math.floor(c),x=Math.floor(d),T=Math.min(p+1,o-1),S=Math.min(x+1,o-1);return xT(n.get(p,x),n.get(T,x),n.get(p,S),n.get(T,S),c-p,d-x)}const Bk={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Fk(i,e,n){return(256*i*256+256*e+n)/10-1e4}function jk(i,e,n){return 256*i+e+n/256-32768}class oy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,o,c=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(o&&o!=="mapbox"&&o!=="terrarium")return void Un(`"${o}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const d=this.dim=n.height-2,p=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.floatView=new Float32Array(n.data.buffer),this.borderReady=c,this._modifiedForSources={},!c){for(let T=0;T<d;T++)p[this._idx(-1,T)]=p[this._idx(0,T)],p[this._idx(d,T)]=p[this._idx(d-1,T)],p[this._idx(T,-1)]=p[this._idx(T,0)],p[this._idx(T,d)]=p[this._idx(T,d-1)];p[this._idx(-1,-1)]=p[this._idx(0,0)],p[this._idx(d,-1)]=p[this._idx(d-1,0)],p[this._idx(-1,d)]=p[this._idx(0,d-1)],p[this._idx(d,d)]=p[this._idx(d-1,d-1)]}const x=o==="terrarium"?jk:Fk;for(let T=0;T<p.length;++T){const S=4*T;this.floatView[T]=x(this.pixels[S],this.pixels[S+1],this.pixels[S+2])}this._timestamp=fa.now()}_buildQuadTree(){this._tree=new vT(this)}get(e,n,o=!1){o&&(e=Ce(e,-1,this.dim),n=Ce(n,-1,this.dim));const c=this._idx(e,n);return this.floatView[c]}set(e,n,o){const c=this._idx(e,n),d=this.floatView[c];return this.floatView[c]=o,o-d}static getUnpackVector(e){return Bk[e]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}static pack(e,n){const o=[0,0,0,0],c=oy.getUnpackVector(n);let d=Math.floor((e+c[3])/c[2]);return o[2]=d%256,d=Math.floor(d/256),o[1]=d%256,d=Math.floor(d/256),o[0]=d,o}getPixels(){return new xb({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let c=n*this.dim,d=n*this.dim+this.dim,p=o*this.dim,x=o*this.dim+this.dim;switch(n){case-1:c=d-1;break;case 1:d=c+1}switch(o){case-1:p=x-1;break;case 1:x=p+1}const T=-n*this.dim,S=-o*this.dim;for(let P=p;P<x;P++)for(let k=c;k<d;k++){const R=4*this._idx(k,P),B=4*this._idx(k+T,P+S);this.pixels[R+0]=e.pixels[B+0],this.pixels[R+1]=e.pixels[B+1],this.pixels[R+2]=e.pixels[B+2],this.pixels[R+3]=e.pixels[B+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Nk(i,e,n){i===1?e.headerLength=n.readFixed32():i===2?e.x=n.readVarint():i===3?e.y=n.readVarint():i===4?e.z=n.readVarint():i===5&&e.layers.push(function(o,c){return o.readFields($k,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},c)}(n,n.readVarint()+n.pos))}function Vk(i,e,n){i===1?(e.delta_filter=function(o,c){return o.readFields(qk,{blockSize:0},c)}(n,n.readVarint()+n.pos),e.filter="delta_filter"):i===2?(n.readVarint(),e.filter="zigzag_filter"):i===3?(n.readVarint(),e.filter="bitshuffle_filter"):i===4&&(n.readVarint(),e.filter="byteshuffle_filter")}function qk(i,e,n){i===1&&(e.blockSize=n.readVarint())}function Hk(i,e,n){i===1?(n.readVarint(),e.codec="gzip_data"):i===2?(n.readVarint(),e.codec="jpeg_image"):i===3?(n.readVarint(),e.codec="webp_image"):i===4&&(n.readVarint(),e.codec="png_image")}function Uk(i,e,n){let o=0,c=0;i===1?e.firstByte=n.readFixed64():i===2?e.lastByte=n.readFixed64():i===3?e.filters.push(function(d,p){return d.readFields(Vk,{},p)}(n,n.readVarint()+n.pos)):i===4?e.codec=function(d,p){return d.readFields(Hk,{},p)}(n,n.readVarint()+n.pos):i===5?c=n.readFloat():i===6?o=n.readFloat():i===7?e.bands.push(n.readString()):i===8?e.offset=n.readDouble():i===9&&(e.scale=n.readDouble()),e.offset===0&&(e.offset=c),e.scale===0&&(e.scale=o)}function $k(i,e,n){i===1?e.version=n.readVarint():i===2?e.name=n.readString():i===3?e.units=n.readString():i===4?e.tileSize=n.readVarint():i===5?e.buffer=n.readVarint():i===6?e.pixelFormat=n.readVarint():i===7&&e.dataIndex.push(function(o,c){return o.readFields(Uk,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},c)}(n,n.readVarint()+n.pos))}function Gk(i,e,n){if(i===2)(function(o,c,d){o.readFields(Wk,d,c)})(n,n.readVarint()+n.pos,e);else if(i===3)throw new Error("Not implemented")}function Wk(i,e,n){if(i===1){let o=0;const c=n.readVarint()+n.pos;for(;n.pos<c;)e[o++]=n.readVarint()}}function Zk(i,e){if(e.length!==4)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let n=e[3];for(let o=2;o>=1;o--){const c=o===1?1:0,d=o===2?1:0;for(let p=0;p<e[0];p++){const x=e[1]*p;for(let T=c;T<e[1];T++){const S=e[2]*(T+x);for(let P=d;P<e[2];P++){const k=e[3]*(P+S);for(let R=0;R<e[3];R++){const B=k+R;i[B]+=i[B-n]}}}}n*=e[o]}return i}function Kk(i){for(let e=0,n=i.length;e<n;e++)i[e]=i[e]>>>1^-(1&i[e]);return i}function Xk(i,e){switch(e){case"uint32":return i;case"uint16":for(let n=0;n<i.length;n+=2){const o=i[n],c=i[n+1];i[n]=(240&o)>>4|(61440&o)>>8|(240&c)<<4|61440&c,i[n+1]=15&o|(3840&o)>>4|(15&c)<<8|(3840&c)<<4}return i;case"uint8":for(let n=0;n<i.length;n+=4){const o=i[n],c=i[n+1],d=i[n+2],p=i[n+3];i[n+0]=(192&o)>>6|(192&c)>>4|(192&d)>>2|192&p,i[n+1]=(48&o)>>4|(48&c)>>2|48&d|(48&p)<<2,i[n+2]=(12&o)>>2|12&c|(12&d)<<2|(12&p)<<4,i[n+3]=3&o|(3&c)<<2|(3&d)<<4|(3&p)<<6}return i;default:throw new Error(`Invalid pixel format, "${e}"`)}}nn(oy,"DEMData"),nn(vT,"DemMinMaxQuadTree",{omit:["dem"]});var Nl=Uint8Array,Cg=Uint16Array,Yk=Int32Array,bT=new Nl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),wT=new Nl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Qk=new Nl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),TT=function(i,e){for(var n=new Cg(31),o=0;o<31;++o)n[o]=e+=1<<i[o-1];var c=new Yk(n[30]);for(o=1;o<30;++o)for(var d=n[o];d<n[o+1];++d)c[d]=d-n[o]<<5|o;return{b:n,r:c}},ST=TT(bT,2),CT=ST.b,Jk=ST.r;CT[28]=258,Jk[258]=28;for(var eM=TT(wT,0).b,ET=new Cg(32768),Ts=0;Ts<32768;++Ts){var cm=(43690&Ts)>>1|(21845&Ts)<<1;ET[Ts]=((65280&(cm=(61680&(cm=(52428&cm)>>2|(13107&cm)<<2))>>4|(3855&cm)<<4))>>8|(255&cm)<<8)>>1}var Eg=function(i,e,n){for(var o=i.length,c=0,d=new Cg(e);c<o;++c)i[c]&&++d[i[c]-1];var p,x=new Cg(e);for(c=1;c<e;++c)x[c]=x[c-1]+d[c-1]<<1;p=new Cg(1<<e);var T=15-e;for(c=0;c<o;++c)if(i[c])for(var S=c<<4|i[c],P=e-i[c],k=x[i[c]-1]++<<P,R=k|(1<<P)-1;k<=R;++k)p[ET[k]>>T]=S;return p},Ag=new Nl(288);for(Ts=0;Ts<144;++Ts)Ag[Ts]=8;for(Ts=144;Ts<256;++Ts)Ag[Ts]=9;for(Ts=256;Ts<280;++Ts)Ag[Ts]=7;for(Ts=280;Ts<288;++Ts)Ag[Ts]=8;var AT=new Nl(32);for(Ts=0;Ts<32;++Ts)AT[Ts]=5;var tM=Eg(Ag,9),nM=Eg(AT,5),gx=function(i){for(var e=i[0],n=1;n<i.length;++n)i[n]>e&&(e=i[n]);return e},bu=function(i,e,n){var o=e/8|0;return(i[o]|i[o+1]<<8)>>(7&e)&n},_x=function(i,e){var n=e/8|0;return(i[n]|i[n+1]<<8|i[n+2]<<16)>>(7&e)},iM=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wu=function(i,e,n){var o=new Error(e||iM[i]);if(o.code=i,Error.captureStackTrace&&Error.captureStackTrace(o,wu),!n)throw o;return o},rM=new Nl(0),sM=typeof TextDecoder<"u"&&new TextDecoder;try{sM.decode(rM,{stream:!0})}catch{}const oM={gzip_data:"gzip"};class Ic extends Error{constructor(e){super(e),this.name="MRTError"}}const aM={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},IT={uint32:1,uint16:2,uint8:4},lM={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let yx;class ay{constructor(e=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){const n=this.layers[e];if(!n)throw new Ic(`Layer '${e}' not found`);return n}getHeaderLength(e){const n=new Uint8Array(e),o=new DataView(e);if(n[0]!==13)throw new Ic("File is not a valid MRT.");return o.getUint32(1,!0)}parseHeader(e){const n=new Uint8Array(e),o=this.getHeaderLength(e);if(n.length<o)throw new Ic(`Expected header with length >= ${o} but got buffer of length ${n.length}`);const c=function(d,p){return d.readFields(Nk,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new yx(n.subarray(0,o)));if(!isNaN(this.x)&&(this.x!==c.x||this.y!==c.y||this.z!==c.z))throw new Ic(`Invalid attempt to parse header ${c.z}/${c.x}/${c.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=c.x,this.y=c.y,this.z=c.z;for(const d of c.layers)this.layers[d.name]=new PT(d,{cacheSize:this._cacheSize});return this}createDecodingTask(e){const n=[],o=this.getLayer(e.layerName);for(let c of e.blockIndices){const d=o.dataIndex[c],p=d.firstByte-e.firstByte,x=d.lastByte-e.firstByte;if(o._blocksInProgress.has(c))continue;const T={layerName:o.name,firstByte:p,lastByte:x,pixelFormat:o.pixelFormat,blockIndex:c,blockShape:[d.bands.length].concat(o.bandShape),buffer:o.buffer,codec:d.codec.codec,filters:d.filters.map(S=>S.filter)};o._blocksInProgress.add(c),n.push(T)}return new kT(n,()=>{n.forEach(c=>o._blocksInProgress.delete(c.blockIndex))},(c,d)=>{if(n.forEach(p=>o._blocksInProgress.delete(p.blockIndex)),c)throw c;d.forEach(p=>{this.getLayer(p.layerName).processDecodedData(p)})})}}class PT{constructor({version:e,name:n,units:o,tileSize:c,pixelFormat:d,buffer:p,dataIndex:x},T){if(this.version=e,this.version!==1)throw new Ic(`Cannot parse raster layer encoded with MRT version ${e}`);this.name=n,this.units=o,this.tileSize=c,this.buffer=p,this.pixelFormat=aM[d],this.dataIndex=x,this.bandShape=[c+2*p,c+2*p,IT[this.pixelFormat]],this._decodedBlocks=new sy(T?T.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return IT[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:e})=>e).flat()}processDecodedData(e){const n=e.blockIndex.toString();this._decodedBlocks.get(n)||this._decodedBlocks.put(n,e.data)}getBlockForBand(e){let n=0;switch(typeof e){case"string":for(const[o,c]of this.dataIndex.entries()){for(const[d,p]of c.bands.entries())if(p===e)return{bandIndex:n+d,blockIndex:o,blockBandIndex:d};n+=c.bands.length}break;case"number":for(const[o,c]of this.dataIndex.entries()){if(e>=n&&e<n+c.bands.length)return{bandIndex:e,blockIndex:o,blockBandIndex:e-n};n+=c.bands.length}break;default:throw new Ic(`Invalid band \`${JSON.stringify(e)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(e){let n=1/0,o=-1/0;const c=[],d=new Set;for(const p of e){const{blockIndex:x}=this.getBlockForBand(p);if(x<0)throw new Ic(`Invalid band: ${JSON.stringify(p)}`);const T=this.dataIndex[x];c.includes(x)||c.push(x),d.add(x),n=Math.min(n,T.firstByte),o=Math.max(o,T.lastByte)}if(d.size>this.cacheSize)throw new Ic(`Number of blocks to decode (${d.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:n,lastByte:o,blockIndices:c}}hasBand(e){const{blockIndex:n}=this.getBlockForBand(e);return n>=0}hasDataForBand(e){const{blockIndex:n}=this.getBlockForBand(e);return n>=0&&!!this._decodedBlocks.get(n.toString())}getBandView(e){const{blockIndex:n,blockBandIndex:o}=this.getBlockForBand(e);if(n<0)throw new Ic(`Band not found: ${JSON.stringify(e)}`);const c=this._decodedBlocks.get(n.toString());if(!c)throw new Ic(`Data for band ${JSON.stringify(e)} of layer "${this.name}" not decoded.`);const d=this.dataIndex[n],p=this.bandShape.reduce((S,P)=>S*P,1),x=o*p,T=c.subarray(x,x+p);return{data:T,bytes:new Uint8Array(T.buffer).subarray(T.byteOffset,T.byteOffset+T.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:d.offset,scale:d.scale}}}ay.setPbf=function(i){yx=i};class kT{constructor(e,n,o){this.tasks=e,this._onCancel=n,this._onComplete=o,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,n){this._finalized||(this._onComplete(e,n),this._finalized=!0)}}function gf(i,e){const n=i.json.bufferViews[e.bufferView],o=I_[e.componentType];return new o(i.buffers[n.buffer],(e.byteOffset||0)+(n.byteOffset||0),e.count*(n.byteStride&&n.byteStride!==cg[e.type]*o.BYTES_PER_ELEMENT?n.byteStride/o.BYTES_PER_ELEMENT:cg[e.type]))}function vx(i,e,n,o){const c=I_[e.componentType],d=function(P){switch(P){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(c),p=i.json.bufferViews[e.bufferView],x=p.byteStride?p.byteStride/c.BYTES_PER_ELEMENT:cg[e.type],T=n.float32,S=T.length/n.capacity;for(let P=0,k=0;P<e.count*x;P+=x,k+=S)for(let R=0;R<S;R++)T[k+R]=o[P+R]*d;n._trim()}function cM(i,e,n){const o=i.indices,c=i.attributes,d={};d.indexArray=new ws;const p=e.json.accessors[o],x=p.count/3;d.indexArray.reserve(x);const T=gf(e,p);for(let R=0;R<x;R++)d.indexArray.emplaceBack(T[3*R],T[3*R+1],T[3*R+2]);d.indexArray._trim(),d.vertexArray=new La;const S=e.json.accessors[c.POSITION];d.vertexArray.reserve(S.count);const P=gf(e,S);for(let R=0;R<S.count;R++)d.vertexArray.emplaceBack(P[3*R],P[3*R+1],P[3*R+2]);if(d.vertexArray._trim(),d.aabb=new Pi(S.min,S.max),d.centroid=function(R,B){const j=[0,0,0],$=R.length;if($>0){for(let K=0;K<$;K++){const ee=3*R[K];j[0]+=B[ee],j[1]+=B[ee+1],j[2]+=B[ee+2]}j[0]/=$,j[1]/=$,j[2]/=$}return j}(T,P),c.COLOR_0!==void 0){const R=e.json.accessors[c.COLOR_0],B=cg[R.type],j=gf(e,R);d.colorArray=B===3?new La:new bs,d.colorArray.resize(R.count),vx(e,R,d.colorArray,j)}if(c.NORMAL!==void 0){d.normalArray=new La;const R=e.json.accessors[c.NORMAL];d.normalArray.resize(R.count);const B=gf(e,R);vx(e,R,d.normalArray,B)}if(c.TEXCOORD_0!==void 0&&n.length>0){d.texcoordArray=new uu;const R=e.json.accessors[c.TEXCOORD_0];d.texcoordArray.resize(R.count);const B=gf(e,R);vx(e,R,d.texcoordArray,B)}if(c._FEATURE_ID_RGBA4444!==void 0){const R=e.json.accessors[c._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(d.featureData=gf(e,R))}c._FEATURE_RGBA4444!==void 0&&(d.featureData=new Uint32Array(gf(e,e.json.accessors[c._FEATURE_RGBA4444]).buffer));const k=i.material;return d.material=function(R,B){const{emissiveFactor:j=[0,0,0],alphaMode:$="OPAQUE",alphaCutoff:K=.5,normalTexture:ee,occlusionTexture:le,emissiveTexture:ce,doubleSided:W}=R,{baseColorFactor:ae=[1,1,1,1],metallicFactor:he=1,roughnessFactor:ge=1,baseColorTexture:Be,metallicRoughnessTexture:ke}=R.pbrMetallicRoughness||{},je=le?B[le.index]:void 0;if(le&&le.extensions&&le.extensions.KHR_texture_transform&&je){const Ze=le.extensions.KHR_texture_transform;je.offsetScale=[Ze.offset[0],Ze.offset[1],Ze.scale[0],Ze.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Ti(...ae),metallicFactor:he,roughnessFactor:ge,baseColorTexture:Be?B[Be.index]:void 0,metallicRoughnessTexture:ke?B[ke.index]:void 0},doubleSided:W,emissiveFactor:new Ti(...j),alphaMode:$,alphaCutoff:K,normalTexture:ee?B[ee.index]:void 0,occlusionTexture:je,emissionTexture:ce?B[ce.index]:void 0,defined:R.defined===void 0}}(k!==void 0?e.json.materials[k]:{defined:!1},n),d}function MT(i,e,n){const{matrix:o,rotation:c,translation:d,scale:p,mesh:x,extras:T,children:S}=i,P={};if(P.matrix=o||function(k,R,B,j){var $=R[0],K=R[1],ee=R[2],le=R[3],ce=$+$,W=K+K,ae=ee+ee,he=$*ce,ge=$*W,Be=$*ae,ke=K*W,je=K*ae,Ze=ee*ae,ut=le*ce,Rt=le*W,wt=le*ae,Mt=j[0],Dt=j[1],dt=j[2];return k[0]=(1-(ke+Ze))*Mt,k[1]=(ge+wt)*Mt,k[2]=(Be-Rt)*Mt,k[3]=0,k[4]=(ge-wt)*Dt,k[5]=(1-(he+Ze))*Dt,k[6]=(je+ut)*Dt,k[7]=0,k[8]=(Be+Rt)*dt,k[9]=(je-ut)*dt,k[10]=(1-(he+ke))*dt,k[11]=0,k[12]=B[0],k[13]=B[1],k[14]=B[2],k[15]=1,k}([],c||[0,0,0,1],d||[0,0,0],p||[1,1,1]),x!==void 0){P.meshes=n[x];const k=P.anchor=[0,0];for(const R of P.meshes){const{min:B,max:j}=R.aabb;k[0]+=B[0]+j[0],k[1]+=B[1]+j[1]}k[0]=Math.floor(k[0]/P.meshes.length/2),k[1]=Math.floor(k[1]/P.meshes.length/2)}if(T&&(T.id&&(P.id=T.id),T.lights&&(P.lights=function(k){if(!k.length)return[];const R=function(ee){const le=atob(ee),ce=new Uint8Array(le.length);for(let W=0;W<le.length;W++)ce[W]=le.codePointAt(W);return ce}(k),B=[],j=R.length/24,$=new Uint16Array(R.buffer),K=new Float32Array(R.buffer);for(let ee=0;ee<j;ee++){const le=$[2*ee*6]/30,ce=$[2*ee*6+1]/30,W=$[2*ee*6+10]/100,ae=K[6*ee+1],he=K[6*ee+2],ge=K[6*ee+3],Be=K[6*ee+4],ke=ge-ae,je=Be-he,Ze=Math.hypot(ke,je);B.push({pos:[ae+.5*ke,he+.5*je,ce],normal:[je/Ze,-ke/Ze,0],width:Ze,height:le,depth:W,points:[ae,he,ge,Be]})}return B}(T.lights))),S){const k=[];for(const R of S)k.push(MT(e.json.nodes[R],e,n));P.children=k}return P}function uM(i){if(i.vertices.length===0||i.indices.length===0)return null;const e=new wv(i.vertices,i.indices,8,256),[n,o]=[e.min.clone(),e.max.clone()];return{vertices:i.vertices,indices:i.indices,grid:e,min:n,max:o}}function hM(i){if(!i.extras||!i.extras.ground)return null;const e=i.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;const n=e[0];if(!n||!Array.isArray(n)||n.length===0)return null;const o=[];for(const p of n){if(!Array.isArray(p)||p.length!==2)continue;const x=p[0],T=p[1];typeof x=="number"&&typeof T=="number"&&o.push(new Wt(x,T))}if(o.length<3)return null;o.length>1&&o[o.length-1].equals(o[0])&&o.pop();let c=0;for(let p=0;p<o.length;p++){const x=o[p],T=o[(p+1)%o.length],S=o[(p+2)%o.length];c+=(x.x-T.x)*(S.y-T.y)-(S.x-T.x)*(x.y-T.y)}c>0&&o.reverse();const d=Ym(o.flatMap(p=>[p.x,p.y]),[]);return d.length===0?null:{vertices:o,indices:d}}function dM(i,e){const n=[],o=[];let c=0;const d=[];for(const p of i){c=n.length;const x=p.vertexArray.float32,T=p.indexArray.uint16;for(let S=0;S<p.vertexArray.length;S++)d[0]=x[3*S+0],d[1]=x[3*S+1],d[2]=x[3*S+2],bn(d,d,e),n.push(new Wt(d[0],d[1]));for(let S=0;S<3*p.indexArray.length;S++)o.push(T[S]+c)}if(o.length%3!=0)return null;for(let p=0;p<o.length;p+=3){const x=n[o[p+0]],T=n[o[p+1]],S=n[o[p+2]];(x.x-T.x)*(S.y-T.y)-(S.x-T.x)*(x.y-T.y)>0&&([o[p+1],o[p+2]]=[o[p+2],o[p+1]])}return{vertices:n,indices:o}}function RT(i){const e=function(T,S){const P=[],k=WebGL2RenderingContext;if(T.json.textures)for(const R of T.json.textures){const B={magFilter:k.LINEAR,minFilter:k.NEAREST,wrapS:k.REPEAT,wrapT:k.REPEAT};R.sampler!==void 0&&Object.assign(B,T.json.samplers[R.sampler]),P.push({image:S[R.source],sampler:B,uploaded:!1})}return P}(i,i.images),n=function(T,S){const P=[];for(const k of T.json.meshes){const R=[];for(const B of k.primitives)R.push(cM(B,T,S));P.push(R)}return P}(i,e),{scenes:o,scene:c,nodes:d}=i.json,p=o?o[c||0].nodes:d,x=[];for(const T of p)x.push(MT(d[T],i,n));return function(T,S,P){const k={},R=new Set;for(let B=0;B<T.length;B++){const j=P[S[B]];if(!j.extras)continue;const $=j.extras["mapbox:footprint:version"],K=j.extras["mapbox:footprint:id"];($||K)&&R.add(B),$==="1.0.0"&&K&&(k[K]=B)}for(let B=0;B<T.length;B++){if(R.has(B))continue;const j=T[B],$=P[S[B]];if(!$.extras)continue;let K=null;j.id in k&&(K=dM(T[k[j.id]].meshes,j.matrix)),K||(K=hM($)),K&&(j.footprint=uM(K))}if(R.size>0){const B=Array.from(R.values()).sort((j,$)=>j-$);for(let j=B.length-1;j>=0;j--)T.splice(B[j],1)}}(x,p,i.json.nodes),x}function pM(i){i.heightmap=new Float32Array(4096),i.heightmap.fill(-1);const e=i.vertexArray.float32,n=i.aabb.min[0]-1,o=i.aabb.min[1]-1,c=ff/(i.aabb.max[0]-n+2),d=ff/(i.aabb.max[1]-o+2);for(let p=0;p<e.length;p+=3){const x=e[p+2],T=(e[p+0]-n)*c|0,S=(e[p+1]-o)*d|0;x>i.heightmap[S*ff+T]&&(i.heightmap[S*ff+T]=x)}}function fM(i,e){const n={};n.indexArray=new ws,n.indexArray.reserve(4*i.length),n.vertexArray=new La,n.vertexArray.reserve(10*i.length),n.colorArray=new bs,n.vertexArray.reserve(10*i.length);let o=0;for(const p of i){const x=Math.min(10,Math.max(4,1.3*p.height))*e,T=[-p.normal[1],p.normal[0],0],S=Math.min(.29,.1*p.width/p.depth),P=p.width-2*p.depth*e*(S+.01),k=lt([],p.pos,T,P/2),R=lt([],p.pos,T,-P/2),B=[k[0],k[1],k[2]+p.height],j=[R[0],R[1],R[2]+p.height],$=lt([],p.normal,T,S);qt($,$,x);const K=lt([],p.normal,T,-S);qt(K,K,x),At($,k,$),At(K,R,K),k[2]+=.1,R[2]+=.1,n.vertexArray.emplaceBack($[0],$[1],$[2]),n.vertexArray.emplaceBack(K[0],K[1],K[2]),n.vertexArray.emplaceBack(k[0],k[1],k[2]),n.vertexArray.emplaceBack(R[0],R[1],R[2]),n.vertexArray.emplaceBack(B[0],B[1],B[2]),n.vertexArray.emplaceBack(j[0],j[1],j[2]),n.vertexArray.emplaceBack(k[0],k[1],k[2]),n.vertexArray.emplaceBack(R[0],R[1],R[2]),n.vertexArray.emplaceBack($[0],$[1],$[2]),n.vertexArray.emplaceBack(K[0],K[1],K[2]);const ee=P/x/2;n.colorArray.emplaceBack(-ee-S,-1,ee,.8),n.colorArray.emplaceBack(ee+S,-1,ee,.8),n.colorArray.emplaceBack(-ee,0,ee,1.3),n.colorArray.emplaceBack(ee,0,ee,1.3),n.colorArray.emplaceBack(ee+S,-.8,ee,.7),n.colorArray.emplaceBack(ee+S,-.8,ee,.7),n.colorArray.emplaceBack(0,0,ee,1.3),n.colorArray.emplaceBack(0,0,ee,1.3),n.colorArray.emplaceBack(ee+S,-1.2,ee,.8),n.colorArray.emplaceBack(ee+S,-1.2,ee,.8),n.indexArray.emplaceBack(6+o,4+o,8+o),n.indexArray.emplaceBack(7+o,9+o,5+o),n.indexArray.emplaceBack(0+o,1+o,2+o),n.indexArray.emplaceBack(1+o,3+o,2+o),o+=10}const c={defined:!0};c.emissiveFactor=Ti.black;const d={};return d.baseColorFactor=Ti.white,c.pbrMetallicRoughness=d,n.material=c,n.aabb=new Pi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),n}ay.performDecoding=function(i,e){const n=new Uint8Array(i);return Promise.all(e.tasks.map(o=>{const{layerName:c,firstByte:d,lastByte:p,pixelFormat:x,blockShape:T,blockIndex:S,filters:P,codec:k}=o,R=n.subarray(d,p+1),B=new Uint32Array(T[0]*T[1]*T[2]);let j;if(k!=="gzip_data")throw new Ic(`Unhandled codec: ${k}`);return j=function($,K){if(!globalThis.DecompressionStream&&K==="gzip_data")return Promise.resolve(((W=function(ge){ge[0]==31&&ge[1]==139&&ge[2]==8||wu(6,"invalid gzip data");var Be=ge[3],ke=10;4&Be&&(ke+=2+(ge[10]|ge[11]<<8));for(var je=(Be>>3&1)+(Be>>4&1);je>0;je-=!ge[ke++]);return ke+(2&Be)}(ce=$))+8>ce.length&&wu(6,"invalid gzip data"),function(ge,Be,ke,je){var Ze=ge.length;if(!Ze||Be.f&&!Be.l)return ke||new Nl(0);var ut=!ke,Rt=ut||Be.i!=2,wt=Be.i;ut&&(ke=new Nl(3*Ze));var Mt,Dt,dt=function(Ur){var wr=ke.length;if(Ur>wr){var hr=new Nl(Math.max(2*wr,Ur));hr.set(ke),ke=hr}},Pt=Be.f||0,ct=Be.p||0,ht=Be.b||0,Nt=Be.l,Vt=Be.d,yn=Be.m,cn=Be.n,Jt=8*Ze;do{if(!Nt){Pt=bu(ge,ct,1);var Ft=bu(ge,ct+1,3);if(ct+=3,!Ft){var Bn=ge[(fe=4+((ct+7)/8|0))-4]|ge[fe-3]<<8,ln=fe+Bn;if(ln>Ze){wt&&wu(0);break}Rt&&dt(ht+Bn),ke.set(ge.subarray(fe,ln),ht),Be.b=ht+=Bn,Be.p=ct=8*ln,Be.f=Pt;continue}if(Ft==1)Nt=tM,Vt=nM,yn=9,cn=5;else if(Ft==2){var un=bu(ge,ct,31)+257,Mn=bu(ge,ct+10,15)+4,Xn=un+bu(ge,ct+5,31)+1;ct+=14;for(var Gn=new Nl(Xn),ai=new Nl(19),Qn=0;Qn<Mn;++Qn)ai[Qk[Qn]]=bu(ge,ct+3*Qn,7);ct+=3*Mn;var li=gx(ai),Vi=(1<<li)-1,mr=Eg(ai,li);for(Qn=0;Qn<Xn;){var fe,we=mr[bu(ge,ct,Vi)];if(ct+=15&we,(fe=we>>4)<16)Gn[Qn++]=fe;else{var gt=0,$t=0;for(fe==16?($t=3+bu(ge,ct,3),ct+=2,gt=Gn[Qn-1]):fe==17?($t=3+bu(ge,ct,7),ct+=3):fe==18&&($t=11+bu(ge,ct,127),ct+=7);$t--;)Gn[Qn++]=gt}}var en=Gn.subarray(0,un),Qt=Gn.subarray(un);yn=gx(en),cn=gx(Qt),Nt=Eg(en,yn),Vt=Eg(Qt,cn)}else wu(1);if(ct>Jt){wt&&wu(0);break}}Rt&&dt(ht+131072);for(var on=(1<<yn)-1,kn=(1<<cn)-1,mi=ct;;mi=ct){var gi=(gt=Nt[_x(ge,ct)&on])>>4;if((ct+=15&gt)>Jt){wt&&wu(0);break}if(gt||wu(2),gi<256)ke[ht++]=gi;else{if(gi==256){mi=ct,Nt=null;break}var Jn=gi-254;gi>264&&(Jn=bu(ge,ct,(1<<(_i=bT[Qn=gi-257]))-1)+CT[Qn],ct+=_i);var $i=Vt[_x(ge,ct)&kn],ur=$i>>4;if($i||wu(3),ct+=15&$i,Qt=eM[ur],ur>3){var _i=wT[ur];Qt+=_x(ge,ct)&(1<<_i)-1,ct+=_i}if(ct>Jt){wt&&wu(0);break}Rt&&dt(ht+131072);var Fr=ht+Jn;if(ht<Qt){var gr=0-Qt,qi=Math.min(Qt,Fr);for(gr+ht<0&&wu(3);ht<qi;++ht)ke[ht]=(void 0)[gr+ht]}for(;ht<Fr;++ht)ke[ht]=ke[ht-Qt]}}Be.l=Nt,Be.p=mi,Be.b=ht,Be.f=Pt,Nt&&(Pt=1,Be.m=yn,Be.d=Vt,Be.n=cn)}while(!Pt);return ht!=ke.length&&ut?(Mt=ke,((Dt=ht)==null||Dt>Mt.length)&&(Dt=Mt.length),new Nl(Mt.subarray(0,Dt))):ke.subarray(0,ht)}(ce.subarray(W,-8),{i:2},new Nl(((ee=ce)[(le=ee.length)-4]|ee[le-3]<<8|ee[le-2]<<16|ee[le-1]<<24)>>>0))));var ee,le,ce,W;const ae=oM[K];if(!ae)throw new Error(`Unhandled codec: ${K}`);const he=new globalThis.DecompressionStream(ae);return new Response(new Blob([$]).stream().pipeThrough(he)).arrayBuffer().then(ge=>new Uint8Array(ge))}(R,k).then($=>(function(K,ee){K.readFields(Gk,ee)}(new yx($),B),new lM[x](B.buffer))),j.then($=>{for(let K=P.length-1;K>=0;K--)switch(P[K]){case"delta_filter":Zk($,T);break;case"zigzag_filter":Kk($);break;case"bitshuffle_filter":Xk($,x);break;default:throw new Ic(`Unhandled filter "${P[K]}"`)}return{layerName:c,blockIndex:S,data:$}}).catch($=>{throw $})}))},nn(kT,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),nn(ay,"MapboxRasterTile"),nn(PT,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class zT{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const o=e[n];this._stringToNumber[o]=n,this._numberToString[n]=o}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const mM=["id","tile","layer","source","sourceLayer","state"];class um{constructor(e,n,o,c,d){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=o,this._y=c,this.properties=e.properties,this.id=d}clone(){const e=new um(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(e.state=Object.assign({},this.state)),this.layer&&(e.layer=Object.assign({},this.layer)),this.source&&(e.source=this.source),this.sourceLayer&&(e.sourceLayer=this.sourceLayer),e}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const n of mM)this[n]!==void 0&&(e[n]=this[n]);return e}}class LT{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new As(Kt,16,0),this.featureIndexArray=new hp,this.promoteId=n,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(e,n,o,c,d,p=0,x=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,c,d,p);const S=this.grid;for(let P=0;P<n.length;P++){const k=n[P],R=[1/0,1/0,-1/0,-1/0];for(let B=0;B<k.length;B++){const j=k[B];R[0]=Math.min(R[0],j.x),R[1]=Math.min(R[1],j.y),R[2]=Math.max(R[2],j.x),R[3]=Math.max(R[3],j.y)}x!==0&&(R[0]-=x,R[1]-=x,R[2]+=x,R[3]+=x),R[0]<Kt&&R[1]<Kt&&R[2]>=0&&R[3]>=0&&S.insert(T,R[0],R[1],R[2],R[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Zn.VectorTile(new k_(this.rawTileData)).layers,this.sourceLayerCoder=new zT(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n){const{tilespaceGeometry:o,transform:c,tileTransform:d,pixelPosMatrix:p,availableImages:x,worldview:T}=n;this.loadVTLayers(),this.serializedLayersCache.clear();const S=o.bufferedTilespaceBounds,P=this.grid.query(S.min.x,S.min.y,S.max.x,S.max.y,(j,$,K,ee)=>Fl(o.bufferedTilespaceGeometry,j,$,K,ee));P.sort(gM);let k=null;c.elevation&&P.length>0&&(k=om.create(c.elevation,this.tileID));const R={};let B;for(let j=0;j<P.length;j++){const $=P[j];if($===B)continue;B=$;const K=this.featureIndexArray.get($);let ee=null;this.is3DTile?this.loadMatchingModelFeature(R,K,e,o,c,T):this.loadMatchingFeature(R,K,e,x,T,(le,ce,W,ae=0)=>(ee||(ee=tn(le,this.tileID.canonical,d)),ce.queryIntersectsFeature(o,le,W,ee,this.z,c,p,k,ae)))}return R}loadMatchingFeature(e,n,o,c,d,p){const{featureIndex:x,bucketIndex:T,sourceLayerIndex:S,layoutVertexArrayOffset:P}=n,k=this.bucketLayerIDs[T],R=o.layers,B=Object.keys(R);if(B.length&&!On(B,k))return;const j=o.sourceCache,$=this.sourceLayerCoder.decode(S),K=this.vtLayers[$].feature(x),ee=this.getId(K,$);for(let le=0;le<k.length;le++){const ce=k[le];if(!R[ce])continue;const{styleLayer:W,targets:ae}=R[ce];let he={};ee!==void 0&&(he=j.getFeatureState(W.sourceLayer,ee));const ge=!p||p(K,W,he,P);if(!ge)continue;const Be=new um(K,this.z,this.x,this.y,ee);Be.tile=this.tileID.canonical,Be.state=he;let ke=this.serializedLayersCache.get(ce);ke||(ke=W.serialize(),ke.id=ce,this.serializedLayersCache.set(ce,ke)),Be.source=ke.source,Be.sourceLayer=ke["source-layer"],Be.layer=tt({},ke),Be.layer.paint=DT(ke.paint,W.paint,K,he,c),Be.layer.layout=DT(ke.layout,W.layout,K,he,c);let je=!1;for(const Ze of ae){this.updateFeatureProperties(Be,Ze);const{filter:ut}=Ze;if(ut){if(K.properties=Be.properties,ut.needGeometry){const Rt=Xt(K,!0);if(!ut.filter(new ji(this.tileID.overscaledZ,{worldview:d}),Rt,this.tileID.canonical))continue}else if(!ut.filter(new ji(this.tileID.overscaledZ,{worldview:d}),K))continue}je=!0,Ze.targetId&&this.addFeatureVariant(Be,Ze)}je&&this.appendToResult(e,ce,x,Be,ge)}}loadMatchingModelFeature(e,n,o,c,d,p){const{featureIndex:x,bucketIndex:T}=n,S=this.bucketLayerIDs[T],P=o.layers,k=Object.keys(P);if(!k.length||On(k,S))for(let R=0;R<S.length;R++){const B=S[R],{styleLayer:j,targets:$}=P[B];if(j.type!=="model")continue;const K=c.tile,ee=K.getBucket(j);if(!(ee&&ee instanceof ey))continue;const le=mk(ee,x,c,d);if(!le)continue;const{z:ce,x:W,y:ae}=K.tileID.canonical,{feature:he,intersectionZ:ge,position:Be}=le;let ke={};he.id!==void 0&&(ke=o.sourceCache.getFeatureState(j.sourceLayer,he.id));const je=new um({},ce,W,ae,he.id);je.tile=this.tileID.canonical,je.state=ke,je.properties=he.properties,je.geometry={type:"Point",coordinates:[Be.lng,Be.lat]};let Ze=this.serializedLayersCache.get(B);Ze||(Ze=j.serialize(),Ze.id=B,this.serializedLayersCache.set(B,Ze)),je.source=Ze.source,je.sourceLayer=Ze["source-layer"],je.layer=tt({},Ze);let ut=!1;for(const Rt of $){this.updateFeatureProperties(je,Rt);const{filter:wt}=Rt;if(wt){if(he.properties=je.properties,wt.needGeometry){if(!wt.filter(new ji(this.tileID.overscaledZ,{worldview:p}),he,this.tileID.canonical))continue}else if(!wt.filter(new ji(this.tileID.overscaledZ,{worldview:p}),he))continue}ut=!0,Rt.targetId&&this.addFeatureVariant(je,Rt)}ut&&this.appendToResult(e,B,x,je,ge)}}updateFeatureProperties(e,n,o){if(n.properties){const c={};for(const d in n.properties){const p=n.properties[d].evaluate({zoom:this.z},e._vectorTileFeature,e.state,e.tile,o);p!=null&&(c[d]=p)}e.properties=c}}addFeatureVariant(e,n,o){const c={target:n.target,namespace:n.namespace,uniqueFeatureID:n.uniqueFeatureID};n.properties&&(c.properties=e.properties),e.variants=e.variants||{},e.variants[n.targetId]=e.variants[n.targetId]||[],e.variants[n.targetId].push(c)}appendToResult(e,n,o,c,d){let p=e[n];p===void 0&&(p=e[n]=[]),p.push({featureIndex:o,feature:c,intersectionZ:d})}lookupSymbolFeatures(e,n,o,c,d,p){const x={};this.loadVTLayers();for(const T of e)this.loadMatchingFeature(x,{bucketIndex:n,sourceLayerIndex:o,featureIndex:T,layoutVertexArrayOffset:0},c,d,p);return x}loadFeature(e){const{featureIndex:n,sourceLayerIndex:o}=e;this.loadVTLayers();const c=this.sourceLayerCoder.decode(o),d=this.vtFeatures[c];if(d[n])return d[n];const p=this.vtLayers[c].feature(n);return d[n]=p,p}hasLayer(e){for(const n of this.bucketLayerIDs)for(const o of n)if(e===o)return!0;return!1}getId(e,n){let o=e.id;if(this.promoteId){const c=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[n];if(c!=null)if(Array.isArray(c)){if(!this.promoteIdExpression){const d=tl(c);if(d.result!=="success"){const p=d.value.map(x=>`${x.key}: ${x.message}`).join(", ");return void Un(`Failed to create expression for promoteId: ${p}`)}this.promoteIdExpression=d.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Lh),o=this.promoteIdExpression.evaluate({zoom:0},e)}else o=e.properties[c];typeof o=="boolean"&&(o=Number(o))}return o}}function DT(i,e,n,o,c){return hn(i,(d,p)=>{const x=e instanceof za?e.get(p):null;return x&&x.evaluate?x.evaluate(n,o,void 0,c):x})}function gM(i,e){return e-i}nn(LT,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const OT=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class xx{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,o]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const c=o>>4;if(c!==1)throw new Error(`Got v${c} data when expected v1.`);const d=OT[15&o];if(!d)throw new Error("Unrecognized array type.");const[p]=new Uint16Array(e,2,1),[x]=new Uint32Array(e,4,1);return new xx(x,p,d,e)}constructor(e,n=64,o=Float64Array,c){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const d=OT.indexOf(this.ArrayType),p=2*e*this.ArrayType.BYTES_PER_ELEMENT,x=e*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-x%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${o}.`);c&&c instanceof ArrayBuffer?(this.data=c,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+x+T,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+p+x+T),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+x+T,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=n,o}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return bx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:p,nodeSize:x}=this,T=[0,d.length-1,0],S=[];for(;T.length;){const P=T.pop()||0,k=T.pop()||0,R=T.pop()||0;if(k-R<=x){for(let K=R;K<=k;K++){const ee=p[2*K],le=p[2*K+1];ee>=e&&ee<=o&&le>=n&&le<=c&&S.push(d[K])}continue}const B=R+k>>1,j=p[2*B],$=p[2*B+1];j>=e&&j<=o&&$>=n&&$<=c&&S.push(d[B]),(P===0?e<=j:n<=$)&&(T.push(R),T.push(B-1),T.push(1-P)),(P===0?o>=j:c>=$)&&(T.push(B+1),T.push(k),T.push(1-P))}return S}within(e,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:c,coords:d,nodeSize:p}=this,x=[0,c.length-1,0],T=[],S=o*o;for(;x.length;){const P=x.pop()||0,k=x.pop()||0,R=x.pop()||0;if(k-R<=p){for(let K=R;K<=k;K++)FT(d[2*K],d[2*K+1],e,n)<=S&&T.push(c[K]);continue}const B=R+k>>1,j=d[2*B],$=d[2*B+1];FT(j,$,e,n)<=S&&T.push(c[B]),(P===0?e-o<=j:n-o<=$)&&(x.push(R),x.push(B-1),x.push(1-P)),(P===0?e+o>=j:n+o>=$)&&(x.push(B+1),x.push(k),x.push(1-P))}return T}}function bx(i,e,n,o,c,d){if(c-o<=n)return;const p=o+c>>1;BT(i,e,p,o,c,d),bx(i,e,n,o,p-1,1-d),bx(i,e,n,p+1,c,1-d)}function BT(i,e,n,o,c,d){for(;c>o;){if(c-o>600){const S=c-o+1,P=n-o+1,k=Math.log(S),R=.5*Math.exp(2*k/3),B=.5*Math.sqrt(k*R*(S-R)/S)*(P-S/2<0?-1:1);BT(i,e,n,Math.max(o,Math.floor(n-P*R/S+B)),Math.min(c,Math.floor(n+(S-P)*R/S+B)),d)}const p=e[2*n+d];let x=o,T=c;for(Ig(i,e,o,n),e[2*c+d]>p&&Ig(i,e,o,c);x<T;){for(Ig(i,e,x,T),x++,T--;e[2*x+d]<p;)x++;for(;e[2*T+d]>p;)T--}e[2*o+d]===p?Ig(i,e,o,T):(T++,Ig(i,e,T,c)),T<=n&&(o=T+1),n<=T&&(c=T-1)}}function Ig(i,e,n,o){wx(i,n,o),wx(e,2*n,2*o),wx(e,2*n+1,2*o+1)}function wx(i,e,n){const o=i[e];i[e]=i[n],i[n]=o}function FT(i,e,n,o){const c=i-n,d=e-o;return c*c+d*d}r.$=vs,r.A=rc,r.B=bl,r.C=ol,r.D=Yf,r.E=sc,r.F=2,r.G=fg,r.H=nw,r.I=oo,r.J=wl,r.K=class extends Q_{},r.L=$a,r.M=Ps,r.N=Yu,r.O=Xu,r.P=Wt,r.Q=Kh,r.R=ga,r.S=Il,r.T=nx,r.U=Lo,r.V=Q_,r.W=su,r.X=tl,r.Y=Vu,r.Z=pc,r._=El,r.a=function(i){return Ds.API_CDN_URL_REGEX.test(i)},r.a$=rt,r.a0=Os,r.a1=Tc,r.a2=mc,r.a3=Zh,r.a4=function(i){const e=i.value;let n=[];if(!e)return n;const o=wl(e);return o!=="string"?(n=n.concat([new Q_(i.key,e,`string expected, "${o}" found`)]),n):(ox(e,!0)||(n=n.concat([new Q_(i.key,e,`invalid url "${e}"`)])),n)},r.a5=Xe,r.a6=us,r.a7=Er,r.a8=Ot,r.a9=class{constructor(i){this.specification=i}possiblyEvaluate(i,e){return pr(i.expression.evaluate(e))}interpolate(i,e,n){return{x:Cn(i.x,e.x,n),y:Cn(i.y,e.y,n),z:Cn(i.z,e.z,n),azimuthal:Cn(i.azimuthal,e.azimuthal,n),polar:Cn(i.polar,e.polar,n)}}},r.aA=zr,r.aB=b,r.aC=Ba,r.aD=Te,r.aE=nt,r.aF=function(i,e){const n={};for(let o=0;o<e.length;o++){const c=e[o];c in i&&(n[c]=i[c])}return n},r.aG=pe,r.aH=ve,r.aI=class{constructor(i){this.entries={},this.scheduler=i}request(i,e,n,o){const c=this.entries[i]=this.entries[i]||{callbacks:[]};if(c.result){const[d,p]=c.result;return this.scheduler?this.scheduler.add(()=>{o(d,p)},e):o(d,p),()=>{}}return c.callbacks.push(o),c.cancel||(c.cancel=n((d,p)=>{c.result=[d,p];for(const x of c.callbacks)this.scheduler?this.scheduler.add(()=>{x(d,p)},e):x(d,p);setTimeout(()=>delete this.entries[i],3e3)})),()=>{c.result||(c.callbacks=c.callbacks.filter(d=>d!==o),c.callbacks.length||(c.cancel(),delete this.entries[i]))}}},r.aJ=function(i,e,n){const o=JSON.stringify(i.request);return i.data&&(this.deduped.entries[o]={result:[null,i.data]}),this.deduped.request(o,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},c=>{const d=Ih(i.request,(p,x,T,S)=>{p?c(p):x&&c(null,{vectorTile:n?void 0:new Zn.VectorTile(new k_(x)),rawData:x,cacheControl:T,expires:S})});return()=>{d.cancel(),c()}},e)},r.aK=function(i){Cd++,Cd>ar&&(i.getActor().send("enforceCacheSizeLimit",ia),Cd=0)},r.aL=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},r.aM=bo,r.aN=Mw,r.aO=Bw,r.aP=kw,r.aQ=function(i,e){const n=document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let o=0;o<i.length;o++){const c=document.createElement("source");Rf(i[o])||(n.crossOrigin="Anonymous"),c.src=i[o],n.appendChild(c)}return{cancel:()=>{}}},r.aR=W_,r.aS=function(i){return fetch(i).then(e=>e.arrayBuffer()).then(e=>b1(e,0,i))},r.aT=RT,r.aU=class{constructor(i,e,n,o){this.id=i,this.position=e!=null?new re(e[0],e[1]):new re(0,0),this.orientation=n??[0,0,0],this.nodes=o,this.uploaded=!1,this.aabb=new Pi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(i,e){if(me(i.matrix,e,i.matrix),i.meshes)for(const n of i.meshes){const o=Pi.applyTransformFast(n.aabb,i.matrix);this.aabb.encapsulate(o)}if(i.children)for(const n of i.children)this._applyTransformations(n,i.matrix)}computeBoundsAndApplyParent(){const i=ne([]);for(const e of this.nodes)this._applyTransformations(e,i)}computeModelMatrix(i,e,n,o,c,d,p=!1){Zw(this.matrix,this,i.transform,this.position,e,n,o,c,d,p)}upload(i){if(!this.uploaded){for(const e of this.nodes)lx(e,i);for(const e of this.nodes)J_(e);this.uploaded=!0}}destroy(){for(const i of this.nodes)cx(i)}},r.aV=an,r.aW=gg,r.aX=Me,r.aY=We,r.aZ=sh,r.a_=ws,r.aa=ji,r.ab=_c,r.ac=Ve,r.ad=bn,r.ae=St,r.af=He,r.ag=za,r.ah=pi,r.ai=Cn,r.aj=Kt,r.ak=Mu,r.al=Ei,r.am=Ti,r.an=class{constructor(i){this.specification=i}possiblyEvaluate(i,e){return function([n,o]){const c=pr([1,n,o]);return{x:c.x,y:c.y,z:c.z}}(i.expression.evaluate(e))}interpolate(i,e,n){return{x:Cn(i.x,e.x,n),y:Cn(i.y,e.y,n),z:Cn(i.z,e.z,n)}}},r.ao=function(i,e,n=0,o=!0){const c=new Wt(n,n),d=i.sub(c),p=e.add(c),x=[d,new Wt(p.x,d.y),p,new Wt(d.x,p.y)];return o&&x.push(d.clone()),x},r.ap=function(i,e){const n=[];for(let o=0;o<i.length;o++){const c=Je(o-1,-1,i.length-1),d=Je(o+1,-1,i.length-1),p=i[o],x=i[d],T=i[c].sub(p).unit(),S=x.sub(p).unit(),P=S.angleWithSep(T.x,T.y),k=T.add(S).unit().mult(-1*e/Math.sin(P/2));n.push(p.add(k))}return n},r.aq=gw,r.ar=Fl,r.as=function(i,e,n=0){return xt(((e.x-n)*i.scale-i.x)*Kt,(e.y*i.scale-i.y)*Kt,Qe(e.z,e.y))},r.at=Vn,r.au=xn,r.av=cr,r.aw=I1,r.ax=function(i){let e=1/0,n=1/0,o=-1/0,c=-1/0;for(const d of i)e=Math.min(e,d.x),n=Math.min(n,d.y),o=Math.max(o,d.x),c=Math.max(c,d.y);return{min:new Wt(e,n),max:new Wt(o,c)}},r.ay=Ce,r.az=me,r.b=function(i){return Ds.API_FONTS_REGEX.test(i)},r.b$=function(i,e,n){n*=.5;var o=e[0],c=e[1],d=e[2],p=e[3],x=Math.sin(n),T=Math.cos(n);return i[0]=o*T+c*x,i[1]=c*T-o*x,i[2]=d*T+p*x,i[3]=p*T-d*x,i},r.b0=ch,r.b1=$_,r.b2=function(){Ra.isLoading()||Ra.isLoaded()||kl()!=="deferred"||Kd()},r.b3=ed,r.b4=Xt,r.b5=um,r.b6=Ii,r.b7=Lv,r.b8=bv,r.b9=tn,r.bA=function(i,e){const{x:n,y:o}=i.point,c=ui(n,o,i.worldSize/i._pixelsPerMercatorPixel,0,0);return me(c,c,vt(ot(e)))},r.bB=U,r.bC=function(i){return i[0]=0,i[1]=0,i[2]=0,i},r.bD=function(i,e){return Math.hypot(e[0]-i[0],e[1]-i[1],e[2]-i[2])},r.bE=lt,r.bF=ti,r.bG=An,r.bH=pg,r.bI=Fa,r.bJ=qv,r.bK=function(i,e,n,o,c){const d=5*e+2;i.float32[d+0]=n,i.float32[d+1]=o,i.float32[d+2]=c},r.bL=U_,r.bM=E_,r.bN=Oo,r.bO=to,r.bP=Bb,r.bQ=Hw,r.bR=qb,r.bS=Hb,r.bT=Vv,r.bU=cw,r.bV=Gv,r.bW=xx,r.bX=Je,r.bY=qt,r.bZ=zi,r.b_=sr,r.ba=ll,r.bb=Vs,r.bc=A,r.bd=Qi,r.be=Ym,r.bf=Jv,r.bg=function(i,e){const n=pi(e.zoom);if(n===0)return ot(i);const o=dn(i),c=jn(o),d=Te(o.getWest())*e.worldSize,p=Te(o.getEast())*e.worldSize,x=ve(o.getNorth())*e.worldSize,T=ve(o.getSouth())*e.worldSize,S=[d,x,0],P=[p,x,0],k=[d,T,0],R=[p,T,0],B=Se([],e.globeMatrix);return bn(S,S,B),bn(P,P,B),bn(k,k,B),bn(R,R,B),c[0]=Bt(c[0],k,n),c[1]=Bt(c[1],R,n),c[2]=Bt(c[2],P,n),c[3]=Bt(c[3],S,n),Pi.fromPoints(c)},r.bh=It,r.bi=Se,r.bj=Kn,r.bk=Bt,r.bl=rh,r.bm=y,r.bn=Ee,r.bo=Re,r.bp=ay,r.bq=k_,r.br=Ih,r.bs=function(i,e){const n=[];for(const o in i)o in e||n.push(o);return n},r.bt=Ue,r.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.bv=Ha,r.bw=function(i){var e=new V(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},r.bx=ne,r.by=Oe,r.bz=se,r.c=Sd,r.c$=A_,r.c0=Ss,r.c1=Lr,r.c2=function(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i},r.c3=$e,r.c4=function(i,e,n,o,c){var d,p=1/Math.tan(e/2);return i[0]=p/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=p,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,c!=null&&c!==1/0?(i[10]=(c+o)*(d=1/(o-c)),i[14]=2*c*o*d):(i[10]=-1,i[14]=-2*o),i},r.c5=function(i,e,n,o,c,d,p){var x=1/(e-n),T=1/(o-c),S=1/(d-p);return i[0]=-2*x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*T,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*S,i[11]=0,i[12]=(e+n)*x,i[13]=(c+o)*T,i[14]=(p+d)*S,i[15]=1,i},r.c6=Pe,r.c7=function(i,e,n){i[4*e+0]=n[0],i[4*e+1]=n[1],i[4*e+2]=n[2],i[4*e+3]=n[3]},r.c8=fu,r.c9=Fn,r.cA=X_,r.cB=Ge,r.cC=Fw,r.cD=function(i){const e=Fw(i,!0);return U([],[e[0],e[1],e[4],e[5]])},r.cE=ye,r.cF=Ni,r.cG=Le,r.cH=function(i){const{x:e,y:n}=i.point,{lng:o,lat:c}=i._center;return ui(e,n,i.worldSize,o,c)},r.cI=Ut,r.cJ=it,r.cK=Ac,r.cL=E,r.cM=function(i,e,n){let o=0;for(let c=0;c<2;++c)i[c]>0&&(o+=(i[c]-0)*(i[c]-0)),e[c]<0&&(o+=(0-e[c])*(0-e[c]));return o},r.cN=function(i){return i*i*i*i*i},r.cO=Ie,r.cP=45,r.cQ=Bl,r.cR=function(i,e,n){const o=Math.sqrt(i*i+e*e+n*n),c=o>0?Math.acos(n/o)*Rc:0;let d=i!==0||e!==0?Math.atan2(-e,-i)*Rc+90:0;return d<0&&(d+=360),[o,d,c]},r.cS=xt,r.cT=pr,r.cU=st,r.cV=At,r.cW=Pi,r.cX=Ct,r.cY=function(i){return[Math.pow(i[0],1/2.2),Math.pow(i[1],1/2.2),Math.pow(i[2],1/2.2)]},r.cZ=ox,r.c_=function(i,e){return i.readFields(yk,{icons:[]},e)},r.ca=Ui,r.cb=ul,r.cc=hh,r.cd=re,r.ce=bw,r.cf=function(){var i=new V(4);return V!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i},r.cg=function(i,e,n){var o=e[0],c=e[1],d=e[2],p=e[3],x=Math.sin(n),T=Math.cos(n);return i[0]=o*T+d*x,i[1]=c*T+p*x,i[2]=o*-x+d*T,i[3]=c*-x+p*T,i},r.ch=function(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]},r.ci=Yi,r.cj=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},r.ck=ci,r.cl=Ci,r.cm=af,r.cn=fr,r.co=jw,r.cp=md,r.cq=gn,r.cr=function(i,e,n,o,c,d,p,x,T){if(T.name==="globe")return gn(i,e,new md(n,o,c),!1);const S=gg({z:n,x:o,y:c},T);return new Pi([(d+S.x/S.scale)*e,e*(S.y/S.scale),p],[(d+S.x2/S.scale)*e,e*(S.y2/S.scale),x])},r.cs=function(i,e,n){return i[0]=Math.min(e[0],n[0]),i[1]=Math.min(e[1],n[1]),i[2]=Math.min(e[2],n[2]),i[3]=Math.min(e[3],n[3]),i},r.ct=function(i,e,n){return i[0]=Math.max(e[0],n[0]),i[1]=Math.max(e[1],n[1]),i[2]=Math.max(e[2],n[2]),i[3]=Math.max(e[3],n[3]),i},r.cu=function(i){const e=Math.round((i+45+360)%360/90)%4;return te[e]},r.cv=ft,r.cw=Gr,r.cx=I,r.cy=function(i){const e=ne(new Float64Array(16));me(e,i.pixelMatrix,i.globeMatrix);const n=[0,F,0],o=[0,q,0];return bn(n,n,e),bn(o,o,e),[n[0]>0&&n[0]<=i.width&&n[1]>0&&n[1]<=i.height&&!Ri(i,new re(i.center.lat,90)),o[0]>0&&o[0]<=i.width&&o[1]>0&&o[1]<=i.height&&!Ri(i,new re(i.center.lat,-90))]},r.cz=function(i,e){const{scale:n}=i.tileTransform,o=n*Kt/(i.tileSize*Math.pow(2,e.zoom-i.tileID.overscaledZ+i.tileID.canonical.z));return function(c,d,p){var x=d[1],T=d[2],S=d[3],P=p[0],k=p[1];return c[0]=d[0]*P,c[1]=x*P,c[2]=T*k,c[3]=S*k,c}(new Float32Array(4),e.inverseAdjustmentMatrix,[o,o])},r.d=function(i){return Ds.API_TILEJSON_REGEX.test(i)},r.d$=lp,r.d0=nm,r.d1=Uv,r.d2=Ah,r.d3=wc,r.d4=po,r.d5=jc,r.d6=Ln,r.d7=function(i){const e=i.indexOf(Sc);return e>=0?i.slice(0,e):i},r.d8=function(i){return i.indexOf(Sc)>=0},r.d9=function(i){const e=i.lastIndexOf(Sc);return e>=0?i.slice(e+1):""},r.dA=Tn,r.dB=ls,r.dC=so,r.dD=256,r.dE=function(i,e){const n=[0,0,0];return bn(n,n,It(ot(e.canonical))),bn(n,n,i),n},r.dF=i=>({u_matrix:new hh(i),u_texsize:new ul(i),u_pixels_to_tile_units:new gu(i),u_device_pixel_ratio:new Ui(i),u_width_scale:new Ui(i),u_floor_width_scale:new Ui(i),u_image:new fu(i),u_units_to_pixels:new ul(i),u_tile_units_to_pixels:new Ui(i),u_alpha_discard_threshold:new Ui(i),u_trim_offset:new ul(i),u_trim_fade_range:new ul(i),u_trim_color:new Bl(i),u_emissive_strength:new Ui(i),u_zbias_factor:new Ui(i),u_tile_to_meter:new Ui(i),u_ground_shadow_factor:new Fn(i),u_pattern_transition:new Ui(i)}),r.dG=i=>({u_matrix:new hh(i),u_pixels_to_tile_units:new gu(i),u_device_pixel_ratio:new Ui(i),u_width_scale:new Ui(i),u_floor_width_scale:new Ui(i),u_units_to_pixels:new ul(i),u_dash_image:new fu(i),u_gradient_image:new fu(i),u_image_height:new Ui(i),u_texsize:new ul(i),u_tile_units_to_pixels:new Ui(i),u_alpha_discard_threshold:new Ui(i),u_trim_offset:new ul(i),u_trim_fade_range:new ul(i),u_trim_color:new Bl(i),u_emissive_strength:new Ui(i),u_zbias_factor:new Ui(i),u_tile_to_meter:new Ui(i),u_ground_shadow_factor:new Fn(i)}),r.dH=i=>({u_camera_to_center_distance:new Ui(i),u_extrude_scale:new gu(i),u_device_pixel_ratio:new Ui(i),u_matrix:new hh(i),u_inv_rot_matrix:new hh(i),u_merc_center:new ul(i),u_tile_id:new Fn(i),u_zoom_transition:new Ui(i),u_up_dir:new Fn(i),u_emissive_strength:new Ui(i)}),r.dI=sd,r.dJ=wP,r.dK=ub,r.dL=(i,e,n,o,c,d)=>{const p=i.transform,x=p.projection.name==="globe";let T;if(d.paint.get("circle-pitch-alignment")==="map")if(x){const P=Tn(p.zoom,e.canonical)*p._pixelsPerMercatorPixel;T=Float32Array.from([P,0,0,P])}else T=p.calculatePixelsToTileUnitsMatrix(n);else T=new Float32Array([p.pixelsToGLUnits[0],0,0,p.pixelsToGLUnits[1]]);const S={u_camera_to_center_distance:i.transform.getCameraToCenterDistance(p.projection),u_matrix:i.translatePosMatrix(e.projMatrix,n,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:fa.devicePixelRatio,u_extrude_scale:T,u_inv_rot_matrix:pv,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(x){S.u_inv_rot_matrix=o,S.u_merc_center=c,S.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],S.u_zoom_transition=pi(p.zoom);const P=c[0]*Kt,k=c[1]*Kt;S.u_up_dir=p.projection.upVector(new md(0,0,0),P,k)}return S},r.dM=R1,r.dN=Po,r.dO=(i,e,n,o,c,d,p,x,T,S)=>{const P=i.transform,k=P.pitch<15?P1(.07,.7,Ce((14-P.zoom)/5,0,1)):.07,R=n.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:M1(i,e,n,o),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:P.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:c,u_width_scale:d,u_floor_width_scale:p,u_image:0,u_tile_units_to_pixels:k1(e,P),u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:x,u_trim_fade_range:n.paint.get("line-trim-fade-range"),u_trim_color:n.paint.get("line-trim-color").toPremultipliedRenderColor(R?null:n.lut).toArray01(),u_emissive_strength:n.paint.get("line-emissive-strength"),u_zbias_factor:k,u_tile_to_meter:st(e.tileID.canonical,0),u_ground_shadow_factor:T,u_pattern_transition:S}},r.dP=(i,e,n,o,c,d,p,x,T,S)=>{const P=i.transform,k=P.calculatePixelsToTileUnitsMatrix(e),R=n.paint.get("line-trim-color-use-theme").constantOr("default")==="none",B=P.pitch<15?P1(.07,.7,Ce((14-P.zoom)/5,0,1)):.07;return{u_matrix:M1(i,e,n,o),u_pixels_to_tile_units:k,u_device_pixel_ratio:d,u_width_scale:p,u_floor_width_scale:x,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:c,u_texsize:z1(n)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:k1(e,i.transform),u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:n.paint.get("line-trim-fade-range"),u_trim_color:n.paint.get("line-trim-color").toPremultipliedRenderColor(R?null:n.lut).toArray01(),u_emissive_strength:n.paint.get("line-emissive-strength"),u_zbias_factor:B,u_tile_to_meter:st(e.tileID.canonical,0),u_ground_shadow_factor:S}},r.dQ=Gt,r.dR=Xm,r.dS=Qe,r.dT=dv,r.dU=C_,r.dV=n1,r.dW=_p,r.dX=450,r.dY=7,r.dZ=ik,r.d_=xi,r.da=function(i){const e=[],n=i.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},r.db=function(i,e,n,o){return i.type==="custom"?new rk(i,e):new gk[i.type](i,e,n,o)},r.dc=Rn,r.dd=function(i){const e=i.indexOf(Sc);return e>=0?i.slice(e+1):""},r.de=class extends um{constructor(i,e){super(i._vectorTileFeature,i._z,i._x,i._y,i.id),i.state&&(this.state=Object.assign({},i.state)),this.target=e.target,this.namespace=e.namespace,e.properties&&(this.properties=e.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=i.source,this.sourceLayer=i.sourceLayer,this.layer=i.layer)}toJSON(){const i=super.toJSON();return i.target=this.target,i.namespace=this.namespace,i}},r.df=ts,r.dg=Ua,r.dh=function(i){return i({pluginStatus:Js,pluginURL:Xo}),ts.on("pluginStateChange",i),i},r.di=dp,r.dj=class extends Ol{constructor(i){super(i),this.current=mu}set(i,e,n){if(this.fetchUniformLocation(i,e)){for(let o=0;o<9;o++)if(n[o]!==this.current[o]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}}},r.dk=oe,r.dl=function(i,e,n){const o=pi(n.zoom),c=i.style.map._antialias,d=i.terrain&&i.terrain.exaggeration()>0;return o===0&&!c&&!d},r.dm=function(i){const e=i.pixelsPerMeter,n=e/Pe(1,i.center.lat),o=ne(new Float64Array(16));return Re(o,o,[i.point.x,i.point.y,0]),ye(o,o,[n,n,e]),Float32Array.from(o)},r.dn=dn,r.dp=function(i){const e=ft-5;i=Ce(i,-80.051129,e)/e*90;const n=Math.pow(Math.abs(Math.sin(Ei(i))),3);return Math.round(n*(N.length-1))},r.dq=function(i,e,n,o){const c=e.getNorth(),d=e.getSouth(),p=e.getWest(),x=e.getEast(),T=1<<i.z,S=x-p,P=c-d,k=S/L,R=-P/N[n],B=[0,k,0,R,0,0,c,p,0];if(i.z>0){const j=180/o;de(B,B,[j/S+1,0,0,0,j/P+1,0,-.5*j/k,.5*j/R,1])}return B[2]=T,B[5]=i.x,B[8]=i.y,B},r.dr=ot,r.ds=function(i,e,n){const o=ne(new Float64Array(16)),c=(e/(1<<i)-.5)*Math.PI*2;return De(o,n.globeMatrix,c),Float32Array.from(o)},r.dt=class{isDataAvailableAtPoint(i){const e=this._source();if(this.isUsingMockSource()||!e||i.y<0||i.y>1)return!1;const n=e.getSource().maxzoom,o=1<<n,c=Math.floor(i.x),d=Math.floor((i.x-c)*o),p=Math.floor(i.y*o),x=this.findDEMTileFor(new bo(n,c,n,d,p));return!(!x||!x.dem)}getAtPointOrZero(i,e=0){return this.getAtPoint(i,e)||0}getAtPoint(i,e,n=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const o=this._source();if(!o||i.y<0||i.y>1)return e;const c=o.getSource().maxzoom,d=1<<c,p=Math.floor(i.x),x=i.x-p,T=new bo(c,p,c,Math.floor(x*d),Math.floor(i.y*d)),S=this.findDEMTileFor(T);if(!S||!S.dem)return e;const P=S.dem,k=1<<S.tileID.canonical.z,R=(x*k-S.tileID.canonical.x)*P.dim,B=(i.y*k-S.tileID.canonical.y)*P.dim,j=Math.floor(R),$=Math.floor(B);return(n?this.exaggeration():1)*Cn(Cn(P.get(j,$),P.get(j,$+1),B-$),Cn(P.get(j+1,$),P.get(j+1,$+1),B-$),R-j)}getAtTileOffset(i,e,n){const o=1<<i.canonical.z;return this.getAtPointOrZero(new Ve(i.wrap+(i.canonical.x+e/Kt)/o,(i.canonical.y+n/Kt)/o))}getAtTileOffsetFunc(i,e,n,o){return c=>{const d=this.getAtTileOffset(i,c.x,c.y),p=o.upVector(i.canonical,c.x,c.y);return qt(p,p,d*o.upVectorScale(i.canonical,e,n).metersToTile),p}}getForTilePoints(i,e,n,o){if(this.isUsingMockSource())return!1;const c=om.create(this,i,o);return!!c&&(e.forEach(d=>{d[2]=this.exaggeration()*c.getElevationAt(d[0],d[1],n)}),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(i);if(!e||!e.dem)return null;const n=e.dem.tree,o=e.tileID,c=1<<i.canonical.z-o.canonical.z;let d=i.canonical.x/c-o.canonical.x,p=i.canonical.y/c-o.canonical.y,x=0;for(let T=0;T<i.canonical.z-o.canonical.z&&!n.leaves[x];T++){d*=2,p*=2;const S=2*Math.floor(p)+Math.floor(d);x=n.childOffsets[x]+S,d%=1,p%=1}return{min:this.exaggeration()*n.minimums[x],max:this.exaggeration()*n.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const i=this.visibleDemTiles;if(i.length===0)return null;let e=!1,n=Number.MAX_VALUE,o=Number.MIN_VALUE;for(const c of i){const d=this.getMinMaxForTile(c.tileID);d&&(n=Math.min(n,d.min),o=Math.max(o,d.max),e=!0)}return e?{min:n,max:o}:null}},r.du=xb,r.dv=D,r.dw=function(i,e){return[Math.pow(i[0],2.2)*e,Math.pow(i[1],2.2)*e,Math.pow(i[2],2.2)*e]},r.dx=Z,r.dy=function(i,e){var n=Math.sin(e),o=Math.cos(e);return i[0]=o,i[1]=n,i[2]=0,i[3]=-n,i[4]=o,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},r.dz=Zi,r.e=Ds,r.e$=zT,r.e0=256,r.e1=vt,r.e2=La,r.e3=De,r.e4=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i},r.e5=Dl,r.e6=ah,r.e7=el,r.e8=function(i,e,n,o,c){return Ce((i-e)/(n-e)*(c-o)+o,o,c)},r.e9=as,r.eA=function(i,e,n){return i[0]=e[0]/n[0],i[1]=e[1]/n[1],i[2]=e[2]/n[2],i},r.eB=ki,r.eC=G,r.eD=Nn,r.eE=function(i,e,n,o){return i[0]=e,i[1]=n,i[2]=o,i},r.eF=function([i,e,n]){const o=Math.hypot(i,e,n),c=Math.atan2(i,n),d=.5*Math.PI-Math.acos(-e/o);return new re(it(c),it(d))},r.eG=ys,r.eH=rx,r.eI=function(i){const e=i.navigator?i.navigator.userAgent:null;return!!function(n){if(kr==null){const o=n.navigator?n.navigator.userAgent:null;kr=!!n.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return kr}(i)&&!(!e||!(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},r.eJ=function(i,e){ia=i,ar=e},r.eK=Ri,r.eL=bi,r.eM=function(i){const e=[0,0,0],n=ne(new Float64Array(16));return me(n,i.pixelMatrix,i.globeMatrix),bn(e,e,n),new Wt(e[0],e[1])},r.eN=function(){const i=ag;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(Iv),ag=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},r.eO=function(){A_().acquire(Iv)},r.eP=kl,r.eQ=function(i,e,n=!1){if(Js===Qs.deferred||Js===Qs.loading||Js===Qs.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Xo=fa.resolveURL(i),Js=Qs.deferred,Pl=e,th(),n||Kd()},r.eR=function(i){Qf=fa.resolveURL(i),Jf||(Jf=new Yf(A_(),new sc)),Jf.broadcast("setMeshoptUrl",Qf)},r.eS=m1,r.eT=function(i){kv=fa.resolveURL(i),Jf||(Jf=new Yf(A_(),new sc)),Jf.broadcast("setDracoUrl",kv)},r.eU=f1,r.eV=og,r.eW=function(i){const e=ec();if(!e)return;const n=e.delete(_l);i&&n.then(()=>i()).catch(i)},r.eX=hf,r.eY=nn,r.eZ=gp,r.e_=xu,r.ea=function(i,e){var n=e[0],o=e[1],c=e[2],d=e[3],p=e[4],x=e[5],T=e[6],S=e[7],P=e[8],k=P*p-x*S,R=-P*d+x*T,B=S*d-p*T,j=n*k+o*R+c*B;return j?(i[0]=k*(j=1/j),i[1]=(-P*o+c*S)*j,i[2]=(x*o-c*p)*j,i[3]=R*j,i[4]=(P*n-c*T)*j,i[5]=(-x*n+c*d)*j,i[6]=B*j,i[7]=(-S*n+o*T)*j,i[8]=(p*n-o*d)*j,i):null},r.eb=zn,r.ec=Et,r.ed=sx,r.ee=function(i,e){if(i===e){var n=e[1],o=e[2],c=e[3],d=e[6],p=e[7],x=e[11];i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=n,i[6]=e[9],i[7]=e[13],i[8]=o,i[9]=d,i[11]=e[14],i[12]=c,i[13]=p,i[14]=x}else i[0]=e[0],i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=e[1],i[5]=e[5],i[6]=e[9],i[7]=e[13],i[8]=e[2],i[9]=e[6],i[10]=e[10],i[11]=e[14],i[12]=e[3],i[13]=e[7],i[14]=e[11],i[15]=e[15];return i},r.ef=et,r.eg=[1,1,1],r.eh=class{constructor(i,e,n,o){this.context=i,this.format=o,this.size=n,this.texture=i.gl.createTexture();const[c,d,p]=this.size,{gl:x}=i;x.bindTexture(x.TEXTURE_3D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(!1),x.texImage3D(x.TEXTURE_3D,0,this.format,c,d,p,0,ex(this.format),tx(this.format),e.data)}bind(i,e){const{context:n}=this,{gl:o}=n;o.bindTexture(o.TEXTURE_3D,this.texture),i!==this.minFilter&&(o.texParameteri(o.TEXTURE_3D,o.TEXTURE_MAG_FILTER,i),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_MIN_FILTER,i),this.minFilter=i),e!==this.wrapS&&(o.texParameteri(o.TEXTURE_3D,o.TEXTURE_WRAP_S,e),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_WRAP_T,e),this.wrapS=e)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}},r.ei=om,r.ej=function(i,e,n,o){var c=new V(4);return c[0]=i,c[1]=e,c[2]=n,c[3]=o,c},r.ek=Pr,r.el=function(i,e,n,o){var c=e[0],d=e[1],p=e[2],x=e[3];return i[0]=c+o*(n[0]-c),i[1]=d+o*(n[1]-d),i[2]=p+o*(n[2]-p),i[3]=x+o*(n[3]-x),i},r.em=sm,r.en=Ll,r.eo=uu,r.ep=function(i,e,n,o,c,d,p,x,T,S,P,k,R,B,j,$){var K=new V(16);return K[0]=i,K[1]=e,K[2]=n,K[3]=o,K[4]=c,K[5]=d,K[6]=p,K[7]=x,K[8]=T,K[9]=S,K[10]=P,K[11]=k,K[12]=R,K[13]=B,K[14]=j,K[15]=$,K},r.eq=Y,r.er=od,r.es=ap,r.et=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Wt(1/0,1/0),max:new Wt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(i,e=!1){const n=jb(new Wt(0,0),new Wt(Kt,Kt),i),o=[];if(e&&!Tv(n,this._globalClipBounds))return o;for(const c of this._activeRegions){if(c.hiddenByOverlap||!Tv(n,c))continue;const d=jI(c.min,c.max,i);o.push({min:d.min,max:d.max,sourceId:this._sourceIds[c.priority],footprint:c.footprint,footprintTileId:c.tileId,order:c.order,clipMask:c.clipMask,clipScope:c.clipScope})}return o}setSources(i){this._setSources(i.map(e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{const n=[];for(const o of e.cache.getVisibleCoordinates()){const c=e.cache.getTile(o).buckets[e.layer];c&&c.updateFootprints(o.toUnwrapped(),n)}return n},getOrder:()=>e.order,getClipMask:()=>e.clipMask,getClipScope:()=>e.clipScope})))}_addSource(i){const e=i.getFootprints();if(e.length===0)return;const n=i.getOrder(),o=i.getClipMask(),c=i.getClipScope();for(const d of e){if(!d.footprint)continue;const p=jb(d.footprint.min,d.footprint.max,d.id);this._activeRegions.push({min:p.min,max:p.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:d.id,footprint:d.footprint,order:n,clipMask:o,clipScope:c})}this._sourceIds.push(i.getSourceId())}_computeReplacement(){this._activeRegions.sort((e,n)=>e.priority-n.priority||T_(e.min,n.min)||T_(e.max,n.max)||e.order-n.order||e.clipMask-n.clipMask||function(o,c){const d=(p,x)=>p+x;return o.length-c.length||o.reduce(d,"").localeCompare(c.reduce(d,""))}(e.clipScope,n.clipScope));let i=this._activeRegions.length!==this._prevRegions.length;if(!i){let e=0;for(;!i&&e!==this._activeRegions.length;){const n=this._activeRegions[e],o=this._prevRegions[e];i=n.priority!==o.priority||!Fb(n,o)||n.order!==o.order||n.clipMask!==o.clipMask||!Ha(n.clipScope,o.clipScope),++e}}if(i){++this._updateTime;for(const n of this._activeRegions)n.order!==w_&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,n.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,n.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,n.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,n.max.y));const e=n=>{const o=this._activeRegions;if(n>=o.length)return n;const c=o[n].priority;for(;n<o.length&&o[n].priority===c;)++n;return n};if(this._sourceIds.length>1){let n=0,o=e(n);for(;n!==o;){let c=n;const d=n;for(;c!==o;){const p=this._activeRegions[c];p.hiddenByOverlap=!1;for(let x=0;x<d;x++){const T=this._activeRegions[x];if(!T.hiddenByOverlap&&p.order===w_&&Tv(p,T)&&(p.hiddenByOverlap=Vb(p.footprint,p.tileId,T.footprint,T.tileId),p.hiddenByOverlap))break}++c}n=o,o=e(n)}}}}_setSources(i){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=i.length-1;e>=0;e--)this._addSource(i[e]);this._computeReplacement()}},r.eu=w_,r.ev=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy()}_fillGridMeshWithLods(i,e){const n=new ll,o=new ws,c=[],d=i+1+2,p=e[0]+1,x=e[0]+1+(1+e.length),T=(S,P,k)=>{let R=S===d-1?S-2:S===0?S:S-1;return R+=k?24575:0,[R,P]};for(let S=0;S<d;++S)n.emplaceBack(...T(S,0,!0));for(let S=0;S<p;++S)for(let P=0;P<d;++P)n.emplaceBack(...T(P,S,(P===0||P===d-1)&&!0));for(let S=0;S<e.length;++S){const P=e[S];for(let k=0;k<d;++k)n.emplaceBack(...T(k,P,!0))}for(let S=0;S<e.length;++S){const P=o.length,k=e[S]+1+2,R=new ws;for(let $=0;$<k-1;$++){const K=$===k-2,ee=K?d*(x-e.length+S-$):d;for(let le=0;le<d-1;le++){const ce=$*d+le;$===0||K||le===0||le===d-2?(R.emplaceBack(ce+1,ce,ce+ee),R.emplaceBack(ce+ee,ce+ee+1,ce+1)):(o.emplaceBack(ce+1,ce,ce+ee),o.emplaceBack(ce+ee,ce+ee+1,ce+1))}}const B=Qi.simpleSegment(0,P,n.length,o.length-P);for(let $=0;$<R.uint16.length;$+=3)o.emplaceBack(R.uint16[$],R.uint16[$+1],R.uint16[$+2]);const j=Qi.simpleSegment(0,P,n.length,o.length-P);c.push({withoutSkirts:B,withSkirts:j})}return{vertices:n,indices:o,segments:c}}_createGrid(i){const e=this._fillGridMeshWithLods(L,N);this._gridSegments=e.segments,this._gridBuffer=i.createVertexBuffer(e.vertices,A.members),this._gridIndexBuffer=i.createIndexBuffer(e.indices,!0)}_createPoles(i){const e=new ws;for(let p=0;p<=L;p++)e.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=i.createIndexBuffer(e,!0);const n=new Dl,o=new Dl,c=new Dl,d=new Dl;this._poleSegments=[];for(let p=0,x=0;p<E;p++){const T=360/(1<<p);n.emplaceBack(0,-b,0,.5,0),o.emplaceBack(0,-b,0,.5,1),c.emplaceBack(0,-b,0,.5,.5),d.emplaceBack(0,-b,0,.5,.5);for(let S=0;S<=L;S++){let P=S/L,k=0;const R=Cn(0,T,P),[B,j,$]=X(Nr,ph,R,b);n.emplaceBack(B,j,$,P,k),o.emplaceBack(B,j,$,P,1-k);const K=Ei(R);P=.5+.5*Math.sin(K),k=.5+.5*Math.cos(K),c.emplaceBack(B,j,$,P,k),d.emplaceBack(B,j,$,P,1-k)}this._poleSegments.push(Qi.simpleSegment(x,0,66,64)),x+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(n,f,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(o,f,!1),this._texturedPoleNorthVertexBuffer=i.createVertexBuffer(c,f,!1),this._texturedPoleSouthVertexBuffer=i.createVertexBuffer(d,f,!1)}getGridBuffers(i,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}},r.ew=xe,r.ex=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},r.ey=ze,r.ez=Ke,r.f=function(i){return btoa(encodeURIComponent(i).replace(/%([0-9A-F]{2})/g,(e,n)=>String.fromCharCode(+("0x"+n))))},r.f0=LT,r.f1=C1,r.f2=si,r.f3="hd_road_elevation",r.f4=ha,r.f5=hn,r.f6=cf,r.f7=Hv,r.f8=df,r.f9=function(i,e,n,o,c,d,p,x=1,T,S,P){i.createArrays(),i.tilePixelRatio=Kt/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const k=i.layers[0].layout,R=i.layers[0]._unevaluatedLayout._values,B={};B.scaleFactor=x,B.textSizeScaleRange=k.get("text-size-scale-range"),B.iconSizeScaleRange=k.get("icon-size-scale-range");const[j,$]=B.textSizeScaleRange,[K,ee]=B.iconSizeScaleRange;B.textScaleFactor=Ce(B.scaleFactor,j,$),B.iconScaleFactor=Ce(B.scaleFactor,K,ee);const le=R["text-size"],ce=R["icon-size"];if(i.textSizeData.kind==="composite"){const{minZoom:ke,maxZoom:je}=i.textSizeData;B.compositeTextSizes=[le.possiblyEvaluate(new ji(ke,{worldview:P}),d),le.possiblyEvaluate(new ji(je,{worldview:P}),d)]}if(i.iconSizeData.kind==="composite"){const{minZoom:ke,maxZoom:je}=i.iconSizeData;B.compositeIconSizes=[ce.possiblyEvaluate(new ji(ke,{worldview:P}),d),ce.possiblyEvaluate(new ji(je,{worldview:P}),d)]}B.layoutTextSize=le.possiblyEvaluate(new ji(p+1,{worldview:P}),d),B.layoutIconSize=ce.possiblyEvaluate(new ji(p+1,{worldview:P}),d),B.textMaxSize=le.possiblyEvaluate(new ji(18,{worldview:P}),d);const W=k.get("symbol-placement"),ae=k.get("text-rotation-alignment")==="map"&&W!=="point",he=k.get("text-size");let ge=!1;const Be=[];for(const ke of i.features){const je=k.get("text-font").evaluate(ke,{},d).join(","),Ze=he.evaluate(ke,{},d)*B.textScaleFactor,ut=B.layoutTextSize.evaluate(ke,{},d)*B.textScaleFactor,Rt=B.layoutIconSize.evaluate(ke,{},d)*B.iconScaleFactor,wt={horizontal:{},vertical:void 0},Mt=ke.text;let Dt,dt=[0,0];if(Mt){const Mn=Mt.toString(),Xn=k.get("text-letter-spacing").evaluate(ke,{},d)*to,Gn=k.get("text-line-height").evaluate(ke,{},d)*to,ai=bc(Mn)?Xn:0,Qn=k.get("text-anchor").evaluate(ke,{},d),li=k.get("text-variable-anchor");if(!li){const gt=k.get("text-radial-offset").evaluate(ke,{},d);if(gt)dt=cw(Qn,[gt*to,$v]);else{const $t=k.get("text-offset").evaluate(ke,{},d);dt=[$t[0]*to,$t[1]*to]}}let Vi=ae?"center":k.get("text-justify").evaluate(ke,{},d);const mr=W==="point",fe=mr?k.get("text-max-width").evaluate(ke,{},d)*to:1/0,we=gt=>{i.allowVerticalPlacement&&la(Mn)&&(wt.vertical=Nv(Mt,e,n,c,je,fe,Gn,Qn,gt,ai,dt,Fa.vertical,!0,ut,Ze,T))};if(!ae&&li){const gt=Vi==="auto"?li.map(en=>Gv(en)):[Vi];let $t=!1;for(let en=0;en<gt.length;en++){const Qt=gt[en];if(!wt.horizontal[Qt])if($t)wt.horizontal[Qt]=wt.horizontal[0];else{const on=Nv(Mt,e,n,c,je,fe,Gn,"center",Qt,ai,dt,Fa.horizontal,!1,ut,Ze,T);on&&(wt.horizontal[Qt]=on,$t=on.positionedLines.length===1)}}we("left")}else{if(Vi==="auto"&&(Vi=Gv(Qn)),mr||k.get("text-writing-mode").indexOf("horizontal")>=0||!la(Mn)){const gt=Nv(Mt,e,n,c,je,fe,Gn,Qn,Vi,ai,dt,Fa.horizontal,!1,ut,Ze,T);gt&&(wt.horizontal[Vi]=gt)}we(mr?"left":Vi)}}let Pt,ct,ht,Nt,Vt,yn,cn=!1;const Jt=k.get("icon-text-fit").evaluate(ke,{},d);if(ke.icon&&ke.icon.hasPrimary()){const Mn=hw(ke.icon,i.iconSizeData,R["icon-size"],d,i.zoom,ke,T,B.iconScaleFactor,P);Pt=Mn.iconPrimary,ht=Mn.iconSecondary;const Xn=Pt.toString();if(ct=o.get(Xn),ct&&(Vt=k.get("icon-offset").evaluate(ke,{},d),yn=k.get("icon-anchor").evaluate(ke,{},d),Dt=zP(c.get(Xn),ht?c.get(ht.toString()):void 0,Vt,yn),cn=ct.sdf,i.sdfIcons===void 0?i.sdfIcons=ct.sdf:i.sdfIcons!==ct.sdf&&Un("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ct.pixelRatio!==i.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0)),ht){const Gn=ht.toString();Nt=o.get(Gn)}}ge=ge||!(!ke.icon||!ke.icon.hasSecondary());const Ft=Wv(wt.horizontal)||wt.vertical;i.iconsInText||(i.iconsInText=!!Ft&&Ft.iconsInText);const Bn=ut*B.textScaleFactor/to,{defaultShapedIcon:ln,verticallyShapedIcon:un}=HP(i,Dt,k,ke,d,wt,Bn,Vt,Jt);Jt!=="none"&&Dt&&(W1(Dt)||Z1(Dt))&&(O_(0,ct,Pt,Dt,ln,Jt,S,o,c),O_(0,Nt,ht,Dt,ln,Jt,S,o,c),un&&(O_(0,ct,Pt,Dt,un,Jt,S,o,c),O_(0,Nt,ht,Dt,un,Jt,S,o,c))),Dt=ln,Be.push({feature:ke,shapedTextOrientations:wt,shapedText:Ft,shapedIcon:Dt,iconPrimary:Pt,iconSecondary:ht,iconOffset:Vt,iconAnchor:yn,verticallyShapedIcon:un,layoutTextSize:ut,layoutIconSize:Rt,textOffset:dt,isSDFIcon:cn,iconTextFit:Jt})}return{featureData:Be,sizes:B,hasAnySecondaryIcon:ge,textAlongLine:ae,symbolPlacement:W}},r.fa=iw,r.fb=function(i,e,n,o,c,d,p,x,T,S){const{featureData:P,hasAnySecondaryIcon:k,sizes:R,textAlongLine:B,symbolPlacement:j}=e;for(const $ of P){const{shapedIcon:K,verticallyShapedIcon:ee,feature:le,shapedTextOrientations:ce,shapedText:W,layoutTextSize:ae,textOffset:he,isSDFIcon:ge,iconPrimary:Be,iconSecondary:ke,iconTextFit:je,iconOffset:Ze}=$;dw(K,S.iconPositions,Be,ke),dw(ee,S.iconPositions,Be,ke),qP(ce,S.iconPositions),VP(Be,ke,S.iconPositions),(W||K)&&UP(i,le,ce,K,ee,T,R,ae,0,he,ge,o,c,p,x,k,je,Ze,B,j)}n&&i.generateCollisionDebugBuffers(d,i.collisionBoxArray,R.textScaleFactor)},r.fc=Zn,r.fd=oy,r.fe=Kl,r.ff=Dn,r.fg=j1,r.fh=qa,r.fi=function(i){let e=0;if(new Uint32Array(i,0,1)[0]!==_1){const n=new Uint32Array(i,0,7),[,,o,c,d,p]=n;e=n.byteLength+c+d+p+d,(o!==i.byteLength||e>=i.byteLength)&&Un("Invalid b3dm header information.")}return b1(i,e)},r.fj=function(i,e){const n=RT(i);for(const o of n){for(const c of o.meshes)pM(c);o.lights&&(o.lightMeshIndex=o.meshes.length,o.meshes.push(fM(o.lights,e)))}return n},r.fk=ey,r.fl=Li,r.fm=d1,r.fn=Ra,r.fo=Qs,r.fp=function(i){Oc(),Ea!=null&&Ea.then(e=>{e.keys().then(n=>{for(let o=0;o<n.length-i;o++)e.delete(n[o]).catch(c=>Un(c.message))}).catch(n=>Un(n.message))}).catch(e=>Un(e.message))},r.g=function(i,e){return Ua(tt(i,{method:"GET"}),e)},r.h=tt,r.i=function(i){return Ds.API_STYLE_REGEX.test(i)&&!Sd(i)},r.j=function(i){return i.indexOf("mapbox:")===0},r.k=Xl,r.l=Eh,r.m=function(i){return decodeURIComponent(atob(i).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""))},r.n=function(i,e){return Ua(tt(i,{type:"json"}),e)},r.o=Bc,r.p=function(i,e){return Ua(tt(i,{method:"POST"}),e)},r.q=fa,r.r=wo,r.s=function(i){try{const e=self[i];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}},r.t=Cu,r.u=function(){return function i(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()},r.v=function(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)},r.w=Un,r.x=function(){return Pv||(Pv=new hf),Pv},r.y=mx,r.z=Aa}),C(["./shared"],function(r){function O(it){const te=it?it.url.toString():void 0;return te?performance.getEntriesByName(te):[]}function V(it){if(typeof it=="number"||typeof it=="boolean"||typeof it=="string"||it==null)return JSON.stringify(it);if(Array.isArray(it)){let oe="[";for(const xe of it)oe+=`${V(xe)},`;return`${oe}]`}let te="{";for(const oe of Object.keys(it).sort())te+=`${oe}:${V(it[oe])},`;return`${te}}`}function U(it){let te="";for(const oe of r.bu)te+=`/${V(it[oe])}`;return te}class Z{constructor(te){this.keyCache={},this._layers={},this._layerConfigs={},te&&this.replace(te)}replace(te,oe){this._layerConfigs={},this._layers={},this.update(te,[],oe)}update(te,oe,xe){this._options=xe;for(const Ce of te)this._layerConfigs[Ce.id]=Ce,(this._layers[Ce.id]=r.db(Ce,this.scope,null,this._options)).compileFilter(xe),this.keyCache[Ce.id]&&delete this.keyCache[Ce.id];for(const Ce of oe)delete this.keyCache[Ce],delete this._layerConfigs[Ce],delete this._layers[Ce];this.familiesBySource={};const ze=function(Ce,He){const Je={};for(let tt=0;tt<Ce.length;tt++){const bt=Ce[tt];let rt=He&&He[bt.id];rt||(bt.type==="symbol"?rt=bt.id:(rt=U(bt),bt.type==="line"&&bt.paint&&function an(hn){return typeof hn=="string"&&hn==="line-progress"||(Array.isArray(hn)?hn.some(an):!(!hn||typeof hn!="object")&&Object.values(hn).some(an))}(bt.paint["line-width"])&&(rt+=`/${V(bt.paint["line-width"])}`))),He&&(He[bt.id]=rt);let Gt=Je[rt];Gt||(Gt=Je[rt]=[]),Gt.push(bt)}const Ue=[];for(const tt in Je)Ue.push(Je[tt]);return Ue}(Object.values(this._layerConfigs),this.keyCache);for(const Ce of ze){const He=Ce.map(Gt=>this._layers[Gt.id]),Je=He[0];if(Je.visibility==="none")continue;const Ue=Je.source||"";let tt=this.familiesBySource[Ue];tt||(tt=this.familiesBySource[Ue]={});const bt=Je.sourceLayer||"_geojsonTileLayer";let rt=tt[bt];rt||(rt=tt[bt]=[]),rt.push(He)}}}const ie=1*r.e_;class de{constructor(te){const oe={},xe=[];for(const Je in te){const Ue=te[Je],tt=oe[Je]={};for(const bt in Ue.glyphs){const rt=Ue.glyphs[+bt];if(!rt||rt.bitmap.width===0||rt.bitmap.height===0)continue;const Gt=rt.metrics.localGlyph?ie:1,an={x:0,y:0,w:rt.bitmap.width+2*Gt,h:rt.bitmap.height+2*Gt};xe.push(an),tt[bt]=an}}const{w:ze,h:Ce}=r.H(xe),He=new r.eZ({width:ze||1,height:Ce||1});for(const Je in te){const Ue=te[Je];for(const tt in Ue.glyphs){const bt=Ue.glyphs[+tt];if(!bt||bt.bitmap.width===0||bt.bitmap.height===0)continue;const rt=oe[Je][tt],Gt=bt.metrics.localGlyph?ie:1;r.eZ.copy(bt.bitmap,He,{x:0,y:0},{x:rt.x+Gt,y:rt.y+Gt},bt.bitmap)}}this.image=He,this.positions=oe}}r.eY(de,"GlyphAtlas");class se{constructor(te){this.tileID=new r.aM(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.tileZoom=te.tileZoom,this.uid=te.uid,this.zoom=te.zoom,this.lut=te.lut,this.canonical=te.tileID.canonical,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.scope=te.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.request&&te.request.collectResourceTiming,this.promoteId=te.promoteId,this.isSymbolTile=te.isSymbolTile,this.tileTransform=r.aW(te.tileID.canonical,te.projection),this.projection=te.projection,this.worldview=te.worldview,this.localizableLayerIds=te.localizableLayerIds,this.brightness=te.brightness,this.extraShadowCaster=!!te.extraShadowCaster,this.tessellationStep=te.tessellationStep,this.scaleFactor=te.scaleFactor,this.worldview=te.worldview}parse(te,oe,xe,ze,Ce,He){this.status="parsing",this.data=te,this.collisionBoxArray=new r.b0;const Je=new r.e$(Object.keys(te.layers).sort()),Ue=new r.f0(this.tileID,this.promoteId);Ue.bucketLayerIDs=[];const tt={},bt=new r.f1(256,256),rt={featureIndex:Ue,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:bt,availableImages:xe,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Gt=[],an=oe.familiesBySource[this.source];for(const Rn in an){const Ln=te.layers[Rn];if(!Ln)continue;let On=!1,ni=!1,Un=!1;for(const Li of an[Rn])Li[0].type==="symbol"?On=!0:ni=!0,Li[0].is3D()&&Li[0].type!=="model"&&(Un=!0);if(this.extraShadowCaster&&!Un||this.isSymbolTile===!0&&!On||this.isSymbolTile===!1&&!ni)continue;Ln.version===1&&r.w(`Vector tile source "${this.source}" layer "${Rn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ki=Je.encode(Rn),fi=[];let pr=!1;for(let Li=0,Ii=0;Li<Ln.length;Li++){const kr=Ln.feature(Li),Lr=Ue.getId(kr,Rn);if(this.localizableLayerIds&&this.localizableLayerIds.has(Rn)){const Sr=kr.properties?kr.properties.worldview:null;if(this.worldview&&typeof Sr=="string")if(Sr==="all")kr.properties.$localized=!0;else{if(!Sr.split(",").includes(this.worldview))continue;kr.properties.$localized=!0,kr.properties.worldview=this.worldview}}!pr&&kr.properties&&kr.properties.hasOwnProperty(r.f2)&&(pr=!0),fi.push({feature:kr,id:Lr,index:Ii,sourceLayerIndex:Ki}),Ii++}pr&&!rt.elevationFeatures&&te.layers.hasOwnProperty(r.f3)&&(rt.elevationFeatures=r.f4.parseFrom(te.layers[r.f3],this.canonical));for(const Li of an[Rn]){const Ii=Li[0];if(this.extraShadowCaster&&(!Ii.is3D()||Ii.type==="model")||this.isSymbolTile!==void 0&&Ii.type==="symbol"!==this.isSymbolTile||Ii.minzoom&&this.zoom<Math.floor(Ii.minzoom)||Ii.maxzoom&&this.zoom>=Ii.maxzoom||Ii.visibility==="none")continue;ne(Li,this.zoom,rt.brightness,xe,this.worldview);const kr=tt[Ii.id]=Ii.createBucket({index:Ue.bucketLayerIDs.length,layers:Li,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ki,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:ze,worldview:this.worldview});Ue.bucketLayerIDs.push(Li.map(Sr=>r.C(Sr.id,Sr.scope)));let Lr=kr.prepare?kr.prepare():null;Lr!=null?(Lr=Lr.then(()=>kr.populate(fi,rt,this.tileID.canonical,this.tileTransform)),Gt.push(Lr)):kr.populate(fi,rt,this.tileID.canonical,this.tileTransform)}}const hn=()=>{let Rn,Ln,On,ni,Un,Ki;bt.trim();const fi={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},pr=()=>{if(Rn)return this.status="done",He(Rn);if(this.extraShadowCaster)this.status="done",He(null,{buckets:Object.values(tt).filter(Ii=>!Ii.isEmpty()),featureIndex:Ue,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:rt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Ln&&On&&ni){const Ii=new de(Ln),kr=new Map;for(const[ds,ls]of On.entries()){const{imagePosition:so}=r.f7(ds,ls,r.f8);kr.set(ds,so)}const Lr={};for(const ds in tt){const ls=tt[ds];ls instanceof r.b1&&(ne(ls.layers,this.zoom,rt.brightness,xe,this.worldview),Lr[ds]=r.f9(ls,Ln,Ii.positions,On,kr,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,Un,this.worldview))}const Sr={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Ce,On,Un,()=>{Sr.iconsPending=!1,Li(Lr,Ii,Sr)}),this.rasterizeIfNeeded(Ce,ni,Ki,()=>{Sr.patternsPending=!1,Li(Lr,Ii,Sr)})}},Li=(Ii,kr,Lr,Sr)=>{if(Lr.iconsPending||Lr.patternsPending)return;const ds=new r.fa(On,ni,this.lut);for(const ls in tt){const so=tt[ls];if(ls in Ii)r.fb(so,Ii[ls],this.showCollisionBoxes,xe,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,On,ds);else if(so.hasPattern&&(so instanceof r.b7||so instanceof r.b8||so instanceof r.dU)){ne(so.layers,this.zoom,rt.brightness,xe,this.worldview);const Ao=Object.fromEntries(ds.patternPositions);so.addFeatures(rt,this.tileID.canonical,Ao,xe,this.tileTransform,this.brightness)}}this.status="done",He(null,{buckets:Object.values(tt).filter(ls=>!ls.isEmpty()),featureIndex:Ue,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:kr.image,lineAtlas:bt,imageAtlas:ds,brightness:rt.brightness})};if(!this.extraShadowCaster){const Ii=r.f5(rt.glyphDependencies,Sr=>Object.keys(Sr).map(Number));Object.keys(Ii).length?Ce.send("getGlyphs",{uid:this.uid,stacks:Ii,scope:this.scope},(Sr,ds)=>{Rn||(Rn=Sr,Ln=ds,pr())},void 0,!1,fi):Ln={};const kr=Array.from(rt.iconDependencies.keys()).map(Sr=>r.I.parse(Sr));kr.length?Ce.send("getImages",{images:kr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Sr,ds)=>{Rn||(Rn=Sr,On=new Map,Un=this.updateImageMapAndGetImageTaskQueue(On,ds,rt.iconDependencies),pr())},void 0,!1,fi):(On=new Map,Un=new Map);const Lr=Array.from(rt.patternDependencies.keys()).map(Sr=>r.I.parse(Sr));Lr.length?Ce.send("getImages",{images:Lr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Sr,ds)=>{Rn||(Rn=Sr,ni=new Map,Ki=this.updateImageMapAndGetImageTaskQueue(ni,ds,rt.patternDependencies),pr())},void 0,!1,fi):(ni=new Map,Ki=new Map)}if(rt.elevationFeatures&&rt.elevationFeatures.length>0){const Ii=[];for(const Lr of Object.values(tt))if(Lr instanceof r.b8){const Sr=Lr.getUnevaluatedPortalGraph();Sr&&Ii.push(Sr)}const kr=r.f6.evaluate(Ii);for(const Lr of Object.values(tt))if(Lr instanceof r.b8){const Sr=te.layers[Je.decode(Lr.sourceLayerIndex)];Lr.setEvaluatedPortalGraph(kr,Sr,this.tileID.canonical,rt.availableImages,rt.brightness)}}pr()};Gt.length>0?Promise.allSettled(Gt).then(hn).catch(He):hn()}rasterizeIfNeeded(te,oe,xe,ze){Array.from(oe.values()).some(Ce=>Ce.usvg)?this.rasterize(te,oe,xe,ze):ze()}updateImageMapAndGetImageTaskQueue(te,oe,xe){const ze=new Map;for(const Ce of oe.keys()){const He=xe.get(Ce)||[];for(const Je of He){const Ue=Je.toString(),tt=oe.get(Je.id.toString());tt.usvg?ze.has(Ue)||(ze.set(Ue,Je),te.set(Ue,Object.assign({},tt))):te.set(Ue,tt)}}return ze}rasterize(te,oe,xe,ze){this.rasterizeTask=te.send("rasterizeImages",{scope:this.scope,tasks:xe},(Ce,He)=>{if(!Ce)for(const[Je,Ue]of He.entries()){const tt=Object.assign(oe.get(Je),{data:Ue});oe.set(Je,tt)}ze()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function ne(it,te,oe,xe,ze){const Ce=new r.aa(te,{brightness:oe,worldview:ze});for(const He of it)He.recalculate(Ce,xe)}class Se extends r.E{constructor(te,oe,xe,ze,Ce,He,Je){super(),this.actor=te,this.layerIndex=oe,this.availableImages=xe,this.availableModels=ze,this.loadVectorData=He||r.aJ,this.loading={},this.loaded={},this.deduped=new r.aI(te.scheduler),this.isSpriteLoaded=Ce,this.scheduler=te.scheduler,this.brightness=Je}loadTile(te,oe){const xe=te.uid,ze=te&&te.request,Ce=ze&&ze.collectResourceTiming,He=this.loading[xe]=new se(te);He.abort=this.loadVectorData(te,(Je,Ue)=>{const tt=!this.loading[xe];if(delete this.loading[xe],He.cancelRasterize(),tt||Je||!Ue)return He.status="done",tt||(this.loaded[xe]=He),oe(Je);const bt=Ue.rawData,rt={};Ue.expires&&(rt.expires=Ue.expires),Ue.cacheControl&&(rt.cacheControl=Ue.cacheControl),He.vectorTile=Ue.vectorTile||new r.fc.VectorTile(new r.bq(bt));const Gt=()=>{He.parse(He.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(an,hn)=>{if(an||!hn)return oe(an);const Rn={};if(Ce){const Ln=O(ze);Ln.length>0&&(Rn.resourceTiming=JSON.parse(JSON.stringify(Ln)))}oe(null,r.h({rawTileData:bt.slice(0)},hn,rt,Rn))})};this.isSpriteLoaded?Gt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Gt,{type:"parseTile",isSymbolTile:te.isSymbolTile,zoom:te.tileZoom}):Gt()}),this.loaded=this.loaded||{},this.loaded[xe]=He})}reloadTile(te,oe){const xe=this.loaded,ze=te.uid;if(xe&&xe[ze]){const Ce=xe[ze];Ce.scaleFactor=te.scaleFactor,Ce.showCollisionBoxes=te.showCollisionBoxes,Ce.projection=te.projection,Ce.brightness=te.brightness,Ce.tileTransform=r.aW(te.tileID.canonical,te.projection),Ce.extraShadowCaster=te.extraShadowCaster,Ce.lut=te.lut,Ce.worldview=te.worldview;const He=(Je,Ue)=>{const tt=Ce.reloadCallback;tt&&(delete Ce.reloadCallback,Ce.parse(Ce.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,tt)),oe(Je,Ue)};Ce.status==="parsing"?Ce.reloadCallback=He:Ce.status==="done"&&(Ce.vectorTile?Ce.parse(Ce.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,He):He())}else oe(null,void 0)}abortTile(te,oe){const xe=te.uid,ze=this.loading[xe];ze&&(ze.abort&&ze.abort(),delete this.loading[xe]),oe()}removeTile(te,oe){const xe=this.loaded,ze=te.uid;xe&&xe[ze]&&delete xe[ze],oe()}}class me{loadTile(te,oe){const{uid:xe,encoding:ze,rawImageData:Ce,padding:He}=te,Je=ImageBitmap&&Ce instanceof ImageBitmap?this.getImageData(Ce,He):Ce;oe(null,new r.fd(xe,Je,ze,He<1))}reloadTile(te,oe){oe(null,null)}abortTile(te,oe){oe()}removeTile(te,oe){oe()}getImageData(te,oe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);const xe=this.offscreenCanvasContext.getImageData(-oe,-oe,te.width+2*oe,te.height+2*oe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),xe}}r.bp.setPbf(r.bq);class Re{constructor(te){this._mrt=new r.bp(te.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=te.uid,this.tileID=te.tileID,this.source=te.source}parse(te,oe){const xe=this._mrt;this.status="parsing",this._entireBuffer=te;try{xe.parseHeader(te),this._isHeaderLoaded=!0;const ze=[];for(const Ce in xe.layers){const He=xe.getLayer(Ce),Je=He.getDataRange(He.getBandList()),Ue=xe.createDecodingTask(Je),tt=te.slice(Je.firstByte,Je.lastByte+1),bt=r.bp.performDecoding(tt,Ue).then(rt=>Ue.complete(null,rt)).catch(rt=>Ue.complete(rt,null));ze.push(bt)}Promise.allSettled(ze).then(()=>oe(null,xe)).catch(Ce=>oe(Ce))}catch(ze){oe(ze)}}}class ye{constructor(te){this.actor=te,this.loading={},this.loaded={}}loadTile(te,oe){const xe=te.uid,ze=te.request,Ce=this.loading[xe]=new Re(te),{cancel:He}=r.br(ze,(Je,Ue,tt,bt)=>{const rt=!this.loading[xe];if(delete this.loading[xe],rt||Je||!Ue)return Ce.status="done",rt||(this.loaded[xe]=Ce),oe(Je);Ce.parse(Ue,(Gt,an)=>{if(Gt||!an)return oe(Gt);oe(null,an,tt,bt)}),this.loaded[xe]=Ce});Ce.abort=He}reloadTile(te,oe){oe(null,void 0)}abortTile(te,oe){const xe=te.uid,ze=this.loading[xe];ze&&(ze.abort&&ze.abort(),delete this.loading[xe]),oe()}removeTile(te,oe){const xe=te.uid;this.loaded[xe]&&delete this.loaded[xe],oe()}decodeRasterArray(te,oe){r.bp.performDecoding(te.buffer,te.task).then(xe=>oe(null,xe)).catch(xe=>oe(xe))}}const Le=r.fc.VectorTileFeature.prototype.toGeoJSON;class De{constructor(te){this._feature=te,this.extent=r.aj,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))}loadGeometry(){if(this._feature.type===1){const te=[];for(const oe of this._feature.geometry)te.push([new r.P(oe[0],oe[1])]);return te}{const te=[];for(const oe of this._feature.geometry){const xe=[];for(const ze of oe)xe.push(new r.P(ze[0],ze[1]));te.push(xe)}return te}}toGeoJSON(te,oe,xe){return Le.call(this,te,oe,xe)}}class Oe{constructor(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.aj,this.length=te.length,this._features=te}feature(te){return new De(this._features[te])}}class Ee{constructor(te,oe){this.name=te,this.extent=r.aj,this.length=oe.length,this._features=oe}feature(te){return new De(this._features[te])}}class qe extends Oe{constructor(te){super([]),this.layers={};for(const oe in te)this.layers[oe]=new Ee(oe,te[oe])}}const $e=64/4096,Ge=128;class et{constructor(){this.features=new Map}clear(){this.features.clear()}load(te=[],oe){for(const xe of te){const ze=xe.id;if(ze==null)continue;let Ce=this.features.get(ze);Ce&&this.updateCache(Ce,oe),xe.geometry?(Ce=St(xe),this.updateCache(Ce,oe),this.features.set(ze,Ce)):this.features.delete(ze),this.updateCache(Ce,oe)}}updateCache(te,oe){for(const{canonical:xe,uid:ze}of Object.values(oe)){const{z:Ce,x:He,y:Je}=xe;mt(te,Math.pow(2,Ce),He,Je)&&delete oe[ze]}}getTile(te,oe,xe){const ze=Math.pow(2,te),Ce=[];for(const He of this.features.values())mt(He,ze,oe,xe)&&Ce.push(Ut(He,ze,oe,xe));return{features:Ce}}getFeatures(){return[...this.features.values()]}}function mt({minX:it,minY:te,maxX:oe,maxY:xe},ze,Ce,He){return it<(Ce+1+$e)/ze&&te<(He+1+$e)/ze&&oe>(Ce-$e)/ze&&xe>(He-$e)/ze}function St(it){const{id:te,geometry:oe,properties:xe}=it;if(!oe)return;if(oe.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:ze,coordinates:Ce}=oe,He={id:te,type:1,geometry:[],tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Je=He.geometry;if(ze==="Point")xt(Ce,Je,He);else if(ze==="MultiPoint")for(const Ue of Ce)xt(Ue,Je,He);else if(ze==="LineString")He.type=2,At(Ce,Je,He);else if(ze==="MultiLineString")He.type=2,Ct(Ce,Je,He);else if(ze==="Polygon")He.type=3,Ct(Ce,Je,He,!0);else{if(ze!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");He.type=3;for(const Ue of Ce)Ct(Ue,Je,He,!0)}return He}function xt([it,te],oe,xe){const ze=r.aD(it);let Ce=r.aH(te);Ce=Ce<0?0:Ce>1?1:Ce,oe.push(ze,Ce),xe.minX=Math.min(xe.minX,ze),xe.minY=Math.min(xe.minY,Ce),xe.maxX=Math.max(xe.maxX,ze),xe.maxY=Math.max(xe.maxY,Ce)}function At(it,te,oe,xe=!1,ze=!1){const Ce=[];for(const He of it)xt(He,Ce,oe);te.push(Ce),xe&&function(He,Je){let Ue=0;for(let tt=0,bt=He.length,rt=bt-2;tt<bt;rt=tt,tt+=2)Ue+=(He[tt]-He[rt])*(He[tt+1]+He[rt+1]);if(Ue>0===Je)for(let tt=0,bt=He.length;tt<bt/2;tt+=2){const rt=He[tt],Gt=He[tt+1];He[tt]=He[bt-2-tt],He[tt+1]=He[bt-1-tt],He[bt-2-tt]=rt,He[bt-1-tt]=Gt}}(Ce,ze)}function Ct(it,te,oe,xe=!1){for(let ze=0;ze<it.length;ze++)At(it[ze],te,oe,xe,ze===0)}function Ut(it,te,oe,xe){const{id:ze,type:Ce,geometry:He,tags:Je}=it,Ue=[];if(Ce===1)(function(tt,bt,rt,Gt,an){for(let hn=0;hn<tt.length;hn+=2){const Rn=Math.round(r.aj*(tt[hn+0]*bt-rt)),Ln=Math.round(r.aj*(tt[hn+1]*bt-Gt));an.push([Rn,Ln])}})(He,te,oe,xe,Ue);else for(const tt of He)at(tt,te,oe,xe,Ue);return{id:ze,type:Ce,geometry:Ue,tags:Je}}function at(it,te,oe,xe,ze){const He=r.aj+Ge;let Je;for(let Ue=0;Ue<it.length-2;Ue+=2){let tt=Math.round(r.aj*(it[Ue+0]*te-oe)),bt=Math.round(r.aj*(it[Ue+1]*te-xe)),rt=Math.round(r.aj*(it[Ue+2]*te-oe)),Gt=Math.round(r.aj*(it[Ue+3]*te-xe));const an=rt-tt,hn=Gt-bt;tt<-128&&rt<-128||(tt<-128?(bt+=Math.round(hn*((-128-tt)/an)),tt=-128):rt<-128&&(Gt=bt+Math.round(hn*((-128-tt)/an)),rt=-128),bt<-128&&Gt<-128||(bt<-128?(tt+=Math.round(an*((-128-bt)/hn)),bt=-128):Gt<-128&&(rt=tt+Math.round(an*((-128-bt)/hn)),Gt=-128),tt>=He&&rt>=He||(tt>=He?(bt+=Math.round(hn*((He-tt)/an)),tt=He):rt>=He&&(Gt=bt+Math.round(hn*((He-tt)/an)),rt=He),bt>=He&&Gt>=He||(bt>=He?(tt+=Math.round(an*((He-bt)/hn)),bt=He):Gt>=He&&(rt=tt+Math.round(an*((He-bt)/hn)),Gt=He),Je&&tt===Je[Je.length-1][0]&&bt===Je[Je.length-1][1]||(Je=[[tt,bt]],ze.push(Je)),Je.push([rt,Gt])))))}}var kt,qt,lt,Ht={exports:{}},Nn=function(){if(lt)return Ht.exports;lt=1;var it=r.fg(),te=function(){if(qt)return kt;qt=1;var bt=r.fe(),rt=r.ff().VectorTileFeature;function Gt(hn,Rn){this.options=Rn||{},this.features=hn,this.length=hn.length}function an(hn,Rn){this.id=typeof hn.id=="number"?hn.id:void 0,this.type=hn.type,this.rawGeometry=hn.type===1?[hn.geometry]:hn.geometry,this.properties=hn.tags,this.extent=Rn||4096}return kt=Gt,Gt.prototype.feature=function(hn){return new an(this.features[hn],this.options.extent)},an.prototype.loadGeometry=function(){var hn=this.rawGeometry;this.geometry=[];for(var Rn=0;Rn<hn.length;Rn++){for(var Ln=hn[Rn],On=[],ni=0;ni<Ln.length;ni++)On.push(new bt(Ln[ni][0],Ln[ni][1]));this.geometry.push(On)}return this.geometry},an.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var hn=this.geometry,Rn=1/0,Ln=-1/0,On=1/0,ni=-1/0,Un=0;Un<hn.length;Un++)for(var Ki=hn[Un],fi=0;fi<Ki.length;fi++){var pr=Ki[fi];Rn=Math.min(Rn,pr.x),Ln=Math.max(Ln,pr.x),On=Math.min(On,pr.y),ni=Math.max(ni,pr.y)}return[Rn,On,Ln,ni]},an.prototype.toGeoJSON=rt.prototype.toGeoJSON,kt}();function oe(bt){var rt=new it;return function(Gt,an){for(var hn in Gt.layers)an.writeMessage(3,xe,Gt.layers[hn])}(bt,rt),rt.finish()}function xe(bt,rt){var Gt;rt.writeVarintField(15,bt.version||1),rt.writeStringField(1,bt.name||""),rt.writeVarintField(5,bt.extent||4096);var an={keys:[],values:[],keycache:{},valuecache:{}};for(Gt=0;Gt<bt.length;Gt++)an.feature=bt.feature(Gt),rt.writeMessage(2,ze,an);var hn=an.keys;for(Gt=0;Gt<hn.length;Gt++)rt.writeStringField(3,hn[Gt]);var Rn=an.values;for(Gt=0;Gt<Rn.length;Gt++)rt.writeMessage(4,tt,Rn[Gt])}function ze(bt,rt){var Gt=bt.feature;Gt.id!==void 0&&rt.writeVarintField(1,Gt.id),rt.writeMessage(2,Ce,bt),rt.writeVarintField(3,Gt.type),rt.writeMessage(4,Ue,Gt)}function Ce(bt,rt){var Gt=bt.feature,an=bt.keys,hn=bt.values,Rn=bt.keycache,Ln=bt.valuecache;for(var On in Gt.properties){var ni=Gt.properties[On],Un=Rn[On];if(ni!==null){Un===void 0&&(an.push(On),Rn[On]=Un=an.length-1),rt.writeVarint(Un);var Ki=typeof ni;Ki!=="string"&&Ki!=="boolean"&&Ki!=="number"&&(ni=JSON.stringify(ni));var fi=Ki+":"+ni,pr=Ln[fi];pr===void 0&&(hn.push(ni),Ln[fi]=pr=hn.length-1),rt.writeVarint(pr)}}}function He(bt,rt){return(rt<<3)+(7&bt)}function Je(bt){return bt<<1^bt>>31}function Ue(bt,rt){for(var Gt=bt.loadGeometry(),an=bt.type,hn=0,Rn=0,Ln=Gt.length,On=0;On<Ln;On++){var ni=Gt[On],Un=1;an===1&&(Un=ni.length),rt.writeVarint(He(1,Un));for(var Ki=an===3?ni.length-1:ni.length,fi=0;fi<Ki;fi++){fi===1&&an!==1&&rt.writeVarint(He(2,Ki-1));var pr=ni[fi].x-hn,Li=ni[fi].y-Rn;rt.writeVarint(Je(pr)),rt.writeVarint(Je(Li)),hn+=pr,Rn+=Li}an===3&&rt.writeVarint(He(7,1))}}function tt(bt,rt){var Gt=typeof bt;Gt==="string"?rt.writeStringField(1,bt):Gt==="boolean"?rt.writeBooleanField(7,bt):Gt==="number"&&(bt%1!=0?rt.writeDoubleField(3,bt):bt<0?rt.writeSVarintField(6,bt):rt.writeVarintField(5,bt))}return Ht.exports=oe,Ht.exports.fromVectorTileJs=oe,Ht.exports.fromGeojsonVt=function(bt,rt){rt=rt||{};var Gt={};for(var an in bt)Gt[an]=new te(bt[an].features,rt),Gt[an].name=an,Gt[an].version=rt.version,Gt[an].extent=rt.extent;return oe({layers:Gt})},Ht.exports.GeoJSONWrapper=te,Ht.exports}(),zn=r.fh(Nn);const xn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:it=>it},An=Math.fround||(ti=new Float32Array(1),it=>(ti[0]=+it,ti[0]));var ti;const Hn=3,bn=5,Zi=6;class Ci{constructor(te){this.options=Object.assign(Object.create(xn),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:oe,minZoom:xe,maxZoom:ze}=this.options;oe&&console.time("total time");const Ce=`prepare ${te.length} points`;oe&&console.time(Ce),this.points=te;const He=[];for(let Ue=0;Ue<te.length;Ue++){const tt=te[Ue];if(!tt.geometry)continue;const[bt,rt]=tt.geometry.coordinates,Gt=An(ki(bt)),an=An(zi(rt));He.push(Gt,an,1/0,Ue,-1,1),this.options.reduce&&He.push(0)}let Je=this.trees[ze+1]=this._createTree(He);oe&&console.timeEnd(Ce);for(let Ue=ze;Ue>=xe;Ue--){const tt=+Date.now();Je=this.trees[Ue]=this._createTree(this._cluster(Je,Ue)),oe&&console.log("z%d: %d clusters in %dms",Ue,Je.numItems,+Date.now()-tt)}return oe&&console.timeEnd("total time"),this}getClusters(te,oe){let xe=((te[0]+180)%360+360)%360-180;const ze=Math.max(-90,Math.min(90,te[1]));let Ce=te[2]===180?180:((te[2]+180)%360+360)%360-180;const He=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)xe=-180,Ce=180;else if(xe>Ce){const rt=this.getClusters([xe,ze,180,He],oe),Gt=this.getClusters([-180,ze,Ce,He],oe);return rt.concat(Gt)}const Je=this.trees[this._limitZoom(oe)],Ue=Je.range(ki(xe),zi(He),ki(Ce),zi(ze)),tt=Je.data,bt=[];for(const rt of Ue){const Gt=this.stride*rt;bt.push(tt[Gt+bn]>1?Yi(tt,Gt,this.clusterProps):this.points[tt[Gt+Hn]])}return bt}getChildren(te){const oe=this._getOriginId(te),xe=this._getOriginZoom(te),ze="No cluster with the specified id.",Ce=this.trees[xe];if(!Ce)throw new Error(ze);const He=Ce.data;if(oe*this.stride>=He.length)throw new Error(ze);const Je=this.options.radius/(this.options.extent*Math.pow(2,xe-1)),Ue=Ce.within(He[oe*this.stride],He[oe*this.stride+1],Je),tt=[];for(const bt of Ue){const rt=bt*this.stride;He[rt+4]===te&&tt.push(He[rt+bn]>1?Yi(He,rt,this.clusterProps):this.points[He[rt+Hn]])}if(tt.length===0)throw new Error(ze);return tt}getLeaves(te,oe,xe){const ze=[];return this._appendLeaves(ze,te,oe=oe||10,xe=xe||0,0),ze}getTile(te,oe,xe){const ze=this.trees[this._limitZoom(te)],Ce=Math.pow(2,te),{extent:He,radius:Je}=this.options,Ue=Je/He,tt=(xe-Ue)/Ce,bt=(xe+1+Ue)/Ce,rt={features:[]};return this._addTileFeatures(ze.range((oe-Ue)/Ce,tt,(oe+1+Ue)/Ce,bt),ze.data,oe,xe,Ce,rt),oe===0&&this._addTileFeatures(ze.range(1-Ue/Ce,tt,1,bt),ze.data,Ce,xe,Ce,rt),oe===Ce-1&&this._addTileFeatures(ze.range(0,tt,Ue/Ce,bt),ze.data,-1,xe,Ce,rt),rt.features.length?rt:null}getClusterExpansionZoom(te){let oe=this._getOriginZoom(te)-1;for(;oe<=this.options.maxZoom;){const xe=this.getChildren(te);if(oe++,xe.length!==1)break;te=xe[0].properties.cluster_id}return oe}_appendLeaves(te,oe,xe,ze,Ce){const He=this.getChildren(oe);for(const Je of He){const Ue=Je.properties;if(Ue&&Ue.cluster?Ce+Ue.point_count<=ze?Ce+=Ue.point_count:Ce=this._appendLeaves(te,Ue.cluster_id,xe,ze,Ce):Ce<ze?Ce++:te.push(Je),te.length===xe)break}return Ce}_createTree(te){const oe=new r.bW(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let xe=0;xe<te.length;xe+=this.stride)oe.add(te[xe],te[xe+1]);return oe.finish(),oe.data=te,oe}_addTileFeatures(te,oe,xe,ze,Ce,He){for(const Je of te){const Ue=Je*this.stride,tt=oe[Ue+bn]>1;let bt,rt,Gt;if(tt)bt=Vn(oe,Ue,this.clusterProps),rt=oe[Ue],Gt=oe[Ue+1];else{const Rn=this.points[oe[Ue+Hn]];bt=Rn.properties;const[Ln,On]=Rn.geometry.coordinates;rt=ki(Ln),Gt=zi(On)}const an={type:1,geometry:[[Math.round(this.options.extent*(rt*Ce-xe)),Math.round(this.options.extent*(Gt*Ce-ze))]],tags:bt};let hn;hn=tt||this.options.generateId?oe[Ue+Hn]:this.points[oe[Ue+Hn]].id,hn!==void 0&&(an.id=hn),He.features.push(an)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,oe){const{radius:xe,extent:ze,reduce:Ce,minPoints:He}=this.options,Je=xe/(ze*Math.pow(2,oe)),Ue=te.data,tt=[],bt=this.stride;for(let rt=0;rt<Ue.length;rt+=bt){if(Ue[rt+2]<=oe)continue;Ue[rt+2]=oe;const Gt=Ue[rt],an=Ue[rt+1],hn=te.within(Ue[rt],Ue[rt+1],Je),Rn=Ue[rt+bn];let Ln=Rn;for(const On of hn){const ni=On*bt;Ue[ni+2]>oe&&(Ln+=Ue[ni+bn])}if(Ln>Rn&&Ln>=He){let On,ni=Gt*Rn,Un=an*Rn,Ki=-1;const fi=(rt/bt<<5)+(oe+1)+this.points.length;for(const pr of hn){const Li=pr*bt;if(Ue[Li+2]<=oe)continue;Ue[Li+2]=oe;const Ii=Ue[Li+bn];ni+=Ue[Li]*Ii,Un+=Ue[Li+1]*Ii,Ue[Li+4]=fi,Ce&&(On||(On=this._map(Ue,rt,!0),Ki=this.clusterProps.length,this.clusterProps.push(On)),Ce(On,this._map(Ue,Li)))}Ue[rt+4]=fi,tt.push(ni/Ln,Un/Ln,1/0,fi,-1,Ln),Ce&&tt.push(Ki)}else{for(let On=0;On<bt;On++)tt.push(Ue[rt+On]);if(Ln>1)for(const On of hn){const ni=On*bt;if(!(Ue[ni+2]<=oe)){Ue[ni+2]=oe;for(let Un=0;Un<bt;Un++)tt.push(Ue[ni+Un])}}}}return tt}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,oe,xe){if(te[oe+bn]>1){const He=this.clusterProps[te[oe+Zi]];return xe?Object.assign({},He):He}const ze=this.points[te[oe+Hn]].properties,Ce=this.options.map(ze);return xe&&Ce===ze?Object.assign({},Ce):Ce}}function Yi(it,te,oe){return{type:"Feature",id:it[te+Hn],properties:Vn(it,te,oe),geometry:{type:"Point",coordinates:[(xe=it[te],360*(xe-.5)),Pr(it[te+1])]}};var xe}function Vn(it,te,oe){const xe=it[te+bn],ze=xe>=1e4?`${Math.round(xe/1e3)}k`:xe>=1e3?Math.round(xe/100)/10+"k":xe,Ce=it[te+Zi],He=Ce===-1?{}:Object.assign({},oe[Ce]);return Object.assign(He,{cluster:!0,cluster_id:it[te+Hn],point_count:xe,point_count_abbreviated:ze})}function ki(it){return it/360+.5}function zi(it){const te=Math.sin(it*Math.PI/180),oe=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return oe<0?0:oe>1?1:oe}function Pr(it){const te=(180-360*it)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function Gr(it,te,oe,xe){let ze=xe;const Ce=te+(oe-te>>1);let He,Je=oe-te;const Ue=it[te],tt=it[te+1],bt=it[oe],rt=it[oe+1];for(let Gt=te+3;Gt<oe;Gt+=3){const an=ys(it[Gt],it[Gt+1],Ue,tt,bt,rt);if(an>ze)He=Gt,ze=an;else if(an===ze){const hn=Math.abs(Gt-Ce);hn<Je&&(He=Gt,Je=hn)}}ze>xe&&(He-te>3&&Gr(it,te,He,xe),it[He+2]=ze,oe-He>3&&Gr(it,He,oe,xe))}function ys(it,te,oe,xe,ze,Ce){let He=ze-oe,Je=Ce-xe;if(He!==0||Je!==0){const Ue=((it-oe)*He+(te-xe)*Je)/(He*He+Je*Je);Ue>1?(oe=ze,xe=Ce):Ue>0&&(oe+=He*Ue,xe+=Je*Ue)}return He=it-oe,Je=te-xe,He*He+Je*Je}function zr(it,te,oe,xe){const ze={id:it??null,type:te,geometry:oe,tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(te==="Point"||te==="MultiPoint"||te==="LineString")Or(ze,oe);else if(te==="Polygon")Or(ze,oe[0]);else if(te==="MultiLineString")for(const Ce of oe)Or(ze,Ce);else if(te==="MultiPolygon")for(const Ce of oe)Or(ze,Ce[0]);return ze}function Or(it,te){for(let oe=0;oe<te.length;oe+=3)it.minX=Math.min(it.minX,te[oe]),it.minY=Math.min(it.minY,te[oe+1]),it.maxX=Math.max(it.maxX,te[oe]),it.maxY=Math.max(it.maxY,te[oe+1])}function sr(it,te,oe,xe){if(!te.geometry)return;const ze=te.geometry.coordinates;if(ze&&ze.length===0)return;const Ce=te.geometry.type,He=Math.pow(oe.tolerance/((1<<oe.maxZoom)*oe.extent),2);let Je=[],Ue=te.id;if(oe.promoteId?Ue=te.properties[oe.promoteId]:oe.generateId&&(Ue=xe||0),Ce==="Point")Ss(ze,Je);else if(Ce==="MultiPoint")for(const tt of ze)Ss(tt,Je);else if(Ce==="LineString")as(ze,Je,He,!1);else if(Ce==="MultiLineString"){if(oe.lineMetrics){for(const tt of ze)Je=[],as(tt,Je,He,!1),it.push(zr(Ue,"LineString",Je,te.properties));return}Hi(ze,Je,He,!1)}else if(Ce==="Polygon")Hi(ze,Je,He,!0);else{if(Ce!=="MultiPolygon"){if(Ce==="GeometryCollection"){for(const tt of te.geometry.geometries)sr(it,{id:Ue,geometry:tt,properties:te.properties},oe,xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const tt of ze){const bt=[];Hi(tt,bt,He,!0),Je.push(bt)}}it.push(zr(Ue,Ce,Je,te.properties))}function Ss(it,te){te.push(Gs(it[0]),ho(it[1]),0)}function as(it,te,oe,xe){let ze,Ce,He=0;for(let Ue=0;Ue<it.length;Ue++){const tt=Gs(it[Ue][0]),bt=ho(it[Ue][1]);te.push(tt,bt,0),Ue>0&&(He+=xe?(ze*bt-tt*Ce)/2:Math.sqrt(Math.pow(tt-ze,2)+Math.pow(bt-Ce,2))),ze=tt,Ce=bt}const Je=te.length-3;te[2]=1,Gr(te,0,Je,oe),te[Je+2]=1,te.size=Math.abs(He),te.start=0,te.end=te.size}function Hi(it,te,oe,xe){for(let ze=0;ze<it.length;ze++){const Ce=[];as(it[ze],Ce,oe,xe),te.push(Ce)}}function Gs(it){return it/360+.5}function ho(it){const te=Math.sin(it*Math.PI/180),oe=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return oe<0?0:oe>1?1:oe}function Jr(it,te,oe,xe,ze,Ce,He,Je){if(xe/=te,Ce>=(oe/=te)&&He<xe)return it;if(He<oe||Ce>=xe)return null;const Ue=[];for(const tt of it){const bt=tt.geometry;let rt=tt.type;const Gt=ze===0?tt.minX:tt.minY,an=ze===0?tt.maxX:tt.maxY;if(Gt>=oe&&an<xe){Ue.push(tt);continue}if(an<oe||Gt>=xe)continue;let hn=[];if(rt==="Point"||rt==="MultiPoint")xr(bt,hn,oe,xe,ze);else if(rt==="LineString")ci(bt,hn,oe,xe,ze,!1,Je.lineMetrics);else if(rt==="MultiLineString")Wr(bt,hn,oe,xe,ze,!1);else if(rt==="Polygon")Wr(bt,hn,oe,xe,ze,!0);else if(rt==="MultiPolygon")for(const Rn of bt){const Ln=[];Wr(Rn,Ln,oe,xe,ze,!0),Ln.length&&hn.push(Ln)}if(hn.length){if(Je.lineMetrics&&rt==="LineString"){for(const Rn of hn)Ue.push(zr(tt.id,rt,Rn,tt.tags));continue}rt!=="LineString"&&rt!=="MultiLineString"||(hn.length===1?(rt="LineString",hn=hn[0]):rt="MultiLineString"),rt!=="Point"&&rt!=="MultiPoint"||(rt=hn.length===3?"Point":"MultiPoint"),Ue.push(zr(tt.id,rt,hn,tt.tags))}}return Ue.length?Ue:null}function xr(it,te,oe,xe,ze){for(let Ce=0;Ce<it.length;Ce+=3){const He=it[Ce+ze];He>=oe&&He<=xe&&Ws(te,it[Ce],it[Ce+1],it[Ce+2])}}function ci(it,te,oe,xe,ze,Ce,He){let Je=Cs(it);const Ue=ze===0?hi:br;let tt,bt,rt=it.start;for(let Ln=0;Ln<it.length-3;Ln+=3){const On=it[Ln],ni=it[Ln+1],Un=it[Ln+2],Ki=it[Ln+3],fi=it[Ln+4],pr=ze===0?On:ni,Li=ze===0?Ki:fi;let Ii=!1;He&&(tt=Math.sqrt(Math.pow(On-Ki,2)+Math.pow(ni-fi,2))),pr<oe?Li>oe&&(bt=Ue(Je,On,ni,Ki,fi,oe),He&&(Je.start=rt+tt*bt)):pr>xe?Li<xe&&(bt=Ue(Je,On,ni,Ki,fi,xe),He&&(Je.start=rt+tt*bt)):Ws(Je,On,ni,Un),Li<oe&&pr>=oe&&(bt=Ue(Je,On,ni,Ki,fi,oe),Ii=!0),Li>xe&&pr<=xe&&(bt=Ue(Je,On,ni,Ki,fi,xe),Ii=!0),!Ce&&Ii&&(He&&(Je.end=rt+tt*bt),te.push(Je),Je=Cs(it)),He&&(rt+=tt)}let Gt=it.length-3;const an=it[Gt],hn=it[Gt+1],Rn=ze===0?an:hn;Rn>=oe&&Rn<=xe&&Ws(Je,an,hn,it[Gt+2]),Gt=Je.length-3,Ce&&Gt>=3&&(Je[Gt]!==Je[0]||Je[Gt+1]!==Je[1])&&Ws(Je,Je[0],Je[1],Je[2]),Je.length&&te.push(Je)}function Cs(it){const te=[];return te.size=it.size,te.start=it.start,te.end=it.end,te}function Wr(it,te,oe,xe,ze,Ce){for(const He of it)ci(He,te,oe,xe,ze,Ce,!1)}function Ws(it,te,oe,xe){it.push(te,oe,xe)}function hi(it,te,oe,xe,ze,Ce){const He=(Ce-te)/(xe-te);return Ws(it,Ce,oe+(ze-oe)*He,1),He}function br(it,te,oe,xe,ze,Ce){const He=(Ce-oe)/(ze-oe);return Ws(it,te+(xe-te)*He,Ce,1),He}function is(it,te){const oe=[];for(let xe=0;xe<it.length;xe++){const ze=it[xe],Ce=ze.type;let He;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")He=ro(ze.geometry,te);else if(Ce==="MultiLineString"||Ce==="Polygon"){He=[];for(const Je of ze.geometry)He.push(ro(Je,te))}else if(Ce==="MultiPolygon"){He=[];for(const Je of ze.geometry){const Ue=[];for(const tt of Je)Ue.push(ro(tt,te));He.push(Ue)}}oe.push(zr(ze.id,Ce,He,ze.tags))}return oe}function ro(it,te){const oe=[];oe.size=it.size,it.start!==void 0&&(oe.start=it.start,oe.end=it.end);for(let xe=0;xe<it.length;xe+=3)oe.push(it[xe]+te,it[xe+1],it[xe+2]);return oe}function Ca(it,te){if(it.transformed)return it;const oe=1<<it.z,xe=it.x,ze=it.y;for(const Ce of it.features){const He=Ce.geometry,Je=Ce.type;if(Ce.geometry=[],Je===1)for(let Ue=0;Ue<He.length;Ue+=2)Ce.geometry.push(or(He[Ue],He[Ue+1],te,oe,xe,ze));else for(let Ue=0;Ue<He.length;Ue++){const tt=[];for(let bt=0;bt<He[Ue].length;bt+=2)tt.push(or(He[Ue][bt],He[Ue][bt+1],te,oe,xe,ze));Ce.geometry.push(tt)}}return it.transformed=!0,it}function or(it,te,oe,xe,ze,Ce){return[Math.round(oe*(it*xe-ze)),Math.round(oe*(te*xe-Ce))]}function qa(it,te,oe,xe,ze){const Ce=te===ze.maxZoom?0:ze.tolerance/((1<<te)*ze.extent),He={features:[],numPoints:0,numSimplified:0,numFeatures:it.length,source:null,x:oe,y:xe,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Je of it)Wl(He,Je,Ce,ze);return He}function Wl(it,te,oe,xe){const ze=te.geometry,Ce=te.type,He=[];if(it.minX=Math.min(it.minX,te.minX),it.minY=Math.min(it.minY,te.minY),it.maxX=Math.max(it.maxX,te.maxX),it.maxY=Math.max(it.maxY,te.maxY),Ce==="Point"||Ce==="MultiPoint")for(let Je=0;Je<ze.length;Je+=3)He.push(ze[Je],ze[Je+1]),it.numPoints++,it.numSimplified++;else if(Ce==="LineString")Ls(He,ze,it,oe,!1,!1);else if(Ce==="MultiLineString"||Ce==="Polygon")for(let Je=0;Je<ze.length;Je++)Ls(He,ze[Je],it,oe,Ce==="Polygon",Je===0);else if(Ce==="MultiPolygon")for(let Je=0;Je<ze.length;Je++){const Ue=ze[Je];for(let tt=0;tt<Ue.length;tt++)Ls(He,Ue[tt],it,oe,!0,tt===0)}if(He.length){let Je=te.tags||null;if(Ce==="LineString"&&xe.lineMetrics){Je={};for(const tt in te.tags)Je[tt]=te.tags[tt];Je.mapbox_clip_start=ze.start/ze.size,Je.mapbox_clip_end=ze.end/ze.size}const Ue={geometry:He,type:Ce==="Polygon"||Ce==="MultiPolygon"?3:Ce==="LineString"||Ce==="MultiLineString"?2:1,tags:Je};te.id!==null&&(Ue.id=te.id),it.features.push(Ue)}}function Ls(it,te,oe,xe,ze,Ce){const He=xe*xe;if(xe>0&&te.size<(ze?He:xe))return void(oe.numPoints+=te.length/3);const Je=[];for(let Ue=0;Ue<te.length;Ue+=3)(xe===0||te[Ue+2]>He)&&(oe.numSimplified++,Je.push(te[Ue],te[Ue+1])),oe.numPoints++;ze&&function(Ue,tt){let bt=0;for(let rt=0,Gt=Ue.length,an=Gt-2;rt<Gt;an=rt,rt+=2)bt+=(Ue[rt]-Ue[an])*(Ue[rt+1]+Ue[an+1]);if(bt>0===tt)for(let rt=0,Gt=Ue.length;rt<Gt/2;rt+=2){const an=Ue[rt],hn=Ue[rt+1];Ue[rt]=Ue[Gt-2-rt],Ue[rt+1]=Ue[Gt-1-rt],Ue[Gt-2-rt]=an,Ue[Gt-1-rt]=hn}}(Je,Ce),it.push(Je)}const Zl={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Sh{constructor(te,oe){const xe=(oe=this.options=function(Ce,He){for(const Je in He)Ce[Je]=He[Je];return Ce}(Object.create(Zl),oe)).debug;if(xe&&console.time("preprocess data"),oe.maxZoom<0||oe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(oe.promoteId&&oe.generateId)throw new Error("promoteId and generateId cannot be used together.");let ze=function(Ce,He){const Je=[];if(Ce.type==="FeatureCollection")for(let Ue=0;Ue<Ce.features.length;Ue++)sr(Je,Ce.features[Ue],He,Ue);else sr(Je,Ce.type==="Feature"?Ce:{geometry:Ce},He);return Je}(te,oe);this.tiles={},this.tileCoords=[],xe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",oe.indexMaxZoom,oe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ze=function(Ce,He){const Je=He.buffer/He.extent;let Ue=Ce;const tt=Jr(Ce,1,-1-Je,Je,0,-1,2,He),bt=Jr(Ce,1,1-Je,2+Je,0,-1,2,He);return(tt||bt)&&(Ue=Jr(Ce,1,-Je,1+Je,0,-1,2,He)||[],tt&&(Ue=is(tt,1).concat(Ue)),bt&&(Ue=Ue.concat(is(bt,-1)))),Ue}(ze,oe),ze.length&&this.splitTile(ze,0,0,0),xe&&(ze.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(te,oe,xe,ze,Ce,He,Je){const Ue=[te,oe,xe,ze],tt=this.options,bt=tt.debug;for(;Ue.length;){ze=Ue.pop(),xe=Ue.pop(),oe=Ue.pop(),te=Ue.pop();const rt=1<<oe,Gt=Kl(oe,xe,ze);let an=this.tiles[Gt];if(!an&&(bt>1&&console.time("creation"),an=this.tiles[Gt]=qa(te,oe,xe,ze,tt),this.tileCoords.push({z:oe,x:xe,y:ze}),bt)){bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",oe,xe,ze,an.numFeatures,an.numPoints,an.numSimplified),console.timeEnd("creation"));const Ii=`z${oe}`;this.stats[Ii]=(this.stats[Ii]||0)+1,this.total++}if(an.source=te,Ce==null){if(oe===tt.indexMaxZoom||an.numPoints<=tt.indexMaxPoints)continue}else{if(oe===tt.maxZoom||oe===Ce)continue;if(Ce!=null){const Ii=Ce-oe;if(xe!==He>>Ii||ze!==Je>>Ii)continue}}if(an.source=null,te.length===0)continue;bt>1&&console.time("clipping");const hn=.5*tt.buffer/tt.extent,Rn=.5-hn,Ln=.5+hn,On=1+hn;let ni=null,Un=null,Ki=null,fi=null,pr=Jr(te,rt,xe-hn,xe+Ln,0,an.minX,an.maxX,tt),Li=Jr(te,rt,xe+Rn,xe+On,0,an.minX,an.maxX,tt);te=null,pr&&(ni=Jr(pr,rt,ze-hn,ze+Ln,1,an.minY,an.maxY,tt),Un=Jr(pr,rt,ze+Rn,ze+On,1,an.minY,an.maxY,tt),pr=null),Li&&(Ki=Jr(Li,rt,ze-hn,ze+Ln,1,an.minY,an.maxY,tt),fi=Jr(Li,rt,ze+Rn,ze+On,1,an.minY,an.maxY,tt),Li=null),bt>1&&console.timeEnd("clipping"),Ue.push(ni||[],oe+1,2*xe,2*ze),Ue.push(Un||[],oe+1,2*xe,2*ze+1),Ue.push(Ki||[],oe+1,2*xe+1,2*ze),Ue.push(fi||[],oe+1,2*xe+1,2*ze+1)}}getTile(te,oe,xe){te=+te,oe=+oe,xe=+xe;const ze=this.options,{extent:Ce,debug:He}=ze;if(te<0||te>24)return null;const Je=1<<te,Ue=Kl(te,oe=oe+Je&Je-1,xe);if(this.tiles[Ue])return Ca(this.tiles[Ue],Ce);He>1&&console.log("drilling down to z%d-%d-%d",te,oe,xe);let tt,bt=te,rt=oe,Gt=xe;for(;!tt&&bt>0;)bt--,rt>>=1,Gt>>=1,tt=this.tiles[Kl(bt,rt,Gt)];return tt&&tt.source?(He>1&&(console.log("found parent tile z%d-%d-%d",bt,rt,Gt),console.time("drilling down")),this.splitTile(tt.source,bt,rt,Gt,te,oe,xe),He>1&&console.timeEnd("drilling down"),this.tiles[Ue]?Ca(this.tiles[Ue],Ce):null):null}}function Kl(it,te,oe){return 32*((1<<it)*oe+te)+it}function Wt(it,te){const oe=it.tileID.canonical;if(!this._geoJSONIndex)return void te(null,null);const xe=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!xe)return void te(null,null);const ze=Ue=>Ue.tags&&"3d_elevation_id"in Ue.tags&&"source"in Ue.tags&&Ue.tags.source==="elevation",Ce=xe.features.filter(Ue=>ze(Ue));let He;if(Ce.length>0){const Ue=xe.features.filter(tt=>!ze(tt));He=new qe({_geojsonTileLayer:Ue,hd_road_elevation:Ce})}else He=new Oe(xe.features);let Je=zn(He);Je.byteOffset===0&&Je.byteLength===Je.buffer.byteLength||(Je=new Uint8Array(Je)),te(null,{vectorTile:He,rawData:Je.buffer})}class Ha extends Se{constructor(te,oe,xe,ze,Ce,He,Je){super(te,oe,xe,ze,Ce,Wt,Je),He&&(this.loadGeoJSON=He),this._dynamicIndex=new et}loadData(te,oe){const xe=te&&te.request,ze=xe&&xe.collectResourceTiming;this.loadGeoJSON(te,(Ce,He)=>{if(Ce||!He)return oe(Ce);if(typeof He!="object")return oe(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));{try{if(te.filter){const Ue=r.X(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ue.result==="error")throw new Error(Ue.value.map(tt=>`${tt.key}: ${tt.message}`).join(", "));He.features=He.features.filter(tt=>Ue.value.evaluate({zoom:0},tt))}te.dynamic?(He.type==="Feature"&&(He={type:"FeatureCollection",features:[He]}),te.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(He.features,this.loaded),te.cluster&&(He.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=te.cluster?new Ci(function({superclusterOptions:Ue,clusterProperties:tt}){if(!tt||!Ue)return Ue;const bt={},rt={},Gt={accumulated:null,zoom:0},an={properties:null},hn=Object.keys(tt);for(const Rn of hn){const[Ln,On]=tt[Rn],ni=r.X(On),Un=r.X(typeof Ln=="string"?[Ln,["accumulated"],["get",Rn]]:Ln);bt[Rn]=ni.value,rt[Rn]=Un.value}return Ue.map=Rn=>{an.properties=Rn;const Ln={};for(const On of hn)Ln[On]=bt[On].evaluate(Gt,an);return Ln},Ue.reduce=(Rn,Ln)=>{an.properties=Ln;for(const On of hn)Gt.accumulated=Rn[On],Rn[On]=rt[On].evaluate(Gt,an)},Ue}(te)).load(He.features):te.dynamic?this._dynamicIndex:function(Ue,tt){return new Sh(Ue,tt)}(He,te.geojsonVtOptions)}catch(Ue){return oe(Ue)}const Je={};if(ze){const Ue=O(xe);Ue&&(Je.resourceTiming={},Je.resourceTiming[te.source]=JSON.parse(JSON.stringify(Ue)))}oe(null,Je)}})}reloadTile(te,oe){const xe=this.loaded;return xe&&xe[te.uid]?te.partial?oe(null,void 0):super.reloadTile(te,oe):this.loadTile(te,oe)}loadGeoJSON(te,oe){if(te.request)r.n(te.request,oe);else{if(typeof te.data!="string")return oe(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));try{return oe(null,JSON.parse(te.data))}catch{return oe(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(te,oe){try{oe(null,this._geoJSONIndex.getClusterExpansionZoom(te.clusterId))}catch(xe){oe(xe)}}getClusterChildren(te,oe){try{oe(null,this._geoJSONIndex.getChildren(te.clusterId))}catch(xe){oe(xe)}}getClusterLeaves(te,oe){try{oe(null,this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset))}catch(xe){oe(xe)}}}class Td{constructor(te,oe,xe){this.tileID=new r.aM(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.tileZoom=te.tileZoom,this.uid=te.uid,this.zoom=te.zoom,this.canonical=te.tileID.canonical,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=te.projection,this.brightness=oe,this.worldview=xe}parse(te,oe,xe,ze){this.status="parsing";const Ce=new r.aM(xe.tileID.overscaledZ,xe.tileID.wrap,xe.tileID.canonical.z,xe.tileID.canonical.x,xe.tileID.canonical.y),He=[],Je=oe.familiesBySource[xe.source],Ue=new r.f0(Ce,xe.promoteId);Ue.bucketLayerIDs=[],Ue.is3DTile=!0,r.fi(te).then(tt=>{if(!tt)return ze(new Error("Could not parse tile"));const bt=tt.json.extensionsUsed&&tt.json.extensionsUsed.includes("MAPBOX_mesh_features")||tt.json.asset.extras&&tt.json.asset.extras.MAPBOX_mesh_features,rt=tt.json.extensionsUsed&&tt.json.extensionsUsed.includes("EXT_meshopt_compression"),Gt=new r.aa(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const an in Je)for(const hn of Je[an]){const Rn=hn[0];Ue.bucketLayerIDs.push(hn.map(ni=>r.C(ni.id,ni.scope))),Rn.recalculate(Gt,[]);const Ln=r.fj(tt,1/r.cU(xe.tileID.canonical)),On=new r.fk(hn,Ln,Ce,bt,rt,this.brightness,Ue,this.worldview);bt||(On.needsUpload=!0),He.push(On),On.evaluate(Rn)}this.status="done",ze(null,{buckets:He,featureIndex:Ue,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(tt=>ze(new Error(tt.message)))}}class Rc{constructor(te,oe,xe,ze,Ce,He,Je,Ue){this.actor=te,this.layerIndex=oe,this.availableImages=xe,this.availableModels=ze,this.brightness=Je,this.loading={},this.loaded={},this.worldview=Ue}loadTile(te,oe){const xe=te.uid,ze=this.loading[xe]=new Td(te,this.brightness,this.worldview);r.br(te.request,(Ce,He)=>{const Je=!this.loading[xe];return delete this.loading[xe],Je||Ce?(ze.status="done",Je||(this.loaded[xe]=ze),oe(Ce)):He&&He.byteLength!==0?void ze.parse(He,this.layerIndex,te,(Ue,tt)=>{ze.status="done",this.loaded=this.loaded||{},this.loaded[xe]=ze,Ue||!tt?oe(Ue):oe(null,tt)}):(ze.status="done",this.loaded[xe]=ze,oe())})}reloadTile(te,oe){const xe=this.loaded,ze=te.uid;if(xe&&xe[ze]){const Ce=xe[ze];Ce.projection=te.projection,Ce.brightness=te.brightness;const He=(Je,Ue)=>{Ce.reloadCallback&&(delete Ce.reloadCallback,this.loadTile(te,oe)),oe(Je,Ue)};Ce.status==="parsing"?Ce.reloadCallback=He:Ce.status==="done"&&this.loadTile(te,oe)}}abortTile(te,oe){const xe=te.uid;this.loading[xe]&&delete this.loading[xe],oe()}removeTile(te,oe){const xe=this.loaded,ze=te.uid;xe&&xe[ze]&&delete xe[ze],oe()}}class Ei{constructor(te){this.self=te,this.actor=new r.fm(te,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new r.y,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=r.ce({name:"mercator"}),this.workerSourceTypes={vector:Se,geojson:Ha,"raster-dem":me,"raster-array":ye,"batched-model":Rc},this.workerSources={},this.self.registerWorkerSource=(oe,xe)=>{if(this.workerSourceTypes[oe])throw new Error(`Worker source with name "${oe}" already registered.`);this.workerSourceTypes[oe]=xe},this.self.registerRTLTextPlugin=oe=>{if(r.fn.isParsed())throw new Error("RTL text plugin already registered.");r.fn.setState({pluginStatus:r.fo.parsed,pluginURL:r.fn.getPluginURL()}),r.fn.applyArabicShaping=oe.applyArabicShaping,r.fn.processBidirectionalText=oe.processBidirectionalText,r.fn.processStyledBidirectionalText=oe.processStyledBidirectionalText;for(const xe of this.rtlPluginParsingListeners)xe(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(te,oe,xe){delete this.layerIndexes[te],delete this.availableImages[te],delete this.availableModels[te],delete this.workerSources[te],xe()}checkIfReady(te,oe,xe){xe()}setReferrer(te,oe){this.referrer=oe}spriteLoaded(te,oe){this.isSpriteLoaded[te]||(this.isSpriteLoaded[te]={});const{scope:xe,isLoaded:ze}=oe;if(this.isSpriteLoaded[te][xe]=ze,this.workerSources[te]&&this.workerSources[te][xe])for(const Ce in this.workerSources[te][xe]){const He=this.workerSources[te][xe][Ce];for(const Je in He){const Ue=He[Je];Ue instanceof Se&&(Ue.isSpriteLoaded=ze,Ue.fire(new r.A("isSpriteLoaded")))}}}setImages(te,oe,xe){this.availableImages[te]||(this.availableImages[te]={});const{scope:ze,images:Ce}=oe;if(this.availableImages[te][ze]=Ce,this.workerSources[te]&&this.workerSources[te][ze]){for(const He in this.workerSources[te][ze]){const Je=this.workerSources[te][ze][He];for(const Ue in Je)Je[Ue].availableImages=Ce}xe()}else xe()}setModels(te,{scope:oe,models:xe},ze){if(this.availableModels[te]||(this.availableModels[te]={}),this.availableModels[te][oe]=xe,this.workerSources[te]&&this.workerSources[te][oe]){for(const Ce in this.workerSources[te][oe]){const He=this.workerSources[te][oe][Ce];for(const Je in He)He[Je].availableModels=xe}ze()}else ze()}setProjection(te,oe){this.projections[te]=r.ce(oe)}setBrightness(te,oe,xe){this.brightness=oe,xe()}setWorldview(te,oe,xe){this.worldview=oe,xe()}setLayers(te,oe,xe){this.getLayerIndex(te,oe.scope).replace(oe.layers,oe.options),xe()}updateLayers(te,oe,xe){this.getLayerIndex(te,oe.scope).update(oe.layers,oe.removedIds,oe.options),xe()}loadTile(te,oe,xe){oe.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,oe.type,oe.source,oe.scope).loadTile(oe,xe)}decodeRasterArray(te,oe,xe){this.getWorkerSource(te,oe.type,oe.source,oe.scope).decodeRasterArray(oe,xe)}reloadTile(te,oe,xe){oe.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,oe.type,oe.source,oe.scope).reloadTile(oe,xe)}abortTile(te,oe,xe){this.getWorkerSource(te,oe.type,oe.source,oe.scope).abortTile(oe,xe)}removeTile(te,oe,xe){this.getWorkerSource(te,oe.type,oe.source,oe.scope).removeTile(oe,xe)}removeSource(te,oe,xe){if(!(this.workerSources[te]&&this.workerSources[te][oe.scope]&&this.workerSources[te][oe.scope][oe.type]&&this.workerSources[te][oe.scope][oe.type][oe.source]))return;const ze=this.workerSources[te][oe.scope][oe.type][oe.source];delete this.workerSources[te][oe.scope][oe.type][oe.source],ze.removeSource!==void 0?ze.removeSource(oe,xe):xe()}loadWorkerSource(te,oe,xe){try{this.self.importScripts(oe.url),xe()}catch(ze){xe(ze.toString())}}syncRTLPluginState(te,oe,xe){if(r.fn.isParsed())xe(null,!0);else if(r.fn.isParsing())this.rtlPluginParsingListeners.push(xe);else try{r.fn.setState(oe);const ze=r.fn.getPluginURL();!r.fn.isLoaded()||r.fn.isParsed()||r.fn.isParsing()||ze==null||(r.fn.setState({pluginStatus:r.fo.parsing,pluginURL:r.fn.getPluginURL()}),this.self.importScripts(ze),r.fn.isParsed()?xe(null,!0):this.rtlPluginParsingListeners.push(xe))}catch(ze){xe(ze.toString())}}setDracoUrl(te,oe){this.dracoUrl=oe}getAvailableImages(te,oe){this.availableImages[te]||(this.availableImages[te]={});let xe=this.availableImages[te][oe];return xe||(xe=[]),xe}getAvailableModels(te,oe){this.availableModels[te]||(this.availableModels[te]={});let xe=this.availableModels[te][oe];return xe||(xe={}),xe}getLayerIndex(te,oe){this.layerIndexes[te]||(this.layerIndexes[te]={});let xe=this.layerIndexes[te][oe];return xe||(xe=this.layerIndexes[te][oe]=new Z,xe.scope=oe),xe}getWorkerSource(te,oe,xe,ze){const Ce=this.workerSources;return Ce[te]||(Ce[te]={}),Ce[te][ze]||(Ce[te][ze]={}),Ce[te][ze][oe]||(Ce[te][ze][oe]={}),this.isSpriteLoaded[te]||(this.isSpriteLoaded[te]={}),Ce[te][ze][oe][xe]||(Ce[te][ze][oe][xe]=new this.workerSourceTypes[oe]({send:(He,Je,Ue,tt,bt,rt)=>this.actor.send(He,Je,Ue,te,bt,rt),scheduler:this.actor.scheduler},this.getLayerIndex(te,ze),this.getAvailableImages(te,ze),this.getAvailableModels(te,ze),this.isSpriteLoaded[te][ze],void 0,this.brightness,this.worldview)),Ce[te][ze][oe][xe]}rasterizeImagesWorker(te,oe,xe){const ze=new Map;for(const[Ce,{image:He,imageVariant:Je}]of oe.tasks.entries()){const Ue=this.imageRasterizer.rasterize(Je,He,oe.scope,te);ze.set(Ce,Ue)}xe(void 0,ze)}removeRasterizedImages(te,oe,xe){this.imageRasterizer.removeImagesFromCacheByIds(oe.imageIds,oe.scope,te),xe()}enforceCacheSizeLimit(te,oe){r.fp(oe)}getWorkerPerformanceMetrics(te,oe,xe){xe(void 0,void 0)}}return r.fl(self)&&(self.worker=new Ei(self)),Ei}),C(["./shared"],function(r){var O="3.13.0";const V={create:"create",load:"load",fullLoad:"fullLoad"},U={mark(u){performance.mark(u)},measure(u,t,s){performance.measure(u,t,s)}};function Z(u){const t=u.name.split("?")[0];return r.a(t)&&t.includes("mapbox-gl.js")?"javascript":r.a(t)&&t.includes("mapbox-gl.css")?"css":r.b(t)?"fontRange":r.c(t)?"sprite":r.i(t)?"style":r.d(t)?"tilejson":"other"}var ie,de={},se=function(){if(ie)return de;function u(h){return!t(h)}function t(h){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,b,E=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(E);try{b=new Worker(I),v=!0}catch{v=!1}return b&&b.terminate(),URL.revokeObjectURL(I),v}()?function(){var v=document.createElement("canvas");v.width=v.height=1;var b=v.getContext("2d");if(!b)return!1;var E=b.getImageData(0,0,1,1);return E&&E.width===v.width}()?(s[g=h&&h.failIfMajorPerformanceCaveat]===void 0&&(s[g]=function(v){var b,E=function(I){var z=document.createElement("canvas"),L=Object.create(u.webGLContextAttributes);return L.failIfMajorPerformanceCaveat=I,z.getContext("webgl2",L)}(v);if(!E)return!1;try{b=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!b||E.isContextLost())&&(E.shaderSource(b,"void main() {}"),E.compileShader(b),E.getShaderParameter(b,E.COMPILE_STATUS)===!0)}(g)),s[g]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var g}ie=1,de.supported=u,de.notSupportedReason=t;var s={};return u.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},de}();function ne(u,t,s){const h=document.createElement(u);return t!=null&&(h.className=t),s&&s.appendChild(h),h}function Se(u,t,s){const h=document.createElementNS("http://www.w3.org/2000/svg",u);for(const g of Object.keys(t))h.setAttributeNS(null,g,String(t[g]));return s&&s.appendChild(h),h}const me=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Re=me&&me.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ye;function Le(){me&&Re&&(ye=me[Re],me[Re]="none")}function De(){me&&Re&&(me[Re]=ye)}function Oe(u){u.preventDefault(),u.stopPropagation(),window.removeEventListener("click",Oe,!0)}function Ee(){window.addEventListener("click",Oe,!0),window.setTimeout(()=>{window.removeEventListener("click",Oe,!0)},0)}function qe(u,t){const s=u.getBoundingClientRect();return et(u,s,t)}function $e(u,t){const s=u.getBoundingClientRect(),h=[];for(let g=0;g<t.length;g++)h.push(et(u,s,t[g]));return h}function Ge(u){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&u.button===2&&u.ctrlKey?0:u.button}function et(u,t,s){const h=u.offsetWidth===t.width?1:u.offsetWidth/t.width;return new r.P((s.clientX-t.left)*h,(s.clientY-t.top)*h)}const mt="01",St="NO_ACCESS_TOKEN";class xt{constructor(t,s,h){this._transformRequestFn=t,this._customAccessToken=s,this._silenceAuthErrors=!!h,this._createSkuToken()}_createSkuToken(){const t=function(){let s="";for(let h=0;h<10;h++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",mt,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,s){return this._transformRequestFn&&this._transformRequestFn(t,s)||{url:t}}normalizeStyleURL(t,s){if(!r.j(t))return t;const h=Ct(t);return h.params.push(`sdk=js-${O}`),h.path=`/styles/v1${h.path}`,this._makeAPIURL(h,this._customAccessToken||s)}normalizeGlyphsURL(t,s){if(!r.j(t))return t;const h=Ct(t);return h.path=`/fonts/v1${h.path}`,this._makeAPIURL(h,this._customAccessToken||s)}normalizeModelURL(t,s){if(!r.j(t))return t;const h=Ct(t);return h.path=`/models/v1${h.path}`,this._makeAPIURL(h,this._customAccessToken||s)}normalizeSourceURL(t,s,h,g){if(!r.j(t))return t;const v=Ct(t);return v.path=`/v4/${v.authority}.json`,v.params.push("secure"),h&&v.params.push(`language=${h}`),g&&v.params.push(`worldview=${g}`),this._makeAPIURL(v,this._customAccessToken||s)}normalizeIconsetURL(t,s){const h=Ct(t);return r.j(t)?(h.path=`/styles/v1${h.path}/iconset.pbf`,this._makeAPIURL(h,this._customAccessToken||s)):Ut(h)}normalizeSpriteURL(t,s,h,g){const v=Ct(t);return r.j(t)?(v.path=`/styles/v1${v.path}/sprite${s}${h}`,this._makeAPIURL(v,this._customAccessToken||g)):(v.path+=`${s}${h}`,Ut(v))}normalizeTileURL(t,s,h){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!r.j(t))return t;const g=Ct(t);g.path=g.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||h&&g.authority!=="raster"&&h===512?"@2x":""}${r.l.supported?".webp":"$1"}`),g.authority==="raster"?g.path=`/${r.e.RASTER_URL_PREFIX}${g.path}`:g.authority==="rasterarrays"?g.path=`/${r.e.RASTERARRAYS_URL_PREFIX}${g.path}`:g.authority==="3dtiles"?g.path=`/${r.e.TILES3D_URL_PREFIX}${g.path}`:(g.path=g.path.replace(/^.+\/v4\//,"/"),g.path=`/${r.e.TILE_URL_VERSION}${g.path}`);const v=this._customAccessToken||function(b){for(const E of b){const I=E.match(/^access_token=(.*)$/);if(I)return I[1]}return null}(g.params)||r.e.ACCESS_TOKEN;return r.e.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&g.params.push(`sku=${this._skuToken}`),this._makeAPIURL(g,v)}canonicalizeTileURL(t,s){const h=Ct(t);if(!h.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!h.path.match(/\.[\w]+$/))return t;let g="mapbox://";h.path.match(/^\/raster\/v1\//)?g+=`raster/${h.path.replace(`/${r.e.RASTER_URL_PREFIX}/`,"")}`:h.path.match(/^\/rasterarrays\/v1\//)?g+=`rasterarrays/${h.path.replace(`/${r.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:g+=`tiles/${h.path.replace(`/${r.e.TILE_URL_VERSION}/`,"")}`;let v=h.params;return s&&(v=v.filter(b=>!b.match(/^access_token=/))),v.length&&(g+=`?${v.join("&")}`),g}canonicalizeTileset(t,s){const h=!!s&&r.j(s),g=[];for(const v of t.tiles||[])r.k(v)?g.push(this.canonicalizeTileURL(v,h)):g.push(v);return g}_makeAPIURL(t,s){const h="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",g=Ct(r.e.API_URL);if(t.protocol=g.protocol,t.authority=g.authority,t.protocol==="http"){const v=t.params.indexOf("secure");v>=0&&t.params.splice(v,1)}if(g.path!=="/"&&(t.path=`${g.path}${t.path}`),!r.e.REQUIRE_ACCESS_TOKEN)return Ut(t);if(s=s||r.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${h}`);if(s[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${h}`)}return t.params=t.params.filter(v=>v.indexOf("access_token")===-1),t.params.push(`access_token=${s||""}`),Ut(t)}}const At=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ct(u){const t=u.match(At);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Ut(u){const t=u.params.length?`?${u.params.join("&")}`:"";return`${u.protocol}://${u.authority}${u.path}${t}`}const at="mapbox.eventData";function kt(u){if(!u)return null;const t=u.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(r.m(t[1]))}catch{return null}}class qt{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const s=kt(r.e.ACCESS_TOKEN);let h="";return h=s&&s.u?r.f(s.u):r.e.ACCESS_TOKEN||"",t?`${at}.${t}:${h}`:`${at}:${h}`}fetchEventData(){const t=r.s("localStorage"),s=this.getStorageKey(),h=this.getStorageKey("uuid");if(t)try{const g=localStorage.getItem(s);g&&(this.eventData=JSON.parse(g));const v=localStorage.getItem(h);v&&(this.anonId=v)}catch{r.w("Unable to read from LocalStorage")}}saveEventData(){const t=r.s("localStorage"),s=this.getStorageKey(),h=this.getStorageKey("uuid"),g=this.anonId;if(t&&g)try{localStorage.setItem(h,g),Object.keys(this.eventData).length>=1&&localStorage.setItem(s,JSON.stringify(this.eventData))}catch{r.w("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,s,h,g){if(!r.e.EVENTS_URL)return;const v=Ct(r.e.EVENTS_URL);v.params.push(`access_token=${g||r.e.ACCESS_TOKEN||""}`);const b={event:this.type,created:new Date(t).toISOString()},E=s?r.h(b,s):b,I={url:Ut(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=r.p(I,z=>{this.pendingRequest=null,h(z),this.saveEventData(),this.processRequests(g)})}queueRequest(t,s){this.queue.push(t),this.processRequests(s)}}const lt=new class extends qt{constructor(u){super("appUserTurnstile"),this._customAccessToken=u}postTurnstileEvent(u,t){r.e.EVENTS_URL&&r.e.ACCESS_TOKEN&&Array.isArray(u)&&u.some(s=>r.j(s)||r.k(s))&&this.queueRequest(Date.now(),t)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=kt(r.e.ACCESS_TOKEN),s=t?t.u:r.e.ACCESS_TOKEN;let h=s!==this.eventData.tokenU;r.v(this.anonId)||(this.anonId=r.u(),h=!0);const g=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),b=new Date(g),E=(g-this.eventData.lastSuccess)/864e5;h=h||E>=1||E<-1||v.getDate()!==b.getDate()}else h=!0;h?this.postEvent(g,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:mt,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=g,this.eventData.tokenU=s)},u):this.processRequests()}},Ht=lt.postTurnstileEvent.bind(lt),Nn=new class extends qt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(u,t,s,h){this.skuToken=t,this.errorCb=h,r.e.EVENTS_URL&&(s||r.e.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},s):this.errorCb(new Error(St)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:s}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),r.v(this.anonId)||(this.anonId=r.u()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:mt,skuToken:this.skuToken,userId:this.anonId},h=>{h?this.errorCb(h):t&&(this.success[t]=!0)},u))}remove(){this.errorCb=null}},zn=Nn.postMapLoadEvent.bind(Nn),xn=new class extends qt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(u){let t=this.mapInstanceIdMap.get(u);return t||(t=r.u(),this.mapInstanceIdMap.set(u,t)),t}getEventId(u){const t=this.eventIdPerMapInstanceMap.get(u)||0;return this.eventIdPerMapInstanceMap.set(u,t+1),t}postStyleLoadEvent(u,t){const{map:s,style:h,importedStyles:g}=t;if(!r.e.EVENTS_URL||!u&&!r.e.ACCESS_TOKEN)return;const v=this.getMapInstanceId(s),b={mapInstanceId:v,eventId:this.getEventId(v),style:h};g.length&&(b.importedStyles=g),this.queueRequest({timestamp:Date.now(),payload:b},u)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,payload:s}=this.queue.shift();this.postEvent(t,s,()=>{},u)}},An=xn.postStyleLoadEvent.bind(xn),ti=new class extends qt{constructor(){super("gljs.performance")}postPerformanceEvent(u,t){r.e.EVENTS_URL&&(u||r.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},u)}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:s}=this.queue.shift(),h=function(g){const v=performance.getEntriesByType("resource"),b=performance.getEntriesByType("mark"),E=function(q){const X={};if(q){for(const G in q)if(G!=="other")for(const Y of q[G]){const J=`${G}ResolveRangeMin`,re=`${G}ResolveRangeMax`,pe=`${G}RequestCount`,_e=`${G}RequestCachedCount`;X[J]=Math.min(X[J]||1/0,Y.startTime),X[re]=Math.max(X[re]||-1/0,Y.responseEnd);const Ae=Ie=>{X[Ie]===void 0&&(X[Ie]=0),++X[Ie]};Y.transferSize!==void 0&&Y.transferSize===0&&Ae(_e),Ae(pe)}}return X}(function(q,X){const G={};if(q)for(const Y of q){const J=X(Y);G[J]===void 0&&(G[J]=[]),G[J].push(Y)}return G}(v,Z)),I=window.devicePixelRatio,z=navigator.connection||navigator.mozConnection||navigator.webkitConnection,L=z?z.effectiveType:void 0,N={counters:[],metadata:[],attributes:[]},F=(q,X,G)=>{G!=null&&q.push({name:X,value:G.toString()})};for(const q in E)F(N.counters,q,E[q]);if(g.interactionRange[0]!==1/0&&g.interactionRange[1]!==-1/0&&(F(N.counters,"interactionRangeMin",g.interactionRange[0]),F(N.counters,"interactionRangeMax",g.interactionRange[1])),b)for(const q of Object.keys(V)){const X=V[q],G=b.find(Y=>Y.name===X);G&&F(N.counters,X,G.startTime)}return F(N.counters,"visibilityHidden",g.visibilityHidden),F(N.attributes,"style",function(q){if(q)for(const X of q){const G=X.name.split("?")[0];if(r.i(G)){const Y=G.split("/").slice(-2);if(Y.length===2)return`mapbox://styles/${Y[0]}/${Y[1]}`}}}(v)),F(N.attributes,"terrainEnabled",g.terrainEnabled?"true":"false"),F(N.attributes,"fogEnabled",g.fogEnabled?"true":"false"),F(N.attributes,"projection",g.projection),F(N.attributes,"zoom",g.zoom),F(N.metadata,"devicePixelRatio",I),F(N.metadata,"connectionEffectiveType",L),F(N.metadata,"navigatorUserAgent",navigator.userAgent),F(N.metadata,"screenWidth",window.screen.width),F(N.metadata,"screenHeight",window.screen.height),F(N.metadata,"windowWidth",window.innerWidth),F(N.metadata,"windowHeight",window.innerHeight),F(N.metadata,"mapWidth",g.width/I),F(N.metadata,"mapHeight",g.height/I),F(N.metadata,"webglRenderer",g.renderer),F(N.metadata,"webglVendor",g.vendor),F(N.metadata,"sdkVersion",O),F(N.metadata,"sdkIdentifier","mapbox-gl-js"),N}(s);for(const g of h.metadata);for(const g of h.counters);for(const g of h.attributes);this.postEvent(t,h,()=>{},u)}},Hn=ti.postPerformanceEvent.bind(ti),bn=new class extends qt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(u,t,s,h){if(!r.e.API_URL||!r.e.SESSION_PATH)return;const g=Ct(r.e.API_URL+r.e.SESSION_PATH);g.params.push(`sku=${t||""}`),g.params.push(`access_token=${h||r.e.ACCESS_TOKEN||""}`);const v={url:Ut(g),headers:{"Content-Type":"text/plain"}};this.pendingRequest=r.g(v,b=>{this.pendingRequest=null,s(b),this.saveEventData(),this.processRequests(h)})}getSessionAPI(u,t,s,h){this.skuToken=t,this.errorCb=h,r.e.SESSION_PATH&&r.e.API_URL&&(s||r.e.ACCESS_TOKEN?this.queueRequest({id:u,timestamp:Date.now()},s):this.errorCb(new Error(St)))}processRequests(u){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:s}=this.queue.shift();t&&this.success[t]||this.getSession(s,this.skuToken,h=>{h?this.errorCb(h):t&&(this.success[t]=!0)},u)}remove(){this.errorCb=null}},Zi=bn.getSessionAPI.bind(bn),Ci=new Set;function Yi(u,t){t?Ci.add(u):Ci.delete(u)}class Vn{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(t,s){this._updatedSourceCaches[t]=s,this.setDirty()}discardSourceCacheUpdate(t){delete this._updatedSourceCaches[t]}updateLayer(t){const s=t.scope;this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._updatedLayers[s].add(t.id),this.setDirty()}removeLayer(t){const s=t.scope;this._removedLayers[s]=this._removedLayers[s]||{},this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._removedLayers[s][t.id]=t,this._updatedLayers[s].delete(t.id),this._updatedPaintProps.delete(t.fqid),this.setDirty()}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const s in this._updatedLayers)t[s]=t[s]||{},t[s].updatedIds=Array.from(this._updatedLayers[s].values());for(const s in this._removedLayers)t[s]=t[s]||{},t[s].removedIds=Object.keys(this._removedLayers[s]);return t}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(t){this._updatedPaintProps.add(t.fqid),this.setDirty()}getUpdatedImages(t){return this._updatedImages[t]?Array.from(this._updatedImages[t].values()):[]}updateImage(t,s){this._updatedImages[s]=this._updatedImages[s]||new Set,this._updatedImages[s].add(r.I.toString(t)),this.setDirty()}resetUpdatedImages(t){this._updatedImages[t]&&this._updatedImages[t].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function ki(u){const{userImage:t}=u;return!!(t&&t.render&&t.render())&&(u.data.replace(new Uint8Array(t.data.buffer)),!0)}class zi extends r.E{constructor(t){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=t,t!=="raster"&&r.t()&&(this.imageRasterizerDispatcher=new r.D(r.x(),this,"Image Rasterizer Worker",1))}addScope(t){this.loaded.set(t,!1),this.imageProviders.set(t,new Map),this.images.set(t,new Map),this.updatedImages.set(t,new Set),this.callbackDispatchedThisFrame.set(t,new Set),this.patterns.set(t,new Map),this.atlasImage.set(t,new r.r({width:1,height:1}))}removeScope(t){this.loaded.delete(t),this.imageProviders.delete(t),this.images.delete(t),this.updatedImages.delete(t),this.callbackDispatchedThisFrame.delete(t),this.patterns.delete(t),this.atlasImage.delete(t);const s=this.atlasTexture.get(t);s&&(s.destroy(),this.atlasTexture.delete(t))}addImageProvider(t,s){this.imageProviders.has(s)||this.imageProviders.set(s,new Map),this.imageProviders.get(s).set(t.id,t)}removeImageProvider(t,s){this.imageProviders.has(s)&&this.imageProviders.get(s).delete(t)}getPendingImageProviders(){const t=[];for(const s of this.imageProviders.values())for(const h of s.values())h.hasPendingRequests()&&t.push(h);return t}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new r.y),this._imageRasterizer}isLoaded(){for(const t of this.loaded.keys())if(!this.loaded.get(t))return!1;return!0}setLoaded(t,s){if(this.loaded.get(s)!==t&&(this.loaded.set(s,t),t)){for(const{ids:h,callback:g}of this.requestors)this._notify(h,s,g);this.requestors=[]}}hasImage(t,s){return!!this.getImage(t,s)}getImage(t,s){return this.images.get(s).get(t.toString())}addImage(t,s,h){this._validate(t,h)&&this.images.get(s).set(t.toString(),h)}_validate(t,s){let h=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new r.z(new Error(`Image "${t.name}" has invalid "stretchX" value`))),h=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new r.z(new Error(`Image "${t.name}" has invalid "stretchY" value`))),h=!1),this._validateContent(s.content,s)||(this.fire(new r.z(new Error(`Image "${t.name}" has invalid "content" value`))),h=!1),h}_validateStretch(t,s){if(!t)return!0;let h=0;for(const g of t){if(g[0]<h||g[1]<g[0]||s<g[1])return!1;h=g[1]}return!0}_validateContent(t,s){return t?t.length!==4||!s.usvg&&(t[0]<0||s.data.width<t[0]||t[1]<0||s.data.height<t[1]||t[2]<0||s.data.width<t[2]||t[3]<0||s.data.height<t[3])?!1:!(t[2]<t[0]||t[3]<t[1]):!0}updateImage(t,s,h){const g=this.images.get(s).get(t.toString());h.version=g.version+1,this.images.get(s).set(t.toString(),h),this.updatedImages.get(s).add(t),this.removeFromImageRasterizerCache(t,s)}clearUpdatedImages(t){this.updatedImages.get(t).clear()}removeFromImageRasterizerCache(t,s){this.spriteFormat!=="raster"&&(r.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[t],scope:s}):this.imageRasterizer.removeImagesFromCacheByIds([t],s))}removeImage(t,s){const h=this.images.get(s),g=h.get(t.toString());h.delete(t.toString()),this.patterns.get(s).delete(t.toString()),this.removeFromImageRasterizerCache(t,s),g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(t){return Array.from(this.images.get(t).keys()).map(s=>r.I.from(s))}getImages(t,s,h){const g=[],v=[],b=this.imageProviders.get(s);for(const L of t){if(!L.iconsetId){g.push(L);continue}const N=b.get(L.iconsetId);N&&(this.getImage(L,s)?v.push(L):N.addPendingRequest(L))}if(g.length===0)return void this._notify(v,s,h);let E=!0;const I=!!this.loaded.get(s),z=this.images.get(s);if(!I)for(const L of g)z.has(L.toString())||(E=!1);I||E?this._notify(g,s,h):this.requestors.push({ids:g,scope:s,callback:h})}rasterizeImages(t,s){const h=new Map,{tasks:g,scope:v}=t;for(const[b,E]of g.entries()){const I=this.getImage(E.id,v);I&&h.set(b,{image:I,imageVariant:E})}this._rasterizeImages(v,h,s)}_rasterizeImages(t,s,h){if(r.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:s,scope:t},h);else{const g=new Map;for(const[v,{image:b,imageVariant:E}]of s.entries())g.set(v,this.imageRasterizer.rasterize(E,b,t,0));h(void 0,g)}}getUpdatedImages(t){return this.updatedImages.get(t)||new Set}_notify(t,s,h){const g=this.images.get(s),v=new Map;for(const b of t){if(!g.get(b.toString())){if(b.iconsetId)continue;this.fire(new r.A("styleimagemissing",{id:b.name}))}const E=g.get(b.toString());if(!E){r.w(`Image "${b.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const I={data:E.usvg?null:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,usvg:E.usvg,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)};E.usvg&&Object.assign(I,{width:E.icon.usvg_tree.width,height:E.icon.usvg_tree.height}),v.set(r.I.toString(b),I)}h(null,v)}getPixelSize(t){const{width:s,height:h}=this.atlasImage.get(t);return{width:s,height:h}}getPattern(t,s,h){const g=t.toString(),v=this.patterns.get(s),b=v.get(g),E=this.getImage(t,s);if(!E)return null;if(b){if(b.position.version===E.version)return b.position;b.position.version=E.version}else{if(E.usvg&&!E.data){const I=this.getPatternInFlightId(g,s);if(this.patternsInFlight.has(I))return null;this.patternsInFlight.add(I);const z=new r.B(t).scaleSelf(r.q.devicePixelRatio),L=new Map([[z.toString(),{image:E,imageVariant:z}]]);return this._rasterizeImages(s,L,(N,F)=>this.storePatternImage(z,s,E,h,F)),null}this.storePattern(t,s,E)}return this._updatePatternAtlas(s,h),v.get(g).position}getPatternInFlightId(t,s){return r.C(t,s)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(t,s,h,g,v){const b=t.toString(),E=v?v.get(b):void 0;E&&(h.data=E,this.storePattern(t.id,s,h),this._updatePatternAtlas(s,g),this.patternsInFlight.delete(this.getPatternInFlightId(t.id.toString(),s)))}storePattern(t,s,h){const g={w:h.data.width+2*r.F,h:h.data.height+2*r.F,x:0,y:0},v=new r.G(g,h,r.F);this.patterns.get(s).set(t.toString(),{bin:g,position:v})}bind(t,s){const h=t.gl;let g=this.atlasTexture.get(s);g?this.dirty&&(g.update(this.atlasImage.get(s)),this.dirty=!1):(g=new r.T(t,this.atlasImage.get(s),h.RGBA8),this.atlasTexture.set(s,g)),g.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(t,s){const h=this.patterns.get(t),g=Array.from(h.values()).map(({bin:z})=>z),{w:v,h:b}=r.H(g),E=this.atlasImage.get(t);E.resize({width:v||1,height:b||1});const I=this.images.get(t);for(const[z,{bin:L,position:N}]of h.entries()){let F=N.padding;const q=L.x+F,X=L.y+F,G=I.get(z).data,Y=G.width,J=G.height;F=F>1?F-1:F,r.r.copy(G,E,{x:0,y:0},{x:q,y:X},{width:Y,height:J},s),r.r.copy(G,E,{x:0,y:J-F},{x:q,y:X-F},{width:Y,height:F},s),r.r.copy(G,E,{x:0,y:0},{x:q,y:X+J},{width:Y,height:F},s),r.r.copy(G,E,{x:Y-F,y:0},{x:q-F,y:X},{width:F,height:J},s),r.r.copy(G,E,{x:0,y:0},{x:q+Y,y:X},{width:F,height:J},s),r.r.copy(G,E,{x:Y-F,y:J-F},{x:q-F,y:X-F},{width:F,height:F},s),r.r.copy(G,E,{x:0,y:J-F},{x:q+Y,y:X-F},{width:F,height:F},s),r.r.copy(G,E,{x:0,y:0},{x:q+Y,y:X+J},{width:F,height:F},s),r.r.copy(G,E,{x:Y-F,y:0},{x:q-F,y:X+J},{width:F,height:F},s)}this.dirty=!0}beginFrame(){for(const t of this.images.keys())this.callbackDispatchedThisFrame.set(t,new Set)}dispatchRenderCallbacks(t,s){const h=this.images.get(s);for(const g of t){if(this.callbackDispatchedThisFrame.get(s).has(g.toString()))continue;this.callbackDispatchedThisFrame.get(s).add(g.toString());const v=h.get(g.toString());ki(v)&&this.updateImage(g,s,v)}}}function Pr(u){const t=u.key,s=u.value,h=u.valueSpec||{},g=u.objectElementValidators||{},v=u.style,b=u.styleSpec;let E=[];const I=r.J(s);if(I!=="object")return[new r.V(t,s,`object expected, ${I} found`)];for(const z in s){const L=z.split(".")[0];let N;g[L]?N=g[L]:h[L]?N=or:g["*"]?N=g["*"]:h["*"]&&(N=or),N?E=E.concat(N({key:(t&&`${t}.`)+z,value:s[z],valueSpec:h[L]||h["*"],style:v,styleSpec:b,object:s,objectKey:z},s)):E.push(new r.K(t,s[z],`unknown property "${z}"`))}for(const z in h)g[z]||h[z].required&&h[z].default===void 0&&s[z]===void 0&&E.push(new r.V(t,s,`missing required property "${z}"`));return E}function Gr(u){const t=u.value,s=u.valueSpec,h=u.style,g=u.styleSpec,v=u.key,b=u.arrayElementValidator||or;if(r.J(t)!=="array")return[new r.V(v,t,`array expected, ${r.J(t)} found`)];if(s.length&&t.length!==s.length)return[new r.V(v,t,`array length ${s.length} expected, length ${t.length} found`)];if(s["min-length"]&&t.length<s["min-length"])return[new r.V(v,t,`array length at least ${s["min-length"]} expected, length ${t.length} found`)];let E={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};g.$version<7&&(E.function=s.function),r.J(s.value)==="object"&&(E=s.value);let I=[];for(let z=0;z<t.length;z++)I=I.concat(b({array:t,arrayIndex:z,value:t[z],valueSpec:E,style:h,styleSpec:g,key:`${v}[${z}]`},!0));return I}function ys(u){const t=u.key,s=u.value,h=u.valueSpec;let g=r.J(s);if(g==="number"&&s!=s&&(g="NaN"),g!=="number")return[new r.V(t,s,`number expected, ${g} found`)];if("minimum"in h){let v=h.minimum;if(r.J(h.minimum)==="array"&&(v=h.minimum[u.arrayIndex]),s<v)return[new r.V(t,s,`${s} is less than the minimum value ${v}`)]}if("maximum"in h){let v=h.maximum;if(r.J(h.maximum)==="array"&&(v=h.maximum[u.arrayIndex]),s>v)return[new r.V(t,s,`${s} is greater than the maximum value ${v}`)]}return[]}function zr(u){const t=u.valueSpec,s=r.M(u.value.type);let h,g,v,b={};const E=s!=="categorical"&&u.value.property===void 0,I=!E,z=r.J(u.value.stops)==="array"&&r.J(u.value.stops[0])==="array"&&r.J(u.value.stops[0][0])==="object",L=Pr({key:u.key,value:u.value,valueSpec:u.styleSpec.function,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(q){if(s==="identity")return[new r.V(q.key,q.value,'identity function may not have a "stops" property')];let X=[];const G=q.value;return X=X.concat(Gr({key:q.key,value:G,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:N})),r.J(G)==="array"&&G.length===0&&X.push(new r.V(q.key,G,"array must have at least one stop")),X},default:function(q){return or({key:q.key,value:q.value,valueSpec:t,style:q.style,styleSpec:q.styleSpec})}}});return s==="identity"&&E&&L.push(new r.V(u.key,u.value,'missing required property "property"')),s==="identity"||u.value.stops||L.push(new r.V(u.key,u.value,'missing required property "stops"')),s==="exponential"&&u.valueSpec.expression&&!r.N(u.valueSpec)&&L.push(new r.V(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(I&&!r.O(u.valueSpec)?L.push(new r.V(u.key,u.value,"property functions not supported")):E&&!r.Q(u.valueSpec)&&L.push(new r.V(u.key,u.value,"zoom functions not supported"))),s!=="categorical"&&!z||u.value.property!==void 0||L.push(new r.V(u.key,u.value,'"property" property is required')),L;function N(q){let X=[];const G=q.value,Y=q.key;if(r.J(G)!=="array")return[new r.V(Y,G,`array expected, ${r.J(G)} found`)];if(G.length!==2)return[new r.V(Y,G,`array length 2 expected, length ${G.length} found`)];if(z){if(r.J(G[0])!=="object")return[new r.V(Y,G,`object expected, ${r.J(G[0])} found`)];if(G[0].zoom===void 0)return[new r.V(Y,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new r.V(Y,G,"object stop key must have value")];const J=r.M(G[0].zoom);if(typeof J!="number")return[new r.V(Y,G[0].zoom,"stop zoom values must be numbers")];if(v&&v>J)return[new r.V(Y,G[0].zoom,"stop zoom values must appear in ascending order")];J!==v&&(v=J,g=void 0,b={}),X=X.concat(Pr({key:`${Y}[0]`,value:G[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:ys,value:F}}))}else X=X.concat(F({key:`${Y}[0]`,value:G[0],style:q.style,styleSpec:q.styleSpec},G));return r.S(r.U(G[1]))?X.concat([new r.V(`${Y}[1]`,G[1],"expressions are not allowed in function stops.")]):X.concat(or({key:`${Y}[1]`,value:G[1],valueSpec:t,style:q.style,styleSpec:q.styleSpec}))}function F(q,X){const G=r.J(q.value),Y=r.M(q.value),J=q.value!==null?q.value:X;if(h){if(G!==h)return[new r.V(q.key,J,`${G} stop domain type must match previous stop domain type ${h}`)]}else h=G;if(G!=="number"&&G!=="string"&&G!=="boolean"&&typeof Y!="number"&&typeof Y!="string"&&typeof Y!="boolean")return[new r.V(q.key,J,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&s!=="categorical"){let re=`number expected, ${G} found`;return r.O(t)&&s===void 0&&(re+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new r.V(q.key,J,re)]}return s!=="categorical"||G!=="number"||typeof Y=="number"&&isFinite(Y)&&Math.floor(Y)===Y?s!=="categorical"&&G==="number"&&typeof Y=="number"&&typeof g=="number"&&g!==void 0&&Y<g?[new r.V(q.key,J,"stop domain values must appear in ascending order")]:(g=Y,s==="categorical"&&Y in b?[new r.V(q.key,J,"stop domain values must be unique")]:(b[Y]=!0,[])):[new r.V(q.key,J,`integer expected, found ${String(Y)}`)]}}function Or(u){const t=(u.expressionContext==="property"?r.W:r.X)(r.U(u.value),u.valueSpec);if(t.result==="error")return t.value.map(h=>new r.V(`${u.key}${h.key}`,u.value,h.message));const s=t.value.expression||t.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!s.outputDefined())return[new r.V(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!r.Y(s))return[new r.V(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter")return sr(s,u);if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!r.Z(s,["zoom","feature-state"]))return[new r.V(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!r._(s))return[new r.V(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function sr(u,t){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const g of t.valueSpec.expression.parameters)s.delete(g);if(s.size===0)return[];const h=[];return u instanceof r.$&&s.has(u.name)?[new r.V(t.key,t.value,`["${u.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(u.eachChild(g=>{h.push(...sr(g,t))}),h)}function Ss(u){const t=u.key,s=u.value,h=u.valueSpec,g=[];return Array.isArray(h.values)?h.values.indexOf(r.M(s))===-1&&g.push(new r.V(t,s,`expected one of [${h.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(h.values).indexOf(r.M(s))===-1&&g.push(new r.V(t,s,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(s)} found`)),g}function as(u){return r.a1(r.U(u.value))?Or(r.L({},u,{expressionContext:"filter",valueSpec:u.styleSpec[`filter_${u.layerType||"fill"}`]})):Hi(u)}function Hi(u){const t=u.value,s=u.key;if(r.J(t)!=="array")return[new r.V(s,t,`array expected, ${r.J(t)} found`)];const h=u.styleSpec;let g,v=[];if(t.length<1)return[new r.V(s,t,"filter array must have at least 1 element")];switch(v=v.concat(Ss({key:`${s}[0]`,value:t[0],valueSpec:h.filter_operator,style:u.style,styleSpec:u.styleSpec})),r.M(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&r.M(t[1])==="$type"&&v.push(new r.V(s,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&v.push(new r.V(s,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(g=r.J(t[1]),g!=="string"&&v.push(new r.V(`${s}[1]`,t[1],`string expected, ${g} found`)));for(let b=2;b<t.length;b++)g=r.J(t[b]),r.M(t[1])==="$type"?v=v.concat(Ss({key:`${s}[${b}]`,value:t[b],valueSpec:h.geometry_type,style:u.style,styleSpec:u.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&v.push(new r.V(`${s}[${b}]`,t[b],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let b=1;b<t.length;b++)v=v.concat(Hi({key:`${s}[${b}]`,value:t[b],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":g=r.J(t[1]),t.length!==2?v.push(new r.V(s,t,`filter array for "${t[0]}" operator must have 2 elements`)):g!=="string"&&v.push(new r.V(`${s}[1]`,t[1],`string expected, ${g} found`))}return v}function Gs(u,t){const s=u.key,h=u.style,g=u.layer,v=u.styleSpec,b=u.value,E=u.objectKey,I=v[`${t}_${u.layerType}`];if(!I)return[];const z=E.match(/^(.*)-use-theme$/);if(t==="paint"&&z&&I[z[1]])return r.S(b)?[].concat(or({key:u.key,value:b,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:h,styleSpec:v,expressionContext:"property",propertyType:t,propertyKey:E})):or({key:s,value:b,valueSpec:{type:"string"},style:h,styleSpec:v});const L=E.match(/^(.*)-transition$/);if(t==="paint"&&L&&I[L[1]]&&I[L[1]].transition)return or({key:s,value:b,valueSpec:v.transition,style:h,styleSpec:v});const N=u.valueSpec||I[E];if(!N)return[new r.K(s,b,`unknown property "${E}"`)];let F;if(r.J(b)==="string"&&r.O(N)&&!N.tokens&&(F=/^{([^}]+)}$/.exec(b))){const X=`\`{ "type": "identity", "property": ${F?JSON.stringify(F[1]):'"_"'} }\``;return[new r.V(s,b,`"${E}" does not support interpolation syntax
Use an identity property function instead: ${X}.`)]}const q=[];if(u.layerType==="symbol")E!=="text-field"||!h||h.glyphs||h.imports||q.push(new r.V(s,b,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&r.a2(r.U(b))&&r.M(b.type)==="identity"&&q.push(new r.V(s,b,'"text-font" does not support identity functions'));else if(u.layerType==="model"&&t==="paint"&&g&&g.layout&&g.layout.hasOwnProperty("model-id")&&r.O(N)&&(r.a3(N)||r.Q(N))){const X=r.W(r.U(b),N),G=X.value.expression||X.value._styleExpression.expression;G&&!r.Z(G,["measure-light"])&&(E==="model-emissive-strength"&&r._(G)&&r.Y(G)||q.push(new r.V(s,b,`${E} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return q.concat(or({key:u.key,value:b,valueSpec:N,style:h,styleSpec:v,expressionContext:"property",propertyType:t,propertyKey:E}))}function ho(u){return Gs(u,"paint")}function Jr(u){return Gs(u,"layout")}function xr(u){let t=[];const s=u.value,h=u.key,g=u.style,v=u.styleSpec;s.type||s.ref||t.push(new r.V(h,s,'either "type" or "ref" is required'));let b=r.M(s.type);const E=r.M(s.ref);if(s.id){const I=r.M(s.id);for(let z=0;z<u.arrayIndex;z++){const L=g.layers[z];r.M(L.id)===I&&t.push(new r.V(h,s.id,`duplicate layer id "${s.id}", previously used at line ${L.id.__line__}`))}}if("ref"in s){let I;["type","source","source-layer","filter","layout"].forEach(z=>{z in s&&t.push(new r.V(h,s[z],`"${z}" is prohibited for ref layers`))}),g.layers.forEach(z=>{r.M(z.id)===E&&(I=z)}),I?I.ref?t.push(new r.V(h,s.ref,"ref cannot reference another ref layer")):b=r.M(I.type):typeof E=="string"&&t.push(new r.V(h,s.ref,`ref layer "${E}" not found`))}else if(b!=="background"&&b!=="sky"&&b!=="slot")if(s.source){const I=g.sources&&g.sources[s.source],z=I&&r.M(I.type);I?z==="vector"&&b==="raster"?t.push(new r.V(h,s.source,`layer "${s.id}" requires a raster source`)):z==="raster"&&b!=="raster"?t.push(new r.V(h,s.source,`layer "${s.id}" requires a vector source`)):z!=="vector"||s["source-layer"]?z==="raster-dem"&&b!=="hillshade"?t.push(new r.V(h,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):z!=="raster-array"||["raster","raster-particle"].includes(b)?b==="line"&&s.paint&&(s.paint["line-gradient"]||s.paint["line-trim-offset"])&&z==="geojson"&&!I.lineMetrics?t.push(new r.V(h,s,`layer "${s.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):b==="raster-particle"&&z!=="raster-array"&&t.push(new r.V(h,s.source,`layer "${s.id}" requires a 'raster-array' source.`)):t.push(new r.V(h,s.source,"raster-array source can only be used with layer type 'raster'.")):t.push(new r.V(h,s,`layer "${s.id}" must specify a "source-layer"`)):t.push(new r.V(h,s.source,`source "${s.source}" not found`))}else t.push(new r.V(h,s,'missing required property "source"'));return t=t.concat(Pr({key:h,value:s,valueSpec:v.layer,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{"*":()=>[],type:()=>or({key:`${h}.type`,value:s.type,valueSpec:v.layer.type,style:u.style,styleSpec:u.styleSpec,object:s,objectKey:"type"}),filter:I=>as(r.L({layerType:b},I)),layout:I=>Pr({layer:s,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":z=>Jr(r.L({layerType:b},z))}}),paint:I=>Pr({layer:s,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":z=>ho(r.L({layerType:b,layer:s},z))}})}})),t}function ci(u){const t=u.value,s=u.key,h=r.J(t);return h!=="string"?[new r.V(s,t,`string expected, ${h} found`)]:[]}const Cs={promoteId:function u({key:t,value:s}){if(r.J(s)==="string")return ci({key:t,value:s});if(Array.isArray(s)){const h=[],g=r.U(s),v=r.X(g);return v.result==="error"&&v.value.forEach(b=>{h.push(new r.V(`${t}${b.key}`,null,`${b.message}`))}),r.Z(v.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||h.push(new r.V(`${t}`,null,"promoteId expression should be only feature dependent")),h}{const h=[];for(const g in s)h.push(...u({key:`${t}.${g}`,value:s[g]}));return h}}};function Wr(u){const t=u.value,s=u.key,h=u.styleSpec,g=u.style;if(!t.type)return[new r.V(s,t,'"type" is required')];const v=r.M(t.type);let b=[];switch(["vector","raster","raster-dem","raster-array"].includes(v)&&(t.url||t.tiles||b.push(new r.K(s,t,'Either "url" or "tiles" is required.'))),v){case"vector":case"raster":case"raster-dem":case"raster-array":return b=b.concat(Pr({key:s,value:t,valueSpec:h[`source_${v.replace("-","_")}`],style:u.style,styleSpec:h,objectElementValidators:Cs})),b;case"geojson":if(b=Pr({key:s,value:t,valueSpec:h.source_geojson,style:g,styleSpec:h,objectElementValidators:Cs}),t.cluster)for(const E in t.clusterProperties){const[I,z]=t.clusterProperties[E],L=typeof I=="string"?[I,["accumulated"],["get",E]]:I;b.push(...Or({key:`${s}.${E}.map`,value:z,expressionContext:"cluster-map"})),b.push(...Or({key:`${s}.${E}.reduce`,value:L,expressionContext:"cluster-reduce"}))}return b;case"video":return Pr({key:s,value:t,valueSpec:h.source_video,style:g,styleSpec:h});case"image":return Pr({key:s,value:t,valueSpec:h.source_image,style:g,styleSpec:h});case"canvas":return[new r.V(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ss({key:`${s}.type`,value:t.type,valueSpec:{values:Ws(h)}})}}function Ws(u){return u.source.reduce((t,s)=>{const h=u[s];return h.type.type==="enum"&&(t=t.concat(Object.keys(h.type.values))),t},[])}function hi(u){const t=u.value,s=u.styleSpec,h=s.light,g=u.style;let v=[];const b=r.J(t);if(t===void 0)return v;if(b!=="object")return v=v.concat([new r.V("light",t,`object expected, ${b} found`)]),v;for(const E in t){const I=E.match(/^(.*)-transition$/),z=E.match(/^(.*)-use-theme$/);v=v.concat(z&&h[z[1]]?or({key:E,value:t[E],valueSpec:{type:"string"},style:g,styleSpec:s}):I&&h[I[1]]&&h[I[1]].transition?or({key:E,value:t[E],valueSpec:s.transition,style:g,styleSpec:s}):h[E]?or({key:E,value:t[E],valueSpec:h[E],style:g,styleSpec:s}):[new r.V(E,t[E],`unknown property "${E}"`)])}return v}function br(u){const t=u.value;let s=[];if(!t)return s;const h=r.J(t);if(h!=="object")return s=s.concat([new r.V("light-3d",t,`object expected, ${h} found`)]),s;const g=u.styleSpec,v=g["light-3d"],b=u.key,E=u.style,I=u.style.lights;for(const N of["type","id"])if(!(N in t))return s=s.concat([new r.V("light-3d",t,`missing property ${N} on light`)]),s;if(t.type&&I)for(let N=0;N<u.arrayIndex;N++){const F=r.M(t.type),q=I[N];r.M(q.type)===F&&s.push(new r.V(b,t.id,`duplicate light type "${t.type}", previously defined at line ${q.id.__line__}`))}const z=`properties_light_${t.type}`;if(!(z in g))return s=s.concat([new r.V("light-3d",t,`Invalid light type ${t.type}`)]),s;const L=g[z];for(const N in t)if(N==="properties"){const F=t[N],q=r.J(F);if(q!=="object")return s=s.concat([new r.V("properties",F,`object expected, ${q} found`)]),s;for(const X in F){const G=X.match(/^(.*)-transition$/),Y=X.match(/^(.*)-use-theme$/);s=s.concat(Y&&L[Y[1]]?or({key:N,value:F[X],valueSpec:{type:"string"},style:E,styleSpec:g}):G&&L[G[1]]&&L[G[1]].transition?or({key:N,value:t[N],valueSpec:g.transition,style:E,styleSpec:g}):L[X]?or({key:X,value:F[X],valueSpec:L[X],style:E,styleSpec:g}):[new r.K(u.key,F[X],`unknown property "${X}"`)])}}else s=s.concat(v[N]?or({key:N,value:t[N],valueSpec:v[N],style:E,styleSpec:g}):[new r.K(N,t[N],`unknown property "${N}"`)]);return s}function is(u){const t=u.value,s=u.key,h=u.style,g=u.styleSpec,v=g.terrain;let b=[];const E=r.J(t);if(t===void 0||E==="null")return b;if(E!=="object")return b=b.concat([new r.V("terrain",t,`object expected, ${E} found`)]),b;for(const I in t){const z=I.match(/^(.*)-transition$/),L=I.match(/^(.*)-use-theme$/);b=b.concat(L&&v[L[1]]?or({key:I,value:t[I],valueSpec:{type:"string"},style:h,styleSpec:g}):z&&v[z[1]]&&v[z[1]].transition?or({key:I,value:t[I],valueSpec:g.transition,style:h,styleSpec:g}):v[I]?or({key:I,value:t[I],valueSpec:v[I],style:h,styleSpec:g}):[new r.K(I,t[I],`unknown property "${I}"`)])}if(t.source){const I=h.sources&&h.sources[t.source],z=I&&r.M(I.type);I?z!=="raster-dem"&&b.push(new r.V(s,t.source,`terrain cannot be used with a source of type ${String(z)}, it only be used with a "raster-dem" source type`)):b.push(new r.V(s,t.source,`source "${t.source}" not found`))}else b.push(new r.V(s,t,'terrain is missing required property "source"'));return b}function ro(u){const t=u.value,s=u.style,h=u.styleSpec,g=h.fog;let v=[];const b=r.J(t);if(t===void 0)return v;if(b!=="object")return v=v.concat([new r.V("fog",t,`object expected, ${b} found`)]),v;for(const E in t){const I=E.match(/^(.*)-transition$/),z=E.match(/^(.*)-use-theme$/);v=v.concat(z&&g[z[1]]?or({key:E,value:t[E],valueSpec:{type:"string"},style:s,styleSpec:h}):I&&g[I[1]]&&g[I[1]].transition?or({key:E,value:t[E],valueSpec:h.transition,style:s,styleSpec:h}):g[E]?or({key:E,value:t[E],valueSpec:g[E],style:s,styleSpec:h}):[new r.K(E,t[E],`unknown property "${E}"`)])}return v}const Ca={"*":()=>[],array:Gr,boolean:function(u){const t=u.value,s=u.key,h=r.J(t);return h!=="boolean"?[new r.V(s,t,`boolean expected, ${h} found`)]:[]},number:ys,color:function(u){const t=u.key,s=u.value,h=r.J(s);return h!=="string"?[new r.V(t,s,`color expected, ${h} found`)]:r.a0.parseCSSColor(s)===null?[new r.V(t,s,`color expected, "${s}" found`)]:[]},enum:Ss,filter:as,function:zr,layer:xr,object:Pr,source:Wr,model:r.a4,light:hi,"light-3d":br,terrain:is,fog:ro,string:ci,formatted:function(u){return ci(u).length===0?[]:Or(u)},resolvedImage:function(u){return ci(u).length===0?[]:Or(u)},projection:function(u){const t=u.value,s=u.styleSpec,h=s.projection,g=u.style;let v=[];const b=r.J(t);if(b==="object")for(const E in t)v=v.concat(or({key:E,value:t[E],valueSpec:h[E],style:g,styleSpec:s}));else b!=="string"&&(v=v.concat([new r.V("projection",t,`object or string expected, ${b} found`)]));return v},import:function(u){const{value:t,styleSpec:s}=u,{data:h,...g}=t;Object.defineProperty(g,"__line__",{value:t.__line__,enumerable:!1});let v=Pr(r.L({},u,{value:g,valueSpec:s.import}));return r.M(g.id)===""&&v.push(new r.V(`${u.key}.id`,g,"import id can't be an empty string")),h&&(v=v.concat(Wl(h,s,{key:`${u.key}.data`}))),v},iconset:function(u){const t=u.value,s=u.key,h=u.styleSpec,g=u.style;if(!t.type)return[new r.V(s,t,'"type" is required')];const v=r.M(t.type);let b=[];if(b=b.concat(Pr({key:s,value:t,valueSpec:h[`iconset_${v}`],style:g,styleSpec:h})),v==="source"&&t.source){const E=g.sources&&g.sources[t.source],I=E&&r.M(E.type);E?I!=="raster-array"&&b.push(new r.V(s,t.source,`iconset cannot be used with a source of type ${String(I)}, it only be used with a "raster-array" source type`)):b.push(new r.V(s,t.source,`source "${t.source}" not found`))}return b}};function or(u,t=!1){const s=u.value,h=u.valueSpec,g=u.styleSpec;if(h.expression&&r.a2(r.M(s)))return zr(u);if(h.expression&&r.S(r.U(s)))return Or(u);if(h.type&&Ca[h.type]){const v=Ca[h.type](u);return t===!0&&v.length>0&&r.J(u.value)==="array"?Or(u):v}return Pr(r.L({},u,{valueSpec:h.type?g[h.type]:h}))}function qa(u){const t=u.value,s=u.key,h=ci(u);return h.length||(t.indexOf("{fontstack}")===-1&&h.push(new r.V(s,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&h.push(new r.V(s,t,'"glyphs" url must include a "{range}" token'))),h}function Wl(u,t=r.a5,s={}){return or({key:s.key||"",value:u,valueSpec:t.$root,styleSpec:t,style:u,objectElementValidators:{glyphs:qa,"*":()=>[]}})}function Ls(u,t=r.a5){return ze(Wl(u,t))}const Zl=u=>ze(Wr(u)),Sh=u=>ze(hi(u)),Kl=u=>ze(br(u)),Wt=u=>ze(is(u)),Ha=u=>ze(ro(u)),Td=u=>ze(function(t){const s=t.value,h=t.style,g=t.styleSpec,v=g.snow;let b=[];const E=r.J(s);if(s===void 0)return b;if(E!=="object")return b=b.concat([new r.V("snow",s,`object expected, ${E} found`)]),b;for(const I in s){const z=I.match(/^(.*)-transition$/);b=b.concat(z&&v[z[1]]&&v[z[1]].transition?or({key:I,value:s[I],valueSpec:g.transition,style:h,styleSpec:g}):v[I]?or({key:I,value:s[I],valueSpec:v[I],style:h,styleSpec:g}):[new r.K(I,s[I],`unknown property "${I}"`)])}return b}(u)),Rc=u=>ze(function(t){const s=t.value,h=t.style,g=t.styleSpec,v=g.rain;let b=[];const E=r.J(s);if(s===void 0)return b;if(E!=="object")return b=b.concat([new r.V("rain",s,`object expected, ${E} found`)]),b;for(const I in s){const z=I.match(/^(.*)-transition$/);b=b.concat(z&&v[z[1]]&&v[z[1]].transition?or({key:I,value:s[I],valueSpec:g.transition,style:h,styleSpec:g}):v[I]?or({key:I,value:s[I],valueSpec:v[I],style:h,styleSpec:g}):[new r.K(I,s[I],`unknown property "${I}"`)])}return b}(u)),Ei=u=>ze(xr(u)),it=u=>ze(as(u)),te=u=>ze(ho(u)),oe=u=>ze(Jr(u)),xe=u=>ze(r.a4(u));function ze(u){return u.slice().sort((t,s)=>t.line&&s.line?t.line-s.line:0)}function Ce(u,t){let s=!1;if(t&&t.length)for(const h of t)h instanceof r.K?r.w(h.message):(u.fire(new r.z(new Error(h.message))),s=!0);return s}let He;class Je extends r.E{constructor(t,s="flat"){super(),this._transitionable=new r.a6(He||(He=new r.a7({anchor:new r.a8(r.a5.light.anchor),position:new r.a9(r.a5.light.position),color:new r.a8(r.a5.light.color),intensity:new r.a8(r.a5.light.intensity)}))),this.setLight(t,s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,s,h={}){this._validate(Sh,t,h)||(this._transitionable.setTransitionOrValue(t),this.id=s)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,h){return(!h||h.validate!==!1)&&Ce(this,t.call(Ls,r.h({value:s,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let Ue=class extends r.E{constructor(u,t,s,h,g){super(),this.scope=s,this._transitionable=new r.a6(new r.a7({source:new r.a8(r.a5.terrain.source),exaggeration:new r.a8(r.a5.terrain.exaggeration)}),s,h),this._transitionable.setTransitionOrValue(u,h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t,this.worldview=g}get(){return this._transitionable.serialize()}set(u,t){this._transitionable.setTransitionOrValue(u,t)}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}getExaggeration(u){return this._transitioning.possiblyEvaluate(new r.aa(u,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const u=this._transitionable._values.exaggeration;if(!u)return null;const t=u.value.expression;if(!t)return null;let s=-1,h=-1,g=1;for(const v of t.zoomStops)g=t.evaluate(new r.aa(v,{worldview:this.worldview})),g>.01?(s=v,h=-1):h=v;return g<.01&&s>0&&h>s?[s,h]:null}isZoomDependent(){const u=this._transitionable._values.exaggeration;return u!=null&&u.value!=null&&u.value.expression!=null&&u.value.expression instanceof r.ab}};const tt=45,bt=65,rt=.05;function Gt(u,t,s,h){const g=r.af(tt,bt,s),[v,b]=an(u,h);let E=1-Math.min(1,Math.exp((t-v)/(b-v)*-6));return E*=E*E,E=Math.min(1,1.00747*E),E*g*u.alpha}function an(u,t){const s=.5/Math.tan(.5*t);return[u.range[0]+s,u.range[1]+s]}function hn(u,t,s,h,g){const v=r.ad([],[t,s,h],g.mercatorFogMatrix);return Gt(u,r.ae(v),g.pitch,g._fov)}function Rn(u,t,s,h,g,v,b){const E=[[s,h,0],[g,h,0],[g,v,0],[s,v,0]];let I=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(const L of E){const N=r.ad([],L,t),F=r.ae(N);I=Math.min(I,F),z=Math.max(z,F)}return[Gt(u,I,b.pitch,b._fov),Gt(u,z,b.pitch,b._fov)]}class Ln extends r.E{constructor(t,s,h,g){super();const v=new r.a7({range:new r.a8(r.a5.fog.range),color:new r.a8(r.a5.fog.color),"color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new r.a8(r.a5.fog["high-color"]),"high-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new r.a8(r.a5.fog["space-color"]),"space-color-use-theme":new r.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new r.a8(r.a5.fog["horizon-blend"]),"star-intensity":new r.a8(r.a5.fog["star-intensity"]),"vertical-range":new r.a8(r.a5.fog["vertical-range"])});this._transitionable=new r.a6(v,h,new Map(g)),this.set(t,g),this._transitioning=this._transitionable.untransitioned(),this._transform=s,this.properties=new r.ag(v),this.scope=h}get state(){const t=this._transform,s=t.projection.name==="globe",h=r.ah(t.zoom),g=this.properties.get("range"),v=[.5,3];return{range:s?[r.ai(v[0],g[0],h),r.ai(v[1],g[1],h)]:g,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,s,h={}){if(this._validate(Ha,t,h))return;const g=r.h({},t);for(const v of Object.keys(r.a5.fog))g[v]===void 0&&(g[v]=r.a5.fog[v].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const s=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.af(tt,bt,t))*s.a}getOpacityAtLatLng(t,s){return this._transform.projection.supportsFog?function(h,g,v){const b=r.ac.fromLngLat(g),E=v.elevation?v.elevation.getAtPointOrZero(b):0;return hn(h,b.x,b.y,E,v)}(this.state,t,s):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const s=this._transform.calculateFogTileMatrix(t.toUnwrapped());return Rn(this.state,s,0,0,r.aj,r.aj,this._transform)}getOpacityForBounds(t,s,h,g,v){return this._transform.projection.supportsFog?Rn(this.state,t,s,h,g,v,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?an(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const s=[4,5,6,7];for(const h of s){const g=t.points[h];let v;if(g[2]>=0)v=g;else{const b=t.points[h-4];v=r.ak(b,g,b[2]/(b[2]-g[2]))}if(hn(this.state,v[0],v[1],0,this._transform)>=rt)return!0}return!1}updateConfig(t){this._transitionable.setTransitionOrValue(this._options,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,h){return(!h||h.validate!==!1)&&Ce(this,t.call(Ls,r.h({value:s,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}}let On,ni,Un,Ki,fi=class extends r.E{constructor(u,t,s,h){super();const g=On||(On=new r.a7({density:new r.a8(r.a5.snow.density),intensity:new r.a8(r.a5.snow.intensity),color:new r.a8(r.a5.snow.color),opacity:new r.a8(r.a5.snow.opacity),vignette:new r.a8(r.a5.snow.vignette),"vignette-color":new r.a8(r.a5.snow["vignette-color"]),"center-thinning":new r.a8(r.a5.snow["center-thinning"]),direction:new r.a8(r.a5.snow.direction),"flake-size":new r.a8(r.a5.snow["flake-size"])}));this._transitionable=new r.a6(g,s,new Map(h)),this.set(u,h),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ag(g),this.scope=s}get state(){const u=this.properties.get("opacity"),t=this.properties.get("color"),s=this.properties.get("direction"),h=r.al(s[0]),g=-Math.max(r.al(s[1]),.01),v=[Math.cos(h)*Math.cos(g),Math.sin(h)*Math.cos(g),Math.sin(g)],b=this.properties.get("vignette"),E=this.properties.get("vignette-color");return E.a=b,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.am(t.r,t.g,t.b,t.a*u),direction:v,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(u,t,s={}){if(this._validate(Td,u,s))return;const h=r.h({},u);for(const g of Object.keys(r.a5.snow))h[g]===void 0&&(h[g]=r.a5.snow[g].default);this._options=h,this._transitionable.setTransitionOrValue(this._options,t)}updateConfig(u){this._transitionable.setTransitionOrValue(this._options,new Map(u))}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,t,s){return(!s||s.validate!==!1)&&Ce(this,u.call(Ls,r.h({value:t,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}},pr=class extends r.E{constructor(u,t,s,h){super();const g=ni||(ni=new r.a7({density:new r.a8(r.a5.rain.density),intensity:new r.a8(r.a5.rain.intensity),color:new r.a8(r.a5.rain.color),opacity:new r.a8(r.a5.rain.opacity),vignette:new r.a8(r.a5.rain.vignette),"vignette-color":new r.a8(r.a5.rain["vignette-color"]),"center-thinning":new r.a8(r.a5.rain["center-thinning"]),direction:new r.a8(r.a5.rain.direction),"droplet-size":new r.a8(r.a5.rain["droplet-size"]),"distortion-strength":new r.a8(r.a5.rain["distortion-strength"])}));this._transitionable=new r.a6(g,s,new Map(h)),this.set(u,h),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ag(g),this.scope=s}get state(){const u=this.properties.get("opacity"),t=this.properties.get("color"),s=this.properties.get("direction"),h=r.al(s[0]),g=-Math.max(r.al(s[1]),.01),v=[Math.cos(h)*Math.cos(g),Math.sin(h)*Math.cos(g),Math.sin(g)],b=this.properties.get("vignette-color");return b.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.am(t.r,t.g,t.b,t.a*u),direction:v,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:b}}get(){return this._transitionable.serialize()}set(u,t,s={}){if(this._validate(Rc,u,s))return;const h=r.h({},u);for(const g of Object.keys(r.a5.rain))h[g]===void 0&&(h[g]=r.a5.rain[g].default);this._options=h,this._transitionable.setTransitionOrValue(this._options,t)}updateConfig(u){this._transitionable.setTransitionOrValue(this._options,new Map(u))}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,t,s){return(!s||s.validate!==!1)&&Ce(this,u.call(Ls,r.h({value:t,style:{glyphs:!0,sprite:!0},styleSpec:r.a5})))}};class Li extends r.E{constructor(t,s,h,g){super(),this.scope=h,this._options=t,this.properties=new r.ag(s),this._transitionable=new r.a6(s,h,new Map(g)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,s){this._options=t,this._transitionable.setTransitionOrValue(t.properties,s)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Ii{constructor(t,s,h,g){this.screenBounds=t,this.cameraPoint=s,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=h,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,g)}static createFromScreenPoints(t,s){let h,g;if(t instanceof r.P||typeof t[0]=="number"){const v=r.P.convert(t);h=[v],g=s.isPointAboveHorizon(v)}else{const v=r.P.convert(t[0]),b=r.P.convert(t[1]),E=v.add(b)._div(2);h=[v,b],g=r.ao(v,b).every(I=>s.isPointAboveHorizon(I))&&s.isPointAboveHorizon(E)}return new Ii(h,s.getCameraPoint(),g,s)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return r.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const s=this.screenBounds[0],h=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],g=r.ao(s,h,0,!1);return this.cameraPoint.y>h.y&&(this.cameraPoint.x>s.x&&this.cameraPoint.x<h.x?g.splice(3,0,this.cameraPoint):this.cameraPoint.x>=h.x?g[2]=this.cameraPoint:this.cameraPoint.x<=s.x&&(g[3]=this.cameraPoint)),r.ap(g,t)}bufferedCameraGeometryGlobe(t){const s=this.screenBounds[0],h=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],g=r.ao(s,h,t),v=this.cameraPoint.clone();switch(3*((v.y>s.y)+(v.y>h.y))+((v.x>s.x)+(v.x>h.x))){case 0:g[0]=v,g[4]=v.clone();break;case 1:g.splice(1,0,v);break;case 2:g[1]=v;break;case 3:g.splice(4,0,v);break;case 5:g.splice(2,0,v);break;case 6:g[3]=v;break;case 7:g.splice(3,0,v);break;case 8:g[2]=v}return g}containsTile(t,s,h,g=0){const v=t.queryPadding/s._pixelsPerMercatorPixel+1,b=h?this._bufferedCameraMercator(v,s):this._bufferedScreenMercator(v,s);let E=t.tileID.wrap+(b.unwrapped?g:0);const I=b.polygon.map(Y=>r.aq(t.tileTransform,Y,E));if(!r.ar(I,0,0,r.aj,r.aj))return;E=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?g:0);const z=this.screenGeometryMercator.polygon.map(Y=>r.as(t.tileTransform,Y,E)),L=z.map(Y=>new r.P(Y[0],Y[1])),N=s.getFreeCameraOptions().position||new r.ac(0,0,0),F=r.as(t.tileTransform,N,E),q=z.map(Y=>{const J=r.at(Y,Y,F);return r.au(J,J),new r.av(F,J)}),X=r.aw(t,1,s.zoom)*s._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:L,tilespaceRays:q,bufferedTilespaceGeometry:I,bufferedTilespaceBounds:(G=r.ax(I),G.min.x=r.ay(G.min.x,0,r.aj),G.min.y=r.ay(G.min.y,0,r.aj),G.max.x=r.ay(G.max.x,0,r.aj),G.max.y=r.ay(G.max.y,0,r.aj),G),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:X};var G}_bufferedScreenMercator(t,s){const h=Sr(t);if(this._screenRaycastCache[h])return this._screenRaycastCache[h];{let g;return g=s.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(t),s):{polygon:this.bufferedScreenGeometry(t).map(v=>s.pointCoordinate3D(v)),unwrapped:!0},this._screenRaycastCache[h]=g,g}}_bufferedCameraMercator(t,s){const h=Sr(t);if(this._cameraRaycastCache[h])return this._cameraRaycastCache[h];{let g;return g=s.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),s):{polygon:this.bufferedCameraGeometry(t).map(v=>s.pointCoordinate3D(v)),unwrapped:!0},this._cameraRaycastCache[h]=g,g}}_projectAndResample(t,s){const h=function(v,b){const E=r.az([],b.pixelMatrix,b.globeMatrix),I=[0,-r.aB,0,1],z=[0,r.aB,0,1],L=[0,0,0,1];r.aA(I,I,E),r.aA(z,z,E),r.aA(L,L,E);const N=new r.P(I[0]/I[3],I[1]/I[3]),F=new r.P(z[0]/z[3],z[1]/z[3]),q=r.aC(v,N)&&I[3]<L[3],X=r.aC(v,F)&&z[3]<L[3];if(!q&&!X)return null;const G=function(Te,ve,Pe){for(let Me=1;Me<Te.length;Me++){const We=Lr(ve.pointCoordinate3D(Te[Me-1]).x),Qe=Lr(ve.pointCoordinate3D(Te[Me]).x);if(Pe<0){if(We<Qe)return{idx:Me,t:-We/(Qe-1-We)}}else if(Qe<We)return{idx:Me,t:(1-We)/(Qe+1-We)}}return null}(v,b,q?-1:1);if(!G)return null;const{idx:Y,t:J}=G;let re=Y>1?kr(v.slice(0,Y),b):[],pe=Y<v.length?kr(v.slice(Y),b):[];re=re.map(Te=>new r.P(Lr(Te.x),Te.y)),pe=pe.map(Te=>new r.P(Lr(Te.x),Te.y));const _e=[...re];_e.length===0&&_e.push(pe[pe.length-1]);const Ae=r.ai(_e[_e.length-1].y,(pe.length===0?re[0]:pe[0]).y,J);let Ie;return Ie=q?[new r.P(0,Ae),new r.P(0,0),new r.P(1,0),new r.P(1,Ae)]:[new r.P(1,Ae),new r.P(1,1),new r.P(0,1),new r.P(0,Ae)],_e.push(...Ie),pe.length===0?_e.push(re[0]):_e.push(...pe),{polygon:_e.map(Te=>new r.ac(Te.x,Te.y)),unwrapped:!1}}(t,s);if(h)return h;const g=function(v,b){let E=!1,I=-1/0,z=0;for(let N=0;N<v.length-1;N++)v[N].x>I&&(I=v[N].x,z=N);for(let N=0;N<v.length-1;N++){const F=(z+N)%(v.length-1),q=v[F],X=v[F+1];Math.abs(q.x-X.x)>.5&&(q.x<X.x?(q.x+=1,F===0&&(v[v.length-1].x+=1)):(X.x+=1,F+1===v.length-1&&(v[0].x+=1)),E=!0)}const L=r.aD(b.center.lng);return E&&L<Math.abs(L-1)&&v.forEach(N=>{N.x-=1}),{polygon:v,unwrapped:E}}(kr(t,s).map(v=>new r.P(Lr(v.x),v.y)),s);return{polygon:g.polygon.map(v=>new r.ac(v.x,v.y)),unwrapped:g.unwrapped}}}function kr(u,t){return r.aE(u,s=>{const h=t.pointCoordinate3D(s);s.x=h.x,s.y=h.y},1/256)}function Lr(u){return u<0?1+u%1:u%1}function Sr(u){return 100*u|0}function ds(u,t,s,h,g){const v=function(E,I){if(E)return g(E);if(I){if(u.url&&I.tiles&&u.tiles&&delete u.tiles,I.variants){if(!Array.isArray(I.variants))return g(new Error("variants must be an array"));for(const L of I.variants){if(L==null||typeof L!="object"||L.constructor!==Object)return g(new Error("variant must be an object"));if(!Array.isArray(L.capabilities))return g(new Error("capabilities must be an array"));if(L.capabilities.length===1&&L.capabilities[0]==="meshopt"){I=r.h(I,L);break}}}const z=r.aF(r.h({},I,u),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);z.tiles=t.canonicalizeTileset(z,u.url),g(null,z)}},b=function(E,I,z){if(!E)return null;if(!I&&!z)return E;z=z||E.worldview_default;const L=Object.values(E.language||{});if(L.length===0)return null;const N=Object.values(E.worldview||{});if(N.length===0)return null;const F=L.every(X=>X===I),q=N.every(X=>X===z);return F&&q?E:I in(E.language_options||{})||z in(E.worldview_options||{})?null:E.language_options&&E.worldview_options?E:null}(u.data,s,h);return b?r.q.frame(()=>v(null,b)):u.url?r.n(t.transformRequest(t.normalizeSourceURL(u.url,null,s,h),r.R.Source),v):r.q.frame(()=>{const{data:E,...I}=u;v(null,I)})}function ls(u,t){const s=Math.pow(2,t.z),h=Math.floor(r.aD(u.getWest())*s),g=Math.floor(r.aH(u.getNorth())*s),v=Math.ceil(r.aD(u.getEast())*s),b=Math.ceil(r.aH(u.getSouth())*s);return t.x>=h&&t.x<v&&t.y>=g&&t.y<b}class so{constructor(t,s,h){this.bounds=t?r.aG.convert(this.validateBounds(t)):null,this.minzoom=s||0,this.maxzoom=h||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}addExtraBounds(t){if(t){this.extraBounds||(this.extraBounds=[]);for(const s of t)this.extraBounds.push(r.aG.convert(this.validateBounds(s)))}}contains(t){if(t.z>this.maxzoom||t.z<this.minzoom||this.bounds&&!ls(this.bounds,t))return!1;if(!this.extraBounds)return!0;for(const s of this.extraBounds)if(ls(s,t))return!0;return!1}static fromTileJSON(t){if(!t.bounds&&!t.extra_bounds)return null;const s=new so(t.bounds,t.minzoom,t.maxzoom);return s.addExtraBounds(t.extra_bounds),s}}class Ao extends r.E{constructor(t,s,h,g){if(super(),this.id=t,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.h(this,r.aF(s,["url","scheme","tileSize","promoteId"])),this._options=r.h({type:"vector"},s),this._collectResourceTiming=!!s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g),this._tileWorkers={},this._deduped=new r.aI}load(t){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map.getWorldview();this._tileJSONRequest=ds(this._options,this.map._requestManager,s,h,(g,v)=>{if(this._tileJSONRequest=null,this._loaded=!0,g)s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),h&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new r.z(g));else if(v){if(r.h(this,v),this.hasWorldviews=!!v.worldview_options,v.worldview_default&&(this.worldviewDefault=v.worldview_default),v.vector_layers){this.vectorLayers=v.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const b of v.vector_layers)this.vectorLayerIds.push(b.id),v.worldview&&v.worldview[b.source]&&this.localizableLayerIds.add(b.id)}this.tileBounds=so.fromTileJSON(v),Ht(v.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}t&&t(g)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(t){this.cancelTileJSONRequest()}serialize(){return r.h({},this._options)}loadTile(t,s){const h=t.tileID.canonical.url(this.tiles,this.scheme),g=this.map._requestManager.normalizeTileURL(h),v=this.map._requestManager.transformRequest(g,r.R.Tile),b=this.map.style?this.map.style.getLut(this.scope):null,E=b?{image:b.image.clone()}:null,I={request:v,data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,lut:E,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&r.j(h)&&(I.localizableLayerIds=this.localizableLayerIds),I.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired")t.state==="loading"?t.reloadCallback=s:t.request=t.actor.send("reloadTile",I,z.bind(this));else if(t.actor=this._tileWorkers[g]=this._tileWorkers[g]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",I,z.bind(this),void 0,!0);else{const L=r.aJ.call({deduped:this._deduped},I,(N,F)=>{N||!F?z.call(this,N):(I.data={cacheControl:F.cacheControl,expires:F.expires,rawData:F.rawData.slice(0)},t.actor&&t.actor.send("loadTile",I,z.bind(this),void 0,!0))},!0);t.request={cancel:L}}function z(L,N){return delete t.request,t.aborted?s(null):L&&L.status!==404?s(L):(N&&N.resourceTiming&&(t.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&N&&t.setExpiryData(N),t.loadVectorData(N,this.map.painter),r.aK(this.dispatcher),s(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t,s){t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ds extends r.E{constructor(t,s,h,g){super(),this.id=t,this.dispatcher=h,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.h({type:"raster"},s),r.h(this,r.aF(s,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));const s=this.map.getWorldview();this._tileJSONRequest=ds(this._options,this.map._requestManager,null,s,(h,g)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new r.z(h)):g&&(r.h(this,g),g.raster_layers&&(this.rasterLayers=g.raster_layers,this.rasterLayerIds=this.rasterLayers.map(v=>v.id)),this.tileBounds=so.fromTileJSON(g),Ht(g.tiles),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),t&&t(h)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(t){this.cancelTileJSONRequest()}serialize(){return r.h({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,s){const h=r.q.devicePixelRatio>=2,g=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),h,this.tileSize);t.request=r.o(this.map._requestManager.transformRequest(g,r.R.Tile),(v,b,E,I)=>(delete t.request,t.aborted?(t.state="unloaded",s(null)):v?(t.state="errored",s(v)):b?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:E,expires:I}),t.setTexture(b,this.map.painter),t.state="loaded",r.aK(this.dispatcher),void s(null)):s(null)))}abortTile(t,s){t.request&&(t.request.cancel(),delete t.request),s&&s()}unloadTile(t,s){t.texture&&t.texture instanceof r.T?(t.destroy(!0),t.texture&&t.texture instanceof r.T&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),s&&s()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Xl extends Ds{constructor(t,s,h,g){super(t,s,h,g),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=r.h({type:"raster-array"},s)}triggerRepaint(t){const s=this.map.painter._terrain,h=this.map.style.getSourceCache(this.id);s&&s.enabled&&h&&s._clearRenderCacheForTile(h.id,t.tileID),this.map.triggerRepaint()}loadTile(t,s){const h=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),g=this.map._requestManager.transformRequest(h,r.R.Tile),v={request:g,uid:t.uid,tileID:t.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};t.source=this.id,t.scope=this.scope,t.requestParams=g,t.actor||(t.actor=this.dispatcher.getActor());const b=(E,I,z,L)=>{if(delete t.request,t.aborted)return t.state="unloaded",s(null);if(E)return E.name==="AbortError"?void 0:(t.state="errored",s(E));if(this.map._refreshExpiredTiles&&I&&t.setExpiryData({cacheControl:z,expires:L}),this.partial)t.state="empty";else{if(!I)return s(null);t.state="loaded",t._isHeaderLoaded=!0,t._mrt=I}s(null)};t.request=this.partial?t.fetchHeader(void 0,b.bind(this)):t.actor.send("loadTile",v,b.bind(this),void 0,!0)}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t,s){const h=t.texture;h&&h instanceof r.T?(t.destroy(!0),this.map.painter.saveTileTexture(h)):(t.destroy(),t.flushQueues(),t._isHeaderLoaded=!1,delete t._mrt,delete t.textureDescriptor),t.fbo&&(t.fbo.destroy(),delete t.fbo),delete t.request,delete t.requestParams,delete t.neighboringTiles,t.state="unloaded"}prepareTile(t,s,h){t._isHeaderLoaded&&(t.state!=="empty"&&(t.state="reloading"),t.fetchBand(s,h,(g,v)=>{if(g)return t.state="errored",this.fire(new r.z(g)),void this.triggerRepaint(t);v&&(t._isHeaderLoaded=!0,t.setTexture(v,this.map.painter),t.state="loaded",this.triggerRepaint(t))}))}getInitialBand(t){if(!this.rasterLayers)return 0;const s=this.rasterLayers.find(({id:v})=>v===t),h=s&&s.fields,g=h&&h.bands&&h.bands;return g?g[0]:0}getTextureDescriptor(t,s,h){if(!t)return;const g=s.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!g)return;let v=null;s instanceof r.aN?v=s.paint.get("raster-array-band"):s instanceof r.aO&&(v=s.paint.get("raster-particle-array-band"));const b=v||this.getInitialBand(g);if(b!=null)if(t.textureDescriptor){if(!t.updateNeeded(g,b)||h)return Object.assign({},t.textureDescriptor,{texture:t.texture})}else this.prepareTile(t,g,b)}getImages(t,s){const h=new Map;for(const g of t)for(const v of s){const[b,E]=v.split("/"),I=g.getLayer(b);if(!I||!I.hasBand(E)||!I.hasDataForBand(E))continue;const{bytes:z,tileSize:L,buffer:N}=I.getBandView(E),F=L+2*N,q={data:new r.r({width:F,height:F},z),pixelRatio:2,sdf:!1,usvg:!1,version:0};h.set(v,q)}return h}}const Sd={vector:Ao,raster:Ds,"raster-dem":class extends Ds{constructor(u,t,s,h){super(u,t,s,h),this.type="raster-dem",this.maxzoom=22,this._options=r.h({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(u,t){const s=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function h(g,v){g&&(u.state="errored",t(g)),v&&(u.dem=v,u.dem.onDeserialize(),u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0,u.state="loaded",t(null))}u.request=r.o(this.map._requestManager.transformRequest(s,r.R.Tile),(function(g,v,b,E){if(delete u.request,u.aborted)u.state="unloaded",t(null);else if(g)u.state="errored",t(g);else if(v){this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:b,expires:E});const I=ImageBitmap&&v instanceof ImageBitmap&&r.t(),z=1-(v.width-r.aL(v.width))/2;z<1||u.neighboringTiles||(u.neighboringTiles=this._getNeighboringTiles(u.tileID));const L=I?v:r.q.getImageData(v,z),N={uid:u.uid,tileID:u.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:L,encoding:this.encoding,padding:z};u.actor&&u.state!=="expired"||(u.actor=this.dispatcher.getActor(),u.actor.send("loadTile",N,h.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(u){const t=u.canonical,s=Math.pow(2,t.z),h=(t.x-1+s)%s,g=t.x===0?u.wrap-1:u.wrap,v=(t.x+1+s)%s,b=t.x+1===s?u.wrap+1:u.wrap,E={};return E[new r.aM(u.overscaledZ,g,t.z,h,t.y).key]={backfilled:!1},E[new r.aM(u.overscaledZ,b,t.z,v,t.y).key]={backfilled:!1},t.y>0&&(E[new r.aM(u.overscaledZ,g,t.z,h,t.y-1).key]={backfilled:!1},E[new r.aM(u.overscaledZ,u.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},E[new r.aM(u.overscaledZ,b,t.z,v,t.y-1).key]={backfilled:!1}),t.y+1<s&&(E[new r.aM(u.overscaledZ,g,t.z,h,t.y+1).key]={backfilled:!1},E[new r.aM(u.overscaledZ,u.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},E[new r.aM(u.overscaledZ,b,t.z,v,t.y+1).key]={backfilled:!1}),E}},"raster-array":Xl,geojson:class extends r.E{constructor(u,t,s,h){super(),this.id=u,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=s.getActor(),this.setEventedParent(h),this._data=t.data,this._options=r.h({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.minzoom!==void 0&&(this.minzoom=t.minzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const g=r.aj/this.tileSize;this.workerOptions=r.h({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*g,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*g,extent:r.aj,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:r.aj,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*g,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter,dynamic:t.dynamic},t.workerOptions)}onAdd(u){this.map=u,this.setData(this._data)}setData(u){return this._data=u,this._updateWorkerData(),this}updateData(u){if(!this._options.dynamic)return this.fire(new r.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof u!="string"&&(u.type==="Feature"&&(u={type:"FeatureCollection",features:[u]}),u.type!=="FeatureCollection"))return this.fire(new r.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof u!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const t=new Map;for(const s of this._data.features)t.set(s.id,s);for(const s of u.features)t.set(s.id,s);this._data.features=[...t.values()]}else this._data=u;return this._updateWorkerData(!0),this}getClusterExpansionZoom(u,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:u,source:this.id,scope:this.scope},t),this}getClusterChildren(u,t){return this.actor.send("geojson.getClusterChildren",{clusterId:u,source:this.id,scope:this.scope},t),this}getClusterLeaves(u,t,s,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:u,limit:t,offset:s},h),this}_updateWorkerData(u=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.A("dataloading",{dataType:"source"})),this._loaded=!1;const t=r.h({append:u},this.workerOptions);t.scope=this.scope;const s=this._data;typeof s=="string"?(t.request=this.map._requestManager.transformRequest(r.q.resolveURL(s),r.R.Source),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(s),this._pendingLoad=this.actor.send(`${this.type}.loadData`,t,(h,g)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new r.z(h));else{const v={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(v.resourceTiming=g.resourceTiming[this.id]),u&&(this._partialReload=!0),this.fire(new r.A("data",v)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(u),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const u=r.C(this.id,this.scope);this.map.style.clearSource(u),this._updateWorkerData()}loadTile(u,t){const s=u.actor?"reloadTile":"loadTile";u.actor=this.actor;const h=this.map.style?this.map.style.getLut(this.scope):null,g=h?{image:h.image.clone()}:null,v=this._partialReload,b={type:this.type,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:g,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:u.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:v,worldview:this.map.getWorldview()};u.request=this.actor.send(s,b,(E,I)=>v&&!I?(u.state="loaded",t(null)):(delete u.request,u.destroy(),u.aborted?t(null):E?t(E):(u.loadVectorData(I,this.map.painter,s==="reloadTile"),t(null))),void 0,s==="loadTile")}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.aborted=!0}unloadTile(u,t){this.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id,scope:this.scope}),u.destroy()}onRemove(u){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.h({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends r.aP{constructor(u,t,s,h){super(u,t,s,h),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const u=this.options;this.urls=[];for(const t of u.urls)this.urls.push(this.map._requestManager.transformRequest(t,r.R.Source).url);r.aQ(this.urls,(t,s)=>{this._loaded=!0,t?this.fire(new r.z(t)):s&&(this.video=s,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(u){if(this.video){const t=this.video.seekable;u<t.start(0)||u>t.end(0)?this.fire(new r.z(new r.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=u}}getVideo(){return this.video}onAdd(u){this.map||(this.map=u,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const u=this.map.painter.context,t=u.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new r.T(u,this.video,t.RGBA8),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(u)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:r.aP,model:class extends r.E{constructor(u,t,s,h){super(),this.id=u,this.type="model",this.models=[],this._loaded=!1,this._options=t}load(){const u=[];for(const t in this._options.models){const s=this._options.models[t],h=r.aS(this.map._requestManager.transformRequest(s.uri,r.R.Model).url).then(g=>{if(!g)return;const v=r.aT(g),b=new r.aU(t,s.position,s.orientation,v);b.computeBoundsAndApplyParent(),this.models.push(b)}).catch(g=>{this.fire(new r.z(new Error(`Could not load model ${t} from ${s.uri}: ${g.message}`)))});u.push(h)}Promise.allSettled(u).then(()=>{this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(t=>{this._loaded=!0,this.fire(new r.z(new Error(`Could not load models: ${t.message}`)))})}onAdd(u){this.map=u,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(u,t){}serialize(){return this._options}},"batched-model":class extends r.E{constructor(u,t,s,h){super(),this.type="batched-model",this.id=u,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=s,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(h)}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest();const u=r.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(u))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(u){this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map.getWorldview();this._tileJSONRequest=ds(this._options,this.map._requestManager,t,s,(h,g)=>{this._tileJSONRequest=null,this._loaded=!0,h?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),s&&s.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new r.z(h))):g&&(r.h(this,g),g.bounds&&(this.tileBounds=new so(g.bounds,this.minzoom,this.maxzoom)),Ht(g.tiles,this.map._requestManager._customAccessToken),this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))),u&&u(h)})}hasTransition(){return!1}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loaded(){return this._loaded}loadTile(u,t){const s=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),h={request:this.map._requestManager.transformRequest(s,r.R.Tile),data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:u.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:r.q.devicePixelRatio,promoteId:this.promoteId};if(u.actor&&u.state!=="expired")if(u.state==="loading")u.reloadCallback=t;else{if(u.buckets){const v=Object.values(u.buckets);for(const b of v)b.dirty=!0;return void(u.state="loaded")}u.request=u.actor.send("reloadTile",h,g.bind(this))}else u.actor=this.dispatcher.getActor(),u.request=u.actor.send("loadTile",h,g.bind(this),void 0,!0);function g(v,b){return u.aborted?t(null):v&&v.status!==404?t(v):(this.map._refreshExpiredTiles&&b&&u.setExpiryData(b),u.loadModelData(b,this.map.painter),u.state="loaded",void t(null))}}serialize(){return r.h({},this._options)}},canvas:class extends r.aP{constructor(u,t,s,h){super(u,t,s,h),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(v=>typeof v!="number"))||this.fire(new r.z(new r.V(`sources.${u}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.z(new r.V(`sources.${u}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new r.z(new r.V(`sources.${u}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof HTMLCanvasElement||this.fire(new r.z(new r.V(`sources.${u}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.z(new r.V(`sources.${u}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(u){this.map=u,this.load(),this.canvas&&this.animate&&this.play()}onRemove(u){this.pause()}prepare(){let u=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,u=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,u=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?!u&&!this._playing||this.texture instanceof r.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.T(t,this.canvas,t.gl.RGBA8,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const u of[this.canvas.width,this.canvas.height])if(isNaN(u)||u<=0)return!0;return!1}},custom:class extends r.E{constructor(u,t,s,h){super(),this.id=u,this.type="custom",this._dataType="raster",this._dispatcher=s,this._implementation=t,this.setEventedParent(h),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new so(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),r.h(this,r.aF(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(u){this.map=u,this._loaded=!1,this.fire(new r.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(u),this.load()}onRemove(u){this._implementation.onRemove&&this._implementation.onRemove(u)}hasTile(u){if(this._implementation.hasTile){const{x:t,y:s,z:h}=u.canonical;return this._implementation.hasTile({x:t,y:s,z:h})}return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,t){const{x:s,y:h,z:g}=u.tileID.canonical,v=new AbortController;u.request=Promise.resolve(this._implementation.loadTile({x:s,y:h,z:g},{signal:v.signal})).then((function(b){return delete u.request,u.aborted?(u.state="unloaded",t(null)):b===void 0?(u.state="errored",t(null)):b===null?(this.loadTileData(u,{width:this.tileSize,height:this.tileSize,data:null}),u.state="loaded",t(null)):function(E){return E instanceof ImageData||E instanceof HTMLCanvasElement||E instanceof ImageBitmap||E instanceof HTMLImageElement}(b)?(this.loadTileData(u,b),u.state="loaded",void t(null)):(u.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(b=>{b.name!=="AbortError"&&(u.state="errored",t(b))}),u.request.cancel=()=>v.abort()}loadTileData(u,t){u.setTexture(t,this.map.painter)}unloadTile(u,t){if(u.texture&&u.texture instanceof r.T?(u.destroy(!0),u.texture&&u.texture instanceof r.T&&this.map.painter.saveTileTexture(u.texture)):u.destroy(),this._implementation.unloadTile){const{x:s,y:h,z:g}=u.tileID.canonical;this._implementation.unloadTile({x:s,y:h,z:g})}t&&t()}abortTile(u,t){u.request&&u.request.cancel&&(u.request.cancel(),delete u.request),t&&t()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(u=>({x:u.canonical.x,y:u.canonical.y,z:u.canonical.z}))}_clearTiles(){const u=r.C(this.id,this.scope);this.map.style.clearSource(u)}_update(){this.fire(new r.A("data",{dataType:"source",sourceDataType:"content"}))}}},Yl=function(u,t,s,h){const g=new Sd[t.type](u,t,s,h);if(g.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${g.id}`);return r.aV(["load","abort","unload","serialize","prepare"],g),g};function Ql(u,t,s=""){return`${s}:${t.id||""}:${t.layer.id}:${function(h){if("layerId"in h)return`layer:${h.layerId}`;{const{featuresetId:g,importId:v}=h;return`featureset:${g}${v?`:import:${v}`:""}`}}(u.target)}`}function Jl(u,t,s,h=""){if(u.uniqueFeatureID){const g=Ql(u,t,h);if(s.has(g))return!0;s.add(g)}return!1}function zc(u,t,s,h,g=!1){const v=t.sourceCache.transform,b=t.sourceCache.tilesIn(u,t.has3DLayers,g);b.sort(Cu);const E=[];for(const I of b){const z=I.tile.queryRenderedFeatures(t,I,s,h,v,g);Object.keys(z).length&&E.push({wrappedTileID:I.tile.tileID.wrapped().key,queryResults:z})}return E.length===0?{}:function(I){const z={},L={};for(const N of I){const F=N.queryResults,q=N.wrappedTileID,X=L[q]=L[q]||{};for(const G in F){const Y=F[G],J=X[G]=X[G]||{},re=z[G]=z[G]||[];for(const pe of Y)J[pe.featureIndex]||(J[pe.featureIndex]=!0,re.push(pe))}}return z}(E)}function Lc(u,t,s,h,g,v){const b={},E=h.queryRenderedSymbols(u),I=[];for(const z of Object.keys(E).map(Number))I.push(g[z]);I.sort(Cu);for(const z of I){const L=z.featureIndex.lookupSymbolFeatures(E[z.bucketInstanceId],z.bucketIndex,z.sourceLayerIndex,t,s,v);for(const N in L){const F=b[N]=b[N]||[],q=L[N];q.sort((X,G)=>{const Y=z.featureSortOrder;if(Y){const J=Y.indexOf(X.featureIndex);return Y.indexOf(G.featureIndex)-J}return G.featureIndex-X.featureIndex});for(const X of q)F.push(X)}}return b}function Ch(u,t){const s=u.getRenderableIds().map(v=>u.getTileByID(v)),h=[],g={};for(let v=0;v<s.length;v++){const b=s[v],E=b.tileID.canonical.key;g[E]||(g[E]=!0,b.querySourceFeatures(h,t))}return h}function Cu(u,t){const s=u.tileID,h=t.tileID;return s.overscaledZ-h.overscaledZ||s.canonical.y-h.canonical.y||s.wrap-h.wrap||s.canonical.x-h.canonical.x}function fa(u,t){const s={};if(!t)return s;for(const h of u){const g=h.layerIds.map(v=>t.getLayer(v)).filter(Boolean);if(g.length!==0){h.layers=g,h.stateDependentLayerIds&&(h.stateDependentLayers=h.stateDependentLayerIds.map(v=>g.filter(b=>b.id===v)[0]));for(const v of g)s[v.fqid]=h}}return s}const Io=32,po=33,_l=new Uint16Array(8184);for(let u=0;u<2046;u++){let t=u+2,s=0,h=0,g=0,v=0,b=0,E=0;for(1&t?g=v=b=Io:s=h=E=Io;(t>>=1)>1;){const z=s+g>>1,L=h+v>>1;1&t?(g=s,v=h,s=b,h=E):(s=g,h=v,g=b,v=E),b=z,E=L}const I=4*u;_l[I+0]=s,_l[I+1]=h,_l[I+2]=g,_l[I+3]=v}const ia=new Uint16Array(2178),ar=new Uint8Array(1089),Eu=new Uint16Array(1089);function Ea(u){return u===0?-.03125:u===32?.03125:0}const Dc={type:2,extent:r.aj,loadGeometry:()=>[[new r.P(0,0),new r.P(r.aj+1,0),new r.P(r.aj+1,r.aj+1),new r.P(0,r.aj+1),new r.P(0,0)]]};class ec{constructor(t,s,h,g,v,b){this.tileID=t,this.uid=r.a$(),this.uses=0,this.tileSize=s,this.tileZoom=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,g&&g.style&&(this._lastUpdatedBrightness=g.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",g&&g.transform&&(this.projection=g.transform.projection),this.worldview=b}registerFadeDuration(t){const s=t+this.timeAdded;s<r.q.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=r.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,s,h){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=fa(t.buckets,s.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const v=this.buckets[g];if(v instanceof r.b1){if(this.hasSymbolBuckets=!0,!h)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const v=this.buckets[g];if(v instanceof r.b1&&v.hasRTLText){this.hasRTLText=!0,r.b2();break}}this.queryPadding=0;for(const g in this.buckets){const v=this.buckets[g],b=s.style.getOwnLayer(g);if(!b)continue;const E=b.queryRadius(v);this.queryPadding=Math.max(this.queryPadding,E)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new r.b0}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(t,s,h){t&&(t.resourceTiming&&(this.resourceTiming=t.resourceTiming),this.buckets=Object.assign({},this.buckets,fa(t.buckets,s.style)),t.featureIndex&&(this.latestFeatureIndex=t.featureIndex))}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const g in this.buckets){const v=this.buckets[g];v.uploadPending()&&v.upload(t)}const s=t.gl,h=this.imageAtlas;h&&!h.uploaded&&(this.imageAtlasTexture=new r.T(t,h.image,s.RGBA8,{useMipmap:!!h.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new r.T(t,this.glyphAtlasImage,s.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new r.T(t,this.lineAtlas.image,s.R8),this.lineAtlas.uploaded=!0)}prepare(t,s,h){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,h),!s||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const g=s.style.getBrightness();(this._lastUpdatedBrightness||g)&&(this._lastUpdatedBrightness&&g&&Math.abs(this._lastUpdatedBrightness-g)<.001||(this.updateBuckets(s,this._lastUpdatedBrightness!==g),this._lastUpdatedBrightness=g))}queryRenderedFeatures(t,s,h,g,v,b){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const E=function(I,z){const L=r.bn([],[.5*I.width,.5*-I.height,1]);return r.bo(L,L,[1,-1,0]),r.az(L,L,I.calculateProjMatrix(z.toUnwrapped())),Float32Array.from(L)}(v,this.tileID);return this.latestFeatureIndex.query(t,{tilespaceGeometry:s,pixelPosMatrix:E,transform:g,availableImages:h,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(t,s){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const g=h.loadVTLayers(),v=s?s.sourceLayer:"",b=g._geojsonTileLayer||g[v];if(!b)return;const E=r.b3(s&&s.filter),{z:I,x:z,y:L}=this.tileID.canonical,N={z:I,x:z,y:L};for(let F=0;F<b.length;F++){const q=b.feature(F);if(E.needGeometry){const Y=r.b4(q,!0);if(!E.filter(new r.aa(this.tileID.overscaledZ,{worldview:this.worldview}),Y,this.tileID.canonical))continue}else if(!E.filter(new r.aa(this.tileID.overscaledZ,{worldview:this.worldview}),q))continue;const X=h.getId(q,v),G=new r.b5(q,I,z,L,X);G.tile=N,t.push(G)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(t){const s=this.expirationTime;if(t.cacheControl){const h=r.b6(t.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const h=Date.now();let g=!1;if(this.expirationTime>h)g=!1;else if(s)if(this.expirationTime<s)g=!0;else{const v=this.expirationTime-s;v?this.expirationTime=h+Math.max(v,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(t){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&t&&this.updateBuckets(t)}updateBuckets(t,s){if(!this.latestFeatureIndex||!t.style)return;const h=this.latestFeatureIndex.loadVTLayers(),g=t.style.listImages(),v=t.style.getBrightness();for(const b in this.buckets){if(!t.style.hasLayer(b))continue;const E=this.buckets[b],I=E.layers[0],z=I.sourceLayer||"_geojsonTileLayer",L=h[z],N=t.style.getLayerSourceCache(I);let F={};N&&(F=N._state.getState(z,void 0));const q=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},X=Object.keys(F).length>0&&!s;X&&!E.stateDependentLayers.length&&!s||E.update(F,L,g,q,X?E.stateDependentLayers:E.layers,s,v),(E instanceof r.b7||E instanceof r.b8)&&t._terrain&&t._terrain.enabled&&N&&E.uploadPending()&&t._terrain._clearRenderCacheForTile(N.id,this.tileID);const G=t&&t.style&&t.style.getOwnLayer(b);G&&(this.queryPadding=Math.max(this.queryPadding,G.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<r.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=r.q.now()+t}setTexture(t,s){const h=s.context,g=h.gl;this.texture=this.texture||s.getTileTexture(t.width),this.texture&&this.texture instanceof r.T?this.texture.update(t):(this.texture=new r.T(h,t,g.RGBA8,{useMipmap:!0}),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE))}setDependencies(t,s){const h={};for(const g of s)h[g]=!0;this.dependencies[t]=h}hasDependency(t,s){for(const h of t){const g=this.dependencies[h];if(g){for(const v of s)if(g[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const h=r.b9(Dc,this.tileID.canonical,this.tileTransform)[0],g=new r.ba,v=new r.bb;for(let b=0;b<h.length;b++){const{x:E,y:I}=h[b];g.emplaceBack(E,I),v.emplaceBack(b)}v.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(v),this._tileDebugBuffer=t.createVertexBuffer(g,r.bc.members),this._tileDebugSegments=r.bd.simpleSegment(0,0,g.length,v.length)}_makeTileBoundsBuffers(t,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const h=r.b9(Dc,this.tileID.canonical,this.tileTransform)[0];let g,v;if(this.isRaster){const b=function(E,I){const z=r.aW(E,I),L=Math.pow(2,E.z);for(let Y=0;Y<po;Y++)for(let J=0;J<po;J++){const re=r.aX((E.x+(J+Ea(J))/Io)/L),pe=r.aY((E.y+(Y+Ea(Y))/Io)/L),_e=I.project(re,pe),Ae=Y*po+J;ia[2*Ae+0]=Math.round((_e.x*z.scale-z.x)*r.aj),ia[2*Ae+1]=Math.round((_e.y*z.scale-z.y)*r.aj)}ar.fill(0),Eu.fill(0);for(let Y=2045;Y>=0;Y--){const J=4*Y,re=_l[J+0],pe=_l[J+1],_e=_l[J+2],Ae=_l[J+3],Ie=re+_e>>1,Te=pe+Ae>>1,ve=Ie+Te-pe,Pe=Te+re-Ie,Me=pe*po+re,We=Ae*po+_e,Qe=Te*po+Ie,ft=Math.hypot((ia[2*Me+0]+ia[2*We+0])/2-ia[2*Qe+0],(ia[2*Me+1]+ia[2*We+1])/2-ia[2*Qe+1])>=16;ar[Qe]=ar[Qe]||(ft?1:0),Y<1022&&(ar[Qe]=ar[Qe]||ar[(pe+Pe>>1)*po+(re+ve>>1)]||ar[(Ae+Pe>>1)*po+(_e+ve>>1)])}const N=new r.aZ,F=new r.a_;let q=0;function X(Y,J){const re=J*po+Y;return Eu[re]===0&&(N.emplaceBack(ia[2*re+0],ia[2*re+1],Y*r.aj/Io,J*r.aj/Io),Eu[re]=++q),Eu[re]-1}function G(Y,J,re,pe,_e,Ae){const Ie=Y+re>>1,Te=J+pe>>1;if(Math.abs(Y-_e)+Math.abs(J-Ae)>1&&ar[Te*po+Ie])G(_e,Ae,Y,J,Ie,Te),G(re,pe,_e,Ae,Ie,Te);else{const ve=X(Y,J),Pe=X(re,pe),Me=X(_e,Ae);F.emplaceBack(ve,Pe,Me)}}return G(0,0,Io,Io,Io,0),G(Io,Io,0,0,0,Io),{vertices:N,indices:F}}(this.tileID.canonical,s);g=b.vertices,v=b.indices}else{g=new r.aZ,v=new r.a_;for(const{x:E,y:I}of h)g.emplaceBack(E,I,0,0);const b=r.be(g.int16.subarray(0,4*g.length),void 0,4);for(let E=0;E<b.length;E+=3)v.emplaceBack(b[E],b[E+1],b[E+2])}this._tileBoundsBuffer=t.createVertexBuffer(g,r.bf.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(v),this._tileBoundsSegments=r.bd.simpleSegment(0,0,g.length,v.length)}_makeGlobeTileDebugBuffers(t,s){const h=s.projection;if(!h||h.name!=="globe"||s.freezeTileCoverage)return;const g=this.tileID.canonical,v=r.bg(g,s),b=r.bh(v),E=r.ah(s.zoom);let I;E>0&&(I=r.bi(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,g,s,b,I,E),this._makeGlobeTileDebugTextBuffer(t,g,s,b,I,E)}_globePoint(t,s,h,g,v,b,E){let I=r.bj(t,s,h);if(b){const z=1<<h.z,L=r.aD(g.center.lng),N=r.aH(g.center.lat),F=(h.x+.5)/z-L;let q=0;F>.5?q=-1:F<-.5&&(q=1);let X=(t/r.aj+h.x)/z+q,G=(s/r.aj+h.y)/z;X=(X-L)*g._pixelsPerMercatorPixel+L,G=(G-N)*g._pixelsPerMercatorPixel+N;const Y=[X*g.worldSize,G*g.worldSize,0];r.ad(Y,Y,b),I=r.bk(I,Y,E)}return r.ad(I,I,v)}_makeGlobeTileDebugBorderBuffer(t,s,h,g,v,b){const E=new r.ba,I=new r.bb,z=new r.bl,L=(F,q,X,G,Y)=>{const J=(X-F)/(Y-1),re=(G-q)/(Y-1),pe=E.length;for(let _e=0;_e<Y;_e++){const Ae=F+_e*J,Ie=q+_e*re;E.emplaceBack(Ae,Ie);const Te=this._globePoint(Ae,Ie,s,h,g,v,b);z.emplaceBack(Te[0],Te[1],Te[2]),I.emplaceBack(pe+_e)}},N=r.aj;L(0,0,N,0,16),L(N,0,N,N,16),L(N,N,0,N,16),L(0,N,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(I),this._tileDebugBuffer=t.createVertexBuffer(E,r.bc.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(z,r.bm.members),this._tileDebugSegments=r.bd.simpleSegment(0,0,E.length,I.length)}_makeGlobeTileDebugTextBuffer(t,s,h,g,v,b){const E=r.aj/4,I=new r.ba,z=new r.a_,L=new r.bl,N=25;z.reserve(32),I.reserve(N),L.reserve(N);const F=(q,X)=>N*q+X;for(let q=0;q<N;q++){const X=q*E;for(let G=0;G<N;G++){const Y=G*E;I.emplaceBack(Y,X);const J=this._globePoint(Y,X,s,h,g,v,b);L.emplaceBack(J[0],J[1],J[2])}}for(let q=0;q<4;q++)for(let X=0;X<4;X++){const G=F(q,X),Y=F(q,X+1),J=F(q+1,X),re=F(q+1,X+1);z.emplaceBack(G,Y,J),z.emplaceBack(J,Y,re)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(z),this._tileDebugTextBuffer=t.createVertexBuffer(I,r.bc.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(L,r.bm.members),this._tileDebugTextSegments=r.bd.simpleSegment(0,0,N,32)}destroy(t=!1){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof r.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}r.bp.setPbf(r.bq);class Oc extends ec{constructor(t,s,h,g,v){super(t,s,h,g,v),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(t){return this._mrt&&this._mrt.getLayer(t)}setTexture(t,s){const h=s.context,g=h.gl;this.texture=this.texture||s.getTileTexture(t.width),this.texture&&this.texture instanceof r.T?this.texture.update(t,{premultiply:!1}):this.texture=new r.T(h,t,g.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(t=16384,s){const h=this._mrt=new r.bp(30),g=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(t-1)}});return this.entireBuffer=null,this.request=r.br(g,(v,b,E,I)=>{if(v)s(v);else try{const z=h.getHeaderLength(b);if(z>t)return void(this.request=this.fetchHeader(z,s));h.parseHeader(b),this._isHeaderLoaded=!0;let L=0;for(const N of Object.values(h.layers))L=Math.max(L,N.dataIndex[N.dataIndex.length-1].lastByte);b.byteLength>=L&&(this.entireBuffer=b),s(null,this.entireBuffer||b,E,I)}catch(z){s(z)}}),this.request}fetchBand(t,s,h){const g=this._mrt;if(!this._isHeaderLoaded||!g)return void h(new Error("Tile header is not ready"));const v=this.actor;if(!v)return void h(new Error("Can't fetch tile band without an actor"));let b;const E=(N,F)=>{b.complete(N,F),N?h(N):(this.updateTextureDescriptor(t,s),h(null,this.textureDescriptor&&this.textureDescriptor.img))},I=(N,F)=>{if(N)return h(N);const q=v.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:F,task:b},E,void 0,!0);this._workQueue.push(()=>{q&&q.cancel(),b.cancel()})},z=g.getLayer(t);if(!z)return void h(new Error(`Unknown sourceLayer "${t}"`));if(z.hasDataForBand(s))return this.updateTextureDescriptor(t,s),void h(null,this.textureDescriptor?this.textureDescriptor.img:null);const L=z.getDataRange([s]);if(b=g.createDecodingTask(L),!b||b.tasks.length)if(this.flushQueues(),this.entireBuffer)I(null,this.entireBuffer.slice(L.firstByte,L.lastByte+1));else{const N=Object.assign({},this.requestParams,{headers:{Range:`bytes=${L.firstByte}-${L.lastByte}`}}),F=r.br(N,I);this._fetchQueue.push(()=>{F.cancel(),b.cancel()})}else h(null)}updateNeeded(t,s){return(!this.textureDescriptor||this.textureDescriptor.band!==s||this.textureDescriptor.layer!==t)&&this.state!=="errored"}updateTextureDescriptor(t,s){if(!this._mrt)return;const h=this._mrt.getLayer(t);if(!h||!h.hasBand(s)||!h.hasDataForBand(s))return;const{bytes:g,tileSize:v,buffer:b,offset:E,scale:I}=h.getBandView(s),z=v+2*b,L=new r.r({width:z,height:z},g),N=this.texture;N&&N instanceof r.T&&N.update(L,{premultiply:!1}),this.textureDescriptor={layer:t,band:s,img:L,buffer:b,offset:E,tileSize:v,format:h.pixelFormat,mix:[I,256*I,65536*I,16777216*I]}}}class Cd{constructor(t,s){this.max=t,this.onRemove=s,this.reset()}reset(){for(const t in this.data)for(const s of this.data[t])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(t,s,h){const g=t.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const v={value:s,timeout:void 0};if(h!==void 0&&(v.timeout=setTimeout(()=>{this.remove(t,v)},h)),this.data[g].push(v),this.order.push(g),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const s=this.data[t].shift();return s.timeout&&clearTimeout(s.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),s.value}getByKey(t){const s=this.data[t];return s?s[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,s){if(!this.has(t))return this;const h=t.wrapped().key,g=s===void 0?0:this.data[h].indexOf(s),v=this.data[h][g];return this.data[h].splice(g,1),v.timeout&&clearTimeout(v.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(v.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(t){const s=[];for(const h in this.data)for(const g of this.data[h])t(g.value)||s.push(g);for(const h of s)this.remove(h.value.tileID,h)}}class Eh{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,s,h){const g=String(s);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][g]=this.stateChanges[t][g]||{},r.h(this.stateChanges[t][g],h),this.deletedStates[t]===null){this.deletedStates[t]={};for(const v in this.state[t])v!==g&&(this.deletedStates[t][v]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][g]===null){this.deletedStates[t][g]={};for(const v in this.state[t][g])h[v]||(this.deletedStates[t][g][v]=null)}else for(const v in h)this.deletedStates[t]&&this.deletedStates[t][g]&&this.deletedStates[t][g][v]===null&&delete this.deletedStates[t][g][v]}removeFeatureState(t,s,h){if(this.deletedStates[t]===null)return;const g=String(s);if(this.deletedStates[t]=this.deletedStates[t]||{},h&&s!==void 0)this.deletedStates[t][g]!==null&&(this.deletedStates[t][g]=this.deletedStates[t][g]||{},this.deletedStates[t][g][h]=null);else if(s!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][g])for(h in this.deletedStates[t][g]={},this.stateChanges[t][g])this.deletedStates[t][g][h]=null;else this.deletedStates[t][g]=null;else this.deletedStates[t]=null}getState(t,s){const h=this.state[t]||{},g=this.stateChanges[t]||{},v=this.deletedStates[t];if(v===null)return{};if(s!==void 0){const E=String(s),I=r.h({},h[E],g[E]);if(v){const z=v[s];if(z===null)return{};for(const L in z)delete I[L]}return I}const b=r.h({},h,g);if(v)for(const E in v)delete b[E];return b}initializeTileState(t,s){t.refreshFeatureState(s)}coalesceChanges(t,s){const h={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const v={};for(const b in this.stateChanges[g])this.state[g][b]||(this.state[g][b]={}),r.h(this.state[g][b],this.stateChanges[g][b]),v[b]=this.state[g][b];h[g]=v}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const v={};if(this.deletedStates[g]===null)for(const b in this.state[g])v[b]={},this.state[g][b]={};else for(const b in this.deletedStates[g]){if(this.deletedStates[g][b]===null)this.state[g][b]={};else if(this.state[g][b])for(const E of Object.keys(this.deletedStates[g][b]))delete this.state[g][b][E];v[b]=this.state[g][b]}h[g]=h[g]||{},r.h(h[g],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const g in t)t[g].refreshFeatureState(s)}}class Zs extends r.E{constructor(t,s,h){super(),this.id=t,this._onlySymbols=h,s.on("data",g=>{g.dataType==="source"&&g.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&g.dataType==="source"&&g.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new Cd(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Eh,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles)if(!this._tiles[t].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,s){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,s)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t)}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t)}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const h=this._tiles[s];h.upload(t),h.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(No).map(t=>t.key)}getRenderableIds(t,s){const h=[];for(const g in this._tiles)this._isIdRenderable(+g,t,s)&&h.push(this._tiles[g]);return t?h.sort((g,v)=>{const b=g.tileID,E=v.tileID,I=new r.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),z=new r.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-E.overscaledZ||z.y-I.y||z.x-I.x}).map(g=>g.tileID.key):h.map(g=>g.tileID).sort(No).map(g=>g.key)}hasRenderableParent(t){const s=this.findLoadedParent(t,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(t,s,h){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(s||!this._tiles[t].holdingForFade())&&(h||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,s){const h=this._tiles[t];h&&(h.state!=="loading"&&(h.state=s),this._loadTile(h,this._tileLoaded.bind(this,h,t,s)))}_tileLoaded(t,s,h,g){if(g)if(t.state="errored",g.status!==404)this._source.fire(new r.z(g,{tile:t}));else{if(this._source.fire(new r.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:t})),!(t.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=r.q.now(),h==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(s,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new r.A("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const s=this.getRenderableIds();for(let g=0;g<s.length;g++){const v=s[g];if(t.neighboringTiles&&t.neighboringTiles[v]){const b=this.getTileByID(v);h(t,b),h(b,t)}}function h(g,v){if(!g.dem||g.dem.borderReady)return;g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0;let b=v.tileID.canonical.x-g.tileID.canonical.x;const E=v.tileID.canonical.y-g.tileID.canonical.y,I=Math.pow(2,g.tileID.canonical.z),z=v.tileID.key;b===0&&E===0||Math.abs(E)>1||(Math.abs(b)>1&&(Math.abs(b+I)===1?b+=I:Math.abs(b-I)===1&&(b-=I)),v.dem&&g.dem&&(g.dem.backfillBorder(v.dem,b,E),g.neighboringTiles&&g.neighboringTiles[z]&&(g.neighboringTiles[z].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,s,h,g){for(const v in this._tiles){let b=this._tiles[v];if(g[v]||!b.hasData()||b.tileID.overscaledZ<=s||b.tileID.overscaledZ>h)continue;let E=b.tileID;for(;b&&b.tileID.overscaledZ>s+1;){const z=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[z.key],b&&b.hasData()&&(E=z)}let I=E;for(;I.overscaledZ>s;)if(I=I.scaledTo(I.overscaledZ-1),t[I.key]){g[E.key]=E;break}}}findLoadedParent(t,s){if(t.key in this._loadedParentTiles){const h=this._loadedParentTiles[t.key];return h&&h.tileID.overscaledZ>=s?h:null}for(let h=t.overscaledZ-1;h>=s;h--){const g=t.scaledTo(h),v=this._getLoadedTile(g);if(v)return v}}_getLoadedTile(t){const s=this._tiles[t.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,s){s=s||this._source.tileSize;const h=Math.ceil(t.width/s)+1,g=Math.ceil(t.height/s)+1,v=Math.floor(h*g*5),b=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(E)}handleWrapJump(t){const s=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,s){const h={};for(const g in this._tiles){const v=this._tiles[g];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+s),h[v.tileID.key]=v}this._tiles=h;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(+g,this._tiles[g])}}update(t,s,h,g,v){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!h)return;this.updateCacheSize(t,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const b=this._source.type==="batched-model";let E,I=this._source.maxzoom;const z=this.map&&this.map.painter?this.map.painter._terrain:null;if(z&&z.sourceCache===this&&z.attenuationRange()){const F=z.attenuationRange()[0],q=Math.floor(F)-Math.log2(z.getDemUpscale());I>q&&(I=q)}if(this.used||this.usedForTerrain){if(this._source.tileID)E=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(F=>new r.aM(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y));else if(this.tileCoverLift!==0){const F=t.clone();F.tileCoverLift=this.tileCoverLift,E=F.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.minzoom<=1&&t.projection.name==="globe"&&(E.push(new r.aM(1,0,1,0,0)),E.push(new r.aM(1,0,1,1,0)),E.push(new r.aM(1,0,1,0,1)),E.push(new r.aM(1,0,1,1,1)))}else if(E=t.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:b}),this._source.hasTile){const F=this._source.hasTile.bind(this._source);E=E.filter(q=>F(q))}}else E=[];if(E.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!ma(this._source.type)){const F=t.coveringZoomLevel({tileSize:s||this._source.tileSize,roundZoom:this._source.roundZoom&&!h}),q=Math.min(F,this._source.maxzoom);if(b){const X=t.extendTileCover(E,q);for(const G of X)E.push(G)}else if(v){const X=t.extendTileCover(E,q,this.transform._camera.forward());for(const G of X)E.push(G)}else if(this.castsShadows&&g){const X=t.extendTileCover(E,q,g);for(const G of X)this._shadowCasterTiles[G.key]=!0,E.push(G)}}const L=this._updateRetainedTiles(E);if(ma(this._source.type)&&E.length!==0){const F={},q={},X=Object.keys(L);for(const Y of X){const J=L[Y],re=this._tiles[Y];if(!re||re.fadeEndTime&&re.fadeEndTime<=r.q.now())continue;const pe=this.findLoadedParent(J,Math.max(J.overscaledZ-Zs.maxOverzooming,this._source.minzoom));pe&&(this._addTile(pe.tileID),F[pe.tileID.key]=pe.tileID),q[Y]=J}const G=E[E.length-1].overscaledZ;for(const Y in this._tiles){const J=this._tiles[Y];if(L[Y]||!J.hasData())continue;let re=J.tileID;for(;re.overscaledZ>G;){re=re.scaledTo(re.overscaledZ-1);const pe=this._tiles[re.key];if(pe&&pe.hasData()&&q[re.key]){L[Y]=J.tileID;break}}}for(const Y in F)L[Y]||(this._coveredTiles[Y]=!0,L[Y]=F[Y])}for(const F in L)this._tiles[F].clearFadeHold();const N=r.bs(this._tiles,L);for(const F of N){const q=this._tiles[F];q.hasSymbolBuckets&&!q.holdingForFade()?q.setHoldDuration(this.map._fadeDuration):q.hasSymbolBuckets&&!q.symbolFadeFinished()||this._removeTile(+F)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const s={};if(t.length===0)return s;const h={},g=t.reduce((z,L)=>Math.min(z,L.overscaledZ),1/0),v=t[0].overscaledZ,b=Math.max(v-Zs.maxOverzooming,this._source.minzoom),E=Math.max(v+Zs.maxUnderzooming,this._source.minzoom),I={};for(const z of t){const L=this._addTile(z);s[z.key]=z,L.hasData()||g<this._source.maxzoom&&(I[z.key]=z)}this._retainLoadedChildren(I,g,E,s);for(const z of t){let L=this._tiles[z.key];if(L.hasData())continue;if(z.canonical.z>=this._source.maxzoom){const F=z.children(this._source.maxzoom)[0],q=this.getTile(F);if(q&&q.hasData()){s[F.key]=F;continue}}else{const F=z.children(this._source.maxzoom);if(s[F[0].key]&&s[F[1].key]&&s[F[2].key]&&s[F[3].key])continue}let N=L.wasRequested();for(let F=z.overscaledZ-1;F>=b;--F){const q=z.scaledTo(F);if(h[q.key]||(h[q.key]=!0,L=this.getTile(q),!L&&N&&(L=this._addTile(q)),L&&(s[q.key]=q,N=L.wasRequested(),L.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const s=[];let h,g=this._tiles[t].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){h=this._loadedParentTiles[g.key];break}s.push(g.key);const v=g.scaledTo(g.overscaledZ-1);if(h=this._getLoadedTile(v),h)break;g=v}for(const v of s)this._loadedParentTiles[v]=h}}_addTile(t){let s=this._tiles[t.key];if(s)return s.isExtraShadowCaster!==!0||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),s;s=this._cache.getAndRemove(t),s&&(this._setTileReloadTimer(t.key,s),s.tileID=t,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,s)));const h=!!s;if(!h){const g=this.map?this.map.painter:null,v=this._source.tileSize*t.overscaleFactor();s=this._source.type==="raster-array"?new Oc(t,v,this.transform.tileZoom,g,this._isRaster):new ec(t,v,this.transform.tileZoom,g,this._isRaster,this._source.worldview),this._loadTile(s,this._tileLoaded.bind(this,s,t.key,s.state))}return s.uses++,this._tiles[t.key]=s,h||this._source.fire(new r.A("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(t,s){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const h=s.getExpiryTimeout();h&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},h))}_removeTile(t){const s=this._tiles[t];s&&(s.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),s.uses>0||(s.hasData()&&s.state!=="reloading"||s.state==="empty"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,s,h){const g=[],v=this.transform;if(!v)return g;const b=v.projection.name==="globe",E=r.aD(v.center.lng);for(const I in this._tiles){const z=this._tiles[I];if(h&&z.clearQueryDebugViz(),z.holdingForFade())continue;let L;if(b){const N=z.tileID.canonical;if(N.z===0){const F=[Math.abs(r.ay(E,...ra(N,-1))-E),Math.abs(r.ay(E,...ra(N,1))-E)];L=[0,2*F.indexOf(Math.min(...F))-1]}else{const F=[Math.abs(r.ay(E,...ra(N,-1))-E),Math.abs(r.ay(E,...ra(N,0))-E),Math.abs(r.ay(E,...ra(N,1))-E)];L=[F.indexOf(Math.min(...F))-1]}}else L=[0];for(const N of L){const F=t.containsTile(z,v,s,N);F&&g.push(F)}}return g}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,s){const h=this.getRenderableIds(t,s).map(v=>this._tiles[v].tileID),g=this.transform.projection.name==="globe";for(const v of h)v.projMatrix=this.transform.calculateProjMatrix(v.toUnwrapped()),v.expandedProjMatrix=g?this.transform.calculateProjMatrix(v.toUnwrapped(),!1,!0):v.projMatrix;return h}sortCoordinatesByDistance(t){const s=t.slice(),h=this.transform._camera.position,g=this.transform._camera.forward(),v={};for(const b of s){const E=1/(1<<b.canonical.z);v[b.key]=((b.canonical.x+.5)*E+b.wrap-h[0])*g[0]+((b.canonical.y+.5)*E-h[1])*g[1]-h[2]*g[2]}return s.sort((b,E)=>v[b.key]-v[E.key]),s}hasTransition(){if(this._source.hasTransition())return!0;if(ma(this._source.type))for(const t in this._tiles){const s=this._tiles[t];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=r.q.now())return!0}return!1}setFeatureState(t,s,h){this._state.updateState(t=t||"_geojsonTileLayer",s,h)}removeFeatureState(t,s,h){this._state.removeFeatureState(t=t||"_geojsonTileLayer",s,h)}getFeatureState(t,s){return this._state.getState(t=t||"_geojsonTileLayer",s)}setDependencies(t,s,h){const g=this._tiles[t];g&&g.setDependencies(s,h)}reloadTilesForDependencies(t,s){for(const h in this._tiles)this._tiles[h].hasDependency(t,s)&&this._reloadTile(+h,"reloading");this._cache.filter(h=>!h.hasDependency(t,s))}_preloadTiles(t,s){if(!this._sourceLoaded){const I=()=>{this._sourceLoaded&&(this._source.off("data",I),this._preloadTiles(t,s))};return void this._source.on("data",I)}const h=new Map,g=Array.isArray(t)?t:[t],v=this.map.painter.terrain,b=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const I of g){const z=I.coveringTiles({tileSize:b,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const L of z)h.set(L.key,L);this.usedForTerrain&&I.updateElevation(!1)}const E=Array.from(h.values());r.bt(E,(I,z)=>{const L=new ec(I,this._source.tileSize*I.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(L,N=>{this._source.type==="raster-dem"&&L.dem&&this._backfillDEM(L),z(N,L)})},s)}}function No(u,t){const s=Math.abs(2*u.wrap)-+(u.wrap<0),h=Math.abs(2*t.wrap)-+(t.wrap<0);return u.overscaledZ-t.overscaledZ||h-s||t.canonical.y-u.canonical.y||t.canonical.x-u.canonical.x}function ma(u){return u==="raster"||u==="image"||u==="video"||u==="custom"}function ra(u,t){const s=1<<u.z;return[u.x/s+t,(u.x+1)/s+t]}Zs.maxOverzooming=10,Zs.maxUnderzooming=3;class Au{constructor(t){this.style=t,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const t=!1,s=!1;for(const h in this.style._mergedLayers){const g=this.style._mergedLayers[h];if(g.type==="fill-extrusion"||g.type==="building")this.layers.push({layer:g,visible:t,visibilityChanged:s});else if(g.type==="model"){const v=this.style.getLayerSource(g);v&&v.type==="batched-model"&&this.layers.push({layer:g,visible:t,visibilityChanged:s})}}}onNewFrame(t){this.layersGotHidden=!1;for(const s of this.layers){const h=s.layer;let g=!1;h.type==="fill-extrusion"?g=!h.isHidden(t)&&h.paint.get("fill-extrusion-opacity")>0:h.type==="building"?g=!h.isHidden(t)&&h.paint.get("building-opacity")>0:h.type==="model"&&(g=!h.isHidden(t)&&h.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!g&&s.visible,s.visible=g}}updateZOffset(t,s){this.currentBuildingBuckets=[];for(const g of this.layers){const v=g.layer,b=this.style.getLayerSourceCache(v);let E=1;v.type==="fill-extrusion"?E=g.visible?v.paint.get("fill-extrusion-vertical-scale"):0:v.type==="building"&&(E=g.visible?v.paint.get("building-vertical-scale"):0);let I=b?b.getTile(s):null;if(!I&&b&&s.canonical.z>b.getSource().minzoom){let z=s.scaledTo(Math.min(b.getSource().maxzoom,s.overscaledZ-1));for(;z.overscaledZ>=b.getSource().minzoom&&(I=b.getTile(z),!I&&z.overscaledZ!==0);)z=z.scaledTo(z.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:I?I.getBucket(v):null,tileID:I?I.tileID:s,verticalScale:E})}t.hasAnyZOffset=!1;let h=!1;for(let g=0;g<t.symbolInstances.length;g++){const v=t.symbolInstances.get(g),b=v.zOffset,E=this._getHeightAtTileOffset(s,v.tileAnchorX,v.tileAnchorY);v.zOffset=E!==Number.NEGATIVE_INFINITY?E:b,h||b===v.zOffset||(h=!0),t.hasAnyZOffset||v.zOffset===0||(t.hasAnyZOffset=!0)}h&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,s,h,g){let v=s,b=h;if(t.canonical.z!==g.canonical.z){const E=g.canonical,I=1/(1<<t.canonical.z-E.z);v=(s+t.canonical.x*r.aj)*I-E.x*r.aj|0,b=(h+t.canonical.y*r.aj)*I-E.y*r.aj|0}return{tileX:v,tileY:b}}_getHeightAtTileOffset(t,s,h){let g,v;for(let b=0;b<this.layers.length;++b){const E=this.layers[b].layer;if(E.type!=="fill-extrusion"&&E.type!=="building")continue;const{bucket:I,tileID:z,verticalScale:L}=this.currentBuildingBuckets[b];if(!I)continue;const{tileX:N,tileY:F}=this._mapCoordToOverlappingTile(t,s,h,z),q=I.getHeightAtTileCoord(N,F);q&&q.height!==void 0&&(q.hidden?g=q.height:v=Math.max(q.height*L,v||0))}if(v!==void 0)return v;for(let b=0;b<this.layers.length;++b){const E=this.layers[b];if(E.layer.type!=="model"||!E.visible)continue;const{bucket:I,tileID:z}=this.currentBuildingBuckets[b];if(!I)continue;const{tileX:L,tileY:N}=this._mapCoordToOverlappingTile(t,s,h,z),F=I.getHeightAtTileCoord(L,N);if(F&&!F.hidden)return F.height===void 0&&g!==void 0?Math.min(F.maxHeight,g)*F.verticalScale:F.height?F.height*F.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Iu(u,t){const s={};for(const h in u)h!=="ref"&&(s[h]=u[h]);return r.bu.forEach(h=>{h in t&&(s[h]=t[h])}),s}function ga(u){u=u.slice();const t=Object.create(null);for(let s=0;s<u.length;s++)t[u[s].id]=u[s];for(let s=0;s<u.length;s++)"ref"in u[s]&&(u[s]=Iu(u[s],t[u[s].ref]));return u}const wi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Ah(u,t,s){s.push({command:wi.addSource,args:[u,t[u]]})}function Ua(u,t,s){t.push({command:wi.removeSource,args:[u]}),s[u]=!0}function Ih(u,t,s,h){Ua(u,s,h),Ah(u,t,s)}function Rf(u,t,s){let h;for(h in u[s])if(u[s].hasOwnProperty(h)&&h!=="data"&&!r.bv(u[s][h],t[s][h]))return!1;for(h in t[s])if(t[s].hasOwnProperty(h)&&h!=="data"&&!r.bv(u[s][h],t[s][h]))return!1;return!0}function tc(u,t,s,h,g,v){let b;for(b in t=t||{},u=u||{})u.hasOwnProperty(b)&&(r.bv(u[b],t[b])||s.push({command:v,args:[h,b,t[b],g]}));for(b in t)t.hasOwnProperty(b)&&!u.hasOwnProperty(b)&&(r.bv(u[b],t[b])||s.push({command:v,args:[h,b,t[b],g]}))}function nc(u){return u.id}function ic(u,t){return u[t.id]=t,u}class Bc{constructor(t,s){this.reset(t,s)}reset(t,s){this.points=t||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=r.ay(t,0,1);let s=1,h=this._distances[s];const g=t*this.paddedLength+this.padding;for(;h<g&&s<this._distances.length;)h=this._distances[++s];const v=s-1,b=this._distances[v],E=h-b,I=E>0?(g-b)/E:0;return this.points[v].mult(1-I).add(this.points[s].mult(I))}}class Fc{constructor(t,s,h){const g=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(t/h),this.yCellCount=Math.ceil(s/h);for(let b=0;b<this.xCellCount*this.yCellCount;b++)g.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=s,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,s,h,g,v){this._forEachCell(s,h,g,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(v)}insertCircle(t,s,h,g){this._forEachCell(s-g,h-g,s+g,h+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(s),this.circles.push(h),this.circles.push(g)}_insertBoxCell(t,s,h,g,v,b){this.boxCells[v].push(b)}_insertCircleCell(t,s,h,g,v,b){this.circleCells[v].push(b)}_query(t,s,h,g,v,b){if(h<0||t>this.width||g<0||s>this.height)return!v&&[];const E=[];if(t<=0&&s<=0&&this.width<=h&&this.height<=g){if(v)return!0;for(let I=0;I<this.boxKeys.length;I++)E.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const z=this.circles[3*I],L=this.circles[3*I+1],N=this.circles[3*I+2];E.push({key:this.circleKeys[I],x1:z-N,y1:L-N,x2:z+N,y2:L+N})}return b?E.filter(b):E}return this._forEachCell(t,s,h,g,this._queryCell,E,{hitTest:v,seenUids:{box:{},circle:{}}},b),v?E.length>0:E}_queryCircle(t,s,h,g,v){const b=t-h,E=t+h,I=s-h,z=s+h;if(E<0||b>this.width||z<0||I>this.height)return!g&&[];const L=[];return this._forEachCell(b,I,E,z,this._queryCellCircle,L,{hitTest:g,circle:{x:t,y:s,radius:h},seenUids:{box:{},circle:{}}},v),g?L.length>0:L}query(t,s,h,g,v){return this._query(t,s,h,g,!1,v)}hitTest(t,s,h,g,v){return this._query(t,s,h,g,!0,v)}hitTestCircle(t,s,h,g){return this._queryCircle(t,s,h,!0,g)}_queryCell(t,s,h,g,v,b,E,I){const z=E.seenUids,L=this.boxCells[v];if(L!==null){const F=this.bboxes;for(const q of L)if(!z.box[q]){z.box[q]=!0;const X=4*q;if(t<=F[X+2]&&s<=F[X+3]&&h>=F[X+0]&&g>=F[X+1]&&(!I||I(this.boxKeys[q]))){if(E.hitTest)return b.push(!0),!0;b.push({key:this.boxKeys[q],x1:F[X],y1:F[X+1],x2:F[X+2],y2:F[X+3]})}}}const N=this.circleCells[v];if(N!==null){const F=this.circles;for(const q of N)if(!z.circle[q]){z.circle[q]=!0;const X=3*q;if(this._circleAndRectCollide(F[X],F[X+1],F[X+2],t,s,h,g)&&(!I||I(this.circleKeys[q]))){if(E.hitTest)return b.push(!0),!0;{const G=F[X],Y=F[X+1],J=F[X+2];b.push({key:this.circleKeys[q],x1:G-J,y1:Y-J,x2:G+J,y2:Y+J})}}}}}_queryCellCircle(t,s,h,g,v,b,E,I){const z=E.circle,L=E.seenUids,N=this.boxCells[v];if(N!==null){const q=this.bboxes;for(const X of N)if(!L.box[X]){L.box[X]=!0;const G=4*X;if(this._circleAndRectCollide(z.x,z.y,z.radius,q[G+0],q[G+1],q[G+2],q[G+3])&&(!I||I(this.boxKeys[X])))return b.push(!0),!0}}const F=this.circleCells[v];if(F!==null){const q=this.circles;for(const X of F)if(!L.circle[X]){L.circle[X]=!0;const G=3*X;if(this._circlesCollide(q[G],q[G+1],q[G+2],z.x,z.y,z.radius)&&(!I||I(this.circleKeys[X])))return b.push(!0),!0}}}_forEachCell(t,s,h,g,v,b,E,I){const z=this._convertToXCellCoord(t),L=this._convertToYCellCoord(s),N=this._convertToXCellCoord(h),F=this._convertToYCellCoord(g);for(let q=z;q<=N;q++)for(let X=L;X<=F;X++)if(v.call(this,t,s,h,g,this.xCellCount*X+q,b,E,I))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,s,h,g,v,b){const E=g-t,I=v-s,z=h+b;return z*z>E*E+I*I}_circleAndRectCollide(t,s,h,g,v,b,E){const I=(b-g)/2,z=Math.abs(t-(g+I));if(z>I+h)return!1;const L=(E-v)/2,N=Math.abs(s-(v+L));if(N>L+h)return!1;if(z<=I||N<=L)return!0;const F=z-I,q=N-L;return F*F+q*q<=h*h}}const _a={unknown:0,flipRequired:1,flipNotRequired:2},Ph=Math.tan(85*Math.PI/180);function yl(u,t,s,h,g,v,b){const E=r.bz();if(s)if(v.name==="globe"){const I=r.bA(g,t);r.az(E,E,I)}else{const I=r.bB([],b);E[0]=I[0],E[1]=I[1],E[4]=I[2],E[5]=I[3],h||r.by(E,E,g.angle)}else r.az(E,g.labelPlaneMatrix,u);return E}function Ed(u,t,s,h,g,v,b){const E=yl(u,t,s,h,g,v,b);return v.name==="globe"&&s||(E[2]=E[6]=E[10]=E[14]=0),E}function Pu(u,t,s,h,g,v,b){if(s){if(v.name==="globe"){const E=yl(u,t,s,h,g,v,b);return r.bi(E,E),r.az(E,u,E),E}{const E=r.bw(u),I=r.bx([]);return I[0]=b[0],I[1]=b[1],I[4]=b[2],I[5]=b[3],r.az(E,E,I),h||r.by(E,E,-g.angle),E}}return g.glCoordMatrix}function Vo(u,t,s,h){const g=[u,t,s,1];s?r.aA(g,g,h):Ti(g,g,h);const v=g[3];return g[0]/=v,g[1]/=v,g[2]/=v,g}function jc(u,t){return Math.min(.5+u/t*.5,1.5)}function rc(u,t){const s=u[0]/u[3],h=u[1]/u[3];return s>=-t[0]&&s<=t[0]&&h>=-t[1]&&h<=t[1]}function Aa(u,t,s,h,g,v,b,E,I,z){const L=s.transform,N=h?u.textSizeData:u.iconSizeData,F=r.bH(N,s.transform.zoom),q=L.projection.name==="globe",X=[256/s.width*2+1,256/s.height*2+1],G=h?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;G.clear();let Y=null;q&&(Y=h?u.text.globeExtVertexArray:u.icon.globeExtVertexArray);const J=u.lineVertexArray,re=h?u.text.placedSymbolArray:u.icon.placedSymbolArray,pe=s.transform.width/s.transform.height;let _e,Ae=!1;for(let Ie=0;Ie<re.length;Ie++){const Te=re.get(Ie),{numGlyphs:ve,writingMode:Pe}=Te;if(Pe!==r.bI.vertical||Ae||_e===r.bI.horizontal||(Ae=!0),_e=Pe,(Te.hidden||Pe===r.bI.vertical)&&!Ae){Os(ve,G);continue}Ae=!1;const Me=new r.P(Te.tileAnchorX,Te.tileAnchorY);let{x:We,y:Qe,z:ft}=L.projection.projectTilePoint(Me.x,Me.y,z.canonical);if(I){const[Yt,tn,Xt]=I(Me);We+=Yt,Qe+=tn,ft+=Xt}const pt=[We,Qe,ft,1];if(r.aA(pt,pt,t),!rc(pt,X)){Os(ve,G);continue}const Et=pt[3],Ke=jc(s.transform.getCameraToCenterDistance(L.projection),Et),st=r.bJ(N,F,Te),Ve=b?st/Ke:st*Ke,_t=Vo(We,Qe,ft,g);if(_t[3]<=0){Os(ve,G);continue}let nt={};const Tt=r.al(u.layers[0].layout.get("text-max-angle")),jt=Math.cos(Tt),yt=b?null:I,Lt=sc(Te,Ve,!1,E,t,g,v,u.glyphOffsetArray,J,G,Y,_t,Me,nt,pe,yt,L.projection,z,b,jt);Ae=Lt.useVertical,yt&&Lt.needsFlipping&&(nt={}),(Lt.notEnoughRoom||Ae||Lt.needsFlipping&&sc(Te,Ve,!0,E,t,g,v,u.glyphOffsetArray,J,G,Y,_t,Me,nt,pe,yt,L.projection,z,b,jt).notEnoughRoom)&&Os(ve,G)}h?(u.text.dynamicLayoutVertexBuffer.updateData(G),Y&&u.text.globeExtVertexBuffer&&u.text.globeExtVertexBuffer.updateData(Y)):(u.icon.dynamicLayoutVertexBuffer.updateData(G),Y&&u.icon.globeExtVertexBuffer&&u.icon.globeExtVertexBuffer.updateData(Y))}function kh(u,t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y){const{lineStartIndex:J,glyphStartIndex:re,segment:pe}=E,_e=re+E.numGlyphs,Ae=J+E.lineLength,Ie=t.getoffsetX(re),Te=t.getoffsetX(_e-1),ve=Vc(u*Ie,s,h,g,v,b,pe,J,Ae,I,z,L,N,F,!0,q,X,G,Y);if(!ve)return null;const Pe=Vc(u*Te,s,h,g,v,b,pe,J,Ae,I,z,L,N,F,!0,q,X,G,Y);return Pe?{first:ve,last:Pe}:null}function Nc(u,t,s,h){return u===r.bI.horizontal&&Math.abs(h)>Math.abs(s)?{useVertical:!0}:u===r.bI.vertical?h>0?{needsFlipping:!0}:null:t!==_a.unknown&&function(g,v){return g===0||Math.abs(v/g)>Ph}(s,h)?t===_a.flipRequired?{needsFlipping:!0}:null:s<0?{needsFlipping:!0}:null}function sc(u,t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y,J,re,pe){const _e=t/24,Ae=u.lineOffsetX*_e,Ie=u.lineOffsetY*_e,{lineStartIndex:Te,glyphStartIndex:ve,numGlyphs:Pe,segment:Me,writingMode:We,flipState:Qe}=u,ft=Te+u.lineLength,pt=Et=>{if(L){const[_t,nt,Tt]=Et.up,jt=z.length;r.bK(L,jt+0,_t,nt,Tt),r.bK(L,jt+1,_t,nt,Tt),r.bK(L,jt+2,_t,nt,Tt),r.bK(L,jt+3,_t,nt,Tt)}const[Ke,st,Ve]=Et.point;r.bL(z,Ke,st,Ve,Et.angle)};if(Pe>1){const Et=kh(_e,E,Ae,Ie,s,N,F,u,I,v,q,G,!1,Y,J,re,pe);if(!Et)return{notEnoughRoom:!0};if(h&&!s){let[Ke,st,Ve]=Et.first.point,[_t,nt,Tt]=Et.last.point;[Ke,st]=Vo(Ke,st,Ve,b),[_t,nt]=Vo(_t,nt,Tt,b);const jt=Nc(We,Qe,(_t-Ke)*X,nt-st);if(u.flipState=jt&&jt.needsFlipping?_a.flipRequired:_a.flipNotRequired,jt)return jt}pt(Et.first);for(let Ke=ve+1;Ke<ve+Pe-1;Ke++){const st=Vc(_e*E.getoffsetX(Ke),Ae,Ie,s,N,F,Me,Te,ft,I,v,q,G,!1,!1,Y,J,re,pe);if(!st)return z.length-=4*(Ke-ve),{notEnoughRoom:!0};pt(st)}pt(Et.last)}else{if(h&&!s){const Ke=Vo(F.x,F.y,0,g),st=Te+Me+1,Ve=new r.P(I.getx(st),I.gety(st)),_t=Vo(Ve.x,Ve.y,0,g),nt=_t[3]>0?_t:ku(F,Ve,Ke,1,g,void 0,Y,J.canonical),Tt=Nc(We,Qe,(nt[0]-Ke[0])*X,nt[1]-Ke[1]);if(u.flipState=Tt&&Tt.needsFlipping?_a.flipRequired:_a.flipNotRequired,Tt)return Tt}const Et=Vc(_e*E.getoffsetX(ve),Ae,Ie,s,N,F,Me,Te,ft,I,v,q,G,!1,!1,Y,J,re,pe);if(!Et)return{notEnoughRoom:!0};pt(Et)}return{}}function oo(u,t,s,h,g){const{x:v,y:b,z:E}=h.projectTilePoint(u.x,u.y,t);if(!g)return Vo(v,b,E,s);const[I,z,L]=g(u);return Vo(v+I,b+z,E+L,s)}function ku(u,t,s,h,g,v,b,E){const I=oo(u.sub(t)._unit()._add(u),E,g,b,v);return r.at(I,s,I),r.au(I,I),r.bE(I,s,I,h)}function Vc(u,t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y,J,re){const pe=h?u-t:u+t;let _e=pe>0?1:-1,Ae=0;h&&(_e*=-1,Ae=Math.PI),_e<0&&(Ae+=Math.PI);let Ie=E+b+(_e>0?0:1)|0,Te=g,ve=g,Pe=0,Me=0;const We=Math.abs(pe),Qe=[],ft=[];let pt=v,Et=pt,Ke=r.bC([]);const st=()=>ku(Et,pt,ve,We-Pe+1,L,F,G,Y.canonical);for(;Pe+Me<=We;){if(Ie+=_e,Ie<E||Ie>=I)return null;if(ve=Te,Et=pt,Qe.push(ve),q&&ft.push(Et),pt=new r.P(z.getx(Ie),z.gety(Ie)),Te=N[Ie],!Te){const Xt=oo(pt,Y.canonical,L,G,F);Te=Xt[3]>0?N[Ie]=Xt:st()}Pe+=Me;const Yt=r.at([],Te,ve),tn=r.bD(ve,Te);if(s&&tn>0&&Me>0&&r.bG(Ke,Yt)/(Me*tn)<re)return null;Me=tn,Ke=Yt}X&&F&&(N[Ie]&&(Te=st(),Me=r.bD(ve,Te),Ke=r.at([],Te,ve)),N[Ie]=Te);const Ve=(We-Pe)/Me,_t=pt.sub(Et)._mult(Ve)._add(Et),nt=r.bE([],ve,Ke,Ve);let Tt=[0,0,1],jt=Ke[0],yt=Ke[1];if(J&&(Tt=G.upVector(Y.canonical,_t.x,_t.y),Tt[0]!==0||Tt[1]!==0||Tt[2]!==1)){const Yt=[Tt[2],0,-Tt[0]],tn=r.bF([],Tt,Yt);r.au(Yt,Yt),r.au(tn,tn),jt=r.bG(Ke,Yt),yt=r.bG(Ke,tn)}if(s){const Yt=r.bF([],Tt,Ke);r.au(Yt,Yt),r.bE(nt,nt,Yt,s*_e)}const Lt=Ae+Math.atan2(yt,jt);return Qe.push(nt),q&&ft.push(_t),{point:nt,angle:Lt,path:Qe,tilePath:ft,up:Tt}}function Os(u,t){const s=t.length,h=s+4*u;t.resize(h),t.float32.fill(-1/0,4*s,4*h)}function Ti(u,t,s){const h=t[0],g=t[1];return u[0]=s[0]*h+s[4]*g+s[12],u[1]=s[1]*h+s[5]*g+s[13],u[3]=s[3]*h+s[7]*g+s[15],u}const sa=100;class Mh{constructor(t,s,h=new Fc(t.width+200,t.height+200,25),g=new Fc(t.width+200,t.height+200,25)){this.transform=t,this.grid=h,this.ignoredGrid=g,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+sa,this.screenBottomBoundary=t.height+sa,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=s}placeCollisionBox(t,s,h,g,v,b,E,I){let z=h.projectedAnchorX,L=h.projectedAnchorY,N=h.projectedAnchorZ;const F=h.elevation,q=h.tileID,X=t.getProjection();if(F&&q){const[Ie,Te,ve]=X.upVector(q.canonical,h.tileAnchorX,h.tileAnchorY),Pe=X.upVectorScale(q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=Ie*F*Pe,L+=Te*F*Pe,N+=ve*F*Pe}const G=this.projectAndGetPerspectiveRatio(E,z,L,N,h.tileID,X.name==="globe"||!!F||this.transform.pitch>0,X),Y=b*G.perspectiveRatio,J=(h.x1*s+g.x-h.padding)*Y+G.point.x,re=(h.y1*s+g.y-h.padding)*Y+G.point.y,pe=(h.x2*s+g.x+h.padding)*Y+G.point.x,_e=(h.y2*s+g.y+h.padding)*Y+G.point.y,Ae=G.perspectiveRatio<=.55||G.occluded;return!this.isInsideGrid(J,re,pe,_e)||!v&&this.grid.hitTest(J,re,pe,_e,I)||Ae?{box:[],offscreen:!1,occluded:G.occluded}:{box:[J,re,pe,_e],offscreen:this.isOffscreen(J,re,pe,_e),occluded:!1}}placeCollisionCircles(t,s,h,g,v,b,E,I,z,L,N,F,q,X,G){const Y=[],J=this.transform.elevation,re=t.getProjection(),pe=J?J.getAtTileOffsetFunc(G,this.transform.center.lat,this.transform.worldSize,re):null,_e=new r.P(h.tileAnchorX,h.tileAnchorY);let{x:Ae,y:Ie,z:Te}=re.projectTilePoint(_e.x,_e.y,G.canonical);if(pe){const[Tt,jt,yt]=pe(_e);Ae+=Tt,Ie+=jt,Te+=yt}const ve=re.name==="globe",Pe=this.projectAndGetPerspectiveRatio(E,Ae,Ie,Te,G,ve||!!J||this.transform.pitch>0,re),{perspectiveRatio:Me}=Pe,We=(N?b/Me:b*Me)/r.bO,Qe=Vo(Ae,Ie,Te,I),ft=h.lineOffsetX*We,pt=h.lineOffsetY*We,Et=r.al(t.layers[0].layout.get("text-max-angle")),Ke=Math.cos(Et),st=Pe.signedDistanceFromCamera>0?kh(We,v,ft,pt,!1,Qe,_e,h,g,I,{},J&&!N?pe:null,N&&!!J,re,G,N,Ke):null;let Ve=!1,_t=!1,nt=!0;if(st&&!Pe.occluded){const Tt=.5*q*Me+X,jt=new r.P(-100,-100),yt=new r.P(this.screenRightBoundary,this.screenBottomBoundary),Lt=new Bc,{first:Yt,last:tn}=st,Xt=Yt.path.length;let rn=[];for(let Pn=Xt-1;Pn>=1;Pn--)rn.push(Yt.path[Pn]);for(let Pn=1;Pn<tn.path.length;Pn++)rn.push(tn.path[Pn]);const fn=2.5*Tt;z&&(rn=rn.map(([Pn,Wn,vi],Ji)=>(pe&&!ve&&(vi=pe(Ji<Xt-1?Yt.tilePath[Xt-1-Ji]:tn.tilePath[Ji-Xt+2])[2]),Vo(Pn,Wn,vi,z))),rn.some(Pn=>Pn[3]<=0)&&(rn=[]));let _n=[];if(rn.length>0){let Pn=1/0,Wn=-1/0,vi=1/0,Ji=-1/0;for(const Oi of rn)Pn=Math.min(Pn,Oi[0]),vi=Math.min(vi,Oi[1]),Wn=Math.max(Wn,Oi[0]),Ji=Math.max(Ji,Oi[1]);Wn>=jt.x&&Pn<=yt.x&&Ji>=jt.y&&vi<=yt.y&&(_n=[rn.map(Oi=>new r.P(Oi[0],Oi[1]))],(Pn<jt.x||Wn>yt.x||vi<jt.y||Ji>yt.y)&&(_n=r.bM(_n,jt.x,jt.y,yt.x,yt.y)))}for(const Pn of _n){Lt.reset(Pn,.25*Tt);let Wn=0;Wn=Lt.length<=.5*Tt?1:Math.ceil(Lt.paddedLength/fn)+1;for(let vi=0;vi<Wn;vi++){const Ji=vi/Math.max(Wn-1,1),Oi=Lt.lerp(Ji),Ai=Oi.x+sa,Dr=Oi.y+sa;Y.push(Ai,Dr,Tt,0);const Dn=Ai-Tt,Zn=Dr-Tt,si=Ai+Tt,er=Dr+Tt;if(nt=nt&&this.isOffscreen(Dn,Zn,si,er),_t=_t||this.isInsideGrid(Dn,Zn,si,er),!s&&this.grid.hitTestCircle(Ai,Dr,Tt,F)&&(Ve=!0,!L))return{circles:[],offscreen:!1,collisionDetected:Ve,occluded:!1}}}}return{circles:!L&&Ve||!_t?[]:Y,offscreen:nt,collisionDetected:Ve,occluded:Pe.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let h=1/0,g=1/0,v=-1/0,b=-1/0;for(const L of t){const N=new r.P(L.x+sa,L.y+sa);h=Math.min(h,N.x),g=Math.min(g,N.y),v=Math.max(v,N.x),b=Math.max(b,N.y),s.push(N)}const E=this.grid.query(h,g,v,b).concat(this.ignoredGrid.query(h,g,v,b)),I={},z={};for(const L of E){const N=L.key;if(I[N.bucketInstanceId]===void 0&&(I[N.bucketInstanceId]={}),I[N.bucketInstanceId][N.featureIndex])continue;const F=[new r.P(L.x1,L.y1),new r.P(L.x2,L.y1),new r.P(L.x2,L.y2),new r.P(L.x1,L.y2)];r.bN(s,F)&&(I[N.bucketInstanceId][N.featureIndex]=!0,z[N.bucketInstanceId]===void 0&&(z[N.bucketInstanceId]=[]),z[N.bucketInstanceId].push(N.featureIndex))}return z}insertCollisionBox(t,s,h,g,v){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:g,collisionGroupID:v},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,s,h,g,v){const b=s?this.ignoredGrid:this.grid,E={bucketInstanceId:h,featureIndex:g,collisionGroupID:v};for(let I=0;I<t.length;I+=4)b.insertCircle(E,t[I],t[I+1],t[I+2])}projectAndGetPerspectiveRatio(t,s,h,g,v,b,E){const I=[s,h,g,1];let z=!1;g||this.transform.pitch>0?(r.aA(I,I,t),this.fogState&&v&&E.name!=="globe"&&(z=function(F,q,X,G,Y,J){const re=J.calculateFogTileMatrix(Y),pe=[q,X,G];return r.ad(pe,pe,re),Gt(F,r.ae(pe),J.pitch,J._fov)}(this.fogState,s,h,g,v.toUnwrapped(),this.transform)>.9)):Ti(I,I,t);const L=I[3];return{point:new r.P((I[0]/L+1)/2*this.transform.width+sa,(-I[1]/L+1)/2*this.transform.height+sa),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(E)/L*.5,1.5),signedDistanceFromCamera:L,occluded:b&&I[2]>L||z}}isOffscreen(t,s,h,g){return h<sa||t>=this.screenRightBoundary||g<sa||s>this.screenBottomBoundary}isInsideGrid(t,s,h,g){return h>=0&&t<this.gridRightBoundary&&g>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const t=r.bx([]);return r.bo(t,t,[-100,-100,0]),t}}function Pp(u,t,s){const h=t.createTileMatrix(u,u.worldSize,s.toUnwrapped());return r.az(new Float32Array(16),u.projMatrix,h)}function Cn(u,t,s){if(t.projection.name===s.projection.name)return u.projMatrix;const h=s.clone();return h.setProjection(t.projection),Pp(h,t.getProjection(),u)}function Mu(u,t,s){return t.name===s.projection.name?u.projMatrix:Pp(s,t,u)}class vl{constructor(t,s,h,g){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?s:-s))):g&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class $a{constructor(t,s,h,g,v,b=!1){this.text=new vl(t?t.text:null,s,h,v),this.icon=new vl(t?t.icon:null,s,g,v),this.clipped=b}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class qo{constructor(t,s,h,g=!1){this.text=t,this.icon=s,this.skipFade=h,this.clipped=g}}class kp{constructor(){this.invProjMatrix=r.bz(),this.viewportMatrix=r.bz(),this.circles=[]}}class Ru{constructor(t,s,h,g,v){this.bucketInstanceId=t,this.featureIndex=s,this.sourceLayerIndex=h,this.bucketIndex=g,this.tileID=v}}class pn{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const s=++this.maxGroupID;this.collisionGroups[t]={ID:s,predicate:h=>h.collisionGroupID===s}}return this.collisionGroups[t]}}function Bi(u,t,s,h,g){const{horizontalAlign:v,verticalAlign:b}=r.bT(u),E=-(v-.5)*t,I=-(b-.5)*s,z=r.bU(u,h);return new r.P(E+z[0]*g,I+z[1]*g)}function Di(u,t,s,h,g){const v=new r.P(u,t);return s&&v._rotate(h?g:-g),v}class Ho{constructor(t,s,h,g,v,b){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new Mh(this.transform,v),this.buildingIndex=b,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new pn(h),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,s,h,g,v=1){const b=h.getBucket(s),E=h.latestFeatureIndex;if(!b||!E||s.fqid!==b.layerIds[0])return;const I=b.layers[0].layout,z=b.layers[0].paint,L=h.collisionBoxArray,N=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),F=h.tileSize/r.aj,q=h.tileID.toUnwrapped();this.transform.setProjection(b.projection);const X=(G=h.tileID,Y=b.getProjection(),J=this.transform,Y.name===this.projection?J.calculateProjMatrix(G.toUnwrapped()):Pp(J,Y,G));var G,Y,J;const re=I.get("text-pitch-alignment")==="map",pe=I.get("text-rotation-alignment")==="map";s.compileFilter(s.options);const _e=s.dynamicFilter(),Ae=s.dynamicFilterNeedsFeature(),Ie=this.transform.calculatePixelsToTileUnitsMatrix(h),Te=Ed(X,h.tileID.canonical,re,pe,this.transform,b.getProjection(),Ie);let ve=null;if(re){const st=Pu(X,h.tileID.canonical,re,pe,this.transform,b.getProjection(),Ie);ve=r.az([],this.transform.labelPlaneMatrix,st)}let Pe=null;_e&&h.latestFeatureIndex&&(Pe={unwrappedTileID:q,dynamicFilter:_e,dynamicFilterNeedsFeature:Ae}),this.retainedQueryData[b.bucketInstanceId]=new Ru(b.bucketInstanceId,E,b.sourceLayerIndex,b.index,h.tileID);const[Me,We]=b.layers[0].layout.get("text-size-scale-range"),Qe=r.ay(v,Me,We),[ft,pt]=I.get("icon-size-scale-range"),Et=r.ay(v,ft,pt),Ke={bucket:b,layout:I,paint:z,posMatrix:X,textLabelPlaneMatrix:Te,labelToScreenMatrix:ve,clippingData:Pe,scale:N,textPixelRatio:F,holdingForFade:h.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:r.bH(b.textSizeData,this.transform.zoom,Qe),partiallyEvaluatedIconSize:r.bH(b.iconSizeData,this.transform.zoom,Et),collisionGroup:this.collisionGroups.get(b.sourceID),latestFeatureIndex:h.latestFeatureIndex};if(g)for(const st of b.sortKeyRanges){const{sortKey:Ve,symbolInstanceStart:_t,symbolInstanceEnd:nt}=st;t.push({sortKey:Ve,symbolInstanceStart:_t,symbolInstanceEnd:nt,parameters:Ke})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Ke})}attemptAnchorPlacement(t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y,J,re){const{textOffset0:pe,textOffset1:_e,crossTileID:Ae}=F,Ie=[pe,_e],Te=Bi(t,h,g,Ie,v),ve=this.collisionIndex.placeCollisionBox(X,v,s,Di(Te.x,Te.y,b,E,this.transform.angle),N,I,z,L.predicate);if(Y){const Pe=X.getSymbolInstanceIconSize(re,this.transform.zoom,F.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(X,Pe,Y,Di(Te.x,Te.y,b,E,this.transform.angle),N,I,z,L.predicate).box.length===0)return}if(ve.box.length>0){let Pe;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ae]&&this.prevPlacement.placements[Ae]&&this.prevPlacement.placements[Ae].text&&(Pe=this.prevPlacement.variableOffsets[Ae].anchor),this.variableOffsets[Ae]={textOffset:Ie,width:h,height:g,anchor:t,textScale:v,prevAnchor:Pe},this.markUsedJustification(X,t,F,G),X.allowVerticalPlacement&&(this.markUsedOrientation(X,G,F),this.placedOrientations[Ae]=G),{shift:Te,placedGlyphBoxes:ve}}}placeLayerBucketPart(t,s,h,g,v=1){const{bucket:b,layout:E,paint:I,posMatrix:z,textLabelPlaneMatrix:L,labelToScreenMatrix:N,clippingData:F,textPixelRatio:q,holdingForFade:X,collisionBoxArray:G,partiallyEvaluatedTextSize:Y,partiallyEvaluatedIconSize:J,collisionGroup:re,latestFeatureIndex:pe}=t.parameters,_e=E.get("text-optional"),Ae=E.get("icon-optional"),Ie=E.get("text-allow-overlap"),Te=E.get("icon-allow-overlap"),ve=E.get("text-rotation-alignment")==="map",Pe=E.get("text-pitch-alignment")==="map",Me=I.get("symbol-z-offset"),We=E.get("symbol-elevation-reference")==="sea",[Qe,ft]=E.get("text-size-scale-range"),[pt,Et]=E.get("icon-size-scale-range"),Ke=r.ay(v,Qe,ft),st=r.ay(v,pt,Et);this.transform.setProjection(b.projection);let Ve=Ie&&(Te||!b.hasIconData()||Ae),_t=Te&&(Ie||!b.hasTextData()||_e);const nt=!Me.isConstant();!b.collisionArrays&&G&&b.deserializeCollisionBoxes(G),h&&g&&b.updateCollisionDebugBuffers(this.transform.zoom,G,Ke,st);const Tt=(yt,Lt,Yt)=>{const{crossTileID:tn,numVerticalGlyphVertices:Xt}=yt;let rn=null;if(F&&F.dynamicFilterNeedsFeature||nt){const Ni=this.retainedQueryData[b.bucketInstanceId];rn=pe.loadFeature({featureIndex:yt.featureIndex,bucketIndex:Ni.bucketIndex,sourceLayerIndex:Ni.sourceLayerIndex,layoutVertexArrayOffset:0})}if(F&&!(0,F.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},rn,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new r.P(yt.tileAnchorX,yt.tileAnchorY),this.transform.calculateDistanceTileData(F.unwrappedTileID)))return this.placements[tn]=new qo(!1,!1,!1,!0),void s.add(tn);const fn=Me.evaluate(rn,{});if(s.has(tn))return;if(X)return void(this.placements[tn]=new qo(!1,!1,!1));let _n=!1,Pn=!1,Wn=!0,vi=!1,Ji=!1,Oi=null,Ai={box:null,offscreen:null,occluded:null},Dr={box:null},Dn=null,Zn=null,si=null,er=0,Hr=0,nr=0;Yt.textFeatureIndex?er=Yt.textFeatureIndex:yt.useRuntimeCollisionCircles&&(er=yt.featureIndex),Yt.verticalTextFeatureIndex&&(Hr=Yt.verticalTextFeatureIndex);const Mi=Ni=>{Ni.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;const ir=this.transform.elevation;Ni.elevation=We?fn:fn+(ir?ir.getAtTileOffset(Ni.tileID,Ni.tileAnchorX,Ni.tileAnchorY):0),Ni.elevation+=yt.zOffset},Mr=Yt.textBox;if(Mr){Mi(Mr);const Ni=$n=>{let Br=r.bI.horizontal;if(b.allowVerticalPlacement&&!$n&&this.prevPlacement){const ks=this.prevPlacement.placedOrientations[tn];ks&&(this.placedOrientations[tn]=ks,Br=ks,this.markUsedOrientation(b,Br,yt))}return Br},ir=($n,Br)=>{if(b.allowVerticalPlacement&&Xt>0&&Yt.verticalTextBox){for(const ks of b.writingModes)if(ks===r.bI.vertical?(Ai=Br(),Dr=Ai):Ai=$n(),Ai&&Ai.box&&Ai.box.length)break}else Ai=$n()};if(E.get("text-variable-anchor")){let $n=E.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[tn]){const fr=this.prevPlacement.variableOffsets[tn];$n.indexOf(fr.anchor)>0&&($n=$n.filter(Pi=>Pi!==fr.anchor),$n.unshift(fr.anchor))}const Br=(fr,Pi,Do)=>{const xo=b.getSymbolInstanceTextSize(Y,yt,this.transform.zoom,Lt),ha=(fr.x2-fr.x1)*xo+2*fr.padding,ms=(fr.y2-fr.y1)*xo+2*fr.padding,Qo=yt.hasIconTextFit&&!Te?Pi:null;Qo&&Mi(Qo);let Oo={box:[],offscreen:!1,occluded:!1};const Bo=Ie?2*$n.length:$n.length;for(let Jo=0;Jo<Bo;++Jo){const ea=this.attemptAnchorPlacement($n[Jo%$n.length],fr,ha,ms,xo,ve,Pe,q,z,re,Jo>=$n.length,yt,Lt,b,Do,Qo,Y,J);if(ea&&(Oo=ea.placedGlyphBoxes,Oo&&Oo.box&&Oo.box.length)){_n=!0,Oi=ea.shift;break}}return Oo};ir(()=>Br(Mr,Yt.iconBox,r.bI.horizontal),()=>{const fr=Yt.verticalTextBox;return fr&&Mi(fr),b.allowVerticalPlacement&&!(Ai&&Ai.box&&Ai.box.length)&&Xt>0&&fr?Br(fr,Yt.verticalIconBox,r.bI.vertical):{box:null,offscreen:null,occluded:null}}),Ai&&(_n=Ai.box,Wn=Ai.offscreen,vi=Ai.occluded);const ks=Ni(!(!Ai||!Ai.box));if(!_n&&this.prevPlacement){const fr=this.prevPlacement.variableOffsets[tn];fr&&(this.variableOffsets[tn]=fr,this.markUsedJustification(b,fr.anchor,yt,ks))}}else{const $n=(Br,ks)=>{const fr=b.getSymbolInstanceTextSize(Y,yt,this.transform.zoom,Lt,v),Pi=this.collisionIndex.placeCollisionBox(b,fr,Br,new r.P(0,0),Ie,q,z,re.predicate);return Pi&&Pi.box&&Pi.box.length&&(this.markUsedOrientation(b,ks,yt),this.placedOrientations[tn]=ks),Pi};ir(()=>$n(Mr,r.bI.horizontal),()=>{const Br=Yt.verticalTextBox;return b.allowVerticalPlacement&&Xt>0&&Br?(Mi(Br),$n(Br,r.bI.vertical)):{box:null,offscreen:null,occluded:null}}),Ni(!!(Ai&&Ai.box&&Ai.box.length))}}if(Dn=Ai,_n=Dn&&Dn.box&&Dn.box.length>0,Wn=Dn&&Dn.offscreen,vi=Dn&&Dn.occluded,yt.useRuntimeCollisionCircles){const Ni=b.text.placedSymbolArray.get(yt.centerJustifiedTextSymbolIndex>=0?yt.centerJustifiedTextSymbolIndex:yt.verticalPlacedTextSymbolIndex),ir=r.bJ(b.textSizeData,Y,Ni),$n=E.get("text-padding");Zn=this.collisionIndex.placeCollisionCircles(b,Ie,Ni,b.lineVertexArray,b.glyphOffsetArray,ir,z,L,N,h,Pe,re.predicate,yt.collisionCircleDiameter*ir/r.bO,$n,this.retainedQueryData[b.bucketInstanceId].tileID),_n=Ie||Zn.circles.length>0&&!Zn.collisionDetected,Wn=Wn&&Zn.offscreen,vi=Zn.occluded}if(Yt.iconFeatureIndex&&(nr=Yt.iconFeatureIndex),Yt.iconBox){const Ni=ir=>{Mi(ir);const $n=yt.hasIconTextFit&&Oi?Di(Oi.x,Oi.y,ve,Pe,this.transform.angle):new r.P(0,0),Br=b.getSymbolInstanceIconSize(J,this.transform.zoom,yt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,Br,ir,$n,Te,q,z,re.predicate)};Dr&&Dr.box&&Dr.box.length&&Yt.verticalIconBox?(si=Ni(Yt.verticalIconBox),Pn=si.box.length>0):(si=Ni(Yt.iconBox),Pn=si.box.length>0),Wn=Wn&&si.offscreen,Ji=si.occluded}const yi=_e||yt.numHorizontalGlyphVertices===0&&Xt===0,Rr=Ae||yt.numIconVertices===0;if(yi||Rr?Rr?yi||(Pn=Pn&&_n):_n=Pn&&_n:Pn=_n=Pn&&_n,_n&&Dn&&Dn.box&&this.collisionIndex.insertCollisionBox(Dn.box,E.get("text-ignore-placement"),b.bucketInstanceId,Dr&&Dr.box&&Hr?Hr:er,re.ID),Pn&&si&&this.collisionIndex.insertCollisionBox(si.box,E.get("icon-ignore-placement"),b.bucketInstanceId,nr,re.ID),Zn&&(_n&&this.collisionIndex.insertCollisionCircles(Zn.circles,E.get("text-ignore-placement"),b.bucketInstanceId,er,re.ID),h)){const Ni=b.bucketInstanceId;let ir=this.collisionCircleArrays[Ni];ir===void 0&&(ir=this.collisionCircleArrays[Ni]=new kp);for(let $n=0;$n<Zn.circles.length;$n+=4)ir.circles.push(Zn.circles[$n+0]),ir.circles.push(Zn.circles[$n+1]),ir.circles.push(Zn.circles[$n+2]),ir.circles.push(Zn.collisionDetected?1:0)}const cr=b.projection.name!=="globe";Ve=Ve&&(cr||!vi),_t=_t&&(cr||!Ji),this.placements[tn]=new qo(_n||Ve,Pn||_t,Wn||b.justReloaded),s.add(tn)},jt=this.retainedQueryData[b.bucketInstanceId].tileID;if(b.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(b,jt),b.elevationType==="road"&&b.updateRoadElevation(jt.canonical),b.updateZOffset(),b.sortFeaturesByY){const yt=b.getSortedSymbolIndexes(this.transform.angle);for(let Lt=yt.length-1;Lt>=0;--Lt){const Yt=yt[Lt];Tt(b.symbolInstances.get(Yt),Yt,b.collisionArrays[Yt])}b.hasAnyZOffset&&r.w(`${b.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(b.hasAnyZOffset){const yt=b.getSortedIndexesByZOffset();for(let Lt=0;Lt<yt.length;++Lt){const Yt=yt[Lt];Tt(b.symbolInstances.get(Yt),Yt,b.collisionArrays[Yt])}}else for(let yt=t.symbolInstanceStart;yt<t.symbolInstanceEnd;yt++)Tt(b.symbolInstances.get(yt),yt,b.collisionArrays[yt]);if(h&&b.bucketInstanceId in this.collisionCircleArrays){const yt=this.collisionCircleArrays[b.bucketInstanceId];r.bi(yt.invProjMatrix,z),yt.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(t,s,h,g){const{leftJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:b,rightJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:I,crossTileID:z}=h,L=r.bV(s),N=g===r.bI.vertical?I:L==="left"?v:L==="center"?b:L==="right"?E:-1;v>=0&&(t.text.placedSymbolArray.get(v).crossTileID=N>=0&&v!==N?0:z),b>=0&&(t.text.placedSymbolArray.get(b).crossTileID=N>=0&&b!==N?0:z),E>=0&&(t.text.placedSymbolArray.get(E).crossTileID=N>=0&&E!==N?0:z),I>=0&&(t.text.placedSymbolArray.get(I).crossTileID=N>=0&&I!==N?0:z)}markUsedOrientation(t,s,h){const g=s===r.bI.horizontal||s===r.bI.horizontalOnly?s:0,v=s===r.bI.vertical?s:0,{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:z}=h,L=t.text.placedSymbolArray;b>=0&&(L.get(b).placedOrientation=g),E>=0&&(L.get(E).placedOrientation=g),I>=0&&(L.get(I).placedOrientation=g),z>=0&&(L.get(z).placedOrientation=v)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let h=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const g=s?s.symbolFadeChange(t):1,v=s?s.opacities:{},b=s?s.variableOffsets:{},E=s?s.placedOrientations:{};for(const I in this.placements){const z=this.placements[I],L=v[I];L?(this.opacities[I]=new $a(L,g,z.text,z.icon,null,z.clipped),h=h||z.text!==L.text.placed||z.icon!==L.icon.placed):(this.opacities[I]=new $a(null,g,z.text,z.icon,z.skipFade,z.clipped),h=h||z.text||z.icon)}for(const I in v){const z=v[I];if(!this.opacities[I]){const L=new $a(z,g,!1,!1);L.isHidden()||(this.opacities[I]=L,h=h||z.text.placed||z.icon.placed)}}for(const I in b)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=b[I]);for(const I in E)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=E[I]);h?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:t)}updateLayerOpacities(t,s,h,g){const v=new Set;for(const b of s){const E=b.getBucket(t);E&&b.latestFeatureIndex&&t.fqid===E.layerIds[0]&&(this.updateBucketOpacities(E,v,b,b.collisionBoxArray,h,g,b.tileID,t.scope),E.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(E,b.tileID),E.elevationType==="road"&&E.updateRoadElevation(b.tileID.canonical),E.updateZOffset())}}updateBucketOpacities(t,s,h,g,v,b,E,I){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const z=t.layers[0].layout,L=t.layers[0].paint,N=!!t.layers[0].dynamicFilter(),F=new $a(null,0,!1,!1,!0),q=z.get("text-allow-overlap"),X=z.get("icon-allow-overlap"),G=z.get("text-variable-anchor"),Y=z.get("text-rotation-alignment")==="map",J=z.get("text-pitch-alignment")==="map",re=L.get("symbol-z-offset"),pe=z.get("symbol-elevation-reference")==="sea",_e=!re.isConstant(),Ae=new $a(null,0,q&&(X||!t.hasIconData()||z.get("icon-optional")),X&&(q||!t.hasTextData()||z.get("text-optional")),!0);!t.collisionArrays&&g&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(g);const Ie=(ve,Pe,Me)=>{for(let We=0;We<Pe/4;We++)ve.opacityVertexArray.emplaceBack(Me)};let Te=0;b&&t.updateReplacement(E,b);for(let ve=0;ve<t.symbolInstances.length;ve++){const Pe=t.symbolInstances.get(ve),{numHorizontalGlyphVertices:Me,numVerticalGlyphVertices:We,crossTileID:Qe,numIconVertices:ft,tileAnchorX:pt,tileAnchorY:Et}=Pe;let Ke=null;const st=this.retainedQueryData[t.bucketInstanceId];_e&&Pe&&st&&(Ke=h.latestFeatureIndex.loadFeature({featureIndex:Pe.featureIndex,bucketIndex:st.bucketIndex,sourceLayerIndex:st.sourceLayerIndex,layoutVertexArrayOffset:0}));const Ve=re.evaluate(Ke,{}),_t=s.has(Qe);let nt=this.opacities[Qe];_t?nt=F:nt||(nt=Ae,this.opacities[Qe]=nt),s.add(Qe);const Tt=Me>0||We>0,jt=ft>0,yt=this.placedOrientations[Qe],Lt=yt===r.bI.vertical,Yt=yt===r.bI.horizontal||yt===r.bI.horizontalOnly;!Tt&&!jt||nt.isHidden()||Te++;let tn=!1;if((Tt||jt)&&b)for(const Xt of t.activeReplacements){if(r.bP(Xt,v,r.bQ.Symbol,I)||Xt.min.x>pt||pt>Xt.max.x||Xt.min.y>Et||Et>Xt.max.y)continue;const rn=r.bR(pt,Et,E.canonical,Xt.footprintTileId.canonical);if(tn=r.bS(rn,Xt.footprint),tn)break}if(Tt){const Xt=tn?ac:oc(nt.text);Ie(t.text,Me,Lt?ac:Xt),Ie(t.text,We,Yt?ac:Xt);const rn=nt.text.isHidden(),{leftJustifiedTextSymbolIndex:fn,centerJustifiedTextSymbolIndex:_n,rightJustifiedTextSymbolIndex:Pn,verticalPlacedTextSymbolIndex:Wn}=Pe,vi=t.text.placedSymbolArray,Ji=rn||Lt?1:0;fn>=0&&(vi.get(fn).hidden=Ji),_n>=0&&(vi.get(_n).hidden=Ji),Pn>=0&&(vi.get(Pn).hidden=Ji),Wn>=0&&(vi.get(Wn).hidden=rn||Yt?1:0);const Oi=this.variableOffsets[Qe];Oi&&this.markUsedJustification(t,Oi.anchor,Pe,yt);const Ai=this.placedOrientations[Qe];Ai&&(this.markUsedJustification(t,"left",Pe,Ai),this.markUsedOrientation(t,Ai,Pe))}if(jt){const Xt=tn?ac:oc(nt.icon),{placedIconSymbolIndex:rn,verticalPlacedIconSymbolIndex:fn}=Pe,_n=t.icon.placedSymbolArray,Pn=nt.icon.isHidden()?1:0;rn>=0&&(Ie(t.icon,ft,Lt?ac:Xt),_n.get(rn).hidden=Pn),fn>=0&&(Ie(t.icon,Pe.numVerticalIconVertices,Yt?ac:Xt),_n.get(fn).hidden=Pn)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Xt=t.collisionArrays[ve];if(Xt){let rn=new r.P(0,0),fn=!0;if(Xt.textBox||Xt.verticalTextBox){if(G){const Pn=this.variableOffsets[Qe];Pn?(rn=Bi(Pn.anchor,Pn.width,Pn.height,Pn.textOffset,Pn.textScale),Y&&rn._rotate(J?this.transform.angle:-this.transform.angle)):fn=!1}N&&(fn=!nt.clipped),Xt.textBox&&xl(t.textCollisionBox.collisionVertexArray,nt.text.placed,!fn||Lt,Ve,pe,rn.x,rn.y),Xt.verticalTextBox&&xl(t.textCollisionBox.collisionVertexArray,nt.text.placed,!fn||Yt,Ve,pe,rn.x,rn.y)}const _n=fn&&!!(!Yt&&Xt.verticalIconBox);Xt.iconBox&&xl(t.iconCollisionBox.collisionVertexArray,nt.icon.placed,_n,Ve,pe,Pe.hasIconTextFit?rn.x:0,Pe.hasIconTextFit?rn.y:0),Xt.verticalIconBox&&xl(t.iconCollisionBox.collisionVertexArray,nt.icon.placed,!_n,Ve,pe,Pe.hasIconTextFit?rn.x:0,Pe.hasIconTextFit?rn.y:0)}}}if(t.fullyClipped=Te===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const ve=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=ve.invProjMatrix,t.placementViewportMatrix=ve.viewportMatrix,t.collisionCircleArray=ve.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,s){const h=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*h>t}setStale(){this.stale=!0}}function xl(u,t,s,h,g,v,b){u.emplaceBack(t?1:0,s?1:0,v||0,b||0,h,g?1:0),u.emplaceBack(t?1:0,s?1:0,v||0,b||0,h,g?1:0),u.emplaceBack(t?1:0,s?1:0,v||0,b||0,h,g?1:0),u.emplaceBack(t?1:0,s?1:0,v||0,b||0,h,g?1:0)}const Fi=Math.pow(2,25),Ad=Math.pow(2,24),zu=Math.pow(2,17),Rh=Math.pow(2,16),fo=Math.pow(2,9),cs=Math.pow(2,8),Vm=Math.pow(2,1);function oc(u){if(u.opacity===0&&!u.placed)return 0;if(u.opacity===1&&u.placed)return 4294967295;const t=u.placed?1:0,s=Math.floor(127*u.opacity);return s*Fi+t*Ad+s*zu+t*Rh+s*fo+t*cs+s*Vm+t}const ac=0;class zh{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,s,h,g,v,b){const E=this._bucketParts;for(;this._currentTileIndex<t.length;)if(s.getBucketParts(E,g,t[this._currentTileIndex],this._sortAcrossTiles,b),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((I,z)=>I.sortKey-z.sortKey));this._currentPartIndex<E.length;){const I=E[this._currentPartIndex];if(s.placeLayerBucketPart(I,this._seenCrossTileIDs,h,I.symbolInstanceStart===0,b),this._currentPartIndex++,v())return!0}return!1}}class Id{constructor(t,s,h,g,v,b,E,I,z){this.placement=new Ho(t,v,b,E,I,z),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(t,s,h,g,v){const b=r.q.now(),E=()=>{const I=r.q.now()-b;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=s[t[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(I.type==="symbol"&&(!I.minzoom||I.minzoom<=z)&&(!I.maxzoom||I.maxzoom>z)){const L=I,N=L.layout.get("symbol-z-elevate"),F=L.layout.get("symbol-sort-key").constantOr(1)!==void 0,q=L.layout.get("symbol-z-order"),X=q==="viewport-y"||q==="auto"&&!(q!=="viewport-y"&&F),G=L.layout.get("text-allow-overlap")||L.layout.get("icon-allow-overlap")||L.layout.get("text-ignore-placement")||L.layout.get("icon-ignore-placement"),Y=X&&G,J=this._inProgressLayer=this._inProgressLayer||new zh(L),re=r.C(I.source,I.scope);if(J.continuePlacement(N||Y?g[re]:h[re],this.placement,this._showCollisionBoxes,I,E,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Lu=512/r.aj/2;class Pd{constructor(t,s,h){this.tileID=t,this.bucketInstanceId=h,this.index=new r.bW(s.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const g=t.canonical.x*r.aj,v=t.canonical.y*r.aj;for(let b=0;b<s.length;b++){const{key:E,crossTileID:I,tileAnchorX:z,tileAnchorY:L}=s.get(b),N=Math.floor((g+z)*Lu),F=Math.floor((v+L)*Lu);this.index.add(N,F),this.keys.push(E),this.crossTileIDs.push(I)}this.index.finish()}findMatches(t,s,h){const g=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),v=Lu/Math.pow(2,s.canonical.z-this.tileID.canonical.z),b=s.canonical.x*r.aj,E=s.canonical.y*r.aj;for(let I=0;I<t.length;I++){const z=t.get(I);if(z.crossTileID)continue;const{key:L,tileAnchorX:N,tileAnchorY:F}=z,q=Math.floor((b+N)*v),X=Math.floor((E+F)*v),G=this.index.range(q-g,X-g,q+g,X+g).sort((Y,J)=>Y-J);for(const Y of G){const J=this.crossTileIDs[Y];if(this.keys[Y]===L&&!h.has(J)){h.add(J),z.crossTileID=J;break}}}}}class mo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class bl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const s=Math.round((t-this.lng)/360);if(s!==0)for(const h in this.indexes){const g=this.indexes[h],v={};for(const b in g){const E=g[b];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+s),v[E.tileID.key]=E}this.indexes[h]=v}this.lng=t}addBucket(t,s,h){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let v=0;v<s.symbolInstances.length;v++)s.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const g=this.usedCrossTileIDs[t.overscaledZ];for(const v in this.indexes){const b=this.indexes[v];if(Number(v)>t.overscaledZ)for(const E in b){const I=b[E];I.tileID.isChildOf(t)&&I.findMatches(s.symbolInstances,t,g)}else{const E=b[t.scaledTo(Number(v)).key];E&&E.findMatches(s.symbolInstances,t,g)}}for(let v=0;v<s.symbolInstances.length;v++){const b=s.symbolInstances.get(v);b.crossTileID||(b.crossTileID=h.generate(),g.add(b.crossTileID))}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Pd(t,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(t,s){for(const h of s.crossTileIDs)this.usedCrossTileIDs[t].delete(h)}removeStaleBuckets(t){let s=!1;for(const h in this.indexes){const g=this.indexes[h];for(const v in g)t[g[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,g[v]),delete g[v],s=!0)}return s}}class Po{constructor(){this.layerIndexes={},this.crossTileIDs=new mo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,s,h,g){let v=this.layerIndexes[t.fqid];v===void 0&&(v=this.layerIndexes[t.fqid]=new bl);let b=!1;const E={};g.name!=="globe"&&v.handleWrapJump(h);for(const I of s){const z=I.getBucket(t);z&&t.fqid===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(I.tileID,z,this.crossTileIDs)&&(b=!0),E[z.bucketInstanceId]=!0)}return v.removeStaleBuckets(E)&&(b=!0),b}pruneUnusedLayers(t){const s={};t.forEach(h=>{s[h]=!0});for(const h in this.layerIndexes)s[h]||delete this.layerIndexes[h]}}const qc=771;class ii{constructor(t,s,h,g){this.blendFunction=t,this.blendColor=s.toNonPremultipliedRenderColor(null),this.mask=h,this.blendEquation=g}}ii.Replace=[1,0,1,0],ii.disabled=new ii(ii.Replace,r.am.transparent,[!1,!1,!1,!1]),ii.unblended=new ii(ii.Replace,r.am.transparent,[!0,!0,!0,!0]),ii.alphaBlended=new ii([1,qc,1,qc],r.am.transparent,[!0,!0,!0,!0]),ii.alphaBlendedNonPremultiplied=new ii([770,qc,770,qc],r.am.transparent,[!0,!0,!0,!0]),ii.multiply=new ii([774,0,774,0],r.am.transparent,[!0,!0,!0,!0]);class sn{constructor(t,s,h){this.func=t,this.mask=s,this.range=h}}sn.ReadOnly=!1,sn.ReadWrite=!0,sn.disabled=new sn(519,sn.ReadOnly,[0,1]);const Uo=7680;class In{constructor(t,s,h,g,v,b){this.test=t,this.ref=s,this.mask=h,this.fail=g,this.depthFail=v,this.pass=b}}In.disabled=new In({func:519,mask:0},0,0,Uo,Uo,Uo);const rs=1029,Du=2305;class Sn{constructor(t,s,h){this.enable=t,this.mode=s,this.frontFace=h}}function Hc(u,t){const s=r.c1(u,3);r.c3(u,t),r.c7(u,3,s)}function Uc(u,t){const s=r.b_([]);return r.b$(s,s,-t),r.c0(s,s,-u),s}function wl(u,t){const s=[u[0],u[1],0],h=[t[0],t[1],0];if(r.ae(s)>=1e-15){const b=r.au([],s);r.bY(h,b,r.bG(h,b)),t[0]=h[0],t[1]=h[1]}const g=r.bF([],t,u);if(r.bZ(g)<1e-15)return null;const v=Math.atan2(-g[1],g[0]);return Uc(Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2]),v)}Sn.disabled=new Sn(!1,rs,Du),Sn.backCCW=new Sn(!0,rs,Du),Sn.backCW=new Sn(!0,rs,2304),Sn.frontCW=new Sn(!0,1028,2304),Sn.frontCCW=new Sn(!0,1028,Du);class $c{constructor(t,s){this.position=t,this.orientation=s}get position(){return this._position}set position(t){if(t){const s=t instanceof r.ac?t:new r.ac(t[0],t[1],t[2]);this._renderWorldCopies&&(s.x=r.bX(s.x,0,1)),this._position=s}else this._position=null}lookAtPoint(t,s){if(this.orientation=null,!this.position)return;const h=this.position,g=this._elevation?this._elevation.getAtPointOrZero(r.ac.fromLngLat(t)):0,v=r.ac.fromLngLat(t,g),b=[v.x-h.x,v.y-h.y,v.z-h.z];s||(s=[0,0,1]),s[2]=Math.abs(s[2]),this.orientation=wl(b,s)}setPitchBearing(t,s){this.orientation=Uc(r.al(t),r.al(-s))}}class ya{constructor(t,s){this._transform=r.bx([]),this.orientation=s,this.position=t}get mercatorPosition(){const t=this.position;return new r.ac(t[0],t[1],t[2])}get position(){const t=r.c1(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var s;t&&r.c7(this._transform,3,[(s=t)[0],s[1],s[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||r.b_([]),t&&Hc(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),s=this.right();return{bearing:Math.atan2(-s[1],s[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,s){this._orientation=Uc(t,s),Hc(this._transform,this._orientation)}forward(){const t=r.c1(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=r.c1(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=r.c1(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,s){const h=new Float64Array(16);return r.bi(h,this.getWorldToCamera(t,s)),h}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,s,h){const g=this.position;r.bY(g,g,-t);const v=new Float64Array(16);return r.bn(v,[h,h,h]),r.bo(v,v,g),v[10]*=s,v}getWorldToCamera(t,s){const h=new Float64Array(16),g=new Float64Array(4),v=this.position;return r.c2(g,this._orientation),r.bY(v,v,-t),r.c3(h,g),r.bo(h,h,v),h[1]*=-1,h[5]*=-1,h[9]*=-1,h[13]*=-1,h[8]*=s,h[9]*=s,h[10]*=s,h[11]*=s,h}getCameraToClipPerspective(t,s,h,g){const v=new Float64Array(16);return r.c4(v,t,s,h,g),v}getCameraToClipOrthographic(t,s,h,g,v,b){const E=new Float64Array(16);return r.c5(E,t,s,h,g,v,b),E}getDistanceToElevation(t,s=!1){const h=t===0?0:r.c6(t,s?r.aY(this.position[1]):this.position[1]),g=this.forward();return(h-this.position[2])/g[2]}clone(){return new ya([...this.position],[...this.orientation])}}const go={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Lh{constructor(t=0,s=0,h=0,g=0){if(isNaN(t)||t<0||isNaN(s)||s<0||isNaN(h)||h<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=s,this.left=h,this.right=g}interpolate(t,s,h){return s.top!=null&&t.top!=null&&(this.top=r.ai(t.top,s.top,h)),s.bottom!=null&&t.bottom!=null&&(this.bottom=r.ai(t.bottom,s.bottom,h)),s.left!=null&&t.left!=null&&(this.left=r.ai(t.left,s.left,h)),s.right!=null&&t.right!=null&&(this.right=r.ai(t.right,s.right,h)),this}getCenter(t,s){const h=r.ay((this.left+t-this.right)/2,0,t),g=r.ay((this.top+s-this.bottom)/2,0,s);return new r.P(h,g)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Lh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const vs=15;class kd{constructor(t,s,h,g,v,b,E){this.tileSize=512,this._renderWorldCopies=v===void 0||v,this._minZoom=t||0,this._maxZoom=s||22,this._minPitch=h??0,this._maxPitch=g??60,this.setProjection(b),this.setMaxBounds(E),this.width=0,this.height=0,this._center=new r.cd(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Lh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ya,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const t=new kd(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t._allowWorldUnderZoom=this._allowWorldUnderZoom,t}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<vs}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(t,s=!1){const h=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||h)&&this._updateCameraOnTerrain(),(t||h)&&this._constrainCamera(s),this._calcMatrices()}getProjection(){return r.aF(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const s=this.projection?this.getProjection():void 0;this.projection=r.ce(this.projectionOptions);const h=this.getProjection(),g=!r.bv(s,h);return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.ce({name:"mercator"});const s=t!==this.projection.name;return s&&this._calcMatrices(),s}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.c6(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return r.bX(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const s=-t*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=r.cf(),r.cg(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const s=r.ay(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=r.al(t),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const s=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._setZoom(s),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(t){this._tileCoverLift!==t&&(this._tileCoverLift=t)}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,s=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!s||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;s||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&h.exaggeration()&&this._centerAltitudeValidForExaggeration!==h.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*h.exaggeration(),this._centerAltitudeValidForExaggeration=h.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=h.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const t=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(t)}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,s=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],h=this.horizonLineFromTop();let g=0,v=0;for(let b=0;b<s.length;b++){const E=new r.P(s[b][0]*this.width,h+s[b][1]*(this.height-h)),I=t.pointCoordinate(E);if(!I)continue;const z=1/Math.hypot(I[0]-this._camera.position[0],I[1]-this._camera.position[1]);g+=I[3]*z,v+=z}return v===0?NaN:g/v}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,s=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),h=this.pixelsPerMeter/this.worldSize*s,g=this._mercatorZfromZoom(t),v=this._mercatorZfromZoom(this._maxZoom),b=Math.max(g-h,v);this._setZoom(this._zoomFromMercatorZ(b))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const s=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let h;h=t.z<this._camera.position[2]?[s.x,s.y,s.z]:[t.x,t.y,t.z];const g=r.ae(r.at([],this._camera.position,h));return r.ay(this._zoomFromMercatorZ(g),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let s=!1;if(t.orientation&&!r.ch(t.orientation,this._camera.orientation)&&(s=this._setCameraOrientation(t.orientation)),t.position){const h=[t.position.x,t.position.y,t.position.z];r.ci(h,this._camera.position)||(this._setCameraPosition(h),s=!0)}s&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,s=new $c;return s.position=new r.ac(t[0],t[1],t[2]),s.orientation=this._camera.orientation,s._elevation=this.elevation,s._renderWorldCopies=this.renderWorldCopies,s}_setCameraOrientation(t){if(!r.cj(t))return!1;r.ck(t,t);const s=r.cl([],[0,0,-1],t),h=r.cl([],[0,-1,0],t);if(h[2]<0)return!1;const g=wl(s,h);return!!g&&(this._camera.orientation=g,!0)}_setCameraPosition(t){const s=this.zoomScale(this.minZoom)*this.tileSize,h=this.zoomScale(this.maxZoom)*this.tileSize,g=this.cameraToCenterDistance;t[2]=r.ay(t[2],g/h,g/s),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,s,h){this._unmodified=!1,this._edgeInsets.interpolate(t,s,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const s=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(t){const s=[new r.cm(0,t)];if(this.renderWorldCopies){const h=this.pointCoordinate(new r.P(0,0)),g=this.pointCoordinate(new r.P(this.width,0)),v=this.pointCoordinate(new r.P(this.width,this.height)),b=this.pointCoordinate(new r.P(0,this.height)),E=Math.floor(Math.min(h.x,g.x,v.x,b.x)),I=Math.floor(Math.max(h.x,g.x,v.x,b.x)),z=1;for(let L=E-z;L<=I+z;L++)L!==0&&s.push(new r.cm(L,t))}return s}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(t,s,h){let g=[];const v=h!=null,b=!v;if(b&&this.zoom<s||v&&h[0]===0&&h[1]===0)return g;const E=new Set,I=(L,N,F,q,X)=>{const G=r.cK(N,L,F,q,X);E.has(G)||(g.push(new r.aM(L,N,F,q,X)),E.add(G))};for(let L=0;L<t.length;L++){const N=t[L];if(b&&N.canonical.z!==s)continue;const F=N.canonical,q=N.overscaledZ,X=N.wrap,G=1<<F.z,Y=F.x+1<G,J=F.x>0,re=F.y+1<G,pe=F.y>0,_e=N.wrap-(J?0:1),Ae=N.wrap+(Y?0:1),Ie=J?F.x-1:G-1,Te=Y?F.x+1:0;if(v)h[0]<0?(I(q,Ae,F.z,Te,F.y),h[1]<0&&re&&(I(q,X,F.z,F.x,F.y+1),I(q,Ae,F.z,Te,F.y+1)),h[1]>0&&pe&&(I(q,X,F.z,F.x,F.y-1),I(q,Ae,F.z,Te,F.y-1))):h[0]>0?(I(q,_e,F.z,Ie,F.y),h[1]<0&&re&&(I(q,X,F.z,F.x,F.y+1),I(q,_e,F.z,Ie,F.y+1)),h[1]>0&&pe&&(I(q,X,F.z,F.x,F.y-1),I(q,_e,F.z,Ie,F.y-1))):h[1]<0&&re?I(q,X,F.z,F.x,F.y+1):pe&&I(q,X,F.z,F.x,F.y-1);else{const ve=N.visibleQuadrants;1&ve&&(I(q,_e,F.z,Ie,F.y),pe&&(I(q,X,F.z,F.x,F.y-1),I(q,_e,F.z,Ie,F.y-1))),2&ve&&(I(q,Ae,F.z,Te,F.y),pe&&(I(q,X,F.z,F.x,F.y-1),I(q,Ae,F.z,Te,F.y-1))),4&ve&&(I(q,_e,F.z,Ie,F.y),re&&(I(q,X,F.z,F.x,F.y+1),I(q,_e,F.z,Ie,F.y+1))),8&ve&&(I(q,Ae,F.z,Te,F.y),re&&(I(q,X,F.z,F.x,F.y+1),I(q,Ae,F.z,Te,F.y+1)))}}const z=[];for(const L of g)g.some(N=>L.isChildOf(N))||z.push(L);if(g=z.filter(L=>!t.some(N=>!!(L.overscaledZ<s&&N.isChildOf(L))||L.equals(N)||L.isChildOf(N))),b){const L=1<<s,N=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),F=[L*N.x,L*N.y],q=4,X=q*q;g=g.filter(G=>{const Y=G.canonical.x+.5-F[0],J=G.canonical.y+.5-F[1];return Y*Y+J*J<X})}return g}coveringTiles(t){let s=this.coveringZoomLevel(t);const h=s,g=this.elevation&&this.elevation.exaggeration(),v=g&&!t.isTerrainDEM,b=this.projection.name==="mercator";if(t.minzoom!==void 0&&s<t.minzoom)return[];t.maxzoom!==void 0&&s>t.maxzoom&&(s=t.maxzoom);const E=this.locationCoordinate(this.center),I=this.center.lat,z=1<<s,L=[z*E.x,z*E.y,0],N=this.projection.name==="globe",F=!N,q=r.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,F),X=N?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),G=z*r.c6(1,this.center.lat),Y=this._camera.position[2]/r.c6(1,this.center.lat),J=[z*X.x,z*X.y,Y*(F?1:G)],re=N||g,pe=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),_e=this.isLODDisabled(!0)?s:0;let Ae;if(this._elevation&&t.isTerrainDEM)Ae=1e4*this._elevation.exaggeration();else if(this._elevation){const Ve=this._elevation.getMinMaxForVisibleTiles();Ae=Ve?Ve.max:this._centerAltitude}else Ae=this._centerAltitude;const Ie=t.isTerrainDEM?-Ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,Te=this.projection.isReprojectedInTileSpace?r.co(this):1,ve=Ve=>{const nt=new r.ac(Ve.x+25e-6,Ve.y,Ve.z),Tt=new r.ac(Ve.x,Ve.y+25e-6,Ve.z),jt=Ve.toLngLat(),yt=nt.toLngLat(),Lt=Tt.toLngLat(),Yt=this.locationCoordinate(jt),tn=this.locationCoordinate(yt),Xt=this.locationCoordinate(Lt),rn=Math.hypot(tn.x-Yt.x,tn.y-Yt.y),fn=Math.hypot(Xt.x-Yt.x,Xt.y-Yt.y);return Math.sqrt(rn*fn)*Te/25e-6},Pe=Ve=>{const _t=Ae,nt=Ie;return{aabb:r.cr(this,z,0,0,0,Ve,nt,_t,this.projection),zoom:0,x:0,y:0,minZ:nt,maxZ:_t,wrap:Ve,fullyVisible:!1}},Me=[];let We=[];const Qe=s,ft=t.reparseOverscaled?h:s,pt=(Y-this._centerAltitude)*G,Et=Ve=>{if(!this._elevation||!Ve.tileID||!b)return;const _t=this._elevation.getMinMaxForTile(Ve.tileID),nt=Ve.aabb;_t?(nt.min[2]=_t.min,nt.max[2]=_t.max,nt.center[2]=(nt.min[2]+nt.max[2])/2):(Ve.shouldSplit=st(Ve),Ve.shouldSplit||(nt.min[2]=nt.max[2]=nt.center[2]=this._centerAltitude))},Ke=(Ve,_t)=>{if(.707*_t<Ve)return 1;const nt=_t/Ve;return nt/(1.4144271570014144+(Math.pow(1.1,nt-1.4144271570014144+1)-1)/(1.1-1)-1)},st=Ve=>{if(Ve.zoom<_e)return!0;if(Ve.zoom===Qe)return!1;if(Ve.shouldSplit!=null)return Ve.shouldSplit;const _t=Ve.aabb.distanceX(J),nt=Ve.aabb.distanceY(J);let Tt=pt,jt=1;if(N){Tt=Ve.aabb.distanceZ(J);const fn=Math.pow(2,Ve.zoom),_n=r.aY((Ve.y+1)/fn),Pn=r.aY(Ve.y/fn),Wn=Math.min(Math.max(I,_n),Pn),vi=r.cO(Wn)/r.cO(I);if(jt=Wn===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,vi/this._mercatorScaleRatio),this.zoom<=r.cL&&Ve.zoom===Qe-1&&vi>=.9)return!0}else if(v&&(Tt=Ve.aabb.distanceZ(J)*G),this.projection.isReprojectedInTileSpace&&h<=5){const fn=Math.pow(2,Ve.zoom),_n=ve(new r.ac((Ve.x+.5)/fn,(Ve.y+.5)/fn));jt=_n>.85?1:_n}if(!b){const fn=Math.sqrt(_t*_t+nt*nt+Tt*Tt);let _n=(1<<Qe-Ve.zoom)*pe*jt;return _n*=Ke(Math.max(Tt,pt),fn),fn<_n}let yt=Number.MAX_VALUE,Lt=0;const Yt=Ve.aabb.getCorners(),tn=[];for(const fn of Yt){r.at(tn,fn,J),N||(v?tn[2]*=G:tn[2]=pt);const _n=r.bG(tn,this._camera.forward());_n<yt&&(yt=_n,Lt=Math.abs(tn[2]))}let Xt=(1<<Qe-Ve.zoom)*pe*jt;if(Xt*=Ke(Math.max(Lt,pt),yt),yt<Xt)return!0;const rn=Ve.aabb.closestPoint(L);return rn[0]===L[0]&&rn[1]===L[1]};if(this.renderWorldCopies)for(let Ve=1;Ve<=3;Ve++)Me.push(Pe(-Ve)),Me.push(Pe(Ve));for(Me.push(Pe(0));Me.length>0;){const Ve=Me.pop(),_t=Ve.x,nt=Ve.y;let Tt=Ve.fullyVisible;const jt=()=>this.projection.name==="globe"&&(Ve.y===0||Ve.y===(1<<Ve.zoom)-1);if(!Tt){let yt=re?Ve.aabb.intersects(q):Ve.aabb.intersectsFlat(q);if(yt===0&&jt()){const Lt=new r.cp(Ve.zoom,_t,nt);yt=r.cq(this,z,Lt,!0).intersects(q)}if(yt===0)continue;Tt=yt===2}if(Ve.zoom!==Qe&&st(Ve))for(let yt=0;yt<4;yt++){const Lt=(_t<<1)+yt%2,Yt=(nt<<1)+(yt>>1),tn={aabb:b?Ve.aabb.quadrant(yt):r.cr(this,z,Ve.zoom+1,Lt,Yt,Ve.wrap,Ve.minZ,Ve.maxZ,this.projection),zoom:Ve.zoom+1,x:Lt,y:Yt,wrap:Ve.wrap,fullyVisible:Tt,tileID:void 0,shouldSplit:void 0,minZ:Ve.minZ,maxZ:Ve.maxZ};v&&!N&&(tn.tileID=new r.aM(Ve.zoom+1===Qe?ft:Ve.zoom+1,Ve.wrap,Ve.zoom+1,Lt,Yt),Et(tn)),Me.push(tn)}else{const yt=Ve.zoom===Qe?ft:Ve.zoom;if(t.minzoom&&t.minzoom>yt)continue;let Lt=0;if(!Tt){let rn=re?Ve.aabb.intersectsPrecise(q):Ve.aabb.intersectsPreciseFlat(q);if(rn===0&&jt()){const fn=new r.cp(Ve.zoom,_t,nt);rn=r.cq(this,z,fn,!0).intersectsPrecise(q)}if(rn===0)continue;if(t.calculateQuadrantVisibility)if(q.containsPoint(Ve.aabb.center))Lt=15;else for(let fn=0;fn<4;fn++)Ve.aabb.quadrant(fn).intersects(q)!==0&&(Lt|=1<<fn)}const Yt=L[0]-(.5+_t+(Ve.wrap<<Ve.zoom))*(1<<s-Ve.zoom),tn=L[1]-.5-nt,Xt=Ve.tileID?Ve.tileID:new r.aM(yt,Ve.wrap,Ve.zoom,_t,nt);t.calculateQuadrantVisibility&&(Xt.visibleQuadrants=Lt),We.push({tileID:Xt,distanceSq:Yt*Yt+tn*tn})}}if(this.fogCullDistSq){const Ve=this.fogCullDistSq,_t=this.horizonLineFromTop();We=We.filter(nt=>{const Tt=[0,0,0,1],jt=[r.aj,r.aj,0,1],yt=this.calculateFogTileMatrix(nt.tileID.toUnwrapped());r.aA(Tt,Tt,yt),r.aA(jt,jt,yt);const Lt=r.cs([],Tt,jt),Yt=r.ct([],Tt,jt),tn=r.cM(Lt,Yt);if(tn===0)return!0;let Xt=!1;const rn=this._elevation;if(rn&&tn>Ve&&_t!==0){const fn=this.calculateProjMatrix(nt.tileID.toUnwrapped());let _n;t.isTerrainDEM||(_n=rn.getMinMaxForTile(nt.tileID)),_n||(_n={min:Ie,max:Ae});const Pn=r.cu(this.rotation),Wn=[Pn[0]*r.aj,Pn[1]*r.aj,_n.max];r.ad(Wn,Wn,fn),Xt=(1-Wn[1])*this.height*.5<_t}return tn<Ve||Xt})}return We.sort((Ve,_t)=>Ve.distanceSq-_t.distanceSq).map(Ve=>Ve.tileID)}resize(t,s){this.width=t,this.height=s,this.pixelsToGLUnits=[2/t,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const s=r.ay(t.lat,-85.051129,r.cv),h=this.projection.project(t.lng,s);return new r.P(h.x*this.worldSize,h.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.c6(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,s){let h,g;const v=this.centerPoint;if(this.projection.name==="globe"){const E=this.worldSize;h=(s.x-v.x)/E,g=(s.y-v.y)/E}else{const E=this.pointCoordinate(s),I=this.pointCoordinate(v);h=E.x-I.x,g=E.y-I.y}const b=this.locationCoordinate(t);this.setLocation(new r.ac(b.x-h,b.y-g))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t,s){return this.projection.locationPoint(this,t,s)}locationPoint3D(t,s){return this.projection.locationPoint(this,t,s,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t,s){return this.coordinateLocation(this.pointCoordinate3D(t,s))}locationCoordinate(t,s){const h=s?r.c6(s,t.lat):void 0,g=this.projection.project(t.lng,t.lat);return new r.ac(g.x,g.y,h)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,s){const h=s??this._centerAltitude,g=[t.x,t.y,0,1],v=[t.x,t.y,1,1];r.aA(g,g,this.pixelMatrixInverse),r.aA(v,v,this.pixelMatrixInverse);const b=v[3];r.cw(g,g,1/g[3]),r.cw(v,v,1/b);const E=g[2],I=v[2];return{p0:g,p1:v,t:E===I?0:(h-E)/(I-E)}}screenPointToMercatorRay(t){const s=[t.x,t.y,0,1],h=[t.x,t.y,1,1];return r.aA(s,s,this.pixelMatrixInverse),r.aA(h,h,this.pixelMatrixInverse),r.cw(s,s,1/s[3]),r.cw(h,h,1/h[3]),s[2]=r.c6(s[2],this._center.lat)*this.worldSize,h[2]=r.c6(h[2],this._center.lat)*this.worldSize,r.cw(s,s,1/this.worldSize),r.cw(h,h,1/this.worldSize),new r.av([s[0],s[1],s[2]],r.au([],r.at([],h,s)))}rayIntersectionCoordinate(t){const{p0:s,p1:h,t:g}=t,v=r.c6(s[2],this._center.lat),b=r.c6(h[2],this._center.lat);return new r.ac(r.ai(s[0],h[0],g)/this.worldSize,r.ai(s[1],h[1],g)/this.worldSize,r.ai(v,b,g))}pointCoordinate(t,s=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,s)}pointCoordinate3D(t,s){if(!this.elevation)return this.pointCoordinate(t,s);let h=this.projection.pointCoordinate3D(this,t.x,t.y);if(h)return new r.ac(h[0],h[1],h[2]);let g=0,v=this.horizonLineFromTop();if(t.y>v)return this.pointCoordinate(t,s);const b=.02*v,E=t.clone();for(let I=0;I<10&&v-g>b;I++){E.y=r.ai(g,v,.66);const z=this.projection.pointCoordinate3D(this,E.x,E.y);z?(v=E.y,h=z):g=E.y}return h?new r.ac(h[0],h[1],h[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=r.cx)return!this.isPointAboveHorizon(t);const s=this.pointCoordinate(t);return s.y>=0&&s.y<=1}_coordinatePoint(t,s){const h=s&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,g=[t.x*this.worldSize,t.y*this.worldSize,h+t.toAltitude(),1];return r.aA(g,g,this.pixelMatrix),g[3]>0?new r.P(g[0]/g[3],g[1]/g[3]):new r.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:s}=this._edgeInsets,h=this.height-this._edgeInsets.bottom,g=this.width-this._edgeInsets.right,v=this.pointLocation3D(new r.P(s,t)),b=this.pointLocation3D(new r.P(g,t)),E=this.pointLocation3D(new r.P(g,h)),I=this.pointLocation3D(new r.P(s,h));let z=Math.min(v.lng,b.lng,E.lng,I.lng),L=Math.max(v.lng,b.lng,E.lng,I.lng),N=Math.min(v.lat,b.lat,E.lat,I.lat),F=Math.max(v.lat,b.lat,E.lat,I.lat);const q=Math.pow(2,-this.zoom)/16*270,X=this.projection.name==="globe"?1:4,G=(Y,J,re,pe,_e)=>{const Ae=(Y+re)/2,Ie=(J+pe)/2,Te=new r.P(Ae,Ie),{lng:ve,lat:Pe}=this.pointLocation3D(Te),Me=Math.max(0,z-ve,N-Pe,ve-L,Pe-F);z=Math.min(z,ve),L=Math.max(L,ve),N=Math.min(N,Pe),F=Math.max(F,Pe),(_e<X||Me>q)&&(G(Y,J,Ae,Ie,_e+1),G(Ae,Ie,re,pe,_e+1))};if(G(s,t,g,t,1),G(g,t,g,h,1),G(g,h,s,h,1),G(s,h,s,t,1),this.projection.name==="globe"){const[Y,J]=r.cy(this);Y?(F=90,L=180,z=-180):J&&(N=-90,L=180,z=-180)}return new r.aG(new r.cd(z,N),new r.cd(L,F))}_getBoundsRectangular(t,s){const{top:h,left:g}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,E=new r.P(g,h),I=new r.P(b,h),z=new r.P(b,v),L=new r.P(g,v);let N=this.pointCoordinate(E,t),F=this.pointCoordinate(I,t);const q=this.pointCoordinate(z,s),X=this.pointCoordinate(L,s),G=(Y,J)=>(J.y-Y.y)/(J.x-Y.x);return N.y>1&&F.y>=0?N=new r.ac((1-X.y)/G(X,N)+X.x,1):N.y<0&&F.y<=1&&(N=new r.ac(-X.y/G(X,N)+X.x,0)),F.y>1&&N.y>=0?F=new r.ac((1-q.y)/G(q,F)+q.x,1):F.y<0&&N.y<=1&&(F=new r.ac(-q.y/G(q,F)+q.x,0)),new r.aG().extend(this.coordinateLocation(N)).extend(this.coordinateLocation(F)).extend(this.coordinateLocation(X)).extend(this.coordinateLocation(q))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const s=t.visibleDemTiles.reduce((h,g)=>{if(g.dem){const v=g.dem.tree;h.min=Math.min(h.min,v.minimums[0]),h.max=Math.max(h.max,v.maximums[0])}return h},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(s.min*t.exaggeration(),s.max*t.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const s=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,h=this.height/2-s*(1-this._horizonShift);return t?Math.max(0,h):h}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-85.051129,this.maxLat=r.cv,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.aD(this.minLng)*this.tileSize,this.worldMaxX=r.aD(this.maxLng)*this.tileSize,this.worldMinY=r.aH(this.maxLat)*this.tileSize,this.worldMaxY=r.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,s){return this.projection.createTileMatrix(this,s,t)}calculateDistanceTileData(t){const s=t.key,h=this._distanceTileDataCache;if(h[s])return h[s];const g=t.canonical,v=1/this.height,b=this.cameraWorldSize,E=b/this.zoomScale(g.z),I=(g.x+Math.pow(2,g.z)*t.wrap)*E,z=g.y*E,L=this.point;L.x*=b/this.worldSize,L.y*=b/this.worldSize;const N=this.angle,F=Math.sin(-N),q=-Math.cos(-N);return h[s]={bearing:[F,q],center:[(L.x-I)*v,(L.y-z)*v],scale:E/r.aj*v},h[s]}calculateFogTileMatrix(t){const s=t.key,h=this._fogTileMatrixCache;if(h[s])return h[s];const g=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return r.az(g,this.worldToFogMatrix,g),h[s]=new Float32Array(g),h[s]}calculateProjMatrix(t,s=!1,h=!1){const g=t.key;let v;if(v=h?this._expandedProjMatrixCache:s?this._alignedProjMatrixCache:this._projMatrixCache,v[g])return v[g];const b=this.calculatePosMatrix(t,this.worldSize);let E;return E=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.expandedFarZProjMatrix:s?this.alignedProjMatrix:this.projMatrix,r.az(b,E,b),v[g]=new Float32Array(b),v[g]}calculatePixelsToTileUnitsMatrix(t){const s=t.tileID.key,h=this._pixelsToTileUnitsCache;if(h[s])return h[s];const g=r.cz(t,this);return h[s]=g,h[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const t=1/this.worldSize,s=r.bn([],[t,t,t]);return r.az(s,s,this.globeMatrix),s}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const t=this._elevation;this._updateCameraState();const s=r.c6(1,this._center.lat)*this.worldSize,h=this._computeCameraPosition(s),g=this._camera.forward(),v=r.c6(1,this._center.lat);h[2]/=v,g[2]/=v,r.au(g,g);const b=t.raycast(h,g,t.exaggeration());if(b){const E=r.bE([],h,g,b),I=new r.ac(E[0],E[1],r.c6(E[2],r.aY(E[1]))),z=(I.z+r.ae([I.x-h[0],I.y-h[1],I.z-h[2]*v]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=I.toAltitude(),this._center=this.coordinateLocation(I),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const s=this._elevation,h=r.c6(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(h),v=s.getAtPointOrZero(new r.ac(...g)),b=this.pixelsPerMeter/this.worldSize*v,E=this._minimumHeightOverTerrain(),I=g[2]-b;if(I<=E)if(I<0||t){const z=this.locationCoordinate(this._center,this._centerAltitude),L=[g[0],g[1],z.z-g[2]],N=r.ae(L);L[2]-=(E-I)/this._pixelsPerMercatorPixel;const F=r.ae(L);if(F===0)return;r.bY(L,L,N/F*this._pixelsPerMercatorPixel),this._camera.position=[g[0],g[1],z.z*this._pixelsPerMercatorPixel-L[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const F=this.center;return F.lat=r.ay(F.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(F.lng=r.ay(F.lng,this.minLng,this.maxLng)),this.center=F,void(this._constraining=!1)}const s=this._unmodified,{x:h,y:g}=this.point;let v=0,b=h,E=g;const I=this.width/2,z=this.height/2,L=this.worldMinY*this.scale,N=this.worldMaxY*this.scale;if(g-z<L&&(E=L+z),g+z>N&&(E=N-z),N-L<this.height&&(v=Math.max(v,this.height/(N-L)),E=(N+L)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const F=this.worldMinX*this.scale,q=this.worldMaxX*this.scale,X=this.worldSize/2-(F+q)/2;b=(h+X+this.worldSize)%this.worldSize-X,b-I<F&&(b=F+I),b+I>q&&(b=q-I),q-F<this.width&&(v=Math.max(v,this.width/(q-F)),b=(q+F)/2)}b===h&&E===g||this._allowWorldUnderZoom||(this.center=this.unproject(new r.P(b,E))),v&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(v)),this._constrainCamera(),this._unmodified=s,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,s=this.projection.name==="globe",h=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.c6(1,this.center.lat)/r.c6(1,r.cP));const g=r.cA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,g),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const v=this.projection.zAxisUnit==="meters"?h:1,b=this._camera.getWorldToCamera(this.worldSize,v);let E;const I=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(I[8]=2*-t.x/this.width,I[9]=2*t.y/this.height,this.isOrthographic){let Pe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Me=Pe*this.aspect,We=-Me,Qe=-Pe;Me-=t.x,We-=t.x,Pe+=t.y,Qe+=t.y,E=this._camera.getCameraToClipOrthographic(We,Me,Qe,Pe,this._nearZ,this._farZ),((ft,pt,Et,Ke)=>{for(let st=0;st<16;st++)ft[st]=r.ai(pt[st],Et[st],Ke)})(E,E,I,r.cN(this.pitch>=vs?1:this.pitch/vs))}else E=I;const z=r.cB([],I,b);let L=r.cB([],E,b);if(this.projection.isReprojectedInTileSpace){const Pe=this.locationCoordinate(this.center),Me=r.bx([]);r.bo(Me,Me,[Pe.x*this.worldSize,Pe.y*this.worldSize,0]),r.az(Me,Me,r.cC(this)),r.bo(Me,Me,[-Pe.x*this.worldSize,-Pe.y*this.worldSize,0]),r.az(L,L,Me),r.az(z,z,Me),this.inverseAdjustmentMatrix=r.cD(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=r.cE([],L,[this.worldSize,this.worldSize,this.worldSize/v,1]),this.projMatrix=L,this.invProjMatrix=r.bi(new Float64Array(16),this.projMatrix),s){const Pe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Pe[8]=2*-t.x/this.width,Pe[9]=2*t.y/this.height,this.expandedFarZProjMatrix=r.cB([],Pe,b)}else this.expandedFarZProjMatrix=this.projMatrix;const N=r.bi([],E);this.frustumCorners=r.cF.fromInvProjectionMatrix(N,this.horizonLineFromTop(),this.height),this.cameraFrustum=r.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!s);const F=new Float32Array(16);r.bx(F),r.cE(F,F,[1,-1,1]),r.cG(F,F,this._pitch),r.by(F,F,this.angle);const q=r.c4(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=r.bw(q);const X=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;q[8]=2*-t.x/this.width,q[9]=2*(t.y+X)/this.height,this.skyboxMatrix=r.az(F,q,F);const G=this.point,Y=G.x,J=G.y,re=this.width%2/2,pe=this.height%2/2,_e=Math.cos(this.angle),Ae=Math.sin(this.angle),Ie=Y-Math.round(Y)+_e*re+Ae*pe,Te=J-Math.round(J)+_e*pe+Ae*re,ve=new Float64Array(L);if(r.bo(ve,ve,[Ie>.5?Ie-1:Ie,Te>.5?Te-1:Te,0]),this.alignedProjMatrix=ve,L=r.bz(),r.cE(L,L,[this.width/2,-this.height/2,1]),r.bo(L,L,[1,-1,0]),this.labelPlaneMatrix=L,L=r.bz(),r.cE(L,L,[1,-1,1]),r.bo(L,L,[-1,-1,0]),r.cE(L,L,[2/this.width,2/this.height,1]),this.glCoordMatrix=L,this.pixelMatrix=r.az(new Float64Array(16),this.labelPlaneMatrix,z),this._calcFogMatrices(),this._distanceTileDataCache={},L=r.bi(new Float64Array(16),this.pixelMatrix),!L)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=L,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.cH(this);const Pe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.ad(Pe,Pe,b),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=L;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,s=this.cameraPixelsPerMeter,h=this._camera.position,g=1/this.height/this._pixelsPerMercatorPixel,v=[t,t,s];r.bY(v,v,g),r.bY(h,h,-1),r.cI(h,h,v);const b=r.bz();r.bo(b,b,h),r.cE(b,b,v),this.mercatorFogMatrix=b,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,s,g)}_computeCameraPosition(t){const s=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,h=this._camera.forward(),g=this.point,v=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*s-t/this.worldSize*this._centerAltitude;return[g.x/this.worldSize-h[0]*v,g.y/this.worldSize-h[1]*v,t/this.worldSize*this._centerAltitude-h[2]*v]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const s=this._maxCameraBoundsDistance()*Math.cos(this._pitch),h=this._camera.position[2],g=t[2];let v=1;this.projection.wrap&&(this.center=this.center.wrap()),g>0&&(v=Math.min((s-h)/g,1)),this._camera.position=r.bE([],this._camera.position,t,v),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,s=this._camera.forward(),{pitch:h,bearing:g}=this._camera.getPitchBearing(),v=r.c6(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,b=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.al(this._maxPitch)),E=Math.max((t[2]-v)/Math.cos(h),b),I=this._zoomFromMercatorZ(E);r.bE(t,t,s,E),this._pitch=r.ay(h,r.al(this.minPitch),r.al(this.maxPitch)),this.angle=r.bX(g,-Math.PI,Math.PI),this._setZoom(r.ay(I,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.ac(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,t)*this.tileSize))}zoomFromMercatorZAdjusted(t){let s=0,h=r.cx,g=0,v=1/0;for(;h-s>1e-6&&h>s;){const b=s+.5*(h-s),E=this.tileSize*Math.pow(2,b),I=this.getCameraToCenterDistance(this.projection,b,E),z=this.scaleZoom(I/(Math.max(0,t)*this.tileSize)),L=Math.abs(b-z);L<v&&(v=L,g=b),b<z?s=b:h=b}return g}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,s){const h=Math.min(t.x,s.x),g=Math.max(t.x,s.x),v=Math.min(t.y,s.y),b=Math.max(t.y,s.y);if(v<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const E=[new r.P(h,v),new r.P(g,b),new r.P(h,b),new r.P(g,v)],I=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const L of E){const N=this.pointRayIntersection(L);if(N.t<0)return!0;const F=this.rayIntersectionCoordinate(N);if(F.x<I||F.y<0||F.x>z||F.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.cJ(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.P(0,0),new r.P(this.width,this.height))}zoomDeltaToMovement(t,s){const h=r.ae(r.at([],this._camera.position,t)),g=this._zoomFromMercatorZ(h)+s;return h-this._mercatorZfromZoom(g)}getCameraPoint(){if(this.projection.name==="globe"){const t=function([s,h,g],v){const b=[s,h,g,1];r.aA(b,b,v);const E=b[3]=Math.max(b[3],1e-6);return b[0]/=E,b[1]/=E,b[2]/=E,b}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.P(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,t))}}getCameraToCenterDistance(t,s=this.zoom,h=this.worldSize){const g=r.cA(t,s,this.width,this.height,1024),v=t.pixelSpaceConversion(this.center.lat,h,g);let b=.5/Math.tan(.5*this._fov)*this.height*v;return this.isOrthographic&&(b=r.ai(1,b,r.cN(this.pitch>=vs?1:this.pitch/vs))),b}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.az(t,t,this.globeMatrix),t}getFrustum(t){return r.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,this.projection.zAxisUnit==="meters")}}const $o=(u,t)=>{if(t>0&&u.terrain&&r.w("Cutoff is currently disabled on terrain"),t<=0||u.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const s=u.transform,h=Math.max(Math.abs(s._zoom-(u.minCutoffZoom-1)),1),g=s.isLODDisabled(!1)?r.af(60,45,s.pitch):r.af(30,15,s.pitch),v=s._farZ-s._nearZ,b=t*s.height,E=((1-(I=g))*s.cameraToCenterDistance+I*(s._farZ+b))*h;var I;return{shouldRenderCutoff:g<1,uniformValues:{u_cutoff_params:[s._nearZ,s._farZ,(E-s._nearZ)/v,(E-b-s._nearZ)/v]}}},xs={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Dh{constructor(t,s){this.aabb=t,this.lastCascade=s}}class Md{add(t,s){const h=this.receivers[t.key];h!==void 0?(h.aabb.min[0]=Math.min(h.aabb.min[0],s.min[0]),h.aabb.min[1]=Math.min(h.aabb.min[1],s.min[1]),h.aabb.min[2]=Math.min(h.aabb.min[2],s.min[2]),h.aabb.max[0]=Math.max(h.aabb.max[0],s.max[0]),h.aabb.max[1]=Math.max(h.aabb.max[1],s.max[1]),h.aabb.max[2]=Math.max(h.aabb.max[2],s.max[2])):this.receivers[t.key]=new Dh(s,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,s,h){const g=r.cW.fromPoints(t.points);let v=0;for(const b in this.receivers){const E=this.receivers[b];if(!E||!g.intersectsAabb(E.aabb))continue;E.aabb.min=g.closestPoint(E.aabb.min),E.aabb.max=g.closestPoint(E.aabb.max);const I=E.aabb.getCorners();for(let z=0;z<h.length;z++){let L=!0;for(const N of I){const F=[N[0]*s,N[1]*s,N[2]];if(r.ad(F,F,h[z].matrix),F[0]<-1||F[0]>1||F[1]<-1||F[1]>1){L=!1;break}}if(E.lastCascade=z,v=Math.max(v,z),L)break}}return v+1}}class qm{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Md,this._depthMode=new sn(t.context.gl.LEQUAL,sn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,t.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),t.tp.registerParameter(xs,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),t.tp.registerParameter(xs,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),t.tp.registerParameter(xs,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),t.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,s){const h=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!s||!s.properties)return;const g=s.properties.get("shadow-intensity");if(!s.shadowsEnabled()||g<=0||(this._shadowLayerCount=h.style.order.reduce((X,G)=>{const Y=h.style._mergedLayers[G];return X+(Y.hasShadowPass()&&!Y.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const v=h.context,b=xs.shadowMapResolution,E=xs.shadowMapResolution;if(this._cascades.length===0||xs.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let X=0;X<xs.cascadeCount;++X){const G=h._shadowMapDebug,Y=v.gl,J=v.createFramebuffer(b,E,G,"texture"),re=new r.T(v,{width:b,height:E,data:null},Y.DEPTH_COMPONENT16);if(J.depthAttachment.set(re.texture),G){const pe=new r.T(v,{width:b,height:E,data:null},Y.RGBA8);J.colorAttachment.set(pe.texture)}this._cascades.push({framebuffer:J,texture:re,matrix:[],far:0,boundingSphereRadius:0,frustum:new r.cn,scale:0})}}this.shadowDirection=lc(s);let I=0;if(t.elevation){const X=t.elevation,G=[1e4,-1e4];X.visibleDemTiles.filter(Y=>Y.dem).forEach(Y=>{const J=Y.dem.tree;G[0]=Math.min(G[0],J.minimums[0]),G[1]=Math.max(G[1],J.maximums[0])}),G[0]!==1e4&&(I=(G[1]-G[0])*X.exaggeration())}const z=1.5*t.cameraToCenterDistance,L=3*z,N=new Float64Array(16);for(let X=0;X<this._cascades.length;++X){const G=this._cascades[X];let Y=t.height/50,J=1;xs.cascadeCount===1?J=L:X===0?J=z:(Y=z,J=L);const[re,pe]=Gc(t,this.shadowDirection,Y,J,xs.shadowMapResolution,I);G.scale=t.scale,G.matrix=re,G.boundingSphereRadius=pe,r.bi(N,G.matrix),G.frustum=r.cn.fromInvProjectionMatrix(N,1,0,!0),G.far=J}const F=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[F].far,this._cascades[F].far],this._uniformValues.u_shadow_intensity=g,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/xs.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=xs.shadowMapResolution,this._uniformValues.u_shadowmap_0=go.ShadowMap0,this._uniformValues.u_shadowmap_1=go.ShadowMap0+1,this._groundShadowTiles=h.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const q=h.transform.elevation;for(const X of this._groundShadowTiles){let G={min:0,max:0};if(q){const Y=q.getMinMaxForTile(X);Y&&(G=Y)}this.addShadowReceiver(X.toUnwrapped(),G.min,G.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(t){this._enabled=t}drawShadowPass(t,s){if(!this.enabled)return;const h=this.painter,g=h.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(h.transform.getFrustum(0),h.transform.worldSize,this._cascades),g.viewport.set([0,0,xs.shadowMapResolution,xs.shadowMapResolution]);for(let v=0;v<this._numCascadesToRender;++v){h.currentShadowCascade=v,g.bindFramebuffer.set(this._cascades[v].framebuffer.framebuffer),g.clear({color:r.am.white,depth:1});for(const b of t.order){const E=t._mergedLayers[b];if(!E.hasShadowPass()||E.isHidden(h.transform.zoom))continue;const I=t.getLayerSourceCache(E),z=I?s[I.id]:void 0;(E.type==="model"||z&&z.length)&&h.renderLayer(h,I,E,z)}}h.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const t=this.painter,s=t.style,h=t.context,g=h.gl,v=s.directionalLight,b=s.ambientLight;if(!v||!b)return;const E=[],I=$o(t,t.longestCutoffRange);I.shouldRenderCutoff&&E.push("RENDER_CUTOFF"),E.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&E.push("NORMAL_OFFSET");const z=Sl(s,v,b),L=new sn(g.LEQUAL,sn.ReadOnly,t.depthRangeFor3D),N=new In({func:g.EQUAL,mask:255},0,255,g.KEEP,g.KEEP,g.KEEP);for(const F of this._groundShadowTiles){const q=F.toUnwrapped(),X=t.isTileAffectedByFog(F),G=t.getOrCreateProgram("groundShadow",{defines:E,overrideFog:X});this.setupShadows(q,G),t.uploadCommonUniforms(h,G,q,null,I);const Y={u_matrix:t.transform.calculateProjMatrix(q),u_ground_shadow_factor:z};G.draw(t,g.TRIANGLES,L,N,ii.multiply,Sn.disabled,Y,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,null,t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?ii.unblended:ii.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const s=this.painter.transform,h=s.calculatePosMatrix(t,s.worldSize);return r.az(h,this._cascades[this.painter.currentShadowCascade].matrix,h),Float32Array.from(h)}calculateShadowPassMatrixFromMatrix(t){return r.az(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,s,h,g=0){if(!this.enabled)return;const v=this.painter.transform,b=this.painter.context,E=b.gl,I=this._uniformValues,z=new Float64Array(16),L=v.calculatePosMatrix(t,v.worldSize);for(let N=0;N<this._cascades.length;N++)r.az(z,this._cascades[N].matrix,L),I[N===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(z),b.activeTexture.set(E.TEXTURE0+go.ShadowMap0+N),this._cascades[N].texture.bindExtraParam(E.LINEAR,E.LINEAR,E.CLAMP_TO_EDGE,E.CLAMP_TO_EDGE,E.GREATER);if(this.useNormalOffset=!!h,this.useNormalOffset){const N=r.cU(t.canonical),F=2/v.tileSize*r.aj/xs.shadowMapResolution,q=F*this._cascades[0].boundingSphereRadius,X=F*this._cascades[this._cascades.length-1].boundingSphereRadius,G=(h==="vector-tile"?1:3)/Math.pow(2,g-t.canonical.z-(1-v.zoom+Math.floor(v.zoom)));I.u_shadow_normal_offset=[N,q*G,X*G],I.u_shadow_bias=[6e-5,.0012,.012]}else I.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(b,I)}setupShadowsFromMatrix(t,s,h=!1){if(!this.enabled)return;const g=this.painter.context,v=g.gl,b=this._uniformValues,E=new Float64Array(16);for(let I=0;I<xs.cascadeCount;I++)r.az(E,this._cascades[I].matrix,t),b[I===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(E),g.activeTexture.set(v.TEXTURE0+go.ShadowMap0+I),this._cascades[I].texture.bindExtraParam(v.LINEAR,v.LINEAR,v.CLAMP_TO_EDGE,v.CLAMP_TO_EDGE,v.GREATER);if(this.useNormalOffset=h,h){const I=xs.normalOffset;b.u_shadow_normal_offset=[1,I,I],b.u_shadow_bias=[6e-5,.0012,.012]}else b.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(g,b)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,s,h,g){if(g[2]>=0)return{};const v=function(I,z,L){const N=L/(1<<I.canonical.z);return new r.cW([I.canonical.x*N+I.wrap*L,I.canonical.y*N+I.wrap*L,0],[(I.canonical.x+1)*N+I.wrap*L,(I.canonical.y+1)*N+I.wrap*L,z])}(t,s,h).getCorners(),b=s/-g[2];g[0]<0?(r.cV(v[0],v[0],[g[0]*b,0,0]),r.cV(v[3],v[3],[g[0]*b,0,0])):g[0]>0&&(r.cV(v[1],v[1],[g[0]*b,0,0]),r.cV(v[2],v[2],[g[0]*b,0,0])),g[1]<0?(r.cV(v[0],v[0],[0,g[1]*b,0]),r.cV(v[1],v[1],[0,g[1]*b,0])):g[1]>0&&(r.cV(v[2],v[2],[0,g[1]*b,0]),r.cV(v[3],v[3],[0,g[1]*b,0]));const E={};return E.vertices=v,E.planes=[Tl(v[1],v[0],v[4]),Tl(v[2],v[1],v[5]),Tl(v[3],v[2],v[6]),Tl(v[0],v[3],v[7])],E}addShadowReceiver(t,s,h){this._receivers.add(t,r.cW.fromTileIdAndHeight(t,s,h))}getMaxCascadeForTile(t){const s=this._receivers.get(t);return s&&s.lastCascade?s.lastCascade:0}}function Tl(u,t,s){const h=r.at([],s,t),g=r.at([],u,t),v=r.bF([],h,g),b=r.ae(v);return b===0?[0,0,1,0]:(r.bY(v,v,1/b),[v[0],v[1],v[2],-r.bG(v,t)])}function lc(u){const t=u.properties.get("direction"),s=r.cR(t.x,t.y,t.z);s[2]=r.ay(s[2],0,75);const h=r.cT([s[0],s[1],s[2]]);return r.cS(h.x,h.y,h.z)}function Sl(u,t,s){const h=t.properties.get("color-use-theme")==="none",g=t.properties.get("color"),v=t.properties.get("intensity"),b=t.properties.get("direction"),E=[b.x,b.y,b.z],I=s.properties.get("color-use-theme")==="none",z=s.properties.get("color"),L=s.properties.get("intensity"),N=Math.max(r.bG([0,0,1],E),0),F=[0,0,0];r.bY(F,z.toPremultipliedRenderColor(I?null:u.getLut(t.scope)).toArray01Linear().slice(0,3),L);const q=[0,0,0];return r.bY(q,g.toPremultipliedRenderColor(h?null:u.getLut(s.scope)).toArray01Linear().slice(0,3),N*v),r.cY([F[0]>0?F[0]/(F[0]+q[0]):0,F[1]>0?F[1]/(F[1]+q[1]):0,F[2]>0?F[2]/(F[2]+q[2]):0])}function Gc(u,t,s,h,g,v){const b=u.zoom,E=u.scale,I=u.worldSize,z=1/I,L=u.aspect,N=Math.sqrt(1+L*L)*Math.tan(.5*u.fovX),F=N*N,q=h-s,X=h+s;let G,Y;F>q/X?(G=h,Y=h*N):(G=.5*X*(1+F),Y=.5*Math.sqrt(q*q+2*(h*h+s*s)*F+X*X*F*F));const J=u.projection.pixelsPerMeter(u.center.lat,I),re=u._camera.getCameraToWorldMercator(),pe=[0,0,-G*z];r.ad(pe,pe,re);let _e=Y*z;const Ae=u._edgeInsets;if(!(Ae.left===0&&Ae.top===0&&Ae.right===0&&Ae.bottom===0||Ae.left===Ae.right&&Ae.top===Ae.bottom)){const Tt=u._camera.getWorldToCamera(u.worldSize,u.projection.zAxisUnit==="meters"?J:1),jt=u._camera.getCameraToClipPerspective(u._fov,u.width/u.height,s,h);jt[8]=2*-u.centerOffset.x/u.width,jt[9]=2*u.centerOffset.y/u.height;const yt=new Float64Array(16);r.cB(yt,jt,Tt);const Lt=new Float64Array(16);r.bi(Lt,yt);const Yt=r.cn.fromInvProjectionMatrix(Lt,I,b,!0);for(const tn of Yt.points){const Xt=((Ie=tn)[0]/=E,Ie[1]/=E,Ie[2]=r.c6(Ie[2],u._center.lat),Ie);_e=Math.max(_e,r.bZ(r.cX([],pe,Xt)))}}var Ie;_e*=g/(g-1);const Te=Math.acos(t[2]),ve=Math.atan2(-t[0],-t[1]),Pe=new ya;Pe.position=pe,Pe.setPitchBearing(Te,ve);const Me=Pe.getWorldToCamera(I,J),We=_e*I,Qe=Math.min(u._mercatorZfromZoom(17)*I*-2,-2*We),ft=Pe.getCameraToClipOrthographic(-We,We,-We,We,Qe,(We+v*J)/t[2]),pt=new Float64Array(16);r.az(pt,ft,Me);const Et=r.cS(Math.floor(1e6*pe[0])/1e6*I,Math.floor(1e6*pe[1])/1e6*I,0),Ke=.5*g,st=[0,0,0];r.ad(st,Et,pt),r.bY(st,st,Ke);const Ve=[Math.floor(st[0]),Math.floor(st[1]),Math.floor(st[2])],_t=[0,0,0];r.at(_t,st,Ve),r.bY(_t,_t,-1/Ke);const nt=new Float64Array(16);return r.bx(nt),r.bo(nt,nt,_t),r.az(pt,nt,pt),[pt,We]}class Mp extends r.E{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(t,s){return r.aS(this.requestManager.transformRequest(s,r.R.Model).url).then(h=>{if(!h)return;const g=r.aT(h),v=new r.aU(t,void 0,void 0,g);return v.computeBoundsAndApplyParent(),v}).catch(h=>{if(h&&h.status===404)return null;this.fire(new r.z(new Error(`Could not load model ${t} from ${s}: ${h.message}`)))})}load(t,s,h={forceReload:!1}){this.models[s]||(this.models[s]={});const g=Object.keys(t),v=[],b=[];for(const E of g){const I=t[E];this.hasURLBeenRequested(I)&&!h.forceReload||(this.modelByURL[I]={modelId:E,scope:s},v.push(this.loadModel(E,I)),b.push(E)),this.models[s][E]||(this.models[s][E]={model:null,numReferences:1})}this.numModelsLoading[s]=(this.numModelsLoading[s]||0)+b.length,Promise.allSettled(v).then(E=>{for(let I=0;I<E.length;I++){const{status:z}=E[I];if(z==="rejected")continue;const{value:L}=E[I];this.models[s][b[I]]||(this.models[s][b[I]]={model:null,numReferences:1}),this.models[s][b[I]].model=L}this.numModelsLoading[s]-=b.length,this.fire(new r.A("data",{dataType:"style"}))}).catch(E=>{this.fire(new r.z(new Error(`Could not load models: ${E.message}`)))})}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,s,h={exactIdMatch:!1}){return!!(h.exactIdMatch?this.getModel(t,s):this.getModelByURL(this.modelUris[s][t]))}getModel(t,s){return this.models[s]||(this.models[s]={}),this.models[s][t]?this.models[s][t].model:void 0}getModelByURL(t){if(!t)return null;const s=this.modelByURL[t];return s?this.models[s.scope][s.modelId].model:null}hasModelBeenAdded(t,s){return this.models[s]&&this.models[s][t]!==void 0}getModelURIs(t){return this.modelUris[t]||{}}addModel(t,s,h){this.models[h]||(this.models[h]={}),this.modelUris[h]||(this.modelUris[h]={});const g=this.requestManager.normalizeModelURL(s);if((this.hasModel(t,h,{exactIdMatch:!0})||this.hasModelBeenAdded(t,h))&&this.modelUris[h][t]===g)this.models[h][t].numReferences++;else if(this.hasURLBeenRequested(g)){const{scope:v,modelId:b}=this.modelByURL[g];this.models[v][b].numReferences++}else this.modelUris[h][t]=g,this.load({[t]:this.modelUris[h][t]},h)}addModelURLs(t,s){this.models[s]||(this.models[s]={}),this.modelUris[s]||(this.modelUris[s]={});const h=this.modelUris[s];for(const g in t)h[g]=this.requestManager.normalizeModelURL(t[g])}reloadModels(t){this.load(this.modelUris[t],t,{forceReload:!0})}addModelsFromBucket(t,s){this.models[s]||(this.models[s]={}),this.modelUris[s]||(this.modelUris[s]={});const h={};for(const g of t)this.hasModel(g,s,{exactIdMatch:!0})||this.hasURLBeenRequested(g)?this.models[s][g].numReferences++:this.modelUris[s][g]&&!this.hasURLBeenRequested(g)?h[g]=this.modelUris[s][g]:!this.hasURLBeenRequested(g)&&r.cZ(g,!1)&&(this.modelUris[s][g]=this.requestManager.normalizeModelURL(g),h[g]=this.modelUris[s][g]);this.load(h,s)}hasURLBeenRequested(t){return this.modelByURL[t]!==void 0}removeModel(t,s,h=!1){if(this.models[s]&&this.models[s][t]&&(this.models[s][t].numReferences--,this.models[s][t].numReferences===0)){const g=this.modelUris[s][t];h||delete this.modelUris[s][t],delete this.modelByURL[g];const v=this.models[s][t].model;if(!v)return;delete this.models[s][t],v.destroy()}}destroy(){for(const t of Object.keys(this.models))for(const s of Object.keys(this.models[t])){const h=this.models[t][s].model;delete this.models[t][s],h&&h.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,s){this.models[s]||(this.models[s]={});for(const h in this.models[s])this.models[s][h].model&&this.models[s][h].model.upload(t.context)}}const Oh=new r.a7({data:new r.a8(r.a5.colorTheme.data)}),Rp={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function Cl(u){return u=u||{},Object.assign(u,Rp)}class Hm extends r.E{constructor(t){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._floorplanStates={},r.aV(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=t,this._checkFloorplanVisible(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(t=>{t.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new r.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=t.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=t.stylesheet.indoor.buildingFeaturesetId,this._scope=t.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:t=>(t.feature&&t.feature.properties.floorplan&&this.selectFloorplan(t.feature.properties.floorplan),!0)}),this._checkFloorplanVisible()}_onMove(){this._checkFloorplanVisible()}_checkFloorplanVisible(){if(!this._queryFeatureSetId||!this._map.isStyleLoaded())return;const t=()=>{this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new r.A("floorplangone"))};if(this._map.transform.zoom<13)return void t();const s={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},h=this._map.transform.width,g=this._map.transform.height,v=h*(2/3),b=g*(2/3),E=.5*(h-v),I=.5*(g-b),z=[new r.P(E,I),new r.P(E+v,I+b)],L=this._map.queryRenderedFeatures(z,s);L.length>0?this._selectedFloorplan&&L[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=L[0],this._floorplanSelected()):t()}_floorplanSelected(){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._floorplanStates[this._indoorData.id]=this._floorplanStates[this._indoorData.id]||{},this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[this._indoorData.id]]);const t=this._floorplanStates[this._indoorData.id].selectedBuilding,s=t?this._indoorData.buildings.find(E=>E.id===t):this._indoorData.buildings.length>0?this._indoorData.buildings[0]:null,h=this._floorplanStates[this._indoorData.id].selectedLevel,g=this._indoorData.levels.find(E=>E.id===h),v=this._indoorData.levels.find(E=>!(!s||!s.levels)&&Number(E.levelOrder)===0&&s.levels.includes(E.id)),b=g?g.id:v?v.id:void 0;this.fire(new r.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:b})),s&&this._buildingSelected(s,!1),b&&this._levelSelected(b)}_buildingSelected(t,s){if(!t||!t.id)return void console.warn("IndoorManager: Building or building id is undefined");s&&t.extent&&this._map.fitBounds(t.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=t?t.id:void 0;const h=this._indoorData.levels.filter(g=>t.levels.includes(g.id));this.fire(new r.A("buildingselected",{buildingId:t.id,levels:h}))}_levelSelected(t){const s=this._indoorData.levels.find(h=>h.id===t);s?(this._updateLevels(s,!0),this.fire(new r.A("levelselected",{levelId:s.id}))):console.warn(`IndoorManager: Level with ID ${t} not found in the current floorplan.`)}_updateLevels(t,s){if(!t||!t.id)throw new Error("IndoorManager: Selected level or level ID is undefined");function h(z){const L=z.indexOf("/floor/");if(L===-1)return z;const N=L+7,F=z.indexOf("/",N);return F===-1?z.slice(N):z.slice(N,F)}this._floorplanStates[this._indoorData.id].selectedLevel=t.id;const g=[],v={},b={},E={},I={};for(const z of this._indoorData.levels){if(g.push(z.id),v[z.id]=z.levelOrder>=0?3*Math.abs(z.levelOrder+1):3*Math.abs(z.levelOrder),b[z.id]=z.levelOrder>=0?3*z.levelOrder:0,this.mergeFloors){const L=h(t.id),N=h(z.id);E[z.id]=N===L?"true":"false"}else E[z.id]=z.id===t.id?"true":"false";I[z.id]=z.levelOrder<t.levelOrder?"true":"false"}this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",g]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",v]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",b]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",E]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",I]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",t.levelOrder<0)}selectFloorplan(t){const s={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},h=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],g=this._map.queryRenderedFeatures(h,s);if(g.length>0){for(const v of g)if(JSON.parse(v.properties["indoor-data"]).id===t){this._selectedFloorplan=v,this._floorplanSelected();break}}}selectBuilding(t){const s=this._indoorData.buildings.find(h=>h.id===t);this._buildingSelected(s,!0)}selectLevel(t){this._levelSelected(t)}}function Um(u){if(!u.metadata||!u.metadata.content_area)return;const t=r.q.devicePixelRatio,{left:s,top:h,width:g,height:v}=u.metadata.content_area,b=s*t,E=h*t;return[b,E,b+g*t,E+v*t]}function zf(u){if(u)return u.map(([t,s])=>[t*r.q.devicePixelRatio,s*r.q.devicePixelRatio])}class va{constructor(t,s,h){this.id=t,this.scope=s,this.sourceCache=h,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(t){this.missingRequests.has(t.name)||this.pendingRequests.has(t.name)||this.pendingRequests.add(t.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const t=new Map;if(!this.sourceCache.loaded())return t;const s=this.sourceCache.getVisibleCoordinates();if(s.length===0)return t;const h=this.sourceCache.getSource();if(!(h instanceof Xl))return t;const g=s.map(b=>this.sourceCache.getTile(b)),v=h.getImages(g,Array.from(this.pendingRequests));for(const[b,E]of v)t.set(r.I.from({name:b,iconsetId:this.id}),E),this.pendingRequests.delete(b);for(const b of this.pendingRequests)this.missingRequests.add(b);return this.pendingRequests.clear(),t}}const Ia=(u,t)=>Ce(u,t&&t.filter(s=>s.identifier!=="source.canvas")),Rd=r.aF(wi,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),zp=r.aF(wi,["setCenter","setZoom","setBearing","setPitch"]),Bh=new Set(["background","sky","slot","custom"]),zd={version:8,layers:[],sources:{}},Fh={duration:300,delay:0};class ao extends r.E{constructor(t,s={}){super(),this.map=t,this.scope=s.scope||"",this.globalId=null,this.fragments=[],this.importDepth=s.importDepth||0,this.importsCache=s.importsCache||new Map,this.resolvedImports=s.resolvedImports||new Set,this.transition=r.h({},Fh),this._buildingIndex=new Au(this),this.crossTileSymbolIndex=new Po,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=s.styleChanges||new Vn,this.dispatcher=s.dispatcher?s.dispatcher:new r.D(r.c$(),this),s.imageManager?this.imageManager=s.imageManager:(this.imageManager=new zi(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=s.glyphManager?s.glyphManager:new r.d0(t._requestManager,s.localFontFamily?r.d1.all:s.localIdeographFontFamily?r.d1.ideographs:r.d1.none,s.localFontFamily||s.localIdeographFontFamily),s.modelManager?this.modelManager=s.modelManager:(this.modelManager=new Mp(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=s.configOptions?s.configOptions:new Map,this._configDependentLayers=s.configDependentLayers?s.configDependentLayers:new Set,this._config=s.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:s.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=s.initialConfig,this.dispatcher.broadcast("setReferrer",r.d2());const h=this;this._rtlTextPluginCallback=ao.registerForPluginStateChange(g=>{h.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},(v,b)=>{if(r.d3(v),b&&b.every(E=>E))for(const E in h._sourceCaches){const I=h._sourceCaches[E],z=I.getSource().type;z!=="vector"&&z!=="geojson"||I.reload()}})}),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const v=this.getOwnSource(g.sourceId);if(v&&v.vectorLayerIds)for(const b in this._layers){const E=this._layers[b];E.source===v.id&&this._validateLayer(E)}})}load(t){return t?(typeof t=="string"?this.loadURL(t):this.loadJSON(t),this):this}_getGlobalId(t){if(!t)return null;if(typeof t=="string"){if(r.j(t))return t;const s=r.d4(t);if(!s.startsWith("http"))try{return new URL(s,location.href).toString()}catch{return s}return s}return`json://${r.d5(JSON.stringify(t))}`}_diffStyle(t,s,h){this.globalId=this._getGlobalId(t);const g=(v,b)=>{try{b(null,this.setState(v,h))}catch(E){b(E,!1)}};if(typeof t=="string"){const v=this.map._requestManager.normalizeStyleURL(t),b=this.map._requestManager.transformRequest(v,r.R.Style);r.n(b,(E,I)=>{E?this.fire(new r.z(E)):I&&g(I,s)})}else typeof t=="object"&&g(t,s)}loadURL(t,s={}){this.fire(new r.A("dataloading",{dataType:"style"}));const h=typeof s.validate=="boolean"?s.validate:!r.j(t);this.globalId=this._getGlobalId(t),t=this.map._requestManager.normalizeStyleURL(t,s.accessToken),this.resolvedImports.add(t);const g=this.importsCache.get(t);if(g)return this._load(g,h);const v=this.map._requestManager.transformRequest(t,r.R.Style);this._request=r.n(v,(b,E)=>{if(this._request=null,b)this.fire(new r.z(b));else if(E)return this.importsCache.set(t,E),this._load(E,h)})}loadJSON(t,s={}){this.fire(new r.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(t),this._request=r.q.frame(()=>{this._request=null,this._load(t,s.validate!==!1)})}loadEmpty(){this.fire(new r.A("dataloading",{dataType:"style"})),this._load(zd,!1)}_loadImports(t,s,h){if(this.importDepth>=4)return r.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const g=[];for(const v of t){const b=this._createFragmentStyle(v),E=new Promise(L=>{b.once("style.import.load",L),b.once("error",L)}).then(()=>this.mergeAll());if(g.push(E),this.resolvedImports.has(v.url)){b.loadEmpty();continue}const I=v.data||this.importsCache.get(v.url);I?(b.loadJSON(I,{validate:s}),this._isInternalStyle(I)&&(b.globalId=null)):v.url?b.loadURL(v.url,{validate:s}):b.loadEmpty();const z={style:b,id:v.id,config:v.config};if(h){const L=this.fragments.findIndex(({id:N})=>N===h);this.fragments=this.fragments.slice(0,L).concat(z).concat(this.fragments.slice(L))}else this.fragments.push(z)}return Promise.allSettled(g)}getImportGlobalIds(t=this,s=new Set){for(const h of t.fragments)h.style.globalId&&s.add(h.style.globalId),this.getImportGlobalIds(h.style,s);return[...s.values()]}_createFragmentStyle(t){const s=this.scope?r.C(t.id,this.scope):t.id;let h;const g=this._initialConfig&&this._initialConfig[s];(t.config||g)&&(h=r.h({},t.config,g));const v=new ao(this.map,{scope:s,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:h,configOptions:this.options,colorThemeOverride:t["color-theme"],configDependentLayers:this._configDependentLayers});return v.setEventedParent(this.map,{style:v}),v}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(t){return this.isRootStyle()&&(t.fragment||!!t.schema&&t.fragment!==!1)}_load(t,s){const h=t.indoor?Cl(t.schema):t.schema;if(this._isInternalStyle(t)){const b=r.h({},zd,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(b,s)}if(this.updateConfig(this._config,h),s&&Ia(this,Ls(t)))return;this._loaded=!0,this.stylesheet=r.d6(t);const g=()=>{for(const z in t.sources)this.addSource(z,t.sources[z],{validate:!1,isInitialLoad:!0});if(t.iconsets)for(const z in t.iconsets)this.addIconset(z,t.iconsets[z]);t.sprite?this._loadIconset(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(t.glyphs);const b=ga(this.stylesheet.layers);if(this._order=b.map(z=>z.id),this.stylesheet.light&&r.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const z=this.stylesheet.lights[0];this.light=new Je(z.properties,z.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Je(this.stylesheet.light)),this._layers={};for(const z of b){const L=r.db(z,this.scope,this._styleColorTheme.lut,this.options);L.configDependencies.size!==0&&this._configDependentLayers.add(L.fqid),L.setEventedParent(this,{layer:{id:L.id}}),this._layers[L.id]=L;const N=this.getOwnLayerSourceCache(L),F=!!this.directionalLight&&this.directionalLight.shadowsEnabled();N&&L.canCastShadows()&&F&&(N.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const E=this.stylesheet.terrain;E&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(E,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new r.A("data",{dataType:"style"}));const I=this.isRootStyle();t.imports?this._loadImports(t.imports,s).then(()=>{this._reloadImports(),this.fire(new r.A(I?"style.load":"style.import.load"))}).catch(z=>{this.fire(new r.z(new Error("Failed to load imports",z))),this.fire(new r.A(I?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new r.A(I?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const v=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(v){const b=this._evaluateColorThemeData(v);this._loadColorTheme(b).then(()=>{g()}).catch(E=>{r.w(`Couldn't load color theme from the stylesheet: ${E}`),g()})}else this._styleColorTheme.lut=null,g()}isRootStyle(){return this.importDepth===0}mergeAll(){let t,s,h,g,v,b,E,I,z,L;const N={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(F=>{if(F.stylesheet){if(F.light!=null&&(t=F.light),F.stylesheet.lights)for(const q of F.stylesheet.lights)q.type==="ambient"&&F.ambientLight!=null&&(s=F.ambientLight),q.type==="directional"&&F.directionalLight!=null&&(h=F.directionalLight);g=this._prioritizeTerrain(g,F.terrain,F.stylesheet.terrain),F.stylesheet.fog&&F.fog!=null&&(v=F.fog),F.stylesheet.snow&&F.snow!=null&&(b=F.snow),F.stylesheet.rain&&F.rain!=null&&(E=F.rain),F.stylesheet.camera!=null&&(L=F.stylesheet.camera),F.stylesheet.projection!=null&&(I=F.stylesheet.projection),F.stylesheet.transition!=null&&(z=F.stylesheet.transition),N[F.scope]=F._styleColorTheme}}),this.light=t,this.ambientLight=s,this.directionalLight=h,this.fog=v,this.snow=b,this.rain=E,this._styleColorThemeForScope=N,g===null?delete this.terrain:this.terrain=g,this.camera=L||{"camera-projection":"perspective"},this.projection=I||{name:"mercator"},this.transition=r.h({},Fh,z),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const s=h=>{for(const g of h.fragments)s(g.style);t(h)};s(this)}_prioritizeTerrain(t,s,h){const g=t&&t.drapeRenderMode===0;return h===null?s&&s.drapeRenderMode===0?s:g?t:null:s!=null&&(!t||g||s&&s.drapeRenderMode===1)?s:t}mergeTerrain(){let t;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(s=>{t=this._prioritizeTerrain(t,s.terrain,s.stylesheet.terrain)}),t===null?delete this.terrain:this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(s=>{s.stylesheet.projection!=null&&(t=s.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},s={},h={};this.forEachFragmentStyle(g=>{for(const v in g._sourceCaches){const b=r.C(v,g.scope);t[b]=g._sourceCaches[v]}for(const v in g._otherSourceCaches){const b=r.C(v,g.scope);s[b]=g._otherSourceCaches[v]}for(const v in g._symbolSourceCaches){const b=r.C(v,g.scope);h[b]=g._symbolSourceCaches[v]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=s,this._mergedSymbolSourceCaches=h}mergeLayers(){const t={},s=[],h={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(v=>{for(const b of v._order){const E=v._layers[b];if(E.type==="slot"){const I=r.d7(b);if(t[I])continue;t[I]=[]}E.slot&&t[E.slot]?t[E.slot].push(E):s.push(E)}}),this._mergedOrder=[];const g=(v=[])=>{for(const b of v)if(b.type==="slot"){const E=r.d7(b.id);t[E]&&g(t[E]),this._mergedSlots.push(E)}else{const E=r.C(b.id,b.scope);this._mergedOrder.push(E),h[E]=b,b.is3D(!!this.terrain)&&(this._has3DLayers=!0),b.type==="circle"&&(this._hasCircleLayers=!0),b.type==="symbol"&&(this._hasSymbolLayers=!0),b.type==="clip"&&(this._clipLayerPresent=!0)}};g(s),this._mergedOrder.sort((v,b)=>{const E=h[v],I=h[b];return E.hasInitialOcclusionOpacityProperties?I.is3D(!!this.terrain)?1:0:E.is3D(!!this.terrain)&&I.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=h,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=r.h({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(t){return t.data?function(s,h,g,v){const b=r.h({},h);for(const I of Object.keys(r.a5.colorTheme))b[I]===void 0&&(b[I]=r.a5.colorTheme[I].default);const E=new r.a6(Oh,s,new Map(g));return E.setTransitionOrValue(b,g),E.untransitioned().possiblyEvaluate(new r.aa(0,{worldview:void 0}))}(this.scope,t,this.options).get("data"):null}_loadColorTheme(t){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const s=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((h,g)=>{const v="data:image/png;base64,";if(!t||t.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void h();let b=t;b.startsWith(v)||(b=v+b);const E=r.I.from("mapbox-reserved-lut"),I=new Image;I.src=b,I.onerror=()=>{this._styleColorTheme.lutLoading=!1,g(new Error("Failed to load image data"))},I.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==s)return void h();this._styleColorTheme.lutLoading=!1;const{width:z,height:L,data:N}=r.q.getImageData(I);if(L>32)return void g(new Error("The height of the image must be less than or equal to 32 pixels."));if(z!==L*L)return void g(new Error("The width of the image must be equal to the height squared."));this.getImage(E)&&this.removeImage(E),this.addImage(E,{data:new r.r({width:z,height:L},N),pixelRatio:1,sdf:!1,usvg:!1,version:0});const F=this.imageManager.getImage(E,this.scope);F?(this._styleColorTheme.lut={image:F.data,data:t},h()):g(new Error("Missing LUT image."))}})}getLut(t){const s=this._styleColorThemeForScope[t];return s?s.lut:null}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(s,h,g){let v,b,E;const I=r.q.devicePixelRatio>1?"@2x":"";let z=r.n(h.transformRequest(h.normalizeSpriteURL(s,I,".json"),r.R.SpriteJSON),(F,q)=>{z=null,E||(E=F,v=q,N())}),L=r.o(h.transformRequest(h.normalizeSpriteURL(s,I,".png"),r.R.SpriteImage),(F,q)=>{L=null,E||(E=F,b=q,N())});function N(){if(E)g(E);else if(v&&b){const F=r.q.getImageData(b),q={};for(const X in v){const{width:G,height:Y,x:J,y:re,sdf:pe,pixelRatio:_e,stretchX:Ae,stretchY:Ie,content:Te}=v[X],ve=new r.r({width:G,height:Y});r.r.copy(F,ve,{x:J,y:re},{x:0,y:0},{width:G,height:Y},null),q[X]={data:ve,pixelRatio:_e,sdf:pe,stretchX:Ae,stretchY:Ie,content:Te,usvg:!1}}g(null,q)}}return{cancel(){z&&(z.cancel(),z=null),L&&(L.cancel(),L=null)}}}(t,this.map._requestManager,(s,h)=>{if(this._spriteRequest=null,s)this.fire(new r.z(s));else if(h){const g=new Map;for(const v in h)g.set(r.I.from(v),h[v]);this.addImages(g)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))})}addIconset(t,s){if(s.type==="sprite")return void this._loadSprite(s.url);const h=this.getOwnSourceCache(s.source);if(!h)return void this.fire(new r.z(new Error(`Source "${s.source}" as specified by iconset "${t}" does not exist and cannot be used as an iconset source`)));const g=h.getSource();if(g.type!=="raster-array")return void this.fire(new r.z(new Error(`Source "${s.source}" as specified by iconset "${t}" is not a "raster-array" source and cannot be used as an iconset source`)));g.partial=!1;const v=new va(t,this.scope,h);this.imageManager.addImageProvider(v,this.scope)}removeIconset(t){this.imageManager.removeImageProvider(t,this.scope)}_loadIconset(t){if(!r.j(t)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(t);const s=this.map._spriteFormat==="auto";var h,g;this._spriteRequest=(g=(v,b)=>{if(this._spriteRequest=null,v)s?this._loadSprite(t):this.fire(new r.z(v));else if(b){const E=new Map;for(const I in b)E.set(r.I.from(I),b[I]);this.addImages(E)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.A("data",{dataType:"style"}))},r.br((h=this.map._requestManager).transformRequest(h.normalizeIconsetURL(t),r.R.Iconset),(v,b)=>{if(v)return void g(v);const E={},I=r.c_(new r.bq(b));for(const z of I.icons){const L={version:1,pixelRatio:r.q.devicePixelRatio,content:Um(z),stretchX:z.metadata?zf(z.metadata.stretch_x_areas):void 0,stretchY:z.metadata?zf(z.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:z};E[z.name]=L}g(null,E)}))}_validateLayer(t){const s=this.getOwnSource(t.source);if(!s)return;const h=t.sourceLayer;h&&(s.type==="geojson"||s.vectorLayerIds&&s.vectorLayerIds.indexOf(h)===-1)&&this.fire(new r.z(new Error(`Source layer "${h}" does not exist on source "${s.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,s)=>{const h=this.fragments[s];return h&&h.style&&(t.data=h.style.serialize()),t})}_serializeSources(){const t={};for(const s in this._sourceCaches){const h=this._sourceCaches[s].getSource();t[h.id]||(t[h.id]=h.serialize())}return t}_serializeLayers(t){const s=[];for(const h of t){const g=this._layers[h];g&&g.type!=="custom"&&s.push(g.serialize())}return s}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(t){return t?this.order:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&t.isDraped(this.getLayerSourceCache(t))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(t){const s=this.getOwnLayer(t);if(s)return s;this.fire(new r.z(new Error(`The layer '${t}' does not exist in the map's style.`)))}_checkSource(t){const s=this.getOwnSource(t);if(s)return s;this.fire(new r.z(new Error(`The source '${t}' does not exist in the map's style.`)))}precompilePrograms(t,s){const h=this.map.painter;if(h)for(let g=t.minzoom||0;g<(t.maxzoom||25.5);g++){const v=t.getProgramIds();if(v)for(const b of v){const E=t.getDefaultProgramParams(b,s.zoom,this._styleColorTheme.lut);E&&(h.style=this,this.fog&&(h._fogVisible=!0,E.overrideFog=!0,h.getOrCreateProgram(b,E)),h._fogVisible=!1,E.overrideFog=!1,h.getOrCreateProgram(b,E),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(E.overrideRtt=!0,h.getOrCreateProgram(b,E)))}}}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const s=this.calculateLightsBrightness();t.brightness=s||0,s!==this._brightness&&(this._brightness=s,this.dispatcher.broadcast("setBrightness",s)),t.worldview!==this._worldview&&(this._worldview=t.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const h=this._changes.isDirty();let g=!1;if(this._changes.isDirty()){const E=this._changes.getLayerUpdatesByScope();for(const I in E){const{updatedIds:z,removedIds:L}=E[I];(z||L)&&(this._updateWorkerLayers(I,z,L),g=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this.snow&&this.snow.updateTransitions(t),this.rain&&this.rain.updateTransitions(t),this._changes.reset()}const v={};for(const E in this._mergedSourceCaches){const I=this._mergedSourceCaches[E];v[E]=I.used,I.used=!1,I.tileCoverLift=0}for(const E of this._mergedOrder){const I=this._mergedLayers[E];if(I.recalculate(t,this._availableImages),!I.isHidden(t.zoom)){const z=this.getLayerSourceCache(I);z&&(z.used=!0,z.tileCoverLift=Math.max(z.tileCoverLift,I.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(I,t)}):this.precompilePrograms(I,t))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&g&&this.mergeLayers();const b=this.imageManager.getPendingImageProviders();for(const E of b)E.sourceCache.used=!0;for(const E in v){const I=this._mergedSourceCaches[E];v[E]!==I.used&&I.getSource().fire(new r.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:I.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.snow&&this.snow.recalculate(t),this.rain&&this.rain.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),h&&this.fire(new r.A("data",{dataType:"style"}))}updateImageProviders(){const t=this.imageManager.getPendingImageProviders();for(const s of t){const h=s.resolvePendingRequests(),g=this.getFragmentStyle(s.scope);g&&g.addImages(h)}}_updateTilesForChangedImages(){const t={};for(const s in this._mergedSourceCaches){const h=this._mergedSourceCaches[s].getSource().scope;t[h]=t[h]||this._changes.getUpdatedImages(h),t[h].length!==0&&this._mergedSourceCaches[s].reloadTilesForDependencies(["icons","patterns"],t[h])}for(const s in t)this._changes.resetUpdatedImages(s)}_updateWorkerLayers(t,s,h){const g=this.getFragmentStyle(t);g&&this.dispatcher.broadcast("updateLayers",{layers:s?g._serializeLayers(s):[],scope:t,removedIds:h||[],options:g.options})}setState(t,s){if(this._checkLoaded(),Ia(this,Ls(t)))return!1;(t=r.d6(t)).layers=ga(t.layers);const h=function(b,E){if(!b)return[{command:wi.setStyle,args:[E]}];let I=[];try{if(!r.bv(b.version,E.version))return[{command:wi.setStyle,args:[E]}];if(r.bv(b.center,E.center)||I.push({command:wi.setCenter,args:[E.center]}),r.bv(b.zoom,E.zoom)||I.push({command:wi.setZoom,args:[E.zoom]}),r.bv(b.bearing,E.bearing)||I.push({command:wi.setBearing,args:[E.bearing]}),r.bv(b.pitch,E.pitch)||I.push({command:wi.setPitch,args:[E.pitch]}),r.bv(b.sprite,E.sprite)||I.push({command:wi.setSprite,args:[E.sprite]}),r.bv(b.glyphs,E.glyphs)||I.push({command:wi.setGlyphs,args:[E.glyphs]}),r.bv(b.imports,E.imports)||function(q=[],X=[],G){X=X||[];const Y=(q=q||[]).map(nc),J=X.map(nc),re=q.reduce(ic,{}),pe=X.reduce(ic,{}),_e=Y.slice();let Ae,Ie,Te,ve;for(Ae=0,Ie=0;Ae<Y.length;Ae++)Te=Y[Ae],pe.hasOwnProperty(Te)?Ie++:(G.push({command:wi.removeImport,args:[Te]}),_e.splice(_e.indexOf(Te,Ie),1));for(Ae=0,Ie=0;Ae<J.length;Ae++)Te=J[J.length-1-Ae],_e[_e.length-1-Ae]!==Te&&(re.hasOwnProperty(Te)?(G.push({command:wi.removeImport,args:[Te]}),_e.splice(_e.lastIndexOf(Te,_e.length-Ie),1)):Ie++,ve=_e[_e.length-Ae],G.push({command:wi.addImport,args:[pe[Te],ve]}),_e.splice(_e.length-Ae,0,Te));for(const Pe of X){const Me=re[Pe.id];Me&&(delete Me.data,r.bv(Me,Pe)||G.push({command:wi.updateImport,args:[Pe.id,Pe]}))}}(b.imports,E.imports,I),r.bv(b.transition,E.transition)||I.push({command:wi.setTransition,args:[E.transition]}),r.bv(b.light,E.light)||I.push({command:wi.setLight,args:[E.light]}),r.bv(b.fog,E.fog)||I.push({command:wi.setFog,args:[E.fog]}),r.bv(b.snow,E.snow)||I.push({command:wi.setSnow,args:[E.snow]}),r.bv(b.rain,E.rain)||I.push({command:wi.setRain,args:[E.rain]}),r.bv(b.projection,E.projection)||I.push({command:wi.setProjection,args:[E.projection]}),r.bv(b.lights,E.lights)||I.push({command:wi.setLights,args:[E.lights]}),r.bv(b.camera,E.camera)||I.push({command:wi.setCamera,args:[E.camera]}),r.bv(b.iconsets,E.iconsets)||function(q,X,G){let Y;for(Y in X=X||{},q=q||{})q.hasOwnProperty(Y)&&(X.hasOwnProperty(Y)||G.push({command:wi.removeIconset,args:[Y]}));for(Y in X){if(!X.hasOwnProperty(Y))continue;const J=X[Y];q.hasOwnProperty(Y)?r.bv(q[Y],J)||(G.push({command:wi.removeIconset,args:[Y]}),G.push({command:wi.addIconset,args:[Y,J]})):G.push({command:wi.addIconset,args:[Y,J]})}}(b.iconsets,E.iconsets,I),!r.bv(b["color-theme"],E["color-theme"]))return[{command:wi.setStyle,args:[E]}];const z={},L=[];(function(q,X,G,Y){let J;for(J in X=X||{},q=q||{})q.hasOwnProperty(J)&&(X.hasOwnProperty(J)||Ua(J,G,Y));for(J in X){if(!X.hasOwnProperty(J))continue;const re=X[J];q.hasOwnProperty(J)?r.bv(q[J],re)||(q[J].type==="geojson"&&re.type==="geojson"&&Rf(q,X,J)?G.push({command:wi.setGeoJSONSourceData,args:[J,re.data]}):Ih(J,X,G,Y)):Ah(J,X,G)}})(b.sources,E.sources,L,z);const N=[];b.layers&&b.layers.forEach(q=>{q.source&&z[q.source]?I.push({command:wi.removeLayer,args:[q.id]}):N.push(q)});let F=b.terrain;F&&z[F.source]&&(I.push({command:wi.setTerrain,args:[void 0]}),F=void 0),I=I.concat(L),r.bv(F,E.terrain)||I.push({command:wi.setTerrain,args:[E.terrain]}),function(q,X,G){X=X||[];const Y=(q=q||[]).map(nc),J=X.map(nc),re=q.reduce(ic,{}),pe=X.reduce(ic,{}),_e=Y.slice(),Ae=Object.create(null);let Ie,Te,ve,Pe,Me,We,Qe;for(Ie=0,Te=0;Ie<Y.length;Ie++)ve=Y[Ie],pe.hasOwnProperty(ve)?Te++:(G.push({command:wi.removeLayer,args:[ve]}),_e.splice(_e.indexOf(ve,Te),1));for(Ie=0,Te=0;Ie<J.length;Ie++)ve=J[J.length-1-Ie],_e[_e.length-1-Ie]!==ve&&(re.hasOwnProperty(ve)?(G.push({command:wi.removeLayer,args:[ve]}),_e.splice(_e.lastIndexOf(ve,_e.length-Te),1)):Te++,We=_e[_e.length-Ie],G.push({command:wi.addLayer,args:[pe[ve],We]}),_e.splice(_e.length-Ie,0,ve),Ae[ve]=!0);for(Ie=0;Ie<J.length;Ie++)if(ve=J[Ie],Pe=re[ve],Me=pe[ve],!Ae[ve]&&!r.bv(Pe,Me))if(r.bv(Pe.source,Me.source)&&r.bv(Pe["source-layer"],Me["source-layer"])&&r.bv(Pe.type,Me.type)){for(Qe in tc(Pe.layout,Me.layout,G,ve,null,wi.setLayoutProperty),tc(Pe.paint,Me.paint,G,ve,null,wi.setPaintProperty),r.bv(Pe.slot,Me.slot)||G.push({command:wi.setSlot,args:[ve,Me.slot]}),r.bv(Pe.filter,Me.filter)||G.push({command:wi.setFilter,args:[ve,Me.filter]}),r.bv(Pe.minzoom,Me.minzoom)&&r.bv(Pe.maxzoom,Me.maxzoom)||G.push({command:wi.setLayerZoomRange,args:[ve,Me.minzoom,Me.maxzoom]}),Pe)Pe.hasOwnProperty(Qe)&&Qe!=="layout"&&Qe!=="paint"&&Qe!=="filter"&&Qe!=="metadata"&&Qe!=="minzoom"&&Qe!=="maxzoom"&&Qe!=="slot"&&(Qe.indexOf("paint.")===0?tc(Pe[Qe],Me[Qe],G,ve,Qe.slice(6),wi.setPaintProperty):r.bv(Pe[Qe],Me[Qe])||G.push({command:wi.setLayerProperty,args:[ve,Qe,Me[Qe]]}));for(Qe in Me)Me.hasOwnProperty(Qe)&&!Pe.hasOwnProperty(Qe)&&Qe!=="layout"&&Qe!=="paint"&&Qe!=="filter"&&Qe!=="metadata"&&Qe!=="minzoom"&&Qe!=="maxzoom"&&Qe!=="slot"&&(Qe.indexOf("paint.")===0?tc(Pe[Qe],Me[Qe],G,ve,Qe.slice(6),wi.setPaintProperty):r.bv(Pe[Qe],Me[Qe])||G.push({command:wi.setLayerProperty,args:[ve,Qe,Me[Qe]]}))}else G.push({command:wi.removeLayer,args:[ve]}),We=_e[_e.lastIndexOf(ve)+1],G.push({command:wi.addLayer,args:[Me,We]})}(N,E.layers,I)}catch(z){console.warn("Unable to compute style diff:",z),I=[{command:wi.setStyle,args:[E]}]}return I}(this.serialize(),t).filter(b=>!(b.command in zp));if(h.length===0)return!1;const g=h.filter(b=>!(b.command in Rd));if(g.length>0)throw new Error(`Unimplemented: ${g.map(b=>b.command).join(", ")}.`);const v=[];return h.forEach(b=>{v.push(this[b.command](...b.args))}),s&&Promise.all(v).then(s).catch(s),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(t){for(const[s,h]of t.entries()){if(this.getImage(s))return this.fire(new r.z(new Error(`An image with the name "${s.name}" already exists.`)));this.imageManager.addImage(s,this.scope,h),this._changes.updateImage(s,this.scope)}return this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this}addImage(t,s){return this.getImage(t)?this.fire(new r.z(new Error(`An image with the name "${t.name}" already exists.`))):(this.imageManager.addImage(t,this.scope,s),this._changes.updateImage(t,this.scope),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this)}updateImage(t,s,h=!1){this.imageManager.updateImage(t,this.scope,s),h&&(this._changes.updateImage(t,this.scope),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})))}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._changes.updateImage(t,this.scope),this._updateWorkerImages(),this.fire(new r.A("data",{dataType:"style"})),this):this.fire(new r.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(t){return this.modelManager.addModelURLs(t,this.scope),this._updateWorkerModels(),this.fire(new r.A("data",{dataType:"style"})),this}addModel(t,s,h={}){return this._checkLoaded(),this._validate(xe,`models.${t}`,s,null,h)||(this.modelManager.addModel(t,s,this.scope),this.fire(new r.A("data",{dataType:"style"}))),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this.fire(new r.A("data",{dataType:"style"})),this):this.fire(new r.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,s,h={}){if(this._checkLoaded(),this.getOwnSource(t)!==void 0)throw new Error(`There is already a source with ID "${t}".`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(Zl,`sources.${t}`,s,null,h))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const g=Yl(t,s,this.dispatcher,this);g.scope=this.scope,g.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(g.id),source:g.serialize(),sourceId:g.id}));const v=b=>{const E=(b?"symbol:":"other:")+g.id,I=r.C(E,this.scope),z=this._sourceCaches[E]=new Zs(I,g,b);(b?this._symbolSourceCaches:this._otherSourceCaches)[g.id]=z,z.onAdd(this.map)};v(!1),s.type!=="vector"&&s.type!=="geojson"||v(!0),g.onAdd&&g.onAdd(this.map),h.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(t){this._checkLoaded();const s=this.getOwnSource(t);if(!s)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===t)return this.fire(new r.z(new Error(`Source "${t}" cannot be removed while layer "${g}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===t)return this.fire(new r.z(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const g=Object.entries(this.stylesheet.iconsets).find(([v,b])=>b.type==="source"&&b.source===t);if(g)return this.fire(new r.z(new Error(`Source "${t}" cannot be removed while iconset "${g[0]}" is using it.`)))}const h=this.getOwnSourceCaches(t);for(const g of h){const v=r.d7(g.id);delete this._sourceCaches[v],this._changes.discardSourceCacheUpdate(g.id),g.fire(new r.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:g.getSource().id})),g.setEventedParent(null),g.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),s.setEventedParent(null),s.onRemove&&s.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(t,s){this._checkLoaded(),this.getOwnSource(t).setData(s),this._changes.setDirty()}getOwnSource(t){const s=this.getOwnSourceCache(t);return s&&s.getSource()}getOwnSources(){const t=[];for(const s in this._otherSourceCaches){const h=this.getOwnSourceCache(s);h&&t.push(h.getSource())}return t}areTilesLoaded(){const t=this._mergedSourceCaches;for(const s in t){const h=t[s]._tiles;for(const g in h){const v=h[g];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const s=this._getTransitionParameters();for(const v of t){if(this._validate(Kl,"lights",v))return;switch(v.type){case"ambient":if(this.ambientLight){const b=this.ambientLight;b.set(v),b.updateTransitions(s)}else this.ambientLight=new Li(v,Un||(Un=new r.a7({color:new r.a8(r.a5.properties_light_ambient.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const b=this.directionalLight;b.set(v),b.updateTransitions(s)}else this.directionalLight=new Li(v,Ki||(Ki=new r.a7({direction:new r.an(r.a5.properties_light_directional.direction),color:new r.a8(r.a5.properties_light_directional.color),"color-use-theme":new r.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a8(r.a5.properties_light_directional.intensity),"cast-shadows":new r.a8(r.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new r.a8(r.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new r.a8(r.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const h=Object.assign(s,{worldview:this.map.getWorldview()}),g=new r.aa(this.z||0,h);this.ambientLight&&this.ambientLight.recalculate(g),this.directionalLight&&this.directionalLight.recalculate(g),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,s=this.ambientLight;if(!t||!s)return;const h=F=>.2126*(F[0]<=.03928?F[0]/12.92:Math.pow((F[0]+.055)/1.055,2.4))+.7152*(F[1]<=.03928?F[1]/12.92:Math.pow((F[1]+.055)/1.055,2.4))+.0722*(F[2]<=.03928?F[2]/12.92:Math.pow((F[2]+.055)/1.055,2.4)),g=t.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),v=t.properties.get("intensity"),b=t.properties.get("direction"),E=1-r.cR(b.x,b.y,b.z)[2]/90,I=h(g)*v*E,z=s.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),L=s.properties.get("intensity"),N=h(z)*L;return Number(((I+N)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(t==null||t===""&&this.isRootStyle())return this;if(r.d8(t)){const s=r.d9(t),h=this.fragments.find(({id:v})=>v===s);if(!h)return;const g=r.d7(t);return h.style.getFragmentStyle(g)}{const s=this.fragments.find(({id:h})=>h===t);return s?s.style:void 0}}setFeaturesetSelectors(t){if(!t)return;const s={},h=(g,v="")=>`${g}::${v}`;this._featuresetSelectors={};for(const g in t){const v=this._featuresetSelectors[g]=[];for(const b of t[g].selectors){if(b.featureNamespace){const I=this.getOwnLayer(b.layer);if(!I){r.w(`Layer is undefined for selector: ${b.layer}`);continue}const z=h(I.source,I.sourceLayer);if(z in s&&s[z]!==b.featureNamespace){r.w(`"featureNamespace ${b.featureNamespace} of featureset ${g}'s selector is not associated to the same source, skip this selector`);continue}s[z]=b.featureNamespace}let E;if(b.properties)for(const I in b.properties){const z=r.X(b.properties[I]);z.result==="success"&&(E=E||{},E[I]=z.value)}v.push({layerId:b.layer,namespace:b.featureNamespace,properties:E,uniqueFeatureID:b._uniqueFeatureID})}}}getFeaturesetDescriptors(t){const s=this.getFragmentStyle(t);if(!s||!s.stylesheet.featuresets)return[];const h=[];for(const g in s.stylesheet.featuresets)h.push({featuresetId:g,importId:s.scope?s.scope:void 0});return h}getFeaturesetLayers(t,s){const h=this.getFragmentStyle(s),g=h.stylesheet.featuresets;if(!g||!g[t])return this.fire(new r.z(new Error(`The featureset '${t}' does not exist in the map's style and cannot be queried.`))),[];const v=[];for(const b of g[t].selectors){const E=h.getOwnLayer(b.layer);E&&v.push(E)}return v}getConfigProperty(t,s){const h=this.getFragmentStyle(t);if(!h)return null;const g=r.C(s,h.scope),v=h.options.get(g),b=v?v.value||v.default:null;return b?b.serialize():null}setConfigProperty(t,s,h){const g=this.getFragmentStyle(t);if(!g)return;const v=g.stylesheet.indoor?Cl(g.stylesheet.schema):g.stylesheet.schema;if(!v||!v[s])return;const b=r.X(h);if(b.result!=="success")return void Ia(this,b.value);const E=b.value.expression,I=r.C(s,g.scope),z=g.options.get(I);if(!z)return;let L;const{minValue:N,maxValue:F,stepValue:q,type:X,values:G}=v[s],Y=r.X(v[s].default);Y.result==="success"&&(L=Y.value.expression),L?(this.options.set(I,Object.assign({},z,{value:E,default:L,minValue:N,maxValue:F,stepValue:q,type:X,values:G})),this.updateConfigDependencies(s)):this.fire(new r.z(new Error(`No schema defined for the config option "${s}" in the "${t}" fragment.`)))}getConfig(t){const s=this.getFragmentStyle(t);if(!s)return null;const h=s.stylesheet.schema;if(!h)return null;const g={};for(const v in h){const b=r.C(v,s.scope),E=s.options.get(b),I=E?E.value||E.default:null;g[v]=I?I.serialize():null}return g}setConfig(t,s){const h=this.getFragmentStyle(t);h&&(h.updateConfig(s,h.stylesheet.schema),this.updateConfigDependencies())}getSchema(t){const s=this.getFragmentStyle(t);return s?s.stylesheet.schema:null}setSchema(t,s){const h=this.getFragmentStyle(t);h&&(h.stylesheet.schema=s,h.updateConfig(h._config,s),this.updateConfigDependencies())}updateConfig(t,s){if(this._config=t,t||s)if(s)for(const h in s){let g,v;const b=r.X(s[h].default);if(b.result==="success"&&(g=b.value.expression),t&&t[h]!==void 0){const F=r.X(t[h]);F.result==="success"&&(v=F.value.expression)}const{minValue:E,maxValue:I,stepValue:z,type:L,values:N}=s[h];if(g){const F=r.C(h,this.scope);this.options.set(F,{default:g,value:v,minValue:E,maxValue:I,stepValue:z,type:L,values:N})}else this.fire(new r.z(new Error(`No schema defined for config option "${h}".`)))}else this.fire(new r.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(t){for(const s of this._configDependentLayers){const h=this.getLayer(s);if(h){if(t&&!h.configDependencies.has(t))continue;h.possiblyEvaluateVisibility(),this._updateLayer(h)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(s=>{const h=s._styleColorTheme.colorThemeOverride?s._styleColorTheme.colorThemeOverride:s._styleColorTheme.colorTheme;if(h){const g=s._evaluateColorThemeData(h);(!s._styleColorTheme.lut&&g!==""||s._styleColorTheme.lut&&g!==s._styleColorTheme.lut.data)&&s.setColorTheme(h)}}),this._changes.setDirty()}addLayer(t,s,h={}){this._checkLoaded();const g=t.id;if(this._layers[g])return void this.fire(new r.z(new Error(`Layer with id "${g}" already exists on this map`)));let v;if(t.type==="custom"){if(Ia(this,r.da(t)))return;v=r.db(t,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof t.source=="object"&&(this.addSource(g,t.source),t=r.d6(t),t=r.h(t,{source:g})),this._validate(Ei,`layers.${g}`,t,{arrayIndex:-1},h))return;v=r.db(t,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(v),v.setEventedParent(this,{layer:{id:g}})}v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid);let b=this._order.length;if(s){const L=this._order.indexOf(s);if(L===-1)return void this.fire(new r.z(new Error(`Layer with id "${s}" does not exist on this map.`)));v.slot===this._layers[s].slot?b=L:r.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(b,0,g),this._layerOrderChanged=!0,this._layers[g]=v;const E=this.getOwnLayerSourceCache(v),I=!!this.directionalLight&&this.directionalLight.shadowsEnabled();E&&v.canCastShadows()&&I&&(E.castsShadows=!0);const z=this._changes.getRemovedLayer(v);if(z&&v.source&&E&&v.type!=="custom"){this._changes.discardLayerRemoval(v);const L=r.C(v.source,v.scope);z.type!==v.type?this._changes.updateSourceCache(L,"clear"):(this._changes.updateSourceCache(L,"reload"),E.pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map),v.scope=this.scope,this.mergeLayers()}moveLayer(t,s){this._checkLoaded();const h=this._checkLayer(t);if(!h||t===s)return;const g=this._order.indexOf(t);this._order.splice(g,1);let v=this._order.length;if(s){const b=this._order.indexOf(s);if(b===-1)return void this.fire(new r.z(new Error(`Layer with id "${s}" does not exist on this map.`)));h.slot===this._layers[s].slot?v=b:r.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(v,0,t),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(t){this._checkLoaded();const s=this._checkLayer(t);if(!s)return;s.setEventedParent(null);const h=this._order.indexOf(t);this._order.splice(h,1),delete this._layers[t],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(s.fqid),this._changes.removeLayer(s);const g=this.getOwnLayerSourceCache(s);if(g&&g.castsShadows){let v=!1;for(const b in this._layers)if(this._layers[b].source===s.source&&this._layers[b].canCastShadows()){v=!0;break}g.castsShadows=v}s.onRemove&&s.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const s in this._layers)if(this._layers[s].type===t)return!0;return!1}setLayerZoomRange(t,s,h){this._checkLoaded();const g=this._checkLayer(t);g&&(g.minzoom===s&&g.maxzoom===h||(s!=null&&(g.minzoom=s),h!=null&&(g.maxzoom=h),this._updateLayer(g)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(t,s){this._checkLoaded();const h=this._checkLayer(t);h&&h.slot!==s&&(h.slot=s,this._updateLayer(h))}setFilter(t,s,h={}){this._checkLoaded();const g=this._checkLayer(t);if(g&&!r.bv(g.filter,s))return s==null?(g.filter=void 0,void this._updateLayer(g)):void(this._validate(it,`layers.${g.id}.filter`,s,{layerType:g.type},h)||(g.filter=r.d6(s),this._updateLayer(g)))}getFilter(t){const s=this._checkLayer(t);if(s)return r.d6(s.filter)}setLayoutProperty(t,s,h,g={}){this._checkLoaded();const v=this._checkLayer(t);if(v&&!r.bv(v.getLayoutProperty(s),h)){if(h!=null&&(!g||g.validate!==!1)&&Ia(v,oe.call(Ls,{key:`layers.${t}.layout.${s}`,layerType:v.type,objectKey:s,value:h,styleSpec:r.a5,style:{glyphs:!0,sprite:!0}})))return;v.setLayoutProperty(s,h),v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid),this._updateLayer(v)}}getLayoutProperty(t,s){const h=this._checkLayer(t);if(h)return h.getLayoutProperty(s)}setPaintProperty(t,s,h,g={}){this._checkLoaded();const v=this._checkLayer(t);if(!v||r.bv(v.getPaintProperty(s),h)||h!=null&&(!g||g.validate!==!1)&&Ia(v,te.call(Ls,{key:`layers.${t}.paint.${s}`,layerType:v.type,objectKey:s,value:h,styleSpec:r.a5})))return;const b=v.setPaintProperty(s,h);v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid),b&&this._updateLayer(v),this._changes.updatePaintProperties(v)}getPaintProperty(t,s){const h=this._checkLayer(t);if(h)return h.getPaintProperty(s)}setFeatureState(t,s){if(this._checkLoaded(),"target"in t){if("featuresetId"in t.target){const{featuresetId:I,importId:z}=t.target,L=this.getFragmentStyle(z),N=L.getFeaturesetLayers(I);for(const{source:F,sourceLayer:q}of N)L.setFeatureState({id:t.id,source:F,sourceLayer:q},s)}else if("layerId"in t.target){const{layerId:I}=t.target,z=this.getLayer(I);this.setFeatureState({id:t.id,source:z.source,sourceLayer:z.sourceLayer},s)}return}const h=t.source,g=t.sourceLayer,v=this._checkSource(h);if(!v)return;const b=v.type;if(b==="geojson"&&g)return void this.fire(new r.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(b==="vector"&&!g)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided.")));const E=this.getOwnSourceCaches(h);for(const I of E)I.setFeatureState(g,t.id,s)}removeFeatureState(t,s){if(this._checkLoaded(),"target"in t){if("featuresetId"in t.target){const{featuresetId:I,importId:z}=t.target,L=this.getFragmentStyle(z),N=L.getFeaturesetLayers(I);for(const{source:F,sourceLayer:q}of N)L.removeFeatureState({id:t.id,source:F,sourceLayer:q},s)}else if("layerId"in t.target){const{layerId:I}=t.target,z=this.getLayer(I);this.removeFeatureState({id:t.id,source:z.source,sourceLayer:z.sourceLayer},s)}return}const h=t.source,g=this._checkSource(h);if(!g)return;const v=g.type,b=v==="vector"?t.sourceLayer:void 0;if(v==="vector"&&!b)return void this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(s&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new r.z(new Error("A feature id is required to remove its specific state property.")));const E=this.getOwnSourceCaches(h);for(const I of E)I.removeFeatureState(b,t.id,s)}getFeatureState(t){if(this._checkLoaded(),"target"in t){let v;if("featuresetId"in t.target){const{featuresetId:b,importId:E}=t.target,I=this.getFragmentStyle(E),z=I.getFeaturesetLayers(b);for(const{source:L,sourceLayer:N}of z){const F=I.getFeatureState({id:t.id,source:L,sourceLayer:N});if(F&&!v)v=F;else if(!r.bv(v,F))return void this.fire(new r.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in t.target){const{layerId:b}=t.target,E=this.getLayer(b);v=this.getFeatureState({id:t.id,source:E.source,sourceLayer:E.sourceLayer})}return v}const s=t.source,h=t.sourceLayer,g=this._checkSource(s);if(g){if(g.type!=="vector"||h)return t.id===void 0&&this.fire(new r.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(s)[0].getFeatureState(h,t.id);this.fire(new r.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(t){return this.stylesheet.transition=r.h({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return r.h({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),s=t&&this.terrain&&this.terrain.scope===this.scope?t:this.stylesheet.terrain;return r.dc({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:s,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},h=>h!==void 0)}_updateFilteredLayers(t){for(const s of Object.values(this._mergedLayers))t(s)&&this._updateLayer(s)}_updateLayer(t){this._changes.updateLayer(t);const s=this.getLayerSourceCache(t),h=r.C(t.source,t.scope),g=this._changes.getUpdatedSourceCaches();t.source&&!g[h]&&s&&s.getSource().type!=="raster"&&(this._changes.updateSourceCache(h,"reload"),s.pause()),t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const s=E=>this._mergedLayers[E].is3D(!!this.terrain),h=this.order,g={},v=[];for(let E=h.length-1;E>=0;E--){const I=h[E];if(s(I)){g[I]=E;for(const z of t){const L=z[I];if(L)for(const N of L)v.push(N)}}}v.sort((E,I)=>I.intersectionZ-E.intersectionZ);const b=[];for(let E=h.length-1;E>=0;E--){const I=h[E];if(s(I))for(let z=v.length-1;z>=0;z--){const L=v[z].feature;if(L.layer&&g[L.layer.id]<E)break;b.push(L),v.pop()}else for(const z of t){const L=z[I];if(L)for(const N of L)b.push(N.feature)}}return b}queryRenderedFeatures(t,s,h){let g;s&&!Array.isArray(s)&&s.filter&&(this._validate(it,"queryRenderedFeatures.filter",s.filter,null,s),g=r.b3(s.filter));const v={},b=L=>{if(Bh.has(L.type))return;const N=this.getOwnLayerSourceCache(L),F=v[N.id]=v[N.id]||{sourceCache:N,layers:{},has3DLayers:!1};L.is3D(!!this.terrain)&&(F.has3DLayers=!0),F.layers[L.fqid]=F.layers[L.fqid]||{styleLayer:L,targets:[]},F.layers[L.fqid].targets.push({filter:g})};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new r.z(new Error("parameters.layers must be an Array."))),[];for(const L of s.layers){const N=this._layers[L];if(!N)return this.fire(new r.z(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];b(N)}}else for(const L in this._layers)b(this._layers[L]);const E=this._queryRenderedFeatures(t,v,h),I=this._flattenAndSortRenderedFeatures(E),z=[];for(const L of I)r.dd(L.layer.id)===this.scope&&z.push(L);return z}queryRenderedFeatureset(t,s,h){let g;s&&!Array.isArray(s)&&s.filter&&(this._validate(it,"queryRenderedFeatures.filter",s.filter,null,s),g=r.b3(s.filter));const v="mock",b=[];if(s&&s.target)b.push(Object.assign({},s,{targetId:v,filter:g}));else{const L=this.getFeaturesetDescriptors();for(const N of L)b.push({targetId:v,filter:g,target:N});for(const{style:N}of this.fragments){const F=N.getFeaturesetDescriptors();for(const q of F)b.push({targetId:v,filter:g,target:q})}}const E=this.queryRenderedTargets(t,b,h),I=[],z=new Set;for(const L of E)for(const N of L.variants[v])Jl(N,L,z)||I.push(new r.de(L,N));return I}queryRenderedTargets(t,s,h){const g={},v=(E,I,z,L)=>{const N=g[I.id]=g[I.id]||{sourceCache:I,layers:{},has3DLayers:!1};if(N.layers[E.fqid]=N.layers[E.fqid]||{styleLayer:E,targets:[]},E.is3D(!!this.terrain)&&(N.has3DLayers=!0),!L)return z.uniqueFeatureID=!1,void N.layers[E.fqid].targets.push(z);N.layers[E.fqid].targets.push(Object.assign({},z,{namespace:L.namespace,properties:L.properties,uniqueFeatureID:L.uniqueFeatureID}))};for(const E of s)if("featuresetId"in E.target){const{featuresetId:I,importId:z}=E.target,L=this.getFragmentStyle(z);if(!L||!L._featuresetSelectors)continue;const N=L._featuresetSelectors[I];if(!N){this.fire(new r.z(new Error(`The featureset '${I}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const F of N){const q=L.getOwnLayer(F.layerId);q&&!Bh.has(q.type)&&v(q,L.getOwnLayerSourceCache(q),E,F)}}else if("layerId"in E.target){const{layerId:I}=E.target,z=this.getLayer(I);if(!z||Bh.has(z.type))continue;v(z,this.getLayerSourceCache(z),E)}const b=this._queryRenderedFeatures(t,g,h);return this._flattenAndSortRenderedFeatures(b)}_queryRenderedFeatures(t,s,h){const g=[],v=!!this.map._showQueryGeometry,b=Ii.createFromScreenPoints(t,h);for(const E in s){const I=zc(b,s[E],this._availableImages,h,v);Object.keys(I).length&&g.push(I)}if(this.placement)for(const E in s){if(!s[E].sourceCache._onlySymbols)continue;const I=Lc(b.screenGeometry,s[E],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(I).length&&g.push(I)}return g}querySourceFeatures(t,s){const h=s&&s.filter;h&&this._validate(it,"querySourceFeatures.filter",h,null,s);let g=[];const v=this.getOwnSourceCaches(t);for(const b of v)g=g.concat(Ch(b,s));return g}addSourceType(t,s,h){return ao.getSourceType(t)?h(new Error(`A source type called "${t}" already exists.`)):(ao.setSourceType(t,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:s.workerSourceURL},h):h(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,s,h={}){this._checkLoaded();const g=this.light.getLight();let v=!1;for(const E in t)if(!r.bv(t[E],g[E])){v=!0;break}if(!v)return;const b=this._getTransitionParameters();this.light.setLight(t,s,h),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=r.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&r.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(t,s=1){if(this._checkLoaded(),!t)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),s===0&&delete this.terrain,t===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let h=t;const g=t.source==null;if(s===1){if(this.disableElevatedTerrain)return;if(typeof h.source=="object"){const E="terrain-dem-src";this.addSource(E,h.source),h=r.d6(h),h=r.h(h,{source:E})}const v=r.h({},h),b={};if(this.terrain&&g){v.source=this.terrain.get().source;const E=this.terrain?this.getFragmentStyle(this.terrain.scope):null;E&&(b.style=E.serialize())}if(this._validate(Wt,"terrain",v,b))return}if(!this.terrain||this.terrain.scope!==this.scope&&!g||this.terrain&&s!==this.terrain.drapeRenderMode){if(!h)return;this._createTerrain(h,s),this.fire(new r.A("data",{dataType:"style"}))}else{const v=this.terrain,b=v.get();for(const E of Object.keys(r.a5.terrain))!h.hasOwnProperty(E)&&r.a5.terrain[E].default&&(h[E]=r.a5.terrain[E].default);for(const E in t)if(!r.bv(t[E],b[E])){v.set(t,this.options),this.stylesheet.terrain=t;const I=this._getTransitionParameters({duration:0});v.updateTransitions(I),this.fire(new r.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const s=this.fog=new Ln(t,this.map.transform,this.scope,this.options);this.stylesheet.fog=s.get();const h=this._getTransitionParameters({duration:0});s.updateTransitions(h)}_createSnow(t){const s=this.snow=new fi(t,this.map.transform,this.scope,this.options);this.stylesheet.snow=s.get();const h=this._getTransitionParameters({duration:0});s.updateTransitions(h)}_createRain(t){const s=this.rain=new pr(t,this.map.transform,this.scope,this.options);this.stylesheet.rain=s.get();const h=this._getTransitionParameters({duration:0});s.updateTransitions(h)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const s=this.fog;if(!r.bv(s.get(),t)){s.set(t,this.options),this.stylesheet.fog=s.get();const h=this._getTransitionParameters({duration:0});s.updateTransitions(h)}}else this._createFog(t);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(t){if(this._checkLoaded(),!t)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const s=this.snow;if(!r.bv(s.get(),t)){s.set(t,this.options),this.stylesheet.snow=s.get();const h=this._getTransitionParameters({duration:0});s.updateTransitions(h)}}else this._createSnow(t);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(t){if(this._checkLoaded(),!t)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const s=this.rain;if(!r.bv(s.get(),t)){s.set(t,this.options),this.stylesheet.rain=s.get();const h=this._getTransitionParameters({duration:0});s.updateTransitions(h)}}else this._createRain(t);this._markersNeedUpdate=!0}_reloadColorTheme(){const t=()=>{for(const g in this._layers)this._layers[g].lut=this._styleColorTheme.lut;for(const g in this._sourceCaches)this._sourceCaches[g].clearTiles()},s=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!s)return this._styleColorTheme.lut=null,void t();const h=this._evaluateColorThemeData(s);this._loadColorTheme(h).then(()=>{this.fire(new r.A("colorthemeset")),t()}).catch(g=>{r.w(`Couldn't set color theme: ${g}`)})}setColorTheme(t){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&r.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=t,this._reloadColorTheme()}setImportColorTheme(t,s){const h=this.getFragmentStyle(t);h&&(h._styleColorTheme.colorThemeOverride=s,h._reloadColorTheme())}_getTransitionParameters(t){return{now:r.q.now(),transition:r.h(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],s=[];for(const h of this._mergedOrder)this.isLayerDraped(this._mergedLayers[h])?t.push(h):s.push(h);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...s)}_createTerrain(t,s){const h=this.terrain=new Ue(t,s,this.scope,this.options,this.map.getWorldview());s===1&&(this.stylesheet.terrain=t),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}_force3DLayerUpdate(){for(const t in this._layers){const s=this._layers[t];s.type==="fill-extrusion"&&this._updateLayer(s)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const s=this._layers[t];s.type==="symbol"&&this._updateLayer(s)}}_validate(t,s,h,g,v={}){if(v&&v.validate===!1)return!1;const b=r.h({},this.serialize());return Ia(this,t.call(Ls,r.h({key:s,style:b,value:h,styleSpec:r.a5},g)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.df.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._mergedLayers)this._mergedLayers[t].setEventedParent(null);for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles(),this._mergedSourceCaches[t].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(t){const s=this.getSourceCaches(t);for(const h of s)h.clearTiles()}clearSources(){for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles()}reloadSource(t){const s=this.getSourceCaches(t);for(const h of s)h.resume(),h.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(t=>{t.modelManager.reloadModels(t.scope)})}updateSources(t){let s;this.directionalLight&&(s=lc(this.directionalLight));const h=new Set;for(const g in this._mergedLayers){const v=this._mergedLayers[g];v.hasElevation()&&!h.has(v.source)&&h.add(v.source)}for(const g in this._mergedSourceCaches){const v=this._mergedSourceCaches[g],b=h.has(v._source.id);v.update(t,void 0,void 0,s,b)}}_generateCollisionBoxes(){for(const t in this._sourceCaches){const s=this._sourceCaches[t];s.resume(),s.reload()}}_updatePlacement(t,s,h,g,v,b,E=!1){let I=!1,z=!1;const L={},N={};for(const F of this._mergedOrder){const q=this._mergedLayers[F];if(q.type!=="symbol")continue;const X=r.C(q.source,q.scope);let G=L[X];if(!G){const J=this.getLayerSourceCache(q);if(!J)continue;const re=J.getRenderableIds(!0).map(pe=>J.getTileByID(pe));N[X]=re.slice(),G=L[X]=re.sort((pe,_e)=>_e.tileID.overscaledZ-pe.tileID.overscaledZ||(pe.tileID.isLessThan(_e.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(q,G,s.center.lng,s.projection);I=I||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),E=E||this._layerOrderChanged||g===0,this._layerOrderChanged&&this.fire(new r.A("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.q.now(),s.zoom))&&(this.pauseablePlacement=new Id(s,this._mergedOrder,E,h,g,v,this.placement,this.fog&&s.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,L,N,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.q.now()),z=!0),I&&this.pauseablePlacement.placement.setStale()),z||I){this._buildingIndex.onNewFrame(s.zoom);for(let F=0;F<this._mergedOrder.length;F++){const q=this._mergedLayers[this._mergedOrder[F]];if(q.type!=="symbol")continue;const X=this.isLayerClipped(q);this.placement.updateLayerOpacities(q,L[r.C(q.source,q.scope)],F,X?b:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.q.now())}}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t,s){this._checkLoaded();const h=this.stylesheet.imports=this.stylesheet.imports||[];if(h.findIndex(({id:v})=>v===t.id)!==-1)return void this.fire(new r.z(new Error(`Import with id '${t.id}' already exists in the map's style.`)));if(!s)return h.push(t),this._loadImports([t],!0);const g=h.findIndex(({id:v})=>v===s);return g===-1&&this.fire(new r.z(new Error(`Import with id "${s}" does not exist on this map.`))),this.stylesheet.imports=h.slice(0,g).concat(t).concat(h.slice(g)),this._loadImports([t],!0,s)}updateImport(t,s){this._checkLoaded();const h=this.stylesheet.imports||[],g=this.getImportIndex(t);return g===-1?this:typeof s=="string"?(this.setImportUrl(t,s),this):(s.url&&s.url!==h[g].url&&this.setImportUrl(t,s.url),r.bv(s.config,h[g].config)||this.setImportConfig(t,s.config,s.data.schema),r.bv(s.data,h[g].data)||this.setImportData(t,s.data),this)}moveImport(t,s){this._checkLoaded();let h=this.stylesheet.imports||[];const g=this.getImportIndex(t);if(g===-1)return this;const v=this.getImportIndex(s);if(v===-1)return this;const b=h[g],E=this.fragments[g];return h=h.filter(({id:I})=>I!==t),this.fragments=this.fragments.filter(({id:I})=>I!==t),this.stylesheet.imports=h.slice(0,v).concat(b).concat(h.slice(v)),this.fragments=this.fragments.slice(0,v).concat(E).concat(this.fragments.slice(v)),this.mergeLayers(),this}setImportUrl(t,s){this._checkLoaded();const h=this.stylesheet.imports||[],g=this.getImportIndex(t);if(g===-1)return this;h[g].url=s;const v=this.fragments[g];return v.style=this._createFragmentStyle(h[g]),v.style.on("style.import.load",()=>this.mergeAll()),v.style.loadURL(s),this}setImportData(t,s){this._checkLoaded();const h=this.getImportIndex(t),g=this.stylesheet.imports||[];return h===-1?this:s?(this.fragments[h].style.setState(s),this._reloadImports(),this):(delete g[h].data,this.setImportUrl(t,g[h].url))}setImportConfig(t,s,h){this._checkLoaded();const g=this.getImportIndex(t),v=this.stylesheet.imports||[];if(g===-1)return this;s?v[g].config=s:delete v[g].config;const b=this.fragments[g];h&&b.style.stylesheet&&(b.style.stylesheet.schema=h);const E=b.style.stylesheet&&b.style.stylesheet.schema;return b.config=s,b.style.updateConfig(s,E),this.updateConfigDependencies(),this}removeImport(t){this._checkLoaded();const s=this.stylesheet.imports||[],h=this.getImportIndex(t);h!==-1&&(s.splice(h,1),this.fragments[h].style._remove(),this.fragments.splice(h,1),this._reloadImports())}getImportIndex(t){const s=(this.stylesheet.imports||[]).findIndex(h=>h.id===t);return s===-1&&this.fire(new r.z(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),s}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const s in this._mergedOtherSourceCaches){const h=this._mergedOtherSourceCaches[s];h&&t.push(h.getSource())}return t}getSource(t,s){const h=this.getSourceCache(t,s);return h&&h.getSource()}getLayerSource(t){const s=this.getLayerSourceCache(t);return s&&s.getSource()}getSourceCache(t,s){const h=r.C(t,s);return this._mergedOtherSourceCaches[h]}getLayerSourceCache(t){const s=r.C(t.source,t.scope);return t.type==="symbol"?this._mergedSymbolSourceCaches[s]:this._mergedOtherSourceCaches[s]}getSourceCaches(t){if(t==null)return Object.values(this._mergedSourceCaches);const s=[];return this._mergedOtherSourceCaches[t]&&s.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&s.push(this._mergedSymbolSourceCaches[t]),s}updateSourceCaches(){const t=this._changes.getUpdatedSourceCaches();for(const s in t){const h=t[s];h==="reload"?this.reloadSource(s):h==="clear"&&this.clearSource(s)}}updateLayers(t){const s=this._changes.getUpdatedPaintProperties();for(const h of s){const g=this.getLayer(h);g&&g.updateTransitions(t)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(t){this.stylesheet.glyphs=t,this.glyphManager.setURL(t,this.scope)}getImages(t,s,h){this.imageManager.getImages(s.images,s.scope,h),this._updateTilesForChangedImages();const g=b=>{if(b){const E=s.images.map(I=>r.I.toString(I));b.setDependencies(s.tileID.key,s.type,E)}},v=r.C(s.source,s.scope);g(this._mergedOtherSourceCaches[v]),g(this._mergedSymbolSourceCaches[v])}rasterizeImages(t,s,h){this.imageManager.rasterizeImages(s,h)}getGlyphs(t,s,h){this.glyphManager.getGlyphs(s.stacks,s.scope,h)}getResource(t,s,h){return r.dg(s,h)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const s=[];return this._otherSourceCaches[t]&&s.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&s.push(this._symbolSourceCaches[t]),s}_isSourceCacheLoaded(t){const s=this.getOwnSourceCaches(t);return s.length===0?(this.fire(new r.z(new Error(`There is no source with ID '${t}'`))),!1):s.every(h=>h.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(t,s){if(!this._clipLayerPresent&&t.type!=="fill-extrusion"&&t.type!=="building")return!1;const h=t.type==="fill-extrusion"&&t.sourceLayer==="building",g=t.type==="building";if(t.is3D(!!this.terrain)){if(h||g||s&&s.type==="batched-model"||t.type==="model")return!0}else if(t.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(t=>{t.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ao.getSourceType=function(u){return Sd[u]},ao.setSourceType=function(u,t){Sd[u]=t},ao.registerForPluginStateChange=r.dh;var jh=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,cc=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Nh=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Ga="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",uc=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Ld=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Wc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Ks=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Ou=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Kt=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Bu=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Zc=[];Bs(jh,Zc),Bs(Nh,Zc),Bs(cc,Zc);const Kc={"_prelude_fog.vertex.glsl":Ld,"_prelude_terrain.vertex.glsl":uc,"_prelude_shadow.vertex.glsl":Kt,"_prelude_fog.fragment.glsl":Wc,"_prelude_shadow.fragment.glsl":Bu,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Ks,"_prelude_raster_particle.glsl":Ou},Fu={};di("",uc),di(Wc,Ld),di(Bu,Kt),di(Ks,""),di(Ou,"");const ju=di(cc,Nh),Pa=jh;var Vh={background:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in highp vec3 v_normal;in highp float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 apply_lighting_linear(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec4 color=vec4(v_color.rgb,1.0);vec3 normal=normalize(v_normal);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,v_color.rgb,v_color.a);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_height));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_height);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3f;out vec4 v_color;out highp vec3 v_normal;out highp float v_height;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));vec3 pos=a_pos_3f;v_height=pos.z;gl_Position=u_matrix*vec4(pos,1.0);
#ifdef RENDER_SHADOWS
vec3 shadow_pos=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:di(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:di("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:di(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:di(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:di("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:di("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:di("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:di(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:di(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:di(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:di(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:di(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:di(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:di("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:di("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:di(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:di(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
#endif
}`),terrainRaster:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:di("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:di(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ga),skyboxGradient:di(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ga),skyboxCapture:di(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:di(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:di(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:di(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:di(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:di("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:di("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:di("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:di("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Bs(u,t){const s=u.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let h of s)if(h=h.trim(),h[0]==="#"&&h.includes("if")&&!h.includes("endif")){h=h.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const g=h.split(" ");for(const v of g)t.includes(v)||t.push(v)}}function di(u,t){const s=/#include\s+"([^"]+)"/g,h=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let g=t.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);g&&(g=g.map(z=>{const L=z.split(" ");return L[L.length-1]}),g=[...new Set(g)]);const v={},b=[],E=[];if(u=u.replace(s,(z,L)=>(E.push(L),"")),(t=t.replace(s,(z,L)=>(b.push(L),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let I=[...Zc];Bs(u,I),Bs(t,I);for(const z of[...b,...E])Kc[z]||console.error(`Undefined include: ${z}`),Fu[z]||(Fu[z]=[],Bs(Kc[z],Fu[z])),I=[...I,...Fu[z]];return{fragmentSource:u=u.replace(h,(z,L,N,F,q)=>(v[q]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${q}
in ${N} ${F} ${q};
#else
uniform ${N} ${F} u_${q};
#endif
`:L==="initialize"?`
#ifdef HAS_UNIFORM_u_${q}
    ${N} ${F} ${q} = u_${q};
#endif
`:L==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    in ${N} ${F} ${q};
#endif
`:L==="initialize-attribute"?"":void 0)),vertexSource:t=t.replace(h,(z,L,N,F,q)=>{const X=F==="float"?"vec2":F,G=q.match(/color/)?"color":X;return L==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${q}
in ${N} ${F} a_${q};
#endif
`:v[q]?L==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${N} ${X} a_${q};
out ${N} ${F} ${q};
#else
uniform ${N} ${F} u_${q};
#endif
`:L==="initialize"?G==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${N} ${F} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${G}(a_${q}, u_${q}_t);
#else
    ${N} ${F} ${q} = u_${q};
#endif
`:L==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    in ${N} ${F} a_${q};
    out ${N} ${F} ${q};
#endif
`:L==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    ${q} = a_${q};
#endif
`:void 0:L==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${N} ${X} a_${q};
#else
uniform ${N} ${F} u_${q};
#endif
`:L==="define-instanced"?G==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${q}0;
in vec4 a_${q}1;
in vec4 a_${q}2;
in vec4 a_${q}3;
#else
uniform ${N} ${F} u_${q};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${N} ${X} a_${q};
#else
uniform ${N} ${F} u_${q};
#endif
`:L==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    ${N} ${F} ${q} = a_${q};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${N} ${F} ${q} = a_${q};
#else
    ${N} ${F} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${N} ${F} ${q} = unpack_mix_${G}(a_${q}, u_${q}_t);
#else
    ${N} ${F} ${q} = u_${q};
#endif
`}),staticAttributes:g,usedDefines:I,vertexIncludes:b,fragmentIncludes:E}}class hc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,s,h,g,v,b,E,I){this.context=t;let z=this.boundPaintVertexBuffers.length!==g.length;for(let N=0;!z&&N<g.length;N++)this.boundPaintVertexBuffers[N]!==g[N]&&(z=!0);let L=this.boundDynamicVertexBuffers.length!==E.length;for(let N=0;!L&&N<E.length;N++)this.boundDynamicVertexBuffers[N]!==E[N]&&(L=!0);if(!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==h||z||L||this.boundIndexBuffer!==v||this.boundVertexOffset!==b)this.freshBind(s,h,g,v,b,E,I);else{t.bindVertexArrayOES.set(this.vao);for(const N of E)N&&(N.bind(),I&&N.instanceCount&&N.setVertexAttribDivisor(t.gl,s,I));v&&v.dynamicDraw&&v.bind()}}freshBind(t,s,h,g,v,b,E){const I=t.numAttributes,z=this.context,L=z.gl;this.vao&&this.destroy(),this.vao=z.gl.createVertexArray(),z.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=g,this.boundVertexOffset=v,this.boundDynamicVertexBuffers=b,s.enableAttributes(L,t),s.bind(),s.setVertexAttribPointers(L,t,v);for(const N of h)N.enableAttributes(L,t),N.bind(),N.setVertexAttribPointers(L,t,v);for(const N of b)N&&(N.enableAttributes(L,t),N.bind(),N.setVertexAttribPointers(L,t,v),E&&N.instanceCount&&N.setVertexAttribDivisor(L,t,E));g&&g.bind(),z.currentNumAttributes=I}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function $m(u,t){const s=Math.pow(2,t.canonical.z),h=t.canonical.y;return[new r.ac(0,h/s).toLngLat().lat,new r.ac(0,(h+1)/s).toLngLat().lat]}function Gm(u,t,s,h,g,v,b){const E=u.context,I=E.gl,z=s.hillshadeFBO;if(!z)return;u.prepareDrawTile();const L=u.isTileAffectedByFog(t),N=u.getOrCreateProgram("hillshade",{overrideFog:L});E.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,z.colorAttachment.get());const F=((Y,J,re,pe)=>{const _e=re.paint.get("hillshade-shadow-color"),Ae=re.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ie=re.paint.get("hillshade-highlight-color"),Te=re.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",ve=re.paint.get("hillshade-accent-color"),Pe=re.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Me=re.paint.get("hillshade-emissive-strength");let We=r.al(re.paint.get("hillshade-illumination-direction"));if(re.paint.get("hillshade-illumination-anchor")==="viewport")We-=Y.transform.angle;else if(Y.style&&Y.style.enable3dLights()&&Y.style.directionalLight){const ft=Y.style.directionalLight.properties.get("direction"),pt=r.cR(ft.x,ft.y,ft.z);We=r.al(pt[1])}const Qe=!Y.options.moving;return{u_matrix:pe||Y.transform.calculateProjMatrix(J.tileID.toUnwrapped(),Qe),u_image:0,u_latrange:$m(0,J.tileID),u_light:[re.paint.get("hillshade-exaggeration"),We],u_shadow:_e.toPremultipliedRenderColor(Ae?null:re.lut),u_highlight:Ie.toPremultipliedRenderColor(Te?null:re.lut),u_emissive_strength:Me,u_accent:ve.toPremultipliedRenderColor(Pe?null:re.lut)}})(u,s,h,u.terrain?t.projMatrix:null);u.uploadCommonUniforms(E,N,t.toUnwrapped());const{tileBoundsBuffer:q,tileBoundsIndexBuffer:X,tileBoundsSegments:G}=u.getTileBoundsBuffers(s);N.draw(u,I.TRIANGLES,g,v,b,Sn.disabled,F,h.id,q,X,G)}function dc(u,t,s){if(!t.needsDEMTextureUpload)return;const h=u.context,g=h.gl;h.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||u.getTileTexture(s.stride);const v=s.getPixels();t.demTexture?t.demTexture.update(v,{premultiply:!1}):t.demTexture=new r.T(h,v,g.R32F,{premultiply:!1}),t.needsDEMTextureUpload=!1}function Wm(u,t,s){const h=u.context,g=h.gl;if(!t.dem)return;const v=t.dem;if(h.activeTexture.set(g.TEXTURE1),dc(u,t,v),!t.demTexture)return;t.demTexture.bind(g.NEAREST,g.CLAMP_TO_EDGE);const b=v.dim;h.activeTexture.set(g.TEXTURE0);let E=t.hillshadeFBO;if(!E){const F=new r.T(h,{width:b,height:b,data:null},g.RGBA8);F.bind(g.LINEAR,g.CLAMP_TO_EDGE),E=t.hillshadeFBO=h.createFramebuffer(b,b,!0,"renderbuffer"),E.colorAttachment.set(F.texture)}h.bindFramebuffer.set(E.framebuffer),h.viewport.set([0,0,b,b]);const{tileBoundsBuffer:I,tileBoundsIndexBuffer:z,tileBoundsSegments:L}=u.getMercatorTileBoundsBuffers(),N=[];u.linearFloatFilteringSupported()&&N.push("TERRAIN_DEM_FLOAT_FORMAT"),u.getOrCreateProgram("hillshadePrepare",{defines:N}).draw(u,g.TRIANGLES,sn.disabled,In.disabled,ii.unblended,Sn.disabled,((F,q)=>{const X=q.stride,G=r.bz();return r.c5(G,0,r.aj,-8192,0,0,1),r.bo(G,G,[0,-8192,0]),{u_matrix:G,u_image:1,u_dimension:[X,X],u_zoom:F.overscaledZ}})(t.tileID,v),s.id,I,z,L),t.needsHillshadePrepare=!1}class Cr{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Lp extends Cr{getDefault(){return r.am.transparent.toNonPremultipliedRenderColor(null)}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Zr extends Cr{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Dp extends Cr{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Dd extends Cr{getDefault(){return[!0,!0,!0,!0]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class qh extends Cr{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Lf extends Cr{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Od extends Cr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const s=this.current;(t.func!==s.func||t.ref!==s.ref||t.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Hh extends Cr{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Xc extends Cr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=t,this.dirty=!1}}class Nu extends Cr{getDefault(){return[0,1]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Op extends Cr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=t,this.dirty=!1}}class Bp extends Cr{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Bd extends Cr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.BLEND):s.disable(s.BLEND),this.current=t,this.dirty=!1}}class Fd extends Cr{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Wa extends Cr{getDefault(){return r.am.transparent.toNonPremultipliedRenderColor(null)}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class El extends Cr{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class Vu extends Cr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=t,this.dirty=!1}}class qu extends Cr{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class pc extends Cr{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let jd=class extends Cr{getDefault(){return null}set(u){(u!==this.current||this.dirty)&&(this.gl.useProgram(u),this.current=u,this.dirty=!1)}};class Fp extends Cr{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class jp extends Cr{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Hu extends Cr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Nd extends Cr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Uu extends Cr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Za extends Cr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Uh extends Cr{getDefault(){return null}set(t){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ka extends Cr{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class ka extends Cr{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class $u extends Cr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Xa extends Cr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Ya extends Cr{constructor(t,s){super(t),this.context=t,this.parent=s}getDefault(){return null}}class Df extends Ya{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Of extends Ya{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,this.attachment(),s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Yc extends Ya{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,this.attachment(),s.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class $h extends Of{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const fc=(u,t,s)=>({u_matrix:u,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:s}),Qc=(u,t,s,h,g,v,b,E,I,z,L,N,F,q,X,G)=>({u_proj_matrix:Float32Array.from(u),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(h),u_merc_matrix:s,u_zoom_transition:g,u_merc_center:v,u_image0:0,u_frustum_tl:b,u_frustum_tr:E,u_frustum_br:I,u_frustum_bl:z,u_globe_pos:L,u_globe_radius:N,u_viewport:F,u_grid_matrix:G?Float32Array.from(G):new Float32Array(9),u_skirt_height:q,u_far_z_cutoff:X});function Gu(u,t){return u!=null&&t!=null&&!(!u.hasData()||!t.hasData())&&u.demTexture!=null&&t.demTexture!=null&&u.tileID.key!==t.tileID.key}const oa=new class{constructor(){this.operations={}}newMorphing(u,t,s,h,g){if(u in this.operations){const v=this.operations[u];v.to.tileID.key!==s.tileID.key&&(v.queued=s)}else this.operations[u]={startTime:h,phase:0,duration:g,from:t,to:s,queued:null}}getMorphValuesForProxy(u){if(!(u in this.operations))return null;const t=this.operations[u];return{from:t.from,to:t.to,phase:t.phase}}update(u){for(const t in this.operations){const s=this.operations[t];for(s.phase=(u-s.startTime)/s.duration;s.phase>=1||!this._validOp(s);)if(!this._nextOp(s,u)){delete this.operations[t];break}}}_nextOp(u,t){return!!u.queued&&(u.from=u.to,u.to=u.queued,u.queued=null,u.phase=0,u.startTime=t,!0)}_validOp(u){return u.from.hasData()&&u.to.hasData()}},Qa={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Kr(u,t,s){if(t===0)return 0;const h=t<1&&s===514?.25/t:1;return 6*Math.pow(1.5,22-u)*Math.max(t,1)*h}function es(u,t){const s=1<<u.z;return!t&&(u.x===0||u.x===s-1)||u.y===0||u.y===s-1}const Go=u=>({u_matrix:u});function fs(u,t,s,h,g){if(g>0){const v=r.q.now(),b=(v-u.timeAdded)/g,E=t?(v-t.timeAdded)/g:-1,I=s.getSource(),z=h.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),L=!t||Math.abs(t.tileID.overscaledZ-z)>Math.abs(u.tileID.overscaledZ-z),N=L&&u.refreshedUponExpiration?1:r.ay(L?b:1-E,0,1);return u.refreshedUponExpiration&&b>=1&&(u.refreshedUponExpiration=!1),t?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}class ko extends Zs{constructor(t){const s={type:"raster-dem",maxzoom:t.transform.maxZoom},h=new r.D(r.c$(),null),g=Yl("mock-dem",s,h,t.style);super("mock-dem",g,!1),g.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,s){t.state="loaded",s(null)}}class Fs extends Zs{constructor(t){const s=Yl("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new r.D(r.c$(),null),t.style);super("proxy",s,!1),s.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,s,h){if(t.freezeTileCoverage)return;this.transform=t;const g=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((v,b)=>{if(v[b.key]="",!this._tiles[b.key]){const E=new ec(b,this._source.tileSize*b.overscaleFactor(),t.tileZoom,void 0,void 0,this._source.worldview);E.state="loaded",this._tiles[b.key]=E}return v},{});for(const v in this._tiles)v in g||(this.freeFBO(v),this._tiles[v].unloadVectorData(),delete this._tiles[v])}freeFBO(t){const s=this.proxyCachedFBO[t];if(s!==void 0){const h=Object.values(s);this.renderCachePool.push(...h),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Al extends r.aM{constructor(t,s,h){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=s,this.projMatrix=h}}class Xs extends r.dt{constructor(t,s){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},t.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),t.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),t.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[h,g,v]=function(I){const z=new r.ba,L=new r.a_,N=131;z.reserve(17161),L.reserve(33800);const F=r.aj/128,q=r.aj+F/2,X=q+F;for(let Y=-64;Y<X;Y+=F)for(let J=-64;J<X;J+=F){const re=J<0||J>q||Y<0||Y>q?24575:0,pe=r.ay(Math.round(J),0,r.aj),_e=r.ay(Math.round(Y),0,r.aj);z.emplaceBack(pe+re,_e)}const G=(Y,J)=>{const re=J*N+Y;L.emplaceBack(re+1,re,re+N),L.emplaceBack(re+N,re+N+1,re+1)};for(let Y=1;Y<129;Y++)for(let J=1;J<129;J++)G(J,Y);return[0,129].forEach(Y=>{for(let J=0;J<130;J++)G(J,Y),G(Y,J)}),[z,L,32768]}(),b=t.context;this.gridBuffer=b.createVertexBuffer(h,r.bc.members),this.gridIndexBuffer=b.createIndexBuffer(g),this.gridSegments=r.bd.simpleSegment(0,0,h.length,g.length),this.gridNoSkirtSegments=r.bd.simpleSegment(0,0,h.length,v),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Fs(s.map),this.orthoMatrix=r.bz(),r.c5(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.aj,0,r.aj,0,1);const E=b.gl;this._overlapStencilMode=new In({func:E.GEQUAL,mask:255},0,255,E.KEEP,E.KEEP,E.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=s,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ko(s.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,s,h){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const g=t.terrain.properties,v=t.terrain.drapeRenderMode===0,b=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=r.q.now();const E=t.terrain&&t.terrain.scope,I=g.get("source"),z=v?this._mockSourceCache:t.getSourceCache(I,E);if(!z)return void r.w(`Couldn't find terrain source "${I}".`);if(this.sourceCache=z,this._attenuationRange=t.terrain.getAttenuationRange(),this._exaggeration=b?this.calculateExaggeration(s):g.get("exaggeration"),!s.projection.requiresDraping&&b&&this._exaggeration===0)return void this._disable();this.enabled=!0;const L=()=>{this.sourceCache.used&&r.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const N=this.getScaledDemTileSize();this.sourceCache.update(s,N,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,L(),this._initializing=!0),L(),s.updateElevation(!0,h),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(s),this._emptyDEMTextureDirty=!0,this._previousZoom=s.zoom}else this._disable()}calculateExaggeration(t){if(this._attenuationRange&&t.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(t.zoom);const s=this._previousCameraAltitude,h=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=h;const g=s!=null?h-s:Number.MAX_VALUE;if(Math.abs(g)<2)return this._exaggeration;const v=t.zoom,b=this._style.terrain;if(!this._previousUpdateTimestamp)return b.getExaggeration(v);let E=v-this._previousZoom;const I=this._previousUpdateTimestamp;let z=v;this._evaluationZoom!=null&&(z=this._evaluationZoom,Math.abs(v-z)>.5&&(E=.5*(v-z+E)),E*g<0&&(z+=E)),this._evaluationZoom=z;const L=b.getExaggeration(z),N=L===b.getExaggeration(Math.max(0,z-.1));if(N&&Math.abs(L-this._exaggeration)<.01)return L;let F=Math.min(.1,.00375*(this._updateTimestamp-I));return(N||L<.1||Math.abs(E)<1e-4)&&(F=Math.min(.2,4*F)),r.ai(this._exaggeration,L,F)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const s=this.proxySourceCache,h=this.painter.transform;this._initializing&&(this._initializing=h._centerAltitude===0&&this.getAtPointOrZero(r.ac.fromLngLat(h.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const g=this.proxyCoords=s.getIds().map(I=>{const z=s.getTileByID(I).tileID;return z.projMatrix=h.calculateProjMatrix(z.toUnwrapped()),z});(function(I,z){const L=z.transform.pointCoordinate(z.transform.getCameraPoint()),N=new r.P(L.x,L.y);I.sort((F,q)=>{if(q.overscaledZ-F.overscaledZ)return q.overscaledZ-F.overscaledZ;const X=new r.P(F.canonical.x+(1<<F.canonical.z)*F.wrap,F.canonical.y),G=new r.P(q.canonical.x+(1<<q.canonical.z)*q.wrap,q.canonical.y),Y=N.mult(1<<F.canonical.z);return Y.x-=.5,Y.y-=.5,Y.distSqr(X)-Y.distSqr(G)})})(g,this.painter);const v=this.proxyToSource||{};this.proxyToSource={},g.forEach(I=>{this.proxyToSource[I.key]={}}),this.terrainTileForTile={};const b=this._style._mergedSourceCaches;for(const I in b){const z=b[I];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,t[I],v),z.usedForTerrain))continue;const L=t[I];z.getSource().reparseOverscaled&&this._assignTerrainTiles(L)}this.proxiedCoords[s.id]=g.map(I=>new Al(I,I.key,this.orthoMatrix)),this._assignTerrainTiles(g),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(v),this.renderingToTexture=!1;const E={};this._visibleDemTiles=[];for(const I of this.proxyCoords){const z=this.terrainTileForTile[I.key];if(!z)continue;const L=z.tileID.key;L in E||(this._visibleDemTiles.push(z),E[L]=L)}}_assignTerrainTiles(t){this._initializing||t.forEach(s=>{if(this.terrainTileForTile[s.key])return;const h=this._findTileCoveringTileID(s,this.sourceCache);h&&(this.terrainTileForTile[s.key]=h)})}_prepareDEMTextures(){const t=this.painter.context,s=t.gl;for(const h in this.terrainTileForTile){const g=this.terrainTileForTile[h],v=g.dem;!v||g.demTexture&&!g.needsDEMTextureUpload||(t.activeTexture.set(s.TEXTURE1),dc(this.painter,g,v))}}_prepareDemTileUniforms(t,s,h,g){if(!s||s.demTexture==null)return!1;const v=t.tileID.canonical,b=Math.pow(2,s.tileID.canonical.z-v.z),E=g||"";return h[`u_dem_tl${E}`]=[v.x*b%1,v.y*b%1],h[`u_dem_scale${E}`]=b,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let t=0;const s=this._visibleDemTiles.reduce((h,g)=>{if(!g.dem)return h;const v=g.dem.tree.minimums[0];return v>0&&t++,h+v},0);return t?s/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,s=t.gl;t.activeTexture.set(s.TEXTURE2);const h=this._getLoadedAreaMinimum(),g=new r.du({width:1,height:1},new Float32Array([h]));this._emptyDEMTextureDirty=!1;let v=this._emptyDEMTexture;return v?v.update(g,{premultiply:!1}):v=this._emptyDEMTexture=new r.T(t,g,s.R32F,{premultiply:!1}),v}setupElevationDraw(t,s,h){const g=this.painter.context,v=g.gl,b={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};b.u_exaggeration=this.exaggeration();let E=null,I=null,z=1;if(h&&h.morphing&&this._useVertexMorphing){const q=h.morphing.srcDemTile,X=h.morphing.dstDemTile;z=h.morphing.phase,q&&X&&(this._prepareDemTileUniforms(t,q,b,"_prev")&&(I=q),this._prepareDemTileUniforms(t,X,b)&&(E=X))}const L=q=>q&&q.demTexture&&this.painter.linearFloatFilteringSupported()?v.LINEAR:v.NEAREST;let N=null;var F;if(this.enabled?I&&E?(N=E.demTexture,g.activeTexture.set(v.TEXTURE4),I.demTexture.bind(L(I),v.CLAMP_TO_EDGE),b.u_dem_lerp=z):(E=this.terrainTileForTile[t.tileID.key],N=this._prepareDemTileUniforms(t,E,b)?E.demTexture:this.emptyDEMTexture):N=this.emptyDEMTexture,g.activeTexture.set(v.TEXTURE2),N&&(b.u_dem_size=(F=N).size[0]===1?1:F.size[0]-2,N.bind(L(E),v.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(h&&h.useDepthForOcclusion,s,b),h&&h.useMeterToDem&&E){const q=(1<<E.tileID.canonical.z)*r.c6(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;b.u_meter_to_dem=q}if(h&&h.labelPlaneMatrixInv&&(b.u_label_plane_matrix_inv=h.labelPlaneMatrixInv),s.setTerrainUniformValues(g,b),this.painter.transform.projection.name==="globe"){const q=this.globeUniformValues(this.painter.transform,t.tileID.canonical,h&&h.useDenormalizedUpVectorScale);s.setGlobeUniformValues(g,q)}}globeUniformValues(t,s,h){const g=t.projection;return{u_tile_tl_up:g.upVector(s,0,0),u_tile_tr_up:g.upVector(s,r.aj,0),u_tile_br_up:g.upVector(s,r.aj,r.aj),u_tile_bl_up:g.upVector(s,0,r.aj),u_tile_up_scale:h?r.dv(1):g.upVectorScale(s,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const s=this.painter,h=this.painter.context;t.length!==0&&(h.bindFramebuffer.set(null),h.viewport.set([0,0,s.width,s.height]),s.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(g,v,b,E,I){if(g.transform.projection.name==="globe")(function(z,L,N,F,q){const X=z.context,G=X.gl;let Y,J;const re=z.transform,pe=r.dl(z,X,re),_e=(ft,pt)=>{if(J===pt)return;const Et=[Qa[pt],"PROJECTION_GLOBE_VIEW"];pe&&Et.push("CUSTOM_ANTIALIASING");const Ke=z.isTileAffectedByFog(ft);Y=z.getOrCreateProgram("globeRaster",{defines:Et,overrideFog:Ke}),J=pt},Ae=z.colorModeForRenderPass(),Ie=new sn(G.LEQUAL,sn.ReadWrite,z.depthRangeFor3D);oa.update(q);const Te=r.dm(re),ve=[r.aD(re.center.lng),r.aH(re.center.lat)],Pe=z.globeSharedBuffers,Me=[re.width*r.q.devicePixelRatio,re.height*r.q.devicePixelRatio],We=Float32Array.from(re.globeMatrix),Qe={useDenormalizedUpVectorScale:!0};{const ft=z.transform,pt=Kr(ft.zoom,L.exaggeration(),L.sourceCache._source.tileSize);J=-1;const Et=G.TRIANGLES;for(const Ke of F){const st=N.getTile(Ke),Ve=In.disabled,_t=L.prevTerrainTileForTile[Ke.key],nt=L.terrainTileForTile[Ke.key];Gu(_t,nt)&&oa.newMorphing(Ke.key,_t,nt,q,250),X.activeTexture.set(G.TEXTURE0),st.texture&&st.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const Tt=oa.getMorphValuesForProxy(Ke.key),jt=Tt?1:0;Tt&&r.L(Qe,{morphing:{srcDemTile:Tt.from,dstDemTile:Tt.to,phase:r.dk(Tt.phase)}});const yt=r.dn(Ke.canonical),Lt=r.dp(yt.getCenter().lat),Yt=r.dq(Ke.canonical,yt,Lt,ft.worldSize/ft._pixelsPerMercatorPixel),tn=r.bh(r.dr(Ke.canonical)),Xt=Qc(ft.expandedFarZProjMatrix,We,Te,tn,r.ah(ft.zoom),ve,ft.frustumCorners.TL,ft.frustumCorners.TR,ft.frustumCorners.BR,ft.frustumCorners.BL,ft.globeCenterInViewSpace,ft.globeRadius,Me,pt,ft._farZ,Yt);if(_e(Ke,jt),Y&&(L.setupElevationDraw(st,Y,Qe),z.uploadCommonUniforms(X,Y,Ke.toUnwrapped()),Pe)){const[rn,fn,_n]=Pe.getGridBuffers(Lt,pt!==0);Y.draw(z,Et,Ie,Ve,Ae,Sn.backCCW,Xt,"globe_raster",rn,fn,_n)}}}if(Pe&&(z.renderDefaultNorthPole||z.renderDefaultSouthPole)){const ft=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];pe&&ft.push("CUSTOM_ANTIALIASING"),Y=z.getOrCreateProgram("globeRaster",{defines:ft});for(const pt of F){const{x:Et,y:Ke,z:st}=pt.canonical,Ve=Ke===0,_t=Ke===(1<<st)-1,[nt,Tt,jt,yt]=Pe.getPoleBuffers(st,!1);if(yt&&(Ve||_t)){const Lt=N.getTile(pt);X.activeTexture.set(G.TEXTURE0),Lt.texture&&Lt.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);let Yt=r.ds(st,Et,re);const tn=r.bh(r.dr(pt.canonical)),Xt=(rn,fn)=>rn.draw(z,G.TRIANGLES,Ie,In.disabled,Ae,Sn.disabled,Qc(re.expandedFarZProjMatrix,Yt,Yt,tn,0,ve,re.frustumCorners.TL,re.frustumCorners.TR,re.frustumCorners.BR,re.frustumCorners.BL,re.globeCenterInViewSpace,re.globeRadius,Me,0,re._farZ),"globe_pole_raster",fn,jt,yt);L.setupElevationDraw(Lt,Y,Qe),z.uploadCommonUniforms(X,Y,pt.toUnwrapped()),Ve&&z.renderDefaultNorthPole&&Xt(Y,nt),_t&&z.renderDefaultSouthPole&&(Yt=r.cE(r.bz(),Yt,[1,-1,1]),Xt(Y,Tt))}}}})(g,v,b,E,I);else{const z=g.context,L=z.gl;let N,F;const q=g.shadowRenderer,X=$o(g,g.longestCutoffRange),G=Ae=>{if(F===Ae)return;const Ie=[];Ie.push(Qa[Ae]),X.shouldRenderCutoff&&Ie.push("RENDER_CUTOFF"),q&&(Ie.push("RENDER_SHADOWS","DEPTH_TEXTURE"),q.useNormalOffset&&Ie.push("NORMAL_OFFSET")),N=g.getOrCreateProgram("terrainRaster",{defines:Ie}),F=Ae},Y=g.colorModeForRenderPass(),J=new sn(L.LEQUAL,sn.ReadWrite,g.depthRangeFor3D);oa.update(I);const re=g.transform,pe=Kr(re.zoom,v.exaggeration(),v.sourceCache._source.tileSize);let _e=[0,0,0];if(q){const Ae=g.style.directionalLight,Ie=g.style.ambientLight;Ae&&Ie&&(_e=Sl(g.style,Ae,Ie))}{F=-1;const Ae=L.TRIANGLES,[Ie,Te]=[v.gridIndexBuffer,v.gridSegments];for(const ve of E){const Pe=b.getTile(ve),Me=In.disabled,We=v.prevTerrainTileForTile[ve.key],Qe=v.terrainTileForTile[ve.key];Gu(We,Qe)&&oa.newMorphing(ve.key,We,Qe,I,250),z.activeTexture.set(L.TEXTURE0),Pe.texture&&Pe.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE);const ft=oa.getMorphValuesForProxy(ve.key),pt=ft?1:0;let Et;ft&&(Et={morphing:{srcDemTile:ft.from,dstDemTile:ft.to,phase:r.dk(ft.phase)}});const Ke=fc(ve.projMatrix,es(ve.canonical,re.renderWorldCopies)?pe/10:pe,_e);if(G(pt),!N)continue;v.setupElevationDraw(Pe,N,Et);const st=ve.toUnwrapped();q&&q.setupShadows(st,N),g.uploadCommonUniforms(z,N,st,null,X),N.draw(g,Ae,J,Me,Y,Sn.backCCW,Ke,"terrain_raster",v.gridBuffer,Ie,Te)}}}}(s,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,s.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const s=this.painter,h=this.painter.context,g=this.proxySourceCache,v=this.proxiedCoords[g.id],b=this._drapedRenderBatches.shift(),E=s.style.order,I=[];let z=0;for(const L of v){const N=g.getTileByID(L.proxyTileKey),F=g.proxyCachedFBO[L.key]?g.proxyCachedFBO[L.key][t]:void 0,q=F!==void 0?g.renderCache[F]:this.pool[z++],X=F!==void 0;if(N.texture=q.tex,X&&!q.dirty){I.push(N.tileID);continue}let G;h.bindFramebuffer.set(q.fb.framebuffer),this.renderedToTile=!1,q.dirty&&(h.clear({color:r.am.transparent,stencil:0}),q.dirty=!1);for(let Y=b.start;Y<=b.end;++Y){const J=s.style._mergedLayers[E[Y]];if(J.isHidden(s.transform.zoom))continue;const re=s.style.getLayerSourceCache(J),pe=re?this.proxyToSource[L.key][re.id]:[L];if(!pe)continue;const _e=pe;h.viewport.set([0,0,q.fb.width,q.fb.height]),G!==(re?re.id:null)&&(this._setupStencil(q,pe,J,re),G=re?re.id:null),s.renderLayer(s,re,J,_e)}if(this._drapedRenderBatches.length===0)for(const Y of this._pendingGroundEffectLayers){const J=s.style._mergedLayers[E[Y]];if(J.isHidden(s.transform.zoom))continue;const re=s.style.getLayerSourceCache(J),pe=re?this.proxyToSource[L.key][re.id]:[L];if(!pe)continue;const _e=pe;h.viewport.set([0,0,q.fb.width,q.fb.height]),G!==(re?re.id:null)&&(this._setupStencil(q,pe,J,re),G=re?re.id:null),s.renderLayer(s,re,J,_e)}this.renderedToTile?(q.dirty=!0,I.push(N.tileID)):X||--z,z===5&&(z=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,h.bindFramebuffer.set(null),h.viewport.set([0,0,s.width,s.height]),b.end+1}postRender(){}isLayerOrderingCorrect(t){const s=t.order.length;let h=-1,g=s;for(let v=0;v<s;++v)this._style.isLayerDraped(t._mergedLayers[t.order[v]])?h=Math.max(h,v):g=Math.min(g,v);return g>h}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(s=>s.dem).forEach(s=>{t=Math.min(t,s.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,s,h){if(!this._visibleDemTiles)return null;const g=this._visibleDemTiles.filter(v=>v.dem).map(v=>{const b=v.tileID,E=1<<b.overscaledZ,{x:I,y:z}=b.canonical,L=I/E,N=(I+1)/E,F=z/E,q=(z+1)/E;return{minx:L,miny:F,maxx:N,maxy:q,t:v.dem.tree.raycastRoot(L,F,N,q,t,s,h),tile:v}});g.sort((v,b)=>(v.t!==null?v.t:Number.MAX_VALUE)-(b.t!==null?b.t:Number.MAX_VALUE));for(const v of g){if(v.t==null)return null;const b=v.tile.dem.tree.raycast(v.minx,v.miny,v.maxx,v.maxy,t,s,h);if(b!=null)return b}return null}_createFBO(){const t=this.painter.context,s=t.gl,h=this.drapeBufferSize;t.activeTexture.set(s.TEXTURE0);const g=new r.T(t,{width:h[0],height:h[1],data:null},s.RGBA8);g.bind(s.LINEAR,s.CLAMP_TO_EDGE);const v=t.createFramebuffer(h[0],h[1],!0,null);return v.colorAttachment.set(g.texture),v.depthAttachment=new $h(t,v.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,h[0],h[1]),this._stencilRef=0,v.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):v.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:v,tex:g,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const s=this._style._mergedLayers[t],h=s.isHidden(this.painter.transform.zoom);return s.type==="hillshade"||s.type==="custom"?!h&&s.shouldRedrape():!h&&s.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const h of this._style.getSources())if(h instanceof Ao){t=!0;break}if(!t)return;const s={};for(let h=0;h<this._style.order.length;++h){const g=this._style._mergedLayers[this._style.order[h]],v=this._style.getLayerSourceCache(g);if(v&&!s[v.id]&&!g.isHidden(this.painter.transform.zoom)&&g.type==="line"&&g.widthExpression()instanceof r.ab){s[v.id]=!0;for(const b of this.proxyCoords){const E=this.proxyToSource[b.key][v.id];if(E)for(const I of E)this._clearRenderCacheForTile(v.id,I)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const h in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[h]._source instanceof Ds){t=!0;break}if(!t)return;const s={};for(let h=0;h<this._style.order.length;++h){const g=this._style._mergedLayers[this._style.order[h]],v=this._style.getLayerSourceCache(g);if(!v||s[v.id]||g.isHidden(this.painter.transform.zoom)||g.type!=="raster")continue;const b=g.paint.get("raster-fade-duration");for(const E of this.proxyCoords){const I=this.proxyToSource[E.key][v.id];if(I)for(const z of I){const L=fs(v.getTile(z),v.findLoadedParent(z,0),v,this.painter.transform,b);(L.opacity!==1||L.mix!==0)&&this._clearRenderCacheForTile(v.id,z)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const t=this._style.order,s=t.length;if(s===0)return;const h=[];this._pendingGroundEffectLayers=[];let g,v=0,b=this._style._mergedLayers[t[v]];for(;!this._style.isLayerDraped(b)&&b.isHidden(this.painter.transform.zoom)&&++v<s;)b=this._style._mergedLayers[t[v]];for(;v<s;++v){const E=this._style._mergedLayers[t[v]];E.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(E)?g===void 0&&(g=v):(E.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(v),g!==void 0&&(h.push({start:g,end:v-1}),g=void 0)))}if(g!==void 0&&h.push({start:g,end:v-1}),h.length!==0){const E=h[h.length-1];this._pendingGroundEffectLayers.every(I=>I>E.end)||r.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=h}_setupRenderCache(t){const s=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,s.renderCache.length>s.renderCachePool.length){const b=Object.values(s.proxyCachedFBO);s.proxyCachedFBO={};for(let E=0;E<b.length;++E){const I=Object.values(b[E]);s.renderCachePool.push(...I)}}return}this._clearRasterLayersFromRenderCache();const h=this.proxyCoords,g=this._tilesDirty;for(let b=h.length-1;b>=0;b--){const E=h[b];if(s.getTileByID(E.key),s.proxyCachedFBO[E.key]!==void 0){const I=t[E.key],z=this.proxyToSource[E.key];let L=0;for(const N in z){const F=z[N],q=I[N];if(!q||q.length!==F.length||F.some((X,G)=>X!==q[G]||g[N]&&g[N].hasOwnProperty(X.key))){L=-1;break}++L}for(const N in s.proxyCachedFBO[E.key])s.renderCache[s.proxyCachedFBO[E.key][N]].dirty=L<0||L!==Object.values(I).length}}const v=[...this._drapedRenderBatches];v.sort((b,E)=>E.end-E.start-(b.end-b.start));for(const b of v)for(const E of h){if(s.proxyCachedFBO[E.key])continue;let I=s.renderCachePool.pop();I===void 0&&s.renderCache.length<50&&(I=s.renderCache.length,s.renderCache.push(this._createFBO())),I!==void 0&&(s.proxyCachedFBO[E.key]={},s.proxyCachedFBO[E.key][b.start]=I,s.renderCache[I].dirty=!0)}this._tilesDirty={}}_setupStencil(t,s,h,g){if(!g||!this._sourceTilesOverlap[g.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const v=this.painter.context,b=v.gl;if(s.length<=1)return void(this._overlapStencilType=!1);let E;if(h.isTileClipped())E=s.length,this._overlapStencilMode.test={func:b.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(s[0].overscaledZ>s[s.length-1].overscaledZ))return void(this._overlapStencilType=!1);E=1,this._overlapStencilMode.test={func:b.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+E>255&&(v.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=E,this._overlapStencilMode.ref=this._stencilRef,h.isTileClipped()&&this._renderTileClippingMasks(s,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):In.disabled}_renderTileClippingMasks(t,s){const h=this.painter,g=this.painter.context,v=g.gl;h._tileClippingMaskIDs={},g.setColorMode(ii.disabled),g.setDepthMode(sn.disabled);const b=h.getOrCreateProgram("clippingMask");for(const E of t){const I=h._tileClippingMaskIDs[E.key]=--s;b.draw(h,v.TRIANGLES,sn.disabled,new In({func:v.ALWAYS,mask:0},I,255,v.KEEP,v.KEEP,v.REPLACE),ii.disabled,Sn.disabled,Go(E.projMatrix),"$clipping",h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}}pointCoordinate(t){const s=this.painter.transform;if(t.x<0||t.x>s.width||t.y<0||t.y>s.height)return null;const h=[t.x,t.y,1,1];r.aA(h,h,s.pixelMatrixInverse),r.cw(h,h,1/h[3]),h[0]/=s.worldSize,h[1]/=s.worldSize;const g=s._camera.position,v=r.c6(1,s.center.lat),b=[g[0],g[1],g[2]/v,0],E=r.cX([],h.slice(0,3),b);r.au(E,E);const I=this.raycast(b,E,this._exaggeration);return I!==null&&I?(r.bE(b,b,E,I),b[3]=b[2],b[2]*=v,b):null}_setupProxiedCoordsForOrtho(t,s,h){if(t.getSource()instanceof r.aP)return this._setupProxiedCoordsForImageSource(t,s,h);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const g=this.proxiedCoords[t.id]=[],v=this.proxyCoords;for(let I=0;I<v.length;I++){const z=v[I],L=this._findTileCoveringTileID(z,t);if(L){const N=this._createProxiedId(z,L,h[z.key]&&h[z.key][t.id]);g.push(N),this.proxyToSource[z.key][t.id]=[N]}}let b=!1;const E=new Set;for(let I=0;I<s.length;I++){const z=t.getTile(s[I]);if(!z||!z.hasData())continue;const L=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if(L&&L.tileID.canonical.z!==z.tileID.canonical.z){const N=this.proxyToSource[L.tileID.key][t.id],F=this._createProxiedId(L.tileID,z,h[L.tileID.key]&&h[L.tileID.key][t.id]);N?N.splice(N.length-1,0,F):this.proxyToSource[L.tileID.key][t.id]=[F];const q=this.proxyToSource[L.tileID.key][t.id];E.has(q)||E.add(q),g.push(F),b=!0}}if(this._sourceTilesOverlap[t.id]=b,b&&this._debugParams.sortTilesHiZFirst)for(const I of E)I.sort((z,L)=>L.overscaledZ-z.overscaledZ)}_setupProxiedCoordsForImageSource(t,s,h){if(!t.getSource().loaded())return;const g=this.proxiedCoords[t.id]=[],v=this.proxyCoords,b=t.getSource(),E=b.tileID;if(!E)return;const I=new r.P(E.x,E.y)._div(1<<E.z),z=b.coordinates.map(r.ac.fromLngLat).reduce((N,F)=>(N.min.x=Math.min(N.min.x,F.x-I.x),N.min.y=Math.min(N.min.y,F.y-I.y),N.max.x=Math.max(N.max.x,F.x-I.x),N.max.y=Math.max(N.max.y,F.y-I.y),N),{min:new r.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),L=(N,F)=>{const q=N.wrap+N.canonical.x/(1<<N.canonical.z),X=N.canonical.y/(1<<N.canonical.z),G=r.aj/(1<<N.canonical.z),Y=F.wrap+F.canonical.x/(1<<F.canonical.z),J=F.canonical.y/(1<<F.canonical.z);return q+G<Y+z.min.x||q>Y+z.max.x||X+G<J+z.min.y||X>J+z.max.y};for(let N=0;N<v.length;N++){const F=v[N];for(let q=0;q<s.length;q++){const X=t.getTile(s[q]);if(!X||!X.hasData()||L(F,X.tileID))continue;const G=this._createProxiedId(F,X,h[F.key]&&h[F.key][t.id]),Y=this.proxyToSource[F.key][t.id];Y?Y.push(G):this.proxyToSource[F.key][t.id]=[G],g.push(G)}}}_createProxiedId(t,s,h){let g=this.orthoMatrix;if(h){const v=h.find(b=>b.key===s.tileID.key);if(v)return v}if(s.tileID.key!==t.key){const v=t.canonical.z-s.tileID.canonical.z;let b,E,I;g=r.bz();const z=s.tileID.wrap-t.wrap<<t.overscaledZ;v>0?(b=r.aj>>v,E=b*((s.tileID.canonical.x<<v)-t.canonical.x+z),I=b*((s.tileID.canonical.y<<v)-t.canonical.y)):(b=r.aj<<-v,E=r.aj*(s.tileID.canonical.x-(t.canonical.x+z<<-v)),I=r.aj*(s.tileID.canonical.y-(t.canonical.y<<-v))),r.c5(g,0,b,0,b,0,1),r.bo(g,g,[E,I,0])}return new Al(s.tileID,t.key,g)}_findTileCoveringTileID(t,s){let h=s.getTile(t);if(h&&h.hasData())return h;const g=this._findCoveringTileCache[s.id],v=g[t.key];if(h=v?s.getTileByID(v):null,h&&h.hasData()||v===null)return h;let b=h?h.tileID:t,E=b.overscaledZ;const I=s.getSource().minzoom,z=[];if(!v){const N=s.getSource().maxzoom;if(t.canonical.z>=N){const F=t.canonical.z-N;s.getSource().reparseOverscaled?(E=Math.max(t.canonical.z+2,s.transform.tileZoom),b=new r.aM(E,t.wrap,N,t.canonical.x>>F,t.canonical.y>>F)):F!==0&&(E=N,b=new r.aM(E,t.wrap,N,t.canonical.x>>F,t.canonical.y>>F))}b.key!==t.key&&(z.push(b.key),h=s.getTile(b))}const L=N=>{z.forEach(F=>{g[F]=N}),z.length=0};for(E-=1;E>=I&&(!h||!h.hasData());E--){h&&L(h.tileID.key);const N=b.calculateScaledKey(E);if(h=s.getTileByID(N),h&&h.hasData())break;const F=g[N];if(F===null)break;F===void 0?z.push(N):h=s.getTileByID(F)}return L(h?h.tileID.key:null),h&&h.hasData()?h:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,s){let h=this._tilesDirty[t];h||(h=this._tilesDirty[t]={}),h[s.key]=!0}}function Jc(u,t,s){const h=function(E,I,z){const L=r.bG(I,E),N=r.bG(z,[.2126,.7152,.0722]),F=(X,G,Y)=>(1-Y)*X+Y*G,q=F(1-.3*Math.min(N,1),1,Math.min(L+1,1));return F(.92,1,Math.asin(r.ay(I[2],-1,1))/Math.PI+.5)*q}(u,[0,0,1],t),g=[0,0,0];r.bY(g,s.slice(0,3),h);const v=[0,0,0];r.bY(v,t.slice(0,3),u[2]);const b=[0,0,0];return r.cV(b,g,v),r.cY(b)}const Vd=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],qd=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class eu{static cacheKey(t,s,h,g){let v=`${s}${g?g.cacheKey:""}`;for(const b of h)t.usedDefines.includes(b)&&(v+=`/${b}`);return v}constructor(t,s,h,g,v,b){const E=t.gl;this.program=E.createProgram(),this.configuration=g,this.name=s,this.fixedDefines=[...b];const I=g?g.getBinderAttributes():[],z=(h.staticAttributes||[]).concat(I);let L=g?g.defines():[];L=L.concat(b.map(Y=>`#define ${Y}`));const N=`#version 300 es
`;let F=N+L.concat("precision mediump float;",Pa,ju.fragmentSource).join(`
`);for(const Y of h.fragmentIncludes)F+=`
${Kc[Y]}`;F+=`
${h.fragmentSource}`;let q=N+L.concat("precision highp float;",Pa,ju.vertexSource).join(`
`);for(const Y of h.vertexIncludes)q+=`
${Kc[Y]}`;this.forceManualRenderingForInstanceIDShaders=t.forceManualRenderingForInstanceIDShaders&&h.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(q+=`
uniform int u_instanceID;
`),q+=`
${h.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(q=q.replaceAll("gl_InstanceID","u_instanceID"));const X=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);E.shaderSource(X,F),E.compileShader(X),E.attachShader(this.program,X);const G=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())this.failedToCreate=!0;else{E.shaderSource(G,q),E.compileShader(G),E.attachShader(this.program,G),this.attributes={},this.numAttributes=z.length;for(let Y=0;Y<this.numAttributes;Y++)if(z[Y]){const J=z[Y].startsWith("a_")?z[Y]:`a_${z[Y]}`;E.bindAttribLocation(this.program,Y,J),this.attributes[J]=Y}E.linkProgram(this.program),E.deleteShader(G),E.deleteShader(X),this.fixedUniforms=v(t),this.binderUniforms=g?g.getUniforms(t):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(Y=>({u_instanceID:new r.c8(Y)}))(t)),(b.includes("TERRAIN")||s.indexOf("symbol")!==-1||s.indexOf("circle")!==-1)&&(this.terrainUniforms=(Y=>({u_dem:new r.c8(Y),u_dem_prev:new r.c8(Y),u_dem_tl:new r.cb(Y),u_dem_scale:new r.ca(Y),u_dem_tl_prev:new r.cb(Y),u_dem_scale_prev:new r.ca(Y),u_dem_size:new r.ca(Y),u_dem_lerp:new r.ca(Y),u_exaggeration:new r.ca(Y),u_depth:new r.c8(Y),u_depth_size_inv:new r.cb(Y),u_depth_range_unpack:new r.cb(Y),u_occluder_half_size:new r.ca(Y),u_occlusion_depth_offset:new r.ca(Y),u_meter_to_dem:new r.ca(Y),u_label_plane_matrix_inv:new r.cc(Y)}))(t)),b.includes("GLOBE")&&(this.globeUniforms=(Y=>({u_tile_tl_up:new r.c9(Y),u_tile_tr_up:new r.c9(Y),u_tile_br_up:new r.c9(Y),u_tile_bl_up:new r.c9(Y),u_tile_up_scale:new r.ca(Y)}))(t)),b.includes("FOG")&&(this.fogUniforms=(Y=>({u_fog_matrix:new r.cc(Y),u_fog_range:new r.cb(Y),u_fog_color:new r.cQ(Y),u_fog_horizon_blend:new r.ca(Y),u_fog_vertical_limit:new r.cb(Y),u_fog_temporal_offset:new r.ca(Y),u_frustum_tl:new r.c9(Y),u_frustum_tr:new r.c9(Y),u_frustum_br:new r.c9(Y),u_frustum_bl:new r.c9(Y),u_globe_pos:new r.c9(Y),u_globe_radius:new r.ca(Y),u_globe_transition:new r.ca(Y),u_is_globe:new r.c8(Y),u_viewport:new r.cb(Y)}))(t)),b.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Y=>({u_cutoff_params:new r.cQ(Y)}))(t)),b.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Y=>({u_lighting_ambient_color:new r.c9(Y),u_lighting_directional_dir:new r.c9(Y),u_lighting_directional_color:new r.c9(Y),u_ground_radiance:new r.c9(Y)}))(t)),b.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Y=>({u_light_matrix_0:new r.cc(Y),u_light_matrix_1:new r.cc(Y),u_fade_range:new r.cb(Y),u_shadow_normal_offset:new r.c9(Y),u_shadow_intensity:new r.ca(Y),u_shadow_texel_size:new r.ca(Y),u_shadow_map_resolution:new r.ca(Y),u_shadow_direction:new r.c9(Y),u_shadow_bias:new r.c9(Y),u_shadowmap_0:new r.c8(Y),u_shadowmap_1:new r.c8(Y)}))(t))}}setTerrainUniformValues(t,s){if(!this.terrainUniforms)return;const h=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const g in s)h[g]&&h[g].set(this.program,g,s[g])}}setGlobeUniformValues(t,s){if(!this.globeUniforms)return;const h=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const g in s)h[g]&&h[g].set(this.program,g,s[g])}}setFogUniformValues(t,s){if(!this.fogUniforms)return;const h=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const g in s)h[g].set(this.program,g,s[g])}}setCutoffUniformValues(t,s){if(!this.cutoffUniforms)return;const h=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const g in s)h[g].set(this.program,g,s[g])}}setLightsUniformValues(t,s){if(!this.lightsUniforms)return;const h=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const g in s)h[g].set(this.program,g,s[g])}}setShadowUniformValues(t,s){if(this.failedToCreate||!this.shadowUniforms)return;const h=this.shadowUniforms;t.program.set(this.program);for(const g in s)h[g].set(this.program,g,s[g])}_drawDebugWireframe(t,s,h,g,v,b,E,I,z,L){const N=t.options.wireframe;if(N.terrain===!1&&N.layers2D===!1&&N.layers3D===!1)return;const F=t.context;if(!(!(!N.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!N.layers2D||t._terrain&&t._terrain.renderingToTexture||!Vd.includes(this.name))||!(!N.layers3D||!qd.includes(this.name))))return;const q=F.gl,X=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,v,F);if(!X)return;const G=[...this.fixedDefines];G.push("DEBUG_WIREFRAME");const Y=t.getOrCreateProgram(this.name,{config:this.configuration,defines:G});F.program.set(Y.program);const J=(_e,Ae,Ie)=>{if(Ae[_e]&&Ie[_e])for(const Te in Ae[_e])Ie[_e][Te]&&Ie[_e][Te].set(Ie.program,Te,Ae[_e][Te].current)};z&&z.setUniforms(Y.program,F,Y.binderUniforms,E,{zoom:I}),J("fixedUniforms",this,Y),J("terrainUniforms",this,Y),J("globeUniforms",this,Y),J("fogUniforms",this,Y),J("lightsUniforms",this,Y),J("shadowUniforms",this,Y),X.bind(),F.setColorMode(new ii([q.ONE,q.ONE_MINUS_SRC_ALPHA,q.ZERO,q.ONE],r.am.transparent,[!0,!0,!0,!1])),F.setDepthMode(new sn(s.func===q.LESS?q.LEQUAL:s.func,sn.ReadOnly,s.range)),F.setStencilMode(In.disabled);const re=3*b.primitiveLength*2,pe=3*b.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const _e=L||1;for(let Ae=0;Ae<_e;++Ae)Y.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ae),q.drawElements(q.LINES,re,q.UNSIGNED_SHORT,pe)}else L&&L>1?q.drawElementsInstanced(q.LINES,re,q.UNSIGNED_SHORT,pe,L):q.drawElements(q.LINES,re,q.UNSIGNED_SHORT,pe);v.bind(),F.program.set(this.program),F.setDepthMode(s),F.setStencilMode(h),F.setColorMode(g)}checkUniforms(t,s,h){if(this.fixedDefines.includes(s)){for(const g of Object.keys(h))if(!h[g].initialized)throw new Error(`Program '${this.name}', from draw '${t}': uniform ${g} not set but required by ${s} being defined`)}}draw(t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y){const J=t.context,re=J.gl;if(this.failedToCreate)return;J.program.set(this.program),J.setDepthMode(h),J.setStencilMode(g),J.setColorMode(v),J.setCullFace(b);for(const Ae of Object.keys(this.fixedUniforms))this.fixedUniforms[Ae].set(this.program,Ae,E[Ae]);X&&X.setUniforms(this.program,J,this.binderUniforms,F,{zoom:q});const pe={[re.POINTS]:1,[re.LINES]:2,[re.TRIANGLES]:3,[re.LINE_STRIP]:1}[s];this.checkUniforms(I,"RENDER_SHADOWS",this.shadowUniforms);const _e=Y&&Y>0?1:void 0;for(const Ae of N.get()){const Ie=Ae.vaos||(Ae.vaos={});if((Ie[I]||(Ie[I]=new hc)).bind(J,this,z,X?X.getPaintVertexBuffers():[],L,Ae.vertexOffset,G||[],_e),this.forceManualRenderingForInstanceIDShaders){const Te=Y||1;for(let ve=0;ve<Te;++ve)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ve),L?re.drawElements(s,Ae.primitiveLength*pe,re.UNSIGNED_SHORT,Ae.primitiveOffset*pe*2):re.drawArrays(s,Ae.vertexOffset,Ae.vertexLength)}else Y&&Y>1?re.drawElementsInstanced(s,Ae.primitiveLength*pe,re.UNSIGNED_SHORT,Ae.primitiveOffset*pe*2,Y):L?re.drawElements(s,Ae.primitiveLength*pe,re.UNSIGNED_SHORT,Ae.primitiveOffset*pe*2):re.drawArrays(s,Ae.vertexOffset,Ae.vertexLength);s===re.TRIANGLES&&L&&this._drawDebugWireframe(t,h,g,v,L,Ae,F,q,X,Y)}}}function Wu(u,t,s=0){const h=Math.pow(2,t.tileID.overscaledZ),g=t.tileSize*Math.pow(2,u.transform.tileZoom)/h,v=g*(t.tileID.canonical.x+t.tileID.wrap*h),b=g*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/r.aw(t,1,u.transform.tileZoom),u_pixel_coord_upper:[v>>16,b>>16],u_pixel_coord_lower:[65535&v,65535&b],u_pattern_transition:s}}const Wo={terrain:0,flat:1},Zu=r.bz(),tu=(u,t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y,J)=>{const re=t.style.light,pe=re.properties.get("position"),_e=[pe.x,pe.y,pe.z],Ae=r.dx();re.properties.get("anchor")==="viewport"&&(r.dy(Ae,-t.transform.angle),r.dz(_e,_e,Ae));const Ie=re.properties.get("color").toPremultipliedRenderColor(null),Te=t.transform,ve={u_matrix:u,u_lightpos:_e,u_lightintensity:re.properties.get("intensity"),u_lightcolor:[Ie.r,Ie.g,Ie.b],u_vertical_gradient:+s,u_opacity:h,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Zu,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Wo[z],u_base_type:Wo[L],u_ao:g,u_edge_radius:v,u_width_scale:b,u_flood_light_color:X,u_vertical_scale:G,u_flood_light_intensity:Y,u_ground_shadow_factor:J};return Te.projection.name==="globe"&&(ve.u_tile_id=[E.canonical.x,E.canonical.y,1<<E.canonical.z],ve.u_zoom_transition=N,ve.u_inv_rot_matrix=q,ve.u_merc_center=F,ve.u_up_dir=Te.projection.upVector(new r.cp(0,0,0),F[0]*r.aj,F[1]*r.aj),ve.u_height_lift=I),ve},Np=(u,t,s,h,g,v)=>({u_matrix:u,u_edge_radius:t,u_width_scale:s,u_vertical_scale:h,u_height_type:Wo[g],u_base_type:Wo[v]}),Bf=(u,t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y,J)=>{const re=tu(u,t,s,h,g,v,b,E,z,L,N,F,q,X,G,Y,1,[0,0,0]),pe={u_height_factor:-Math.pow(2,E.overscaledZ)/I.tileSize/8};return r.h(re,Wu(t,I,J),pe)},Zo=(u,t,s)=>({u_matrix:u,u_emissive_strength:t,u_ground_shadow_factor:s}),nu=(u,t,s,h,g,v=0)=>r.h(Zo(u,t,g),Wu(s,h,v)),Ku=(u,t,s,h)=>({u_matrix:u,u_world:s,u_emissive_strength:t,u_ground_shadow_factor:h}),Hd=(u,t,s,h,g,v,b=0)=>r.h(nu(u,t,s,h,v,b),{u_world:g}),Ud=(u,t)=>({u_matrix:u,u_ground_shadow_factor:t}),Mo=(u,t,s,h,g)=>({u_matrix:u,u_camera_pos:[t[0],t[1],t[2]],u_depth_bias:s,u_height_scale:h,u_reset_depth:g}),xa=(u,t,s,h)=>{const g=r.aj/s.tileSize;return{u_matrix:u,u_camera_to_center_distance:t.getCameraToCenterDistance(h),u_extrude_scale:[t.pixelsToGLUnits[0]/g,t.pixelsToGLUnits[1]/g]}},Ja=(u,t,s=1)=>({u_matrix:u,u_color:t,u_overlay:0,u_overlay_scale:s}),Ma=r.bz(),el=(u,t,s,h,g,v,b)=>{const E=u.transform,I=E.projection.name==="globe",z=I?r.dA(E.zoom,t.canonical)*E._pixelsPerMercatorPixel:r.aw(s,1,v),L={u_matrix:t.projMatrix,u_extrude_scale:z,u_intensity:b,u_inv_rot_matrix:Ma,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){L.u_inv_rot_matrix=h,L.u_merc_center=g,L.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],L.u_zoom_transition=r.ah(E.zoom);const N=g[0]*r.aj,F=g[1]*r.aj;L.u_up_dir=E.projection.upVector(new r.cp(0,0,0),N,F)}return L};function aa(u,[t,s,h,g],[v,b]){if(v===b)return[0,0,0,0];const E=255*(u-1)/(u*(b-v));return[t*E,s*E,h*E,g*E]}function $d(u,t,[s,h]){return s===h?0:.5/u+(t-s)*(u-1)/(u*(h-s))}const Gh=(u,t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y,J,re,pe,_e)=>({u_matrix:u,u_normalize_matrix:t,u_globe_matrix:s,u_merc_matrix:h,u_grid_matrix:g,u_tl_parent:v,u_scale_parent:z,u_fade_t:L.mix,u_opacity:L.opacity*N.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:N.paint.get("raster-brightness-min"),u_brightness_high:N.paint.get("raster-brightness-max"),u_saturation_factor:r.dC(N.paint.get("raster-saturation")),u_contrast_factor:r.dB(N.paint.get("raster-contrast")),u_spin_weights:Gd(N.paint.get("raster-hue-rotate")),u_perspective_transform:F,u_raster_elevation:q,u_zoom_transition:b,u_merc_center:E,u_cutoff_params:I,u_colorization_mix:aa(r.dD,G,J),u_colorization_offset:$d(r.dD,Y,J),u_color_ramp:X,u_texture_offset:[pe/(re+2*pe),re/(re+2*pe)],u_texture_res:[re+2*pe,re+2*pe],u_emissive_strength:_e});function Gd(u){u*=Math.PI/180;const t=Math.sin(u),s=Math.cos(u);return[(2*s+1)/3,(-Math.sqrt(3)*t-s+1)/3,(Math.sqrt(3)*t-s+1)/3]}const Es=.05,js=(u,t,s,h,g,v,b,E,I,z,L,N)=>({u_matrix:u,u_normalize_matrix:t,u_globe_matrix:s,u_merc_matrix:h,u_grid_matrix:g,u_tl_parent:v,u_scale_parent:z,u_fade_t:L.mix,u_opacity:L.opacity,u_image0:0,u_image1:1,u_raster_elevation:N,u_zoom_transition:b,u_merc_center:E,u_cutoff_params:I}),ss=(u,t,s,h,g,v,b,E,I,z)=>({u_particle_texture:u,u_particle_texture_side_len:t,u_tile_offset:s,u_velocity:h,u_color_ramp:v,u_velocity_res:g,u_max_speed:b,u_uv_offset:E,u_data_scale:[255*I[0],255*I[1]],u_data_offset:z,u_particle_pos_scale:1.1,u_particle_pos_offset:[Es,Es]}),Ys=(u,t,s,h,g,v,b,E,I,z)=>({u_particle_texture:u,u_particle_texture_side_len:t,u_velocity:s,u_velocity_res:h,u_max_speed:g,u_speed_factor:v,u_reset_rate:b,u_rand_seed:Math.random(),u_uv_offset:E,u_data_scale:[255*I[0],255*I[1]],u_data_offset:z,u_particle_pos_scale:1.1,u_particle_pos_offset:[Es,Es]}),Wh=r.bz(),Xu=(u,t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y,J,re,pe,_e,Ae,Ie,Te)=>{const ve=g.transform,Pe={u_is_size_zoom_constant:+(u==="constant"||u==="source"),u_is_size_feature_constant:+(u==="constant"||u==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:ve.getCameraToCenterDistance(re),u_rotate_symbol:+s,u_aspect_ratio:ve.width/ve.height,u_fade_change:g.options.fadeDuration?g.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:b,u_coord_matrix:E,u_is_text:+z,u_elevation_from_sea:I?1:0,u_pitch_with_map:+h,u_texsize:L,u_texsize_icon:N,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Wh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Wh,u_up_vector:[0,-1,0],u_color_adj_mat:Ae,u_icon_transition:Ie||0,u_gamma_scale:h?g.transform.getCameraToCenterDistance(re)*Math.cos(g.terrain?0:g.transform._pitch):1,u_device_pixel_ratio:r.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Te||1,u_ground_shadow_factor:pe,u_inv_matrix:r.bi(r.bz(),b),u_normal_scale:_e};return re.name==="globe"&&(Pe.u_tile_id=[q.canonical.x,q.canonical.y,1<<q.canonical.z],Pe.u_zoom_transition=X,Pe.u_inv_rot_matrix=Y,Pe.u_merc_center=G,Pe.u_camera_forward=ve._camera.forward(),Pe.u_ecef_origin=r.dE(ve.globeMatrix,q.toUnwrapped()),Pe.u_tile_matrix=Float32Array.from(ve.globeMatrix),Pe.u_up_vector=J),Pe},Zh=(u,t,s,h)=>({u_matrix:u,u_emissive_strength:t,u_opacity:s,u_color:h}),Kh=(u,t,s,h,g,v,b,E,I)=>r.h(function(z,L,N,F,q,X){const{width:G,height:Y}=F.imageManager.getPixelSize(L),J=Math.pow(2,X.tileID.overscaledZ),re=X.tileSize*Math.pow(2,F.transform.tileZoom)/J,pe=re*(X.tileID.canonical.x+X.tileID.wrap*J),_e=re*X.tileID.canonical.y;return{u_image:0,u_pattern_tl:N.tl,u_pattern_br:N.br,u_texsize:[G,Y],u_pattern_size:N.displaySize,u_pattern_units_to_pixels:q?[F.transform.width,-1*F.transform.height]:[1/r.aw(X,1,F.transform.tileZoom),1/r.aw(X,1,F.transform.tileZoom)],u_pixel_coord_upper:[pe>>16,_e>>16],u_pixel_coord_lower:[65535&pe,65535&_e]}}(0,v,b,h,E,I),{u_matrix:u,u_emissive_strength:t,u_opacity:s}),Yu=new Float32Array(r.bx([])),mc=(u,t,s,h,g,v,b,E,I,z,L,N,F,q=[0,0,0],X)=>{const G=g.style.light,Y=G.properties.get("position"),J=[-Y.x,-Y.y,Y.z],re=r.dx();G.properties.get("anchor")==="viewport"&&(r.dy(re,-g.transform.angle),r.dz(J,J,re));const pe=L.alphaMode==="MASK",_e=G.properties.get("color").toNonPremultipliedRenderColor(null),Ae=F.paint.get("model-ambient-occlusion-intensity"),Ie=F.paint.get("model-color").constantOr(r.am.white).toNonPremultipliedRenderColor(null);return Ie.a=F.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:u,u_lighting_matrix:t,u_normal_matrix:s,u_node_matrix:h||Yu,u_lightpos:J,u_lightintensity:G.properties.get("intensity"),u_lightcolor:[_e.r,_e.g,_e.b],u_camera_pos:q,u_opacity:v,u_baseTextureIsAlpha:0,u_alphaMask:+pe,u_alphaCutoff:L.alphaCutoff,u_baseColorFactor:b.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:E.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:I,u_roughnessFactor:z,u_baseColorTexture:go.BaseColor,u_metallicRoughnessTexture:go.MetallicRoughness,u_normalTexture:go.Normal,u_occlusionTexture:go.Occlusion,u_emissionTexture:go.Emission,u_lutTexture:go.LUT,u_color_mix:Ie.toArray01(),u_aoIntensity:Ae,u_emissive_strength:N,u_occlusionTextureTransform:X||[0,0,0,0]}},Vp=(u,t=Yu,s=Yu)=>({u_matrix:u,u_instance:t,u_node_matrix:s}),iu={fillExtrusion:u=>({u_matrix:new r.cc(u),u_lightpos:new r.c9(u),u_lightintensity:new r.ca(u),u_lightcolor:new r.c9(u),u_vertical_gradient:new r.ca(u),u_opacity:new r.ca(u),u_edge_radius:new r.ca(u),u_width_scale:new r.ca(u),u_ao:new r.cb(u),u_height_type:new r.c8(u),u_base_type:new r.c8(u),u_tile_id:new r.c9(u),u_zoom_transition:new r.ca(u),u_inv_rot_matrix:new r.cc(u),u_merc_center:new r.cb(u),u_up_dir:new r.c9(u),u_height_lift:new r.ca(u),u_flood_light_color:new r.c9(u),u_vertical_scale:new r.ca(u),u_flood_light_intensity:new r.ca(u),u_ground_shadow_factor:new r.c9(u)}),fillExtrusionDepth:u=>({u_matrix:new r.cc(u),u_edge_radius:new r.ca(u),u_width_scale:new r.ca(u),u_vertical_scale:new r.ca(u),u_height_type:new r.c8(u),u_base_type:new r.c8(u)}),fillExtrusionPattern:u=>({u_matrix:new r.cc(u),u_lightpos:new r.c9(u),u_lightintensity:new r.ca(u),u_lightcolor:new r.c9(u),u_vertical_gradient:new r.ca(u),u_height_factor:new r.ca(u),u_edge_radius:new r.ca(u),u_width_scale:new r.ca(u),u_ao:new r.cb(u),u_height_type:new r.c8(u),u_base_type:new r.c8(u),u_tile_id:new r.c9(u),u_zoom_transition:new r.ca(u),u_inv_rot_matrix:new r.cc(u),u_merc_center:new r.cb(u),u_up_dir:new r.c9(u),u_height_lift:new r.ca(u),u_image:new r.c8(u),u_texsize:new r.cb(u),u_pixel_coord_upper:new r.cb(u),u_pixel_coord_lower:new r.cb(u),u_tile_units_to_pixels:new r.ca(u),u_opacity:new r.ca(u),u_pattern_transition:new r.ca(u)}),fillExtrusionGroundEffect:u=>({u_matrix:new r.cc(u),u_opacity:new r.ca(u),u_ao_pass:new r.ca(u),u_meter_to_tile:new r.ca(u),u_ao:new r.cb(u),u_flood_light_intensity:new r.ca(u),u_flood_light_color:new r.c9(u),u_attenuation:new r.ca(u),u_edge_radius:new r.ca(u),u_fb:new r.c8(u),u_fb_size:new r.ca(u),u_dynamic_offset:new r.ca(u)}),fill:u=>({u_matrix:new r.cc(u),u_emissive_strength:new r.ca(u),u_ground_shadow_factor:new r.c9(u)}),fillPattern:u=>({u_matrix:new r.cc(u),u_emissive_strength:new r.ca(u),u_image:new r.c8(u),u_texsize:new r.cb(u),u_pixel_coord_upper:new r.cb(u),u_pixel_coord_lower:new r.cb(u),u_tile_units_to_pixels:new r.ca(u),u_ground_shadow_factor:new r.c9(u),u_pattern_transition:new r.ca(u)}),fillOutline:u=>({u_matrix:new r.cc(u),u_emissive_strength:new r.ca(u),u_world:new r.cb(u),u_ground_shadow_factor:new r.c9(u)}),fillOutlinePattern:u=>({u_matrix:new r.cc(u),u_emissive_strength:new r.ca(u),u_world:new r.cb(u),u_image:new r.c8(u),u_texsize:new r.cb(u),u_pixel_coord_upper:new r.cb(u),u_pixel_coord_lower:new r.cb(u),u_tile_units_to_pixels:new r.ca(u),u_ground_shadow_factor:new r.c9(u),u_pattern_transition:new r.ca(u)}),building:u=>({u_matrix:new r.cc(u),u_normal_matrix:new r.cc(u),u_opacity:new r.ca(u)}),buildingDepth:u=>({u_matrix:new r.cc(u)}),elevatedStructuresDepth:u=>({u_matrix:new r.cc(u),u_depth_bias:new r.ca(u)}),elevatedStructures:u=>({u_matrix:new r.cc(u),u_ground_shadow_factor:new r.c9(u)}),elevatedStructuresDepthReconstruct:u=>({u_matrix:new r.cc(u),u_camera_pos:new r.c9(u),u_depth_bias:new r.ca(u),u_height_scale:new r.ca(u),u_reset_depth:new r.ca(u)}),circle:r.dH,collisionBox:u=>({u_matrix:new r.cc(u),u_camera_to_center_distance:new r.ca(u),u_extrude_scale:new r.cb(u)}),collisionCircle:u=>({u_matrix:new r.cc(u),u_inv_matrix:new r.cc(u),u_camera_to_center_distance:new r.ca(u),u_viewport_size:new r.cb(u)}),debug:u=>({u_color:new r.di(u),u_matrix:new r.cc(u),u_overlay:new r.c8(u),u_overlay_scale:new r.ca(u)}),clippingMask:u=>({u_matrix:new r.cc(u)}),heatmap:u=>({u_extrude_scale:new r.ca(u),u_intensity:new r.ca(u),u_matrix:new r.cc(u),u_inv_rot_matrix:new r.cc(u),u_merc_center:new r.cb(u),u_tile_id:new r.c9(u),u_zoom_transition:new r.ca(u),u_up_dir:new r.c9(u)}),heatmapTexture:u=>({u_image:new r.c8(u),u_color_ramp:new r.c8(u),u_opacity:new r.ca(u)}),hillshade:u=>({u_matrix:new r.cc(u),u_image:new r.c8(u),u_latrange:new r.cb(u),u_light:new r.cb(u),u_shadow:new r.di(u),u_highlight:new r.di(u),u_emissive_strength:new r.ca(u),u_accent:new r.di(u)}),hillshadePrepare:u=>({u_matrix:new r.cc(u),u_image:new r.c8(u),u_dimension:new r.cb(u),u_zoom:new r.ca(u)}),line:r.dG,linePattern:r.dF,raster:u=>({u_matrix:new r.cc(u),u_normalize_matrix:new r.cc(u),u_globe_matrix:new r.cc(u),u_merc_matrix:new r.cc(u),u_grid_matrix:new r.dj(u),u_tl_parent:new r.cb(u),u_scale_parent:new r.ca(u),u_fade_t:new r.ca(u),u_opacity:new r.ca(u),u_image0:new r.c8(u),u_image1:new r.c8(u),u_brightness_low:new r.ca(u),u_brightness_high:new r.ca(u),u_saturation_factor:new r.ca(u),u_contrast_factor:new r.ca(u),u_spin_weights:new r.c9(u),u_perspective_transform:new r.cb(u),u_raster_elevation:new r.ca(u),u_zoom_transition:new r.ca(u),u_merc_center:new r.cb(u),u_cutoff_params:new r.cQ(u),u_colorization_mix:new r.cQ(u),u_colorization_offset:new r.ca(u),u_color_ramp:new r.c8(u),u_texture_offset:new r.cb(u),u_texture_res:new r.cb(u),u_emissive_strength:new r.ca(u)}),rasterParticle:u=>({u_matrix:new r.cc(u),u_normalize_matrix:new r.cc(u),u_globe_matrix:new r.cc(u),u_merc_matrix:new r.cc(u),u_grid_matrix:new r.dj(u),u_tl_parent:new r.cb(u),u_scale_parent:new r.ca(u),u_fade_t:new r.ca(u),u_opacity:new r.ca(u),u_image0:new r.c8(u),u_image1:new r.c8(u),u_raster_elevation:new r.ca(u),u_zoom_transition:new r.ca(u),u_merc_center:new r.cb(u),u_cutoff_params:new r.cQ(u)}),rasterParticleTexture:u=>({u_texture:new r.c8(u),u_opacity:new r.ca(u)}),rasterParticleDraw:u=>({u_particle_texture:new r.c8(u),u_particle_texture_side_len:new r.ca(u),u_tile_offset:new r.cb(u),u_velocity:new r.c8(u),u_color_ramp:new r.c8(u),u_velocity_res:new r.cb(u),u_max_speed:new r.ca(u),u_uv_offset:new r.cb(u),u_data_scale:new r.cb(u),u_data_offset:new r.ca(u),u_particle_pos_scale:new r.ca(u),u_particle_pos_offset:new r.cb(u)}),rasterParticleUpdate:u=>({u_particle_texture:new r.c8(u),u_particle_texture_side_len:new r.ca(u),u_velocity:new r.c8(u),u_velocity_res:new r.cb(u),u_max_speed:new r.ca(u),u_speed_factor:new r.ca(u),u_reset_rate:new r.ca(u),u_rand_seed:new r.ca(u),u_uv_offset:new r.cb(u),u_data_scale:new r.cb(u),u_data_offset:new r.ca(u),u_particle_pos_scale:new r.ca(u),u_particle_pos_offset:new r.cb(u)}),symbol:u=>({u_is_size_zoom_constant:new r.c8(u),u_is_size_feature_constant:new r.c8(u),u_size_t:new r.ca(u),u_size:new r.ca(u),u_camera_to_center_distance:new r.ca(u),u_rotate_symbol:new r.c8(u),u_aspect_ratio:new r.ca(u),u_fade_change:new r.ca(u),u_matrix:new r.cc(u),u_label_plane_matrix:new r.cc(u),u_coord_matrix:new r.cc(u),u_is_text:new r.c8(u),u_elevation_from_sea:new r.c8(u),u_pitch_with_map:new r.c8(u),u_texsize:new r.cb(u),u_texsize_icon:new r.cb(u),u_texture:new r.c8(u),u_texture_icon:new r.c8(u),u_gamma_scale:new r.ca(u),u_device_pixel_ratio:new r.ca(u),u_tile_id:new r.c9(u),u_zoom_transition:new r.ca(u),u_inv_rot_matrix:new r.cc(u),u_merc_center:new r.cb(u),u_camera_forward:new r.c9(u),u_tile_matrix:new r.cc(u),u_up_vector:new r.c9(u),u_ecef_origin:new r.c9(u),u_is_halo:new r.c8(u),u_icon_transition:new r.ca(u),u_color_adj_mat:new r.cc(u),u_scale_factor:new r.ca(u),u_ground_shadow_factor:new r.c9(u),u_inv_matrix:new r.cc(u),u_normal_scale:new r.ca(u)}),background:u=>({u_matrix:new r.cc(u),u_emissive_strength:new r.ca(u),u_opacity:new r.ca(u),u_color:new r.di(u)}),backgroundPattern:u=>({u_matrix:new r.cc(u),u_emissive_strength:new r.ca(u),u_opacity:new r.ca(u),u_image:new r.c8(u),u_pattern_tl:new r.cb(u),u_pattern_br:new r.cb(u),u_texsize:new r.cb(u),u_pattern_size:new r.cb(u),u_pixel_coord_upper:new r.cb(u),u_pixel_coord_lower:new r.cb(u),u_pattern_units_to_pixels:new r.cb(u)}),terrainRaster:u=>({u_matrix:new r.cc(u),u_image0:new r.c8(u),u_skirt_height:new r.ca(u),u_ground_shadow_factor:new r.c9(u)}),skybox:u=>({u_matrix:new r.cc(u),u_sun_direction:new r.c9(u),u_cubemap:new r.c8(u),u_opacity:new r.ca(u),u_temporal_offset:new r.ca(u)}),skyboxGradient:u=>({u_matrix:new r.cc(u),u_color_ramp:new r.c8(u),u_center_direction:new r.c9(u),u_radius:new r.ca(u),u_opacity:new r.ca(u),u_temporal_offset:new r.ca(u)}),skyboxCapture:u=>({u_matrix_3f:new r.dj(u),u_sun_direction:new r.c9(u),u_sun_intensity:new r.ca(u),u_color_tint_r:new r.cQ(u),u_color_tint_m:new r.cQ(u),u_luminance:new r.ca(u)}),globeRaster:u=>({u_proj_matrix:new r.cc(u),u_globe_matrix:new r.cc(u),u_normalize_matrix:new r.cc(u),u_merc_matrix:new r.cc(u),u_zoom_transition:new r.ca(u),u_merc_center:new r.cb(u),u_image0:new r.c8(u),u_grid_matrix:new r.dj(u),u_skirt_height:new r.ca(u),u_far_z_cutoff:new r.ca(u),u_frustum_tl:new r.c9(u),u_frustum_tr:new r.c9(u),u_frustum_br:new r.c9(u),u_frustum_bl:new r.c9(u),u_globe_pos:new r.c9(u),u_globe_radius:new r.ca(u),u_viewport:new r.cb(u)}),globeAtmosphere:u=>({u_frustum_tl:new r.c9(u),u_frustum_tr:new r.c9(u),u_frustum_br:new r.c9(u),u_frustum_bl:new r.c9(u),u_horizon:new r.ca(u),u_transition:new r.ca(u),u_fadeout_range:new r.ca(u),u_color:new r.cQ(u),u_high_color:new r.cQ(u),u_space_color:new r.cQ(u),u_temporal_offset:new r.ca(u),u_horizon_angle:new r.ca(u)}),model:u=>({u_matrix:new r.cc(u),u_lighting_matrix:new r.cc(u),u_normal_matrix:new r.cc(u),u_node_matrix:new r.cc(u),u_lightpos:new r.c9(u),u_lightintensity:new r.ca(u),u_lightcolor:new r.c9(u),u_camera_pos:new r.c9(u),u_opacity:new r.ca(u),u_baseColorFactor:new r.cQ(u),u_emissiveFactor:new r.cQ(u),u_metallicFactor:new r.ca(u),u_roughnessFactor:new r.ca(u),u_baseTextureIsAlpha:new r.c8(u),u_alphaMask:new r.c8(u),u_alphaCutoff:new r.ca(u),u_baseColorTexture:new r.c8(u),u_metallicRoughnessTexture:new r.c8(u),u_normalTexture:new r.c8(u),u_occlusionTexture:new r.c8(u),u_emissionTexture:new r.c8(u),u_lutTexture:new r.c8(u),u_color_mix:new r.cQ(u),u_aoIntensity:new r.ca(u),u_emissive_strength:new r.ca(u),u_occlusionTextureTransform:new r.cQ(u)}),modelDepth:u=>({u_matrix:new r.cc(u),u_instance:new r.cc(u),u_node_matrix:new r.cc(u)}),groundShadow:u=>({u_matrix:new r.cc(u),u_ground_shadow_factor:new r.c9(u)}),stars:u=>({u_matrix:new r.cc(u),u_up:new r.c9(u),u_right:new r.c9(u),u_intensity_multiplier:new r.ca(u)}),snowParticle:u=>({u_modelview:new r.cc(u),u_projection:new r.cc(u),u_time:new r.ca(u),u_cam_pos:new r.c9(u),u_velocityConeAperture:new r.ca(u),u_velocity:new r.ca(u),u_horizontalOscillationRadius:new r.ca(u),u_horizontalOscillationRate:new r.ca(u),u_boxSize:new r.ca(u),u_billboardSize:new r.ca(u),u_simpleShapeParameters:new r.cb(u),u_screenSize:new r.cb(u),u_thinningCenterPos:new r.cb(u),u_thinningShape:new r.c9(u),u_thinningAffectedRatio:new r.ca(u),u_thinningParticleOffset:new r.ca(u),u_particleColor:new r.cQ(u),u_direction:new r.c9(u)}),rainParticle:u=>({u_modelview:new r.cc(u),u_projection:new r.cc(u),u_time:new r.ca(u),u_cam_pos:new r.c9(u),u_texScreen:new r.c8(u),u_velocityConeAperture:new r.ca(u),u_velocity:new r.ca(u),u_boxSize:new r.ca(u),u_rainDropletSize:new r.cb(u),u_distortionStrength:new r.ca(u),u_rainDirection:new r.c9(u),u_color:new r.cQ(u),u_screenSize:new r.cb(u),u_thinningCenterPos:new r.cb(u),u_thinningShape:new r.c9(u),u_thinningAffectedRatio:new r.ca(u),u_thinningParticleOffset:new r.ca(u),u_shapeDirectionalPower:new r.ca(u),u_shapeNormalPower:new r.ca(u),u_mode:new r.ca(u)}),vignette:u=>({u_vignetteShape:new r.c9(u),u_vignetteColor:new r.cQ(u)}),occlusion:u=>({u_matrix:new r.cc(u),u_anchorPos:new r.c9(u),u_screenSizePx:new r.cb(u),u_occluderSizePx:new r.cb(u),u_color:new r.cQ(u)})};class Ko{constructor(t,s,h,g){this.id=Ko.uniqueIdxCounter,Ko.uniqueIdxCounter++,this.context=t;const v=t.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||g||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=Ko.uniqueIdxCounter,Ko.uniqueIdxCounter++;const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Ko.uniqueIdxCounter=0;const Zm={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Xh{constructor(t,s,h,g,v,b){this.length=s.length,this.attributes=h,this.itemSize=s.bytesPerElement,this.dynamicDraw=g,this.instanceCount=b,this.context=t;const E=t.gl;this.buffer=E.createBuffer(),t.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||v||s.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,s){for(let h=0;h<this.attributes.length;h++){const g=s.attributes[this.attributes[h].name];g!==void 0&&t.enableVertexAttribArray(g)}}setVertexAttribPointers(t,s,h){for(let g=0;g<this.attributes.length;g++){const v=this.attributes[g],b=s.attributes[v.name];b!==void 0&&t.vertexAttribPointer(b,v.components,t[Zm[v.type]],!1,this.itemSize,v.offset+this.itemSize*(h||0))}}setVertexAttribDivisor(t,s,h){for(let g=0;g<this.attributes.length;g++){const v=s.attributes[this.attributes[g].name];v!==void 0&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(v,h)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Qu{constructor(t,s,h,g,v){this.context=t,this.width=s,this.height=h;const b=this.framebuffer=t.gl.createFramebuffer();g&&(this.colorAttachment=new Df(t,b)),v&&(this.depthAttachmentType=v,this.depthAttachment=v==="renderbuffer"?new Of(t,b):new Yc(t,b))}destroy(){const t=this.context.gl;if(this.colorAttachment){const s=this.colorAttachment.get();s&&t.deleteTexture(s)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const s=this.depthAttachment.get();s&&t.deleteRenderbuffer(s)}else{const s=this.depthAttachment.get();s&&t.deleteTexture(s)}t.deleteFramebuffer(this.framebuffer)}}class Ff{constructor(t,s){this.gl=t,this.clearColor=new Lp(this),this.clearDepth=new Zr(this),this.clearStencil=new Dp(this),this.colorMask=new Dd(this),this.depthMask=new qh(this),this.stencilMask=new Lf(this),this.stencilFunc=new Od(this),this.stencilOp=new Hh(this),this.stencilTest=new Xc(this),this.depthRange=new Nu(this),this.depthTest=new Op(this),this.depthFunc=new Bp(this),this.blend=new Bd(this),this.blendFunc=new Fd(this),this.blendColor=new Wa(this),this.blendEquation=new El(this),this.cullFace=new Vu(this),this.cullFaceSide=new qu(this),this.frontFace=new pc(this),this.program=new jd(this),this.activeTexture=new Fp(this),this.viewport=new jp(this),this.bindFramebuffer=new Hu(this),this.bindRenderbuffer=new Nd(this),this.bindTexture=new Uu(this),this.bindVertexBuffer=new Za(this),this.bindElementBuffer=new Uh(this),this.bindVertexArrayOES=new Ka(this),this.pixelStoreUnpack=new ka(this),this.pixelStoreUnpackPremultiplyAlpha=new $u(this),this.pixelStoreUnpackFlipY=new Xa(this),this.options=s?Object.assign({},s):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=s&&!!s.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxPointSize=t.getParameter(t.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,s,h){return new Ko(this,t,s,h)}createVertexBuffer(t,s,h,g,v){return new Xh(this,t,s,h,g,v)}createRenderbuffer(t,s,h){const g=this.gl,v=g.createRenderbuffer();return this.bindRenderbuffer.set(v),g.renderbufferStorage(g.RENDERBUFFER,t,s,h),this.bindRenderbuffer.set(null),v}createFramebuffer(t,s,h,g){return new Qu(this,t,s,h,g)}clear({color:t,depth:s,stencil:h,colorMask:g}){const v=this.gl;let b=0;t&&(b|=v.COLOR_BUFFER_BIT,this.clearColor.set(t.toNonPremultipliedRenderColor(null)),this.colorMask.set(g||[!0,!0,!0,!0])),s!==void 0&&(b|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),h!==void 0&&(b|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),v.clear(b)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){r.bv(t.blendFunction,ii.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let ru;function Il(u,t,s,h,g,v,b){const E=u.context,I=E.gl,z=u.transform,L=u.getOrCreateProgram("collisionBox"),N=[];let F=0,q=0;for(let _e=0;_e<h.length;_e++){const Ae=h[_e],Ie=t.getTile(Ae),Te=Ie.getBucket(s);if(!Te)continue;const ve=Cn(Ae,Te,z);let Pe=ve;g[0]===0&&g[1]===0||(Pe=u.translatePosMatrix(ve,Ie,g,v));const Me=b?Te.textCollisionBox:Te.iconCollisionBox,We=Te.collisionCircleArray;if(We.length>0){const Qe=r.bz(),ft=Pe;r.cB(Qe,Te.placementInvProjMatrix,z.glCoordMatrix),r.cB(Qe,Qe,Te.placementViewportMatrix),N.push({circleArray:We,circleOffset:q,transform:ft,invTransform:Qe,projection:Te.getProjection()}),F+=We.length/4,q=F}Me&&(u.terrain&&u.terrain.setupElevationDraw(Ie,L),L.draw(u,I.LINES,sn.disabled,In.disabled,u.colorModeForRenderPass(),Sn.disabled,xa(Pe,z,Ie,Te.getProjection()),s.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,null,z.zoom,null,[Me.collisionVertexBuffer,Me.collisionVertexBufferExt]))}if(!b||!N.length)return;const X=u.getOrCreateProgram("collisionCircle"),G=new r.dI;G.resize(4*F),G._trim();let Y=0;for(const _e of N)for(let Ae=0;Ae<_e.circleArray.length/4;Ae++){const Ie=4*Ae,Te=_e.circleArray[Ie+0],ve=_e.circleArray[Ie+1],Pe=_e.circleArray[Ie+2],Me=_e.circleArray[Ie+3];G.emplace(Y++,Te,ve,Pe,Me,0),G.emplace(Y++,Te,ve,Pe,Me,1),G.emplace(Y++,Te,ve,Pe,Me,2),G.emplace(Y++,Te,ve,Pe,Me,3)}(!ru||ru.length<2*F)&&(ru=function(_e){const Ae=2*_e,Ie=new r.a_;Ie.resize(Ae),Ie._trim();for(let Te=0;Te<Ae;Te++){const ve=6*Te;Ie.uint16[ve+0]=4*Te+0,Ie.uint16[ve+1]=4*Te+1,Ie.uint16[ve+2]=4*Te+2,Ie.uint16[ve+3]=4*Te+2,Ie.uint16[ve+4]=4*Te+3,Ie.uint16[ve+5]=4*Te+0}return Ie}(F));const J=E.createIndexBuffer(ru,!0),re=E.createVertexBuffer(G,r.dJ.members,!0);for(const _e of N){const Ae={u_matrix:_e.transform,u_inv_matrix:_e.invTransform,u_camera_to_center_distance:(pe=z).getCameraToCenterDistance(_e.projection),u_viewport_size:[pe.width,pe.height]};X.draw(u,I.TRIANGLES,sn.disabled,In.disabled,u.colorModeForRenderPass(),Sn.disabled,Ae,s.id,re,J,r.bd.simpleSegment(0,2*_e.circleOffset,_e.circleArray.length,_e.circleArray.length/2),null,z.zoom)}var pe;re.destroy(),J.destroy()}const tl=r.bz();function gc(u){const t=u._camera.getWorldToCamera(u.worldSize,1),s=r.az([],t,u.globeMatrix);r.bi(s,s);const h=[0,0,0],g=[0,1,0,0];return r.aA(g,g,s),h[0]=g[0],h[1]=g[1],h[2]=g[2],r.au(h,h),h}function _c({width:u,height:t,anchor:s,textOffset:h,textScale:g},v){const{horizontalAlign:b,verticalAlign:E}=r.bT(s),I=-(b-.5)*u,z=-(E-.5)*t,L=r.bU(s,h);return new r.P((I/g+L[0])*v,(z/g+L[1])*v)}function su(u,t,s,h,g,v,b,E,I,z){const L=u.text.placedSymbolArray,N=u.text.dynamicLayoutVertexArray,F=u.icon.dynamicLayoutVertexArray,q={},X=u.getProjection(),G=Mu(b,X,g),Y=g.elevation,J=X.upVectorScale(b.canonical,g.center.lat,g.worldSize).metersToTile;N.clear();for(let re=0;re<L.length;re++){const pe=L.get(re),{tileAnchorX:_e,tileAnchorY:Ae,numGlyphs:Ie}=pe,Te=pe.hidden||!pe.crossTileID||u.allowVerticalPlacement&&!pe.placedOrientation?null:h[pe.crossTileID];if(Te){let ve=0,Pe=0,Me=0;if(Y){const _t=Y?Y.getAtTileOffset(b,_e,Ae):0,[nt,Tt,jt]=X.upVector(b.canonical,_e,Ae);ve=_t*nt*J,Pe=_t*Tt*J,Me=_t*jt*J}let[We,Qe,ft,pt]=Vo(pe.projectedAnchorX+ve,pe.projectedAnchorY+Pe,pe.projectedAnchorZ+Me,s?G:v);const Et=jc(g.getCameraToCenterDistance(X),pt);let Ke=r.bJ(u.textSizeData,I,pe)*Et/r.bO;s&&(Ke*=u.tilePixelRatio/E);const st=_c(Te,Ke);s?({x:We,y:Qe,z:ft}=X.projectTilePoint(_e+st.x,Ae+st.y,b.canonical),[We,Qe,ft]=Vo(We+ve,Qe+Pe,ft+Me,v)):(t&&st._rotate(-g.angle),We+=st.x,Qe+=st.y,ft=0);const Ve=u.allowVerticalPlacement&&pe.placedOrientation===r.bI.vertical?Math.PI/2:0;for(let _t=0;_t<Ie;_t++)r.bL(N,We,Qe,ft,Ve);z&&pe.associatedIconIndex>=0&&(q[pe.associatedIconIndex]={x:We,y:Qe,z:ft,angle:Ve})}else Os(Ie,N)}if(z){F.clear();const re=u.icon.placedSymbolArray;for(let pe=0;pe<re.length;pe++){const _e=re.get(pe),{numGlyphs:Ae}=_e,Ie=q[pe];if(_e.hidden||!Ie)Os(Ae,F);else{const{x:Te,y:ve,z:Pe,angle:Me}=Ie;for(let We=0;We<Ae;We++)r.bL(F,Te,ve,Pe,Me)}}u.icon.dynamicLayoutVertexBuffer.updateData(F)}u.text.dynamicLayoutVertexBuffer.updateData(N)}function yc(u,t,s,h,g,v,b={}){const E=s.paint.get("icon-translate"),I=s.paint.get("text-translate"),z=s.paint.get("icon-translate-anchor"),L=s.paint.get("text-translate-anchor"),N=s.layout.get("icon-rotation-alignment"),F=s.layout.get("text-rotation-alignment"),q=s.layout.get("icon-pitch-alignment"),X=s.layout.get("text-pitch-alignment"),G=s.layout.get("icon-keep-upright"),Y=s.layout.get("text-keep-upright"),J=s.paint.get("icon-color-saturation"),re=s.paint.get("icon-color-contrast"),pe=s.paint.get("icon-color-brightness-min"),_e=s.paint.get("icon-color-brightness-max"),Ae=s.layout.get("symbol-elevation-reference")==="sea",Ie=u.context,Te=Ie.gl,ve=u.transform,Pe=N==="map",Me=F==="map",We=q==="map",Qe=X==="map",ft=s.layout.get("symbol-sort-key").constantOr(1)!==void 0;let pt=!1;const Et=u.depthModeForSublayer(0,sn.ReadOnly),Ke=new sn(u.context.gl.LEQUAL,sn.ReadOnly,u.depthRangeFor3D),st=[r.aD(ve.center.lng),r.aH(ve.center.lat)],Ve=s.layout.get("text-variable-anchor"),_t=ve.projection.name==="globe",nt=[],Tt=[0,-1,0];for(const jt of h){const yt=t.getTile(jt),Lt=yt.getBucket(s);if(!Lt||Lt.projection.name==="mercator"&&_t||Lt.fullyClipped)continue;const Yt=Lt.projection.name==="globe",tn=Yt?r.ah(ve.zoom):0,Xt=Mu(jt,Lt.getProjection(),ve),rn=ve.calculatePixelsToTileUnitsMatrix(yt),fn=Ve&&Lt.hasTextData(),_n=Lt.hasIconTextFit()&&fn&&Lt.hasIconData(),Pn=Lt.getProjection().createInversionMatrix(ve,jt.canonical),Wn=(1<<yt.tileID.canonical.z)*r.aj/u.transform.worldSize,vi=nr=>{let Mi=[0,0,0];if(nr){const Mr=u.style.directionalLight,yi=u.style.ambientLight;Mr&&yi&&(Mi=Sl(u.style,Mr,yi))}return Mi},Ji=nr=>{ve.depthOcclusionForSymbolsAndCircles&&(s.hasInitialOcclusionOpacityProperties||u.terrain)&&(nr.push("DEPTH_D24"),nr.push("DEPTH_OCCLUSION"))},Oi=()=>{const nr=Pe&&s.layout.get("symbol-placement")!=="point",Mi=[];Ji(Mi);const Mr=nr||_n,yi=Lt.elevationType==="road"&&We,Rr=u.shadowRenderer,cr=yi&&!!Rr&&Rr.enabled,Ni=vi(cr),ir=yi?Ke:Et,$n=s.paint.get("icon-image-cross-fade");u.terrainRenderModeElevated()&&We&&Mi.push("PITCH_WITH_MAP_TERRAIN"),Yt&&(Mi.push("PROJECTION_GLOBE_VIEW"),Mr&&Mi.push("PROJECTED_POS_ON_VIEWPORT")),$n>0&&Mi.push("ICON_TRANSITION"),Lt.icon.zOffsetVertexBuffer&&Mi.push("Z_OFFSET"),J===0&&re===0&&pe===0&&_e===1||Mi.push("COLOR_ADJUSTMENT"),Lt.sdfIcons&&Mi.push("RENDER_SDF"),cr&&Mi.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),yi&&Lt.icon.orientationVertexBuffer&&Mi.push("ELEVATED_ROADS");const Br=Lt.icon.programConfigurations.get(s.id),ks=u.getOrCreateProgram("symbol",{config:Br,defines:Mi}),fr=yt.imageAtlasTexture?yt.imageAtlasTexture.size:[0,0],Pi=Lt.iconSizeData,Do=r.bH(Pi,ve.zoom),xo=We||!ve.isOrthographic,ha=yl(Xt,yt.tileID.canonical,We,Pe,ve,Lt.getProjection(),rn),ms=Pu(Xt,yt.tileID.canonical,We,Pe,ve,Lt.getProjection(),rn),Qo=u.translatePosMatrix(ms,yt,E,z,!0),Oo=u.translatePosMatrix(Xt,yt,E,z),Bo=Mr?tl:ha,Jo=Pe&&!We&&!nr;let ea=Tt;!_t&&!ve.mercatorFromTransition||Pe||(ea=gc(ve));const Cc=Yt?ea:Tt,pd=s.getColorAdjustmentMatrix(J,re,pe,_e),Ec=Xu(Pi.kind,Do,Jo,We,u,Oo,Bo,Qo,Ae,!1,fr,[0,0],0,jt,tn,st,Pn,Cc,Lt.getProjection(),Ni,Wn,pd,$n,null),tf=yt.imageAtlasTexture?yt.imageAtlasTexture:null,yu=s.layout.get("icon-size").constantOr(0)!==1||Lt.iconsNeedLinear,fp=Lt.sdfIcons||u.options.rotating||u.options.zooming||yu||xo?Te.LINEAR:Te.NEAREST,fd=Lt.sdfIcons&&s.paint.get("icon-halo-width").constantOr(1)!==0,Ba=u.terrain&&We&&nr?r.bi(r.bz(),ha):tl;if(nr&&Lt.icon){const Fl=ve.elevation,hl=Fl?Fl.getAtTileOffsetFunc(jt,ve.center.lat,ve.worldSize,Lt.getProjection()):null,jl=Ed(Xt,yt.tileID.canonical,We,Pe,ve,Lt.getProjection(),rn);Aa(Lt,Xt,u,!1,jl,ms,We,G,hl,jt)}return{program:ks,buffers:Lt.icon,uniformValues:Ec,atlasTexture:tf,atlasTextureIcon:null,atlasInterpolation:fp,atlasInterpolationIcon:null,isSDF:Lt.sdfIcons,hasHalo:fd,depthMode:ir,tile:yt,renderWithShadows:cr,labelPlaneMatrixInv:Ba}},Ai=()=>{const nr=Me&&s.layout.get("symbol-placement")!=="point",Mi=[],Mr=nr||Ve||_n,yi=Lt.elevationType==="road"&&Qe,Rr=u.shadowRenderer,cr=yi&&!!Rr&&Rr.enabled,Ni=vi(cr),ir=yi?Ke:Et;u.terrainRenderModeElevated()&&Qe&&Mi.push("PITCH_WITH_MAP_TERRAIN"),Yt&&(Mi.push("PROJECTION_GLOBE_VIEW"),Mr&&Mi.push("PROJECTED_POS_ON_VIEWPORT")),Lt.text.zOffsetVertexBuffer&&Mi.push("Z_OFFSET"),Lt.iconsInText&&Mi.push("RENDER_TEXT_AND_SYMBOL"),Mi.push("RENDER_SDF"),cr&&Mi.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),yi&&Lt.text.orientationVertexBuffer&&Mi.push("ELEVATED_ROADS"),Ji(Mi);const $n=Lt.text.programConfigurations.get(s.id),Br=u.getOrCreateProgram("symbol",{config:$n,defines:Mi});let ks,fr=[0,0],Pi=null;const Do=Lt.textSizeData;Lt.iconsInText&&(fr=yt.imageAtlasTexture?yt.imageAtlasTexture.size:[0,0],Pi=yt.imageAtlasTexture?yt.imageAtlasTexture:null,ks=Qe||!ve.isOrthographic||u.options.rotating||u.options.zooming||Do.kind==="composite"||Do.kind==="camera"?Te.LINEAR:Te.NEAREST);const xo=yt.glyphAtlasTexture?yt.glyphAtlasTexture.size:[0,0],ha=s.layout.get("text-size-scale-range"),ms=r.ay(u.scaleFactor,ha[0],ha[1]),Qo=r.bH(Do,ve.zoom,ms),Oo=yl(Xt,yt.tileID.canonical,Qe,Me,ve,Lt.getProjection(),rn),Bo=Pu(Xt,yt.tileID.canonical,Qe,Me,ve,Lt.getProjection(),rn),Jo=u.translatePosMatrix(Bo,yt,I,L,!0),ea=u.translatePosMatrix(Xt,yt,I,L),Cc=Mr?tl:Oo,pd=Me&&!Qe&&!nr;let Ec=Tt;!_t&&!ve.mercatorFromTransition||Me||(Ec=gc(ve));const tf=Xu(Do.kind,Qo,pd,Qe,u,ea,Cc,Jo,Ae,!0,xo,fr,0,jt,tn,st,Pn,Yt?Ec:Tt,Lt.getProjection(),Ni,Wn,null,null,ms),yu=yt.glyphAtlasTexture?yt.glyphAtlasTexture:null,fp=Te.LINEAR,fd=s.paint.get("text-halo-width").constantOr(1)!==0,Ba=u.terrain&&Qe&&nr?r.bi(r.bz(),Oo):tl;if(nr&&Lt.text){const Fl=ve.elevation,hl=Fl?Fl.getAtTileOffsetFunc(jt,ve.center.lat,ve.worldSize,Lt.getProjection()):null,jl=Ed(Xt,yt.tileID.canonical,Qe,Me,ve,Lt.getProjection(),rn);Aa(Lt,Xt,u,!0,jl,Bo,Qe,Y,hl,jt)}return{program:Br,buffers:Lt.text,uniformValues:tf,atlasTexture:yu,atlasTextureIcon:Pi,atlasInterpolation:fp,atlasInterpolationIcon:ks,isSDF:!0,hasHalo:fd,depthMode:ir,tile:yt,renderWithShadows:cr,labelPlaneMatrixInv:Ba}},Dr=Lt.icon.segments.get().length,Dn=Lt.text.segments.get().length,Zn=Dr&&!b.onlyText?Oi():null,si=Dn&&!b.onlyIcons?Ai():null,er=s.paint.get("icon-opacity").constantOr(1),Hr=s.paint.get("text-opacity").constantOr(1);if(ft&&Lt.canOverlap){pt=!0;const nr=er&&!b.onlyText?Lt.icon.segments.get():[],Mi=Hr&&!b.onlyIcons?Lt.text.segments.get():[];for(const Mr of nr)nt.push({segments:new r.bd([Mr]),sortKey:Mr.sortKey,state:Zn});for(const Mr of Mi)nt.push({segments:new r.bd([Mr]),sortKey:Mr.sortKey,state:si})}else b.onlyText||nt.push({segments:er?Lt.icon.segments:new r.bd([]),sortKey:0,state:Zn}),b.onlyIcons||nt.push({segments:Hr?Lt.text.segments:new r.bd([]),sortKey:0,state:si})}pt&&nt.sort((jt,yt)=>jt.sortKey-yt.sortKey);for(const jt of nt){const yt=jt.state;if(yt)if(u.terrain?u.terrain.setupElevationDraw(yt.tile,yt.program,{useDepthForOcclusion:ve.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:yt.labelPlaneMatrixInv}):u.setupDepthForOcclusion(ve.depthOcclusionForSymbolsAndCircles,yt.program),Ie.activeTexture.set(Te.TEXTURE0),yt.atlasTexture&&yt.atlasTexture.bind(yt.atlasInterpolation,Te.CLAMP_TO_EDGE,!0),yt.atlasTextureIcon&&(Ie.activeTexture.set(Te.TEXTURE1),yt.atlasTextureIcon&&yt.atlasTextureIcon.bind(yt.atlasInterpolationIcon,Te.CLAMP_TO_EDGE,!0)),yt.renderWithShadows&&u.shadowRenderer.setupShadows(yt.tile.tileID.toUnwrapped(),yt.program,"vector-tile",yt.tile.tileID.overscaledZ),u.uploadCommonLightUniforms(u.context,yt.program),yt.hasHalo){const Lt=yt.uniformValues;Lt.u_is_halo=1,vc(yt.buffers,jt.segments,s,u,yt.program,yt.depthMode,g,v,Lt,2),Lt.u_is_halo=0}else{if(yt.isSDF){const Lt=yt.uniformValues;yt.hasHalo&&(Lt.u_is_halo=1,vc(yt.buffers,jt.segments,s,u,yt.program,yt.depthMode,g,v,Lt,1)),Lt.u_is_halo=0}vc(yt.buffers,jt.segments,s,u,yt.program,yt.depthMode,g,v,yt.uniformValues,1)}}}function vc(u,t,s,h,g,v,b,E,I,z){const L=[u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer,u.iconTransitioningVertexBuffer,u.globeExtVertexBuffer,u.zOffsetVertexBuffer,u.orientationVertexBuffer];g.draw(h,h.context.gl.TRIANGLES,v,b,E,Sn.disabled,I,s.id,u.layoutVertexBuffer,u.indexBuffer,t,s.paint,h.transform.zoom,u.programConfigurations.get(s.id),L,z)}function Ju(u,t){const s=1<<u.canonical.z,h=(t.x*s-u.canonical.x-u.wrap*s)*r.aj,g=(t.y*s-u.canonical.y)*r.aj,v=r.dS(t.z,t.y);return r.cS(h,g,v)}function Yh(u,t,s,h,g){if(!s.layout||s.layout.get("fill-elevation-reference")==="none")return;const v=u.context.gl,b=new sn(u.context.gl.LEQUAL,sn.ReadWrite,u.depthRangeFor3D),E=new sn(u.context.gl.GREATER,sn.ReadWrite,u.depthRangeFor3D),I=function(q){const X=r.cJ(q.pitch);let G=.01;return q.isOrthographic&&(G=r.ai(1e-4,G,r.cN(X>=vs?1:X/vs))),2*G}(u.transform),z=u.transform.getFreeCameraOptions().position,L="elevatedStructuresDepthReconstruct",N=u.getOrCreateProgram(L,{defines:["DEPTH_RECONSTRUCTION"]}),F=u.getOrCreateProgram(L);for(const q of h){const X=t.getTile(q),G=X.getBucket(s);if(!G)continue;const Y=G.elevatedStructures;if(!Y)continue;const J=G.elevationBufferData.heightRange,re=Ju(q.toUnwrapped(),z),pe=u.translatePosMatrix(q.projMatrix,X,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));let _e,Ae,Ie,Te;if(g==="initialize"){if(!J||J.min>=1||Y.depthSegments.segments[0].primitiveLength===0)continue;_e=Mo(pe,re,I,1,0),Ae=b,Ie=Y.depthSegments,Te=N}else if(g==="reset"){if(!J||J.min>=0||Y.maskSegments.segments[0].primitiveLength===0)continue;_e=Mo(pe,re,0,0,1),Ae=E,Ie=Y.maskSegments,Te=N}else if(g==="geometry"){if(Y.depthSegments.segments[0].primitiveLength===0)continue;_e=Mo(pe,re,I,1,0),Ae=b,Ie=Y.depthSegments,Te=F}Te.draw(u,v.TRIANGLES,Ae,In.disabled,ii.disabled,Sn.disabled,_e,s.id,Y.vertexBuffer,Y.indexBuffer,Ie,s.paint,u.transform.zoom)}}function xc(u,t,s){const{painter:h,sourceCache:g,layer:v,coords:b,colorMode:E,elevationType:I,terrainEnabled:z,pass:L}=u,N=h.context.gl,F=v.paint.get("fill-pattern"),q=v.paint.get("fill-pattern-cross-fade"),X=F.constantOr(null);let G=I;I!=="road"||t&&!z||(G="none");const Y=G==="road",J=u.painter.shadowRenderer,re=Y&&!!J&&J.enabled,pe=new sn(h.context.gl.LEQUAL,sn.ReadOnly,h.depthRangeFor3D);let _e=[0,0,0];if(re){const Te=h.style.directionalLight,ve=h.style.ambientLight;Te&&ve&&(_e=Sl(h.style,Te,ve))}const Ae=F&&F.constantOr(1),Ie=(Te,ve)=>{let Pe,Me,We,Qe,ft;ve?(Pe=Ae&&!v.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",We=N.LINES):(Pe=Ae?"fillPattern":"fill",We=N.TRIANGLES);for(const pt of b){const Et=g.getTile(pt);if(Ae&&!Et.patternsLoaded())continue;const Ke=Et.getBucket(v);if(!Ke)continue;const st=t?Ke.elevationBufferData:Ke.bufferData;if(st.isEmpty())continue;h.prepareDrawTile();const Ve=st.programConfigurations.get(v.id),_t=h.isTileAffectedByFog(pt),nt=[],Tt=[];Y&&(nt.push("ELEVATED_ROADS"),Tt.push(st.elevatedLayoutVertexBuffer)),re&&nt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ae&&(h.context.activeTexture.set(N.TEXTURE0),Et.imageAtlasTexture&&Et.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Ve.updatePaintBuffers());let jt=!1;if(X&&Et.imageAtlas){const Xt=Et.imageAtlas,rn=r.dN.from(X),fn=rn.getPrimary().scaleSelf(r.q.devicePixelRatio).toString(),_n=rn.getSecondary(),Pn=Xt.patternPositions.get(fn),Wn=_n?Xt.patternPositions.get(_n.scaleSelf(r.q.devicePixelRatio).toString()):null;jt=!!Pn&&!!Wn,Pn&&Ve.setConstantPatternPositions(Pn,Wn)}q>0&&(jt||Ve.getPatternTransitionVertexBuffer("fill-pattern"))&&nt.push("FILL_PATTERN_TRANSITION");const yt=h.getOrCreateProgram(Pe,{config:Ve,overrideFog:_t,defines:nt}),Lt=h.translatePosMatrix(pt.projMatrix,Et,v.paint.get("fill-translate"),v.paint.get("fill-translate-anchor"));re&&J.setupShadows(Et.tileID.toUnwrapped(),yt,"vector-tile",Et.tileID.overscaledZ);const Yt=v.paint.get("fill-emissive-strength");if(ve){Qe=st.lineIndexBuffer,ft=st.lineSegments;const Xt=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[N.drawingBufferWidth,N.drawingBufferHeight];Me=Pe==="fillOutlinePattern"&&Ae?Hd(Lt,Yt,h,Et,Xt,_e,q):Ku(Lt,Yt,Xt,_e)}else Qe=st.indexBuffer,ft=st.triangleSegments,Me=Ae?nu(Lt,Yt,h,Et,_e,q):Zo(Lt,Yt,_e);h.uploadCommonUniforms(h.context,yt,pt.toUnwrapped());let tn=Te;(I==="road"&&!z||I==="offset")&&(tn=pe),yt.draw(h,We,tn,s||h.stencilModeForClipping(pt),E,Sn.disabled,Me,v.id,st.layoutVertexBuffer,Qe,ft,v.paint,h.transform.zoom,Ve,Tt)}};h.renderPass===L&&Ie(h.depthModeForSublayer(1,h.renderPass==="opaque"?sn.ReadWrite:sn.ReadOnly),!1),G==="none"&&h.renderPass==="translucent"&&v.paint.get("fill-antialias")&&Ie(h.depthModeForSublayer(v.getPaintProperty("fill-outline-color")?2:0,sn.ReadOnly),!0)}function As(u,t,s,h,g,v,b,E){s.resetLayerRenderingStats(u);const I=u.context,z=I.gl,L=u.transform,N=s.paint.get("fill-extrusion-pattern"),F=s.paint.get("fill-extrusion-pattern-cross-fade"),q=N.constantOr(null),X=N.constantOr(1),G=s.paint.get("fill-extrusion-opacity"),Y=u.style.enable3dLights(),J=s.paint.get(Y&&!X?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),re=[s.paint.get("fill-extrusion-ambient-occlusion-intensity"),J],pe=s.layout.get("fill-extrusion-edge-radius"),_e=pe>0&&!s.paint.get("fill-extrusion-rounded-roof"),Ae=_e?0:pe,Ie=L.projection.name==="globe"?r.dV():0,Te=L.projection.name==="globe",ve=Te?r.ah(L.zoom):0,Pe=[r.aD(L.center.lng),r.aH(L.center.lat)],Me=s.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",We=s.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(Me?null:s.lut).toArray01().slice(0,3),Qe=s.paint.get("fill-extrusion-flood-light-intensity"),ft=s.paint.get("fill-extrusion-vertical-scale"),pt=s.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Et=s.paint.get("fill-extrusion-height-alignment"),Ke=s.paint.get("fill-extrusion-base-alignment"),st=$o(u,s.paint.get("fill-extrusion-cutoff-fade-range")),Ve=[];let _t;Te&&Ve.push("PROJECTION_GLOBE_VIEW"),re[0]>0&&Ve.push("FAUX_AO"),_e&&Ve.push("ZERO_ROOF_RADIUS"),E&&Ve.push("HAS_CENTROID"),Qe>0&&Ve.push("FLOOD_LIGHT"),st.shouldRenderCutoff&&Ve.push("RENDER_CUTOFF"),pt&&Ve.push("RENDER_WALL_MODE");const nt=u.renderPass==="shadow",Tt=u.shadowRenderer,jt=nt&&!!Tt,yt=nt?Sn.disabled:Sn.backCCW;u.shadowRenderer&&(u.shadowRenderer.useNormalOffset=!0);let Lt=[0,0,0];if(Tt){const Xt=u.style.directionalLight,rn=u.style.ambientLight;Xt&&rn&&(Lt=Sl(u.style,Xt,rn)),nt||(Ve.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Tt.useNormalOffset&&Ve.push("NORMAL_OFFSET")),_t=Ve.concat(["SHADOWS_SINGLE_CASCADE"])}const Yt=jt?"fillExtrusionDepth":X?"fillExtrusionPattern":"fillExtrusion",tn=s.getLayerRenderingStats();for(const Xt of h){const rn=t.getTile(Xt),fn=rn.getBucket(s);if(!fn||fn.projection.name!==L.projection.name)continue;let _n=!1;Tt&&(_n=Tt.getMaxCascadeForTile(Xt.toUnwrapped())===0);const Pn=u.isTileAffectedByFog(Xt),Wn=fn.programConfigurations.get(s.id);let vi=!1;if(q&&rn.imageAtlas){const si=rn.imageAtlas,er=r.dN.from(q),Hr=er.getPrimary().scaleSelf(r.q.devicePixelRatio).toString(),nr=er.getSecondary(),Mi=si.patternPositions.get(Hr),Mr=nr?si.patternPositions.get(nr.scaleSelf(r.q.devicePixelRatio).toString()):null;vi=!!Mi&&!!Mr,Mi&&Wn.setConstantPatternPositions(Mi,Mr)}F>0&&(vi||Wn.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&Ve.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Ji=u.getOrCreateProgram(Yt,{config:Wn,defines:_n?_t:Ve,overrideFog:Pn});if(u.terrain&&u.terrain.setupElevationDraw(rn,Ji,{useMeterToDem:!0}),!fn.centroidVertexBuffer){const si=Ji.attributes.a_centroid_pos;si!==void 0&&z.vertexAttrib2f(si,0,0)}!nt&&Tt&&Tt.setupShadows(rn.tileID.toUnwrapped(),Ji,"vector-tile",rn.tileID.overscaledZ),X&&(u.context.activeTexture.set(z.TEXTURE0),rn.imageAtlasTexture&&rn.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Wn.updatePaintBuffers());const Oi=s.paint.get("fill-extrusion-vertical-gradient"),Ai=1/fn.tileToMeter;let Dr;if(nt&&Tt){if(il(rn.tileID,fn,u))continue;const si=Tt.calculateShadowPassMatrixFromTile(rn.tileID.toUnwrapped());Dr=Np(si,Ae,Ai,ft,Et,Ke)}else{const si=u.translatePosMatrix(Xt.expandedProjMatrix,rn,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),er=L.projection.createInversionMatrix(L,Xt.canonical);Dr=X?Bf(si,u,Oi,G,re,Ae,Ai,Xt,rn,Ie,Et,Ke,ve,Pe,er,We,ft,F):tu(si,u,Oi,G,re,Ae,Ai,Xt,Ie,Et,Ke,ve,Pe,er,We,ft,Qe,Lt)}u.uploadCommonUniforms(I,Ji,Xt.toUnwrapped(),null,st);let Dn=fn.segments;if(L.projection.name==="mercator"&&!nt&&(Dn=fn.getVisibleSegments(rn.tileID,u.terrain,u.transform.getFrustum(0)),!Dn.get().length))continue;if(tn)if(nt)for(const si of Dn.get())tn.numRenderedVerticesInShadowPass+=si.primitiveLength;else for(const si of Dn.get())tn.numRenderedVerticesInTransparentPass+=si.primitiveLength;const Zn=[];(u.terrain||E)&&Zn.push(fn.centroidVertexBuffer),Te&&Zn.push(fn.layoutVertexExtBuffer),pt&&Zn.push(fn.wallVertexBuffer),Ji.draw(u,I.gl.TRIANGLES,g,v,b,yt,Dr,s.id,fn.layoutVertexBuffer,fn.indexBuffer,Dn,s.paint,u.transform.zoom,Wn,Zn)}u.shadowRenderer&&(u.shadowRenderer.useNormalOffset=!1)}function Ro(u,t,s,h,g,v,b,E,I,z,L,N,F,q,X,G,Y,J,re){const pe=u.context,_e=pe.gl,Ae=u.transform,Ie=u.transform.zoom,Te=[],ve=$o(u,s.paint.get("fill-extrusion-cutoff-fade-range"));z==="clear"?(Te.push("CLEAR_SUBPASS"),re&&(Te.push("CLEAR_FROM_TEXTURE"),pe.activeTexture.set(_e.TEXTURE0),re.bind(_e.LINEAR,_e.CLAMP_TO_EDGE))):z==="sdf"&&Te.push("SDF_SUBPASS"),Y&&Te.push("HAS_CENTROID"),ve.shouldRenderCutoff&&Te.push("RENDER_CUTOFF");const Pe=s.layout.get("fill-extrusion-edge-radius"),Me=(We,Qe,ft,pt,Et)=>{const Ke=Qe.programConfigurations.get(s.id),st=u.isTileAffectedByFog(We),Ve=u.getOrCreateProgram("fillExtrusionGroundEffect",{config:Ke,defines:Te,overrideFog:st}),_t=((Tt,jt,yt,Lt,Yt,tn,Xt,rn,fn,_n,Pn)=>({u_matrix:jt,u_opacity:yt,u_ao_pass:Lt?1:0,u_meter_to_tile:Yt,u_ao:tn,u_flood_light_intensity:Xt,u_flood_light_color:rn,u_attenuation:fn,u_edge_radius:_n,u_fb:0,u_fb_size:Pn,u_dynamic_offset:1}))(0,pt,L,I,Et,[N,F*Et],q,X,G,Ie>=17?0:Pe*Et,re?re.size[0]:0),nt=[];Y&&nt.push(Qe.hiddenByLandmarkVertexBuffer),u.uploadCommonUniforms(pe,Ve,We.toUnwrapped(),null,ve),Ve.draw(u,pe.gl.TRIANGLES,g,v,b,E,_t,s.id,Qe.vertexBuffer,Qe.indexBuffer,ft,s.paint,Ie,Ke,nt)};for(const We of h){const Qe=t.getTile(We),ft=Qe.getBucket(s);if(!ft||ft.projection.name!==Ae.projection.name||!ft.groundEffect||ft.groundEffect&&!ft.groundEffect.hasData())continue;const pt=ft.groundEffect,Et=1/ft.tileToMeter;{const Ke=u.translatePosMatrix(We.projMatrix,Qe,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),st=pt.getDefaultSegment();Me(We,pt,st,Ke,Et)}if(J)for(let Ke=0;Ke<4;Ke++){const st=r.dT[Ke](We),Ve=t.getTile(st);if(!Ve)continue;const _t=Ve.getBucket(s);if(!_t||_t.projection.name!==Ae.projection.name||!_t.groundEffect||_t.groundEffect&&!_t.groundEffect.hasData())continue;const nt=_t.groundEffect;let Tt,jt;Ke===0?(Tt=[-8192,0,0],jt=1):Ke===1?(Tt=[r.aj,0,0],jt=0):Ke===2?(Tt=[0,-8192,0],jt=3):(Tt=[0,r.aj,0],jt=2);const yt=nt.regionSegments[jt];if(!yt)continue;const Lt=new Float32Array(16);r.bo(Lt,We.projMatrix,Tt),Me(We,nt,yt,u.translatePosMatrix(Lt,Qe,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Et)}}}function nn(u,t,s,h,g,v,b){h.centroidVertexArray.length===0&&h.createCentroidsBuffer();const E=v?v.findDEMTileFor(s):null;if(!(E&&E.dem||b))return;v&&E&&E.dem&&h.selfDEMTileTimestamp!==E.dem._timestamp&&(h.borderDoneWithNeighborZ=[-1,-1,-1,-1],h.selfDEMTileTimestamp=E.dem._timestamp);const I=J=>new r.P(Math.ceil((J+r.dX)*r.dY),0),z=J=>{const re=t.getSource().minzoom,pe=Ae=>{const Ie=t.getTileByID(Ae);if(Ie&&Ie.hasData())return Ie.getBucket(g)},_e=[0,-1,1];for(const Ae of _e){if(J.overscaledZ+Ae<re)continue;const Ie=pe(J.calculateScaledKey(J.overscaledZ+Ae));if(Ie)return Ie}},L=[0,0,0],N=(J,re)=>(L[0]=Math.min(J.min.y,re.min.y),L[1]=Math.max(J.max.y,re.max.y),L[2]=r.aj-re.min.x>J.max.x?re.min.x-r.aj:J.max.x,L),F=(J,re)=>(L[0]=Math.min(J.min.x,re.min.x),L[1]=Math.max(J.max.x,re.max.x),L[2]=r.aj-re.min.y>J.max.y?re.min.y-r.aj:J.max.y,L),q=[(J,re)=>N(J,re),(J,re)=>N(re,J),(J,re)=>F(J,re),(J,re)=>F(re,J)],X=(J,re,pe,_e,Ae,Ie,Te)=>{if(!v)return 0;const ve=[[Ie?pe:J,Ie?J:pe,0],[Ie?pe:re,Ie?re:pe,0]],Pe=Te<0?r.aj+Te:Te,Me=[Ie?Pe:(J+re)/2,Ie?(J+re)/2:Pe,0];return pe===0&&Te<0||pe!==0&&Te>0?v.getForTilePoints(Ae,[Me],!0,_e):ve.push(Me),v.getForTilePoints(s,ve,!0,E),Math.max(ve[0][2],ve[1][2],Me[2])/v.exaggeration()};for(let J=0;J<4;J++){const re=h.borderFeatureIndices[J];if(re.length===0)continue;const pe=r.dT[J](s),_e=z(pe);if(!(_e&&_e instanceof r.dU))continue;const Ae=v?v.findDEMTileFor(pe):null;if(!(Ae&&Ae.dem||b)||(v&&Ae&&Ae.dem&&h.borderDEMTileTimestamp[J]!==Ae.dem._timestamp&&(h.borderDoneWithNeighborZ[J]=-1,h.borderDEMTileTimestamp[J]=Ae.dem._timestamp),h.borderDoneWithNeighborZ[J]===_e.canonical.z))continue;_e.centroidVertexArray.length===0&&_e.createCentroidsBuffer();const Ie=(J<2?1:5)-J,Te=_e.borderDoneWithNeighborZ[Ie]!==h.canonical.z,ve=_e.borderFeatureIndices[Ie];let Pe=0;if(h.canonical.z!==_e.canonical.z){for(const Me of re)h.showCentroid(h.featuresOnBorder[Me]);if(Te)for(const Me of ve)_e.showCentroid(_e.featuresOnBorder[Me]);h.borderDoneWithNeighborZ[J]=_e.canonical.z,_e.borderDoneWithNeighborZ[Ie]=h.canonical.z}for(const Me of re){const We=h.featuresOnBorder[Me],Qe=h.centroidData[We.centroidDataIndex],ft=We.borders[J];let pt;for(;Pe<ve.length;){pt=_e.featuresOnBorder[ve[Pe]];const Et=pt.borders[Ie];if(Et[1]>ft[0]+3||Et[0]>ft[0]-3)break;_e.showCentroid(pt),Pe++}if(pt&&Pe<ve.length){const Et=Pe;let Ke=0;for(;!(pt.borders[Ie][0]>ft[1]-3)&&(Ke++,++Pe!==ve.length);)pt=_e.featuresOnBorder[ve[Pe]];pt=_e.featuresOnBorder[ve[Et]];let st=!1;if(Ke>=1){const nt=pt.borders[Ie];Math.abs(ft[0]-nt[0])<3&&Math.abs(ft[1]-nt[1])<3&&(Ke=1,st=!0,Pe=Et+1)}else if(Ke===0){h.showCentroid(We);continue}const Ve=_e.centroidData[pt.centroidDataIndex];b&&st&&(((G=Qe).flags|(Y=Ve).flags)&r.dW?(G.flags|=r.dW,Y.flags|=r.dW):(G.flags&=2147483647,Y.flags&=2147483647));const _t=We.intersectsCount()>1||pt.intersectsCount()>1;if(Ke>1)Pe=Et,Qe.centroidXY=Ve.centroidXY=new r.P(0,0);else if(Ae&&Ae.dem&&!_t){const nt=q[J](Qe,Ve),Tt=J%2?r.aj-1:0,jt=X(nt[0],Math.min(r.aj-1,nt[1]),Tt,Ae,pe,J<2,nt[2]);Qe.centroidXY=Ve.centroidXY=I(jt)}else _t?Qe.centroidXY=Ve.centroidXY=new r.P(0,0):(Qe.centroidXY=h.encodeBorderCentroid(We),Ve.centroidXY=_e.encodeBorderCentroid(pt));h.writeCentroidToBuffer(Qe),_e.writeCentroidToBuffer(Ve)}else h.showCentroid(We)}h.borderDoneWithNeighborZ[J]=_e.canonical.z,_e.borderDoneWithNeighborZ[Ie]=h.canonical.z}var G,Y;(h.needsCentroidUpdate||!h.centroidVertexBuffer&&h.centroidVertexArray.length!==0)&&h.uploadCentroid(u)}const qp=[1,0,0],nl=[0,1,0],zo=[0,0,1];function il(u,t,s){const h=s.transform,g=s.shadowRenderer;if(!g)return!0;const v=u.toUnwrapped(),b=h.tileSize*g._cascades[s.currentShadowCascade].scale;let E=t.maxHeight;if(h.elevation){const G=h.elevation.getMinMaxForTile(u);G&&(E+=G.max)}const I=[...g.shadowDirection];I[2]=-I[2];const z=g.computeSimplifiedTileShadowVolume(v,E,b,I);if(!z)return!1;const L=[qp,nl,zo,I,[I[0],0,I[2]],[0,I[1],I[2]]],N=h.projection.name==="globe",F=h.scaleZoom(b),q=r.cn.fromInvProjectionMatrix(h.invProjMatrix,h.worldSize,F,!N),X=g.getCurrentCascadeFrustum();return q.intersectsPrecise(z.vertices,z.planes,L)===0||X.intersectsPrecise(z.vertices,z.planes,L)===0}function wn(u){return[u[0]*r.dZ,u[1]*r.dZ,u[2]*r.dZ,0]}function la(u,t,s,h,g,v,b,E,I){const z=h.getSource(),L=s.globeSharedBuffers;if(!L)return;let N,F,q;if(t&&(N=h.getTile(t)),z instanceof r.aP?(F=z.texture,q=r.ds(0,0,s.transform)):N&&t&&(F=N.texture,q=r.ds(t.canonical.z,t.canonical.x,s.transform)),!F||!q)return;u||(q=r.cE(r.bz(),q,[1,-1,1]));const X=s.context,G=X.gl,Y=g.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR,J=s.colorModeForDrapableLayerRenderPass(v),re=b.defines;re.push("GLOBE_POLES");const pe=new sn(G.LEQUAL,sn.ReadWrite,s.depthRangeFor3D),_e=Float32Array.from(s.transform.expandedFarZProjMatrix),Ae=Float32Array.from(r.bh(r.dr(new r.cp(0,0,0))));s.terrain&&s.terrain.prepareDrawTile(),X.activeTexture.set(G.TEXTURE0),F.bind(Y,G.CLAMP_TO_EDGE),X.activeTexture.set(G.TEXTURE1),F.bind(Y,G.CLAMP_TO_EDGE),"useMipmap"in F&&X.extTextureFilterAnisotropic&&s.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,X.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,X.extTextureFilterAnisotropicMax);const[Ie,Te,ve,Pe]=t?L.getPoleBuffers(t.canonical.z,!1):L.getPoleBuffers(0,!0),Me=g.paint.get("raster-elevation");let We;u?(We=Ie,s.renderDefaultNorthPole=Me!==0):(We=Te,s.renderDefaultSouthPole=Me!==0);const Qe=wn(b.mix),ft=((Et,Ke,st,Ve,_t,nt,Tt,jt,yt,Lt,Yt,tn,Xt)=>Gh(Et,Ke,st,new Float32Array(16),new Float32Array(9),[0,0],Ve,[0,0],[0,0,0,0],1,{opacity:1,mix:0},nt,[0,0],jt,2,Lt,Yt,tn,1,0,Xt))(_e,Ae,q,r.ah(s.transform.zoom),0,g,0,Me,0,Qe,b.offset,b.range,v),pt=s.getOrCreateProgram("raster",{defines:re});s.uploadCommonUniforms(X,pt,null),pt.draw(s,G.TRIANGLES,pe,I,J,E,ft,g.id,We,ve,Pe)}function bc(u){const t=u._nearZ,s=u.projection.farthestPixelDistance(u),h=s-t,g=.2*u.height,v=t+g;return[t,s,(v-g-t)/h,(v-t)/h]}function Wd(u,t,s,h){if(u)return t instanceof Xl&&u instanceof Oc?t.getTextureDescriptor(u,s,!0):{texture:u.texture,mix:wn(h.mix),offset:h.offset,buffer:0,tileSize:1}}var Zd=r.d_([{name:"a_index",type:"Int16",components:1}]);class Qh{constructor(t,s,h,g){const v={width:h[0],height:h[1],data:null},b=t.gl;this.targetColorTexture=new r.T(t,v,b.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new r.T(t,v,b.RGBA8,{useMipmap:!1}),this.context=t,this.updateParticleTexture(s,g),this.lastInvalidatedAt=0}updateParticleTexture(t,s){if(this.particleTextureDimension===s.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const h=this.context.gl,g=s.width*s.height;this.particleTexture0=new r.T(this.context,s,h.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new r.T(this.context,s,h.RGBA8,{premultiply:!1,useMipmap:!1});const v=new r.d$;v.reserve(g);for(let b=0;b<g;b++)v.emplaceBack(b);this.particleIndexBuffer=this.context.createVertexBuffer(v,Zd.members,!0),this.particleSegment=r.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=s.width}update(t){return!(this.lastInvalidatedAt<t&&(this.lastInvalidatedAt=r.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function jf(u,t,s){if(!u)return null;const h=t.getTextureDescriptor(u,s,!0);if(!h)return null;let{texture:g,mix:v,offset:b,tileSize:E,buffer:I,format:z}=h;if(!g||!z)return null;let L=!1;return z==="uint32"&&(L=!0,v[3]=0,v=aa(r.e0,v,[0,s.paint.get("raster-particle-max-speed")]),b=$d(r.e0,b,[0,s.paint.get("raster-particle-max-speed")])),{texture:g,textureOffset:[I/(E+2*I),E/(E+2*I)],tileSize:E,scalarData:L,scale:v,offset:b,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[z]]}}function eh(u){const t=u._nearZ,s=u.projection.farthestPixelDistance(u),h=s-t,g=.2*u.height,v=t+g;return[t,s,(v-g-t)/h,(v-t)/h]}const rl=new r.am(1,0,0,1),Jh=new r.am(0,1,0,1),Qs=new r.am(0,0,1,1),Pl=new r.am(1,0,1,1),Js=new r.am(0,1,1,1);function Xo(u,t,s,h,g,v){for(let b=0;b<s.length;b++)if(g){const z=new r.am(h.r*.8,h.g*.8,h.b*.8,1);wc(u,t,s[b],h,-1,-1,v),wc(u,t,s[b],h,-1,1,v),wc(u,t,s[b],h,1,1,v),wc(u,t,s[b],h,1,-1,v),wc(u,t,s[b],z,0,0,v)}else wc(u,t,s[b],h,0,0,v)}function wc(u,t,s,h,g,v,b){const E=u.context,I=u.transform,z=E.gl,L=I.projection.name==="globe",N=L?["PROJECTION_GLOBE_VIEW"]:[];let F=r.bw(s.projMatrix);if(L&&r.ah(I.zoom)>0){const Qe=r.bg(s.canonical,I),ft=r.e1(Qe);F=r.az(new Float32Array(16),I.globeMatrix,ft),r.az(F,I.projMatrix,F)}const q=r.bz();q[12]+=2*g/(r.q.devicePixelRatio*I.width),q[13]+=2*v/(r.q.devicePixelRatio*I.height),r.az(F,q,F);const X=u.getOrCreateProgram("debug",{defines:N}),G=t.getTileByID(s.key);u.terrain&&u.terrain.setupElevationDraw(G,X);const Y=sn.disabled,J=In.disabled,re=u.colorModeForRenderPass(),pe="$debug";E.activeTexture.set(z.TEXTURE0),u.emptyTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),L?G._makeGlobeTileDebugBuffers(u.context,I):G._makeDebugTileBoundsBuffers(u.context,I.projection);const _e=G._tileDebugBuffer||u.debugBuffer,Ae=G._tileDebugIndexBuffer||u.debugIndexBuffer,Ie=G._tileDebugSegments||u.debugSegments;if(X.draw(u,z.LINE_STRIP,Y,J,re,Sn.disabled,Ja(F,h.toPremultipliedRenderColor(null)),pe,_e,Ae,Ie,null,null,null,[G._globeTileDebugBorderBuffer]),b){const Qe=G.latestRawTileData,ft=Math.floor((Qe&&Qe.byteLength||0)/1024);let pt=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(pt+=` => ${s.overscaledZ}`),pt+=` ${G.state}`,pt+=` ${ft}kb`,function(Et,Ke){Et.initDebugOverlayCanvas();const st=Et.debugOverlayCanvas,Ve=Et.context.gl,_t=Et.debugOverlayCanvas.getContext("2d");_t.clearRect(0,0,st.width,st.height),_t.shadowColor="white",_t.shadowBlur=2,_t.lineWidth=1.5,_t.strokeStyle="white",_t.textBaseline="top",_t.font="bold 36px Open Sans, sans-serif",_t.fillText(Ke,5,5),_t.strokeText(Ke,5,5),Et.debugOverlayTexture.update(st),Et.debugOverlayTexture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)}(u,pt)}const Te=t.getTile(s).tileSize,ve=512/Math.min(Te,512)*(s.overscaledZ/I.zoom)*.5,Pe=G._tileDebugTextBuffer||u.debugBuffer,Me=G._tileDebugTextIndexBuffer||u.quadTriangleIndexBuffer,We=G._tileDebugTextSegments||u.debugSegments;X.draw(u,z.TRIANGLES,Y,J,ii.alphaBlended,Sn.disabled,Ja(F,r.am.transparent.toPremultipliedRenderColor(null),ve),pe,Pe,Me,We,null,null,null,[G._globeTileDebugTextBuffer])}function th(u,t,s,h){kl(u,0,t+s/2,u.transform.width,s,h)}function ts(u,t,s,h){kl(u,t-s/2,0,s,u.transform.height,h)}function kl(u,t,s,h,g,v){const b=u.context,E=b.gl;E.enable(E.SCISSOR_TEST),E.scissor(t*r.q.devicePixelRatio,s*r.q.devicePixelRatio,h*r.q.devicePixelRatio,g*r.q.devicePixelRatio),b.clear({color:v}),E.disable(E.SCISSOR_TEST)}const Kd=r.d_([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ra}=Kd;function ji(u,t,s,h){u.emplaceBack(t,s,h)}class ou{constructor(t){this.vertexArray=new r.e2,this.indices=new r.a_,ji(this.vertexArray,-1,-1,1),ji(this.vertexArray,1,-1,1),ji(this.vertexArray,-1,1,1),ji(this.vertexArray,1,1,1),ji(this.vertexArray,-1,-1,-1),ji(this.vertexArray,1,-1,-1),ji(this.vertexArray,-1,1,-1),ji(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Ra),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=r.bd.simpleSegment(0,0,36,12)}}function Yo(u,t,s,h,g,v){const b=u.context.gl,E=t.paint.get("sky-atmosphere-color"),I=t.paint.get("sky-atmosphere-halo-color"),z=t.paint.get("sky-atmosphere-sun-intensity"),L=((N,F,q,X,G)=>({u_matrix_3f:N,u_sun_direction:F,u_sun_intensity:q,u_color_tint_r:[X.r,X.g,X.b,X.a],u_color_tint_m:[G.r,G.g,G.b,G.a],u_luminance:5e-5}))(r.e4(r.dx(),h),g,z,E.toPremultipliedRenderColor(null),I.toPremultipliedRenderColor(null));b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_CUBE_MAP_POSITIVE_X+v,t.skyboxTexture,0),s.draw(u,b.TRIANGLES,sn.disabled,In.disabled,ii.unblended,Sn.frontCW,L,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const us=r.d_([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Is{constructor(t){const s=new r.e5;s.emplaceBack(-1,1,1,0,0),s.emplaceBack(1,1,1,1,0),s.emplaceBack(1,-1,1,1,1),s.emplaceBack(-1,-1,1,0,1);const h=new r.a_;h.emplaceBack(0,1,2),h.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(s,us.members),this.indexBuffer=t.createIndexBuffer(h),this.segments=r.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ns=r.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Xd{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class sl{constructor(t){this.colorModeAlphaBlendedWriteRGB=new ii([1,qc,1,qc],r.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new ii([1,0,1,0],r.am.transparent,[!1,!1,!1,!0]),this.params=new Xd,this.updateNeeded=!0,t.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),t.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),t.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),t.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(t){const s=t.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Is(s);const h=this.params.sizeRange,g=this.params.intensityRange,v=function(L){const N=r.e7(30),F=[];for(let q=0;q<L;++q){const X=2*Math.PI*N(),G=Math.acos(1-2*N())-.5*Math.PI;F.push(r.cS(Math.cos(G)*Math.cos(X),Math.cos(G)*Math.sin(X),Math.sin(G)))}return F}(this.params.starsCount),b=r.e7(300),E=new r.e6,I=new r.a_;let z=0;for(let L=0;L<v.length;++L){const N=r.bY([],v[L],200),F=Math.max(0,1+.01*h*(1*b()-.5)),q=Math.max(0,1+.01*g*(1*b()-.5));E.emplaceBack(N[0],N[1],N[2],-1,-1,F,q),E.emplaceBack(N[0],N[1],N[2],1,-1,F,q),E.emplaceBack(N[0],N[1],N[2],1,1,F,q),E.emplaceBack(N[0],N[1],N[2],-1,1,F,q),I.emplaceBack(z+0,z+1,z+2),I.emplaceBack(z+0,z+2,z+3),z+=4}this.starsVx=s.createVertexBuffer(E,Ns.members),this.starsIdx=s.createIndexBuffer(I),this.starsSegments=r.bd.simpleSegment(0,0,E.length,I.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,s){const h=t.context,g=h.gl,v=t.transform,b=new sn(g.LEQUAL,sn.ReadOnly,[0,1]),E=r.ah(v.zoom),I=t.style.getLut(s.scope),z=s.properties.get("color-use-theme")==="none",L=s.properties.get("color").toNonPremultipliedRenderColor(z?null:I).toArray01(),N=s.properties.get("high-color-use-theme")==="none",F=s.properties.get("high-color").toNonPremultipliedRenderColor(N?null:I).toArray01(),q=s.properties.get("space-color-use-theme")==="none",X=s.properties.get("space-color").toNonPremultipliedRenderColor(q?null:I).toArray01(),G=5e-4,Y=r.e8(s.properties.get("horizon-blend"),0,1,G,.25),J=r.dl(t,h,v)&&Y===G?v.worldSize/(2*Math.PI*1.025)-1:v.globeRadius,re=t.frameCounter/1e3%1,pe=r.ae(v.globeCenterInViewSpace),_e=Math.sqrt(Math.pow(pe,2)-Math.pow(J,2)),Ae=Math.acos(_e/pe),Ie=Te=>{const ve=v.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Te&&ve.push("ALPHA_PASS");const Pe=t.getOrCreateProgram("globeAtmosphere",{defines:ve}),Me=((Qe,ft,pt,Et,Ke,st,Ve,_t,nt,Tt,jt,yt)=>({u_frustum_tl:Qe,u_frustum_tr:ft,u_frustum_br:pt,u_frustum_bl:Et,u_horizon:Ke,u_transition:st,u_fadeout_range:Ve,u_color:_t,u_high_color:nt,u_space_color:Tt,u_temporal_offset:jt,u_horizon_angle:yt}))(v.frustumCorners.TL,v.frustumCorners.TR,v.frustumCorners.BR,v.frustumCorners.BL,v.frustumCorners.horizon,E,Y,L,F,X,re,Ae);t.uploadCommonUniforms(h,Pe);const We=this.atmosphereBuffer;We&&Pe.draw(t,g.TRIANGLES,b,In.disabled,Te?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Sn.backCW,Me,Te?"atmosphere_glow_alpha":"atmosphere_glow",We.vertexBuffer,We.indexBuffer,We.segments)};Ie(!1),Ie(!0)}drawStars(t,s){const h=r.ay(s.properties.get("star-intensity"),0,1);if(h===0)return;const g=t.context,v=g.gl,b=t.transform,E=t.getOrCreateProgram("stars"),I=r.b_([]);r.c0(I,I,-b._pitch),r.b$(I,I,-b.angle),r.c0(I,I,r.al(b._center.lat)),r.e9(I,I,-r.al(b._center.lng));const z=r.c3(new Float32Array(16),I),L=r.az([],b.starsProjMatrix,z),N=r.e4([],z),F=r.ea([],N),q=[0,1,0];r.dz(q,q,F),r.bY(q,q,this.params.sizeMultiplier);const X=[1,0,0];r.dz(X,X,F),r.bY(X,X,this.params.sizeMultiplier);const G=(Y=q,J=X,re=h,{u_matrix:Float32Array.from(L),u_up:Y,u_right:J,u_intensity_multiplier:re});var Y,J,re;t.uploadCommonUniforms(g,E),this.starsVx&&this.starsIdx&&E.draw(t,v.TRIANGLES,sn.disabled,In.disabled,this.colorModeAlphaBlendedWriteRGB,Sn.disabled,G,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function za(u,t){const s=[...u],h=t.cameraWorldSizeForFog/t.worldSize,g=r.bx([]);return r.cE(g,g,[h,h,1]),r.az(s,g,s),r.az(s,t.worldToFogMatrix,s),s}function Ot(u,t,s,h,g){const v=s.material,b=h.context,{baseColorTexture:E,metallicRoughnessTexture:I}=v.pbrMetallicRoughness,{normalTexture:z,occlusionTexture:L,emissionTexture:N}=v;function F(X,G,Y){if(X&&(u.push(G),b.activeTexture.set(b.gl.TEXTURE0+Y),X.gfxTexture)){const{minFilter:J,magFilter:re,wrapS:pe,wrapT:_e}=X.sampler;X.gfxTexture.bindExtraParam(J,re,pe,_e)}}F(E,"HAS_TEXTURE_u_baseColorTexture",go.BaseColor),F(I,"HAS_TEXTURE_u_metallicRoughnessTexture",go.MetallicRoughness),F(z,"HAS_TEXTURE_u_normalTexture",go.Normal),F(L,"HAS_TEXTURE_u_occlusionTexture",go.Occlusion),F(N,"HAS_TEXTURE_u_emissionTexture",go.Emission),g&&(g.texture||(g.texture=new r.eh(h.context,g.image,[g.image.height,g.image.height,g.image.height],b.gl.RGBA8)),b.activeTexture.set(b.gl.TEXTURE0+go.LUT),g.texture&&g.texture.bind(b.gl.LINEAR,b.gl.CLAMP_TO_EDGE),u.push("APPLY_LUT_ON_GPU")),s.texcoordBuffer&&(u.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(s.texcoordBuffer)),s.colorBuffer&&(u.push(s.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(s.colorBuffer)),s.normalBuffer&&(u.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(s.normalBuffer)),s.pbrBuffer&&(u.push("HAS_ATTRIBUTE_a_pbr"),u.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(s.pbrBuffer)),v.alphaMode!=="OPAQUE"&&v.alphaMode!=="MASK"||u.push("UNPREMULT_TEXTURE_IN_SHADER"),v.defined||u.push("DIFFUSE_SHADED");const q=h.shadowRenderer;q&&(u.push("RENDER_SHADOWS","DEPTH_TEXTURE"),q.useNormalOffset&&u.push("NORMAL_OFFSET"))}function Zt(u,t,s,h,g,v){const b=s.paint.get("model-opacity").constantOr(1),E=t.context,I=new sn(t.context.gl.LEQUAL,sn.ReadWrite,t.depthRangeFor3D),z=t.transform,L=u.mesh,N=L.material,F=N.pbrMetallicRoughness,q=t.style.fog;let X;X=t.transform.projection.zAxisUnit==="pixels"?[...u.nodeModelMatrix]:r.az([],h.zScaleMatrix,u.nodeModelMatrix),r.az(X,h.negCameraPosMatrix,X);const G=r.bi([],X);r.ee(G,G);const Y=s.paint.get("model-color-use-theme").constantOr("default")==="none",J=s.paint.get("model-emissive-strength").constantOr(0),re=mc(new Float32Array(u.worldViewProjection),new Float32Array(X),new Float32Array(G),null,t,b,F.baseColorFactor,N.emissiveFactor,F.metallicFactor,F.roughnessFactor,N,J,s),pe={defines:[]},_e=[],Ae=t.shadowRenderer;Ae&&(Ae.useNormalOffset=!1),Ot(pe.defines,_e,L,t,Y?null:s.lut);let Ie=null;if(q){const Pe=za(u.nodeModelMatrix,t.transform);if(Ie=new Float32Array(Pe),z.projection.name!=="globe"){const Me=L.aabb.min,We=L.aabb.max,[Qe,ft]=q.getOpacityForBounds(Pe,Me[0],Me[1],We[0],We[1]);pe.overrideFog=Qe>=rt||ft>=rt}}const Te=$o(t,s.paint.get("model-cutoff-fade-range"));Te.shouldRenderCutoff&&pe.defines.push("RENDER_CUTOFF");const ve=t.getOrCreateProgram("model",pe);t.uploadCommonUniforms(E,ve,null,Ie,Te),t.renderPass!=="shadow"&&Ae&&Ae.setupShadowsFromMatrix(u.nodeModelMatrix,ve),ve.draw(t,E.gl.TRIANGLES,I,g,v,L.material.doubleSided?Sn.disabled:Sn.backCCW,re,s.id,L.vertexBuffer,L.indexBuffer,L.segments,s.paint,t.transform.zoom,void 0,_e)}function Ml(u,t,s,h,g,v,b){let E;E=u.projection.name==="globe"?r.ed(s,u):[...s],r.az(E,E,t.matrix);const I=r.az([],h,E);if(t.meshes)for(const z of t.meshes){if(z.material.alphaMode!=="BLEND"){b.push({mesh:z,depth:0,modelIndex:g,worldViewProjection:I,nodeModelMatrix:E});continue}const L=r.ad([],z.centroid,I);!u.isOrthographic&&L[2]<=0||v.push({mesh:z,depth:L[2],modelIndex:g,worldViewProjection:I,nodeModelMatrix:E})}if(t.children)for(const z of t.children)Ml(u,z,s,h,g,v,b)}function Er(u,t,s,h){const g=s.shadowRenderer;if(!g)return;const v=g.getShadowPassDepthMode(),b=g.getShadowPassColorMode(),E=g.calculateShadowPassMatrixFromMatrix(t),I=Vp(E);s.getOrCreateProgram("modelDepth",{defines:s._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(s,s.context.gl.TRIANGLES,v,In.disabled,b,Sn.backCCW,I,h.id,u.vertexBuffer,u.indexBuffer,u.segments,h.paint,s.transform.zoom,void 0,void 0)}function Xe(u,t,s){const h=t.updateZoomBasedPaintProperties(),g=function(v,b,E){let I,z,L,N=v.terrain?v.terrain.exaggeration():0;if(v.terrain&&N>0){const F=v.terrain,q=F.findDEMTileFor(E);q&&q.dem?I=r.ei.create(F,E,q):N=0}if(N===0&&(b.terrainElevationMin=0,b.terrainElevationMax=0),N===b.validForExaggeration&&(N===0||I&&I._demTile&&I._demTile.tileID===b.validForDEMTile.id&&I._dem._timestamp===b.validForDEMTile.timestamp))return!1;for(const F in b.instancesPerModel){const q=b.instancesPerModel[F];for(let X=0;X<q.instancedDataArray.length;++X){const G=(I?N*I.getElevationAt(0|q.instancedDataArray.float32[16*X],0|q.instancedDataArray.float32[16*X+1],!0,!0):0)+q.instancesEvaluatedElevation[X];q.instancedDataArray.float32[16*X+6]=G,z=z?Math.min(b.terrainElevationMin,G):G,L=L?Math.max(b.terrainElevationMax,G):G}}return b.terrainElevationMin=z||0,b.terrainElevationMax=L||0,b.validForExaggeration=N,b.validForDEMTile=I&&I._demTile?{id:I._demTile.tileID,timestamp:I._dem._timestamp}:{id:void 0,timestamp:0},!0}(u,t,s);(h||g)&&(t.uploaded=!1,t.upload(u.context))}const Ps={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new r.cW([0,0,0],[r.aj,r.aj,0])};function Lo(u,t){const s=1<<u.canonical.z,h=t.getFreeCameraOptions().position,g=t.elevation,v=u.canonical.x/s,b=(u.canonical.x+1)/s,E=u.canonical.y/s,I=(u.canonical.y+1)/s;let z=t._centerAltitude;if(g){const q=g.getMinMaxForTile(u);q&&q.max>z&&(z=q.max)}const L=r.ay(h.x,v,b)-h.x,N=r.ay(h.y,E,I)-h.y,F=r.c6(z,t.center.lat)-h.z;return t._zoomFromMercatorZ(Math.sqrt(L*L+N*N+F*F))}function Tc(u,t,s,h,g,v,b){const E=u.context,I=u.renderPass==="shadow",z=u.shadowRenderer,L=I&&z?z.getShadowPassDepthMode():new sn(E.gl.LEQUAL,sn.ReadWrite,u.depthRangeFor3D),N=u.isTileAffectedByFog(v);if(s.meshes)for(const F of s.meshes){const q=["MODEL_POSITION_ON_GPU"],X=[];let G,Y,J;h.instancedDataArray.length>20&&q.push("INSTANCED_ARRAYS");const re=$o(u,t.paint.get("model-cutoff-fade-range"));if(re.shouldRenderCutoff&&q.push("RENDER_CUTOFF"),I&&z)G=u.getOrCreateProgram("modelDepth",{defines:q}),Y=Vp(b.shadowTileMatrix,b.shadowTileMatrix,Float32Array.from(s.matrix)),J=z.getShadowPassColorMode();else{Ot(q,X,F,u,t.paint.get("model-color-use-theme").constantOr("default")==="none"?null:t.lut),G=u.getOrCreateProgram("model",{defines:q,overrideFog:N});const _e=F.material,Ae=_e.pbrMetallicRoughness,Ie=t.paint.get("model-opacity").constantOr(1),Te=t.paint.get("model-emissive-strength").constantOr(0);Y=mc(v.expandedProjMatrix,Float32Array.from(s.matrix),new Float32Array(16),null,u,Ie,Ae.baseColorFactor,_e.emissiveFactor,Ae.metallicFactor,Ae.roughnessFactor,_e,Te,t,g),z&&(b.shadowUniformsInitialized?G.setShadowUniformValues(E,z.getShadowUniformValues()):(z.setupShadows(v.toUnwrapped(),G,"model-tile",v.overscaledZ),b.shadowUniformsInitialized=!0)),J=re.shouldRenderCutoff||Ie<1||_e.alphaMode!=="OPAQUE"?ii.alphaBlended:ii.unblended}u.uploadCommonUniforms(E,G,v.toUnwrapped(),null,re);const pe=F.material.doubleSided?Sn.disabled:Sn.backCCW;if(h.instancedDataArray.length>20)X.push(h.instancedDataBuffer),G.draw(u,E.gl.TRIANGLES,L,In.disabled,J,pe,Y,t.id,F.vertexBuffer,F.indexBuffer,F.segments,t.paint,u.transform.zoom,void 0,X,h.instancedDataArray.length);else{const _e=I?"u_instance":"u_normal_matrix";for(let Ae=0;Ae<h.instancedDataArray.length;++Ae)Y[_e]=new Float32Array(h.instancedDataArray.arrayBuffer,64*Ae,16),G.draw(u,E.gl.TRIANGLES,L,In.disabled,J,pe,Y,t.id,F.vertexBuffer,F.indexBuffer,F.segments,t.paint,u.transform.zoom,void 0,X)}}if(s.children)for(const F of s.children)Tc(u,t,F,h,g,v,b)}const ed=[1,-1,1];function Yd(u,t,s,h){if(!s.modelManager)return!0;const g=s.modelManager;if(!s.shadowRenderer)return!0;const v=s.shadowRenderer,b=t.aabb;let E=!0,I=u.maxHeight;if(I===0){let L=0;for(const N in u.instancesPerModel){const F=g.getModel(N,h);F?L=Math.max(L,Math.max(Math.max(F.aabb.max[0],F.aabb.max[1]),F.aabb.max[2])):E=!1}I=u.maxScale*L*1.41+u.maxVerticalOffset,E&&(u.maxHeight=I)}b.max[2]=I,b.min[2]+=u.terrainElevationMin,b.max[2]+=u.terrainElevationMax,r.ad(b.min,b.min,t.tileMatrix),r.ad(b.max,b.max,t.tileMatrix);const z=b.intersects(v.getCurrentCascadeFrustum());return s.currentShadowCascade===0&&(u.isInsideFirstShadowMapFrustum=z===2),z===0}function Hp(u,t){const s=u.uniformValues.u_cutoff_params[0],h=u.uniformValues.u_cutoff_params[1],g=u.uniformValues.u_cutoff_params[2],v=u.uniformValues.u_cutoff_params[3];return h===s||v===g?1:r.ay(((t-s)/(h-s)-g)/(v-g),0,1)}function au(u,t,s,h){if(t.pitch<20)return 1;const g=t.getWorldToCameraMatrix();r.az(g,g,u);const v=r.ej(s.min[0],s.min[1],s.min[2],1);let b=r.aA(r.ek(),v,g),E=b,I=b;v[1]=s.max[1],b=r.aA(r.ek(),v,g),E=b[1]<E[1]?b:E,I=b[1]>I[1]?b:I,v[0]=s.max[0],b=r.aA(r.ek(),v,g),E=b[1]<E[1]?b:E,I=b[1]>I[1]?b:I,v[1]=s.min[1],b=r.aA(r.ek(),v,g),E=b[1]<E[1]?b:E,I=b[1]>I[1]?b:I;const z=r.ay(h[0],0,1),L=100*t.pixelsPerMeter*r.ay(h[1],0,1),N=r.ay(h[2],0,1),F=r.el(r.ek(),E,I,z),q=Math.tan(.5*t.fovX),X=-F[2]*q;if(L===0)return F[1]<-Math.abs(X)?N:1;const G=(-Math.abs(X)-F[1])/L,Y=(re,pe,_e)=>(1-_e)*re+_e*pe,J=r.ay(Y(1,N,G),N,1);return Y(1,J,r.ay((t.pitch-20)/20,0,1))}class Nf{}class Vf{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,s,h){{const N=this._storage.get(s.id);if(N)return N.lastUsedFrameIdx=t,N.buf}const g=h.gl,v=g.getBufferParameter(g.ELEMENT_ARRAY_BUFFER,g.BUFFER_SIZE),b=new ArrayBuffer(v),E=new Int16Array(b);g.getBufferSubData(g.ELEMENT_ARRAY_BUFFER,0,new Int16Array(b));const I=new r.en;for(let N=0;N<v/2;N+=3){const F=E[N],q=E[N+1],X=E[N+2];I.emplaceBack(F,q),I.emplaceBack(q,X),I.emplaceBack(X,F)}const z=h.bindVertexArrayOES.current,L=new Nf;return L.buf=new Ko(h,I),L.lastUsedFrameIdx=t,this._storage.set(s.id,L),h.bindVertexArrayOES.set(z),L.buf}update(t){for(const[s,h]of this._storage)t-h.lastUsedFrameIdx>30&&(h.buf.destroy(),this._storage.delete(s))}destroy(){for(const[t,s]of this._storage)s.buf.destroy(),this._storage.delete(t)}}class Up{constructor(t){this.occluderSize=30,this.depthOffset=-1e-4,t.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),t.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const td=r.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Qd{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Jd{constructor(t,s){this.revealStart=11,this.revealRange=2,t.registerParameter(this,[...s,"Reveal"],"revealStart",{min:0,max:17,step:.05}),t.registerParameter(this,[...s,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const nh=r.d_([{type:"Float32",name:"a_pos_2f",components:2}]);class nd{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(t,s){const h=t.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const b=new r.eo,E=new r.a_;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(1,1),b.emplaceBack(-1,1),E.emplaceBack(0,1,2),E.emplaceBack(0,2,3),this.vignetteVx=t.context.createVertexBuffer(b,nh.members),this.vignetteIdx=t.context.createIndexBuffer(E)}const g=r.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){t.uploadCommonUniforms(t.context,h);const b={u_vignetteShape:(v={vignetteShape:[s.start,s.range,Math.pow(10,s.fadePower)],vignetteColor:[s.color.r,s.color.g,s.color.b,s.color.a*s.strength]}).vignetteShape,u_vignetteColor:v.vignetteColor};h.draw(t,t.context.gl.TRIANGLES,sn.disabled,In.disabled,ii.alphaBlended,Sn.disabled,b,"vignette",this.vignetteVx,this.vignetteIdx,g)}var v}}class Sc{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(t,s){const h=t.getFreeCameraOptions().position,g=h.toAltitude(),v=h.toLngLat(),b=r.al(v.lng),E=r.al(v.lat),I=t.pixelsPerMeter/s,z=b*r.eq,L=r.eq*Math.log(Math.tan(Math.PI/4+E/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const N=-this._offsetYPrev+L,F=-this._elevationPrev+g;this._accumulatedOffsetX+=(-this._offsetXPrev+z)*I,this._accumulatedOffsetY+=N*I,this._accumulatedElevation+=F*I,this._offsetXPrev=z,this._offsetYPrev=L,this._elevationPrev=g}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function ol(u,t){return[-(u[0]-Math.floor(u[0]/t)*t),-(u[1]-Math.floor(u[1]/t)*t),-(u[2]-Math.floor(u[2]/t)*t)]}function ep(u){const t=r.e7(1323123451230),s=[];for(let h=0;h<u;++h){const g=2*t()-1,v=2*t()-1,b=2*t()-1;s.push(r.cS(g,v,b))}return s}function al(u,t,s,h,g){const v=r.ay((g-s)/(h-s),0,1);return(1-v)*u+v*t}class eo{constructor(t){this._movement=new Sc,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new nd,this._ppmScaleFactor=t}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(t,s){const h=t.transform;this._movement.update(h,this._ppmScaleFactor);const g=h.starsProjMatrix,v=r.b_([]);r.c0(v,v,r.al(90)-h._pitch),r.b$(v,v,-h.angle);const b=r.c3(new Float32Array(16),v),E=r.ep(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),I=r.ee([],E),z=r.az([],I,b),L=Date.now()/1e3;return this._accumulatedTimeFromStart+=(L-this._prevTime)*s,this._prevTime=L,{projectionMatrix:g,modelviewMatrix:z}}}class qf extends eo{constructor(t){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Jd(t.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(t){const s=t.context;if(!this.particlesVx){const h=ep(this.particlesCount),g=new r.er,v=new r.a_;let b=0;const E=r.e7(1323123451230);for(let I=0;I<h.length;++I){const z=h[I],L=[2*E()-1,E(),E(),E()];g.emplaceBack(z[0],z[1],z[2],-1,-1,...L),g.emplaceBack(z[0],z[1],z[2],1,-1,...L),g.emplaceBack(z[0],z[1],z[2],1,1,...L),g.emplaceBack(z[0],z[1],z[2],-1,1,...L),v.emplaceBack(b+0,b+1,b+2),v.emplaceBack(b+0,b+2,b+3),b+=4}this.particlesVx=s.createVertexBuffer(g,td.members),this.particlesIdx=s.createIndexBuffer(v)}}draw(t){if(!this._params.overrideStyleParameters&&!t.style.rain)return;const s=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},h=t.transform.zoom;if(s.revealStart>h)return;const g=al(0,1,s.revealStart,s.revealStart+s.revealRange,h);if(!this.particlesVx||!this.particlesIdx)return;const v=structuredClone(this._params);let b=[-v.direction.x,v.direction.y,-100];r.au(b,b);const E=structuredClone(this._vignetteParams);E.strength*=g,v.overrideStyleParameters||(v.intensity=t.style.rain.state.density,v.timeFactor=t.style.rain.state.intensity,v.color=structuredClone(t.style.rain.state.color),b=structuredClone(t.style.rain.state.direction),v.screenThinning.intensity=t.style.rain.state.centerThinning,v.dropletSizeX=t.style.rain.state.dropletSize[0],v.dropletSizeYScale=t.style.rain.state.dropletSize[1]/t.style.rain.state.dropletSize[0],v.distortionStrength=100*t.style.rain.state.distortionStrength,E.strength=1,E.color=structuredClone(t.style.rain.state.vignetteColor));const I=this.updateOnRender(t,v.timeFactor),z=t.context,L=z.gl,N=t.transform;this.screenTexture&&this.screenTexture.size[0]===t.width&&this.screenTexture.size[1]===t.height||(this.screenTexture=new r.T(z,{width:t.width,height:t.height,data:null},L.RGBA8)),v.distortionStrength>0&&(z.activeTexture.set(L.TEXTURE0),this.screenTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),L.copyTexSubImage2D(L.TEXTURE_2D,0,0,0,0,0,t.width,t.height));const F=t.getOrCreateProgram("rainParticle");t.uploadCommonUniforms(z,F),z.activeTexture.set(L.TEXTURE0),this.screenTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE);const q=[v.color.r,v.color.g,v.color.b,v.color.a],X=(G,Y)=>{const J=ol(this._movement.getPosition(),G),re=v.dropletSizeX,pe=v.dropletSizeX*v.dropletSizeYScale,_e=t.width/2,Ae=t.height/2,Ie=al(0,v.screenThinning.start,0,1,v.screenThinning.intensity),Te=al(.001,v.screenThinning.range,0,1,v.screenThinning.intensity),ve=al(0,v.screenThinning.particleOffset,0,1,v.screenThinning.intensity),Pe=(Me={modelview:I.modelviewMatrix,projection:I.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:J,velocityConeAperture:v.velocityConeAperture,velocity:v.velocity,boxSize:G,rainDropletSize:[re,pe],distortionStrength:v.distortionStrength,rainDirection:b,color:q,screenSize:[N.width,N.height],thinningCenterPos:[_e,Ae],thinningShape:[Ie,Te,Math.pow(10,v.screenThinning.fadePower)],thinningAffectedRatio:v.screenThinning.affectedRatio,thinningParticleOffset:ve,shapeDirectionalPower:v.shapeDirPower,shapeNormalPower:v.shapeNormalPower,mode:Y?0:1},{u_modelview:Float32Array.from(Me.modelview),u_projection:Float32Array.from(Me.projection),u_time:Me.time,u_cam_pos:Me.camPos,u_texScreen:0,u_velocityConeAperture:Me.velocityConeAperture,u_velocity:Me.velocity,u_boxSize:Me.boxSize,u_rainDropletSize:Me.rainDropletSize,u_distortionStrength:Me.distortionStrength,u_rainDirection:Me.rainDirection,u_color:Me.color,u_screenSize:Me.screenSize,u_thinningCenterPos:Me.thinningCenterPos,u_thinningShape:Me.thinningShape,u_thinningAffectedRatio:Me.thinningAffectedRatio,u_thinningParticleOffset:Me.thinningParticleOffset,u_shapeDirectionalPower:Me.shapeDirectionalPower,u_shapeNormalPower:Me.shapeNormalPower,u_mode:Me.mode});var Me;const We=Math.round(v.intensity*this.particlesCount),Qe=r.bd.simpleSegment(0,0,4*We,2*We);F.draw(t,L.TRIANGLES,sn.disabled,In.disabled,ii.alphaBlended,Sn.disabled,Pe,"rain_particles",this.particlesVx,this.particlesIdx,Qe)};v.distortionStrength>0&&X(v.boxSize,!0),X(v.boxSize,!1),this._vignette.draw(t,E)}}const ih=r.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class lr extends eo{constructor(t){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Jd(t.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(t){const s=t.context;if(!this.particlesVx){const h=ep(this.particlesCount),g=new r.es,v=new r.a_;let b=0;const E=r.e7(1323123451230);for(let I=0;I<h.length;++I){const z=h[I],L=E(),N=E(),F=E(),q=[I/h.length,L,N,F],X=[E(),E()];g.emplaceBack(z[0],z[1],z[2],-1,-1,...q,...X),g.emplaceBack(z[0],z[1],z[2],1,-1,...q,...X),g.emplaceBack(z[0],z[1],z[2],1,1,...q,...X),g.emplaceBack(z[0],z[1],z[2],-1,1,...q,...X),v.emplaceBack(b+0,b+1,b+2),v.emplaceBack(b+0,b+2,b+3),b+=4}this.particlesVx=s.createVertexBuffer(g,ih.members),this.particlesIdx=s.createIndexBuffer(v)}}draw(t){if(!this._params.overrideStyleParameters&&!t.style.snow)return;const s=structuredClone(this._params);let h=[-s.direction.x,s.direction.y,-100];r.au(h,h);const g=structuredClone(this._vignetteParams),v=s.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},b=t.transform.zoom;if(v.revealStart>b)return;const E=al(0,1,v.revealStart,v.revealStart+v.revealRange,b);g.strength*=E,s.overrideStyleParameters||(s.intensity=t.style.snow.state.density,s.timeFactor=t.style.snow.state.intensity,s.color=structuredClone(t.style.snow.state.color),h=structuredClone(t.style.snow.state.direction),s.screenThinning.intensity=t.style.snow.state.centerThinning,s.billboardSize=2.79*t.style.snow.state.flakeSize,g.strength=1,g.color=structuredClone(t.style.snow.state.vignetteColor));const I=this.updateOnRender(t,s.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const z=t.context,L=z.gl,N=t.transform,F=t.getOrCreateProgram("snowParticle");t.uploadCommonUniforms(z,F),((q,X,G)=>{const Y=ol(this._movement.getPosition(),q),J=N.width/2,re=N.height/2,pe=al(0,G.screenThinning.start,0,1,G.screenThinning.intensity),_e=al(.001,G.screenThinning.range,0,1,G.screenThinning.intensity),Ae=al(0,G.screenThinning.particleOffset,0,1,G.screenThinning.intensity),Ie=(Te={modelview:I.modelviewMatrix,projection:I.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Y,velocityConeAperture:G.velocityConeAperture,velocity:G.velocity,horizontalOscillationRadius:G.horizontalOscillationRadius,horizontalOscillationRate:G.horizontalOscillationRate,boxSize:q,billboardSize:1*G.billboardSize,simpleShapeParameters:[G.shapeFadeStart,G.shapeFadePower],screenSize:[N.width,N.height],thinningCenterPos:[J,re],thinningShape:[pe,_e,Math.pow(10,G.screenThinning.fadePower)],thinningAffectedRatio:G.screenThinning.affectedRatio,thinningParticleOffset:Ae,color:[G.color.r,G.color.g,G.color.b,G.color.a],direction:h},{u_modelview:Float32Array.from(Te.modelview),u_projection:Float32Array.from(Te.projection),u_time:Te.time,u_cam_pos:Te.camPos,u_velocityConeAperture:Te.velocityConeAperture,u_velocity:Te.velocity,u_horizontalOscillationRadius:Te.horizontalOscillationRadius,u_horizontalOscillationRate:Te.horizontalOscillationRate,u_boxSize:Te.boxSize,u_billboardSize:Te.billboardSize,u_simpleShapeParameters:Te.simpleShapeParameters,u_screenSize:Te.screenSize,u_thinningCenterPos:Te.thinningCenterPos,u_thinningShape:Te.thinningShape,u_thinningAffectedRatio:Te.thinningAffectedRatio,u_thinningParticleOffset:Te.thinningParticleOffset,u_particleColor:Te.color,u_direction:Te.direction});var Te;const ve=Math.round(G.intensity*this.particlesCount),Pe=r.bd.simpleSegment(0,0,4*ve,2*ve);this.particlesVx&&this.particlesIdx&&F.draw(t,L.TRIANGLES,sn.disabled,In.disabled,ii.alphaBlended,Sn.disabled,Ie,"snow_particles",this.particlesVx,this.particlesIdx,Pe)})(s.boxSize,0,s),this._vignette.draw(t,g)}}const xi={symbol:function(u,t,s,h,g){if(u.renderPass!=="translucent")return;const v=In.disabled,b=u.colorModeForRenderPass(),E=s.layout.get("text-variable-anchor"),I=s.layout.get("text-size-scale-range"),z=r.ay(u.scaleFactor,I[0],I[1]);E&&function(F,q,X,G,Y,J,re,pe){const _e=q.transform,Ae=Y==="map",Ie=J==="map";for(const Te of F){const ve=G.getTile(Te),Pe=ve.getBucket(X);if(!Pe||!Pe.text||!Pe.text.segments.get().length)continue;const Me=r.bH(Pe.textSizeData,_e.zoom,pe),We=Mu(Te,Pe.getProjection(),_e),Qe=_e.calculatePixelsToTileUnitsMatrix(ve),ft=yl(We,ve.tileID.canonical,Ie,Ae,_e,Pe.getProjection(),Qe),pt=Pe.hasIconTextFit()&&Pe.hasIconData();Me&&su(Pe,Ae,Ie,re,_e,ft,Te,Math.pow(2,_e.zoom-ve.tileID.overscaledZ),Me,pt)}}(h,u,s,t,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),g,z);const L=s.paint.get("icon-opacity").constantOr(1)!==0,N=s.paint.get("text-opacity").constantOr(1)!==0;s.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(L||N)?yc(u,t,s,h,v,b):(L&&yc(u,t,s,h,v,b,{onlyIcons:!0}),N&&yc(u,t,s,h,v,b,{onlyText:!0})),t.map.showCollisionBoxes&&(Il(u,t,s,h,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),Il(u,t,s,h,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(u,t,s,h){if(u.renderPass!=="translucent")return;const g=s.paint.get("circle-opacity"),v=s.paint.get("circle-stroke-width"),b=s.paint.get("circle-stroke-opacity"),E=s.layout.get("circle-sort-key").constantOr(1)!==void 0,I=s.paint.get("circle-emissive-strength");if(g.constantOr(1)===0&&(v.constantOr(1)===0||b.constantOr(1)===0))return;const z=u.context,L=z.gl,N=u.transform,F=!(!u.terrain||!u.terrain.enabled),q=s.layout.get("circle-elevation-reference"),X=u.depthModeForSublayer(0,sn.ReadOnly),G=new sn(u.context.gl.LEQUAL,sn.ReadOnly,u.depthRangeFor3D),Y=q==="none"||F?X:G,J=In.disabled,re=u.colorModeForDrapableLayerRenderPass(I),pe=N.projection.name==="globe",_e=[r.aD(N.center.lng),r.aH(N.center.lat)],Ae=[];for(let Te=0;Te<h.length;Te++){const ve=h[Te],Pe=t.getTile(ve),Me=Pe.getBucket(s);if(!Me||Me.projection.name!==N.projection.name)continue;const We=Me.programConfigurations.get(s.id),Qe=Me.layoutVertexBuffer,ft=Me.globeExtVertexBuffer,pt=Me.indexBuffer,Et=r.dK(s),Ke=[ft],st=u.isTileAffectedByFog(ve);pe&&Et.push("PROJECTION_GLOBE_VIEW"),Et.push("DEPTH_D24"),u.terrain&&N.depthOcclusionForSymbolsAndCircles&&Et.push("DEPTH_OCCLUSION"),Me.hasElevation&&(Et.push("ELEVATED_ROADS"),Ke.push(Me.elevatedLayoutVertexBuffer));const Ve=u.getOrCreateProgram("circle",{config:We,defines:Et,overrideFog:st}),_t=N.projection.createInversionMatrix(N,ve.canonical),nt={programConfiguration:We,program:Ve,layoutVertexBuffer:Qe,dynamicBuffers:Ke,indexBuffer:pt,uniformValues:r.dL(u,ve,Pe,_t,_e,s),tile:Pe};if(E){const Tt=Me.segments.get();for(const jt of Tt)Ae.push({segments:new r.bd([jt]),sortKey:jt.sortKey,state:nt})}else Ae.push({segments:Me.segments,sortKey:0,state:nt})}E&&Ae.sort((Te,ve)=>Te.sortKey-ve.sortKey);const Ie={useDepthForOcclusion:N.depthOcclusionForSymbolsAndCircles};for(const Te of Ae){const{programConfiguration:ve,program:Pe,layoutVertexBuffer:Me,dynamicBuffers:We,indexBuffer:Qe,uniformValues:ft,tile:pt}=Te.state,Et=Te.segments;u.terrain&&u.terrain.setupElevationDraw(pt,Pe,Ie),u.uploadCommonUniforms(z,Pe,pt.tileID.toUnwrapped()),Pe.draw(u,L.TRIANGLES,Y,J,re,Sn.disabled,ft,s.id,Me,Qe,Et,s.paint,N.zoom,ve,We)}},heatmap:function(u,t,s,h){if(s.paint.get("heatmap-opacity")!==0)if(u.renderPass==="offscreen"){const g=u.context,v=g.gl,b=In.disabled,E=new ii([v.ONE,v.ONE,v.ONE,v.ONE],r.am.transparent,[!0,!0,!0,!0]);(function(q,X,G,Y){const J=q.gl,re=X.width*Y,pe=X.height*Y;q.activeTexture.set(J.TEXTURE1),q.viewport.set([0,0,re,pe]);let _e=G.heatmapFbo;if(!_e||_e&&(_e.width!==re||_e.height!==pe)){_e&&_e.destroy();const Ae=J.createTexture();J.bindTexture(J.TEXTURE_2D,Ae),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.LINEAR),_e=G.heatmapFbo=q.createFramebuffer(re,pe,!0,null),function(Ie,Te,ve,Pe,Me,We){const Qe=Ie.gl;Qe.texImage2D(Qe.TEXTURE_2D,0,Ie.extRenderToTextureHalfFloat?Qe.RGBA16F:Qe.RGBA,Me,We,0,Qe.RGBA,Ie.extRenderToTextureHalfFloat?Qe.HALF_FLOAT:Qe.UNSIGNED_BYTE,null),Pe.colorAttachment.set(ve)}(q,0,Ae,_e,re,pe)}else J.bindTexture(J.TEXTURE_2D,_e.colorAttachment.get()),q.bindFramebuffer.set(_e.framebuffer)})(g,u,s,u.transform.projection.name==="globe"?.5:.25),g.clear({color:r.am.transparent});const I=u.transform,z=I.projection.name==="globe",L=z?["PROJECTION_GLOBE_VIEW"]:[],N=z?Sn.frontCCW:Sn.disabled,F=[r.aD(I.center.lng),r.aH(I.center.lat)];for(let q=0;q<h.length;q++){const X=h[q];if(t.hasRenderableParent(X))continue;const G=t.getTile(X),Y=G.getBucket(s);if(!Y||Y.projection.name!==I.projection.name)continue;const J=u.isTileAffectedByFog(X),re=Y.programConfigurations.get(s.id),pe=u.getOrCreateProgram("heatmap",{config:re,defines:L,overrideFog:J}),{zoom:_e}=u.transform;u.terrain&&u.terrain.setupElevationDraw(G,pe),u.uploadCommonUniforms(g,pe,X.toUnwrapped());const Ae=I.projection.createInversionMatrix(I,X.canonical);pe.draw(u,v.TRIANGLES,sn.disabled,b,E,N,el(u,X,G,Ae,F,_e,s.paint.get("heatmap-intensity")),s.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,s.paint,u.transform.zoom,re,z?[Y.globeExtVertexBuffer]:null)}g.viewport.set([0,0,u.width,u.height])}else u.renderPass==="translucent"&&(u.context.setColorMode(u.colorModeForRenderPass()),function(g,v){const b=g.context,E=b.gl,I=v.heatmapFbo;if(!I)return;b.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,I.colorAttachment.get()),b.activeTexture.set(E.TEXTURE1);let z=v.colorRampTexture;z||(z=v.colorRampTexture=new r.T(b,v.colorRamp,E.RGBA8)),z.bind(E.LINEAR,E.CLAMP_TO_EDGE),g.getOrCreateProgram("heatmapTexture").draw(g,E.TRIANGLES,sn.disabled,In.disabled,g.colorModeForRenderPass(),Sn.disabled,((L,N,F,q)=>({u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}))(0,v),v.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments,v.paint,g.transform.zoom)}(u,s))},line:function(u,t,s,h){if(u.renderPass!=="translucent")return;const g=s.paint.get("line-opacity"),v=s.paint.get("line-width");if(g.constantOr(1)===0||v.constantOr(1)===0)return;const b=s.paint.get("line-emissive-strength"),E=s.paint.get("line-occlusion-opacity"),I=s.layout.get("line-elevation-reference"),z=s.layout.get("line-width-unit")==="meters",L=I==="sea",N=!(!u.terrain||!u.terrain.enabled),F=u.context,q=F.gl;if(s.hasElevatedBuckets&&u.transform.projection.name==="globe")return;const X=s.layout.get("line-cross-slope"),G=X!==void 0,Y=X<1,J=u.colorModeForDrapableLayerRenderPass(b),re=u.terrain&&u.terrain.renderingToTexture,pe=re?1:r.q.devicePixelRatio,_e=s.paint.get("line-dasharray"),Ae=_e.constantOr(1),Ie=s.layout.get("line-cap"),Te=_e.constantOr(null),ve=Ie.constantOr(null),Pe=s.paint.get("line-pattern"),Me=Pe.constantOr(1),We=s.paint.get("line-pattern-cross-fade"),Qe=Pe.constantOr(null),ft=s.paint.get("line-opacity").constantOr(1);let pt=!Me&&ft!==1||u.depthOcclusion&&E>0&&E<1;const Et=s.paint.get("line-gradient"),Ke=Me?"linePattern":"line",st=r.dM(s);let Ve;if(re&&u.terrain&&u.terrain.clipOrMaskOverlapStencilType()&&(pt=!1),E!==0&&u.depthOcclusion){const jt=s.paint._values["line-opacity"];jt&&jt.value&&jt.value.kind==="constant"?Ve=jt.value:r.w(`Occlusion opacity for layer ${s.id} is supported only when line-opacity isn't data-driven.`)}v.value.kind!=="constant"&&v.value.isLineProgressConstant===!1&&st.push("VARIABLE_LINE_WIDTH");const _t=(jt,yt,Lt,Yt,tn,Xt)=>{for(const rn of jt){const fn=t.getTile(rn);if(Me&&!fn.patternsLoaded())continue;const _n=fn.getBucket(s);if(!_n||_n.elevationType!=="none"&&!tn||_n.elevationType==="none"&&tn)continue;u.prepareDrawTile();const Pn=[...yt],Wn=u.shadowRenderer,vi=_n.elevationType==="road"&&!!Wn&&Wn.enabled;let Ji=[0,0,0];if(vi){const yi=u.style.directionalLight,Rr=u.style.ambientLight;yi&&Rr&&(Ji=Sl(u.style,yi,Rr)),Pn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const Oi=_n.programConfigurations.get(s.id);let Ai=!1;if(Qe&&fn.imageAtlas){const yi=r.dN.from(Qe),Rr=yi.getPrimary().scaleSelf(pe).toString(),cr=fn.imageAtlas.patternPositions.get(Rr),Ni=yi.getSecondary(),ir=Ni?fn.imageAtlas.patternPositions.get(Ni.scaleSelf(pe).toString()):null;Ai=!!cr&&!!ir,cr&&Oi.setConstantPatternPositions(cr,ir)}We>0&&(Ai||Oi.getPatternTransitionVertexBuffer("line-pattern"))&&Pn.push("LINE_PATTERN_TRANSITION");const Dr=u.isTileAffectedByFog(rn),Dn=u.getOrCreateProgram(Ke,{config:Oi,defines:Pn,overrideFog:Dr,overrideRtt:!tn&&void 0});if(!Me&&Te&&ve&&fn.lineAtlas){const yi=fn.lineAtlas.getDash(Te,ve);yi&&Oi.setConstantPatternPositions(yi)}vi&&Wn.setupShadows(fn.tileID.toUnwrapped(),Dn,"vector-tile",fn.tileID.overscaledZ);let[Zn,si]=s.paint.get("line-trim-offset");(ve==="round"||ve==="square")&&Zn!==si&&(Zn===0&&(Zn-=1),si===1&&(si+=1));const er=re?rn.projMatrix:null,Hr=z?1/_n.tileToMeter/r.aw(fn,1,u.transform.zoom):1,nr=z?1/_n.tileToMeter/r.aw(fn,1,Math.floor(u.transform.zoom)):1,Mi=Me?r.dO(u,fn,s,er,pe,Hr,nr,[Zn,si],Ji,We):r.dP(u,fn,s,er,_n.lineClipsArray.length,pe,Hr,nr,[Zn,si],Ji);if(Et){const yi=_n.gradients[s.id];let Rr=yi.texture;if(s.gradientVersion!==yi.version){let cr=256;if(s.stepInterpolant){const Ni=t.getSource().maxzoom,ir=rn.canonical.z===Ni?Math.ceil(1<<u.transform.maxZoom-rn.canonical.z):1;cr=r.ay(r.dQ(_n.maxLineLength/r.aj*1024*ir),256,F.maxTextureSize)}yi.gradient=r.dR({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:cr,image:yi.gradient||void 0,clips:_n.lineClipsArray}),yi.texture?yi.texture.update(yi.gradient):yi.texture=new r.T(F,yi.gradient,q.RGBA8),yi.version=s.gradientVersion,Rr=yi.texture}F.activeTexture.set(q.TEXTURE1),Rr.bind(s.stepInterpolant?q.NEAREST:q.LINEAR,q.CLAMP_TO_EDGE)}Ae&&(F.activeTexture.set(q.TEXTURE0),fn.lineAtlasTexture&&fn.lineAtlasTexture.bind(q.LINEAR,q.REPEAT),Oi.updatePaintBuffers()),Me&&(F.activeTexture.set(q.TEXTURE0),fn.imageAtlasTexture&&fn.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),Oi.updatePaintBuffers()),tn&&!L&&u.terrain.setupElevationDraw(fn,Dn),u.uploadCommonUniforms(F,Dn,rn.toUnwrapped());const Mr=yi=>{Ve!=null&&(Ve.value=ft*E),Dn.draw(u,q.TRIANGLES,Lt,yi,J,Sn.disabled,Mi,s.id,_n.layoutVertexBuffer,_n.indexBuffer,_n.segments,s.paint,u.transform.zoom,Oi,[_n.layoutVertexBuffer2,_n.patternVertexBuffer,_n.zOffsetVertexBuffer]),Ve!=null&&(Ve.value=ft)};if(pt&&!tn){const yi=u.stencilModeForClipping(rn).ref;yi===0&&re&&F.clear({stencil:0});const Rr={func:q.EQUAL,mask:255};Mi.u_alpha_discard_threshold=.8,Mr(new In(Rr,yi,255,q.KEEP,q.KEEP,q.INVERT)),Mi.u_alpha_discard_threshold=0,Mr(new In(Rr,yi,255,q.KEEP,q.KEEP,q.KEEP))}else Mi.u_alpha_discard_threshold=pt&&tn&&Xt?.8:0,Mr(tn?Yt:u.stencilModeForClipping(rn))}};let nt=u.depthModeForSublayer(0,sn.ReadOnly);const Tt=new sn(u.depthOcclusion?q.GREATER:q.LEQUAL,sn.ReadOnly,u.depthRangeFor3D);if(s.hasNonElevatedBuckets){const jt=!re&&u.terrain;E!==0&&jt?r.w(`Occlusion opacity for layer ${s.id} is supported on terrain only if the layer has line-z-offset enabled.`):jt?r.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${s.id}.`):_t(h,st,nt,In.disabled,!1,!0)}if(s.hasElevatedBuckets){I==="hd-road-markup"?N||(nt=Tt,st.push("ELEVATED_ROADS")):(st.push("ELEVATED"),nt=Tt,G&&st.push(Y?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),L&&st.push("ELEVATION_REFERENCE_SEA"));const jt=pt?u.stencilModeFor3D():In.disabled;u.forceTerrainMode=!0,_t(h,st,nt,jt,!0,!0),pt&&_t(h,st,nt,jt,!0,!1),u.forceTerrainMode=!1}pt&&(u.resetStencilClippingMasks(),re&&F.clear({stencil:0})),E===0||u.depthOcclusion||re||u.layersWithOcclusionOpacity.push(u.currentLayer)},fill:function(u,t,s,h){const g=s.paint.get("fill-color"),v=s.paint.get("fill-opacity");if(v.constantOr(1)===0)return;const b=s.paint.get("fill-emissive-strength"),E=u.colorModeForDrapableLayerRenderPass(b),I=s.paint.get("fill-pattern"),z=u.opaquePassEnabledForLayer()&&!I.constantOr(1)&&g.constantOr(r.am.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";let L="none";s.layout.get("fill-elevation-reference")!=="none"?L="road":s.paint.get("fill-z-offset").constantOr(1)!==0&&(L="offset");const N=!(!u.terrain||!u.terrain.enabled),F={painter:u,sourceCache:t,layer:s,coords:h,colorMode:E,elevationType:L,terrainEnabled:N,pass:z};if(u.renderPass!=="shadow")if(L!=="offset"){if(xc(F,!1),L==="road"){const q=!N&&u.renderPass==="translucent";q&&Yh(u,t,s,h,"geometry"),xc(F,!0,In.disabled),q&&function(X){const{painter:G,sourceCache:Y,layer:J,coords:re,colorMode:pe}=X,_e=G.context.gl,Ae=X.painter.shadowRenderer,Ie=!!Ae&&Ae.enabled,Te=new sn(G.context.gl.LEQUAL,sn.ReadOnly,G.depthRangeFor3D);let ve=[0,0,0];if(Ie){const Me=G.style.directionalLight,We=G.style.ambientLight;Me&&We&&(ve=Sl(G.style,Me,We))}const Pe=Me=>{for(const We of re){const Qe=Y.getTile(We),ft=Qe.getBucket(J);if(!ft)continue;const pt=ft.elevatedStructures;if(!pt)continue;let Et,Ke;if(Me?(Et=pt.renderableBridgeSegments,Ke=pt.bridgeProgramConfigurations.get(J.id)):(Et=pt.renderableTunnelSegments,Ke=pt.tunnelProgramConfigurations.get(J.id)),!Et||Et.segments[0].primitiveLength===0)continue;Ke.updatePaintBuffers(),G.prepareDrawTile();const st=G.isTileAffectedByFog(We),Ve=[];Ie&&Ve.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const _t=G.getOrCreateProgram("elevatedStructures",{config:Ke,overrideFog:st,defines:Ve}),nt=G.translatePosMatrix(We.projMatrix,Qe,J.paint.get("fill-translate"),J.paint.get("fill-translate-anchor"));Ie&&Ae.setupShadows(Qe.tileID.toUnwrapped(),_t,"vector-tile",Qe.tileID.overscaledZ);const Tt=Ud(nt,ve);G.uploadCommonUniforms(G.context,_t,We.toUnwrapped()),_t.draw(G,_e.TRIANGLES,Te,In.disabled,pe,Sn.backCCW,Tt,J.id,pt.vertexBuffer,pt.indexBuffer,Et,J.paint,G.transform.zoom,Ke,[pt.vertexBufferNormal])}};Pe(!0),Pe(!1)}(F)}}else xc(F,!1,u.stencilModeFor3D());else u.shadowRenderer&&L==="road"&&!N&&function(q){const{painter:X,sourceCache:G,layer:Y,coords:J}=q,re=X.context.gl,pe=q.painter.shadowRenderer;for(const _e of J){const Ae=G.getTile(_e),Ie=Ae.getBucket(Y);if(!Ie)continue;const Te=Ie.elevatedStructures;if(!Te||!Te.shadowCasterSegments||Te.shadowCasterSegments.segments[0].primitiveLength===0)continue;X.prepareDrawTile();const ve=Ie.bufferData.programConfigurations.get(Y.id),Pe=X.isTileAffectedByFog(_e),Me=X.getOrCreateProgram("elevatedStructuresDepth",{config:ve,overrideFog:Pe}),We=pe.calculateShadowPassMatrixFromTile(Ae.tileID.toUnwrapped());X.uploadCommonUniforms(X.context,Me,_e.toUnwrapped());const Qe={u_matrix:We,u_depth_bias:.001};Me.draw(X,re.TRIANGLES,pe.getShadowPassDepthMode(),In.disabled,pe.getShadowPassColorMode(),Sn.disabled,Qe,Y.id,Te.vertexBuffer,Te.indexBuffer,Te.shadowCasterSegments,Y.paint,X.transform.zoom,ve)}}(F)},"fill-extrusion":function(u,t,s,h){const g=s.paint.get("fill-extrusion-opacity"),v=u.context,b=v.gl,E=u.terrain,I=E&&E.renderingToTexture;if(g===0)return;const z=u.conflationActive&&u.style.isLayerClipped(s,t.getSource()),L=u.style.order.indexOf(s.fqid);if(z&&function(N,F,q,X,G){for(const Y of X){const J=F.getTile(Y).getBucket(q);J&&(J.updateReplacement(Y,N.replacementSource,G),J.uploadCentroid(N.context))}}(u,t,s,h,L),E||z)for(const N of h){const F=t.getTile(N).getBucket(s);F&&nn(u.context,t,N,F,s,E,z)}if(u.renderPass==="shadow"&&u.shadowRenderer){const N=u.shadowRenderer;if(E&&g<.65&&s._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof r.ab)return;const F=N.getShadowPassDepthMode(),q=N.getShadowPassColorMode();As(u,t,s,h,F,In.disabled,q,z)}else if(u.renderPass==="translucent"){const N=!s.paint.get("fill-extrusion-pattern").constantOr(1),F=s.paint.get("fill-extrusion-color").constantOr(r.am.white);if(!I&&F.a!==0){const q=new sn(u.context.gl.LEQUAL,sn.ReadWrite,u.depthRangeFor3D);g===1&&N?As(u,t,s,h,q,In.disabled,ii.unblended,z):(As(u,t,s,h,q,In.disabled,ii.disabled,z),As(u,t,s,h,q,u.stencilModeFor3D(),u.colorModeForRenderPass(),z),u.resetStencilClippingMasks())}if(u.style.enable3dLights()&&N&&(!E&&u.transform.projection.name!=="globe"||I)){const q=s.paint.get("fill-extrusion-opacity"),X=s.paint.get("fill-extrusion-ambient-occlusion-intensity"),G=s.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Y=s.paint.get("fill-extrusion-flood-light-intensity"),J=s.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",re=s.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(J?null:s.lut).toArray01().slice(0,3),pe=X>0&&G>0,_e=Y>0,Ae=(Te,ve,Pe)=>(1-Pe)*Te+Pe*ve,Ie=Te=>{const ve=u.depthModeForSublayer(1,sn.ReadOnly,b.LEQUAL,!0),Pe=s.paint.get(Te?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Me=Ae(.1,3,Pe),We=u._showOverdrawInspector;if(!We){const Qe=new In({func:b.ALWAYS,mask:255},255,255,b.KEEP,b.KEEP,b.REPLACE),ft=new ii([b.ONE,b.ONE,b.ONE,b.ONE],r.am.transparent,[!1,!1,!1,!0],b.MIN);Ro(u,t,s,h,ve,Qe,ft,Sn.disabled,Te,"sdf",q,X,G,Y,re,Me,z,!1)}{const Qe=We?In.disabled:new In({func:b.EQUAL,mask:255},255,255,b.KEEP,b.DECR,b.DECR),ft=We?u.colorModeForRenderPass():new ii([b.ONE_MINUS_DST_ALPHA,b.DST_ALPHA,b.ONE,b.ONE],r.am.transparent,[!0,!0,!0,!0]);Ro(u,t,s,h,ve,Qe,ft,Sn.disabled,Te,"color",q,X,G,Y,re,Me,z,!1)}};if(I){const Te=(ve,Pe,Me)=>{const We=u.depthModeForSublayer(1,sn.ReadOnly,b.LEQUAL,!1),Qe=s.paint.get(ve?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ft=Ae(.1,3,Qe);{const pt=new ii([b.ONE,b.ONE,b.ONE,b.ONE],r.am.transparent,[!1,!1,!1,!0]);Ro(u,t,s,h,We,In.disabled,pt,Sn.disabled,ve,"clear",q,X,G,Y,re,ft,z,Pe)}{const pt=new In({func:b.ALWAYS,mask:255},255,255,b.KEEP,b.KEEP,b.REPLACE),Et=new ii([b.ONE,b.ONE,b.ONE,b.ONE],r.am.transparent,[!1,!1,!1,!0],b.MIN);Ro(u,t,s,h,We,pt,Et,Sn.disabled,ve,"sdf",q,X,G,Y,re,ft,z,Pe)}{const pt=ve?b.ZERO:b.ONE_MINUS_DST_ALPHA,Et=new In({func:b.EQUAL,mask:255},255,255,b.KEEP,b.DECR,b.DECR),Ke=new ii([pt,b.DST_ALPHA,b.ONE_MINUS_DST_ALPHA,b.ZERO],r.am.transparent,[!0,!0,!0,!0]);Ro(u,t,s,h,We,Et,Ke,Sn.disabled,ve,"color",q,X,G,Y,re,ft,z,Pe)}{const pt=new ii([b.ONE,b.ONE,b.ONE,ve?b.ZERO:b.ONE],r.am.transparent,[!1,!1,!1,!0],ve?b.FUNC_ADD:b.MAX);Ro(u,t,s,h,We,In.disabled,pt,Sn.disabled,ve,"clear",q,X,G,Y,re,ft,z,Pe,Me)}};if(pe||_e){let ve;if(u.prepareDrawTile(),E){const Pe=E.drapeBufferSize[0],Me=E.drapeBufferSize[1];ve=E.framebufferCopyTexture,ve&&(!ve||ve.size[0]===Pe&&ve.size[1]===Me)||(ve&&ve.destroy(),ve=E.framebufferCopyTexture=new r.T(v,new r.r({width:Pe,height:Me}),b.RGBA8)),ve.bind(b.LINEAR,b.CLAMP_TO_EDGE),b.copyTexSubImage2D(b.TEXTURE_2D,0,0,0,0,0,Pe,Me)}pe&&Te(!0,!1,ve),_e&&Te(!1,!0,ve)}}else pe&&Ie(!0),_e&&Ie(!1),(pe||_e)&&u.resetStencilClippingMasks()}}},building:function(u,t,s,h){},hillshade:function(u,t,s,h){if(u.renderPass!=="offscreen"&&u.renderPass!=="translucent"||u.style.disableElevatedTerrain)return;const g=u.context,v=u.terrain&&u.terrain.renderingToTexture,[b,E]=u.renderPass!=="translucent"||v?[{},h]:u.stencilConfigForOverlap(h);for(const I of E){const z=t.getTile(I);if(z.needsHillshadePrepare&&u.renderPass==="offscreen")Wm(u,z,s);else if(u.renderPass==="translucent"){const L=u.depthModeForSublayer(0,sn.ReadOnly),N=s.paint.get("hillshade-emissive-strength"),F=u.colorModeForDrapableLayerRenderPass(N),q=v&&u.terrain?u.terrain.stencilModeForRTTOverlap(I):b[I.overscaledZ];Gm(u,I,z,s,L,q,F)}}g.viewport.set([0,0,u.width,u.height]),u.resetStencilClippingMasks()},raster:function(u,t,s,h,g,v){if(u.renderPass!=="translucent"||s.paint.get("raster-opacity")===0)return;const b=u.transform.projection.name==="globe",E=s.paint.get("raster-elevation")!==0,I=E&&b;if(u.renderElevatedRasterBackface&&!I)return;const z=u.context,L=z.gl,N=t.getSource(),F=function(Ie,Te,ve,Pe){const Me=Te.paint.get("raster-color"),We=Ie.type==="raster-array",Qe=[],ft=Te.paint.get("raster-resampling"),pt=Te.paint.get("raster-color-mix");let Et=Te.paint.get("raster-color-range");const Ke=[pt[0],pt[1],pt[2],0],st=pt[3];let Ve=ft==="nearest"?Pe.NEAREST:Pe.LINEAR;if(We&&(Qe.push("RASTER_ARRAY"),Me||Qe.push("RASTER_COLOR"),ft==="linear"&&Qe.push("RASTER_ARRAY_LINEAR"),Ve=Pe.NEAREST,!Et&&Ie.rasterLayers)){const _t=Ie.rasterLayers.find(({id:nt})=>nt===Te.sourceLayer);_t&&_t.fields&&_t.fields.range&&(Et=_t.fields.range)}if(Et=Et||[0,1],Me){Qe.push("RASTER_COLOR"),ve.activeTexture.set(Pe.TEXTURE2),Te.updateColorRamp(Et);let _t=Te.colorRampTexture;_t||(_t=Te.colorRampTexture=new r.T(ve,Te.colorRamp,Pe.RGBA8)),_t.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE)}return{mix:Ke,range:Et,offset:st,defines:Qe,resampling:Ve}}(N,s,z,L);if(N instanceof r.aP&&!h.length&&!b)return;const q=s.paint.get("raster-emissive-strength"),X=u.colorModeForDrapableLayerRenderPass(q),G=u.terrain&&u.terrain.renderingToTexture,Y=!u.options.moving,J=s.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;if(N instanceof r.aP&&!h.length&&(N.onNorthPole||N.onSouthPole)){const Ie=E?u.stencilModeFor3D():In.disabled;return void la(!!N.onNorthPole,null,u,t,s,q,F,Sn.disabled,Ie)}if(!h.length)return;const[re,pe]=N instanceof r.aP||G?[{},h]:u.stencilConfigForOverlap(h),_e=pe[pe.length-1].overscaledZ;I&&F.defines.push("PROJECTION_GLOBE_VIEW"),E&&F.defines.push("RENDER_CUTOFF");const Ae=(Ie,Te,ve)=>{for(const Pe of Ie){const Me=Pe.toUnwrapped(),We=t.getTile(Pe);if(G&&(!We||!We.hasData()))continue;z.activeTexture.set(L.TEXTURE0);const Qe=Wd(We,N,s,F);if(!Qe||!Qe.texture)continue;const{texture:ft,mix:pt,offset:Et,tileSize:Ke,buffer:st}=Qe;let Ve,_t;G?(Ve=sn.disabled,_t=Pe.projMatrix):E?(Ve=new sn(L.LEQUAL,sn.ReadWrite,u.depthRangeFor3D),_t=b?Float32Array.from(u.transform.expandedFarZProjMatrix):u.transform.calculateProjMatrix(Me,Y)):(Ve=u.depthModeForSublayer(Pe.overscaledZ-_e,s.paint.get("raster-opacity")===1?sn.ReadWrite:sn.ReadOnly,L.LESS),_t=u.transform.calculateProjMatrix(Me,Y));const nt=u.terrain&&G?u.terrain.stencilModeForRTTOverlap(Pe):re[Pe.overscaledZ],Tt=v?0:s.paint.get("raster-fade-duration");We.registerFadeDuration(Tt);const jt=t.findLoadedParent(Pe,0),yt=fs(We,jt,t,u.transform,Tt);let Lt,Yt;u.terrain&&u.terrain.prepareDrawTile(),z.activeTexture.set(L.TEXTURE0),ft.bind(J,L.CLAMP_TO_EDGE),z.activeTexture.set(L.TEXTURE1),jt?(jt.texture&&jt.texture.bind(J,L.CLAMP_TO_EDGE),Lt=Math.pow(2,jt.tileID.overscaledZ-We.tileID.overscaledZ),Yt=[We.tileID.canonical.x*Lt%1,We.tileID.canonical.y*Lt%1]):ft.bind(J,L.CLAMP_TO_EDGE),"useMipmap"in ft&&z.extTextureFilterAnisotropic&&u.transform.pitch>20&&L.texParameterf(L.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax);const tn=u.transform;let Xt;const rn=E?bc(tn):[0,0,0,0];let fn,_n,Pn,Wn,vi,Ji=0;if(I&&N instanceof r.aP&&N.coordinates.length>3)fn=Float32Array.from(r.bh(r.dr(new r.cp(0,0,0)))),_n=Float32Array.from(tn.globeMatrix),Pn=Float32Array.from(r.dm(tn)),Wn=[r.aD(tn.center.lng),r.aH(tn.center.lat)],Xt=N.elevatedGlobePerspectiveTransform,vi=N.elevatedGlobeGridMatrix||new Float32Array(9);else if(I){const Dn=r.dn(Pe.canonical);Ji=r.dp(Dn.getCenter().lat),fn=Float32Array.from(r.bh(r.dr(Pe.canonical))),_n=Float32Array.from(tn.globeMatrix),Pn=Float32Array.from(r.dm(tn)),Wn=[r.aD(tn.center.lng),r.aH(tn.center.lat)],Xt=[0,0],vi=Float32Array.from(r.dq(Pe.canonical,Dn,Ji,tn.worldSize/tn._pixelsPerMercatorPixel))}else Xt=N instanceof r.aP?N.perspectiveTransform:[0,0],fn=new Float32Array(16),_n=new Float32Array(9),Pn=new Float32Array(16),Wn=[0,0],vi=new Float32Array(9);const Oi=Gh(_t,fn,_n,Pn,vi,Yt||[0,0],r.ah(u.transform.zoom),Wn,rn,Lt||1,yt,s,Xt,E?s.paint.get("raster-elevation"):0,2,pt,Et,F.range,Ke,st,q),Ai=u.isTileAffectedByFog(Pe),Dr=u.getOrCreateProgram("raster",{defines:F.defines,overrideFog:Ai});if(u.uploadCommonUniforms(z,Dr,Me),N instanceof r.aP){const Dn=N.elevatedGlobeVertexBuffer,Zn=N.elevatedGlobeIndexBuffer;if(G||!b)N.boundsBuffer&&N.boundsSegments&&Dr.draw(u,L.TRIANGLES,Ve,In.disabled,X,Sn.disabled,Oi,s.id,N.boundsBuffer,u.quadTriangleIndexBuffer,N.boundsSegments);else if(Dn&&Zn){const si=tn.zoom<=r.cL?N.elevatedGlobeSegments:N.getSegmentsForLongitude(tn.center.lng);si&&Dr.draw(u,L.TRIANGLES,Ve,In.disabled,X,Te,Oi,s.id,Dn,Zn,si)}}else if(I){Ve=new sn(L.LEQUAL,sn.ReadOnly,u.depthRangeFor3D);const Dn=u.globeSharedBuffers;if(Dn){const[Zn,si,er]=Dn.getGridBuffers(Ji,!1);Dr.draw(u,L.TRIANGLES,Ve,ve||nt,u.colorModeForRenderPass(),Te,Oi,s.id,Zn,si,er)}}else{const{tileBoundsBuffer:Dn,tileBoundsIndexBuffer:Zn,tileBoundsSegments:si}=u.getTileBoundsBuffers(We);Dr.draw(u,L.TRIANGLES,Ve,nt,X,Sn.disabled,Oi,s.id,Dn,Zn,si)}}if(!(N instanceof r.aP)&&I)for(const Pe of Ie){const Me=Pe.canonical.y===(1<<Pe.canonical.z)-1;Pe.canonical.y===0&&la(!0,Pe,u,t,s,q,F,Te,ve||In.disabled),Me&&la(!1,Pe,u,t,s,q,F,Te===Sn.frontCW?Sn.backCW:Sn.frontCW,ve||In.disabled)}};I?Ae(pe,u.renderElevatedRasterBackface?Sn.backCW:Sn.frontCW,u.stencilModeFor3D()):Ae(pe,Sn.disabled,void 0),u.resetStencilClippingMasks()},"raster-particle":function(u,t,s,h,g,v){u.renderPass==="offscreen"&&function(b,E,I,z){if(!z.length)return;const L=b.context,N=L.gl,F=E.getSource();if(!(F instanceof Xl))return;const q=Math.ceil(Math.sqrt(I.paint.get("raster-particle-count")));let X=I.particlePositionRGBAImage;if(!X||X.width!==q){const pe=function(_e){const Ae=_e*_e,Ie=new Uint8Array(4*Ae),Te=function(Pe){return Pe|=0,Pe=Math.imul(2747636419^Pe,2654435769),Pe=Math.imul(Pe^Pe>>>16,2654435769),((Pe=Math.imul(Pe^Pe>>>16,2654435769))>>>0)/4294967296},ve=1/1.1;for(let Pe=0;Pe<Ae;Pe++){const Me=ve*(Te(2*Pe+0)+Es),We=ve*(Te(2*Pe+1)+Es),Qe=255*Me%1,ft=255*We%1,pt=Qe,Et=We-ft/255,Ke=ft;Ie[4*Pe+0]=255*(Me-Qe/255),Ie[4*Pe+1]=255*pt,Ie[4*Pe+2]=255*Et,Ie[4*Pe+3]=255*Ke}return Ie}(q);X=I.particlePositionRGBAImage=new r.r({width:q,height:q},pe)}let G=I.particleFramebuffer;G?G.width!==q&&(G.destroy(),G=I.particleFramebuffer=L.createFramebuffer(q,q,!0,null)):G=I.particleFramebuffer=L.createFramebuffer(q,q,!0,null);const Y=[];for(const pe of z){const _e=E.getTile(pe);if(!(_e instanceof Oc))continue;const Ae=jf(_e,F,I);if(!Ae)continue;const Ie=[_e.tileSize,_e.tileSize];let Te=I.tileFramebuffer;Te||(Te=I.tileFramebuffer=L.createFramebuffer(Ie[0],Ie[1],!0,null));let ve=_e.rasterParticleState;ve||(ve=_e.rasterParticleState=new Qh(L,pe,Ie,X));const Pe=ve.update(I.lastInvalidatedAt);ve.particleTextureDimension!==q&&ve.updateParticleTexture(pe,X);const Me=ve.targetColorTexture;ve.targetColorTexture=ve.backgroundColorTexture,ve.backgroundColorTexture=Me;const We=ve.particleTexture0;ve.particleTexture0=ve.particleTexture1,ve.particleTexture1=We,Y.push([pe,Ae,ve,Pe])}if(Y.length===0)return;const J=r.q.now(),re=I.previousDrawTimestamp?.001*(J-I.previousDrawTimestamp):.0167;if(I.previousDrawTimestamp=J,I.hasColorMap()){L.activeTexture.set(N.TEXTURE0+2);let pe=I.colorRampTexture;pe||(pe=I.colorRampTexture=new r.T(L,I.colorRamp,N.RGBA8)),pe.bind(N.LINEAR,N.CLAMP_TO_EDGE)}L.bindFramebuffer.set(I.tileFramebuffer.framebuffer),function(pe,_e,Ae){const Ie=pe.context,Te=Ie.gl,ve=_e.tileFramebuffer;Ie.activeTexture.set(Te.TEXTURE0);const Pe={u_texture:0,u_opacity:1.05*(We=_e.paint.get("raster-particle-fade-opacity-factor"))/(We+.05)},Me=pe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var We;for(const Qe of Ae){const[,,ft,pt]=Qe;ve.colorAttachment.set(ft.targetColorTexture.texture),Ie.viewport.set([0,0,ve.width,ve.height]),Ie.clear({color:r.am.transparent}),pt&&(ft.backgroundColorTexture.bind(Te.NEAREST,Te.CLAMP_TO_EDGE),Me.draw(pe,Te.TRIANGLES,sn.disabled,In.disabled,ii.alphaBlended,Sn.disabled,Pe,_e.id,pe.viewportBuffer,pe.quadTriangleIndexBuffer,pe.viewportSegments))}}(b,I,Y),function(pe,_e,Ae,Ie){const Te=pe.context,ve=Te.gl,Pe=Ae.tileFramebuffer,Me=pe.transform.projection.name==="globe",We=Ae.paint.get("raster-particle-max-speed");for(const Qe of Ie){const[ft,pt,Et]=Qe;Te.activeTexture.set(ve.TEXTURE0+0),pt.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),Pe.colorAttachment.set(Et.targetColorTexture.texture);const Ke=pe.getOrCreateProgram("rasterParticleDraw",{defines:pt.defines,overrideFog:!1});Te.activeTexture.set(ve.TEXTURE0+1);const st=pt.scalarData?[]:[0,1,2,3].map(nt=>r.dT[nt](ft));st.push(ft);const Ve=ft.canonical.x,_t=ft.canonical.y;for(const nt of st){const Tt=_e.getTile(Me?nt.wrapped():nt);if(!Tt)continue;const jt=Tt.rasterParticleState;if(!jt)continue;const yt=nt.canonical.x+(1<<nt.canonical.z)*(nt.wrap-ft.wrap),Lt=nt.canonical.y;jt.particleTexture0.bind(ve.NEAREST,ve.CLAMP_TO_EDGE);const Yt=ss(1,jt.particleTexture0.size[0],[yt-Ve,Lt-_t],0,pt.texture.size,2,We,pt.textureOffset,pt.scale,pt.offset);Ke.draw(pe,ve.POINTS,sn.disabled,In.disabled,ii.alphaBlended,Sn.disabled,Yt,Ae.id,jt.particleIndexBuffer,void 0,jt.particleSegment)}}}(b,E,I,Y),L.bindFramebuffer.set(I.particleFramebuffer.framebuffer),function(pe,_e,Ae,Ie){const Te=pe.context,ve=Te.gl,Pe=_e.paint.get("raster-particle-max-speed"),Me=Ie*_e.paint.get("raster-particle-speed-factor")*.15,We=function(ft){return Math.pow(ft,6)}(.01+1*_e.paint.get("raster-particle-reset-rate-factor")),Qe=_e.particleFramebuffer;Te.viewport.set([0,0,Qe.width,Qe.height]);for(const ft of Ae){const[,pt,Et]=ft;Te.activeTexture.set(ve.TEXTURE0+0),pt.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),Te.activeTexture.set(ve.TEXTURE0+1);const Ke=Et.particleTexture0;Ke.bind(ve.NEAREST,ve.CLAMP_TO_EDGE);const st=Ys(1,Ke.size[0],0,pt.texture.size,Pe,Me,We,pt.textureOffset,pt.scale,pt.offset);Qe.colorAttachment.set(Et.particleTexture1.texture),Te.clear({color:r.am.transparent}),pe.getOrCreateProgram("rasterParticleUpdate",{defines:pt.defines}).draw(pe,ve.TRIANGLES,sn.disabled,In.disabled,ii.unblended,Sn.disabled,st,_e.id,pe.viewportBuffer,pe.quadTriangleIndexBuffer,pe.viewportSegments)}}(b,I,Y,re)}(u,t,s,h),u.renderPass==="translucent"&&(function(b,E,I,z,L){const N=b.context,F=N.gl,q=E.getSource().tileSize,X=5*(1-r.af(r.cx,r.cx+1,b.transform.zoom))*q+I.paint.get("raster-particle-elevation"),G=!b.options.moving,Y=b.transform.projection.name==="globe";if(!z.length)return;const[J,re]=b.stencilConfigForOverlap(z),pe=[];Y&&pe.push("PROJECTION_GLOBE_VIEW");const _e=b.stencilModeFor3D();for(const Ae of re){const Ie=Ae.toUnwrapped(),Te=E.getTile(Ae);if(!Te.rasterParticleState)continue;const ve=Te.rasterParticleState,Pe=100;Te.registerFadeDuration(Pe);const Me=E.findLoadedParent(Ae,0),We=fs(Te,Me,E,b.transform,Pe);let Qe,ft;b.terrain&&b.terrain.prepareDrawTile(),N.activeTexture.set(F.TEXTURE0),ve.targetColorTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),N.activeTexture.set(F.TEXTURE1),Me&&Me.rasterParticleState?(Me.rasterParticleState.targetColorTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Qe=Math.pow(2,Me.tileID.overscaledZ-Te.tileID.overscaledZ),ft=[Te.tileID.canonical.x*Qe%1,Te.tileID.canonical.y*Qe%1]):ve.targetColorTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE);const pt=Y?Float32Array.from(b.transform.expandedFarZProjMatrix):b.transform.calculateProjMatrix(Ie,G),Et=b.transform,Ke=eh(Et),st=r.dn(Ae.canonical),Ve=r.dp(st.getCenter().lat);let _t,nt,Tt,jt,yt;Y?(_t=Float32Array.from(r.bh(r.dr(Ae.canonical))),nt=Float32Array.from(Et.globeMatrix),Tt=Float32Array.from(r.dm(Et)),jt=[r.aD(Et.center.lng),r.aH(Et.center.lat)],yt=Float32Array.from(r.dq(Ae.canonical,st,Ve,Et.worldSize/Et._pixelsPerMercatorPixel))):(_t=new Float32Array(16),nt=new Float32Array(9),Tt=new Float32Array(16),jt=[0,0],yt=new Float32Array(9));const Lt=js(pt,_t,nt,Tt,yt,ft||[0,0],r.ah(b.transform.zoom),jt,Ke,Qe||1,We,X),Yt=b.isTileAffectedByFog(Ae),tn=b.getOrCreateProgram("rasterParticle",{defines:pe,overrideFog:Yt});if(b.uploadCommonUniforms(N,tn,Ie),Y){const Xt=new sn(F.LEQUAL,sn.ReadOnly,b.depthRangeFor3D),rn=0,fn=b.globeSharedBuffers;if(fn){const[_n,Pn,Wn]=fn.getGridBuffers(Ve,rn!==0);tn.draw(b,F.TRIANGLES,Xt,_e,ii.alphaBlended,b.renderElevatedRasterBackface?Sn.frontCCW:Sn.backCCW,Lt,I.id,_n,Pn,Wn)}}else{const Xt=b.depthModeForSublayer(0,sn.ReadOnly),rn=J[Ae.overscaledZ],{tileBoundsBuffer:fn,tileBoundsIndexBuffer:_n,tileBoundsSegments:Pn}=b.getTileBoundsBuffers(Te);tn.draw(b,F.TRIANGLES,Xt,rn,ii.alphaBlended,Sn.disabled,Lt,I.id,fn,_n,Pn)}}b.resetStencilClippingMasks()}(u,t,s,h),u.style.map.triggerRepaint())},background:function(u,t,s,h){const g=s.paint.get("background-color"),v=s.paint.get("background-color-use-theme").constantOr("default")==="none",b=s.paint.get("background-opacity"),E=s.paint.get("background-emissive-strength"),I=s.paint.get("background-pitch-alignment")==="viewport";if(b===0)return;const z=u.context,L=z.gl,N=u.transform,F=N.tileSize,q=s.paint.get("background-pattern");let X;if(q!==void 0&&(q===null||(X=u.imageManager.getPattern(r.I.from(q.toString()),s.scope,u.style.getLut(s.scope)),!X)))return;const G=!q&&g.a===1&&b===1&&u.opaquePassEnabledForLayer()?"opaque":"translucent";if(u.renderPass!==G)return;const Y=In.disabled,J=u.depthModeForSublayer(0,G==="opaque"?sn.ReadWrite:sn.ReadOnly),re=u.colorModeForDrapableLayerRenderPass(E),pe=q?"backgroundPattern":"background";let _e,Ae=h;if(Ae||(_e=u.getBackgroundTiles(),Ae=Object.values(_e).map(Ie=>Ie.tileID)),q&&(z.activeTexture.set(L.TEXTURE0),u.imageManager.bind(u.context,s.scope)),I){const Ie=u.getOrCreateProgram(pe,{overrideFog:!1,overrideRtt:!0}),Te=new Float32Array(r.bx([])),ve=new r.aM(0,0,0,0,0),Pe=q?Kh(Te,E,b,u,0,s.scope,X,I,{tileID:ve,tileSize:F}):Zh(Te,E,b,g.toPremultipliedRenderColor(v?null:s.lut));Ie.draw(u,L.TRIANGLES,J,Y,re,Sn.disabled,Pe,s.id,u.viewportBuffer,u.quadTriangleIndexBuffer,u.viewportSegments)}else for(const Ie of Ae){const Te=u.isTileAffectedByFog(Ie),ve=u.getOrCreateProgram(pe,{overrideFog:Te}),Pe=Ie.toUnwrapped(),Me=h?Ie.projMatrix:u.transform.calculateProjMatrix(Pe);u.prepareDrawTile();const We=t?t.getTile(Ie):_e?_e[Ie.key]:new ec(Ie,F,N.zoom,u),Qe=q?Kh(Me,E,b,u,0,s.scope,X,I,{tileID:Ie,tileSize:F}):Zh(Me,E,b,g.toPremultipliedRenderColor(v?null:s.lut));u.uploadCommonUniforms(z,ve,Pe);const{tileBoundsBuffer:ft,tileBoundsIndexBuffer:pt,tileBoundsSegments:Et}=u.getTileBoundsBuffers(We);ve.draw(u,L.TRIANGLES,J,Y,re,Sn.disabled,Qe,s.id,ft,pt,Et)}},sky:function(u,t,s){const h=u._atmosphere?r.ah(u.transform.zoom):1,g=s.paint.get("sky-opacity")*h;if(g===0)return;const v=u.context,b=s.paint.get("sky-type"),E=new sn(v.gl.LEQUAL,sn.ReadOnly,[0,1]),I=u.frameCounter/1e3%1;b==="atmosphere"?u.renderPass==="offscreen"?s.needsSkyboxCapture(u)&&(function(z,L,N,F){const q=z.context,X=q.gl;let G=L.skyboxFbo;if(!G){G=L.skyboxFbo=q.createFramebuffer(32,32,!0,null),L.skyboxGeometry=new ou(q),L.skyboxTexture=q.gl.createTexture(),X.bindTexture(X.TEXTURE_CUBE_MAP,L.skyboxTexture),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MAG_FILTER,X.LINEAR);for(let pe=0;pe<6;++pe)X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+pe,0,X.RGBA,32,32,0,X.RGBA,X.UNSIGNED_BYTE,null)}q.bindFramebuffer.set(G.framebuffer),q.viewport.set([0,0,32,32]);const Y=L.getCenter(z,!0),J=z.getOrCreateProgram("skyboxCapture"),re=new Float64Array(16);r.bx(re),r.e3(re,re,.5*-Math.PI),Yo(z,L,J,re,Y,0),r.bx(re),r.e3(re,re,.5*Math.PI),Yo(z,L,J,re,Y,1),r.bx(re),r.cG(re,re,.5*-Math.PI),Yo(z,L,J,re,Y,2),r.bx(re),r.cG(re,re,.5*Math.PI),Yo(z,L,J,re,Y,3),r.bx(re),Yo(z,L,J,re,Y,4),r.bx(re),r.e3(re,re,Math.PI),Yo(z,L,J,re,Y,5),q.viewport.set([0,0,z.width,z.height])}(u,s),s.markSkyboxValid(u)):u.renderPass==="sky"&&function(z,L,N,F,q){const X=z.context,G=X.gl,Y=z.transform,J=z.getOrCreateProgram("skybox");X.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_CUBE_MAP,L.skyboxTexture);const re=((pe,_e,Ae,Ie,Te)=>({u_matrix:pe,u_sun_direction:_e,u_cubemap:0,u_opacity:Ie,u_temporal_offset:Te}))(Y.skyboxMatrix,L.getCenter(z,!1),0,F,q);z.uploadCommonUniforms(X,J),J.draw(z,G.TRIANGLES,N,In.disabled,z.colorModeForRenderPass(),Sn.backCW,re,"skybox",L.skyboxGeometry.vertexBuffer,L.skyboxGeometry.indexBuffer,L.skyboxGeometry.segment)}(u,s,E,g,I):b==="gradient"&&u.renderPass==="sky"&&function(z,L,N,F,q){const X=z.context,G=X.gl,Y=z.transform,J=z.getOrCreateProgram("skyboxGradient");L.skyboxGeometry||(L.skyboxGeometry=new ou(X)),X.activeTexture.set(G.TEXTURE0);let re=L.colorRampTexture;re||(re=L.colorRampTexture=new r.T(X,L.colorRamp,G.RGBA8)),re.bind(G.LINEAR,G.CLAMP_TO_EDGE);const pe=((_e,Ae,Ie,Te,ve)=>({u_matrix:_e,u_color_ramp:0,u_center_direction:Ae,u_radius:r.al(Ie),u_opacity:Te,u_temporal_offset:ve}))(Y.skyboxMatrix,L.getCenter(z,!1),L.paint.get("sky-gradient-radius"),F,q);z.uploadCommonUniforms(X,J),J.draw(z,G.TRIANGLES,N,In.disabled,z.colorModeForRenderPass(),Sn.backCW,pe,"skyboxGradient",L.skyboxGeometry.vertexBuffer,L.skyboxGeometry.indexBuffer,L.skyboxGeometry.segment)}(u,s,E,g,I)},custom:function(u,t,s,h){const g=u.context,v=s.implementation;if(!u.transform.projection.unsupportedLayers||!u.transform.projection.unsupportedLayers.includes("custom")||u.terrain&&(u.terrain.renderingToTexture||u.renderPass==="offscreen")&&s.isDraped(t)){if(u.renderPass==="offscreen"){const b=v.prerender;if(b){if(u.setCustomLayerDefaults(),g.setColorMode(u.colorModeForRenderPass()),u.transform.projection.name==="globe"){const E=u.transform.pointMerc;b.call(v,g.gl,u.transform.customLayerMatrix(),u.transform.getProjection(),u.transform.globeToMercatorMatrix(),r.ah(u.transform.zoom),[E.x,E.y],u.transform.pixelsPerMeterRatio)}else b.call(v,g.gl,u.transform.customLayerMatrix());g.setDirty(),u.setBaseState()}}else if(u.renderPass==="translucent"){if(u.terrain&&u.terrain.renderingToTexture){const E=v.renderToTile;if(E){const I=h[0].canonical,z={x:I.x+h[0].wrap*(v.wrapTileId?0:1<<I.z),y:I.y,z:I.z};g.setDepthMode(sn.disabled),g.setStencilMode(In.disabled),g.setColorMode(u.colorModeForRenderPass()),u.setCustomLayerDefaults(),E.call(v,g.gl,z),g.setDirty(),u.setBaseState()}return}u.setCustomLayerDefaults(),g.setColorMode(u.colorModeForRenderPass()),g.setStencilMode(In.disabled);const b=v.renderingMode==="3d"?new sn(u.context.gl.LEQUAL,sn.ReadWrite,u.depthRangeFor3D):u.depthModeForSublayer(0,sn.ReadOnly);if(g.setDepthMode(b),u.transform.projection.name==="globe"){const E=u.transform.pointMerc;v.render(g.gl,u.transform.customLayerMatrix(),u.transform.getProjection(),u.transform.globeToMercatorMatrix(),r.ah(u.transform.zoom),[E.x,E.y],u.transform.pixelsPerMeterRatio)}else v.render(g.gl,u.transform.customLayerMatrix());g.setDirty(),u.setBaseState(),g.bindFramebuffer.set(null)}}else r.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(u,t,s,h){if(u.renderPass==="opaque")return;const g=s.paint.get("model-opacity").constantOr(1);if(g===0)return;const v=s.paint.get("model-cast-shadows");if(u.renderPass==="shadow"&&(!v||u.terrain&&g<.65&&s._transitionablePaint._values["model-opacity"].value.expression instanceof r.ab))return;const b=u.shadowRenderer,E=s.paint.get("model-receive-shadows");b&&(b.useNormalOffset=!0,E||(b.enabled=!1));const I=()=>{b&&(b.useNormalOffset=!0,E||(b.enabled=!0))},z=t.getSource();if(u.renderPass==="light-beam"&&z.type!=="batched-model")return;if(z.type==="vector"||z.type==="geojson")return function(J,re,pe,_e,Ae){const Ie=J.transform;if(Ie.projection.name!=="mercator")return void r.w(`Drawing 3D models for ${Ie.projection.name} projection is not yet implemented`);const Te=Ie.getFreeCameraOptions().position;if(!J.modelManager)return;const ve=J.modelManager;pe.modelManager=ve;const Pe=J.shadowRenderer;if(!pe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Me=pe._unevaluatedLayout._values["model-id"],We=Object.assign({},pe.layout.get("model-id").parameters),Qe=J.style.order.indexOf(pe.fqid);for(const ft of _e){const pt=re.getTile(ft).getBucket(pe);if(!pt||pt.projection.name!==Ie.projection.name)continue;const Et=pt.getModelUris();Et&&!pt.modelsRequested&&(ve.addModelsFromBucket(Et,Ae),pt.modelsRequested=!0);const Ke=Lo(ft,Ie);We.zoom=Ke;const st=Me.possiblyEvaluate(We);if(Xe(J,pt,ft),Ps.shadowUniformsInitialized=!1,Ps.useSingleShadowCascade=!!Pe&&Pe.getMaxCascadeForTile(ft.toUnwrapped())===0,J.renderPass==="shadow"&&Pe){if(J.currentShadowCascade===1&&pt.isInsideFirstShadowMapFrustum)continue;const nt=Ie.calculatePosMatrix(ft.toUnwrapped(),Ie.worldSize);if(Ps.tileMatrix.set(nt),Ps.shadowTileMatrix=Float32Array.from(Pe.calculateShadowPassMatrixFromMatrix(nt)),Ps.aabb.min.fill(0),Ps.aabb.max[0]=Ps.aabb.max[1]=r.aj,Ps.aabb.max[2]=0,Yd(pt,Ps,J,pe.scope))continue}const Ve=1<<ft.canonical.z,_t=[((Te.x-ft.wrap)*Ve-ft.canonical.x)*r.aj,(Te.y*Ve-ft.canonical.y)*r.aj,Te.z*Ve*r.aj];J.conflationActive&&Object.keys(pt.instancesPerModel).length>0&&J.style.isLayerClipped(pe,re.getSource())&&pt.updateReplacement(ft,J.replacementSource,Qe,Ae)&&(pt.uploaded=!1,pt.upload(J.context));for(let nt in pt.instancesPerModel){const Tt=pt.instancesPerModel[nt];Tt.features.length>0&&(nt=st.evaluate(Tt.features[0].feature,{}));const jt=ve.getModel(nt,Ae);if(jt||ve.hasURLBeenRequested(nt)||pt.modelUris.includes(nt)||(pt.modelUris.push(nt),pt.modelsRequested=!1),jt&&jt.uploaded)for(const yt of jt.nodes)Tc(J,pe,yt,Tt,_t,ft,Ps)}}}(u,t,s,h,z.type==="vector"?s.scope:""),void I();if(!z.loaded())return;if(z.type==="batched-model")return function(J,re,pe,_e){pe.resetLayerRenderingStats(J);const Ae=J.context,Ie=J.transform,Te=J.style.fog,ve=J.shadowRenderer;if(Ie.projection.name!=="mercator")return void r.w(`Drawing 3D landmark models for ${Ie.projection.name} projection is not yet implemented`);const Pe=J.transform.getFreeCameraOptions().position,Me=r.bY([],[Pe.x,Pe.y,Pe.z],J.transform.worldSize),We=r.eb([],Me),Qe=r.bx([]),ft=r.ec(Ie.center.lat,Ie.zoom),pt=r.bn([],[1,1,1/ft]);r.bo(Qe,Qe,We);const Et=pe.paint.get("model-opacity").constantOr(1),Ke=new sn(Ae.gl.LEQUAL,sn.ReadWrite,J.depthRangeFor3D),st=new sn(Ae.gl.LEQUAL,sn.ReadOnly,J.depthRangeFor3D),Ve=new r.cW([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),_t=J.renderPass==="shadow",nt=_t&&ve?ve.getCurrentCascadeFrustum():Ie.getFrustum(Ie.scaleZoom(Ie.worldSize)),Tt=pe.paint.get("model-front-cutoff"),jt=Tt[2]<1,yt=$o(J,pe.paint.get("model-cutoff-fade-range")),Lt=pe.getLayerRenderingStats();(function(Yt,tn,Xt,rn){const fn=Yt.terrain?Yt.terrain.exaggeration():0,_n=Yt.transform.zoom;for(const Pn of rn){const Wn=tn.getTile(Pn).getBucket(Xt);Wn&&(Wn.setFilter(Xt.filter),Yt.conflationActive&&Wn.updateReplacement(Pn,Yt.replacementSource),Wn.evaluateTransform(Yt,Xt),Yt.terrain&&fn>0&&Wn.elevationUpdate(Yt.terrain,fn,Pn,Xt.source),Wn.needsReEvaluation(Yt,_n,Xt)&&Wn.evaluate(Xt))}})(J,re,pe,_e),function(){let Yt,tn,Xt;jt?(Yt=_e.length-1,tn=-1,Xt=-1):(Yt=0,tn=_e.length,Xt=1);const rn=new Float64Array(16),fn=r.ef(),_n=new r.P(0,0);for(let Pn=Yt;Pn!==tn;Pn+=Xt){const Wn=_e[Pn],vi=re.getTile(Wn).getBucket(pe);if(!vi||!vi.uploaded)continue;let Ji=!1;ve&&(Ji=ve.getMaxCascadeForTile(Wn.toUnwrapped())===0);const Oi=Ie.calculatePosMatrix(Wn.toUnwrapped(),Ie.worldSize),Ai=vi.modelTraits;!_t&&jt&&(r.bi(rn,Oi),r.ad(fn,Me,rn),_n.x=fn[0],_n.y=fn[1]);const Dr=[];vi.setFilter(pe.filter);for(const Dn of vi.getNodesInfo()){if(Dn.hiddenByReplacement||!Dn.node.meshes)continue;const Zn=Dn.node;let si=0;J.terrain&&Zn.elevation&&(si=Zn.elevation*J.terrain.exaggeration());const er=(()=>{const Br=Dn.aabb;return Ve.min=[...Br.min],Ve.max=[...Br.max],Ve.min[2]+=si,Ve.max[2]+=si,r.ad(Ve.min,Ve.min,Oi),r.ad(Ve.max,Ve.max,Oi),Ve})(),Hr=Dn.evaluatedScale;if(Hr[0]<=1&&Hr[1]<=1&&Hr[2]<=1&&er.intersects(nt)===0)continue;if(!_t&&jt){const Br=.16666666666666666;Dn.cameraCollisionOpacity=Me[0]>er.min[0]&&Me[0]<er.max[0]&&Me[1]>er.min[1]&&Me[1]<er.max[1]&&Me[2]*ft<er.max[2]&&Zn.footprint&&r.bS(_n,Zn.footprint)?Math.max(Dn.cameraCollisionOpacity-Br,0):Math.min(1,Dn.cameraCollisionOpacity+Br)}const nr=[...Oi],Mi=1/r.cU(Wn.canonical),Mr=Zn.anchor?Zn.anchor[0]:0,yi=Zn.anchor?Zn.anchor[1]:0;r.bo(nr,nr,[Mr*(Hr[0]-1)+Dn.evaluatedTranslation[0]*Mi,yi*(Hr[1]-1)+Dn.evaluatedTranslation[1]*Mi,si+Dn.evaluatedTranslation[2]]),r.ci(Hr,r.eg)||r.cE(nr,nr,Hr);const Rr=r.az([],nr,Zn.matrix),cr=r.az([],Ie.expandedFarZProjMatrix,Rr),Ni=r.az([],Ie.expandedFarZProjMatrix,nr),ir=r.aA([],[Mr,yi,si,1],cr)[2];Zn.hidden=!1;let $n=Et;_t||(jt&&($n*=Dn.cameraCollisionOpacity,$n*=au(nr,Ie,Dn.aabb,Tt)),$n*=Hp(yt,ir)),$n!==0?Dr.push({nodeInfo:Dn,depth:ir,opacity:$n,wvpForNode:cr,wvpForTile:Ni,nodeModelMatrix:Rr,tileModelMatrix:nr}):Zn.hidden=!0}_t||Dr.sort((Dn,Zn)=>!jt||Dn.opacity===1&&Zn.opacity===1?Dn.depth<Zn.depth?-1:1:Dn.opacity===1?-1:Zn.opacity===1?1:Dn.depth>Zn.depth?-1:1);for(const Dn of Dr){const Zn=Dn.nodeInfo,si=Zn.node;let er=r.az([],pt,Dn.tileModelMatrix);r.az(er,Qe,er);const Hr=r.bi([],er);r.ee(Hr,Hr),r.cE(Hr,Hr,ed),er=r.az(er,er,si.matrix);const nr=J.renderPass==="light-beam",Mi=pe.paint.get("model-color-use-theme").constantOr("default")==="none",Mr=Ai&r.em.HasMapboxMeshFeatures,yi=Mr?0:Zn.evaluatedRMEA[0][2];for(let Rr=0;Rr<si.meshes.length;++Rr){const cr=si.meshes[Rr],Ni=Rr===si.lightMeshIndex;let ir=Dn.wvpForNode;if(Ni){if(!nr&&!J.terrain&&J.shadowRenderer){J.currentLayer<J.firstLightBeamLayer&&(J.firstLightBeamLayer=J.currentLayer);continue}ir=Dn.wvpForTile}else if(nr)continue;const $n={defines:[]},Br=[];if(!_t&&ve&&(ve.useNormalOffset=!!cr.normalBuffer),Ot($n.defines,Br,cr,J,Mi?null:pe.lut),Mr||$n.defines.push("DIFFUSE_SHADED"),Ji&&$n.defines.push("SHADOWS_SINGLE_CASCADE"),Lt&&(_t?Lt.numRenderedVerticesInShadowPass+=cr.vertexArray.length:Lt.numRenderedVerticesInTransparentPass+=cr.vertexArray.length),_t){Er(cr,Dn.nodeModelMatrix,J,pe);continue}let ks=null;if(Te){const ms=za(Dn.nodeModelMatrix,J.transform);if(ks=new Float32Array(ms),Ie.projection.name!=="globe"){const Qo=cr.aabb.min,Oo=cr.aabb.max,[Bo,Jo]=Te.getOpacityForBounds(ms,Qo[0],Qo[1],Oo[0],Oo[1]);$n.overrideFog=Bo>=rt||Jo>=rt}}const fr=cr.material;let Pi;fr.occlusionTexture&&fr.occlusionTexture.offsetScale&&(Pi=fr.occlusionTexture.offsetScale,$n.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Do=J.getOrCreateProgram("model",$n);!_t&&ve&&ve.setupShadowsFromMatrix(Dn.tileModelMatrix,Do,ve.useNormalOffset),J.uploadCommonUniforms(Ae,Do,null,ks);const xo=fr.pbrMetallicRoughness;xo.metallicFactor=.9,xo.roughnessFactor=.5;const ha=mc(new Float32Array(ir),new Float32Array(er),new Float32Array(Hr),new Float32Array(si.matrix),J,Dn.opacity,xo.baseColorFactor,fr.emissiveFactor,xo.metallicFactor,xo.roughnessFactor,fr,yi,pe,[0,0,0],Pi);!Ni&&(Zn.hasTranslucentParts||Dn.opacity<1)&&Do.draw(J,Ae.gl.TRIANGLES,Ke,In.disabled,ii.disabled,Sn.backCCW,ha,pe.id,cr.vertexBuffer,cr.indexBuffer,cr.segments,pe.paint,J.transform.zoom,void 0,Br),Do.draw(J,Ae.gl.TRIANGLES,Ni?st:Ke,In.disabled,Ni||Dn.opacity<1||Zn.hasTranslucentParts?ii.alphaBlended:ii.unblended,Sn.backCCW,ha,pe.id,cr.vertexBuffer,cr.indexBuffer,cr.segments,pe.paint,J.transform.zoom,void 0,Br)}}}}()}(u,t,s,h),void I();if(z.type!=="model")return;const L=z.getModels(),N=[],F=u.transform.getFreeCameraOptions().position,q=r.bY([],[F.x,F.y,F.z],u.transform.worldSize);r.eb(q,q);const X=[],G=[];let Y=0;for(const J of L){const re=s.paint.get("model-rotation").constantOr(null),pe=s.paint.get("model-scale").constantOr(null),_e=s.paint.get("model-translation").constantOr(null);J.computeModelMatrix(u,re,pe,_e,!0,!0,!1);const Ae=r.bx([]),Ie=r.ec(J.position.lat,u.transform.zoom),Te=r.bn([],[1,1,1/Ie]);r.bo(Ae,Ae,q),N.push({zScaleMatrix:Te,negCameraPosMatrix:Ae});for(const ve of J.nodes)Ml(u.transform,ve,J.matrix,u.transform.expandedFarZProjMatrix,Y,X,G);Y++}if(X.sort((J,re)=>re.depth-J.depth),u.renderPass!=="shadow"){if(g===1)for(const J of G)Zt(J,u,s,N[J.modelIndex],In.disabled,u.colorModeForRenderPass());else{for(const J of G)Zt(J,u,s,N[J.modelIndex],In.disabled,ii.disabled);for(const J of G)Zt(J,u,s,N[J.modelIndex],u.stencilModeFor3D(),u.colorModeForRenderPass());u.resetStencilClippingMasks()}for(const J of X)Zt(J,u,s,N[J.modelIndex],In.disabled,u.colorModeForRenderPass());I()}else{for(const J of G)Er(J.mesh,J.nodeModelMatrix,u,s);for(const J of X)Er(J.mesh,J.nodeModelMatrix,u,s);I()}}},tp={line:function(u,t,s){if(u.hasElevatedBuckets=!1,u.hasNonElevatedBuckets=!1,u._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||u._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(t){const h=t.getVisibleCoordinates();for(const g of h){const v=t.getTile(g).getBucket(u);if(v&&(v.elevationType!=="none"?u.hasElevatedBuckets=!0:u.hasNonElevatedBuckets=!0,u.hasElevatedBuckets&&u.hasNonElevatedBuckets))break}}}else u.hasNonElevatedBuckets=!0},model:function(u,t,s){const h=t.getSource();if(!h.loaded())return;if(h.type==="vector"||h.type==="geojson")return void(s.modelManager&&s.modelManager.upload(s,h.type==="vector"?u.scope:""));if(h.type==="batched-model"||h.type!=="model")return;const g=h.getModels();for(const v of g)v.upload(s.context)},raster:function(u,t,s){const h=t.getSource();if(!(h instanceof Xl&&h.loaded()))return;const g=u.sourceLayer||h.rasterLayerIds&&h.rasterLayerIds[0];if(!g)return;const v=u.paint.get("raster-array-band")||h.getInitialBand(g);if(v==null)return;const b=t.getIds().map(E=>t.getTileByID(E));for(const E of b)E.updateNeeded(g,v)&&h.prepareTile(E,g,v)},"raster-particle":function(u,t,s){const h=t.getSource();if(!(h instanceof Xl&&h.loaded()))return;const g=u.sourceLayer||h.rasterLayerIds&&h.rasterLayerIds[0];if(!g)return;const v=u.paint.get("raster-particle-array-band")||h.getInitialBand(g);if(v==null)return;const b=t.getIds().map(E=>t.getTileByID(E));for(const E of b)E.updateNeeded(g,v)&&h.prepareTile(E,g,v)}},ll={fill:Yh},rh={fill:function(u,t,s,h){if(!s.layout||s.layout.get("fill-elevation-reference")==="none")return;const g=u.context.gl,v=new sn(g.LEQUAL,sn.ReadOnly,u.depthRangeFor3D),b=new In({func:g.ALWAYS,mask:255},255,255,g.KEEP,g.KEEP,g.REPLACE),E=u.transform.getFreeCameraOptions().position,I=u.getOrCreateProgram("elevatedStructuresDepthReconstruct",{defines:["DEPTH_RECONSTRUCTION"]});for(const z of h){const L=t.getTile(z),N=L.getBucket(s);if(!N)continue;const F=N.elevatedStructures;if(!F||F.maskSegments.segments[0].primitiveLength===0)continue;const q=Ju(z.toUnwrapped(),E),X=u.translatePosMatrix(z.projMatrix,L,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor")),G=Mo(X,q,0,0,0);I.draw(u,g.TRIANGLES,v,b,ii.disabled,Sn.disabled,G,s.id,F.vertexBuffer,F.indexBuffer,F.maskSegments,s.paint,u.transform.zoom)}}};class sh{constructor(t,s,h,g,v,b){this.context=new Ff(t,s),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=v,this._timeStamp=r.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const E=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const z of E)this._debugParams.enabledLayers[z]=!0;v.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),v.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),v.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),v.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),v.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),v.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const z of E)v.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],z);this.occlusionParams=new Up(v),this.setup(),this.numSublayers=Zs.maxUnderzooming+Zs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new r.et,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new qm(this),this._wireframeDebugCache=new Vf,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const I=new r.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new r.T(this.context,I,t.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=g,this.worldview=b}updateTerrain(t,s){const h=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(h||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Xs(this,t));const g=this._terrain;this.transform.elevation=h?g:null,g.update(t,this.transform,s),this.transform.elevation&&!g.enabled&&(this.transform.elevation=null)}_updateFog(t){const s=t.fog;if(!s||this.transform.projection.name==="globe"||s.getOpacity(this.transform.pitch)<1||s.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[h,g]=s.getFovAdjustedRange(this.transform._fov);if(h>g)return void(this.transform.fogCullDistSq=null);const v=h+.78*(g-h);this.transform.fogCullDistSq=v*v}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(t){t&&!this._terrain&&(this._terrain=new Xs(this,this.style)),this._forceTerrainMode=t}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,s){if(this.width=t*r.q.devicePixelRatio,this.height=s*r.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style.order)this.style._mergedLayers[h].resize()}setup(){const t=this.context,s=new r.ba;s.emplaceBack(0,0),s.emplaceBack(r.aj,0),s.emplaceBack(0,r.aj),s.emplaceBack(r.aj,r.aj),this.tileExtentBuffer=t.createVertexBuffer(s,r.bc.members),this.tileExtentSegments=r.bd.simpleSegment(0,0,4,2);const h=new r.ba;h.emplaceBack(0,0),h.emplaceBack(r.aj,0),h.emplaceBack(0,r.aj),h.emplaceBack(r.aj,r.aj),this.debugBuffer=t.createVertexBuffer(h,r.bc.members),this.debugSegments=r.bd.simpleSegment(0,0,4,5);const g=new r.ba;g.emplaceBack(-1,-1),g.emplaceBack(1,-1),g.emplaceBack(-1,1),g.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(g,r.bc.members),this.viewportSegments=r.bd.simpleSegment(0,0,4,2);const v=new r.aZ;v.emplaceBack(0,0,0,0),v.emplaceBack(r.aj,0,r.aj,0),v.emplaceBack(0,r.aj,0,r.aj),v.emplaceBack(r.aj,r.aj,r.aj,r.aj),this.mercatorBoundsBuffer=t.createVertexBuffer(v,r.bf.members),this.mercatorBoundsSegments=r.bd.simpleSegment(0,0,4,2);const b=new r.a_;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(b);const E=new r.bb;for(const z of[0,1,3,2,0])E.emplaceBack(z);this.debugIndexBuffer=t.createIndexBuffer(E),this.emptyTexture=new r.T(t,new r.r({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA8),this.identityMat=r.bz();const I=this.context.gl;this.stencilClearMode=new In({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,sn.disabled,this.stencilClearMode,ii.disabled,Sn.disabled,Go(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,s,h){if(!s||this.currentStencilSource===s.id||!t.isTileClipped()||!h||h.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let E=!1;for(const I of h)if(this._tileClippingMaskIDs[I.key]===void 0){E=!0;break}if(!E)return}this.currentStencilSource=s.id;const g=this.context,v=g.gl;this.nextStencilID+h.length>256&&this.clearStencil(),g.setColorMode(ii.disabled),g.setDepthMode(sn.disabled);const b=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of h){const I=s.getTile(E),z=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,{tileBoundsBuffer:L,tileBoundsIndexBuffer:N,tileBoundsSegments:F}=this.getTileBoundsBuffers(I);b.draw(this,v.TRIANGLES,sn.disabled,new In({func:v.ALWAYS,mask:0},z,255,v.KEEP,v.KEEP,v.REPLACE),ii.disabled,Sn.disabled,Go(E.projMatrix),"$clipping",L,N,F)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,s=this.context.gl;return new In({func:s.NOTEQUAL,mask:255},t,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const s=this.context.gl;return new In({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(t){const s=this.context.gl,h=t.sort((b,E)=>E.overscaledZ-b.overscaledZ),g=h[h.length-1].overscaledZ,v=h[0].overscaledZ-g+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const b={};for(let E=0;E<v;E++)b[E+g]=new In({func:s.GEQUAL,mask:255},E+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=v,[b,h]}return[{[g]:In.disabled},h]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new ii([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new r.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ii.unblended:ii.alphaBlended}colorModeForDrapableLayerRenderPass(t){const s=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new ii([s.ONE,s.ONE_MINUS_SRC_ALPHA,s.CONSTANT_ALPHA,s.ONE_MINUS_SRC_ALPHA],new r.am(0,0,0,t===void 0?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,s,h,g=!1){if(this.depthOcclusion)return new sn(this.context.gl.GREATER,sn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!g)return sn.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new sn(h||this.context.gl.LEQUAL,s,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const t=this.context.gl,s=Math.ceil(this.width),h=Math.ceil(this.height),g=this.context.bindFramebuffer.get(),v=t.getParameter(t.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===s&&this.depthFBO.height===h||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),s!==0&&h!==0&&(this.depthFBO=new Qu(this.context,s,h,!1,"texture"),this.depthTexture=new r.T(this.context,{width:s,height:h,data:null},t.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(g),t.bindTexture(t.TEXTURE_2D,v),this.depthFBO&&(t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),t.blitFramebuffer(0,0,s,h,0,0,s,h,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(t.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((t,s)=>t+s/this._fpsHistory.length,0))}render(t,s){const h=r.q.now();this._dt=h-this._timeStamp,this._timeStamp=h,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=t.map.repaint,this.style=t,this.options=s;const g=this.style._mergedLayers,v=!(!this.terrain||!this.terrain.enabled),b=()=>this.style._getOrder(v).filter(Ke=>{const st=g[Ke];return!(st.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[st.type]});let E=b(),I=!1,z=!1;for(const Ke of E){const st=g[Ke];st.type==="circle"&&(I=!0),st.type==="symbol"&&(st.hasInitialOcclusionOpacityProperties?z=!0:I=!0)}let L=E.map(Ke=>g[Ke]);const N=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(r.q.now()),this.imageManager.beginFrame();let F=0,q=!1;for(const Ke in N){const st=N[Ke];st.used&&(st.prepare(this.context),st.getSource().usedInConflation&&++F)}let X=!1;for(const Ke of L)Ke.isHidden(this.transform.zoom)||(Ke.type==="clip"&&(X=!0),this.prepareLayer(Ke));const G={},Y={},J={},re={},pe={};for(const Ke in N){const st=N[Ke];G[Ke]=st.getVisibleCoordinates(),Y[Ke]=G[Ke].slice().reverse(),J[Ke]=st.getVisibleCoordinates(!0).reverse(),re[Ke]=st.getShadowCasterCoordinates(),pe[Ke]=st.sortCoordinatesByDistance(G[Ke])}const _e=Ke=>{const st=this.style.getLayerSourceCache(Ke);return st&&st.used?st.getSource():null};if(F||X||this._clippingActiveLastFrame){const Ke=[],st=[];let Ve=0;for(const _t of L)this.isSourceForClippingOrConflation(_t,_e(_t))&&(Ke.push(_t),st.push(Ve)),Ve++;if(Ke&&(X||Ke.length>1)||this._clippingActiveLastFrame){X=!1;const _t=[];for(let nt=0;nt<Ke.length;nt++){const Tt=Ke[nt],jt=st[nt],yt=this.style.getLayerSourceCache(Tt);if(!yt||!yt.used||!yt.getSource().usedInConflation&&Tt.type!=="clip")continue;let Lt=r.eu,Yt=r.bQ.None;const tn=[];let Xt=!0;if(Tt.type==="clip"){Lt=jt;for(const rn of Tt.layout.get("clip-layer-types"))Yt|=rn==="model"?r.bQ.Model:rn==="symbol"?r.bQ.Symbol:r.bQ.FillExtrusion;for(const rn of Tt.layout.get("clip-layer-scope"))tn.push(rn);Tt.isHidden(this.transform.zoom)?Xt=!1:X=!0}Xt&&_t.push({layer:Tt.fqid,cache:yt,order:Lt,clipMask:Yt,clipScope:tn})}this.replacementSource.setSources(_t),q=!0}}this._clippingActiveLastFrame=X,q||this.replacementSource.clear(),this.conflationActive=q,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Ke=0;Ke<L.length;Ke++){const st=L[Ke],Ve=st.cutoffRange();if(this.longestCutoffRange=Math.max(Ve,this.longestCutoffRange),Ve>0){const _t=_e(st);_t&&(this.minCutoffZoom=Math.max(_t.minzoom,this.minCutoffZoom)),st.minzoom&&(this.minCutoffZoom=Math.max(st.minzoom,this.minCutoffZoom))}st.is3D(v)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Ke),this._lastOcclusionLayer=Ke)}const Ae=this.style&&this.style.fog;Ae?(this._fogVisible=Ae.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ae.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(J),this.opaquePassCutoff=0,E=b(),L=E.map(Ke=>g[Ke]));const Ie=this._shadowRenderer;if(Ie){Ie.updateShadowParameters(this.transform,this.style.directionalLight);for(const Ke in N)for(const st of G[Ke]){let Ve={min:0,max:0};this.terrain&&(Ve=this.terrain.getMinMaxForTile(st)||Ve),Ie.addShadowReceiver(st.toUnwrapped(),Ve.min,Ve.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.ev(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new sl(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Te=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),ve=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Te&&!this._snow&&(this._snow=new lr(this)),!Te&&this._snow&&(this._snow.destroy(),delete this._snow),ve&&!this._rain&&(this._rain=new qf(this)),!ve&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Ci.has(this.context.gl))return;this.renderPass="offscreen";for(const Ke of L){const st=t.getLayerSourceCache(Ke);if(!Ke.hasOffscreenPass()||Ke.isHidden(this.transform.zoom))continue;const Ve=st?Y[st.id]:void 0;(Ke.type==="custom"||Ke.type==="raster"||Ke.type==="raster-particle"||Ke.isSky()||Ve&&Ve.length)&&this.renderLayer(this,st,Ke,Ve)}this.depthRangeFor3D=[0,1-(L.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,re)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Pe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Me=(()=>{if(s.showOverdrawInspector)return r.am.black;const Ke=this.style.fog;if(Ke&&this.transform.projection.supportsFog){const st=this.style.getLut(Ke.scope);if(!Pe){const Ve=Ke.properties.get("color-use-theme")==="none",_t=Ke.properties.get("color").toNonPremultipliedRenderColor(Ve?null:st).toArray01();return new r.am(..._t)}if(Pe){const Ve=Ke.properties.get("space-color-use-theme")==="none",_t=Ke.properties.get("space-color").toNonPremultipliedRenderColor(Ve?null:st).toArray01();return new r.am(..._t)}}return r.am.transparent})();if(this.context.clear({color:Me,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Pe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=E.length-1;this.currentLayer>=0;this.currentLayer--){const Ke=L[this.currentLayer],st=t.getLayerSourceCache(Ke);if(Ke.isSky())continue;const Ve=st?(Ke.is3D(v)?pe:Y)[st.id]:void 0;this._renderTileClippingMasks(Ke,st,Ve),this.renderLayer(this,st,Ke,Ve)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Pe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||r.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<E.length;this.currentLayer++){const Ke=L[this.currentLayer],st=t.getLayerSourceCache(Ke);Ke.isSky()&&this.renderLayer(this,st,Ke,st?Y[st.id]:void 0)}function We(Ke,st){let Ve;return st&&(Ve=(Ke.type==="symbol"?J:Ke.is3D(v)?pe:Y)[st.id]),Ve}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<E.length;){const Ke=L[this.currentLayer];if(Ke.type==="raster"||Ke.type==="raster-particle"){const st=t.getLayerSourceCache(Ke);this.renderLayer(this,st,Ke,We(Ke,st))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Qe=0;Ie&&(Qe=Ie.getShadowCastingLayerCount());let ft=!1,pt=-1;for(let Ke=0;Ke<E.length;++Ke){const st=L[Ke];st.isHidden(this.transform.zoom)||st.is3D(v)&&(pt=Ke)}z&&pt===-1&&(I=!0);let Et=!1;for(;this.currentLayer<E.length;){const Ke=L[this.currentLayer],st=t.getLayerSourceCache(Ke);if(Ke.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Ke)){if(Ke.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Et&&Ke.is3D(v)&&!v){const Ve=this.currentLayer,_t=nt=>{for(this.currentLayer=0;this.currentLayer<L.length;this.currentLayer++){const Tt=L[this.currentLayer];if(ll[Tt.type]){const jt=this.style.getLayerSourceCache(Tt);ll[Tt.type](this,jt,Tt,We(Tt,jt),nt)}}};_t("initialize"),_t("reset"),this.currentLayer=Ve,Et=!0}if(I&&!ft&&this.terrain&&!this.transform.isOrthographic&&(ft=!0,this.blitDepth()),z&&pt!==-1&&this.currentLayer===pt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(Ke,st,st?G[st.id]:void 0),this.renderLayer(this,st,Ke,We(Ke,st)),!this.terrain&&Ie&&Qe>0&&Ke.hasShadowPass()&&--Qe==0){{this.clearStencil();const Ve=this.currentLayer;for(this.currentLayer=0;this.currentLayer<L.length;this.currentLayer++){const _t=L[this.currentLayer];if(rh[_t.type]){const nt=this.style.getLayerSourceCache(_t);rh[_t.type](this,nt,_t,We(_t,nt))}}this.currentLayer=Ve}if(Ie.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const Ve=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ve;this.currentLayer++){const _t=L[this.currentLayer];if(!_t.hasLightBeamPass())continue;const nt=t.getLayerSourceCache(_t);this.renderLayer(this,nt,_t,nt?Y[nt.id]:void 0)}this.currentLayer=Ve,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ve=this.currentLayer;this.depthOcclusion=!0;for(const _t of this.layersWithOcclusionOpacity){this.currentLayer=_t;const nt=L[this.currentLayer],Tt=t.getLayerSourceCache(nt),jt=Tt?Y[Tt.id]:void 0;this.terrain||this._renderTileClippingMasks(nt,Tt,Tt?G[Tt.id]:void 0),this.renderLayer(this,Tt,nt,jt)}this.depthOcclusion=!1,this.currentLayer=Ve,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Ke=null;L.forEach(st=>{const Ve=t.getLayerSourceCache(st);Ve&&!st.isHidden(this.transform.zoom)&&Ve.getVisibleCoordinates().length&&(!Ke||Ke.getSource().maxzoom<Ve.getSource().maxzoom)&&(Ke=Ve)}),Ke&&this.options.showTileBoundaries&&Xo(this,Ke,Ke.getVisibleCoordinates(),r.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Xo(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new r.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Ke){const st=Ke.transform.padding;th(Ke,Ke.transform.height-(st.top||0),3,rl),th(Ke,st.bottom||0,3,Jh),ts(Ke,st.left||0,3,Qs),ts(Ke,Ke.transform.width-(st.right||0),3,Pl);const Ve=Ke.transform.centerPoint;(function(_t,nt,Tt,jt){kl(_t,nt-1,Tt-10,2,20,jt),kl(_t,nt-10,Tt-1,20,2,jt)})(Ke,Ve.x,Ke.transform.height-Ve.y,Js)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),q||(this.conflationActive=!1)}prepareLayer(t){this.gpuTimingStart(t);const{unsupportedLayers:s}=this.transform.projection,h=!s||!s.includes(t.type);if(tp[t.type]&&(h||this.terrain&&t.type==="custom")){const g=this.style.getLayerSourceCache(t);tp[t.type](t,g,this)}this.gpuTimingEnd()}renderLayer(t,s,h,g){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="sky"||h.type==="custom"||h.type==="model"||h.type==="raster"||h.type==="raster-particle"||g&&g.length)&&(this.id=h.id,this.gpuTimingStart(h),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(h.type)&&(!t.terrain||h.type!=="custom")||h.type==="clip"||xi[h.type](t,s,h,g,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery,h=this.context.gl;let g=this.gpuTimers[t.id];g||(g=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:h.createQuery()}),g.calls++,h.beginQuery(s.TIME_ELAPSED_EXT,g.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,s=this.context.gl,h=s.createQuery();this.deferredRenderGpuTimeQueries.push(h),s.beginQuery(t.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const s={};for(const h in t){const g=t[h],v=this.context.extTimerQuery,b=v.getQueryParameter(g.query,this.context.gl.QUERY_RESULT)/1e6;v.deleteQueryEXT(g.query),s[h]=b}return s}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const s=this.context.gl;let h=0;for(const g of t)h+=s.getQueryParameter(g,s.QUERY_RESULT)/1e6,s.deleteQuery(g);return h}translatePosMatrix(t,s,h,g,v){if(!h[0]&&!h[1])return t;const b=v?g==="map"?this.transform.angle:0:g==="viewport"?-this.transform.angle:0;if(b){const z=Math.sin(b),L=Math.cos(b);h=[h[0]*L-h[1]*z,h[0]*z+h[1]*L]}const E=[v?h[0]:r.aw(s,h[0],this.transform.zoom),v?h[1]:r.aw(s,h[1],this.transform.zoom),0],I=new Float32Array(16);return r.bo(I,t,E),I}saveTileTexture(t){const s=t.size[0],h=this._tileTextures[s];h?h.push(t):this._tileTextures[s]=[t]}getTileTexture(t){const s=this._tileTextures[t];return s&&s.length>0?s.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(t,s,h){const g=h===void 0?this.terrain&&this.terrain.renderingToTexture:h,v=[];return this.style&&this.style.enable3dLights()&&(t==="globeRaster"||t==="terrainRaster"?(v.push("LIGHTING_3D_MODE"),v.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):g||v.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||v.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(v.push("TERRAIN"),this.linearFloatFilteringSupported()&&v.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&v.push("GLOBE"),!this._fogVisible||g||s!==void 0&&!s||v.push("FOG","FOG_DITHERING"),g&&v.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&v.push("OVERDRAW_INSPECTOR"),v}getOrCreateProgram(t,s){this.cache=this.cache||{};const h=s&&s.defines||[],g=s&&s.config,v=this.currentGlobalDefines(t,s&&s.overrideFog,s&&s.overrideRtt).concat(h),b=eu.cacheKey(Vh[t],t,v,g);return this.cache[b]||(this.cache[b]=new eu(this.context,t,Vh[t],g,iu[t],v)),this.cache[b]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,s){if(this.style.enable3dLights()){const h=this.style.directionalLight,g=this.style.ambientLight;if(h&&g){const v=((b,E,I)=>{const z=b.properties.get("direction"),L=b.properties.get("color-use-theme")==="none",N=b.properties.get("color").toNonPremultipliedRenderColor(L?null:I.getLut(b.scope)).toArray01(),F=b.properties.get("intensity"),q=E.properties.get("color-use-theme")==="none",X=E.properties.get("color").toNonPremultipliedRenderColor(q?null:I.getLut(E.scope)).toArray01(),G=E.properties.get("intensity"),Y=[z.x,z.y,z.z],J=r.dw(X,G),re=r.dw(N,F);return{u_lighting_ambient_color:J,u_lighting_directional_dir:Y,u_lighting_directional_color:re,u_ground_radiance:Jc(Y,re,J)}})(h,g,this.style);s.setLightsUniformValues(t,v)}}}uploadCommonUniforms(t,s,h,g,v){if(this.uploadCommonLightUniforms(t,s),this.terrain&&this.terrain.renderingToTexture)return;const b=this.style.fog;if(b){const E=b.getOpacity(this.transform.pitch),I=((z,L,N,F,q,X,G,Y,J,re,pe,_e)=>{const Ae=z.transform,Ie=L.properties.get("color-use-theme")==="none",Te=L.properties.get("color").toNonPremultipliedRenderColor(Ie?null:z.style.getLut(L.scope)).toArray01();Te[3]=F;const ve=z.frameCounter/1e3%1,[Pe,Me]=L.properties.get("vertical-range");return{u_fog_matrix:N?Ae.calculateFogTileMatrix(N):_e||z.identityMat,u_fog_range:L.getFovAdjustedRange(Ae._fov),u_fog_color:Te,u_fog_horizon_blend:L.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Pe,Me),Me],u_fog_temporal_offset:ve,u_frustum_tl:q,u_frustum_tr:X,u_frustum_br:G,u_frustum_bl:Y,u_globe_pos:J,u_globe_radius:re,u_viewport:pe,u_globe_transition:r.ah(Ae.zoom),u_is_globe:+(Ae.projection.name==="globe")}})(this,b,h,E,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.q.devicePixelRatio,this.transform.height*r.q.devicePixelRatio],g);s.setFogUniformValues(t,I)}v&&s.setCutoffUniformValues(t,v.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,s=t.createTexture();return t.bindTexture(t.TEXTURE_2D,s),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),s}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,s=this._backgroundTiles={},h=this.transform.coveringTiles({tileSize:512});for(const g of h)s[g.key]=t[g.key]||new ec(g,512,this.transform.tileZoom,this,void 0,this.worldview);return s}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(t,s){return!(!t.is3D(!(!this.terrain||!this.terrain.enabled))||t.type!=="clip"&&(t.minzoom&&t.minzoom>this.transform.zoom||(this.style._clipLayerPresent||t.sourceLayer!=="building")&&(!s||s.type!=="batched-model")))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let s=this._cachedTileFogOpacities[t.key];return s||(this._cachedTileFogOpacities[t.key]=s=this.style.fog.getOpacityForTile(t)),s[0]>=rt||s[1]>=rt}setupDepthForOcclusion(t,s,h){const g=this.context,v=g.gl,b=!!h;var E;h||(h={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),g.activeTexture.set(v.TEXTURE3),t&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),h.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],h.u_depth_range_unpack=[2/((E=this.depthRangeFor3D)[1]-E[0]),-1-2*E[0]/(E[1]-E[0])],h.u_occluder_half_size=.5*this.occlusionParams.occluderSize,h.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),g.activeTexture.set(v.TEXTURE0),b||s.setTerrainUniformValues(g,h)}}function Rl(u,t){let s=!1,h=null;const g=()=>{h=null,s&&(u(),h=setTimeout(g,t),s=!1)};return()=>(s=!0,h||g(),h)}class $p{constructor(t){this._hashName=t&&encodeURIComponent(t),r.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Rl(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const s=np(t);if(this._hashName){const h=this._hashName;let g=!1;const v=location.hash.slice(1).split("&").map(b=>{const E=b.split("=")[0];return E===h?(g=!0,`${E}=${s}`):b}).filter(b=>b);return g||v.push(`${h}=${s}`),`#${v.join("&")}`}return`#${s}`}_getCurrentHash(){const t=location.hash.replace("#","");if(this._hashName){let s;return t.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(s=h)}),(s&&s[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const s=this._getCurrentHash();if(s.length>=3&&!s.some(h=>isNaN(Number(h)))){const h=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(s[3]||0):t.getBearing();return t.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:h,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function np(u,t){const s=u.getCenter(),h=Math.round(100*u.getZoom())/100,g=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,g),b=Math.round(s.lng*v)/v,E=Math.round(s.lat*v)/v,I=u.getBearing(),z=u.getPitch();let L=t?`/${b}/${E}/${h}`:`${h}/${E}/${b}`;return(I||z)&&(L+="/"+Math.round(10*I)/10),z&&(L+=`/${Math.round(z)}`),L}const lu={linearity:.3,easing:r.ew(0,0,.3,1)},ip=r.h({deceleration:2500,maxSpeed:1400},lu),La=r.h({deceleration:20,maxSpeed:1400},lu),Da=r.h({deceleration:1e3,maxSpeed:360},lu),id=r.h({deceleration:1e3,maxSpeed:90},lu);class rp{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.q.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,s=r.q.now();for(;t.length>0&&s-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const s={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)s.zoom+=v.zoomDelta||0,s.bearing+=v.bearingDelta||0,s.pitch+=v.pitchDelta||0,v.panDelta&&s.pan._add(v.panDelta),v.around&&(s.around=v.around),v.pinchAround&&(s.pinchAround=v.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(s.pan.mag()){const v=_o(s.pan.mag(),h,r.h({},ip,t||{}));g.offset=s.pan.mult(v.amount/s.pan.mag()),g.center=this._map.transform.center,oh(g,v)}if(s.zoom){const v=_o(s.zoom,h,La);g.zoom=this._map.transform.zoom+v.amount,oh(g,v)}if(s.bearing){const v=_o(s.bearing,h,Da);g.bearing=this._map.transform.bearing+r.ay(v.amount,-179,179),oh(g,v)}if(s.pitch){const v=_o(s.pitch,h,id);g.pitch=this._map.transform.pitch+v.amount,oh(g,v)}if(g.zoom||g.bearing){const v=s.pinchAround===void 0?s.around:s.pinchAround;g.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),g.noMoveStart=!0,g}}function oh(u,t){(!u.duration||u.duration<t.duration)&&(u.duration=t.duration,u.easing=t.easing)}function _o(u,t,s){const{maxSpeed:h,linearity:g,deceleration:v}=s,b=r.ay(u*g/(t/1e3),-h,h),E=Math.abs(b)/(v*g);return{easing:s.easing,duration:1e3*E,amount:b*(E/2)}}class bs extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,h,g={}){const v=qe(s.getCanvasContainer(),h),b=s.unproject(v);super(t,r.h({point:v,lngLat:b,originalEvent:h},g)),this._defaultPrevented=!1,this.target=s}}class zl extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,h){const g=t==="touchend"?h.changedTouches:h.touches,v=$e(s.getCanvasContainer(),g),b=v.map(I=>s.unproject(I)),E=v.reduce((I,z,L,N)=>I.add(z.div(N.length)),new r.P(0,0));super(t,{points:v,point:E,lngLats:b,lngLat:s.unproject(E),originalEvent:h}),this._defaultPrevented=!1}}class Ll extends r.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s){super("wheel",{originalEvent:s}),this._defaultPrevented=!1}}class sp{constructor(t,s){this._map=t,this._clickTolerance=s.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new Ll(this._map,t))}mousedown(t,s){return this._mousedownPos=s,this._firePreventable(new bs(t.type,this._map,t))}mouseup(t){this._map.fire(new bs(t.type,this._map,t))}preclick(t){const s=r.h({},t);s.type="preclick",this._map.fire(new bs(s.type,this._map,s))}click(t,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||(this.preclick(t),this._map.fire(new bs(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new bs(t.type,this._map,t))}mouseover(t){this._map.fire(new bs(t.type,this._map,t))}mouseout(t){this._map.fire(new bs(t.type,this._map,t))}touchstart(t){return this._firePreventable(new zl(t.type,this._map,t))}touchmove(t){this._map.fire(new zl(t.type,this._map,t))}touchend(t){this._map.fire(new zl(t.type,this._map,t))}touchcancel(t){this._map.fire(new zl(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class rd{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new bs(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new bs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new bs(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sd{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,s){this.isEnabled()&&t.shiftKey&&t.button===0&&(Le(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(t,s){if(!this._active)return;const h=s,g=this._startPos,v=this._lastPos;if(!g||!v||v.equals(h)||!this._box&&h.dist(g)<this._clickTolerance)return;this._lastPos=h,this._box||(this._box=ne("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const b=Math.min(g.x,h.x),E=Math.max(g.x,h.x),I=Math.min(g.y,h.y),z=Math.max(g.y,h.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${b}px,${I}px)`,this._box.style.width=E-b+"px",this._box.style.height=z-I+"px")})}mouseupWindow(t,s){if(!this._active)return;const h=this._startPos,g=s;if(h&&t.button===0){if(this.reset(),Ee(),h.x!==g.x||h.y!==g.y)return this._map.fire(new r.A("boxzoomend",{originalEvent:t})),{cameraAnimation:v=>v.fitScreenCoordinates(h,g,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),De(),delete this._startPos,delete this._lastPos}_fireEvent(t,s){return this._map.fire(new r.A(t,{originalEvent:s}))}}function cl(u,t){const s={};for(let h=0;h<u.length;h++)s[u[h].identifier]=t[h];return s}class ws{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,s,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),h.length===this.numTouches&&(this.centroid=function(g){const v=new r.P(0,0);for(const b of g)v._add(b);return v.div(g.length)}(s),this.touches=cl(h,s)))}touchmove(t,s,h){if(this.aborted||!this.centroid)return;const g=cl(h,s);for(const v in this.touches){const b=g[v];(!b||b.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(t,s,h){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class cu{constructor(t){this.singleTap=new ws(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,s,h){this.singleTap.touchstart(t,s,h)}touchmove(t,s,h){this.singleTap.touchmove(t,s,h)}touchend(t,s,h){const g=this.singleTap.touchend(t,s,h);if(g){const v=t.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(g)<30;if(v&&b||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Gp{constructor(){this._zoomIn=new cu({numTouches:1,numTaps:2}),this._zoomOut=new cu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,s,h){this._zoomIn.touchstart(t,s,h),this._zoomOut.touchstart(t,s,h)}touchmove(t,s,h){this._zoomIn.touchmove(t,s,h),this._zoomOut.touchmove(t,s,h)}touchend(t,s,h){const g=this._zoomIn.touchend(t,s,h),v=this._zoomOut.touchend(t,s,h);return g?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:b.getZoom()+1,around:b.unproject(g)},{originalEvent:t})}):v?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:b.getZoom()-1,around:b.unproject(v)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const op={0:1,2:2},Dl={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class ah{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,s){return!1}_move(t,s){return{}}mousedown(t,s){if(this._lastPoint)return;const h=Ge(t);this._correctButton(t,h)&&(this._lastPoint=s,this._eventButton=h)}mousemoveWindow(t,s){const h=this._lastPoint;if(h){if(t.preventDefault(),this._eventButton!=null&&function(g,v){const b=op[v];return g.buttons===void 0||(g.buttons&b)!==b}(t,this._eventButton))this.reset();else if(this._moved||!(s.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(h,s)}}mouseupWindow(t){this._lastPoint&&Ge(t)===this._eventButton&&(this._moved&&Ee(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ap extends ah{mousedown(t,s){super.mousedown(t,s),this._lastPoint&&(this._active=!0)}_correctButton(t,s){return s===0&&!t.ctrlKey}_move(t,s){return{around:s,panDelta:s.sub(t)}}}class od extends ah{constructor(t){super(t),this._pitchRotateKey=t.pitchRotateKey?Dl[t.pitchRotateKey]:void 0}_correctButton(t,s){return this._pitchRotateKey?s===0&&t[this._pitchRotateKey]:s===0&&t.ctrlKey||s===2}_move(t,s){const h=.8*(s.x-t.x);if(h)return this._active=!0,{bearingDelta:h}}contextmenu(t){this._pitchRotateKey||t.preventDefault()}}class uu extends ah{constructor(t){super(t),this._pitchRotateKey=t.pitchRotateKey?Dl[t.pitchRotateKey]:void 0}_correctButton(t,s){return this._pitchRotateKey?s===0&&t[this._pitchRotateKey]:s===0&&t.ctrlKey||s===2}_move(t,s){const h=-.5*(s.y-t.y);if(h)return this._active=!0,{pitchDelta:h}}contextmenu(t){this._pitchRotateKey||t.preventDefault()}}class yo{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset(),r.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}touchstart(t,s,h){return this._calculateTransform(t,s,h)}touchmove(t,s,h){if(this._active&&!(h.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(h.length===1&&!r.ex())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,s,h)}}touchend(t,s,h){this._calculateTransform(t,s,h),this._active&&h.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,s,h){h.length>0&&(this._active=!0);const g=cl(h,s),v=new r.P(0,0),b=new r.P(0,0);let E=0;for(const z in g){const L=g[z],N=this._touches[z];N&&(v._add(L),b._add(L.sub(N)),E++,g[z]=L)}if(this._touches=g,E<this._minTouches||!b.mag())return;const I=b.div(E);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(E),panDelta:I}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ne("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Vs{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,s,h){return{}}touchstart(t,s,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([s[0],s[1]]))}touchmove(t,s,h){const g=this._firstTwoTouches;if(!g)return;t.preventDefault();const[v,b]=g,E=hu(h,s,v),I=hu(h,s,b);if(!E||!I)return;const z=this._aroundCenter?null:E.add(I).div(2);return this._move([E,I],z,t)}touchend(t,s,h){if(!this._firstTwoTouches)return;const[g,v]=this._firstTwoTouches,b=hu(h,s,g),E=hu(h,s,v);b&&E||(this._active&&Ee(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function hu(u,t,s){for(let h=0;h<u.length;h++)if(u[h].identifier===s)return t[h]}function lh(u,t){return Math.log(u/t)/Math.LN2}class lp extends Vs{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,s){const h=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(lh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:lh(this._distance,h),pinchAround:s}}}function ad(u,t){return 180*u.angleWith(t)/Math.PI}class Wp extends Vs{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,s){const h=this._vector;if(this._vector=t[0].sub(t[1]),h&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ad(this._vector,h),pinchAround:s}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const s=25/(Math.PI*this._minDiameter)*360,h=this._startVector;if(!h)return!1;const g=ad(t,h);return Math.abs(g)<s}}function ch(u){return Math.abs(u.y)>Math.abs(u.x)}class Zp extends Vs{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,ch(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,s,h){const g=this._lastPoints;if(!g)return;const v=t[0].sub(g[0]),b=t[1].sub(g[1]);return this._map._cooperativeGestures&&!r.ex()&&h.touches.length<3||(this._valid=this.gestureBeginsVertically(v,b,h.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(v.y+b.y)/2*-.5})}gestureBeginsVertically(t,s,h){if(this._valid!==void 0)return this._valid;const g=t.mag()>=2,v=s.mag()>=2;if(!g&&!v)return;if(!g||!v)return this._firstMove==null&&(this._firstMove=h),h-this._firstMove<100&&void 0;const b=t.y>0==s.y>0;return ch(t)&&ch(s)&&b}}const cp={panStep:100,bearingStep:15,pitchStep:10};class Kp{constructor(){const t=cp;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let s=0,h=0,g=0,v=0,b=0;switch(t.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:t.shiftKey?h=-1:(t.preventDefault(),v=-1);break;case 39:t.shiftKey?h=1:(t.preventDefault(),v=1);break;case 38:t.shiftKey?g=1:(t.preventDefault(),b=-1);break;case 40:t.shiftKey?g=-1:(t.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(h=0,g=0),{cameraAnimation:E=>{const I=E.getZoom();E.easeTo({duration:300,easeId:"keyboardHandler",easing:Xp,zoom:s?Math.round(I)+s*(t.shiftKey?2:1):I,bearing:E.getBearing()+h*this._bearingStep,pitch:E.getPitch()+g*this._pitchStep,offset:[-v*this._panStep,-b*this._panStep],center:E.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Xp(u){return u*(2-u)}const ld=4.000244140625,up=1/450;class Yp{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._handler=s,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=up,r.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||r.ex()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let s=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const h=r.q.now(),g=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,s!==0&&s%ld==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=s,this._timeout=window.setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(g*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),t.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=t,this._delta-=s,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=qe(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:s,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;this._type==="wheel"&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const s=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>ld?this._wheelZoomRate:this._defaultZoomRate;let L=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&L!==0&&(L=1/L);const N=s(),F=Math.pow(2,N),q=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):F;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(q*L))),this._type==="wheel"&&(this._startZoom=N,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:s(),g=this._startZoom,v=this._easing;let b,E=!1;if(this._type==="wheel"&&g&&v){const z=Math.min((r.q.now()-this._lastWheelEventTime)/200,1),L=v(z);b=r.ai(g,h,L),z<1?this._frameId||(this._frameId=!0):E=!0}else b=h,E=!0;this._active=!0,E&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let I=b-s();return I*this._lastDelta<0&&(I=0),{noInertia:!0,needsRenderFrame:!E,zoomDelta:I,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let s=r.ey;if(this._prevEase){const h=this._prevEase,g=(r.q.now()-h.start)/h.duration,v=h.easing(g+.01)-h.easing(g),b=.27/Math.sqrt(v*v+1e-4)*.01,E=Math.sqrt(.0729-b*b);s=r.ew(b,E,.25,1)}return this._prevEase={start:r.q.now(),duration:t,easing:s},s}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ne("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class hp{constructor(t,s){this._clickZoom=t,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class cd{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,s){return t.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:h.getZoom()+(t.shiftKey?-1:1),around:h.unproject(s)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hf{constructor(){this._tap=new cu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,s,h){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=s[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(t,s,h))}touchmove(t,s,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const g=s[0],v=g.y-this._swipePoint.y;return this._swipePoint=g,t.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(t,s,h)}touchend(t,s,h){this._tapTime?this._swipePoint&&h.length===0&&this.reset():this._tap.touchend(t,s,h)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qp{constructor(t,s,h){this._el=t,this._mousePan=s,this._touchPan=h}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Jp{constructor(t,s,h){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=s,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Uf{constructor(t,s,h,g){this._el=t,this._touchZoom=s,this._touchRotate=h,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const du=u=>u.zoom||u.drag||u.pitch||u.rotate;class Qi extends r.A{}class $f{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,s){const h=r.at([],s,t);this.radius=r.ae(h[2]<0?r.eA([],h,this.constants):[h[0],h[1],0])}projectRay(t){r.eA(t,t,this.constants),r.au(t,t),r.eB(t,t,this.constants);const s=r.bY([],t,this.radius);if(s[2]>0){const h=r.bY([],[0,0,1],r.bG(s,[0,0,1])),g=r.bY([],r.au([],[s[0],s[1],0]),this.radius),v=r.cV([],s,r.bY([],r.at([],r.cV([],g,h),s),2));s[0]=v[0],s[1]=v[1]}return s}}function ud(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}class hd{constructor(t,s){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rp(t),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new $f,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(s),r.aV(["handleEvent","handleWindowEvent"],this);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,v,b]of this._listeners){const E=g===document?this.handleWindowEvent:this.handleEvent;g.addEventListener(v,E,b)}}destroy(){for(const[t,s,h]of this._listeners){const g=t===document?this.handleWindowEvent:this.handleEvent;t.removeEventListener(s,g,h)}}_addDefaultHandlers(t){const s=this._map,h=s.getCanvasContainer();this._add("mapEvent",new sp(s,t));const g=s.boxZoom=new sd(s,t);this._add("boxZoom",g);const v=new Gp,b=new cd;s.doubleClickZoom=new hp(b,v),this._add("tapZoom",v),this._add("clickZoom",b);const E=new Hf;this._add("tapDragZoom",E);const I=s.touchPitch=new Zp(s);this._add("touchPitch",I);const z=new od(t),L=new uu(t);s.dragRotate=new Jp(t,z,L),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);const N=new ap(t),F=new yo(s,t);s.dragPan=new Qp(h,N,F),this._add("mousePan",N),this._add("touchPan",F,["touchZoom","touchRotate"]);const q=new Wp,X=new lp;s.touchZoomRotate=new Uf(h,X,q,E),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",X,["touchPan","touchRotate"]),this._add("blockableMapEvent",new rd(s));const G=s.scrollZoom=new Yp(s,this);this._add("scrollZoom",G,["mousePan"]);const Y=s.keyboard=new Kp;this._add("keyboard",Y);for(const J of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[J]&&s[J].enable(t[J])}_add(t,s,h){this._handlers.push({handlerName:t,handler:s,allowed:h}),this._handlersById[t]=s}stop(t){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!du(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,s,h){for(const g in t)if(g!==h&&(!s||s.indexOf(g)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const s=[];for(const h of t)this._el.contains(h.target)&&s.push(h);return s}handleEvent(t,s){this._updatingCamera=!0;const h=t.type==="renderFrame",g=h?void 0:t,v={needsRenderFrame:!1},b={},E={},I=t.touches?this._getMapTouches(t.touches):void 0,z=I?$e(this._el,I):h?void 0:qe(this._el,t);for(const{handlerName:F,handler:q,allowed:X}of this._handlers){if(!q.isEnabled())continue;let G;this._blockedByActive(E,X,F)?q.reset():q[s||t.type]&&(G=q[s||t.type](t,z,I),this.mergeHandlerResult(v,b,G,F,g),G&&G.needsRenderFrame&&this._triggerRenderFrame()),(G||q.isActive())&&(E[F]=q)}const L={};for(const F in this._previousActiveHandlers)E[F]||(L[F]=g);this._previousActiveHandlers=E,(Object.keys(L).length||ud(v))&&(this._changes.push([v,b,L]),this._triggerRenderFrame()),(Object.keys(E).length||ud(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=v;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))}mergeHandlerResult(t,s,h,g,v){if(!h)return;r.h(t,h);const b={handlerName:g,originalEvent:h.originalEvent||v};h.zoomDelta!==void 0&&(s.zoom=b),h.panDelta!==void 0&&(s.drag=b),h.pitchDelta!==void 0&&(s.pitch=b),h.bearingDelta!==void 0&&(s.rotate=b)}_applyChanges(){const t={},s={},h={};for(const[g,v,b]of this._changes)g.panDelta&&(t.panDelta=(t.panDelta||new r.P(0,0))._add(g.panDelta)),g.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(t.around=g.around),g.aroundCoord!==void 0&&(t.aroundCoord=g.aroundCoord),g.pinchAround!==void 0&&(t.pinchAround=g.pinchAround),g.noInertia&&(t.noInertia=g.noInertia),r.h(s,v),r.h(h,b);this._updateMapTransform(t,s,h),this._changes=[]}_updateMapTransform(t,s,h){const g=this._map,v=g.transform,b=re=>[re.x,re.y,re.z];if((re=>{const pe=this._eventsInProgress.drag;return pe&&!this._handlersById[pe.handlerName].isActive()})()&&!ud(t)){const re=v.zoom;v.cameraElevationReference="sea",this._originalZoom!=null&&v._orthographicProjectionAtLowPitch&&v.projection.name!=="globe"&&v.pitch===0?(v.cameraElevationReference="ground",v.zoom=this._originalZoom):(v.recenterOnTerrain(),v.cameraElevationReference="ground"),re!==v.zoom&&this._map._update(!0)}if(v._isCameraConstrained&&g._stop(!0),!ud(t))return void this._fireEvents(s,h,!0);let{panDelta:E,zoomDelta:I,bearingDelta:z,pitchDelta:L,around:N,aroundCoord:F,pinchAround:q}=t;v._isCameraConstrained&&(I>0&&(I=0),v._isCameraConstrained=!1),q!==void 0&&(N=q),(I||(re=>s[re]&&!this._eventsInProgress[re])("drag"))&&N&&(this._dragOrigin=b(v.pointCoordinate3D(N)),this._originalZoom=v.zoom,this._trackingEllipsoid.setup(v._camera.position,this._dragOrigin)),v.cameraElevationReference="sea",g._stop(!0),N=N||g.transform.centerPoint,z&&(v.bearing+=z),L&&(v.pitch+=L),v._updateCameraState();const X=[0,0,0];if(E)if(v.projection.name==="mercator"){const re=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(N).dir),pe=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(N.sub(E)).dir);X[0]=pe[0]-re[0],X[1]=pe[1]-re[1]}else{const re=v.pointCoordinate(N);if(v.projection.name==="globe"){E=E.rotate(-v.angle);const pe=v._pixelsPerMercatorPixel/v.worldSize;X[0]=-E.x*r.ez(r.aY(re.y))*pe,X[1]=-E.y*r.ez(v.center.lat)*pe}else{const pe=v.pointCoordinate(N.sub(E));re&&pe&&(X[0]=pe.x-re.x,X[1]=pe.y-re.y)}}const G=v.zoom,Y=[0,0,0];if(I){const re=b(F||v.pointCoordinate3D(N)),pe={dir:r.au([],r.at([],re,v._camera.position))};if(pe.dir[2]<0){const _e=v.zoomDeltaToMovement(re,I);r.bY(Y,pe.dir,_e)}}const J=r.cV(X,X,Y);v._translateCameraConstrained(J),I&&Math.abs(v.zoom-G)>1e-4&&v.recenterOnTerrain(),v.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(s,h,!0)}_fireEvents(t,s,h){const g=du(this._eventsInProgress),v=du(t),b={};for(const L in t){const{originalEvent:N}=t[L];this._eventsInProgress[L]||(b[`${L}start`]=N),this._eventsInProgress[L]=t[L]}!g&&v&&this._fireEvent("movestart",v.originalEvent);for(const L in b)this._fireEvent(L,b[L]);v&&this._fireEvent("move",v.originalEvent);for(const L in t){const{originalEvent:N}=t[L];this._fireEvent(L,N)}const E={};let I;for(const L in this._eventsInProgress){const{handlerName:N,originalEvent:F}=this._eventsInProgress[L];this._handlersById[N].isActive()||(delete this._eventsInProgress[L],I=s[N]||F,E[`${L}end`]=I)}for(const L in E)this._fireEvent(L,E[L]);const z=du(this._eventsInProgress);if(h&&(g||v)&&!z){this._updatingCamera=!0;const L=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;L?(N(L.bearing||this._map.getBearing())&&(L.bearing=0),this._map.easeTo(L,{originalEvent:I})):(this._map.fire(new r.A("moveend",{originalEvent:I})),N(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,s){this._map.fire(new r.A(t,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new Qi("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ef="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class uh extends r.E{constructor(t,s){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=s.bearingSnap,this._respectPrefersReducedMotion=s.respectPrefersReducedMotion!==!1,r.aV(["_renderFrameCallback"],this)}getCenter(){return new r.cd(this.transform.center.lng,this.transform.center.lat)}setCenter(t,s){return this.jumpTo({center:t},s)}panBy(t,s,h){return t=r.P.convert(t).mult(-1),this.panTo(this.transform.center,r.h({offset:t},s),h)}panTo(t,s,h){return this.easeTo(r.h({center:t},s),h)}getZoom(){return this.transform.zoom}setZoom(t,s){return this.jumpTo({zoom:t},s),this}zoomTo(t,s,h){return this.easeTo(r.h({zoom:t},s),h)}zoomIn(t,s){return this.zoomTo(this.getZoom()+1,t,s),this}zoomOut(t,s){return this.zoomTo(this.getZoom()-1,t,s),this}getBearing(){return this.transform.bearing}setBearing(t,s){return this.jumpTo({bearing:t},s),this}getPadding(){return this.transform.padding}setPadding(t,s){return this.jumpTo({padding:t},s),this}rotateTo(t,s,h){return this.easeTo(r.h({bearing:t},s),h)}resetNorth(t,s){return this.rotateTo(0,r.h({duration:1e3},t),s),this}resetNorthPitch(t,s){return this.easeTo(r.h({bearing:0,pitch:0,duration:1e3},t),s),this}snapToNorth(t,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,s):this}getPitch(){return this.transform.pitch}setPitch(t,s){return this.jumpTo({pitch:t},s),this}cameraForBounds(t,s){t=r.aG.convert(t);const h=s&&s.bearing||0,g=s&&s.pitch||0,v=t.getNorthWest(),b=t.getSouthEast();return this._cameraForBounds(this.transform,v,b,h,g,s)}_extendPadding(t){const s={top:0,right:0,bottom:0,left:0};return t==null?r.h({},s,this.transform.padding):typeof t=="number"?{top:t,bottom:t,right:t,left:t}:r.h({},s,t)}_extendCameraOptions(t){return(t=r.h({offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=this._extendPadding(t.padding),t}_minimumAABBFrustumDistance(t,s){const h=s.max[0]-s.min[0],g=s.max[1]-s.min[1];return h/g>t.aspect?h/(2*Math.tan(.5*t.fovX)*t.aspect):g/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,s,h,g,v,b){const E=t.clone(),I=this._extendCameraOptions(b);E.bearing=g,E.pitch=v;const z=r.cd.convert(s),L=r.cd.convert(h),N=.5*(z.lat+L.lat),F=.5*(z.lng+L.lng),q=r.eC(N,F),X=r.au([],q),G=r.au([],r.bF([],X,[0,1,0])),Y=r.bF([],G,X),J=[G[0],G[1],G[2],0,Y[0],Y[1],Y[2],0,X[0],X[1],X[2],0,0,0,0,1],re=[q,r.eC(z.lat,z.lng),r.eC(L.lat,z.lng),r.eC(L.lat,L.lng),r.eC(z.lat,L.lng),r.eC(N,z.lng),r.eC(N,L.lng),r.eC(z.lat,F),r.eC(L.lat,F)];let pe=r.cW.fromPoints(re.map(nt=>[r.bG(G,nt),r.bG(Y,nt),r.bG(X,nt)]));const _e=r.ad([],pe.center,J);r.eD(_e)===0&&r.eE(_e,0,0,1),r.au(_e,_e),r.bY(_e,_e,r.aB),E.center=r.eF(_e);const Ae=E.getWorldToCameraMatrix(),Ie=r.bi(new Float64Array(16),Ae);pe=r.cW.applyTransform(pe,r.az([],Ae,J));const Te=this._extendAABB(pe,E,I,g);if(!Te)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");pe=Te,r.ad(_e,_e,Ae);const ve=.5*(pe.max[2]-pe.min[2]),Pe=this._minimumAABBFrustumDistance(E,pe),Me=r.bY([],[0,0,1],ve),We=r.cV(Me,_e,Me),Qe=Pe+(E.pitch===0?0:r.bD(_e,We)),ft=E.globeCenterInViewSpace,pt=r.at([],_e,[ft[0],ft[1],ft[2]]);r.au(pt,pt),r.bY(pt,pt,Qe);const Et=r.cV([],_e,pt);r.ad(Et,Et,Ie);const Ke=r.eq/r.aB,st=r.ae(Et),Ve=r.c6(Math.max(st*Ke-r.eq,Number.EPSILON),0),_t=Math.min(E.zoomFromMercatorZAdjusted(Ve),I.maxZoom);return _t>.5*(r.cL+r.cx)?(E.setProjection({name:"mercator"}),E.zoom=_t,this._cameraForBounds(E,s,h,g,v,b)):{center:E.center,zoom:_t,bearing:g,pitch:v}}_extendAABB(t,s,h,g){const v=.5*((h.padding.left||0)+(h.padding.right||0)),b=.5*((h.padding.top||0)+(h.padding.bottom||0)),E=b,I=v,z=v,L=b,N=s.width-(I+z),F=s.height-(E+L),q=r.at([],t.max,t.min),X=Math.min(N/q[0],F/q[1]),G=Math.min(s.scaleZoom(s.scale*X),h.maxZoom);if(isNaN(G))return null;const Y=s.scale/s.zoomScale(G),J=new r.cW([t.min[0]-I*Y,t.min[1]-L*Y,t.min[2]],[t.max[0]+z*Y,t.max[1]+E*Y,t.max[2]]),re=(typeof h.offset.x=="number"&&typeof h.offset.y=="number"?new r.P(h.offset.x,h.offset.y):r.P.convert(h.offset)).rotate(-r.al(g));return J.center[0]-=re.x*Y,J.center[1]+=re.y*Y,J}queryTerrainElevation(t,s){const h=this.transform.elevation;return h?(s=r.h({},{exaggerated:!0},s),h.getAtPoint(r.ac.fromLngLat(t),null,s.exaggerated)):null}_cameraForBounds(t,s,h,g,v,b){if(t.projection.name==="globe")return this._cameraForBoundsOnGlobe(t,s,h,g,v,b);const E=t.clone(),I=this._extendCameraOptions(b);E.bearing=g,E.pitch=v;const z=r.cd.convert(s),L=r.cd.convert(h),N=new r.cd(z.lng,L.lat),F=new r.cd(L.lng,z.lat),q=E.project(z),X=E.project(L),G=this.queryTerrainElevation(z),Y=this.queryTerrainElevation(L),J=this.queryTerrainElevation(N),re=this.queryTerrainElevation(F),pe=[[q.x,q.y,Math.min(G||0,Y||0,J||0,re||0)],[X.x,X.y,Math.max(G||0,Y||0,J||0,re||0)]];let _e=r.cW.fromPoints(pe);const Ae=E.getWorldToCameraMatrix(),Ie=r.bi(new Float64Array(16),Ae);_e=r.cW.applyTransform(_e,Ae);const Te=this._extendAABB(_e,E,I,g);if(!Te)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");_e=Te;const ve=.5*r.at([],_e.max,_e.min)[2],Pe=this._minimumAABBFrustumDistance(E,_e),Me=[0,0,1,0];r.aA(Me,Me,Ae),r.eG(Me,Me);const We=r.bY([],Me,Pe+ve),Qe=r.cV([],_e.center,We);r.ad(_e.center,_e.center,Ie),r.ad(Qe,Qe,Ie);const ft=E.unproject(new r.P(_e.center[0],_e.center[1])),pt=r.eH(E.projection,ft),Et=Math.pow(2,pt),Ke=Math.min(E._zoomFromMercatorZ(Qe[2]*E.pixelsPerMeter*Et/E.worldSize),I.maxZoom);return E.mercatorFromTransition&&Ke<.5*(r.cL+r.cx)?(E.setProjection({name:"globe"}),E.zoom=Ke,this._cameraForBounds(E,s,h,g,v,b)):{center:ft,zoom:Ke,bearing:g,pitch:v}}fitBounds(t,s,h){const g=this.cameraForBounds(t,s);return this._fitInternal(g,s,h)}fitScreenCoordinates(t,s,h,g,v){const b=r.P.convert(t),E=r.P.convert(s),I=new r.P(Math.min(b.x,E.x),Math.min(b.y,E.y)),z=new r.P(Math.max(b.x,E.x),Math.max(b.y,E.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(b,E))return this;const L=this.transform.pointLocation3D(I),N=this.transform.pointLocation3D(z),F=this.transform.pointLocation3D(new r.P(I.x,z.y)),q=this.transform.pointLocation3D(new r.P(z.x,I.y)),X=[Math.min(L.lng,N.lng,F.lng,q.lng),Math.min(L.lat,N.lat,F.lat,q.lat)],G=[Math.max(L.lng,N.lng,F.lng,q.lng),Math.max(L.lat,N.lat,F.lat,q.lat)],Y=g&&g.pitch?g.pitch:this.getPitch(),J=this._cameraForBounds(this.transform,X,G,h,Y,g);return this._fitInternal(J,g,v)}_fitInternal(t,s,h){return t?(s=r.h(t,s)).linear?this.easeTo(s,h):this.flyTo(s,h):this}jumpTo(t,s){this.stop();const h=t.preloadOnly?this.transform.clone():this.transform;let g=!1,v=!1,b=!1;"zoom"in t&&h.zoom!==+t.zoom&&(g=!0,h.zoom=+t.zoom),t.center!==void 0&&(h.center=r.cd.convert(t.center)),"bearing"in t&&h.bearing!==+t.bearing&&(v=!0,h.bearing=+t.bearing),"pitch"in t&&h.pitch!==+t.pitch&&(b=!0,h.pitch=+t.pitch);const E=typeof t.padding=="number"?this._extendPadding(t.padding):t.padding;if(t.padding!=null&&!h.isPaddingEqual(E))if(t.retainPadding===!1){const I=h.clone();I.padding=E,h.setLocationAtPoint(h.center,I.centerPoint)}else h.padding=E;return t.preloadOnly?(this._preloadTiles(h),this):(this.fire(new r.A("movestart",s)).fire(new r.A("move",s)),g&&this.fire(new r.A("zoomstart",s)).fire(new r.A("zoom",s)).fire(new r.A("zoomend",s)),v&&this.fire(new r.A("rotatestart",s)).fire(new r.A("rotate",s)).fire(new r.A("rotateend",s)),b&&this.fire(new r.A("pitchstart",s)).fire(new r.A("pitch",s)).fire(new r.A("pitchend",s)),this.fire(new r.A("moveend",s)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.w(ef),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,s){const h=this.transform;if(!h.projection.supportsFreeCamera)return r.w(ef),this;this.stop();const g=h.zoom,v=h.pitch,b=h.bearing;h.setFreeCameraOptions(t);const E=g!==h.zoom,I=v!==h.pitch,z=b!==h.bearing;return this.fire(new r.A("movestart",s)).fire(new r.A("move",s)),E&&this.fire(new r.A("zoomstart",s)).fire(new r.A("zoom",s)).fire(new r.A("zoomend",s)),z&&this.fire(new r.A("rotatestart",s)).fire(new r.A("rotate",s)).fire(new r.A("rotateend",s)),I&&this.fire(new r.A("pitchstart",s)).fire(new r.A("pitch",s)).fire(new r.A("pitchend",s)),this.fire(new r.A("moveend",s)),this}easeTo(t,s){this._stop(!1,t.easeId),((t=r.h({offset:[0,0],duration:500,easing:r.ey},t)).animate===!1||this._prefersReducedMotion(t))&&(t.duration=0);const h=this.transform,g=this.getZoom(),v=this.getBearing(),b=this.getPitch(),E=this.getPadding(),I="zoom"in t?+t.zoom:g,z="bearing"in t?this._normalizeBearing(t.bearing,v):v,L="pitch"in t?+t.pitch:b,N=this._extendPadding(t.padding),F=r.P.convert(t.offset);let q,X,G;if(h.projection.name==="globe"){const Me=r.ac.fromLngLat(h.center),We=F.rotate(-h.angle);Me.x+=We.x/h.worldSize,Me.y+=We.y/h.worldSize;const Qe=Me.toLngLat(),ft=r.cd.convert(t.center||Qe);this._normalizeCenter(ft),q=h.centerPoint.add(We),X=new r.P(Me.x,Me.y).mult(h.worldSize),G=new r.P(r.aD(ft.lng),r.aH(ft.lat)).mult(h.worldSize).sub(X)}else{q=h.centerPoint.add(F);const Me=h.pointLocation(q),We=r.cd.convert(t.center||Me);this._normalizeCenter(We),X=h.project(Me),G=h.project(We).sub(X)}const Y=h.zoomScale(I-g);let J,re;t.around&&(J=r.cd.convert(t.around),re=h.locationPoint(J));const pe=this._zooming||I!==g,_e=this._rotating||v!==z,Ae=this._pitching||L!==b,Ie=!h.isPaddingEqual(N),Te=t.retainPadding===!1?h.clone():h,ve=Me=>We=>{if(pe&&(Me.zoom=r.ai(g,I,We)),_e&&(Me.bearing=r.ai(v,z,We)),Ae&&(Me.pitch=r.ai(b,L,We)),Ie&&(Te.interpolatePadding(E,N,We),q=Te.centerPoint.add(F)),J)Me.setLocationAtPoint(J,re);else{const Qe=Me.zoomScale(Me.zoom-g),ft=I>g?Math.min(2,Y):Math.max(.5,Y),pt=Math.pow(ft,1-We),Et=Me.unproject(X.add(G.mult(We*pt)).mult(Qe));Me.setLocationAtPoint(Me.renderWorldCopies?Et.wrap():Et,q)}return t.preloadOnly||this._fireMoveEvents(s),Me};if(t.preloadOnly){const Me=this._emulate(ve,t.duration,h);return this._preloadTiles(Me),this}const Pe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=pe,this._rotating=_e,this._pitching=Ae,this._padding=Ie,this._easeId=t.easeId,this._prepareEase(s,t.noMoveStart,Pe),this._ease(ve(h),Me=>{h.cameraElevationReference==="sea"&&h.recenterOnTerrain(),this._afterEase(s,Me)},t),this}_prepareEase(t,s,h={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),s||h.moving||this.fire(new r.A("movestart",t)),this._zooming&&!h.zooming&&this.fire(new r.A("zoomstart",t)),this._rotating&&!h.rotating&&this.fire(new r.A("rotatestart",t)),this._pitching&&!h.pitching&&this.fire(new r.A("pitchstart",t))}_fireMoveEvents(t){this.fire(new r.A("move",t)),this._zooming&&this.fire(new r.A("zoom",t)),this._rotating&&this.fire(new r.A("rotate",t)),this._pitching&&this.fire(new r.A("pitch",t))}_afterEase(t,s){if(this._easeId&&s&&this._easeId===s)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const h=this._zooming,g=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new r.A("zoomend",t)),g&&this.fire(new r.A("rotateend",t)),v&&this.fire(new r.A("pitchend",t)),this.fire(new r.A("moveend",t))}flyTo(t,s){if(this._prefersReducedMotion(t)){const nt=r.aF(t,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(nt,s)}this.stop(),t=r.h({offset:[0,0],speed:1.2,curve:1.42,easing:r.ey},t);const h=this.transform,g=this.getZoom(),v=this.getBearing(),b=this.getPitch(),E=this.getPadding(),I="zoom"in t?r.ay(+t.zoom,h.minZoom,h.maxZoom):g,z="bearing"in t?this._normalizeBearing(t.bearing,v):v,L="pitch"in t?+t.pitch:b,N=this._extendPadding(t.padding),F=h.zoomScale(I-g),q=r.P.convert(t.offset);let X=h.centerPoint.add(q);const G=h.pointLocation(X),Y=r.cd.convert(t.center||G);this._normalizeCenter(Y);const J=h.project(G),re=h.project(Y).sub(J);let pe=t.curve;const _e=Math.max(h.width,h.height),Ae=_e/F,Ie=re.mag();if("minZoom"in t){const nt=r.ay(Math.min(t.minZoom,g,I),h.minZoom,h.maxZoom),Tt=_e/h.zoomScale(nt-g);pe=Math.sqrt(Tt/Ie*2)}const Te=pe*pe;function ve(nt){const Tt=(Ae*Ae-_e*_e+(nt?-1:1)*Te*Te*Ie*Ie)/(2*(nt?Ae:_e)*Te*Ie);return Math.log(Math.sqrt(Tt*Tt+1)-Tt)}function Pe(nt){return(Math.exp(nt)-Math.exp(-nt))/2}function Me(nt){return(Math.exp(nt)+Math.exp(-nt))/2}const We=ve(0);let Qe=function(nt){return Me(We)/Me(We+pe*nt)},ft=function(nt){return _e*((Me(We)*(Pe(Tt=We+pe*nt)/Me(Tt))-Pe(We))/Te)/Ie;var Tt},pt=(ve(1)-We)/pe;if(Math.abs(Ie)<1e-6||!isFinite(pt)){if(Math.abs(_e-Ae)<1e-6)return this.easeTo(t,s);const nt=Ae<_e?-1:1;pt=Math.abs(Math.log(Ae/_e))/pe,ft=function(){return 0},Qe=function(Tt){return Math.exp(nt*pe*Tt)}}t.duration="duration"in t?+t.duration:1e3*pt/("screenSpeed"in t?+t.screenSpeed/pe:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const Et=v!==z,Ke=L!==b,st=!h.isPaddingEqual(N),Ve=t.retainPadding===!1?h.clone():h,_t=nt=>Tt=>{const jt=Tt*pt,yt=1/Qe(jt);nt.zoom=Tt===1?I:g+nt.scaleZoom(yt),Et&&(nt.bearing=r.ai(v,z,Tt)),Ke&&(nt.pitch=r.ai(b,L,Tt)),st&&(Ve.interpolatePadding(E,N,Tt),X=Ve.centerPoint.add(q));const Lt=Tt===1?Y:nt.unproject(J.add(re.mult(ft(jt))).mult(yt));return nt.setLocationAtPoint(nt.renderWorldCopies?Lt.wrap():Lt,X),nt._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(s),nt};if(t.preloadOnly){const nt=this._emulate(_t,t.duration,h);return this._preloadTiles(nt),this}return this._zooming=!0,this._rotating=Et,this._pitching=Ke,this._padding=st,this._prepareEase(s,!1),this._ease(_t(h),()=>this._afterEase(s),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(t){}_cancelRenderFrame(t){}_stop(t,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const h=this._onEaseEnd;this._onEaseEnd=void 0,h.call(this,s)}if(!t){const h=this.handlers;h&&h.stop(!1)}return this}_ease(t,s,h){h.animate===!1||h.duration===0?(t(1),s()):(this._easeStart=r.q.now(),this._easeOptions=h,this._onEaseFrame=t,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((r.q.now()-this._easeStart)/this._easeOptions.duration,1),s=this._onEaseFrame;s&&s(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,s){t=r.bX(t,-180,180);const h=Math.abs(t-s);return Math.abs(t-360-s)<h&&(t-=360),Math.abs(t+360-s)<h&&(t+=360),t}_normalizeCenter(t){const s=this.transform;if(s.maxBounds||s.projection.name!=="globe"&&!s.renderWorldCopies)return;const h=t.lng-s.center.lng;t.lng+=h>180?-360:h<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&r.q.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,s,h){const g=Math.ceil(15*s/1e3),v=[],b=t(h.clone());for(let E=0;E<=g;E++){const I=b(E/g);v.push(I.clone())}return v}_preloadTiles(t,s){}}class pu{constructor(t={}){this.options=t,r.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const s=this.options&&this.options.compact,h=t._getUIString("AttributionControl.ToggleAttribution");this._map=t,this._container=ne("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ne("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",h);const g=ne("span","mapboxgl-ctrl-icon",this._compactButton);return g.setAttribute("aria-hidden","true"),g.setAttribute("title",h),this._innerContainer=ne("div","mapboxgl-ctrl-attrib-inner",this._container),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.e.ACCESS_TOKEN}];if(t){const h=s.reduce((g,v,b)=>(v.value&&(g+=`${v.key}=${v.value}${b<s.length-1?"&":""}`),g),"?");t.href=`${r.e.FEEDBACK_URL}/${h}#${np(this._map,!0)}`,t.rel="noopener nofollow"}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const s=this._map.style._mergedSourceCaches;for(const g in s){const v=s[g];if(v.used){const b=v.getSource();b.attribution&&t.indexOf(b.attribution)<0&&t.push(b.attribution)}}t.sort((g,v)=>g.length-v.length),t=t.filter((g,v)=>{for(let b=v+1;b<t.length;b++)if(t[b].indexOf(g)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const h=t.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,t.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class qs{constructor(){r.aV(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=ne("div","mapboxgl-ctrl");const s=ne("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const s in t){const h=t[s].getSource();if(h.hasOwnProperty("mapbox_logo")&&!h.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const s=t[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}}}class dd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const s=++this._id;return this._queue.push({callback:t,id:s,cancelled:!1}),s}remove(t){const s=this._currentlyRunning,h=s?this._queue.concat(s):this._queue;for(const g of h)if(g.id===t)return void(g.cancelled=!0)}run(t=0){const s=this._currentlyRunning=this._queue;this._queue=[];for(const h of s)if(!h.cancelled&&(h.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Ol{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const s=r.dk((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-s)+this._end*s}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,s,h){this._start=this.getValue(s),this._end=t,this._startTime=s,this._endTime=s+h}}const fu={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Ui extends r.A{constructor(t,s,h,g){const{point:v,lngLat:b,originalEvent:E,target:I}=t;super(t.type,{point:v,lngLat:b,originalEvent:E,target:I}),this.preventDefault=()=>{t.preventDefault()},this.id=s,this.interaction=h,this.feature=g}}class ul{constructor(t){this.map=t,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(t,s){if(this.typeById.has(t))throw new Error(`Interaction id "${t}" already exists.`);const h=s.filter;let g=s.type;h&&this.filters.set(t,r.b3(h)),g==="mouseover"&&(g="mouseenter"),g==="mouseout"&&(g="mouseleave");const v=this.interactionsByType.get(g)||new Map;g==="mouseenter"||g==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(t,s)):v.size===0&&this.map.on(g,this.handleType),v.size===0&&this.interactionsByType.set(g,v),v.set(t,s),this.typeById.set(t,g)}get(t){const s=this.typeById.get(t);if(!s)return;const h=this.interactionsByType.get(s);return h?h.get(t):void 0}remove(t){const s=this.typeById.get(t);if(!s)return;this.typeById.delete(t),this.filters.delete(t);const h=this.interactionsByType.get(s);h&&(h.delete(t),s==="mouseenter"||s==="mouseleave"?(this.delegatedInteractions.delete(t),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):h.size===0&&this.map.off(s,this.handleType))}queryTargets(t,s){const h=[];for(const[g,v]of s)v.target&&h.push({targetId:g,target:v.target,filter:this.filters.get(g)});return this.map.style.queryRenderedTargets(t,h,this.map.transform)}handleMove(t){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const s=this.queryTargets(t.point,Array.from(this.delegatedInteractions).reverse());s.length&&(t.type="mouseenter",this.handleType(t,s));const h=new Map;for(const[g,{feature:v}]of this.prevHoveredFeatures)this.hoveredFeatures.has(g)||h.set(v.id,v);h.size&&(t.type="mouseleave",this.handleType(t,Array.from(h.values())))}handleOut(t){const s=Array.from(this.hoveredFeatures.values()).map(({feature:h})=>h);s.length&&(t.type="mouseleave",this.handleType(t,s)),this.hoveredFeatures.clear()}handleType(t,s){const h=t.type==="mouseenter";if(h&&!this.interactionsByType.has(t.type))return void r.w("mouseenter interaction required for mouseleave to work.");const g=Array.from(this.interactionsByType.get(t.type)).reverse(),v=!!s;s=s||this.queryTargets(t.point,g);let b=!1;const E=new Set;for(const I of s){for(const[z,L]of g){if(!L.target)continue;const N=I.variants?I.variants[z]:null;if(N){for(const F of N){if(Jl(F,I,E,z))continue;const q=new r.de(I,F),X=Ql(F,I,z);v&&(q.state=this.map.getFeatureState(q));const G=h?this.prevHoveredFeatures.get(X):null,Y=new Ui(t,z,L,q),J=G?G.stop:L.handler(Y);if(h&&this.hoveredFeatures.set(X,{feature:I,stop:J}),J!==!1){b=!0;break}}if(b)break}}if(b)break}if(!b)for(const[I,z]of g){const{handler:L,target:N}=z;if(!N&&L(new Ui(t,I,z,null))!==!1)break}}}function Fn(u,t){if(Array.isArray(u)&&Array.isArray(t)){const s=new Set(u),h=new Set(t);return s.size===h.size&&u.every(g=>h.has(g))}return r.bv(u,t)}const Bl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},dp={showCompass:!0,showZoom:!0,visualizePitch:!1};class Gf{constructor(t,s,h=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new od({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,h&&(this.mousePitch=new uu({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),r.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener("mousedown",this.mousedown),s.addEventListener("touchstart",this.touchstart,{passive:!1}),s.addEventListener("touchmove",this.touchmove),s.addEventListener("touchend",this.touchend),s.addEventListener("touchcancel",this.reset)}down(t,s){this.mouseRotate.mousedown(t,s),this.mousePitch&&this.mousePitch.mousedown(t,s),Le()}move(t,s){const h=this.map,g=this.mouseRotate.mousemoveWindow(t,s),v=g&&g.bearingDelta;if(v&&h.setBearing(h.getBearing()+v),this.mousePitch){const b=this.mousePitch.mousemoveWindow(t,s),E=b&&b.pitchDelta;E&&h.setPitch(h.getPitch()+E)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){De(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(r.h({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),qe(this.element,t)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,qe(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=$e(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=$e(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function hh(u,t,s){if(u=new r.cd(u.lng,u.lat),t){const h=new r.cd(u.lng-360,u.lat),g=new r.cd(u.lng+360,u.lat),v=360*Math.ceil(Math.abs(u.lng-s.center.lng)/360),b=s.locationPoint3D(u).distSqr(t),E=t.x<0||t.y<0||t.x>s.width||t.y>s.height;s.locationPoint3D(h).distSqr(t)<b&&(E||Math.abs(h.lng-s.center.lng)<v)?u=h:s.locationPoint3D(g).distSqr(t)<b&&(E||Math.abs(g.lng-s.center.lng)<v)&&(u=g)}for(;Math.abs(u.lng-s.center.lng)>180;){const h=s.locationPoint3D(u);if(h.x>=0&&h.y>=0&&h.x<=s.width&&h.y<=s.height)break;u.lng>s.center.lng?u.lng-=360:u.lng+=360}return u}const mu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},ca={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class gu extends r.E{constructor(t,s){super(),(t instanceof HTMLElement||s)&&(t=r.h({element:t},s)),r.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:h="center",color:g="#3FB1CE",scale:v=1,draggable:b=!1,clickTolerance:E=0,rotation:I=ca.rotation,rotationAlignment:z=ca.rotationAlignment,pitchAlignment:L=ca.pitchAlignment,occludedOpacity:N=ca.occludedOpacity,altitude:F=ca.altitude}=t||{};this._anchor=h,this._color=g,this._scale=v,this._draggable=b,this._clickTolerance=E,this._rotation=I,this._rotationAlignment=z,this._pitchAlignment=L,this._occludedOpacity=N,this._altitude=F,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),t&&t.element?(this._element=t.element,this._offset=r.P.convert(t&&t.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=r.P.convert(t&&t.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",G=>{G.preventDefault()}),this._element.addEventListener("mousedown",G=>{G.preventDefault()});const q=this._element.classList;for(const G in mu)q.remove(`mapboxgl-marker-anchor-${G}`);q.add(`mapboxgl-marker-anchor-${this._anchor}`);const X=t&&t.className?t.className.trim().split(/\s+/):[];q.add(...X),this._popup=null}_createDefaultMarker(){const t=ne("div"),s=Se("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},t);if(this._altitude===0){const h=Se("radialGradient",{id:"shadowGradient"},Se("defs",{},s));Se("stop",{offset:"10%","stop-opacity":.4},h),Se("stop",{offset:"100%","stop-opacity":.05},h),Se("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},s)}return Se("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},s),Se("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},s),Se("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},s),t}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=r.cd.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(t){return t===this._altitude||(this._defaultMarker&&(this._altitude===0&&t!==0||this._altitude!==0&&t===0)&&(this._element=this._createDefaultMarker()),this._altitude=t||ca.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const g=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,t._marker=this,t._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const s=t.code,h=t.charCode||t.keyCode;s!=="Space"&&s!=="Enter"&&h!==32&&h!==13||this.togglePopup()}_onMapClick(t){const s=t.originalEvent.target,h=this._element;this._popup&&(s===h||h.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,s=this._pos;if(!t||!s)return!1;const h=t.unproject(s,this._altitude),g=t.getFreeCameraOptions();if(!g.position)return!1;const v=g.position.toLngLat();return v.distanceTo(h)<.9*v.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const s=this._pos;if(!s||s.x<0||s.x>t.transform.width||s.y<0||s.y>t.transform.height)return void this._clearFadeTimer();const h=t.unproject(s,this._altitude);let g;t._showingGlobe()&&r.eK(t.transform,this._lngLat)?g=0:(g=1-t._queryFogOpacity(h),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(g*=this._occludedOpacity)),this._element.style.opacity=`${g}`,this._element.style.pointerEvents=g>0?"auto":"none",this._popup&&this._popup._setOpacity(g),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const s=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${t.x}px,${t.y}px)
            ${mu[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${s.x}px,${s.y}px)
        `}_calculateXYTransform(){const t=this._pos,s=this._map,h=this.getPitchAlignment();if(!s||!t||h!=="map")return"";if(!s._showingGlobe()){const I=s.getPitch();return I?`rotateX(${I}deg)`:""}const g=r.cJ(r.eL(s.transform,this._lngLat)),v=t.sub(r.eM(s.transform)),b=Math.abs(v.x)+Math.abs(v.y);if(b===0)return"";const E=g/b;return`rotateX(${-v.y*E}deg) rotateY(${v.x*E}deg)`}_calculateZTransform(){const t=this._pos,s=this._map;if(!s||!t)return"";let h=0;const g=this.getRotationAlignment();if(g==="map")if(s._showingGlobe()){const v=s.project(new r.cd(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),b=s.project(new r.cd(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(v);h=r.cJ(Math.atan2(b.y,b.x))-90}else h=-s.getBearing();else if(g==="horizon"){const v=r.af(4,6,s.getZoom()),b=r.eM(s.transform);b.y+=v*s.transform.height;const E=t.sub(b),I=r.cJ(Math.atan2(E.y,E.x));h=(I>90?I-270:I+90)*(1-v)}return h+=this._rotation,h?`rotateZ(${h}deg)`:""}_update(t){cancelAnimationFrame(this._updateFrameId);const s=this._map;s&&(s.transform.renderWorldCopies&&(this._lngLat=hh(this._lngLat,this._pos,s.transform)),this._pos=s.project(this._lngLat,this._altitude),t===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),s._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(s._showingGlobe()||s.getTerrain()||s.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=r.P.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const s=this._map;if(!s)return;const h=this._pointerdownPos,g=this._positionDelta;if(h&&g){if(!this._isDragging){const v=this._clickTolerance||s._clickTolerance;if(t.point.dist(h)<v)return;this._isDragging=!0}this._pos=t.point.sub(g),this._lngLat=s.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.A("dragstart"))),this.fire(new r.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.A("dragend")),this._state="inactive"}_addDragHandler(t){const s=this._map,h=this._pos;s&&h&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(h),this._pointerdownPos=t.point,this._state="pending",s.on("mousemove",this._onMove),s.on("touchmove",this._onMove),s.once("mouseup",this._onUp),s.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const s=this._map;return s&&(t?(s.on("mousedown",this._addDragHandler),s.on("touchstart",this._addDragHandler)):(s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||ca.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||ca.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||ca.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||ca.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const pp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},dh={maxWidth:100,unit:"metric"},_u={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Oa={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},ua=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qr(u=new r.P(0,0),t="bottom"){if(typeof u=="number"){const s=Math.round(Math.sqrt(.5*Math.pow(u,2)));switch(t){case"top":return new r.P(0,u);case"top-left":return new r.P(s,s);case"top-right":return new r.P(-s,s);case"bottom":return new r.P(0,-u);case"bottom-left":return new r.P(s,-s);case"bottom-right":return new r.P(-s,-s);case"left":return new r.P(u,0);case"right":return new r.P(-u,0)}return new r.P(0,0)}return u instanceof r.P||Array.isArray(u)?r.P.convert(u):r.P.convert(u[t]||[0,0])}return{version:O,supported:se.supported,setRTLTextPlugin:r.eQ,getRTLTextPluginStatus:r.eP,Map:class extends uh{constructor(u){U.mark(V.create);const t=u;if((u=r.h({},Bl,u)).minZoom!=null&&u.maxZoom!=null&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(u.minPitch!=null&&u.maxPitch!=null&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(u.minPitch!=null&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(u.maxPitch!=null&&u.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(u.antialias&&r.eI(window)&&(u.antialias=!1,r.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new kd(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies,null,null),u),this._repaint=!!u.repaint,this._interactive=u.interactive,this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=u.crossSourceCollisions,this._collectResourceTiming=u.collectResourceTiming,this._language=this._parseLanguage(u.language),this._worldview=u.worldview,this._renderTaskQueue=new dd,this._domRenderTaskQueue=new dd,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.a$(),this._locale=r.h({},fu,u.locale),this._clickTolerance=u.clickTolerance,this._cooperativeGestures=u.cooperativeGestures,this._performanceMetricsCollection=u.performanceMetricsCollection,this._tessellationStep=u.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=u.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ol(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=u.scaleFactor,this._requestManager=new xt(u.transformRequest,u.accessToken,u.testMode),this._silenceAuthErrors=!!u.testMode,this._contextCreateOptions=u.contextCreateOptions?Object.assign({},u.contextCreateOptions):{},typeof u.container=="string"){const s=document.getElementById(u.container);if(!s)throw new Error(`Container '${u.container.toString()}' not found.`);this._container=s}else{if(!(u.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(this._container.childNodes.length>0&&r.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),u.maxBounds&&this.setMaxBounds(u.maxBounds),this._spriteFormat=u.spriteFormat,r.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Qd),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new hd(this,u),this._localFontFamily=u.localFontFamily,this._localIdeographFontFamily=u.localIdeographFontFamily,(u.style||!u.testMode)&&this.setStyle(u.style||r.e.DEFAULT_STYLE,{config:u.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),u.projection&&this.setProjection(u.projection),this.indoor=new Hm(this),u.hash&&(this._hash=new $p(typeof u.hash=="string"&&u.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){t.center==null&&t.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch});const s=u.bounds;s&&(this.resize(),this.fitBounds(s,r.h({},u.fitBoundsOptions,{duration:0})))}this.resize(),u.attributionControl&&this.addControl(new pu({customAttribution:u.customAttribution})),this._logoControl=new qs,this.addControl(this._logoControl,u.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new r.A(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new r.A(`${s.dataType}dataloading`,s))}),this._interactions=new ul(this)}_getMapId(){return this._mapId}addControl(u,t){if(t===void 0&&(t=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new r.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=u.onAdd(this);this._controls.push(u);const h=this._controlPositions[t];return t.indexOf("bottom")!==-1?h.insertBefore(s,h.firstChild):h.appendChild(s),this}removeControl(u){if(!u||!u.onRemove)return this.fire(new r.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(u);return t>-1&&this._controls.splice(t,1),u.onRemove(this),this}hasControl(u){return this._controls.indexOf(u)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(u){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new r.A("movestart",u)).fire(new r.A("move",u)),this.fire(new r.A("resize",u)),t&&this.fire(new r.A("moveend",u)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(u){return this.transform.setMaxBounds(r.aG.convert(u)),this._update()}setMinZoom(u){if((u=u??-2)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u?this.setZoom(u):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(u){if((u=u??22)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u?this.setZoom(u):this.fire(new r.A("zoomstart")).fire(new r.A("zoom")).fire(new r.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(u){if((u=u??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u?this.setPitch(u):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(u){if((u=u??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u?this.setPitch(u):this.fire(new r.A("pitchstart")).fire(new r.A("pitch")).fire(new r.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(u){return this._scaleFactor=u,this.painter.scaleFactor=u,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(t=>t.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(u){return this.transform.renderWorldCopies=u,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(u){return u==="auto"?navigator.language:Array.isArray(u)?u.length===0?void 0:u.map(t=>t==="auto"?navigator.language:t):u}setLanguage(u){const t=this._parseLanguage(u);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const s of this._controls)s._setLanguage&&s._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(u){return this.style&&u!==this._worldview?(this._worldview=u,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(u){return this._lazyInitEmptyStyle(),u?typeof u=="string"&&(u={name:u}):u=null,this._useExplicitProjection=!!u,this._prioritizeAndUpdateProjection(u,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const u=this.transform,t=u.projection.name;let s;t==="globe"&&u.zoom>=r.cx?(u.setMercatorFromTransition(),s=!0):t==="mercator"&&u.zoom<r.cx&&(u.setProjection({name:"globe"}),s=!0),s&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(u,t){return this._updateProjection(u||t||{name:"mercator"})}_updateProjection(u){let t;return t=u.name==="globe"&&this.transform.zoom>=r.cx?this.transform.setMercatorFromTransition():this.transform.setProjection(u),this.style.applyProjectionUpdate(),t&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(u,t){return this.transform.locationPoint3D(r.cd.convert(u),t)}unproject(u,t){return this.transform.pointLocation3D(r.P.convert(u),t)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(u,t,s){const h=g=>{let v=[];if(Array.isArray(t)){const b=t.filter(E=>this.getLayer(E));v=b.length?this.queryRenderedFeatures(g,{layers:b}):[]}else v=this.queryRenderedFeatures(g,{target:t});return v};if(u==="mouseenter"||u==="mouseover"){let g=!1;return{listener:s,targets:t,delegates:{mousemove:b=>{const E=h(b.point);E.length?g||(g=!0,s.call(this,new bs(u,this,b.originalEvent,{features:E}))):g=!1},mouseout:()=>{g=!1}}}}if(u==="mouseleave"||u==="mouseout"){let g=!1;return{listener:s,targets:t,delegates:{mousemove:E=>{h(E.point).length?g=!0:g&&(g=!1,s.call(this,new bs(u,this,E.originalEvent)))},mouseout:E=>{g&&(g=!1,s.call(this,new bs(u,this,E.originalEvent)))}}}}{const g=v=>{const b=h(v.point);b.length&&(v.features=b,s.call(this,v),delete v.features)};return{listener:s,targets:t,delegates:{[u]:g}}}}on(u,t,s){if(typeof t=="function"||s===void 0)return super.on(u,t);if(typeof t=="string"&&(t=[t]),!this._areTargetsValid(t))return this;const h=this._createDelegatedListener(u,t,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(h);for(const g in h.delegates)this.on(g,h.delegates[g]);return this}once(u,t,s){if(typeof t=="function"||s===void 0)return super.once(u,t);if(typeof t=="string"&&(t=[t]),!this._areTargetsValid(t))return this;const h=this._createDelegatedListener(u,t,s);for(const g in h.delegates)this.once(g,h.delegates[g]);return this}off(u,t,s){if(typeof t=="function"||s===void 0)return super.off(u,t);if(typeof t=="string"&&(t=[t]),!this._areTargetsValid(t))return this;const h=this._delegatedListeners?this._delegatedListeners[u]:void 0;return h&&(g=>{for(let v=0;v<g.length;v++){const b=g[v];if(b.listener===s&&Fn(b.targets,t)){for(const E in b.delegates)this.off(E,b.delegates[E]);return g.splice(v,1),this}}})(h),this}queryRenderedFeatures(u,t){if(!this.style)return[];if(u===void 0||u instanceof r.P||Array.isArray(u)||t!==void 0||(t=u,u=void 0),u=u||[[0,0],[this.transform.width,this.transform.height]],!t){const v=this.style.queryRenderedFeatures(u,void 0,this.transform),b=this.style.queryRenderedFeatureset(u,void 0,this.transform);return v.concat(b)}let s=!0;if(t.target&&(s=this._isTargetValid(t.target),s&&!t.layers))return this.style.queryRenderedFeatureset(u,t,this.transform);let h=!0;if(t.layers&&Array.isArray(t.layers)){for(const v of t.layers)if(!this._isValidId(v)){h=!1;break}if(h&&!t.target)return this.style.queryRenderedFeatures(u,t,this.transform)}let g=[];return h&&(g=g.concat(this.style.queryRenderedFeatures(u,t,this.transform))),s&&(g=g.concat(this.style.queryRenderedFeatureset(u,t,this.transform))),g}querySourceFeatures(u,t){return!u||typeof u=="string"&&!this._isValidId(u)?[]:this.style.querySourceFeatures(u,t)}isPointOnSurface(u){const{name:t}=this.transform.projection;return t!=="globe"&&t!=="mercator"&&r.w(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.P.convert(u))}addInteraction(u,t){return this._interactions.add(u,t),this}removeInteraction(u){return this._interactions.remove(u),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(u){return this._cooperativeGestures=u,this}setStyle(u,t){return t=r.h({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t),this.style&&u&&t.diff!==!1&&t.localFontFamily===this._localFontFamily&&t.localIdeographFontFamily===this._localIdeographFontFamily&&!t.config?(this.style._diffStyle(u,(s,h)=>{if(s){const g=typeof s=="string"?s:s instanceof Error?s.message:s.error;r.w(`Unable to perform style diff: ${g}. Rebuilding the style from scratch.`),this._updateStyle(u,t)}else h&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(u,t))}_getUIString(u){const t=this._locale[u];if(t==null)throw new Error(`Missing UI string '${u}'`);return t}_updateStyle(u,t){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),u){const s=r.h({},t);t&&t.config&&(s.initialConfig=t.config,delete s.config),this.style=new ao(this,s).load(u),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ao(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.w("There is no style added to the map."),!1)}_isValidId(u){return u==null?(this.fire(new r.z(new Error("IDs can't be empty."))),!1):!r.d8(u)||(this.fire(new r.z(new Error(`IDs can't contain special symbols: "${u}".`))),!1)}_isTargetValid(u){return"featuresetId"in u?this._isValidId("importId"in u?u.importId:u.featuresetId):"layerId"in u&&this._isValidId(u.layerId)}_areTargetsValid(u){if(Array.isArray(u)){for(const t of u)if(!this._isValidId(t))return!1;return!0}return this._isTargetValid(u)}addSource(u,t){return this._isValidId(u)?(this._lazyInitEmptyStyle(),this.style.addSource(u,t),this._update(!0)):this}isSourceLoaded(u){return!!this._isValidId(u)&&!!this.style&&this.style._isSourceCacheLoaded(u)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(u,t,s){this._lazyInitEmptyStyle(),this.style.addSourceType(u,t,s)}removeSource(u){return this._isValidId(u)?(this.style.removeSource(u),this._updateTerrain(),this._update(!0)):this}getSource(u){return this._isValidId(u)?this.style.getOwnSource(u):null}addImage(u,t,{pixelRatio:s=1,sdf:h=!1,stretchX:g,stretchY:v,content:b}={}){this._lazyInitEmptyStyle();const E=r.I.from(u);if(t instanceof HTMLImageElement||ImageBitmap&&t instanceof ImageBitmap){const{width:I,height:z,data:L}=r.q.getImageData(t);this.style.addImage(E,{data:new r.r({width:I,height:z},L),pixelRatio:s,stretchX:g,stretchY:v,content:b,sdf:h,version:0,usvg:!1})}else if(t.width===void 0||t.height===void 0)this.fire(new r.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:z}=t,L=t;this.style.addImage(E,{data:new r.r({width:I,height:z},new Uint8Array(L.data)),pixelRatio:s,stretchX:g,stretchY:v,content:b,sdf:h,usvg:!1,version:0,userImage:L}),L.onAdd&&L.onAdd(this,u)}}updateImage(u,t){this._lazyInitEmptyStyle();const s=r.I.from(u),h=this.style.getImage(s);if(!h)return void this.fire(new r.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=t instanceof HTMLImageElement||ImageBitmap&&t instanceof ImageBitmap?r.q.getImageData(t):t,{width:v,height:b,data:E}=g;if(v===void 0||b===void 0)return void this.fire(new r.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==(h.usvg?h.icon.usvg_tree.width:h.data.width)||b!==(h.usvg?h.icon.usvg_tree.height:h.data.height))return void this.fire(new r.z(new Error(`The width and height of the updated image (${v}, ${b})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`)));const I=!(t instanceof HTMLImageElement||ImageBitmap&&t instanceof ImageBitmap);let z=!1;h.usvg?(h.data=new r.r({width:v,height:b},new Uint8Array(E)),h.usvg=!1,h.icon=void 0,z=!0):h.data.replace(E,I),this.style.updateImage(s,h,z)}hasImage(u){return u?!!this.style&&!!this.style.getImage(r.I.from(u)):(this.fire(new r.z(new Error("Missing required image id"))),!1)}removeImage(u){this.style.removeImage(r.I.from(u))}loadImage(u,t){r.o(this._requestManager.transformRequest(u,r.R.Image),(s,h)=>{t(s,h instanceof HTMLImageElement?r.q.getImageData(h):h)})}listImages(){return this.style.listImages().map(u=>u.name)}addModel(u,t){this._lazyInitEmptyStyle(),this.style.addModel(u,t)}hasModel(u){return u?this.style.hasModel(u):(this.fire(new r.z(new Error("Missing required model id"))),!1)}removeModel(u){this.style.removeModel(u)}listModels(){return this.style.listModels()}addLayer(u,t){return this._isValidId(u.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(u,t),this._update(!0)):this}getSlot(u){const t=this.getLayer(u);return t&&t.slot||null}setSlot(u,t){return this.style.setSlot(u,t),this.style.mergeLayers(),this._update(!0)}addImport(u,t){return this.style.addImport(u,t).catch(s=>this.fire(new r.z(new Error("Failed to add import",s)))),this}updateImport(u,t){return typeof t!="string"&&t.id!==u?(this.removeImport(u),this.addImport(t)):(this.style.updateImport(u,t),this._update(!0))}removeImport(u){return this.style.removeImport(u),this}moveImport(u,t){return this.style.moveImport(u,t),this._update(!0)}moveLayer(u,t){return this._isValidId(u)?(this.style.moveLayer(u,t),this._update(!0)):this}removeLayer(u){return this._isValidId(u)?(this.style.removeLayer(u),this._update(!0)):this}getLayer(u){if(!this._isValidId(u))return null;const t=this.style.getOwnLayer(u);return t?t.type==="custom"?t.implementation:t.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(u,t,s){return this._isValidId(u)?(this.style.setLayerZoomRange(u,t,s),this._update(!0)):this}setFilter(u,t,s={}){return this._isValidId(u)?(this.style.setFilter(u,t,s),this._update(!0)):this}getFilter(u){return this._isValidId(u)?this.style.getFilter(u):null}setPaintProperty(u,t,s,h={}){return this._isValidId(u)?(this.style.setPaintProperty(u,t,s,h),this._update(!0)):this}getPaintProperty(u,t){return this._isValidId(u)?this.style.getPaintProperty(u,t):null}setLayoutProperty(u,t,s,h={}){return this._isValidId(u)?(this.style.setLayoutProperty(u,t,s,h),this._update(!0)):this}getLayoutProperty(u,t){return this._isValidId(u)?this.style.getLayoutProperty(u,t):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(u){return this.style.setGlyphsUrl(u),this._update(!0)}getSchema(u){return this.style.getSchema(u)}setSchema(u,t){return this.style.setSchema(u,t),this._update(!0)}getConfig(u){return this.style.getConfig(u)}setConfig(u,t){return this.style.setConfig(u,t),this._update(!0)}getConfigProperty(u,t){return this.style.getConfigProperty(u,t)}setConfigProperty(u,t,s){return this.style.setConfigProperty(u,t,s),this._update(!0)}getFeaturesetDescriptors(u){return this.style.getFeaturesetDescriptors(u)}setLights(u){if(this._lazyInitEmptyStyle(),u&&u.length===1&&u[0].type==="flat"){const t=u[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(u),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const u=this.style.getLights()||[];return u.length===0&&u.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),u}setLight(u,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:u}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(u){return this._lazyInitEmptyStyle(),!u&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(u),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(u){return this._lazyInitEmptyStyle(),this.style.setFog(u),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(u){return this._lazyInitEmptyStyle(),this.style.setSnow(u),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(u){return this._lazyInitEmptyStyle(),this.style.setRain(u),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(u){return this._lazyInitEmptyStyle(),this.style.setColorTheme(u),this._update(!0)}setImportColorTheme(u,t){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(u,t),this._update(!0)}setCamera(u){return this.style.setCamera(u),this._triggerCameraUpdate(u)}_triggerCameraUpdate(u){return this._update(this.transform.setOrthographicProjectionAtLowPitch(u["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(u){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.cd.convert(u),this.transform):0}setFeatureState(u,t){return u.source&&!this._isValidId(u.source)?this:(this.style.setFeatureState(u,t),this._update())}removeFeatureState(u,t){return u.source&&!this._isValidId(u.source)?this:(this.style.removeFeatureState(u,t),this._update())}getFeatureState(u){return u.source&&!this._isValidId(u.source)?null:this.style.getFeatureState(u)}_updateContainerDimensions(){if(!this._container)return;const u=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let s,h,g,v=this._container;for(;v&&(!h||!g);){const b=window.getComputedStyle(v).transform;b&&b!=="none"&&(s=b.match(/matrix.*\((.+)\)/)[1].split(", "),s[0]&&s[0]!=="0"&&s[0]!=="1"&&(h=s[0]),s[3]&&s[3]!=="0"&&s[3]!=="1"&&(g=s[3])),v=v.parentElement}this._containerWidth=h?Math.abs(u/h):u,this._containerHeight=g?Math.abs(t/g):t}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=ne("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=ne("div","mapboxgl-canvas-container",u);this._canvas=ne("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const s=this._controlContainer=ne("div","mapboxgl-control-container",u),h=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(g=>{h[g]=ne("div",`mapboxgl-ctrl-${g}`,s)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(u,t){const s=r.q.devicePixelRatio||1;this._canvas.width=s*Math.ceil(u),this._canvas.height=s*Math.ceil(t),this._canvas.style.width=`${u}px`,this._canvas.style.height=`${t}px`}_addMarker(u){this._markers.push(u)}_removeMarker(u){const t=this._markers.indexOf(u);t!==-1&&this._markers.splice(t,1)}_addPopup(u){this._popups.push(u)}_removePopup(u){const t=this._popups.indexOf(u);t!==-1&&this._popups.splice(t,1)}_setupPainter(){const u=r.h({},se.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",u);t?(Yi(t,!0),this.painter=new sh(t,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",s=>{s.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.l.testSupport(t)):this.fire(new r.z(new Error("Failed to initialize WebGL")))}_contextLost(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.A("webglcontextlost",{originalEvent:u}))}_contextRestored(u){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new r.A("webglcontextrestored",{originalEvent:u}))}_onMapScroll(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(u){return this._update(),this._renderTaskQueue.add(u)}_cancelRenderFrame(u){this._renderTaskQueue.remove(u)}_requestDomTask(u){!this.loaded()||this.loaded()&&!this.isMoving()?u():this._domRenderTaskQueue.add(u)}_render(u){let t;this.fire(new r.A("renderstart")),++this._frameId;const s=this.painter.context.extTimerQuery,h=r.q.now(),g=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=g.createQuery(),g.beginQuery(s.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(u),this._domRenderTaskQueue.run(u),this._removed)return;this._updateProjectionTransition();const v=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,L=this.transform.pitch,N=r.q.now(),F=new r.aa(z,{now:N,fadeDuration:v,pitch:L,transition:this.style.transition,worldview:this._worldview});this.style.update(F)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(h),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(h);const E=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,v,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),E&&(this._placementDirty=E.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,U.mark(V.load),this.fire(new r.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const z=r.q.now()-h;g.endQuery(s.TIME_ELAPSED_EXT),setTimeout(()=>{const L=g.getQueryParameter(t,g.QUERY_RESULT)/1e6;g.deleteQuery(t),this.fire(new r.A("gpu-timing-frame",{cpuTime:z,gpuTime:L}))},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const L=this.painter.queryGpuTimers(z);this.fire(new r.A("gpu-timing-layer",{layerTimes:L}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const L=this.painter.queryGpuTimeDeferredRender(z);this.fire(new r.A("gpu-timing-deferred-render",{gpuTime:L}))},50)}const I=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(I||this._repaint)this.triggerRepaint();else{const z=this.idle();if(z&&(b=this._updateAverageElevation(h,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new r.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const L=this._calculateSpeedIndex();this.fire(new r.A("speedindexcompleted",{speedIndex:L})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||I||(this._fullyLoaded=!0,U.mark(V.fullLoad),this._performanceMetricsCollection&&Hn(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(u){for(const t of this._markers)u&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!u||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(u,t=!1){const s=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&s(0);const h=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(h||(t||u-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(u)){const g=this.transform.averageElevation;let v=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(v)?v=0:this._averageElevationLastSampledAt=u;const b=Math.abs(g-v);if(b>1){if(this._isInitialLoad||h)return this._averageElevation.jumpTo(v),s(v);this._averageElevation.easeTo(v,u,300)}else if(b>1e-4)return this._averageElevation.jumpTo(v),s(v)}return!!this._averageElevation.isEasing(u)&&s(this._averageElevation.getValue(u))}_authenticate(){Zi(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,u=>{if(u&&(u.message===St||u.status===401)){const t=this.painter.context.gl;Yi(t,!1),this._logoControl instanceof qs&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),zn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&An(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const u=this._isDragging();this.painter.updateTerrain(this.style,u)}_calculateSpeedIndex(){const u=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const s=this.painter.context.gl,h=s.createFramebuffer();function g(v){s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,v,0);const b=new Uint8Array(s.drawingBufferWidth*s.drawingBufferHeight*4);return s.readPixels(0,0,s.drawingBufferWidth,s.drawingBufferHeight,s.RGBA,s.UNSIGNED_BYTE,b),b}return s.bindFramebuffer(s.FRAMEBUFFER,h),this._canvasPixelComparison(g(u),t.canvasCopies.map(g),t.timeStamps)}_canvasPixelComparison(u,t,s){let h=s[1]-s[0];const g=u.length/4;for(let v=0;v<t.length;v++){const b=t[v];let E=0;for(let I=0;I<b.length;I+=4)b[I]===u[I]&&b[I+1]===u[I+1]&&b[I+2]===u[I+2]&&b[I+3]===u[I+3]&&(E+=1);h+=(s[v+2]-s[v+1])*(1-E/g)}return h}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const u=this.painter.context.gl.getExtension("WEBGL_lose_context");u&&u.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Ci.delete(this.painter.context.gl),bn.remove(),Nn.remove(),this._removed=!0,this.fire(new r.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(u){this._renderNextFrame=this._renderNextFrame||u,this.style&&!this._frame&&(this._frame=r.q.frame(t=>{const s=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,s&&this._render(t)}))}_preloadTiles(u){const t=this.style?this.style.getSourceCaches():[];return r.bt(t,(s,h)=>s._preloadTiles(u,h),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(u){this._trackResize&&this.resize({originalEvent:u})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(u){this._showParseStatus!==u&&(this._showParseStatus=u,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(u){this._showTerrainWireframe!==u&&(this._showTerrainWireframe=u,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(u){this._showLayers2DWireframe!==u&&(this._showLayers2DWireframe=u,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(u){this._showLayers3DWireframe!==u&&(this._showLayers3DWireframe=u,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(u){this._speedIndexTiming!==u&&(this._speedIndexTiming=u,this._update())}get showPadding(){return!!this._showPadding}set showPadding(u){this._showPadding!==u&&(this._showPadding=u,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,this._tp.refreshUI(),u?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(u){this._repaint!==u&&(this._repaint=u,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(u){this._vertices=u,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(u){this._showTileAABBs!==u&&(this._showTileAABBs=u,this._tp.refreshUI(),u&&this._update())}_setCacheLimits(u,t){r.eJ(u,t)}get version(){return O}},NavigationControl:class{constructor(u={}){this.options=r.h({},dp,u),this._container=ne("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(r.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),ne("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),ne("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const s=this._map;s&&(this.options.visualizePitch?s.resetNorthPitch({},{originalEvent:t}):s.resetNorth({},{originalEvent:t}))}),this._compassIcon=ne("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const u=this._map;if(!u)return;const t=u.getZoom(),s=t===u.getMaxZoom(),h=t===u.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())}_rotateCompassArrow(){const u=this._map;if(!u)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(u.transform.pitch*(Math.PI/180)),.5)}) rotateX(${u.transform.pitch}deg) rotateZ(${u.transform.angle*(180/Math.PI)}deg)`:`rotate(${u.transform.angle*(180/Math.PI)}deg)`;u._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),u.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&u.on("pitch",this._rotateCompassArrow),u.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Gf(u,this._compass,this.options.visualizePitch)),this._container}onRemove(){const u=this._map;u&&(this._container.remove(),this.options.showZoom&&u.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&u.off("pitch",this._rotateCompassArrow),u.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(u,t){const s=ne("button",u,this._container);return s.type="button",s.addEventListener("click",t),s}_setButtonTitle(u,t){if(!this._map)return;const s=this._map._getUIString(`NavigationControl.${t}`);u.setAttribute("aria-label",s),u.firstElementChild&&u.firstElementChild.setAttribute("title",s)}},GeolocateControl:class extends r.E{constructor(u={}){super();const t=navigator.geolocation;this.options=r.h({geolocation:t},pp,u),r.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Rl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(u){return this._map=u,this._container=ne("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(u){const t=(s=!!this.options.geolocation)=>{this._supportsGeolocation=s,u(s)};this._supportsGeolocation!==void 0?u(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(s=>t(s.state!=="denied")).catch(()=>t()):t()}_isOutOfMapMaxBounds(u){const t=this._map.getMaxBounds(),s=u.coords;return!!t&&(s.longitude<t.getWest()||s.longitude>t.getEast()||s.latitude<t.getSouth()||s.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(u){if(this._map){if(this._isOutOfMapMaxBounds(u))return this._setErrorState(),this.fire(new r.A("outofmaxbounds",u)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=u,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(u),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(u),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("geolocate",u)),this._finish()}}_updateCamera(u){const t=new r.cd(u.coords.longitude,u.coords.latitude),s=u.coords.accuracy,h=this._map.getBearing(),g=r.h({bearing:h},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(s),g,{geolocateSource:!0})}_updateMarker(u){if(u){const t=new r.cd(u.coords.longitude,u.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=u.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const u=this._map.transform,t=r.c6(1,u._center.lat)*u.worldSize,s=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${s}px`,this._circleElement.style.height=`${s}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(u){if(this._map){if(this.options.trackUserLocation)if(u.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(u.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.A("error",u)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(u){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=ne("button","mapboxgl-ctrl-geolocate",this._container),ne("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",u===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ne("div","mapboxgl-user-location"),this._dotElement.appendChild(ne("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ne("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new gu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ne("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new gu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.A("trackuserlocationend")))})}}_onDeviceOrientation(u){this._userLocationDotMarker&&(u.webkitCompassHeading?this._heading=u.webkitCompassHeading:u.absolute===!0&&(this._heading=-1*u.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let u;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(u={maximumAge:6e5,timeout:0},this._noTimeout=!0):(u=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,u),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const u=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&u()}).catch(console.error):u()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:pu,ScaleControl:class{constructor(u={}){this.options=r.h({},dh,u),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const u=this.options.maxWidth||100,t=this._map,s=t._containerHeight/2,h=t._containerWidth/2-u/2,g=t.unproject([h,s]),v=t.unproject([h+u,s]),b=g.distanceTo(v);if(this.options.unit==="imperial"){const E=3.2808*b;E>5280?this._setScale(u,E/5280,"mile"):this._setScale(u,E,"foot")}else this.options.unit==="nautical"?this._setScale(u,b/1852,"nautical-mile"):b>=1e3?this._setScale(u,b/1e3,"kilometer"):this._setScale(u,b,"meter")}_setScale(u,t,s){this._map._requestDomTask(()=>{const h=function(v){const b=Math.pow(10,`${Math.floor(v)}`.length-1);let E=v/b;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:function(I){const z=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*z)/z}(E),b*E}(t),g=h/t;this._container.innerHTML=this._isNumberFormatSupported&&s!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:s}).format(h):`${h}&nbsp;${_u[s]}`,this._container.style.width=u*g+"px"})}onAdd(u){return this._map=u,this._language=u.getLanguage(),this._container=ne("div","mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(u){this._language=u,this._update()}setUnit(u){this.options.unit=u,this._update()}},FullscreenControl:class{constructor(u={}){this._fullscreen=!1,u&&u.container&&(u.container instanceof HTMLElement?this._container=u.container:r.w("Full screen control 'container' must be a DOM element.")),r.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=ne("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const u=this._fullscreenButton=ne("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ne("span","mapboxgl-ctrl-icon",u).setAttribute("aria-hidden","true"),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",u)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.E{constructor(u){super(),this.options=r.h(Object.create(Oa),u),this._altitude=this.options.altitude,r.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(u&&u.className?u.className.trim().split(/\s+/):[])}addTo(u){return this._map&&this.remove(),this._map=u,this.options.closeOnClick&&u.on("preclick",this._onClose),this.options.closeOnMove&&u.on("move",this._onClose),u.on("remove",this.remove),this._update(),u._addPopup(this),this._focusFirstElement(),this._trackPointer?(u.on("mousemove",this._onMouseEvent),u.on("mouseup",this._onMouseEvent),u._canvasContainer.classList.add("mapboxgl-track-pointer")):u.on("move",this._update),this.fire(new r.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const u=this._map;return u&&(u.off("move",this._update),u.off("move",this._onClose),u.off("preclick",this._onClose),u.off("click",this._onClose),u.off("remove",this.remove),u.off("mousemove",this._onMouseEvent),u.off("mouseup",this._onMouseEvent),u.off("drag",this._onMouseEvent),u._canvasContainer&&u._canvasContainer.classList.remove("mapboxgl-track-pointer"),u._removePopup(this),this._map=void 0),this.fire(new r.A("close")),this}getLngLat(){return this._lngLat}setLngLat(u){this._lngLat=r.cd.convert(u),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(u){return this._altitude=u,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const u=this._map;return u&&(u.off("move",this._update),u.on("mousemove",this._onMouseEvent),u.on("drag",this._onMouseEvent),u._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(u){return this.setDOMContent(document.createTextNode(u))}setHTML(u){const t=document.createDocumentFragment(),s=document.createElement("body");let h;for(s.innerHTML=u;h=s.firstChild,h;)t.appendChild(h);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(u){return this.options.maxWidth=u,this._update(),this}setDOMContent(u){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=ne("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(u),this.options.closeButton){const s=this._closeButton=ne("button","mapboxgl-popup-close-button",t);s.type="button",s.setAttribute("aria-label","Close popup"),s.innerHTML='<span aria-hidden="true">&#215;</span>',s.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(u){return this._classList.add(u),this._updateClassList(),this}removeClassName(u){return this._classList.delete(u),this._updateClassList(),this}setOffset(u){return this.options.offset=u,this._update(),this}toggleClassName(u){let t;return this._classList.delete(u)?t=!1:(this._classList.add(u),t=!0),this._updateClassList(),t}_onMouseEvent(u){this._update(u.point)}_getAnchor(u){if(this.options.anchor)return this.options.anchor;const t=this._map,s=this._container,h=this._pos;if(!t||!s||!h)return"bottom";const g=s.offsetWidth,v=s.offsetHeight,b=h.x<g/2,E=h.x>t.transform.width-g/2;if(h.y+u<v)return b?"top-left":E?"top-right":"top";if(h.y>t.transform.height-v){if(b)return"bottom-left";if(E)return"bottom-right"}return b?"left":E?"right":"bottom"}_updateClassList(){const u=this._container;if(!u)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),u.className=t.join(" ")}_update(u){const t=this._map,s=this._content;if(!t||!this._lngLat&&!this._trackPointer||!s)return;let h=this._container;if(h||(h=this._container=ne("div","mapboxgl-popup",t.getContainer()),this._tip=ne("div","mapboxgl-popup-tip",h),h.appendChild(s)),this.options.maxWidth&&h.style.maxWidth!==this.options.maxWidth&&(h.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=hh(this._lngLat,this._pos,t.transform)),!this._trackPointer||u){const g=this._pos=this._trackPointer&&u instanceof r.P?u:t.project(this._lngLat,this._altitude),v=qr(this.options.offset),b=this._anchor=this._getAnchor(v.y),E=qr(this.options.offset,b),I=g.add(E).round();t._requestDomTask(()=>{this._container&&b&&(this._container.style.transform=`${mu[b]} translate(${I.x}px,${I.y}px)`)})}if(!this._marker&&t._showingGlobe()){const g=r.eK(t.transform,this._lngLat)?0:1;this._setOpacity(g)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const u=this._container.querySelector(ua);u&&u.focus()}_onClose(){this.remove()}_setOpacity(u){this._container&&(this._container.style.opacity=`${u}`),this._content&&(this._content.style.pointerEvents=u?"auto":"none")}},Marker:gu,Style:ao,LngLat:r.cd,LngLatBounds:r.aG,Point:r.P,MercatorCoordinate:r.ac,FreeCameraOptions:$c,Evented:r.E,config:r.e,prewarm:r.eO,clearPrewarmedResources:r.eN,get accessToken(){return r.e.ACCESS_TOKEN},set accessToken(u){r.e.ACCESS_TOKEN=u},get baseApiUrl(){return r.e.API_URL},set baseApiUrl(u){r.e.API_URL=u},get workerCount(){return r.eX.workerCount},set workerCount(u){r.eX.workerCount=u},get maxParallelImageRequests(){return r.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){r.e.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage(u){r.eW(u)},get workerUrl(){return r.eV.workerUrl},set workerUrl(u){r.eV.workerUrl=u},get workerClass(){return r.eV.workerClass},set workerClass(u){r.eV.workerClass=u},get workerParams(){return r.eV.workerParams},set workerParams(u){r.eV.workerParams=u},get dracoUrl(){return r.eU()},set dracoUrl(u){r.eT(u)},get meshoptUrl(){return r.eS()},set meshoptUrl(u){r.eR(u)},setNow:r.q.setNow,restoreNow:r.q.restoreNow}});var M=w;return M})}(Cy)),Cy.exports}var nH=tH();const Cm=$l(nH);Cm.accessToken="pk.eyJ1IjoiYm9kaGlwaGlsaXAiLCJhIjoiY21jZzZkODRxMDdkNTJrc2FvdmVjc21jaiJ9.mAKmcXRvELX70UViucsibw";const oI=ue.createContext(void 0),iH=({children:a})=>{const l=ue.useRef(null),[m,_]=ue.useState(null),w=ue.useRef(!1);ue.useEffect(()=>{if(!l.current||w.current)return;w.current=!0;const r=new Cm.Map({container:l.current,style:"mapbox://styles/mapbox/streets-v11",center:[108.32601152345488,15.877122578067937],zoom:17,pitch:0,bearing:0,attributionControl:!1});return r.on("load",()=>{_(r)}),r.on("error",O=>{console.error("Mapbox GL JS Error:",O.error)}),()=>{r&&(r.remove(),_(null),w.current=!1)}},[]);const C=ue.useCallback((r,O)=>{m?m.flyTo({center:r,zoom:O||m.getZoom()}):console.warn("MapProvider: Cannot center map, map instance is null.")},[m]),M=ue.useMemo(()=>({map:m,mapContainerRef:l,centerMap:C}),[m,C]);return Ne.jsx(oI.Provider,{value:M,children:a})},rH=()=>{const a=ue.useContext(oI);if(a===void 0)throw new Error("useMapContext must be used within a MapProvider");return a};var Gg={},FC;function sH(){if(FC)return Gg;FC=1;var a=Th();Object.defineProperty(Gg,"__esModule",{value:!0}),Gg.default=void 0;var l=a(Ip()),m=wd();return Gg.default=(0,l.default)((0,m.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"LocationOn"),Gg}var oH=sH();const aH=$l(oH),jC=Qr.memo(({isActive:a,onClick:l,isBouncing:m,markerColor:_})=>{const w=ue.useCallback(M=>{M.stopPropagation(),l(M)},[l]),C=m?"marker-bounce":"";return Ne.jsx(Hl,{onClick:w,className:C,sx:{p:0,lineHeight:1,color:a?"error.main":_,"&:hover":{color:a?"error.dark":_},transition:"transform 0.3s ease-in-out",transform:a?"scale(1.5)":"scale(1)",cursor:"pointer"},"aria-label":"landmark-marker",children:Ne.jsx(aH,{sx:{fontSize:30}})})}),lH=({map:a,landmarks:l,activeIndex:m,onMapMarkerClick:_,hasUserInteracted:w,getLocalizedContent:C})=>{const M=ue.useRef(new Map);return ue.useEffect(()=>{const r=a;if(!r)return;const O=()=>{const U=new Map;try{r.querySourceFeatures("landmarks-data",{filter:["!",["has","point_count"]]}).forEach(Z=>{Z.properties&&typeof Z.properties.originalIndex=="number"&&Z.geometry&&Z.geometry.type==="Point"&&U.set(Z.properties.originalIndex,Z)})}catch{return}U.forEach((Z,ie)=>{const de=l[ie];if(!de)return;const se=P0(de.category&&de.category.length>0?de.category[0]:"default"),ne={isActive:m===ie,onClick:Se=>_(ie,Se),isBouncing:!w,markerColor:se};if(M.current.has(ie)){const Se=M.current.get(ie);if(Se){const me=Se.marker.getLngLat(),Re=Z.geometry.coordinates;(me.lng!==Re[0]||me.lat!==Re[1])&&Se.marker.setLngLat(Re)}}else{const Se=document.createElement("div"),me=a2.createRoot(Se);me.render(Ne.jsx(jC,{...ne}));const Re=new Cm.Marker({element:Se,anchor:"bottom"}).setLngLat(Z.geometry.coordinates).addTo(r);M.current.set(ie,{marker:Re,root:me})}}),M.current.forEach((Z,ie)=>{U.has(ie)||(setTimeout(()=>{try{Z.root.unmount()}catch{}},0),Z.marker.remove(),M.current.delete(ie))})};r.on("idle",O),r.on("moveend",O),r.on("sourcedata",O);const V=setTimeout(()=>{r.loaded()&&O()},0);return()=>{clearTimeout(V),r&&(r.off("idle",O),r.off("moveend",O),r.off("sourcedata",O)),M.current.forEach(({marker:U,root:Z})=>{setTimeout(()=>{try{Z.unmount()}catch{}},0),U.remove()}),M.current.clear()}},[a,l]),ue.useEffect(()=>{M.current.forEach((r,O)=>{const V=l[O];if(!V)return;const U=P0(V.category&&V.category.length>0?V.category[0]:"default");r.root.render(Ne.jsx(jC,{isActive:m===O,onClick:Z=>_(O,Z),isBouncing:!w,markerColor:U}))})},[m,_,w,l,C]),null};var Wg={},NC;function cH(){if(NC)return Wg;NC=1;var a=Th();Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.default=void 0;var l=a(Ip()),m=wd();return Wg.default=(0,l.default)((0,m.jsx)("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7"}),"MyLocation"),Wg}var uH=cH();const hH=$l(uH),dH=({centerMapFn:a,onShowSnackbar:l})=>{const m=gl(),{t:_}=Gl(),w=ue.useCallback(()=>{if(!a){l(_("mapNotLoadedYet"),"warning");return}navigator.geolocation?navigator.geolocation.getCurrentPosition(C=>{const{latitude:M,longitude:r}=C.coords;a([r,M],15),l(_("youAreHere"),"success")},C=>{console.error("Error getting user location:",C);let M=_("locationError"),r="error";C.code===C.PERMISSION_DENIED&&(M=_("locationPermissionDenied"),r="error"),l(M,r)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0}):l(_("geolocationNotSupported"),"error")},[a,l,_]);return Ne.jsx(Hl,{onClick:w,sx:{position:"absolute",opacity:.5,bottom:184,right:8,zIndex:1e3,backgroundColor:m.palette.background.paper,"&:hover":{backgroundColor:p0(m.palette.background.paper,.8)},boxShadow:m.shadows[3]},"aria-label":_("centerMap"),disabled:!a,children:Ne.jsx(hH,{})})},pH=ue.memo(function({landmarks:l,activeIndex:m,onMapMarkerClick:_,onMapClick:w,routeCoordinates:C,hasUserInteracted:M,isRouteVisible:r,onShowSnackbar:O,getLocalizedContentRef:V}){const{map:U,mapContainerRef:Z}=rH(),[ie,de]=ue.useState(!1),se=ue.useRef(w);ue.useEffect(()=>{se.current=w},[w]);const ne=ue.useCallback((ye,Le)=>{_(ye,Le)},[_]),Se=ue.useRef(null),me="user-location-circle",Re="user-location-circle-layer";return ue.useEffect(()=>{const ye=U;if(!ye){de(!1);return}const Le=()=>{de(!0)};ye.loaded()?Le():ye.on("load",Le),ye.getSource("landmarks-data")||(ye.addSource("landmarks-data",{type:"geojson",data:{type:"FeatureCollection",features:[]},cluster:!0,clusterMaxZoom:14,clusterRadius:50}),ye.addLayer({id:"clusters",type:"circle",source:"landmarks-data",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#ffbf00",100,"#f1f075",750,"#f28cb1"],"circle-radius":["step",["get","point_count"],20,100,30,750,40]}}),ye.addLayer({id:"cluster-count",type:"symbol",source:"landmarks-data",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"rgb(46, 46, 57)"}}),ye.on("click","clusters",Ge=>{var St;const et=ye.queryRenderedFeatures(Ge.point,{layers:["clusters"]}),mt=(St=et[0].properties)==null?void 0:St.cluster_id;ye.getSource("landmarks-data").getClusterExpansionZoom(mt,(xt,At)=>{xt||et[0].geometry.type==="Point"&&At!=null&&ye.easeTo({center:et[0].geometry.coordinates,zoom:At})})}),ye.on("mouseenter","clusters",()=>{ye.getCanvas().style.cursor="pointer"}),ye.on("mouseleave","clusters",()=>{ye.getCanvas().style.cursor=""})),ye.getSource("static-route")||(ye.addSource("static-route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),ye.addLayer({id:"static-route-line",type:"line",source:"static-route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#007bff","line-width":6,"line-opacity":.75}})),ye._controls.some(Ge=>Ge instanceof Cm.NavigationControl)||ye.addControl(new Cm.NavigationControl,"top-right");const De=()=>{se.current()};ye.on("click",De);const Oe=()=>{};ye.on("movestart",Oe);const Ee=Ge=>{const{latitude:et,longitude:mt,accuracy:St}=Ge.coords,xt=[mt,et];if(Se.current)Se.current.setLngLat(xt);else{const At=document.createElement("div");At.className="location-marker",At.style.width="12px",At.style.height="12px",At.style.borderRadius="50%",At.style.backgroundColor="blue",At.style.border="2px solid white",At.style.boxShadow="0 0 5px rgba(0,0,0,0.5)",Se.current=new Cm.Marker({element:At,anchor:"center"}).setLngLat(xt).addTo(ye)}ye.getSource(me)?ye.getSource(me).setData({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:xt},properties:{radius:St}}]}):(ye.addSource(me,{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:xt},properties:{radius:St}}]}}),ye.addLayer({id:Re,type:"circle",source:me,paint:{"circle-radius":["interpolate",["linear"],["zoom"],0,["/",["get","radius"],["literal",100]],20,["/",["get","radius"],["literal",1]]],"circle-color":"rgba(0, 128, 255, 0.4)","circle-stroke-color":"rgba(0, 128, 255, 0.8)","circle-stroke-width":1}}))},qe=Ge=>{};let $e;return navigator.geolocation&&($e=navigator.geolocation.watchPosition(Ee,qe,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})),()=>{ye.off("load",Le),ye.off("click",De),ye.off("movestart",Oe),ye.off("click","clusters"),ye.off("mouseenter","clusters"),ye.off("mouseleave","clusters"),$e!==void 0&&navigator.geolocation.clearWatch($e),Se.current&&(Se.current.remove(),Se.current=null);const Ge=mt=>{ye.getLayer(mt)&&ye.removeLayer(mt)},et=mt=>{ye.getSource(mt)&&ye.removeSource(mt)};if(Ge("cluster-count"),Ge("clusters"),et("landmarks-data"),Ge("static-route-line"),et("static-route"),ye.loaded())try{Ge(Re),et(me)}catch{}de(!1)}},[U]),ue.useEffect(()=>{if(!ie||!U)return;const ye=U.getSource("landmarks-data");if(ye){const Le=l.map((De,Oe)=>({type:"Feature",properties:{originalIndex:Oe,category:De.category&&De.category.length>0?De.category[0]:"default"},geometry:{type:"Point",coordinates:[De.coordinates[1],De.coordinates[0]]}}));ye.setData({type:"FeatureCollection",features:Le})}},[l,ie,U]),ue.useEffect(()=>{if(!ie||!U)return;const Le=U.getSource("static-route");if(Le){const De={type:"Feature",properties:{},geometry:{type:"LineString",coordinates:r&&C&&C.length>1?C:[]}};Le.setData(De)}},[C,r,ie,U]),ue.useEffect(()=>{if(!U||m===null||!ie)return;const ye=l[m];if(ye){const[Le,De]=ye.coordinates,Oe=[De,Le];U.easeTo({center:Oe,zoom:U.getZoom(),duration:800})}},[m,l,U,ie]),Ne.jsxs(Ne.Fragment,{children:[Ne.jsx("div",{ref:Z,style:{height:"100%",width:"100%"}}),ie&&U&&Ne.jsx(lH,{map:U,landmarks:l,activeIndex:m,onMapMarkerClick:ne,hasUserInteracted:M,getLocalizedContent:V.current}),ie&&U&&Ne.jsx(dH,{centerMapFn:(ye,Le)=>{U.easeTo({center:ye,zoom:Le||U.getZoom(),duration:800})},onShowSnackbar:O})]})}),fH=({open:a,message:l,type:m,onClose:_})=>{const w=Ne.jsx(Hl,{size:"small","aria-label":"close",color:"inherit",onClick:_,children:Ne.jsx(Nm,{fontSize:"small"})}),C=M=>{switch(M){case"welcome":return"#ffbf00";case"error":return"#d32f2f";case"info":return"#ffbf00";case"success":return"#ffbf00";case"warning":return"#ff9800";default:return"#323232"}};return Ne.jsx(GN,{sx:{zIndex:1001,top:72},open:a,autoHideDuration:1e4,onClose:_,message:l,action:w,anchorOrigin:{vertical:"top",horizontal:"center"},ContentProps:{sx:{backgroundColor:C(m)}}})},mH=()=>{const[a,l]=ue.useState(!1),[m,_]=ue.useState(""),[w,C]=ue.useState(null),M=ue.useRef(null),r=ue.useCallback((U,Z="info")=>{M.current&&clearTimeout(M.current),l(!1),_(U||""),C(Z),M.current=setTimeout(()=>{l(!0)},200)},[]),O=ue.useCallback((U,Z)=>{Z!=="clickaway"&&(l(!1),_(""),C(null),M.current&&(clearTimeout(M.current),M.current=null))},[]);return{openSnackbar:a,snackbarMessage:m,snackbarType:w,handleOpenSnackbar:r,handleCloseSnackbar:O,snackbarAction:Ne.jsx(Hl,{size:"small","aria-label":"close",color:"inherit",onClick:O,children:Ne.jsx(Nm,{fontSize:"small"})})}};function VC(){const{t:a,i18n:l}=Gl(),m=iR(),{slug:_,lang:w}=sR(),{openSnackbar:C,snackbarMessage:M,snackbarType:r,handleOpenSnackbar:O,handleCloseSnackbar:V}=mH(),[U,Z]=ue.useState(["museum","food-drinks","art-galleries","clubs"]),ie=ue.useCallback(mt=>{Z(mt)},[]),[de,se]=ue.useState([]),[ne,Se]=ue.useState(!0),me=ue.useCallback(()=>{Se(mt=>!mt)},[]),Re=ue.useCallback(mt=>{const St=l.language;return St==="ru"&&mt.ru?mt.ru:St==="es"&&mt.es?mt.es:St==="fr"&&mt.fr?mt.fr:St==="vn"&&mt.vn?mt.vn:mt.en},[l.language]),ye=ue.useRef(Re);ue.useEffect(()=>{ye.current=Re},[Re]);const Le=ue.useMemo(()=>zC.filter(mt=>mt.category.some(St=>U.includes(St))),[U]),De=ue.useMemo(()=>Le.map(mt=>({...mt,localizedContent:Re(mt)})),[Le,Re]),[Oe,Ee]=ue.useState(null),[qe,$e]=ue.useState(!1);ue.useEffect(()=>{w&&l.language!==w&&l.changeLanguage(w)},[w,l]),ue.useEffect(()=>{if(se([]),_){const mt=zC.findIndex(St=>Object.values(St.slug).includes(_));mt!==-1&&(Ee(mt),$e(!0))}},[_]);const Ge=ue.useCallback(mt=>{const St=Le[mt];if(!St)return;Ee(mt),$e(!0);const xt=l.language,At=St.slug[xt];At?m(`/${l.language}/${At}`,{replace:!0}):console.error(`Slug for language '${xt}' not found.`)},[Ee,$e,Le,m,l.language]),et=ue.useCallback(()=>{l.isInitialized?O(a("swiperWelcomeSubtitle"),"info"):console.warn("i18n not initialized, cannot translate map click message."),Ee(null),m("/",{replace:!0})},[O,a,l.isInitialized,m]);return Ne.jsxs($s,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column"},children:[Ne.jsx(e4,{onSelectCategories:ie,selectedCategorySlugs:U,toggleRouteVisibility:me,isRouteVisible:ne}),Ne.jsx($s,{sx:{flexGrow:1,minHeight:0,position:"absolute",height:"100%",width:"100%",overflow:"hidden"},children:Ne.jsx(pH,{landmarks:Le,activeIndex:Oe,onMapMarkerClick:Ge,onMapClick:et,routeCoordinates:de,hasUserInteracted:qe,isRouteVisible:ne,onShowSnackbar:O,getLocalizedContentRef:ye})}),Ne.jsx(Jq,{selectedCategorySlugs:U,filteredLandmarks:De,activeIndex:Oe,setActiveIndex:Ee,setHasUserInteracted:$e,hasInteractedWithMarkers:qe,getLocalizedContent:Re,onShowSnackbar:O}),Ne.jsx(fH,{open:C,message:M,type:r,onClose:V})]})}function gH(){return Ne.jsxs(bR,{children:[Ne.jsx(o0,{path:"/",element:Ne.jsx(VC,{})}),Ne.jsx(o0,{path:"/:lang/:slug",element:Ne.jsx(VC,{})})]})}const Gi=a=>typeof a=="string",Zg=()=>{let a,l;const m=new Promise((_,w)=>{a=_,l=w});return m.resolve=a,m.reject=l,m},qC=a=>a==null?"":""+a,_H=(a,l,m)=>{a.forEach(_=>{l[_]&&(m[_]=l[_])})},yH=/###/g,HC=a=>a&&a.indexOf("###")>-1?a.replace(yH,"."):a,UC=a=>!a||Gi(a),t_=(a,l,m)=>{const _=Gi(l)?l.split("."):l;let w=0;for(;w<_.length-1;){if(UC(a))return{};const C=HC(_[w]);!a[C]&&m&&(a[C]=new m),Object.prototype.hasOwnProperty.call(a,C)?a=a[C]:a={},++w}return UC(a)?{}:{obj:a,k:HC(_[w])}},$C=(a,l,m)=>{const{obj:_,k:w}=t_(a,l,Object);if(_!==void 0||l.length===1){_[w]=m;return}let C=l[l.length-1],M=l.slice(0,l.length-1),r=t_(a,M,Object);for(;r.obj===void 0&&M.length;)C=`${M[M.length-1]}.${C}`,M=M.slice(0,M.length-1),r=t_(a,M,Object),r!=null&&r.obj&&typeof r.obj[`${r.k}.${C}`]<"u"&&(r.obj=void 0);r.obj[`${r.k}.${C}`]=m},vH=(a,l,m,_)=>{const{obj:w,k:C}=t_(a,l,Object);w[C]=w[C]||[],w[C].push(m)},Ny=(a,l)=>{const{obj:m,k:_}=t_(a,l);if(m&&Object.prototype.hasOwnProperty.call(m,_))return m[_]},xH=(a,l,m)=>{const _=Ny(a,m);return _!==void 0?_:Ny(l,m)},aI=(a,l,m)=>{for(const _ in l)_!=="__proto__"&&_!=="constructor"&&(_ in a?Gi(a[_])||a[_]instanceof String||Gi(l[_])||l[_]instanceof String?m&&(a[_]=l[_]):aI(a[_],l[_],m):a[_]=l[_]);return a},_m=a=>a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var bH={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const wH=a=>Gi(a)?a.replace(/[&<>"'\/]/g,l=>bH[l]):a;class TH{constructor(l){this.capacity=l,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(l){const m=this.regExpMap.get(l);if(m!==void 0)return m;const _=new RegExp(l);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(l,_),this.regExpQueue.push(l),_}}const SH=[" ",",","?","!",";"],CH=new TH(20),EH=(a,l,m)=>{l=l||"",m=m||"";const _=SH.filter(M=>l.indexOf(M)<0&&m.indexOf(M)<0);if(_.length===0)return!0;const w=CH.getRegExp(`(${_.map(M=>M==="?"?"\\?":M).join("|")})`);let C=!w.test(a);if(!C){const M=a.indexOf(m);M>0&&!w.test(a.substring(0,M))&&(C=!0)}return C},k0=(a,l,m=".")=>{if(!a)return;if(a[l])return Object.prototype.hasOwnProperty.call(a,l)?a[l]:void 0;const _=l.split(m);let w=a;for(let C=0;C<_.length;){if(!w||typeof w!="object")return;let M,r="";for(let O=C;O<_.length;++O)if(O!==C&&(r+=m),r+=_[O],M=w[r],M!==void 0){if(["string","number","boolean"].indexOf(typeof M)>-1&&O<_.length-1)continue;C+=O-C+1;break}w=M}return w},u_=a=>a==null?void 0:a.replace("_","-"),AH={type:"logger",log(a){this.output("log",a)},warn(a){this.output("warn",a)},error(a){this.output("error",a)},output(a,l){var m,_;(_=(m=console==null?void 0:console[a])==null?void 0:m.apply)==null||_.call(m,console,l)}};class Vy{constructor(l,m={}){this.init(l,m)}init(l,m={}){this.prefix=m.prefix||"i18next:",this.logger=l||AH,this.options=m,this.debug=m.debug}log(...l){return this.forward(l,"log","",!0)}warn(...l){return this.forward(l,"warn","",!0)}error(...l){return this.forward(l,"error","")}deprecate(...l){return this.forward(l,"warn","WARNING DEPRECATED: ",!0)}forward(l,m,_,w){return w&&!this.debug?null:(Gi(l[0])&&(l[0]=`${_}${this.prefix} ${l[0]}`),this.logger[m](l))}create(l){return new Vy(this.logger,{prefix:`${this.prefix}:${l}:`,...this.options})}clone(l){return l=l||this.options,l.prefix=l.prefix||this.prefix,new Vy(this.logger,l)}}var vh=new Vy;class hv{constructor(){this.observers={}}on(l,m){return l.split(" ").forEach(_=>{this.observers[_]||(this.observers[_]=new Map);const w=this.observers[_].get(m)||0;this.observers[_].set(m,w+1)}),this}off(l,m){if(this.observers[l]){if(!m){delete this.observers[l];return}this.observers[l].delete(m)}}emit(l,...m){this.observers[l]&&Array.from(this.observers[l].entries()).forEach(([w,C])=>{for(let M=0;M<C;M++)w(...m)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([w,C])=>{for(let M=0;M<C;M++)w.apply(w,[l,...m])})}}class GC extends hv{constructor(l,m={ns:["translation"],defaultNS:"translation"}){super(),this.data=l||{},this.options=m,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(l){this.options.ns.indexOf(l)<0&&this.options.ns.push(l)}removeNamespaces(l){const m=this.options.ns.indexOf(l);m>-1&&this.options.ns.splice(m,1)}getResource(l,m,_,w={}){var V,U;const C=w.keySeparator!==void 0?w.keySeparator:this.options.keySeparator,M=w.ignoreJSONStructure!==void 0?w.ignoreJSONStructure:this.options.ignoreJSONStructure;let r;l.indexOf(".")>-1?r=l.split("."):(r=[l,m],_&&(Array.isArray(_)?r.push(..._):Gi(_)&&C?r.push(..._.split(C)):r.push(_)));const O=Ny(this.data,r);return!O&&!m&&!_&&l.indexOf(".")>-1&&(l=r[0],m=r[1],_=r.slice(2).join(".")),O||!M||!Gi(_)?O:k0((U=(V=this.data)==null?void 0:V[l])==null?void 0:U[m],_,C)}addResource(l,m,_,w,C={silent:!1}){const M=C.keySeparator!==void 0?C.keySeparator:this.options.keySeparator;let r=[l,m];_&&(r=r.concat(M?_.split(M):_)),l.indexOf(".")>-1&&(r=l.split("."),w=m,m=r[1]),this.addNamespaces(m),$C(this.data,r,w),C.silent||this.emit("added",l,m,_,w)}addResources(l,m,_,w={silent:!1}){for(const C in _)(Gi(_[C])||Array.isArray(_[C]))&&this.addResource(l,m,C,_[C],{silent:!0});w.silent||this.emit("added",l,m,_)}addResourceBundle(l,m,_,w,C,M={silent:!1,skipCopy:!1}){let r=[l,m];l.indexOf(".")>-1&&(r=l.split("."),w=_,_=m,m=r[1]),this.addNamespaces(m);let O=Ny(this.data,r)||{};M.skipCopy||(_=JSON.parse(JSON.stringify(_))),w?aI(O,_,C):O={...O,..._},$C(this.data,r,O),M.silent||this.emit("added",l,m,_)}removeResourceBundle(l,m){this.hasResourceBundle(l,m)&&delete this.data[l][m],this.removeNamespaces(m),this.emit("removed",l,m)}hasResourceBundle(l,m){return this.getResource(l,m)!==void 0}getResourceBundle(l,m){return m||(m=this.options.defaultNS),this.getResource(l,m)}getDataByLanguage(l){return this.data[l]}hasLanguageSomeTranslations(l){const m=this.getDataByLanguage(l);return!!(m&&Object.keys(m)||[]).find(w=>m[w]&&Object.keys(m[w]).length>0)}toJSON(){return this.data}}var lI={processors:{},addPostProcessor(a){this.processors[a.name]=a},handle(a,l,m,_,w){return a.forEach(C=>{var M;l=((M=this.processors[C])==null?void 0:M.process(l,m,_,w))??l}),l}};const WC={},ZC=a=>!Gi(a)&&typeof a!="boolean"&&typeof a!="number";class qy extends hv{constructor(l,m={}){super(),_H(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],l,this),this.options=m,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=vh.create("translator")}changeLanguage(l){l&&(this.language=l)}exists(l,m={interpolation:{}}){const _={...m};if(l==null)return!1;const w=this.resolve(l,_);return(w==null?void 0:w.res)!==void 0}extractFromKey(l,m){let _=m.nsSeparator!==void 0?m.nsSeparator:this.options.nsSeparator;_===void 0&&(_=":");const w=m.keySeparator!==void 0?m.keySeparator:this.options.keySeparator;let C=m.ns||this.options.defaultNS||[];const M=_&&l.indexOf(_)>-1,r=!this.options.userDefinedKeySeparator&&!m.keySeparator&&!this.options.userDefinedNsSeparator&&!m.nsSeparator&&!EH(l,_,w);if(M&&!r){const O=l.match(this.interpolator.nestingRegexp);if(O&&O.length>0)return{key:l,namespaces:Gi(C)?[C]:C};const V=l.split(_);(_!==w||_===w&&this.options.ns.indexOf(V[0])>-1)&&(C=V.shift()),l=V.join(w)}return{key:l,namespaces:Gi(C)?[C]:C}}translate(l,m,_){let w=typeof m=="object"?{...m}:m;if(typeof w!="object"&&this.options.overloadTranslationOptionHandler&&(w=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(w={...w}),w||(w={}),l==null)return"";Array.isArray(l)||(l=[String(l)]);const C=w.returnDetails!==void 0?w.returnDetails:this.options.returnDetails,M=w.keySeparator!==void 0?w.keySeparator:this.options.keySeparator,{key:r,namespaces:O}=this.extractFromKey(l[l.length-1],w),V=O[O.length-1];let U=w.nsSeparator!==void 0?w.nsSeparator:this.options.nsSeparator;U===void 0&&(U=":");const Z=w.lng||this.language,ie=w.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((Z==null?void 0:Z.toLowerCase())==="cimode")return ie?C?{res:`${V}${U}${r}`,usedKey:r,exactUsedKey:r,usedLng:Z,usedNS:V,usedParams:this.getUsedParamsDetails(w)}:`${V}${U}${r}`:C?{res:r,usedKey:r,exactUsedKey:r,usedLng:Z,usedNS:V,usedParams:this.getUsedParamsDetails(w)}:r;const de=this.resolve(l,w);let se=de==null?void 0:de.res;const ne=(de==null?void 0:de.usedKey)||r,Se=(de==null?void 0:de.exactUsedKey)||r,me=["[object Number]","[object Function]","[object RegExp]"],Re=w.joinArrays!==void 0?w.joinArrays:this.options.joinArrays,ye=!this.i18nFormat||this.i18nFormat.handleAsObject,Le=w.count!==void 0&&!Gi(w.count),De=qy.hasDefaultValue(w),Oe=Le?this.pluralResolver.getSuffix(Z,w.count,w):"",Ee=w.ordinal&&Le?this.pluralResolver.getSuffix(Z,w.count,{ordinal:!1}):"",qe=Le&&!w.ordinal&&w.count===0,$e=qe&&w[`defaultValue${this.options.pluralSeparator}zero`]||w[`defaultValue${Oe}`]||w[`defaultValue${Ee}`]||w.defaultValue;let Ge=se;ye&&!se&&De&&(Ge=$e);const et=ZC(Ge),mt=Object.prototype.toString.apply(Ge);if(ye&&Ge&&et&&me.indexOf(mt)<0&&!(Gi(Re)&&Array.isArray(Ge))){if(!w.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const St=this.options.returnedObjectHandler?this.options.returnedObjectHandler(ne,Ge,{...w,ns:O}):`key '${r} (${this.language})' returned an object instead of string.`;return C?(de.res=St,de.usedParams=this.getUsedParamsDetails(w),de):St}if(M){const St=Array.isArray(Ge),xt=St?[]:{},At=St?Se:ne;for(const Ct in Ge)if(Object.prototype.hasOwnProperty.call(Ge,Ct)){const Ut=`${At}${M}${Ct}`;De&&!se?xt[Ct]=this.translate(Ut,{...w,defaultValue:ZC($e)?$e[Ct]:void 0,joinArrays:!1,ns:O}):xt[Ct]=this.translate(Ut,{...w,joinArrays:!1,ns:O}),xt[Ct]===Ut&&(xt[Ct]=Ge[Ct])}se=xt}}else if(ye&&Gi(Re)&&Array.isArray(se))se=se.join(Re),se&&(se=this.extendTranslation(se,l,w,_));else{let St=!1,xt=!1;!this.isValidLookup(se)&&De&&(St=!0,se=$e),this.isValidLookup(se)||(xt=!0,se=r);const Ct=(w.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&xt?void 0:se,Ut=De&&$e!==se&&this.options.updateMissing;if(xt||St||Ut){if(this.logger.log(Ut?"updateKey":"missingKey",Z,V,r,Ut?$e:se),M){const lt=this.resolve(r,{...w,keySeparator:!1});lt&&lt.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let at=[];const kt=this.languageUtils.getFallbackCodes(this.options.fallbackLng,w.lng||this.language);if(this.options.saveMissingTo==="fallback"&&kt&&kt[0])for(let lt=0;lt<kt.length;lt++)at.push(kt[lt]);else this.options.saveMissingTo==="all"?at=this.languageUtils.toResolveHierarchy(w.lng||this.language):at.push(w.lng||this.language);const qt=(lt,Ht,Nn)=>{var xn;const zn=De&&Nn!==se?Nn:Ct;this.options.missingKeyHandler?this.options.missingKeyHandler(lt,V,Ht,zn,Ut,w):(xn=this.backendConnector)!=null&&xn.saveMissing&&this.backendConnector.saveMissing(lt,V,Ht,zn,Ut,w),this.emit("missingKey",lt,V,Ht,se)};this.options.saveMissing&&(this.options.saveMissingPlurals&&Le?at.forEach(lt=>{const Ht=this.pluralResolver.getSuffixes(lt,w);qe&&w[`defaultValue${this.options.pluralSeparator}zero`]&&Ht.indexOf(`${this.options.pluralSeparator}zero`)<0&&Ht.push(`${this.options.pluralSeparator}zero`),Ht.forEach(Nn=>{qt([lt],r+Nn,w[`defaultValue${Nn}`]||$e)})}):qt(at,r,$e))}se=this.extendTranslation(se,l,w,de,_),xt&&se===r&&this.options.appendNamespaceToMissingKey&&(se=`${V}${U}${r}`),(xt||St)&&this.options.parseMissingKeyHandler&&(se=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${V}${U}${r}`:r,St?se:void 0,w))}return C?(de.res=se,de.usedParams=this.getUsedParamsDetails(w),de):se}extendTranslation(l,m,_,w,C){var O,V;if((O=this.i18nFormat)!=null&&O.parse)l=this.i18nFormat.parse(l,{...this.options.interpolation.defaultVariables,..._},_.lng||this.language||w.usedLng,w.usedNS,w.usedKey,{resolved:w});else if(!_.skipInterpolation){_.interpolation&&this.interpolator.init({..._,interpolation:{...this.options.interpolation,..._.interpolation}});const U=Gi(l)&&(((V=_==null?void 0:_.interpolation)==null?void 0:V.skipOnVariables)!==void 0?_.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let Z;if(U){const de=l.match(this.interpolator.nestingRegexp);Z=de&&de.length}let ie=_.replace&&!Gi(_.replace)?_.replace:_;if(this.options.interpolation.defaultVariables&&(ie={...this.options.interpolation.defaultVariables,...ie}),l=this.interpolator.interpolate(l,ie,_.lng||this.language||w.usedLng,_),U){const de=l.match(this.interpolator.nestingRegexp),se=de&&de.length;Z<se&&(_.nest=!1)}!_.lng&&w&&w.res&&(_.lng=this.language||w.usedLng),_.nest!==!1&&(l=this.interpolator.nest(l,(...de)=>(C==null?void 0:C[0])===de[0]&&!_.context?(this.logger.warn(`It seems you are nesting recursively key: ${de[0]} in key: ${m[0]}`),null):this.translate(...de,m),_)),_.interpolation&&this.interpolator.reset()}const M=_.postProcess||this.options.postProcess,r=Gi(M)?[M]:M;return l!=null&&(r!=null&&r.length)&&_.applyPostProcessor!==!1&&(l=lI.handle(r,l,m,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...w,usedParams:this.getUsedParamsDetails(_)},..._}:_,this)),l}resolve(l,m={}){let _,w,C,M,r;return Gi(l)&&(l=[l]),l.forEach(O=>{if(this.isValidLookup(_))return;const V=this.extractFromKey(O,m),U=V.key;w=U;let Z=V.namespaces;this.options.fallbackNS&&(Z=Z.concat(this.options.fallbackNS));const ie=m.count!==void 0&&!Gi(m.count),de=ie&&!m.ordinal&&m.count===0,se=m.context!==void 0&&(Gi(m.context)||typeof m.context=="number")&&m.context!=="",ne=m.lngs?m.lngs:this.languageUtils.toResolveHierarchy(m.lng||this.language,m.fallbackLng);Z.forEach(Se=>{var me,Re;this.isValidLookup(_)||(r=Se,!WC[`${ne[0]}-${Se}`]&&((me=this.utils)!=null&&me.hasLoadedNamespace)&&!((Re=this.utils)!=null&&Re.hasLoadedNamespace(r))&&(WC[`${ne[0]}-${Se}`]=!0,this.logger.warn(`key "${w}" for languages "${ne.join(", ")}" won't get resolved as namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),ne.forEach(ye=>{var Oe;if(this.isValidLookup(_))return;M=ye;const Le=[U];if((Oe=this.i18nFormat)!=null&&Oe.addLookupKeys)this.i18nFormat.addLookupKeys(Le,U,ye,Se,m);else{let Ee;ie&&(Ee=this.pluralResolver.getSuffix(ye,m.count,m));const qe=`${this.options.pluralSeparator}zero`,$e=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(ie&&(Le.push(U+Ee),m.ordinal&&Ee.indexOf($e)===0&&Le.push(U+Ee.replace($e,this.options.pluralSeparator)),de&&Le.push(U+qe)),se){const Ge=`${U}${this.options.contextSeparator}${m.context}`;Le.push(Ge),ie&&(Le.push(Ge+Ee),m.ordinal&&Ee.indexOf($e)===0&&Le.push(Ge+Ee.replace($e,this.options.pluralSeparator)),de&&Le.push(Ge+qe))}}let De;for(;De=Le.pop();)this.isValidLookup(_)||(C=De,_=this.getResource(ye,Se,De,m))}))})}),{res:_,usedKey:w,exactUsedKey:C,usedLng:M,usedNS:r}}isValidLookup(l){return l!==void 0&&!(!this.options.returnNull&&l===null)&&!(!this.options.returnEmptyString&&l==="")}getResource(l,m,_,w={}){var C;return(C=this.i18nFormat)!=null&&C.getResource?this.i18nFormat.getResource(l,m,_,w):this.resourceStore.getResource(l,m,_,w)}getUsedParamsDetails(l={}){const m=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],_=l.replace&&!Gi(l.replace);let w=_?l.replace:l;if(_&&typeof l.count<"u"&&(w.count=l.count),this.options.interpolation.defaultVariables&&(w={...this.options.interpolation.defaultVariables,...w}),!_){w={...w};for(const C of m)delete w[C]}return w}static hasDefaultValue(l){const m="defaultValue";for(const _ in l)if(Object.prototype.hasOwnProperty.call(l,_)&&m===_.substring(0,m.length)&&l[_]!==void 0)return!0;return!1}}class KC{constructor(l){this.options=l,this.supportedLngs=this.options.supportedLngs||!1,this.logger=vh.create("languageUtils")}getScriptPartFromCode(l){if(l=u_(l),!l||l.indexOf("-")<0)return null;const m=l.split("-");return m.length===2||(m.pop(),m[m.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(m.join("-"))}getLanguagePartFromCode(l){if(l=u_(l),!l||l.indexOf("-")<0)return l;const m=l.split("-");return this.formatLanguageCode(m[0])}formatLanguageCode(l){if(Gi(l)&&l.indexOf("-")>-1){let m;try{m=Intl.getCanonicalLocales(l)[0]}catch{}return m&&this.options.lowerCaseLng&&(m=m.toLowerCase()),m||(this.options.lowerCaseLng?l.toLowerCase():l)}return this.options.cleanCode||this.options.lowerCaseLng?l.toLowerCase():l}isSupportedCode(l){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(l=this.getLanguagePartFromCode(l)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(l)>-1}getBestMatchFromCodes(l){if(!l)return null;let m;return l.forEach(_=>{if(m)return;const w=this.formatLanguageCode(_);(!this.options.supportedLngs||this.isSupportedCode(w))&&(m=w)}),!m&&this.options.supportedLngs&&l.forEach(_=>{if(m)return;const w=this.getScriptPartFromCode(_);if(this.isSupportedCode(w))return m=w;const C=this.getLanguagePartFromCode(_);if(this.isSupportedCode(C))return m=C;m=this.options.supportedLngs.find(M=>{if(M===C)return M;if(!(M.indexOf("-")<0&&C.indexOf("-")<0)&&(M.indexOf("-")>0&&C.indexOf("-")<0&&M.substring(0,M.indexOf("-"))===C||M.indexOf(C)===0&&C.length>1))return M})}),m||(m=this.getFallbackCodes(this.options.fallbackLng)[0]),m}getFallbackCodes(l,m){if(!l)return[];if(typeof l=="function"&&(l=l(m)),Gi(l)&&(l=[l]),Array.isArray(l))return l;if(!m)return l.default||[];let _=l[m];return _||(_=l[this.getScriptPartFromCode(m)]),_||(_=l[this.formatLanguageCode(m)]),_||(_=l[this.getLanguagePartFromCode(m)]),_||(_=l.default),_||[]}toResolveHierarchy(l,m){const _=this.getFallbackCodes((m===!1?[]:m)||this.options.fallbackLng||[],l),w=[],C=M=>{M&&(this.isSupportedCode(M)?w.push(M):this.logger.warn(`rejecting language code not found in supportedLngs: ${M}`))};return Gi(l)&&(l.indexOf("-")>-1||l.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&C(this.formatLanguageCode(l)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&C(this.getScriptPartFromCode(l)),this.options.load!=="currentOnly"&&C(this.getLanguagePartFromCode(l))):Gi(l)&&C(this.formatLanguageCode(l)),_.forEach(M=>{w.indexOf(M)<0&&C(this.formatLanguageCode(M))}),w}}const XC={zero:0,one:1,two:2,few:3,many:4,other:5},YC={select:a=>a===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class IH{constructor(l,m={}){this.languageUtils=l,this.options=m,this.logger=vh.create("pluralResolver"),this.pluralRulesCache={}}addRule(l,m){this.rules[l]=m}clearCache(){this.pluralRulesCache={}}getRule(l,m={}){const _=u_(l==="dev"?"en":l),w=m.ordinal?"ordinal":"cardinal",C=JSON.stringify({cleanedCode:_,type:w});if(C in this.pluralRulesCache)return this.pluralRulesCache[C];let M;try{M=new Intl.PluralRules(_,{type:w})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),YC;if(!l.match(/-|_/))return YC;const O=this.languageUtils.getLanguagePartFromCode(l);M=this.getRule(O,m)}return this.pluralRulesCache[C]=M,M}needsPlural(l,m={}){let _=this.getRule(l,m);return _||(_=this.getRule("dev",m)),(_==null?void 0:_.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(l,m,_={}){return this.getSuffixes(l,_).map(w=>`${m}${w}`)}getSuffixes(l,m={}){let _=this.getRule(l,m);return _||(_=this.getRule("dev",m)),_?_.resolvedOptions().pluralCategories.sort((w,C)=>XC[w]-XC[C]).map(w=>`${this.options.prepend}${m.ordinal?`ordinal${this.options.prepend}`:""}${w}`):[]}getSuffix(l,m,_={}){const w=this.getRule(l,_);return w?`${this.options.prepend}${_.ordinal?`ordinal${this.options.prepend}`:""}${w.select(m)}`:(this.logger.warn(`no plural rule found for: ${l}`),this.getSuffix("dev",m,_))}}const QC=(a,l,m,_=".",w=!0)=>{let C=xH(a,l,m);return!C&&w&&Gi(m)&&(C=k0(a,m,_),C===void 0&&(C=k0(l,m,_))),C},r0=a=>a.replace(/\$/g,"$$$$");class PH{constructor(l={}){var m;this.logger=vh.create("interpolator"),this.options=l,this.format=((m=l==null?void 0:l.interpolation)==null?void 0:m.format)||(_=>_),this.init(l)}init(l={}){l.interpolation||(l.interpolation={escapeValue:!0});const{escape:m,escapeValue:_,useRawValueToEscape:w,prefix:C,prefixEscaped:M,suffix:r,suffixEscaped:O,formatSeparator:V,unescapeSuffix:U,unescapePrefix:Z,nestingPrefix:ie,nestingPrefixEscaped:de,nestingSuffix:se,nestingSuffixEscaped:ne,nestingOptionsSeparator:Se,maxReplaces:me,alwaysFormat:Re}=l.interpolation;this.escape=m!==void 0?m:wH,this.escapeValue=_!==void 0?_:!0,this.useRawValueToEscape=w!==void 0?w:!1,this.prefix=C?_m(C):M||"{{",this.suffix=r?_m(r):O||"}}",this.formatSeparator=V||",",this.unescapePrefix=U?"":Z||"-",this.unescapeSuffix=this.unescapePrefix?"":U||"",this.nestingPrefix=ie?_m(ie):de||_m("$t("),this.nestingSuffix=se?_m(se):ne||_m(")"),this.nestingOptionsSeparator=Se||",",this.maxReplaces=me||1e3,this.alwaysFormat=Re!==void 0?Re:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const l=(m,_)=>(m==null?void 0:m.source)===_?(m.lastIndex=0,m):new RegExp(_,"g");this.regexp=l(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=l(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=l(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(l,m,_,w){var de;let C,M,r;const O=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},V=se=>{if(se.indexOf(this.formatSeparator)<0){const Re=QC(m,O,se,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(Re,void 0,_,{...w,...m,interpolationkey:se}):Re}const ne=se.split(this.formatSeparator),Se=ne.shift().trim(),me=ne.join(this.formatSeparator).trim();return this.format(QC(m,O,Se,this.options.keySeparator,this.options.ignoreJSONStructure),me,_,{...w,...m,interpolationkey:Se})};this.resetRegExp();const U=(w==null?void 0:w.missingInterpolationHandler)||this.options.missingInterpolationHandler,Z=((de=w==null?void 0:w.interpolation)==null?void 0:de.skipOnVariables)!==void 0?w.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:se=>r0(se)},{regex:this.regexp,safeValue:se=>this.escapeValue?r0(this.escape(se)):r0(se)}].forEach(se=>{for(r=0;C=se.regex.exec(l);){const ne=C[1].trim();if(M=V(ne),M===void 0)if(typeof U=="function"){const me=U(l,C,w);M=Gi(me)?me:""}else if(w&&Object.prototype.hasOwnProperty.call(w,ne))M="";else if(Z){M=C[0];continue}else this.logger.warn(`missed to pass in variable ${ne} for interpolating ${l}`),M="";else!Gi(M)&&!this.useRawValueToEscape&&(M=qC(M));const Se=se.safeValue(M);if(l=l.replace(C[0],Se),Z?(se.regex.lastIndex+=M.length,se.regex.lastIndex-=C[0].length):se.regex.lastIndex=0,r++,r>=this.maxReplaces)break}}),l}nest(l,m,_={}){let w,C,M;const r=(O,V)=>{const U=this.nestingOptionsSeparator;if(O.indexOf(U)<0)return O;const Z=O.split(new RegExp(`${U}[ ]*{`));let ie=`{${Z[1]}`;O=Z[0],ie=this.interpolate(ie,M);const de=ie.match(/'/g),se=ie.match(/"/g);(((de==null?void 0:de.length)??0)%2===0&&!se||se.length%2!==0)&&(ie=ie.replace(/'/g,'"'));try{M=JSON.parse(ie),V&&(M={...V,...M})}catch(ne){return this.logger.warn(`failed parsing options string in nesting for key ${O}`,ne),`${O}${U}${ie}`}return M.defaultValue&&M.defaultValue.indexOf(this.prefix)>-1&&delete M.defaultValue,O};for(;w=this.nestingRegexp.exec(l);){let O=[];M={..._},M=M.replace&&!Gi(M.replace)?M.replace:M,M.applyPostProcessor=!1,delete M.defaultValue;const V=/{.*}/.test(w[1])?w[1].lastIndexOf("}")+1:w[1].indexOf(this.formatSeparator);if(V!==-1&&(O=w[1].slice(V).split(this.formatSeparator).map(U=>U.trim()).filter(Boolean),w[1]=w[1].slice(0,V)),C=m(r.call(this,w[1].trim(),M),M),C&&w[0]===l&&!Gi(C))return C;Gi(C)||(C=qC(C)),C||(this.logger.warn(`missed to resolve ${w[1]} for nesting ${l}`),C=""),O.length&&(C=O.reduce((U,Z)=>this.format(U,Z,_.lng,{..._,interpolationkey:w[1].trim()}),C.trim())),l=l.replace(w[0],C),this.regexp.lastIndex=0}return l}}const kH=a=>{let l=a.toLowerCase().trim();const m={};if(a.indexOf("(")>-1){const _=a.split("(");l=_[0].toLowerCase().trim();const w=_[1].substring(0,_[1].length-1);l==="currency"&&w.indexOf(":")<0?m.currency||(m.currency=w.trim()):l==="relativetime"&&w.indexOf(":")<0?m.range||(m.range=w.trim()):w.split(";").forEach(M=>{if(M){const[r,...O]=M.split(":"),V=O.join(":").trim().replace(/^'+|'+$/g,""),U=r.trim();m[U]||(m[U]=V),V==="false"&&(m[U]=!1),V==="true"&&(m[U]=!0),isNaN(V)||(m[U]=parseInt(V,10))}})}return{formatName:l,formatOptions:m}},JC=a=>{const l={};return(m,_,w)=>{let C=w;w&&w.interpolationkey&&w.formatParams&&w.formatParams[w.interpolationkey]&&w[w.interpolationkey]&&(C={...C,[w.interpolationkey]:void 0});const M=_+JSON.stringify(C);let r=l[M];return r||(r=a(u_(_),w),l[M]=r),r(m)}},MH=a=>(l,m,_)=>a(u_(m),_)(l);class RH{constructor(l={}){this.logger=vh.create("formatter"),this.options=l,this.init(l)}init(l,m={interpolation:{}}){this.formatSeparator=m.interpolation.formatSeparator||",";const _=m.cacheInBuiltFormats?JC:MH;this.formats={number:_((w,C)=>{const M=new Intl.NumberFormat(w,{...C});return r=>M.format(r)}),currency:_((w,C)=>{const M=new Intl.NumberFormat(w,{...C,style:"currency"});return r=>M.format(r)}),datetime:_((w,C)=>{const M=new Intl.DateTimeFormat(w,{...C});return r=>M.format(r)}),relativetime:_((w,C)=>{const M=new Intl.RelativeTimeFormat(w,{...C});return r=>M.format(r,C.range||"day")}),list:_((w,C)=>{const M=new Intl.ListFormat(w,{...C});return r=>M.format(r)})}}add(l,m){this.formats[l.toLowerCase().trim()]=m}addCached(l,m){this.formats[l.toLowerCase().trim()]=JC(m)}format(l,m,_,w={}){const C=m.split(this.formatSeparator);if(C.length>1&&C[0].indexOf("(")>1&&C[0].indexOf(")")<0&&C.find(r=>r.indexOf(")")>-1)){const r=C.findIndex(O=>O.indexOf(")")>-1);C[0]=[C[0],...C.splice(1,r)].join(this.formatSeparator)}return C.reduce((r,O)=>{var Z;const{formatName:V,formatOptions:U}=kH(O);if(this.formats[V]){let ie=r;try{const de=((Z=w==null?void 0:w.formatParams)==null?void 0:Z[w.interpolationkey])||{},se=de.locale||de.lng||w.locale||w.lng||_;ie=this.formats[V](r,se,{...U,...w,...de})}catch(de){this.logger.warn(de)}return ie}else this.logger.warn(`there was no format function for ${V}`);return r},l)}}const zH=(a,l)=>{a.pending[l]!==void 0&&(delete a.pending[l],a.pendingCount--)};class LH extends hv{constructor(l,m,_,w={}){var C,M;super(),this.backend=l,this.store=m,this.services=_,this.languageUtils=_.languageUtils,this.options=w,this.logger=vh.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=w.maxParallelReads||10,this.readingCalls=0,this.maxRetries=w.maxRetries>=0?w.maxRetries:5,this.retryTimeout=w.retryTimeout>=1?w.retryTimeout:350,this.state={},this.queue=[],(M=(C=this.backend)==null?void 0:C.init)==null||M.call(C,_,w.backend,w)}queueLoad(l,m,_,w){const C={},M={},r={},O={};return l.forEach(V=>{let U=!0;m.forEach(Z=>{const ie=`${V}|${Z}`;!_.reload&&this.store.hasResourceBundle(V,Z)?this.state[ie]=2:this.state[ie]<0||(this.state[ie]===1?M[ie]===void 0&&(M[ie]=!0):(this.state[ie]=1,U=!1,M[ie]===void 0&&(M[ie]=!0),C[ie]===void 0&&(C[ie]=!0),O[Z]===void 0&&(O[Z]=!0)))}),U||(r[V]=!0)}),(Object.keys(C).length||Object.keys(M).length)&&this.queue.push({pending:M,pendingCount:Object.keys(M).length,loaded:{},errors:[],callback:w}),{toLoad:Object.keys(C),pending:Object.keys(M),toLoadLanguages:Object.keys(r),toLoadNamespaces:Object.keys(O)}}loaded(l,m,_){const w=l.split("|"),C=w[0],M=w[1];m&&this.emit("failedLoading",C,M,m),!m&&_&&this.store.addResourceBundle(C,M,_,void 0,void 0,{skipCopy:!0}),this.state[l]=m?-1:2,m&&_&&(this.state[l]=0);const r={};this.queue.forEach(O=>{vH(O.loaded,[C],M),zH(O,l),m&&O.errors.push(m),O.pendingCount===0&&!O.done&&(Object.keys(O.loaded).forEach(V=>{r[V]||(r[V]={});const U=O.loaded[V];U.length&&U.forEach(Z=>{r[V][Z]===void 0&&(r[V][Z]=!0)})}),O.done=!0,O.errors.length?O.callback(O.errors):O.callback())}),this.emit("loaded",r),this.queue=this.queue.filter(O=>!O.done)}read(l,m,_,w=0,C=this.retryTimeout,M){if(!l.length)return M(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:l,ns:m,fcName:_,tried:w,wait:C,callback:M});return}this.readingCalls++;const r=(V,U)=>{if(this.readingCalls--,this.waitingReads.length>0){const Z=this.waitingReads.shift();this.read(Z.lng,Z.ns,Z.fcName,Z.tried,Z.wait,Z.callback)}if(V&&U&&w<this.maxRetries){setTimeout(()=>{this.read.call(this,l,m,_,w+1,C*2,M)},C);return}M(V,U)},O=this.backend[_].bind(this.backend);if(O.length===2){try{const V=O(l,m);V&&typeof V.then=="function"?V.then(U=>r(null,U)).catch(r):r(null,V)}catch(V){r(V)}return}return O(l,m,r)}prepareLoading(l,m,_={},w){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),w&&w();Gi(l)&&(l=this.languageUtils.toResolveHierarchy(l)),Gi(m)&&(m=[m]);const C=this.queueLoad(l,m,_,w);if(!C.toLoad.length)return C.pending.length||w(),null;C.toLoad.forEach(M=>{this.loadOne(M)})}load(l,m,_){this.prepareLoading(l,m,{},_)}reload(l,m,_){this.prepareLoading(l,m,{reload:!0},_)}loadOne(l,m=""){const _=l.split("|"),w=_[0],C=_[1];this.read(w,C,"read",void 0,void 0,(M,r)=>{M&&this.logger.warn(`${m}loading namespace ${C} for language ${w} failed`,M),!M&&r&&this.logger.log(`${m}loaded namespace ${C} for language ${w}`,r),this.loaded(l,M,r)})}saveMissing(l,m,_,w,C,M={},r=()=>{}){var O,V,U,Z,ie;if((V=(O=this.services)==null?void 0:O.utils)!=null&&V.hasLoadedNamespace&&!((Z=(U=this.services)==null?void 0:U.utils)!=null&&Z.hasLoadedNamespace(m))){this.logger.warn(`did not save key "${_}" as the namespace "${m}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(_==null||_==="")){if((ie=this.backend)!=null&&ie.create){const de={...M,isUpdate:C},se=this.backend.create.bind(this.backend);if(se.length<6)try{let ne;se.length===5?ne=se(l,m,_,w,de):ne=se(l,m,_,w),ne&&typeof ne.then=="function"?ne.then(Se=>r(null,Se)).catch(r):r(null,ne)}catch(ne){r(ne)}else se(l,m,_,w,r,de)}!l||!l[0]||this.store.addResource(l[0],m,_,w)}}}const e2=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:a=>{let l={};if(typeof a[1]=="object"&&(l=a[1]),Gi(a[1])&&(l.defaultValue=a[1]),Gi(a[2])&&(l.tDescription=a[2]),typeof a[2]=="object"||typeof a[3]=="object"){const m=a[3]||a[2];Object.keys(m).forEach(_=>{l[_]=m[_]})}return l},interpolation:{escapeValue:!0,format:a=>a,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),t2=a=>{var l,m;return Gi(a.ns)&&(a.ns=[a.ns]),Gi(a.fallbackLng)&&(a.fallbackLng=[a.fallbackLng]),Gi(a.fallbackNS)&&(a.fallbackNS=[a.fallbackNS]),((m=(l=a.supportedLngs)==null?void 0:l.indexOf)==null?void 0:m.call(l,"cimode"))<0&&(a.supportedLngs=a.supportedLngs.concat(["cimode"])),typeof a.initImmediate=="boolean"&&(a.initAsync=a.initImmediate),a},yy=()=>{},DH=a=>{Object.getOwnPropertyNames(Object.getPrototypeOf(a)).forEach(m=>{typeof a[m]=="function"&&(a[m]=a[m].bind(a))})};class h_ extends hv{constructor(l={},m){if(super(),this.options=t2(l),this.services={},this.logger=vh,this.modules={external:[]},DH(this),m&&!this.isInitialized&&!l.isClone){if(!this.options.initAsync)return this.init(l,m),this;setTimeout(()=>{this.init(l,m)},0)}}init(l={},m){this.isInitializing=!0,typeof l=="function"&&(m=l,l={}),l.defaultNS==null&&l.ns&&(Gi(l.ns)?l.defaultNS=l.ns:l.ns.indexOf("translation")<0&&(l.defaultNS=l.ns[0]));const _=e2();this.options={..._,...this.options,...t2(l)},this.options.interpolation={..._.interpolation,...this.options.interpolation},l.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=l.keySeparator),l.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=l.nsSeparator);const w=V=>V?typeof V=="function"?new V:V:null;if(!this.options.isClone){this.modules.logger?vh.init(w(this.modules.logger),this.options):vh.init(null,this.options);let V;this.modules.formatter?V=this.modules.formatter:V=RH;const U=new KC(this.options);this.store=new GC(this.options.resources,this.options);const Z=this.services;Z.logger=vh,Z.resourceStore=this.store,Z.languageUtils=U,Z.pluralResolver=new IH(U,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==_.interpolation.format&&this.logger.warn("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),V&&(!this.options.interpolation.format||this.options.interpolation.format===_.interpolation.format)&&(Z.formatter=w(V),Z.formatter.init&&Z.formatter.init(Z,this.options),this.options.interpolation.format=Z.formatter.format.bind(Z.formatter)),Z.interpolator=new PH(this.options),Z.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},Z.backendConnector=new LH(w(this.modules.backend),Z.resourceStore,Z,this.options),Z.backendConnector.on("*",(de,...se)=>{this.emit(de,...se)}),this.modules.languageDetector&&(Z.languageDetector=w(this.modules.languageDetector),Z.languageDetector.init&&Z.languageDetector.init(Z,this.options.detection,this.options)),this.modules.i18nFormat&&(Z.i18nFormat=w(this.modules.i18nFormat),Z.i18nFormat.init&&Z.i18nFormat.init(this)),this.translator=new qy(this.services,this.options),this.translator.on("*",(de,...se)=>{this.emit(de,...se)}),this.modules.external.forEach(de=>{de.init&&de.init(this)})}if(this.format=this.options.interpolation.format,m||(m=yy),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const V=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);V.length>0&&V[0]!=="dev"&&(this.options.lng=V[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(V=>{this[V]=(...U)=>this.store[V](...U)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(V=>{this[V]=(...U)=>(this.store[V](...U),this)});const r=Zg(),O=()=>{const V=(U,Z)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),r.resolve(Z),m(U,Z)};if(this.languages&&!this.isInitialized)return V(null,this.t.bind(this));this.changeLanguage(this.options.lng,V)};return this.options.resources||!this.options.initAsync?O():setTimeout(O,0),r}loadResources(l,m=yy){var C,M;let _=m;const w=Gi(l)?l:this.language;if(typeof l=="function"&&(_=l),!this.options.resources||this.options.partialBundledLanguages){if((w==null?void 0:w.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return _();const r=[],O=V=>{if(!V||V==="cimode")return;this.services.languageUtils.toResolveHierarchy(V).forEach(Z=>{Z!=="cimode"&&r.indexOf(Z)<0&&r.push(Z)})};w?O(w):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(U=>O(U)),(M=(C=this.options.preload)==null?void 0:C.forEach)==null||M.call(C,V=>O(V)),this.services.backendConnector.load(r,this.options.ns,V=>{!V&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),_(V)})}else _(null)}reloadResources(l,m,_){const w=Zg();return typeof l=="function"&&(_=l,l=void 0),typeof m=="function"&&(_=m,m=void 0),l||(l=this.languages),m||(m=this.options.ns),_||(_=yy),this.services.backendConnector.reload(l,m,C=>{w.resolve(),_(C)}),w}use(l){if(!l)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!l.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return l.type==="backend"&&(this.modules.backend=l),(l.type==="logger"||l.log&&l.warn&&l.error)&&(this.modules.logger=l),l.type==="languageDetector"&&(this.modules.languageDetector=l),l.type==="i18nFormat"&&(this.modules.i18nFormat=l),l.type==="postProcessor"&&lI.addPostProcessor(l),l.type==="formatter"&&(this.modules.formatter=l),l.type==="3rdParty"&&this.modules.external.push(l),this}setResolvedLanguage(l){if(!(!l||!this.languages)&&!(["cimode","dev"].indexOf(l)>-1)){for(let m=0;m<this.languages.length;m++){const _=this.languages[m];if(!(["cimode","dev"].indexOf(_)>-1)&&this.store.hasLanguageSomeTranslations(_)){this.resolvedLanguage=_;break}}!this.resolvedLanguage&&this.languages.indexOf(l)<0&&this.store.hasLanguageSomeTranslations(l)&&(this.resolvedLanguage=l,this.languages.unshift(l))}}changeLanguage(l,m){this.isLanguageChangingTo=l;const _=Zg();this.emit("languageChanging",l);const w=r=>{this.language=r,this.languages=this.services.languageUtils.toResolveHierarchy(r),this.resolvedLanguage=void 0,this.setResolvedLanguage(r)},C=(r,O)=>{O?this.isLanguageChangingTo===l&&(w(O),this.translator.changeLanguage(O),this.isLanguageChangingTo=void 0,this.emit("languageChanged",O),this.logger.log("languageChanged",O)):this.isLanguageChangingTo=void 0,_.resolve((...V)=>this.t(...V)),m&&m(r,(...V)=>this.t(...V))},M=r=>{var U,Z;!l&&!r&&this.services.languageDetector&&(r=[]);const O=Gi(r)?r:r&&r[0],V=this.store.hasLanguageSomeTranslations(O)?O:this.services.languageUtils.getBestMatchFromCodes(Gi(r)?[r]:r);V&&(this.language||w(V),this.translator.language||this.translator.changeLanguage(V),(Z=(U=this.services.languageDetector)==null?void 0:U.cacheUserLanguage)==null||Z.call(U,V)),this.loadResources(V,ie=>{C(ie,V)})};return!l&&this.services.languageDetector&&!this.services.languageDetector.async?M(this.services.languageDetector.detect()):!l&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(M):this.services.languageDetector.detect(M):M(l),_}getFixedT(l,m,_){const w=(C,M,...r)=>{let O;typeof M!="object"?O=this.options.overloadTranslationOptionHandler([C,M].concat(r)):O={...M},O.lng=O.lng||w.lng,O.lngs=O.lngs||w.lngs,O.ns=O.ns||w.ns,O.keyPrefix!==""&&(O.keyPrefix=O.keyPrefix||_||w.keyPrefix);const V=this.options.keySeparator||".";let U;return O.keyPrefix&&Array.isArray(C)?U=C.map(Z=>`${O.keyPrefix}${V}${Z}`):U=O.keyPrefix?`${O.keyPrefix}${V}${C}`:C,this.t(U,O)};return Gi(l)?w.lng=l:w.lngs=l,w.ns=m,w.keyPrefix=_,w}t(...l){var m;return(m=this.translator)==null?void 0:m.translate(...l)}exists(...l){var m;return(m=this.translator)==null?void 0:m.exists(...l)}setDefaultNamespace(l){this.options.defaultNS=l}hasLoadedNamespace(l,m={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const _=m.lng||this.resolvedLanguage||this.languages[0],w=this.options?this.options.fallbackLng:!1,C=this.languages[this.languages.length-1];if(_.toLowerCase()==="cimode")return!0;const M=(r,O)=>{const V=this.services.backendConnector.state[`${r}|${O}`];return V===-1||V===0||V===2};if(m.precheck){const r=m.precheck(this,M);if(r!==void 0)return r}return!!(this.hasResourceBundle(_,l)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||M(_,l)&&(!w||M(C,l)))}loadNamespaces(l,m){const _=Zg();return this.options.ns?(Gi(l)&&(l=[l]),l.forEach(w=>{this.options.ns.indexOf(w)<0&&this.options.ns.push(w)}),this.loadResources(w=>{_.resolve(),m&&m(w)}),_):(m&&m(),Promise.resolve())}loadLanguages(l,m){const _=Zg();Gi(l)&&(l=[l]);const w=this.options.preload||[],C=l.filter(M=>w.indexOf(M)<0&&this.services.languageUtils.isSupportedCode(M));return C.length?(this.options.preload=w.concat(C),this.loadResources(M=>{_.resolve(),m&&m(M)}),_):(m&&m(),Promise.resolve())}dir(l){var w,C;if(l||(l=this.resolvedLanguage||(((w=this.languages)==null?void 0:w.length)>0?this.languages[0]:this.language)),!l)return"rtl";try{const M=new Intl.Locale(l);if(M&&M.getTextInfo){const r=M.getTextInfo();if(r&&r.direction)return r.direction}}catch{}const m=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],_=((C=this.services)==null?void 0:C.languageUtils)||new KC(e2());return l.toLowerCase().indexOf("-latn")>1?"ltr":m.indexOf(_.getLanguagePartFromCode(l))>-1||l.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(l={},m){return new h_(l,m)}cloneInstance(l={},m=yy){const _=l.forkResourceStore;_&&delete l.forkResourceStore;const w={...this.options,...l,isClone:!0},C=new h_(w);if((l.debug!==void 0||l.prefix!==void 0)&&(C.logger=C.logger.clone(l)),["store","services","language"].forEach(r=>{C[r]=this[r]}),C.services={...this.services},C.services.utils={hasLoadedNamespace:C.hasLoadedNamespace.bind(C)},_){const r=Object.keys(this.store.data).reduce((O,V)=>(O[V]={...this.store.data[V]},O[V]=Object.keys(O[V]).reduce((U,Z)=>(U[Z]={...O[V][Z]},U),O[V]),O),{});C.store=new GC(r,w),C.services.resourceStore=C.store}return C.translator=new qy(C.services,w),C.translator.on("*",(r,...O)=>{C.emit(r,...O)}),C.init(w,m),C.translator.options=w,C.translator.backendConnector.services.utils={hasLoadedNamespace:C.hasLoadedNamespace.bind(C)},C}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Sa=h_.createInstance();Sa.createInstance=h_.createInstance;Sa.createInstance;Sa.dir;Sa.init;Sa.loadResources;Sa.reloadResources;Sa.use;Sa.changeLanguage;Sa.getFixedT;Sa.t;Sa.exists;Sa.setDefaultNamespace;Sa.hasLoadedNamespace;Sa.loadNamespaces;Sa.loadLanguages;const{slice:OH,forEach:BH}=[];function FH(a){return BH.call(OH.call(arguments,1),l=>{if(l)for(const m in l)a[m]===void 0&&(a[m]=l[m])}),a}function jH(a){return typeof a!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(m=>m.test(a))}const n2=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,NH=function(a,l){const _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},w=encodeURIComponent(l);let C=`${a}=${w}`;if(_.maxAge>0){const M=_.maxAge-0;if(Number.isNaN(M))throw new Error("maxAge should be a Number");C+=`; Max-Age=${Math.floor(M)}`}if(_.domain){if(!n2.test(_.domain))throw new TypeError("option domain is invalid");C+=`; Domain=${_.domain}`}if(_.path){if(!n2.test(_.path))throw new TypeError("option path is invalid");C+=`; Path=${_.path}`}if(_.expires){if(typeof _.expires.toUTCString!="function")throw new TypeError("option expires is invalid");C+=`; Expires=${_.expires.toUTCString()}`}if(_.httpOnly&&(C+="; HttpOnly"),_.secure&&(C+="; Secure"),_.sameSite)switch(typeof _.sameSite=="string"?_.sameSite.toLowerCase():_.sameSite){case!0:C+="; SameSite=Strict";break;case"lax":C+="; SameSite=Lax";break;case"strict":C+="; SameSite=Strict";break;case"none":C+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return _.partitioned&&(C+="; Partitioned"),C},i2={create(a,l,m,_){let w=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};m&&(w.expires=new Date,w.expires.setTime(w.expires.getTime()+m*60*1e3)),_&&(w.domain=_),document.cookie=NH(a,l,w)},read(a){const l=`${a}=`,m=document.cookie.split(";");for(let _=0;_<m.length;_++){let w=m[_];for(;w.charAt(0)===" ";)w=w.substring(1,w.length);if(w.indexOf(l)===0)return w.substring(l.length,w.length)}return null},remove(a,l){this.create(a,"",-1,l)}};var VH={name:"cookie",lookup(a){let{lookupCookie:l}=a;if(l&&typeof document<"u")return i2.read(l)||void 0},cacheUserLanguage(a,l){let{lookupCookie:m,cookieMinutes:_,cookieDomain:w,cookieOptions:C}=l;m&&typeof document<"u"&&i2.create(m,a,_,w,C)}},qH={name:"querystring",lookup(a){var _;let{lookupQuerystring:l}=a,m;if(typeof window<"u"){let{search:w}=window.location;!window.location.search&&((_=window.location.hash)==null?void 0:_.indexOf("?"))>-1&&(w=window.location.hash.substring(window.location.hash.indexOf("?")));const M=w.substring(1).split("&");for(let r=0;r<M.length;r++){const O=M[r].indexOf("=");O>0&&M[r].substring(0,O)===l&&(m=M[r].substring(O+1))}}return m}},HH={name:"hash",lookup(a){var w;let{lookupHash:l,lookupFromHashIndex:m}=a,_;if(typeof window<"u"){const{hash:C}=window.location;if(C&&C.length>2){const M=C.substring(1);if(l){const r=M.split("&");for(let O=0;O<r.length;O++){const V=r[O].indexOf("=");V>0&&r[O].substring(0,V)===l&&(_=r[O].substring(V+1))}}if(_)return _;if(!_&&m>-1){const r=C.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?(w=r[typeof m=="number"?m:0])==null?void 0:w.replace("/",""):void 0}}}return _}};let ym=null;const r2=()=>{if(ym!==null)return ym;try{if(ym=typeof window<"u"&&window.localStorage!==null,!ym)return!1;const a="i18next.translate.boo";window.localStorage.setItem(a,"foo"),window.localStorage.removeItem(a)}catch{ym=!1}return ym};var UH={name:"localStorage",lookup(a){let{lookupLocalStorage:l}=a;if(l&&r2())return window.localStorage.getItem(l)||void 0},cacheUserLanguage(a,l){let{lookupLocalStorage:m}=l;m&&r2()&&window.localStorage.setItem(m,a)}};let vm=null;const s2=()=>{if(vm!==null)return vm;try{if(vm=typeof window<"u"&&window.sessionStorage!==null,!vm)return!1;const a="i18next.translate.boo";window.sessionStorage.setItem(a,"foo"),window.sessionStorage.removeItem(a)}catch{vm=!1}return vm};var $H={name:"sessionStorage",lookup(a){let{lookupSessionStorage:l}=a;if(l&&s2())return window.sessionStorage.getItem(l)||void 0},cacheUserLanguage(a,l){let{lookupSessionStorage:m}=l;m&&s2()&&window.sessionStorage.setItem(m,a)}},GH={name:"navigator",lookup(a){const l=[];if(typeof navigator<"u"){const{languages:m,userLanguage:_,language:w}=navigator;if(m)for(let C=0;C<m.length;C++)l.push(m[C]);_&&l.push(_),w&&l.push(w)}return l.length>0?l:void 0}},WH={name:"htmlTag",lookup(a){let{htmlTag:l}=a,m;const _=l||(typeof document<"u"?document.documentElement:null);return _&&typeof _.getAttribute=="function"&&(m=_.getAttribute("lang")),m}},ZH={name:"path",lookup(a){var w;let{lookupFromPathIndex:l}=a;if(typeof window>"u")return;const m=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(m)?(w=m[typeof l=="number"?l:0])==null?void 0:w.replace("/",""):void 0}},KH={name:"subdomain",lookup(a){var w,C;let{lookupFromSubdomainIndex:l}=a;const m=typeof l=="number"?l+1:1,_=typeof window<"u"&&((C=(w=window.location)==null?void 0:w.hostname)==null?void 0:C.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(_)return _[m]}};let cI=!1;try{document.cookie,cI=!0}catch{}const uI=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];cI||uI.splice(1,1);const XH=()=>({order:uI,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:a=>a});class hI{constructor(l){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(l,m)}init(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=l,this.options=FH(m,this.options||{},XH()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=w=>w.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=_,this.addDetector(VH),this.addDetector(qH),this.addDetector(UH),this.addDetector($H),this.addDetector(GH),this.addDetector(WH),this.addDetector(ZH),this.addDetector(KH),this.addDetector(HH)}addDetector(l){return this.detectors[l.name]=l,this}detect(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,m=[];return l.forEach(_=>{if(this.detectors[_]){let w=this.detectors[_].lookup(this.options);w&&typeof w=="string"&&(w=[w]),w&&(m=m.concat(w))}}),m=m.filter(_=>_!=null&&!jH(_)).map(_=>this.options.convertDetectedLanguage(_)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?m:m.length>0?m[0]:null}cacheUserLanguage(l){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;m&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(l)>-1||m.forEach(_=>{this.detectors[_]&&this.detectors[_].cacheUserLanguage(l,this.options)}))}}hI.type="languageDetector";const YH={logoTitle:"My Hoi An",moreDetails:"More details",details:"Details",category:"Category",description:"Description",youAreHere:"You are here",close:"Close",noDetailsAvailable:"No details available for this object.",welcomeMessage:"Hello! Welcome to Hoi An!",noMarkers:"Select an existing marker on the map",swiperWelcomeTitle:"Hello!",swiperWelcomeSubtitle:"Please select a marker on the map",welcomeDialogTitle:"Traveler!",welcomeDialogMessage:"Thanks for being with us!",thankYouMessage:"This guide is just starting its journey, but it will grow and get better thanks to your feedback and suggestions!",welcomeClose:"Close",locationPermissionTitle:"Location Access Permission",locationPermissionExplanation:"To provide a better experience and show nearby landmarks on the map, we need access to your current location. This will help display objects near you.",locationPermissionNote:"Your location will not be saved or shared with third parties.",allow:"Allow",deny:"Deny",findMyPosition:"Find My Position",geolocationError:"An error occurred while getting the location.",userDeniedLocation:"User denied the request for geolocation. Please allow access in browser settings.",locationUnavailable:"Location information is unavailable.",locationTimeout:"The request to get user location timed out.",unknownLocationError:"An unknown error occurred while getting the location.",footer:{copyright:"All rights reserved."},menu:{title:"Menu"},categories:{museum:"Museums","food-drinks":"Food & Drinks","art-galleries":"Art Galleries",clubs:"Clubs"}},QH={logoTitle:" ",moreDetails:"",details:"",category:"",description:"",youAreHere:" ",close:"",noDetailsAvailable:"    .",welcomeMessage:"   !",noMarkers:"    ",swiperWelcomeTitle:"!",swiperWelcomeSubtitle:",    .",welcomeDialogTitle:"!",welcomeDialogMessage:",    !",thankYouMessage:"      ,           !",welcomeClose:"",locationPermissionTitle:"    ",locationPermissionExplanation:"            .       .",locationPermissionNote:"        .",allow:"",deny:"",findMyPosition:"  ",geolocationError:"    .",userDeniedLocation:"     . ,     .",locationUnavailable:"   .",locationTimeout:"     .",unknownLocationError:"     .",footer:{copyright:"  ."},menu:{title:""},categories:{museum:"","food-drinks":"  ","art-galleries":"-",clubs:""}},JH={logoTitle:"Mi Hoi An",moreDetails:"Ms detalles",details:"Detalles",category:"Categora",description:"Descripcin",youAreHere:"Ests aqu",close:"Cerrar",noDetailsAvailable:"No hay detalles disponibles para este objeto.",welcomeMessage:"Hola! Bienvenido a Hoi An!",noMarkers:"Selecciona un marcador existente en el mapa",swiperWelcomeTitle:"Hola!",swiperWelcomeSubtitle:"Por favor, selecciona un marcador en el mapa",welcomeDialogTitle:"Viajero!",welcomeDialogMessage:"Gracias por estar con nosotros!",thankYouMessage:"Esta gua apenas comienza su camino, pero crecer y mejorar gracias a tus comentarios y sugerencias.",welcomeClose:"Cerrar",locationPermissionTitle:"Permiso de acceso a la ubicacin",locationPermissionExplanation:"Para una mejor visualizacin de las atracciones en el mapa, necesitamos acceso a su ubicacin actual. Esto ayudar a mostrar los objetos cercanos a usted.",locationPermissionNote:"Su ubicacin no ser guardada ni compartida con terceros.",allow:"Permitir",deny:"Denegar",findMyPosition:"Encontrar mi posicin",geolocationError:"Ocurri un error al obtener la ubicacin.",userDeniedLocation:"El usuario deneg la solicitud de ubicacin. Por favor, permita el acceso en la configuracin del navegador.",locationUnavailable:"Informacin de ubicacin no disponible.",locationTimeout:"Tiempo de espera agotado al obtener la ubicacin.",unknownLocationError:"Ocurri un error desconocido al obtener la ubicacin.",footer:{copyright:"Todos los derechos reservados."},menu:{title:"Men"},categories:{museum:"Museos","food-drinks":"Comida y Bebidas","art-galleries":"Arte",clubs:"Clubs"}},eU={logoTitle:"Mon Hi An",moreDetails:"Plus de dtails",details:"Dtails",category:"Catgorie",description:"Description",youAreHere:"Vous tes ici",close:"Fermer",noDetailsAvailable:"Aucun dtail disponible pour cet objet.",welcomeMessage:"Bonjour ! Bienvenue  Hi An!",noMarkers:"Slectionnez un marqueur existant ",swiperWelcomeTitle:"Bonjour!",swiperWelcomeSubtitle:"Veuillez slectionner un marqueur sur la carte.",welcomeDialogTitle:"Voyageur !",welcomeDialogMessage:"Merci d'tre avec nous !",thankYouMessage:"Ce guide ne fait que commencer son voyage, mais il grandira et s'amliorera grce  tes retours et suggestions !",welcomeClose:"Fermer",locationPermissionTitle:"Autorisation d'accs  la localisation",locationPermissionExplanation:"Pour une meilleure affichage des sites touristiques sur la carte, nous avons besoin d'accder  votre position actuelle. Cela aidera  montrer les objets prs de chez vous.",locationPermissionNote:"Votre position ne sera ni sauvegarde ni partage avec des tiers.",allow:"Autoriser",deny:"Refuser",findMyPosition:"Trouver ma position",geolocationError:"Une erreur est survenue lors de l'obtention de la localisation.",userDeniedLocation:"L'utilisateur a refus la demande de localisation. Veuillez autoriser l'accs dans les paramtres du navigateur.",locationUnavailable:"Les informations de localisation ne sont pas disponibles.",locationTimeout:"Le dlai d'attente pour obtenir la localisation a expir.",unknownLocationError:"Une erreur inconnue est survenue lors de l'obtention de la localisation.",footer:{copyright:"Tous droits rservs."},menu:{title:"Menu"},categories:{museum:"Muses","food-drinks":"Aliments et Boissons","art-galleries":"Art",clubs:"Clubs"}},tU={logoTitle:"Hi An Ca Ti",moreDetails:"Xem thm chi tit",details:"Chi tit",category:"Danh mc",description:"M t",youAreHere:"Bn ang  y",close:"ng",noDetailsAvailable:"Khng c thng tin chi tit cho i tng ny.",welcomeMessage:"Xin cho! Cho mng n Hi An!",noMarkers:"Chn mt im nh du hin c trn bn ",swiperWelcomeTitle:"Xin cho!",swiperWelcomeSubtitle:"Vui lng chn mt im nh du trn bn .",welcomeDialogTitle:"Du khch!",welcomeDialogMessage:"Cm n bn  ng hnh cng chng ti!",thankYouMessage:"Cm nang ny ch mi bt u hnh trnh ca mnh, nhng s pht trin v tt hn nh nhng phn hi v gp  ca bn!",welcomeClose:"ng",locationPermissionTitle:"Quyn truy cp v tr",locationPermissionExplanation:" hin th cc im tham quan tt hn trn bn , chng ti cn truy cp vo v tr hin ti ca bn. iu ny s gip hin th cc a im gn bn.",locationPermissionNote:"V tr ca bn s khng c lu tr hoc chia s vi bn th ba.",allow:"Cho php",deny:"T chi",findMyPosition:"Tm v tr ca ti",geolocationError:" xy ra li khi ly v tr.",userDeniedLocation:"Ngi dng  t chi yu cu xc nh v tr. Vui lng cho php truy cp trong ci t trnh duyt.",locationUnavailable:"Thng tin v tr khng kh dng.",locationTimeout:" ht thi gian ch khi ly v tr.",unknownLocationError:" xy ra li khng xc nh khi ly v tr.",footer:{copyright:"Mi quyn c bo lu."},menu:{title:"Menu"},categories:{museum:"Bo tng","food-drinks":" n & Thc ung","art-galleries":"Ngh thut",clubs:"Cu lc b"}};Sa.use(hI).use(b5).init({resources:{en:{translation:YH},ru:{translation:QH},es:{translation:JH},fr:{translation:eU},vn:{translation:tU}},lng:"en",fallbackLng:"en",supportedLngs:["en","ru","es","fr","vn"],nonExplicitSupportedLngs:!0,load:"languageOnly",interpolation:{escapeValue:!1},debug:!1,detection:{order:["localStorage","navigator"],caches:["localStorage"]},react:{useSuspense:!0}});const nU=a=>({palette:{mode:a,primary:{main:"#90caf9"},secondary:{main:"#f48fb1"},background:{default:"#2e2e39",paper:"#2e2e39"},text:{primary:"#e0e0e0",secondary:"#a0a0a0"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',h1:{fontSize:"3rem"}}}),iU=ue.createContext(void 0),rU=({children:a})=>{const l="dark",m=Qr.useCallback(()=>{console.warn("Theme switching is disabled.")},[]),_=ue.useMemo(()=>K0(nU(l)),[l]);return Ne.jsx(iU.Provider,{value:{toggleColorMode:m,mode:l},children:Ne.jsx(TO,{theme:_,children:a})})};a2.createRoot(document.getElementById("root")).render(Ne.jsx(SR,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:Ne.jsxs(rU,{children:[Ne.jsx(SB,{}),Ne.jsx(E5,{children:Ne.jsx(iH,{children:Ne.jsx(gH,{})})})]})}));
